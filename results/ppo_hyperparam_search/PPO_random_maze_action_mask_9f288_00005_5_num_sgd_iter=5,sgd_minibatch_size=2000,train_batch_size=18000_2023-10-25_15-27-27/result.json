{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999993, "cur_lr": 0.0003, "total_loss": 9.162715572781034, "policy_loss": -0.003836196329858568, "vf_loss": 9.165805371602376, "vf_explained_var": 6.215042538113065e-05, "kl": 0.004097878943658624, "entropy": 0.730662461121877, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 41.70000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.6800000000003, "episode_len_mean": 397.2, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.099999999999703, 16.29999999999979, -50.00000000000044, 30.29999999999999, -50.00000000000044, 34.70000000000004, -50.00000000000044, 41.70000000000002, 36.30000000000003, 24.099999999999902, 41.30000000000001, -50.00000000000044, 23.699999999999896, 6.299999999999649, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [400, 338, 500, 198, 500, 154, 500, 84, 138, 260, 88, 500, 264, 438, 500, 500, 156, 500, 500, 500, 404, 500, 388, 500, 500, 188, 500, 500, 500, 500, 500, 500, 150, 500, 500, 500, 240, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42412708315509384, "mean_inference_ms": 1.3604645289078623, "mean_action_processing_ms": 0.1671750612214436, "mean_env_wait_ms": 0.0973137198568264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02748429775238037, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.13641893863677979}}, "episode_reward_max": 41.70000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.6800000000003, "episode_len_mean": 397.2, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.099999999999703, 16.29999999999979, -50.00000000000044, 30.29999999999999, -50.00000000000044, 34.70000000000004, -50.00000000000044, 41.70000000000002, 36.30000000000003, 24.099999999999902, 41.30000000000001, -50.00000000000044, 23.699999999999896, 6.299999999999649, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [400, 338, 500, 198, 500, 154, 500, 84, 138, 260, 88, 500, 264, 438, 500, 500, 156, 500, 500, 500, 404, 500, 388, 500, 500, 188, 500, 500, 500, 500, 500, 500, 150, 500, 500, 500, 240, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42412708315509384, "mean_inference_ms": 1.3604645289078623, "mean_action_processing_ms": 0.1671750612214436, "mean_env_wait_ms": 0.0973137198568264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02748429775238037, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.13641893863677979}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5105.050030489327, "num_env_steps_trained_throughput_per_sec": 5105.050030489327, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3525.92, "sample_time_ms": 3190.344, "load_time_ms": 9.0, "load_throughput": 2000091.981, "learn_time_ms": 308.871, "learn_throughput": 58276.706, "synch_weights_time_ms": 16.0}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-05", "timestamp": 1698245645, "time_this_iter_s": 3.529918670654297, "time_total_s": 3.529918670654297, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.529918670654297, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 67.06666666666668, "ram_util_percent": 27.483333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 8.942060534159342, "policy_loss": -0.0012513880824877156, "vf_loss": 8.9430724673801, "vf_explained_var": -9.959273868136937e-06, "kl": 0.0030930820283982838, "entropy": 0.6983785404099359, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 42.70000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.42413793103475, "episode_len_mean": 373.37931034482756, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.099999999999703, 16.29999999999979, -50.00000000000044, 30.29999999999999, -50.00000000000044, 34.70000000000004, -50.00000000000044, 41.70000000000002, 36.30000000000003, 24.099999999999902, 41.30000000000001, -50.00000000000044, 23.699999999999896, 6.299999999999649, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 1.099999999999575, 28.29999999999996, -50.00000000000044, 31.900000000000013, 25.29999999999992, 24.499999999999908, 11.29999999999972, 6.699999999999655, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.699999999999768, -50.00000000000044, 35.30000000000004, 35.10000000000004, -50.00000000000044, 37.70000000000003, 33.500000000000036, 14.699999999999768, 0.49999999999956657, 19.899999999999842, 13.699999999999754, -50.00000000000044, -50.00000000000044, 28.499999999999964, 36.70000000000003, 14.09999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 25.499999999999922, 40.500000000000014, -50.00000000000044, 42.70000000000001, 19.899999999999842, 31.70000000000001], "episode_lengths": [400, 338, 500, 198, 500, 154, 500, 84, 138, 260, 88, 500, 264, 438, 500, 500, 156, 500, 500, 500, 404, 500, 388, 500, 500, 188, 500, 500, 500, 500, 500, 500, 150, 500, 500, 500, 240, 500, 500, 500, 500, 254, 500, 500, 500, 500, 352, 490, 218, 500, 182, 248, 256, 388, 434, 500, 256, 500, 354, 500, 148, 150, 500, 124, 166, 354, 496, 302, 364, 500, 500, 216, 134, 360, 500, 500, 218, 500, 500, 230, 500, 246, 96, 500, 74, 302, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4193234638108598, "mean_inference_ms": 1.3385902833928753, "mean_action_processing_ms": 0.1625364058971468, "mean_env_wait_ms": 0.09419918130345399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024428860894564926, "StateBufferConnector_ms": 0.00689440760119208, "ViewRequirementAgentConnector_ms": 0.13159335344687276}}, "episode_reward_max": 42.70000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.42413793103475, "episode_len_mean": 373.37931034482756, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.099999999999703, 16.29999999999979, -50.00000000000044, 30.29999999999999, -50.00000000000044, 34.70000000000004, -50.00000000000044, 41.70000000000002, 36.30000000000003, 24.099999999999902, 41.30000000000001, -50.00000000000044, 23.699999999999896, 6.299999999999649, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 11.29999999999972, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 1.099999999999575, 28.29999999999996, -50.00000000000044, 31.900000000000013, 25.29999999999992, 24.499999999999908, 11.29999999999972, 6.699999999999655, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.699999999999768, -50.00000000000044, 35.30000000000004, 35.10000000000004, -50.00000000000044, 37.70000000000003, 33.500000000000036, 14.699999999999768, 0.49999999999956657, 19.899999999999842, 13.699999999999754, -50.00000000000044, -50.00000000000044, 28.499999999999964, 36.70000000000003, 14.09999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 25.499999999999922, 40.500000000000014, -50.00000000000044, 42.70000000000001, 19.899999999999842, 31.70000000000001], "episode_lengths": [400, 338, 500, 198, 500, 154, 500, 84, 138, 260, 88, 500, 264, 438, 500, 500, 156, 500, 500, 500, 404, 500, 388, 500, 500, 188, 500, 500, 500, 500, 500, 500, 150, 500, 500, 500, 240, 500, 500, 500, 500, 254, 500, 500, 500, 500, 352, 490, 218, 500, 182, 248, 256, 388, 434, 500, 256, 500, 354, 500, 148, 150, 500, 124, 166, 354, 496, 302, 364, 500, 500, 216, 134, 360, 500, 500, 218, 500, 500, 230, 500, 246, 96, 500, 74, 302, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4193234638108598, "mean_inference_ms": 1.3385902833928753, "mean_action_processing_ms": 0.1625364058971468, "mean_env_wait_ms": 0.09419918130345399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024428860894564926, "StateBufferConnector_ms": 0.00689440760119208, "ViewRequirementAgentConnector_ms": 0.13159335344687276}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5433.739339618065, "num_env_steps_trained_throughput_per_sec": 5433.739339618065, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3419.278, "sample_time_ms": 3093.983, "load_time_ms": 8.999, "load_throughput": 2000197.96, "learn_time_ms": 302.443, "learn_throughput": 59515.435, "synch_weights_time_ms": 12.501}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 87, "training_iteration": 2, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-09", "timestamp": 1698245649, "time_this_iter_s": 3.317664384841919, "time_total_s": 6.847583055496216, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.847583055496216, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 74.95, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.04999999999999998, "cur_lr": 0.0003, "total_loss": 8.954854287041558, "policy_loss": -0.001364443451166153, "vf_loss": 8.956157769097222, "vf_explained_var": 8.359220292833116e-06, "kl": 0.002564367447282873, "entropy": 0.6728862855169508, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.213999999999813, "episode_len_mean": 308.6, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.499999999999908, 11.29999999999972, 6.699999999999655, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.699999999999768, -50.00000000000044, 35.30000000000004, 35.10000000000004, -50.00000000000044, 37.70000000000003, 33.500000000000036, 14.699999999999768, 0.49999999999956657, 19.899999999999842, 13.699999999999754, -50.00000000000044, -50.00000000000044, 28.499999999999964, 36.70000000000003, 14.09999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 25.499999999999922, 40.500000000000014, -50.00000000000044, 42.70000000000001, 19.899999999999842, 31.70000000000001, 14.699999999999768, 23.499999999999893, -50.00000000000044, 18.499999999999822, -50.00000000000044, 43.10000000000001, 44.5, 25.29999999999992, -50.00000000000044, 34.10000000000004, 2.8999999999996007, 27.699999999999953, 37.10000000000003, 42.70000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.70000000000002, 36.30000000000003, 13.499999999999751, 36.30000000000003, 16.8999999999998, 30.699999999999996, 14.499999999999766, 8.899999999999686, 37.300000000000026, -50.00000000000044, 5.6999999999996405, 18.29999999999982, 10.099999999999703, -50.00000000000044, 36.900000000000034, 42.70000000000001, 29.69999999999998, -50.00000000000044, 13.499999999999751, 30.9, 29.49999999999998, 30.499999999999993, -50.00000000000044, 25.099999999999916, 30.099999999999987, 15.699999999999783, -50.00000000000044, -50.00000000000044, 32.30000000000002, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 15.899999999999785, 26.299999999999933, 36.50000000000003, 39.90000000000002, 13.699999999999754, 14.499999999999766, 35.10000000000004, 24.899999999999913, 25.699999999999925, 39.50000000000002, 23.499999999999893, 26.89999999999994, 34.10000000000004], "episode_lengths": [256, 388, 434, 500, 256, 500, 354, 500, 148, 150, 500, 124, 166, 354, 496, 302, 364, 500, 500, 216, 134, 360, 500, 500, 218, 500, 500, 230, 500, 246, 96, 500, 74, 302, 184, 354, 266, 500, 316, 500, 70, 56, 248, 500, 160, 472, 224, 130, 74, 418, 500, 500, 232, 104, 138, 366, 138, 332, 194, 356, 412, 128, 500, 444, 318, 400, 500, 132, 74, 204, 500, 366, 192, 206, 196, 500, 250, 200, 344, 500, 500, 178, 300, 500, 500, 500, 68, 342, 238, 136, 102, 364, 356, 150, 252, 244, 106, 266, 232, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41182525708474915, "mean_inference_ms": 1.306284135377515, "mean_action_processing_ms": 0.1563553219882642, "mean_env_wait_ms": 0.0898318262915337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019520282745361328, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12560534477233887}}, "episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.213999999999813, "episode_len_mean": 308.6, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.499999999999908, 11.29999999999972, 6.699999999999655, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.699999999999768, -50.00000000000044, 35.30000000000004, 35.10000000000004, -50.00000000000044, 37.70000000000003, 33.500000000000036, 14.699999999999768, 0.49999999999956657, 19.899999999999842, 13.699999999999754, -50.00000000000044, -50.00000000000044, 28.499999999999964, 36.70000000000003, 14.09999999999976, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 25.499999999999922, 40.500000000000014, -50.00000000000044, 42.70000000000001, 19.899999999999842, 31.70000000000001, 14.699999999999768, 23.499999999999893, -50.00000000000044, 18.499999999999822, -50.00000000000044, 43.10000000000001, 44.5, 25.29999999999992, -50.00000000000044, 34.10000000000004, 2.8999999999996007, 27.699999999999953, 37.10000000000003, 42.70000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.70000000000002, 36.30000000000003, 13.499999999999751, 36.30000000000003, 16.8999999999998, 30.699999999999996, 14.499999999999766, 8.899999999999686, 37.300000000000026, -50.00000000000044, 5.6999999999996405, 18.29999999999982, 10.099999999999703, -50.00000000000044, 36.900000000000034, 42.70000000000001, 29.69999999999998, -50.00000000000044, 13.499999999999751, 30.9, 29.49999999999998, 30.499999999999993, -50.00000000000044, 25.099999999999916, 30.099999999999987, 15.699999999999783, -50.00000000000044, -50.00000000000044, 32.30000000000002, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 15.899999999999785, 26.299999999999933, 36.50000000000003, 39.90000000000002, 13.699999999999754, 14.499999999999766, 35.10000000000004, 24.899999999999913, 25.699999999999925, 39.50000000000002, 23.499999999999893, 26.89999999999994, 34.10000000000004], "episode_lengths": [256, 388, 434, 500, 256, 500, 354, 500, 148, 150, 500, 124, 166, 354, 496, 302, 364, 500, 500, 216, 134, 360, 500, 500, 218, 500, 500, 230, 500, 246, 96, 500, 74, 302, 184, 354, 266, 500, 316, 500, 70, 56, 248, 500, 160, 472, 224, 130, 74, 418, 500, 500, 232, 104, 138, 366, 138, 332, 194, 356, 412, 128, 500, 444, 318, 400, 500, 132, 74, 204, 500, 366, 192, 206, 196, 500, 250, 200, 344, 500, 500, 178, 300, 500, 500, 500, 68, 342, 238, 136, 102, 364, 356, 150, 252, 244, 106, 266, 232, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41182525708474915, "mean_inference_ms": 1.306284135377515, "mean_action_processing_ms": 0.1563553219882642, "mean_env_wait_ms": 0.0898318262915337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019520282745361328, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12560534477233887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5552.438469935003, "num_env_steps_trained_throughput_per_sec": 5552.438469935003, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3360.125, "sample_time_ms": 3040.138, "load_time_ms": 8.335, "load_throughput": 2159497.492, "learn_time_ms": 298.749, "learn_throughput": 60251.286, "synch_weights_time_ms": 11.398}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 152, "training_iteration": 3, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-12", "timestamp": 1698245652, "time_this_iter_s": 3.2468173503875732, "time_total_s": 10.094400405883789, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.094400405883789, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 27.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02499999999999999, "cur_lr": 0.0003, "total_loss": 8.482874658372667, "policy_loss": -0.0005017382083072637, "vf_loss": 8.483396095699733, "vf_explained_var": 3.772311740451389e-06, "kl": 0.0017282482202214547, "entropy": 0.6306599511040581, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.882999999999852, "episode_len_mean": 256.9, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.499999999999993, -50.00000000000044, 25.099999999999916, 30.099999999999987, 15.699999999999783, -50.00000000000044, -50.00000000000044, 32.30000000000002, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 15.899999999999785, 26.299999999999933, 36.50000000000003, 39.90000000000002, 13.699999999999754, 14.499999999999766, 35.10000000000004, 24.899999999999913, 25.699999999999925, 39.50000000000002, 23.499999999999893, 26.89999999999994, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 35.500000000000036, 44.7, 43.50000000000001, -50.00000000000044, 36.50000000000003, 30.099999999999987, -50.00000000000044, 41.500000000000014, 37.50000000000003, 35.10000000000004, 43.10000000000001, 45.1, 44.5, 35.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 17.899999999999814, 37.300000000000026, -50.00000000000044, 39.10000000000002, 42.900000000000006, 43.50000000000001, 16.29999999999979, -50.00000000000044, 45.9, 37.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 33.90000000000004, 40.10000000000002, 30.29999999999999, 34.30000000000004, -50.00000000000044, 42.30000000000001, 0.8999999999995723, 38.700000000000024, 20.899999999999856, 42.10000000000001, 37.300000000000026, 20.699999999999854, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 19.299999999999834, 39.70000000000002, 46.3, 41.30000000000001, 42.70000000000001, 14.699999999999768, 35.30000000000004, 42.30000000000001, 37.10000000000003, 40.70000000000002, -50.00000000000044, 40.500000000000014, 20.899999999999856, 41.90000000000001, 46.099999999999994, 35.30000000000004, -50.00000000000044, 43.900000000000006, 42.10000000000001], "episode_lengths": [196, 500, 250, 200, 344, 500, 500, 178, 300, 500, 500, 500, 68, 342, 238, 136, 102, 364, 356, 150, 252, 244, 106, 266, 232, 160, 500, 500, 500, 500, 500, 122, 146, 54, 66, 500, 136, 200, 500, 86, 126, 150, 70, 50, 56, 144, 500, 56, 500, 322, 128, 500, 110, 72, 66, 338, 500, 42, 128, 38, 500, 500, 500, 302, 162, 100, 198, 158, 500, 78, 492, 114, 292, 80, 128, 294, 500, 500, 386, 500, 500, 308, 104, 38, 88, 74, 354, 148, 78, 130, 94, 500, 96, 292, 82, 40, 148, 500, 62, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052034584207499, "mean_inference_ms": 1.2886751184980119, "mean_action_processing_ms": 0.15415753913830404, "mean_env_wait_ms": 0.08865963480759519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028038978576660156, "StateBufferConnector_ms": 0.007512569427490234, "ViewRequirementAgentConnector_ms": 0.1295170783996582}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.882999999999852, "episode_len_mean": 256.9, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.499999999999993, -50.00000000000044, 25.099999999999916, 30.099999999999987, 15.699999999999783, -50.00000000000044, -50.00000000000044, 32.30000000000002, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 15.899999999999785, 26.299999999999933, 36.50000000000003, 39.90000000000002, 13.699999999999754, 14.499999999999766, 35.10000000000004, 24.899999999999913, 25.699999999999925, 39.50000000000002, 23.499999999999893, 26.89999999999994, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 35.500000000000036, 44.7, 43.50000000000001, -50.00000000000044, 36.50000000000003, 30.099999999999987, -50.00000000000044, 41.500000000000014, 37.50000000000003, 35.10000000000004, 43.10000000000001, 45.1, 44.5, 35.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 17.899999999999814, 37.300000000000026, -50.00000000000044, 39.10000000000002, 42.900000000000006, 43.50000000000001, 16.29999999999979, -50.00000000000044, 45.9, 37.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 33.90000000000004, 40.10000000000002, 30.29999999999999, 34.30000000000004, -50.00000000000044, 42.30000000000001, 0.8999999999995723, 38.700000000000024, 20.899999999999856, 42.10000000000001, 37.300000000000026, 20.699999999999854, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 19.299999999999834, 39.70000000000002, 46.3, 41.30000000000001, 42.70000000000001, 14.699999999999768, 35.30000000000004, 42.30000000000001, 37.10000000000003, 40.70000000000002, -50.00000000000044, 40.500000000000014, 20.899999999999856, 41.90000000000001, 46.099999999999994, 35.30000000000004, -50.00000000000044, 43.900000000000006, 42.10000000000001], "episode_lengths": [196, 500, 250, 200, 344, 500, 500, 178, 300, 500, 500, 500, 68, 342, 238, 136, 102, 364, 356, 150, 252, 244, 106, 266, 232, 160, 500, 500, 500, 500, 500, 122, 146, 54, 66, 500, 136, 200, 500, 86, 126, 150, 70, 50, 56, 144, 500, 56, 500, 322, 128, 500, 110, 72, 66, 338, 500, 42, 128, 38, 500, 500, 500, 302, 162, 100, 198, 158, 500, 78, 492, 114, 292, 80, 128, 294, 500, 500, 386, 500, 500, 308, 104, 38, 88, 74, 354, 148, 78, 130, 94, 500, 96, 292, 82, 40, 148, 500, 62, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4052034584207499, "mean_inference_ms": 1.2886751184980119, "mean_action_processing_ms": 0.15415753913830404, "mean_env_wait_ms": 0.08865963480759519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028038978576660156, "StateBufferConnector_ms": 0.007512569427490234, "ViewRequirementAgentConnector_ms": 0.1295170783996582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5542.848978811512, "num_env_steps_trained_throughput_per_sec": 5542.848978811512, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3331.951, "sample_time_ms": 3005.98, "load_time_ms": 8.501, "load_throughput": 2117280.872, "learn_time_ms": 304.614, "learn_throughput": 59091.257, "synch_weights_time_ms": 11.227}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 226, "training_iteration": 4, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-15", "timestamp": 1698245655, "time_this_iter_s": 3.252821683883667, "time_total_s": 13.347222089767456, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.347222089767456, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 67.025, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012499999999999995, "cur_lr": 0.0003, "total_loss": 7.608007791307237, "policy_loss": -0.0007596280839708117, "vf_loss": 7.6088021808200414, "vf_explained_var": -2.2384855482313368e-07, "kl": 0.002017980812546701, "entropy": 0.600762050681644, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.285999999999856, "episode_len_mean": 247.88, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.899999999999856, 42.10000000000001, 37.300000000000026, 20.699999999999854, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 19.299999999999834, 39.70000000000002, 46.3, 41.30000000000001, 42.70000000000001, 14.699999999999768, 35.30000000000004, 42.30000000000001, 37.10000000000003, 40.70000000000002, -50.00000000000044, 40.500000000000014, 20.899999999999856, 41.90000000000001, 46.099999999999994, 35.30000000000004, -50.00000000000044, 43.900000000000006, 42.10000000000001, 1.099999999999575, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 34.10000000000004, 4.899999999999629, 36.900000000000034, 21.09999999999986, 40.10000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 32.100000000000016, 39.300000000000026, 37.50000000000003, 42.500000000000014, 43.7, 33.30000000000003, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.099999999999994, 42.900000000000006, 35.70000000000003, 27.299999999999947, 46.699999999999996, 43.30000000000001, 43.7, 44.900000000000006, 45.3, 44.900000000000006, 35.10000000000004, -50.00000000000044, 33.90000000000004, 42.900000000000006, 40.10000000000002, 18.499999999999822, 37.50000000000003, 41.30000000000001, 4.299999999999621, 43.7, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.5, -50.00000000000044, 28.89999999999997, 25.29999999999992, 10.099999999999703, 43.7, -50.00000000000044, 3.0999999999996035, 39.300000000000026, 40.70000000000002, 40.90000000000002, 47.3, 36.10000000000004], "episode_lengths": [292, 80, 128, 294, 500, 500, 386, 500, 500, 308, 104, 38, 88, 74, 354, 148, 78, 130, 94, 500, 96, 292, 82, 40, 148, 500, 62, 80, 490, 62, 152, 500, 500, 160, 452, 132, 290, 100, 86, 500, 500, 500, 500, 236, 186, 500, 500, 60, 500, 500, 500, 262, 180, 108, 126, 76, 64, 168, 342, 500, 500, 500, 500, 70, 40, 72, 144, 228, 34, 68, 64, 52, 48, 52, 150, 500, 162, 72, 100, 316, 126, 88, 458, 64, 500, 350, 500, 46, 500, 212, 248, 400, 64, 500, 470, 108, 94, 92, 28, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012384507632656, "mean_inference_ms": 1.2805452485123248, "mean_action_processing_ms": 0.15405742489356256, "mean_env_wait_ms": 0.08837901673473544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02651357650756836, "StateBufferConnector_ms": 0.00815892219543457, "ViewRequirementAgentConnector_ms": 0.13619232177734375}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.285999999999856, "episode_len_mean": 247.88, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.899999999999856, 42.10000000000001, 37.300000000000026, 20.699999999999854, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 19.299999999999834, 39.70000000000002, 46.3, 41.30000000000001, 42.70000000000001, 14.699999999999768, 35.30000000000004, 42.30000000000001, 37.10000000000003, 40.70000000000002, -50.00000000000044, 40.500000000000014, 20.899999999999856, 41.90000000000001, 46.099999999999994, 35.30000000000004, -50.00000000000044, 43.900000000000006, 42.10000000000001, 1.099999999999575, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 34.10000000000004, 4.899999999999629, 36.900000000000034, 21.09999999999986, 40.10000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 32.100000000000016, 39.300000000000026, 37.50000000000003, 42.500000000000014, 43.7, 33.30000000000003, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.099999999999994, 42.900000000000006, 35.70000000000003, 27.299999999999947, 46.699999999999996, 43.30000000000001, 43.7, 44.900000000000006, 45.3, 44.900000000000006, 35.10000000000004, -50.00000000000044, 33.90000000000004, 42.900000000000006, 40.10000000000002, 18.499999999999822, 37.50000000000003, 41.30000000000001, 4.299999999999621, 43.7, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.5, -50.00000000000044, 28.89999999999997, 25.29999999999992, 10.099999999999703, 43.7, -50.00000000000044, 3.0999999999996035, 39.300000000000026, 40.70000000000002, 40.90000000000002, 47.3, 36.10000000000004], "episode_lengths": [292, 80, 128, 294, 500, 500, 386, 500, 500, 308, 104, 38, 88, 74, 354, 148, 78, 130, 94, 500, 96, 292, 82, 40, 148, 500, 62, 80, 490, 62, 152, 500, 500, 160, 452, 132, 290, 100, 86, 500, 500, 500, 500, 236, 186, 500, 500, 60, 500, 500, 500, 262, 180, 108, 126, 76, 64, 168, 342, 500, 500, 500, 500, 70, 40, 72, 144, 228, 34, 68, 64, 52, 48, 52, 150, 500, 162, 72, 100, 316, 126, 88, 458, 64, 500, 350, 500, 46, 500, 212, 248, 400, 64, 500, 470, 108, 94, 92, 28, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4012384507632656, "mean_inference_ms": 1.2805452485123248, "mean_action_processing_ms": 0.15405742489356256, "mean_env_wait_ms": 0.08837901673473544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02651357650756836, "StateBufferConnector_ms": 0.00815892219543457, "ViewRequirementAgentConnector_ms": 0.13619232177734375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5574.087231110502, "num_env_steps_trained_throughput_per_sec": 5574.087231110502, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3311.406, "sample_time_ms": 2989.236, "load_time_ms": 8.201, "load_throughput": 2194821.559, "learn_time_ms": 301.431, "learn_throughput": 59715.237, "synch_weights_time_ms": 10.782}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 298, "training_iteration": 5, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-18", "timestamp": 1698245658, "time_this_iter_s": 3.233959674835205, "time_total_s": 16.58118176460266, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.58118176460266, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 63.96, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006249999999999998, "cur_lr": 0.0003, "total_loss": 6.8166259235805935, "policy_loss": -0.0005295100725359387, "vf_loss": 6.817204051547581, "vf_explained_var": -2.837181091308594e-06, "kl": 0.0015270820374932252, "entropy": 0.581219744682312, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.37699999999985, "episode_len_mean": 241.96, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 43.7, 44.900000000000006, 45.3, 44.900000000000006, 35.10000000000004, -50.00000000000044, 33.90000000000004, 42.900000000000006, 40.10000000000002, 18.499999999999822, 37.50000000000003, 41.30000000000001, 4.299999999999621, 43.7, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.5, -50.00000000000044, 28.89999999999997, 25.29999999999992, 10.099999999999703, 43.7, -50.00000000000044, 3.0999999999996035, 39.300000000000026, 40.70000000000002, 40.90000000000002, 47.3, 36.10000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 37.300000000000026, 29.099999999999973, 18.29999999999982, 24.69999999999991, 44.10000000000001, -50.00000000000044, 46.099999999999994, 4.699999999999626, -50.00000000000044, 38.10000000000002, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.100000000000016, -50.00000000000044, 46.5, 12.69999999999974, 41.500000000000014, 37.50000000000003, 11.699999999999726, 44.900000000000006, 42.500000000000014, -50.00000000000044, 32.50000000000002, 44.900000000000006, 24.299999999999905, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, 46.099999999999994, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 22.299999999999876, 41.100000000000016, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, 11.899999999999729, -50.00000000000044, 44.5, 41.30000000000001, 32.30000000000002, 45.5, 41.500000000000014, -50.00000000000044, 17.499999999999808, 40.10000000000002, 39.50000000000002, 44.300000000000004, 44.10000000000001, 45.1, -50.00000000000044], "episode_lengths": [68, 64, 52, 48, 52, 150, 500, 162, 72, 100, 316, 126, 88, 458, 64, 500, 350, 500, 46, 500, 212, 248, 400, 64, 500, 470, 108, 94, 92, 28, 140, 206, 500, 500, 500, 158, 128, 210, 318, 254, 60, 500, 40, 454, 500, 120, 500, 186, 500, 500, 500, 44, 90, 500, 36, 374, 86, 126, 384, 52, 76, 500, 176, 52, 258, 56, 500, 500, 500, 86, 76, 40, 500, 72, 98, 500, 278, 90, 138, 500, 80, 500, 500, 98, 88, 382, 500, 56, 88, 178, 46, 86, 500, 326, 100, 106, 58, 60, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398317794045647, "mean_inference_ms": 1.2741102807502704, "mean_action_processing_ms": 0.1523557029870537, "mean_env_wait_ms": 0.08771603662966915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002593994140625, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.12985658645629883}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.37699999999985, "episode_len_mean": 241.96, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 43.7, 44.900000000000006, 45.3, 44.900000000000006, 35.10000000000004, -50.00000000000044, 33.90000000000004, 42.900000000000006, 40.10000000000002, 18.499999999999822, 37.50000000000003, 41.30000000000001, 4.299999999999621, 43.7, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.5, -50.00000000000044, 28.89999999999997, 25.29999999999992, 10.099999999999703, 43.7, -50.00000000000044, 3.0999999999996035, 39.300000000000026, 40.70000000000002, 40.90000000000002, 47.3, 36.10000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 37.300000000000026, 29.099999999999973, 18.29999999999982, 24.69999999999991, 44.10000000000001, -50.00000000000044, 46.099999999999994, 4.699999999999626, -50.00000000000044, 38.10000000000002, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.100000000000016, -50.00000000000044, 46.5, 12.69999999999974, 41.500000000000014, 37.50000000000003, 11.699999999999726, 44.900000000000006, 42.500000000000014, -50.00000000000044, 32.50000000000002, 44.900000000000006, 24.299999999999905, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, 46.099999999999994, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 22.299999999999876, 41.100000000000016, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, 11.899999999999729, -50.00000000000044, 44.5, 41.30000000000001, 32.30000000000002, 45.5, 41.500000000000014, -50.00000000000044, 17.499999999999808, 40.10000000000002, 39.50000000000002, 44.300000000000004, 44.10000000000001, 45.1, -50.00000000000044], "episode_lengths": [68, 64, 52, 48, 52, 150, 500, 162, 72, 100, 316, 126, 88, 458, 64, 500, 350, 500, 46, 500, 212, 248, 400, 64, 500, 470, 108, 94, 92, 28, 140, 206, 500, 500, 500, 158, 128, 210, 318, 254, 60, 500, 40, 454, 500, 120, 500, 186, 500, 500, 500, 44, 90, 500, 36, 374, 86, 126, 384, 52, 76, 500, 176, 52, 258, 56, 500, 500, 500, 86, 76, 40, 500, 72, 98, 500, 278, 90, 138, 500, 80, 500, 500, 98, 88, 382, 500, 56, 88, 178, 46, 86, 500, 326, 100, 106, 58, 60, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.398317794045647, "mean_inference_ms": 1.2741102807502704, "mean_action_processing_ms": 0.1523557029870537, "mean_env_wait_ms": 0.08771603662966915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002593994140625, "StateBufferConnector_ms": 0.009999752044677734, "ViewRequirementAgentConnector_ms": 0.12985658645629883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5618.930012729721, "num_env_steps_trained_throughput_per_sec": 5618.930012729721, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3293.415, "sample_time_ms": 2967.826, "load_time_ms": 8.091, "load_throughput": 2224821.748, "learn_time_ms": 305.38, "learn_throughput": 58942.913, "synch_weights_time_ms": 10.485}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 367, "training_iteration": 6, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-22", "timestamp": 1698245662, "time_this_iter_s": 3.5143916606903076, "time_total_s": 20.09557342529297, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.09557342529297, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 59.160000000000004, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003124999999999999, "cur_lr": 0.0003, "total_loss": 7.0934003935919865, "policy_loss": -0.00025777435965008207, "vf_loss": 7.093712753719753, "vf_explained_var": 9.775161743164062e-07, "kl": 0.0011509203922539907, "entropy": 0.5807618485556708, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.65299999999985, "episode_len_mean": 239.16, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.299999999999876, 41.100000000000016, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, 11.899999999999729, -50.00000000000044, 44.5, 41.30000000000001, 32.30000000000002, 45.5, 41.500000000000014, -50.00000000000044, 17.499999999999808, 40.10000000000002, 39.50000000000002, 44.300000000000004, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 40.70000000000002, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 43.7, -50.00000000000044, 9.8999999999997, 45.9, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.70000000000001, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, 38.90000000000002, 20.899999999999856, 42.70000000000001, 44.7, 40.30000000000002, 35.900000000000034, 37.10000000000003, 46.699999999999996, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.90000000000002, 29.099999999999973, 42.900000000000006, 35.10000000000004, -50.00000000000044, 44.900000000000006, 46.3, 44.5, 45.1, 33.30000000000003, 41.500000000000014, 40.30000000000002, 40.10000000000002, 44.7, -50.00000000000044, 7.499999999999666, 44.7, 43.50000000000001, 45.9, 39.50000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, 19.299999999999834, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.30000000000001, 44.7, 42.900000000000006, 45.3, 44.900000000000006], "episode_lengths": [278, 90, 138, 500, 80, 500, 500, 98, 88, 382, 500, 56, 88, 178, 46, 86, 500, 326, 100, 106, 58, 60, 50, 500, 500, 500, 500, 124, 94, 500, 374, 500, 500, 224, 500, 64, 500, 402, 42, 90, 500, 500, 62, 500, 184, 194, 500, 500, 500, 500, 100, 500, 56, 112, 292, 74, 54, 98, 142, 130, 34, 500, 112, 500, 102, 210, 72, 150, 500, 52, 38, 56, 50, 168, 86, 98, 100, 54, 500, 426, 54, 66, 42, 106, 500, 54, 500, 82, 308, 500, 210, 500, 500, 88, 84, 68, 54, 72, 48, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39559760553175194, "mean_inference_ms": 1.267119860457238, "mean_action_processing_ms": 0.15058459773374103, "mean_env_wait_ms": 0.08679841323875287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001981735229492, "StateBufferConnector_ms": 0.004004716873168945, "ViewRequirementAgentConnector_ms": 0.10979485511779785}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.65299999999985, "episode_len_mean": 239.16, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.299999999999876, 41.100000000000016, 36.30000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, 11.899999999999729, -50.00000000000044, 44.5, 41.30000000000001, 32.30000000000002, 45.5, 41.500000000000014, -50.00000000000044, 17.499999999999808, 40.10000000000002, 39.50000000000002, 44.300000000000004, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 40.70000000000002, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 43.7, -50.00000000000044, 9.8999999999997, 45.9, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 31.70000000000001, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, 38.90000000000002, 20.899999999999856, 42.70000000000001, 44.7, 40.30000000000002, 35.900000000000034, 37.10000000000003, 46.699999999999996, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.90000000000002, 29.099999999999973, 42.900000000000006, 35.10000000000004, -50.00000000000044, 44.900000000000006, 46.3, 44.5, 45.1, 33.30000000000003, 41.500000000000014, 40.30000000000002, 40.10000000000002, 44.7, -50.00000000000044, 7.499999999999666, 44.7, 43.50000000000001, 45.9, 39.50000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, 19.299999999999834, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.30000000000001, 44.7, 42.900000000000006, 45.3, 44.900000000000006], "episode_lengths": [278, 90, 138, 500, 80, 500, 500, 98, 88, 382, 500, 56, 88, 178, 46, 86, 500, 326, 100, 106, 58, 60, 50, 500, 500, 500, 500, 124, 94, 500, 374, 500, 500, 224, 500, 64, 500, 402, 42, 90, 500, 500, 62, 500, 184, 194, 500, 500, 500, 500, 100, 500, 56, 112, 292, 74, 54, 98, 142, 130, 34, 500, 112, 500, 102, 210, 72, 150, 500, 52, 38, 56, 50, 168, 86, 98, 100, 54, 500, 426, 54, 66, 42, 106, 500, 54, 500, 82, 308, 500, 210, 500, 500, 88, 84, 68, 54, 72, 48, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39559760553175194, "mean_inference_ms": 1.267119860457238, "mean_action_processing_ms": 0.15058459773374103, "mean_env_wait_ms": 0.08679841323875287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001981735229492, "StateBufferConnector_ms": 0.004004716873168945, "ViewRequirementAgentConnector_ms": 0.10979485511779785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5547.8046822247015, "num_env_steps_trained_throughput_per_sec": 5547.8046822247015, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3286.431, "sample_time_ms": 2957.299, "load_time_ms": 8.078, "load_throughput": 2228397.541, "learn_time_ms": 309.029, "learn_throughput": 58246.993, "synch_weights_time_ms": 10.52}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 443, "training_iteration": 7, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-25", "timestamp": 1698245665, "time_this_iter_s": 3.250521659851074, "time_total_s": 23.346095085144043, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.346095085144043, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 58.9, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015624999999999994, "cur_lr": 0.0003, "total_loss": 6.8200593418545195, "policy_loss": -0.0006026026275422838, "vf_loss": 6.820718140072293, "vf_explained_var": -1.7762184143066407e-06, "kl": 0.0015556996491246386, "entropy": 0.5867594367927975, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.16999999999986, "episode_len_mean": 229.02, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 44.5, 45.1, 33.30000000000003, 41.500000000000014, 40.30000000000002, 40.10000000000002, 44.7, -50.00000000000044, 7.499999999999666, 44.7, 43.50000000000001, 45.9, 39.50000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, 19.299999999999834, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.30000000000001, 44.7, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 28.29999999999996, 42.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.699999999999612, 11.099999999999717, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.7, -50.00000000000044, 39.300000000000026, 45.3, 32.100000000000016, 40.90000000000002, 39.90000000000002, 25.899999999999928, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.70000000000002, 42.10000000000001, 42.10000000000001, 33.30000000000003, 41.70000000000002, 44.7, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 33.30000000000003, 10.899999999999714, -50.00000000000044, 45.3, 44.10000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 5.299999999999635, 41.70000000000002, 45.1, -50.00000000000044, 43.900000000000006, 41.90000000000001, 21.09999999999986, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.90000000000001, 34.50000000000004, 44.10000000000001, 46.099999999999994, 44.5, 41.100000000000016, 45.9], "episode_lengths": [38, 56, 50, 168, 86, 98, 100, 54, 500, 426, 54, 66, 42, 106, 500, 54, 500, 82, 308, 500, 210, 500, 500, 88, 84, 68, 54, 72, 48, 52, 500, 500, 66, 218, 72, 104, 500, 500, 112, 464, 390, 500, 500, 184, 54, 500, 108, 48, 180, 92, 102, 242, 500, 500, 100, 84, 80, 80, 168, 84, 54, 98, 48, 500, 500, 92, 168, 392, 500, 48, 60, 418, 500, 500, 500, 500, 62, 448, 84, 50, 500, 62, 82, 290, 500, 130, 500, 108, 38, 500, 500, 500, 148, 82, 156, 60, 40, 56, 90, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39536244551316085, "mean_inference_ms": 1.2626955478130146, "mean_action_processing_ms": 0.14993293962385304, "mean_env_wait_ms": 0.08647021432022639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200125694274902, "StateBufferConnector_ms": 0.008507490158081055, "ViewRequirementAgentConnector_ms": 0.12561893463134766}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.16999999999986, "episode_len_mean": 229.02, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 44.5, 45.1, 33.30000000000003, 41.500000000000014, 40.30000000000002, 40.10000000000002, 44.7, -50.00000000000044, 7.499999999999666, 44.7, 43.50000000000001, 45.9, 39.50000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, 19.299999999999834, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.30000000000001, 44.7, 42.900000000000006, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 28.29999999999996, 42.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.699999999999612, 11.099999999999717, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.7, -50.00000000000044, 39.300000000000026, 45.3, 32.100000000000016, 40.90000000000002, 39.90000000000002, 25.899999999999928, -50.00000000000044, -50.00000000000044, 40.10000000000002, 41.70000000000002, 42.10000000000001, 42.10000000000001, 33.30000000000003, 41.70000000000002, 44.7, 40.30000000000002, 45.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 33.30000000000003, 10.899999999999714, -50.00000000000044, 45.3, 44.10000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 5.299999999999635, 41.70000000000002, 45.1, -50.00000000000044, 43.900000000000006, 41.90000000000001, 21.09999999999986, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.90000000000001, 34.50000000000004, 44.10000000000001, 46.099999999999994, 44.5, 41.100000000000016, 45.9], "episode_lengths": [38, 56, 50, 168, 86, 98, 100, 54, 500, 426, 54, 66, 42, 106, 500, 54, 500, 82, 308, 500, 210, 500, 500, 88, 84, 68, 54, 72, 48, 52, 500, 500, 66, 218, 72, 104, 500, 500, 112, 464, 390, 500, 500, 184, 54, 500, 108, 48, 180, 92, 102, 242, 500, 500, 100, 84, 80, 80, 168, 84, 54, 98, 48, 500, 500, 92, 168, 392, 500, 48, 60, 418, 500, 500, 500, 500, 62, 448, 84, 50, 500, 62, 82, 290, 500, 130, 500, 108, 38, 500, 500, 500, 148, 82, 156, 60, 40, 56, 90, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39536244551316085, "mean_inference_ms": 1.2626955478130146, "mean_action_processing_ms": 0.14993293962385304, "mean_env_wait_ms": 0.08647021432022639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200125694274902, "StateBufferConnector_ms": 0.008507490158081055, "ViewRequirementAgentConnector_ms": 0.12561893463134766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5539.860779737666, "num_env_steps_trained_throughput_per_sec": 5539.860779737666, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3281.774, "sample_time_ms": 2950.585, "load_time_ms": 8.067, "load_throughput": 2231218.811, "learn_time_ms": 311.376, "learn_throughput": 57807.906, "synch_weights_time_ms": 10.33}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 513, "training_iteration": 8, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-28", "timestamp": 1698245668, "time_this_iter_s": 3.2551708221435547, "time_total_s": 26.601265907287598, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.601265907287598, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 69.2, "ram_util_percent": 27.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812499999999997, "cur_lr": 0.0003, "total_loss": 7.104931778377956, "policy_loss": -0.0006411986218558417, "vf_loss": 7.105626455942789, "vf_explained_var": -1.3298458523220485e-06, "kl": 0.0017864153696968465, "entropy": 0.5498884307013617, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.913999999999868, "episode_len_mean": 221.58, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 41.90000000000001, 21.09999999999986, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.90000000000001, 34.50000000000004, 44.10000000000001, 46.099999999999994, 44.5, 41.100000000000016, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 12.69999999999974, 45.7, 16.8999999999998, 41.500000000000014, 24.899999999999913, 43.10000000000001, -50.00000000000044, 16.29999999999979, 19.69999999999984, 45.7, 40.10000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, 40.500000000000014, 44.7, 44.10000000000001, 36.10000000000004, -50.00000000000044, 34.900000000000034, 45.9, 44.900000000000006, 20.099999999999845, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, 42.70000000000001, 38.300000000000026, 42.70000000000001, 46.9, 40.90000000000002, 43.7, 30.9, 36.70000000000003, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.7, 35.900000000000034, 46.5, -50.00000000000044, 37.70000000000003, 27.099999999999945, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 32.100000000000016, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.899999999999984, 47.3, 47.3, 16.499999999999794, 35.70000000000003, 45.5, 36.900000000000034, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 33.90000000000004, 33.70000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001], "episode_lengths": [500, 62, 82, 290, 500, 130, 500, 108, 38, 500, 500, 500, 148, 82, 156, 60, 40, 56, 90, 42, 500, 500, 500, 36, 72, 500, 374, 44, 332, 86, 252, 70, 500, 338, 304, 44, 100, 60, 40, 500, 96, 54, 60, 140, 500, 152, 42, 52, 300, 500, 84, 500, 38, 74, 118, 74, 32, 92, 64, 192, 134, 500, 46, 98, 500, 62, 500, 54, 142, 36, 500, 124, 230, 500, 500, 168, 500, 180, 66, 500, 500, 80, 202, 28, 28, 336, 144, 46, 132, 56, 44, 500, 500, 162, 164, 86, 500, 500, 40, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928172640195018, "mean_inference_ms": 1.2622207671616272, "mean_action_processing_ms": 0.1490912584728379, "mean_env_wait_ms": 0.08676915424204253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02289438247680664, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.11848282814025879}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.913999999999868, "episode_len_mean": 221.58, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 41.90000000000001, 21.09999999999986, -50.00000000000044, 37.10000000000003, -50.00000000000044, 39.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 41.90000000000001, 34.50000000000004, 44.10000000000001, 46.099999999999994, 44.5, 41.100000000000016, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 12.69999999999974, 45.7, 16.8999999999998, 41.500000000000014, 24.899999999999913, 43.10000000000001, -50.00000000000044, 16.29999999999979, 19.69999999999984, 45.7, 40.10000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, 40.500000000000014, 44.7, 44.10000000000001, 36.10000000000004, -50.00000000000044, 34.900000000000034, 45.9, 44.900000000000006, 20.099999999999845, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, 42.70000000000001, 38.300000000000026, 42.70000000000001, 46.9, 40.90000000000002, 43.7, 30.9, 36.70000000000003, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.7, 35.900000000000034, 46.5, -50.00000000000044, 37.70000000000003, 27.099999999999945, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 32.100000000000016, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.899999999999984, 47.3, 47.3, 16.499999999999794, 35.70000000000003, 45.5, 36.900000000000034, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 33.90000000000004, 33.70000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001], "episode_lengths": [500, 62, 82, 290, 500, 130, 500, 108, 38, 500, 500, 500, 148, 82, 156, 60, 40, 56, 90, 42, 500, 500, 500, 36, 72, 500, 374, 44, 332, 86, 252, 70, 500, 338, 304, 44, 100, 60, 40, 500, 96, 54, 60, 140, 500, 152, 42, 52, 300, 500, 84, 500, 38, 74, 118, 74, 32, 92, 64, 192, 134, 500, 46, 98, 500, 62, 500, 54, 142, 36, 500, 124, 230, 500, 500, 168, 500, 180, 66, 500, 500, 80, 202, 28, 28, 336, 144, 46, 132, 56, 44, 500, 500, 162, 164, 86, 500, 500, 40, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928172640195018, "mean_inference_ms": 1.2622207671616272, "mean_action_processing_ms": 0.1490912584728379, "mean_env_wait_ms": 0.08676915424204253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02289438247680664, "StateBufferConnector_ms": 0.009998559951782227, "ViewRequirementAgentConnector_ms": 0.11848282814025879}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5518.009889043357, "num_env_steps_trained_throughput_per_sec": 5518.009889043357, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3279.582, "sample_time_ms": 2946.59, "load_time_ms": 8.154, "load_throughput": 2207628.833, "learn_time_ms": 313.168, "learn_throughput": 57477.201, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 593, "training_iteration": 9, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-32", "timestamp": 1698245672, "time_this_iter_s": 3.2670445442199707, "time_total_s": 29.86831045150757, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.86831045150757, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 59.56, "ram_util_percent": 27.679999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062499999999986, "cur_lr": 0.0003, "total_loss": 6.889532936943902, "policy_loss": -0.0001295704808500078, "vf_loss": 6.8897174517313635, "vf_explained_var": -2.602736155192057e-06, "kl": 0.0007607058479000747, "entropy": 0.5522300216886732, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.50499999999986, "episode_len_mean": 230.64, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.899999999999984, 47.3, 47.3, 16.499999999999794, 35.70000000000003, 45.5, 36.900000000000034, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 33.90000000000004, 33.70000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 38.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.3, 38.300000000000026, 26.69999999999994, 32.50000000000002, 42.10000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.900000000000006, 44.900000000000006, 33.500000000000036, 45.9, 45.3, 41.30000000000001, 26.499999999999936, 27.299999999999947, 39.300000000000026, 43.50000000000001, 44.7, 25.29999999999992, 45.3, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.3, 16.8999999999998, -50.00000000000044, 43.10000000000001, 37.50000000000003, 40.70000000000002, 44.10000000000001, 29.299999999999976, 39.50000000000002, 47.3, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 38.700000000000024, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 44.5, 38.300000000000026, 20.299999999999848, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.70000000000002, 39.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 38.300000000000026, 37.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, -50.00000000000044], "episode_lengths": [66, 500, 500, 80, 202, 28, 28, 336, 144, 46, 132, 56, 44, 500, 500, 162, 164, 86, 500, 500, 40, 70, 500, 500, 146, 112, 500, 500, 90, 48, 118, 234, 176, 80, 500, 156, 500, 62, 52, 166, 42, 48, 88, 236, 228, 108, 66, 54, 248, 48, 124, 500, 500, 48, 332, 500, 70, 126, 94, 60, 208, 106, 28, 500, 500, 50, 62, 114, 500, 54, 32, 500, 56, 118, 298, 500, 170, 500, 500, 134, 104, 110, 500, 46, 500, 140, 500, 56, 500, 72, 118, 126, 500, 32, 500, 500, 500, 98, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3906590870163585, "mean_inference_ms": 1.2594292034091976, "mean_action_processing_ms": 0.14788942636077707, "mean_env_wait_ms": 0.0863566666177415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007537841796875, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.13269829750061035}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.50499999999986, "episode_len_mean": 230.64, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.899999999999984, 47.3, 47.3, 16.499999999999794, 35.70000000000003, 45.5, 36.900000000000034, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 33.90000000000004, 33.70000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.500000000000036, 38.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.3, 38.300000000000026, 26.69999999999994, 32.50000000000002, 42.10000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.900000000000006, 44.900000000000006, 33.500000000000036, 45.9, 45.3, 41.30000000000001, 26.499999999999936, 27.299999999999947, 39.300000000000026, 43.50000000000001, 44.7, 25.29999999999992, 45.3, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.3, 16.8999999999998, -50.00000000000044, 43.10000000000001, 37.50000000000003, 40.70000000000002, 44.10000000000001, 29.299999999999976, 39.50000000000002, 47.3, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 38.700000000000024, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 44.5, 38.300000000000026, 20.299999999999848, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.70000000000002, 39.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 38.300000000000026, 37.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, -50.00000000000044], "episode_lengths": [66, 500, 500, 80, 202, 28, 28, 336, 144, 46, 132, 56, 44, 500, 500, 162, 164, 86, 500, 500, 40, 70, 500, 500, 146, 112, 500, 500, 90, 48, 118, 234, 176, 80, 500, 156, 500, 62, 52, 166, 42, 48, 88, 236, 228, 108, 66, 54, 248, 48, 124, 500, 500, 48, 332, 500, 70, 126, 94, 60, 208, 106, 28, 500, 500, 50, 62, 114, 500, 54, 32, 500, 56, 118, 298, 500, 170, 500, 500, 134, 104, 110, 500, 46, 500, 140, 500, 56, 500, 72, 118, 126, 500, 32, 500, 500, 500, 98, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3906590870163585, "mean_inference_ms": 1.2594292034091976, "mean_action_processing_ms": 0.14788942636077707, "mean_env_wait_ms": 0.0863566666177415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007537841796875, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.13269829750061035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5585.006647490095, "num_env_steps_trained_throughput_per_sec": 5585.006647490095, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3273.915, "sample_time_ms": 2936.828, "load_time_ms": 8.989, "load_throughput": 2002373.011, "learn_time_ms": 316.585, "learn_throughput": 56856.701, "synch_weights_time_ms": 10.129}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 671, "training_iteration": 10, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-35", "timestamp": 1698245675, "time_this_iter_s": 3.2281694412231445, "time_total_s": 33.09647989273071, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.09647989273071, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 64.85, "ram_util_percent": 27.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531249999999993, "cur_lr": 0.0003, "total_loss": 7.190165837605794, "policy_loss": -0.0004560853044191996, "vf_loss": 7.1906785329182945, "vf_explained_var": -3.288851843939887e-06, "kl": 0.001505183382023271, "entropy": 0.5700659698910183, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.5839999999998335, "episode_len_mean": 264.82, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 46.9, -50.00000000000044, 44.5, 38.300000000000026, 20.299999999999848, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.70000000000002, 39.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 38.300000000000026, 37.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 44.7, 43.30000000000001, 41.90000000000001, 32.50000000000002, 46.9, 35.900000000000034, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.10000000000001, 30.29999999999999, 32.90000000000003, -50.00000000000044, 46.5, 40.500000000000014, 31.1, -50.00000000000044, 23.8999999999999, -50.00000000000044, 44.300000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.90000000000002, 44.10000000000001, -50.00000000000044, 35.30000000000004, 37.10000000000003, 18.499999999999822, 11.499999999999723, -50.00000000000044, 35.500000000000036, 15.49999999999978, 47.1, 43.30000000000001, 37.10000000000003, 44.300000000000004, 8.49999999999968, 27.699999999999953, -50.00000000000044, 33.10000000000003, -50.00000000000044, 37.50000000000003, 38.300000000000026, 30.099999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.900000000000006, 26.09999999999993, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 16.499999999999794, 45.3, 45.3, 13.499999999999751, 27.899999999999956, -50.00000000000044], "episode_lengths": [54, 32, 500, 56, 118, 298, 500, 170, 500, 500, 134, 104, 110, 500, 46, 500, 140, 500, 56, 500, 72, 118, 126, 500, 32, 500, 500, 500, 98, 88, 500, 500, 500, 500, 430, 54, 68, 82, 176, 32, 142, 140, 500, 500, 142, 70, 198, 172, 500, 36, 96, 190, 500, 262, 500, 58, 112, 500, 500, 158, 92, 60, 500, 148, 130, 316, 386, 500, 146, 346, 30, 68, 130, 58, 416, 224, 500, 170, 500, 126, 118, 200, 500, 52, 500, 500, 126, 500, 62, 240, 500, 290, 500, 58, 336, 48, 48, 366, 222, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39037320727394187, "mean_inference_ms": 1.2542169947780102, "mean_action_processing_ms": 0.14798335557799427, "mean_env_wait_ms": 0.08589014000878187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701949119567871, "StateBufferConnector_ms": 0.007017850875854492, "ViewRequirementAgentConnector_ms": 0.13079309463500977}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.5839999999998335, "episode_len_mean": 264.82, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 46.9, -50.00000000000044, 44.5, 38.300000000000026, 20.299999999999848, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.70000000000002, 39.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 36.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 38.300000000000026, 37.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 44.7, 43.30000000000001, 41.90000000000001, 32.50000000000002, 46.9, 35.900000000000034, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.900000000000034, 43.10000000000001, 30.29999999999999, 32.90000000000003, -50.00000000000044, 46.5, 40.500000000000014, 31.1, -50.00000000000044, 23.8999999999999, -50.00000000000044, 44.300000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 40.90000000000002, 44.10000000000001, -50.00000000000044, 35.30000000000004, 37.10000000000003, 18.499999999999822, 11.499999999999723, -50.00000000000044, 35.500000000000036, 15.49999999999978, 47.1, 43.30000000000001, 37.10000000000003, 44.300000000000004, 8.49999999999968, 27.699999999999953, -50.00000000000044, 33.10000000000003, -50.00000000000044, 37.50000000000003, 38.300000000000026, 30.099999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.900000000000006, 26.09999999999993, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 16.499999999999794, 45.3, 45.3, 13.499999999999751, 27.899999999999956, -50.00000000000044], "episode_lengths": [54, 32, 500, 56, 118, 298, 500, 170, 500, 500, 134, 104, 110, 500, 46, 500, 140, 500, 56, 500, 72, 118, 126, 500, 32, 500, 500, 500, 98, 88, 500, 500, 500, 500, 430, 54, 68, 82, 176, 32, 142, 140, 500, 500, 142, 70, 198, 172, 500, 36, 96, 190, 500, 262, 500, 58, 112, 500, 500, 158, 92, 60, 500, 148, 130, 316, 386, 500, 146, 346, 30, 68, 130, 58, 416, 224, 500, 170, 500, 126, 118, 200, 500, 52, 500, 500, 126, 500, 62, 240, 500, 290, 500, 58, 336, 48, 48, 366, 222, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39037320727394187, "mean_inference_ms": 1.2542169947780102, "mean_action_processing_ms": 0.14798335557799427, "mean_env_wait_ms": 0.08589014000878187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701949119567871, "StateBufferConnector_ms": 0.007017850875854492, "ViewRequirementAgentConnector_ms": 0.13079309463500977}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5587.040119399415, "num_env_steps_trained_throughput_per_sec": 5587.040119399415, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3243.498, "sample_time_ms": 2903.288, "load_time_ms": 8.789, "load_throughput": 2047922.225, "learn_time_ms": 320.579, "learn_throughput": 56148.339, "synch_weights_time_ms": 9.527}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 740, "training_iteration": 11, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-38", "timestamp": 1698245678, "time_this_iter_s": 3.226741075515747, "time_total_s": 36.32322096824646, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.32322096824646, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 27.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765624999999996e-05, "cur_lr": 0.0003, "total_loss": 6.831584040323893, "policy_loss": -0.0005577276978227827, "vf_loss": 6.832195684644911, "vf_explained_var": 1.6927719116210937e-06, "kl": 0.0014559293995060013, "entropy": 0.5401146034399669, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.197999999999825, "episode_len_mean": 268.68, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.499999999999822, 11.499999999999723, -50.00000000000044, 35.500000000000036, 15.49999999999978, 47.1, 43.30000000000001, 37.10000000000003, 44.300000000000004, 8.49999999999968, 27.699999999999953, -50.00000000000044, 33.10000000000003, -50.00000000000044, 37.50000000000003, 38.300000000000026, 30.099999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.900000000000006, 26.09999999999993, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 16.499999999999794, 45.3, 45.3, 13.499999999999751, 27.899999999999956, -50.00000000000044, -50.00000000000044, 34.900000000000034, 46.5, 44.300000000000004, 19.499999999999837, 45.3, 38.10000000000002, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 22.699999999999882, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.7, -50.00000000000044, 8.699999999999683, -50.00000000000044, 37.90000000000003, 41.70000000000002, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, 35.500000000000036, 34.50000000000004, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.9, 37.90000000000003, 39.90000000000002, 45.5, 29.099999999999973, 16.09999999999979, 34.10000000000004, 41.90000000000001, 41.500000000000014, 41.70000000000002, -50.00000000000044, 41.90000000000001, 47.3, -50.00000000000044, 46.9, 17.69999999999981], "episode_lengths": [316, 386, 500, 146, 346, 30, 68, 130, 58, 416, 224, 500, 170, 500, 126, 118, 200, 500, 52, 500, 500, 126, 500, 62, 240, 500, 290, 500, 58, 336, 48, 48, 366, 222, 500, 500, 152, 36, 58, 306, 48, 120, 500, 72, 138, 500, 500, 274, 40, 500, 500, 186, 500, 88, 68, 500, 500, 500, 62, 54, 500, 414, 500, 122, 84, 46, 70, 500, 500, 500, 302, 500, 62, 50, 500, 146, 156, 500, 294, 500, 500, 500, 108, 500, 32, 122, 102, 46, 210, 340, 160, 82, 86, 84, 500, 82, 28, 500, 32, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38926159054436854, "mean_inference_ms": 1.250706020769544, "mean_action_processing_ms": 0.14793783605295382, "mean_env_wait_ms": 0.08600462926770806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032511234283447266, "StateBufferConnector_ms": 0.008019208908081055, "ViewRequirementAgentConnector_ms": 0.1196587085723877}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.197999999999825, "episode_len_mean": 268.68, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.499999999999822, 11.499999999999723, -50.00000000000044, 35.500000000000036, 15.49999999999978, 47.1, 43.30000000000001, 37.10000000000003, 44.300000000000004, 8.49999999999968, 27.699999999999953, -50.00000000000044, 33.10000000000003, -50.00000000000044, 37.50000000000003, 38.300000000000026, 30.099999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.900000000000006, 26.09999999999993, -50.00000000000044, 21.09999999999986, -50.00000000000044, 44.300000000000004, 16.499999999999794, 45.3, 45.3, 13.499999999999751, 27.899999999999956, -50.00000000000044, -50.00000000000044, 34.900000000000034, 46.5, 44.300000000000004, 19.499999999999837, 45.3, 38.10000000000002, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 22.699999999999882, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.7, -50.00000000000044, 8.699999999999683, -50.00000000000044, 37.90000000000003, 41.70000000000002, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 43.900000000000006, 45.1, -50.00000000000044, 35.500000000000036, 34.50000000000004, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.9, 37.90000000000003, 39.90000000000002, 45.5, 29.099999999999973, 16.09999999999979, 34.10000000000004, 41.90000000000001, 41.500000000000014, 41.70000000000002, -50.00000000000044, 41.90000000000001, 47.3, -50.00000000000044, 46.9, 17.69999999999981], "episode_lengths": [316, 386, 500, 146, 346, 30, 68, 130, 58, 416, 224, 500, 170, 500, 126, 118, 200, 500, 52, 500, 500, 126, 500, 62, 240, 500, 290, 500, 58, 336, 48, 48, 366, 222, 500, 500, 152, 36, 58, 306, 48, 120, 500, 72, 138, 500, 500, 274, 40, 500, 500, 186, 500, 88, 68, 500, 500, 500, 62, 54, 500, 414, 500, 122, 84, 46, 70, 500, 500, 500, 302, 500, 62, 50, 500, 146, 156, 500, 294, 500, 500, 500, 108, 500, 32, 122, 102, 46, 210, 340, 160, 82, 86, 84, 500, 82, 28, 500, 32, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38926159054436854, "mean_inference_ms": 1.250706020769544, "mean_action_processing_ms": 0.14793783605295382, "mean_env_wait_ms": 0.08600462926770806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032511234283447266, "StateBufferConnector_ms": 0.008019208908081055, "ViewRequirementAgentConnector_ms": 0.1196587085723877}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5534.966728604163, "num_env_steps_trained_throughput_per_sec": 5534.966728604163, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3237.439, "sample_time_ms": 2890.01, "load_time_ms": 9.39, "load_throughput": 1917026.098, "learn_time_ms": 327.174, "learn_throughput": 55016.621, "synch_weights_time_ms": 9.526}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 805, "training_iteration": 12, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-42", "timestamp": 1698245682, "time_this_iter_s": 3.257301092147827, "time_total_s": 39.58052206039429, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.58052206039429, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.480000000000004, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812499999998e-05, "cur_lr": 0.0003, "total_loss": 6.758088535732693, "policy_loss": -0.00041606235835287307, "vf_loss": 6.758561441633437, "vf_explained_var": -5.430645412868923e-07, "kl": 0.0014840968856898624, "entropy": 0.5681445863511827, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.66699999999984, "episode_len_mean": 248.98, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, 34.50000000000004, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.9, 37.90000000000003, 39.90000000000002, 45.5, 29.099999999999973, 16.09999999999979, 34.10000000000004, 41.90000000000001, 41.500000000000014, 41.70000000000002, -50.00000000000044, 41.90000000000001, 47.3, -50.00000000000044, 46.9, 17.69999999999981, 44.900000000000006, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 46.699999999999996, 42.900000000000006, 45.7, -50.00000000000044, 44.10000000000001, 41.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.30000000000001, 40.30000000000002, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 40.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 38.90000000000002, 42.10000000000001, 21.09999999999986, 41.100000000000016, -50.00000000000044, 42.500000000000014, 43.30000000000001, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 37.70000000000003, 43.30000000000001, 39.300000000000026, -50.00000000000044, 45.9, 33.500000000000036, 38.700000000000024, 39.300000000000026, 45.7, -50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 34.50000000000004, 45.9, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 39.10000000000002, 14.699999999999768, 27.699999999999953, 42.30000000000001, 22.699999999999882, -50.00000000000044], "episode_lengths": [146, 156, 500, 294, 500, 500, 500, 108, 500, 32, 122, 102, 46, 210, 340, 160, 82, 86, 84, 500, 82, 28, 500, 32, 324, 52, 500, 88, 500, 500, 170, 34, 72, 44, 500, 60, 88, 500, 58, 500, 500, 68, 500, 88, 98, 62, 500, 72, 500, 94, 500, 72, 500, 500, 500, 122, 500, 112, 80, 290, 90, 500, 76, 68, 500, 50, 88, 500, 500, 56, 124, 68, 108, 500, 42, 166, 114, 108, 44, 500, 70, 76, 500, 500, 30, 156, 42, 80, 500, 74, 500, 500, 500, 370, 110, 354, 224, 78, 274, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38757559229364447, "mean_inference_ms": 1.2486064948494233, "mean_action_processing_ms": 0.14684328410152298, "mean_env_wait_ms": 0.08528513395180759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270078182220459, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.13555288314819336}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.66699999999984, "episode_len_mean": 248.98, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, 34.50000000000004, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.9, 37.90000000000003, 39.90000000000002, 45.5, 29.099999999999973, 16.09999999999979, 34.10000000000004, 41.90000000000001, 41.500000000000014, 41.70000000000002, -50.00000000000044, 41.90000000000001, 47.3, -50.00000000000044, 46.9, 17.69999999999981, 44.900000000000006, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 46.699999999999996, 42.900000000000006, 45.7, -50.00000000000044, 44.10000000000001, 41.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.30000000000001, 40.30000000000002, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 40.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 38.90000000000002, 42.10000000000001, 21.09999999999986, 41.100000000000016, -50.00000000000044, 42.500000000000014, 43.30000000000001, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 37.70000000000003, 43.30000000000001, 39.300000000000026, -50.00000000000044, 45.9, 33.500000000000036, 38.700000000000024, 39.300000000000026, 45.7, -50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 34.50000000000004, 45.9, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 39.10000000000002, 14.699999999999768, 27.699999999999953, 42.30000000000001, 22.699999999999882, -50.00000000000044], "episode_lengths": [146, 156, 500, 294, 500, 500, 500, 108, 500, 32, 122, 102, 46, 210, 340, 160, 82, 86, 84, 500, 82, 28, 500, 32, 324, 52, 500, 88, 500, 500, 170, 34, 72, 44, 500, 60, 88, 500, 58, 500, 500, 68, 500, 88, 98, 62, 500, 72, 500, 94, 500, 72, 500, 500, 500, 122, 500, 112, 80, 290, 90, 500, 76, 68, 500, 50, 88, 500, 500, 56, 124, 68, 108, 500, 42, 166, 114, 108, 44, 500, 70, 76, 500, 500, 30, 156, 42, 80, 500, 74, 500, 500, 500, 370, 110, 354, 224, 78, 274, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38757559229364447, "mean_inference_ms": 1.2486064948494233, "mean_action_processing_ms": 0.14684328410152298, "mean_env_wait_ms": 0.08528513395180759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270078182220459, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.13555288314819336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5679.611775380458, "num_env_steps_trained_throughput_per_sec": 5679.611775380458, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3230.18, "sample_time_ms": 2879.2, "load_time_ms": 9.49, "load_throughput": 1896821.323, "learn_time_ms": 330.648, "learn_throughput": 54438.523, "synch_weights_time_ms": 9.583}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 880, "training_iteration": 13, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-45", "timestamp": 1698245685, "time_this_iter_s": 3.1750001907348633, "time_total_s": 42.75552225112915, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.75552225112915, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 67.275, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.441406249999999e-05, "cur_lr": 0.0003, "total_loss": 6.866367064581977, "policy_loss": -0.0005261221693621741, "vf_loss": 6.866949017842611, "vf_explained_var": -1.7258856031629774e-06, "kl": 0.0012117916439819965, "entropy": 0.5584663622909122, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.675999999999858, "episode_len_mean": 233.94, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 34.50000000000004, 45.9, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 39.10000000000002, 14.699999999999768, 27.699999999999953, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.099999999999994, 43.900000000000006, -50.00000000000044, 34.10000000000004, 27.899999999999956, 34.50000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, 35.900000000000034, 20.299999999999848, -50.00000000000044, 40.70000000000002, 30.499999999999993, 45.1, 38.700000000000024, 45.7, 42.10000000000001, 40.500000000000014, 38.90000000000002, -50.00000000000044, 31.300000000000004, 37.300000000000026, 46.5, 35.10000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 7.899999999999672, -50.00000000000044, 28.29999999999996, 43.50000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.700000000000024, 22.299999999999876, 36.50000000000003, 44.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.30000000000004, 26.09999999999993, 45.5, 44.900000000000006, 45.5, 45.7, 40.90000000000002, -50.00000000000044, 44.7, 44.7, 42.500000000000014, 39.50000000000002, 40.70000000000002, 46.9, 27.49999999999995, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.90000000000002, 40.10000000000002, 46.099999999999994], "episode_lengths": [500, 70, 76, 500, 500, 30, 156, 42, 80, 500, 74, 500, 500, 500, 370, 110, 354, 224, 78, 274, 500, 500, 500, 70, 40, 62, 500, 160, 222, 156, 140, 500, 500, 36, 84, 142, 298, 500, 94, 196, 50, 114, 44, 80, 96, 112, 500, 188, 128, 36, 150, 40, 500, 500, 114, 500, 80, 500, 52, 500, 422, 500, 218, 66, 500, 130, 500, 114, 278, 136, 52, 254, 500, 500, 500, 62, 52, 148, 240, 46, 52, 46, 44, 92, 500, 54, 54, 76, 106, 94, 32, 226, 86, 500, 500, 60, 500, 92, 100, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38660412139717126, "mean_inference_ms": 1.245646547145128, "mean_action_processing_ms": 0.14618088542224938, "mean_env_wait_ms": 0.08507793226352531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027371883392333984, "StateBufferConnector_ms": 0.005018711090087891, "ViewRequirementAgentConnector_ms": 0.11795306205749512}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.675999999999858, "episode_len_mean": 233.94, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.1, 34.50000000000004, 45.9, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, 39.10000000000002, 14.699999999999768, 27.699999999999953, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.099999999999994, 43.900000000000006, -50.00000000000044, 34.10000000000004, 27.899999999999956, 34.50000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, 35.900000000000034, 20.299999999999848, -50.00000000000044, 40.70000000000002, 30.499999999999993, 45.1, 38.700000000000024, 45.7, 42.10000000000001, 40.500000000000014, 38.90000000000002, -50.00000000000044, 31.300000000000004, 37.300000000000026, 46.5, 35.10000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 7.899999999999672, -50.00000000000044, 28.29999999999996, 43.50000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.700000000000024, 22.299999999999876, 36.50000000000003, 44.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.30000000000004, 26.09999999999993, 45.5, 44.900000000000006, 45.5, 45.7, 40.90000000000002, -50.00000000000044, 44.7, 44.7, 42.500000000000014, 39.50000000000002, 40.70000000000002, 46.9, 27.49999999999995, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.90000000000002, 40.10000000000002, 46.099999999999994], "episode_lengths": [500, 70, 76, 500, 500, 30, 156, 42, 80, 500, 74, 500, 500, 500, 370, 110, 354, 224, 78, 274, 500, 500, 500, 70, 40, 62, 500, 160, 222, 156, 140, 500, 500, 36, 84, 142, 298, 500, 94, 196, 50, 114, 44, 80, 96, 112, 500, 188, 128, 36, 150, 40, 500, 500, 114, 500, 80, 500, 52, 500, 422, 500, 218, 66, 500, 130, 500, 114, 278, 136, 52, 254, 500, 500, 500, 62, 52, 148, 240, 46, 52, 46, 44, 92, 500, 54, 54, 76, 106, 94, 32, 226, 86, 500, 500, 60, 500, 92, 100, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38660412139717126, "mean_inference_ms": 1.245646547145128, "mean_action_processing_ms": 0.14618088542224938, "mean_env_wait_ms": 0.08507793226352531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027371883392333984, "StateBufferConnector_ms": 0.005018711090087891, "ViewRequirementAgentConnector_ms": 0.11795306205749512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5606.615820260879, "num_env_steps_trained_throughput_per_sec": 5606.615820260879, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3226.487, "sample_time_ms": 2873.995, "load_time_ms": 9.968, "load_throughput": 1805718.987, "learn_time_ms": 331.895, "learn_throughput": 54234.056, "synch_weights_time_ms": 9.412}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 959, "training_iteration": 14, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-48", "timestamp": 1698245688, "time_this_iter_s": 3.2154834270477295, "time_total_s": 45.97100567817688, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.97100567817688, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 55.68000000000001, "ram_util_percent": 27.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031249999996e-05, "cur_lr": 0.0003, "total_loss": 6.847300879160563, "policy_loss": -0.00028532889361182847, "vf_loss": 6.847642993927002, "vf_explained_var": -7.616149054633247e-07, "kl": 0.0009803435789712644, "entropy": 0.5677685691250696, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.614999999999837, "episode_len_mean": 249.52, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.700000000000024, 22.299999999999876, 36.50000000000003, 44.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.30000000000004, 26.09999999999993, 45.5, 44.900000000000006, 45.5, 45.7, 40.90000000000002, -50.00000000000044, 44.7, 44.7, 42.500000000000014, 39.50000000000002, 40.70000000000002, 46.9, 27.49999999999995, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.90000000000002, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.5, 37.90000000000003, 37.70000000000003, -50.00000000000044, 14.699999999999768, 45.7, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 23.29999999999989, 34.50000000000004, 36.30000000000003, 45.3, 38.90000000000002, 40.70000000000002, 44.7, -50.00000000000044, 40.90000000000002, 3.0999999999996035, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 41.90000000000001, 33.70000000000004, 38.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 30.9, 42.500000000000014, -50.00000000000044, 28.499999999999964, 46.3, -50.00000000000044, 46.099999999999994, 21.299999999999862, -50.00000000000044], "episode_lengths": [66, 500, 130, 500, 114, 278, 136, 52, 254, 500, 500, 500, 62, 52, 148, 240, 46, 52, 46, 44, 92, 500, 54, 54, 76, 106, 94, 32, 226, 86, 500, 500, 60, 500, 92, 100, 40, 500, 500, 44, 500, 48, 500, 52, 46, 64, 500, 500, 464, 500, 500, 50, 96, 500, 500, 398, 46, 122, 124, 500, 354, 44, 38, 80, 500, 500, 500, 84, 268, 156, 138, 48, 112, 94, 54, 500, 92, 470, 70, 500, 500, 500, 440, 82, 164, 112, 62, 500, 500, 254, 500, 192, 76, 500, 216, 38, 500, 40, 288, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869031926298001, "mean_inference_ms": 1.2438452507984146, "mean_action_processing_ms": 0.14600758592732566, "mean_env_wait_ms": 0.08474162729839638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033022165298461914, "StateBufferConnector_ms": 0.010999917984008789, "ViewRequirementAgentConnector_ms": 0.110565185546875}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.614999999999837, "episode_len_mean": 249.52, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 37.10000000000003, -50.00000000000044, 38.700000000000024, 22.299999999999876, 36.50000000000003, 44.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.900000000000006, 35.30000000000004, 26.09999999999993, 45.5, 44.900000000000006, 45.5, 45.7, 40.90000000000002, -50.00000000000044, 44.7, 44.7, 42.500000000000014, 39.50000000000002, 40.70000000000002, 46.9, 27.49999999999995, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.90000000000002, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, -50.00000000000044, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.5, 37.90000000000003, 37.70000000000003, -50.00000000000044, 14.699999999999768, 45.7, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 23.29999999999989, 34.50000000000004, 36.30000000000003, 45.3, 38.90000000000002, 40.70000000000002, 44.7, -50.00000000000044, 40.90000000000002, 3.0999999999996035, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 41.90000000000001, 33.70000000000004, 38.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 30.9, 42.500000000000014, -50.00000000000044, 28.499999999999964, 46.3, -50.00000000000044, 46.099999999999994, 21.299999999999862, -50.00000000000044], "episode_lengths": [66, 500, 130, 500, 114, 278, 136, 52, 254, 500, 500, 500, 62, 52, 148, 240, 46, 52, 46, 44, 92, 500, 54, 54, 76, 106, 94, 32, 226, 86, 500, 500, 60, 500, 92, 100, 40, 500, 500, 44, 500, 48, 500, 52, 46, 64, 500, 500, 464, 500, 500, 50, 96, 500, 500, 398, 46, 122, 124, 500, 354, 44, 38, 80, 500, 500, 500, 84, 268, 156, 138, 48, 112, 94, 54, 500, 92, 470, 70, 500, 500, 500, 440, 82, 164, 112, 62, 500, 500, 254, 500, 192, 76, 500, 216, 38, 500, 40, 288, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869031926298001, "mean_inference_ms": 1.2438452507984146, "mean_action_processing_ms": 0.14600758592732566, "mean_env_wait_ms": 0.08474162729839638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033022165298461914, "StateBufferConnector_ms": 0.010999917984008789, "ViewRequirementAgentConnector_ms": 0.110565185546875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5599.645882854155, "num_env_steps_trained_throughput_per_sec": 5599.645882854155, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3225.013, "sample_time_ms": 2869.039, "load_time_ms": 10.068, "load_throughput": 1787798.33, "learn_time_ms": 335.404, "learn_throughput": 53666.602, "synch_weights_time_ms": 9.412}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 1022, "training_iteration": 15, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-51", "timestamp": 1698245691, "time_this_iter_s": 3.2195937633514404, "time_total_s": 49.19059944152832, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.19059944152832, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 67.725, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515624999998e-06, "cur_lr": 0.0003, "total_loss": 6.485892878638373, "policy_loss": -0.00017689582374360826, "vf_loss": 6.4861231909857855, "vf_explained_var": 7.775094774034288e-07, "kl": 0.0011163344435923743, "entropy": 0.5323278274801042, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.165999999999806, "episode_len_mean": 278.94, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 23.29999999999989, 34.50000000000004, 36.30000000000003, 45.3, 38.90000000000002, 40.70000000000002, 44.7, -50.00000000000044, 40.90000000000002, 3.0999999999996035, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 41.90000000000001, 33.70000000000004, 38.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 30.9, 42.500000000000014, -50.00000000000044, 28.499999999999964, 46.3, -50.00000000000044, 46.099999999999994, 21.299999999999862, -50.00000000000044, 43.10000000000001, 17.299999999999805, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, 39.70000000000002, 20.299999999999848, 43.7, 38.90000000000002, -50.00000000000044, 43.900000000000006, 42.30000000000001, -50.00000000000044, 46.3, 34.50000000000004, -50.00000000000044, 27.699999999999953, 44.10000000000001, 39.90000000000002, -50.00000000000044, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, 22.299999999999876, 35.70000000000003, -50.00000000000044, 12.499999999999737, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 15.899999999999785, 43.50000000000001, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044], "episode_lengths": [80, 500, 500, 500, 84, 268, 156, 138, 48, 112, 94, 54, 500, 92, 470, 70, 500, 500, 500, 440, 82, 164, 112, 62, 500, 500, 254, 500, 192, 76, 500, 216, 38, 500, 40, 288, 500, 70, 328, 500, 34, 500, 500, 50, 104, 298, 64, 112, 500, 62, 78, 500, 38, 156, 500, 224, 60, 102, 500, 52, 52, 500, 500, 60, 122, 500, 500, 500, 500, 62, 500, 42, 40, 278, 144, 500, 376, 300, 500, 500, 500, 500, 38, 80, 500, 500, 56, 500, 84, 500, 500, 90, 342, 66, 60, 46, 500, 500, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864181711260152, "mean_inference_ms": 1.2416783382027474, "mean_action_processing_ms": 0.14513753666166795, "mean_env_wait_ms": 0.08474874336307149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028312206268310547, "StateBufferConnector_ms": 0.0070459842681884766, "ViewRequirementAgentConnector_ms": 0.11071968078613281}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.165999999999806, "episode_len_mean": 278.94, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 23.29999999999989, 34.50000000000004, 36.30000000000003, 45.3, 38.90000000000002, 40.70000000000002, 44.7, -50.00000000000044, 40.90000000000002, 3.0999999999996035, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 41.90000000000001, 33.70000000000004, 38.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 30.9, 42.500000000000014, -50.00000000000044, 28.499999999999964, 46.3, -50.00000000000044, 46.099999999999994, 21.299999999999862, -50.00000000000044, 43.10000000000001, 17.299999999999805, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, 39.70000000000002, 20.299999999999848, 43.7, 38.90000000000002, -50.00000000000044, 43.900000000000006, 42.30000000000001, -50.00000000000044, 46.3, 34.50000000000004, -50.00000000000044, 27.699999999999953, 44.10000000000001, 39.90000000000002, -50.00000000000044, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, 22.299999999999876, 35.70000000000003, -50.00000000000044, 12.499999999999737, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 15.899999999999785, 43.50000000000001, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044], "episode_lengths": [80, 500, 500, 500, 84, 268, 156, 138, 48, 112, 94, 54, 500, 92, 470, 70, 500, 500, 500, 440, 82, 164, 112, 62, 500, 500, 254, 500, 192, 76, 500, 216, 38, 500, 40, 288, 500, 70, 328, 500, 34, 500, 500, 50, 104, 298, 64, 112, 500, 62, 78, 500, 38, 156, 500, 224, 60, 102, 500, 52, 52, 500, 500, 60, 122, 500, 500, 500, 500, 62, 500, 42, 40, 278, 144, 500, 376, 300, 500, 500, 500, 500, 38, 80, 500, 500, 56, 500, 84, 500, 500, 90, 342, 66, 60, 46, 500, 500, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864181711260152, "mean_inference_ms": 1.2416783382027474, "mean_action_processing_ms": 0.14513753666166795, "mean_env_wait_ms": 0.08474874336307149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028312206268310547, "StateBufferConnector_ms": 0.0070459842681884766, "ViewRequirementAgentConnector_ms": 0.11071968078613281}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5671.765942797386, "num_env_steps_trained_throughput_per_sec": 5671.765942797386, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3222.029, "sample_time_ms": 2866.189, "load_time_ms": 10.115, "load_throughput": 1779622.802, "learn_time_ms": 335.145, "learn_throughput": 53708.028, "synch_weights_time_ms": 9.491}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1085, "training_iteration": 16, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-54", "timestamp": 1698245694, "time_this_iter_s": 3.1787731647491455, "time_total_s": 52.369372606277466, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 52.369372606277466, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.08, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812499999e-06, "cur_lr": 0.0003, "total_loss": 7.1257103390163845, "policy_loss": -0.0003651690151956346, "vf_loss": 7.126133219401042, "vf_explained_var": -2.1855036417643228e-07, "kl": 0.0010885182234286756, "entropy": 0.5775596843825446, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.507999999999852, "episode_len_mean": 235.6, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 15.899999999999785, 43.50000000000001, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 38.10000000000002, 45.9, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, 39.50000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.900000000000006, 42.10000000000001, 31.70000000000001, 46.3, 25.099999999999916, 40.10000000000002, 45.9, -50.00000000000044, 44.7, 7.699999999999669, 43.50000000000001, 43.50000000000001, -50.00000000000044, 45.1, 45.3, 42.500000000000014, 3.899999999999615, 46.5, 26.499999999999936, -50.00000000000044, 38.300000000000026, 37.300000000000026, 40.30000000000002, 43.50000000000001, 44.5, 43.50000000000001, 40.90000000000002, 44.10000000000001, 24.69999999999991, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.90000000000002, 42.900000000000006, 29.899999999999984, 41.100000000000016, 45.3, 26.09999999999993, 38.10000000000002, 43.10000000000001, -50.00000000000044, 24.899999999999913, 37.90000000000003, 44.7, 43.50000000000001], "episode_lengths": [56, 500, 84, 500, 500, 90, 342, 66, 60, 46, 500, 500, 94, 500, 500, 46, 62, 120, 42, 200, 500, 50, 500, 88, 106, 500, 84, 500, 220, 500, 90, 500, 500, 88, 500, 72, 80, 184, 38, 250, 100, 42, 500, 54, 424, 66, 66, 500, 50, 48, 76, 462, 36, 236, 500, 118, 128, 98, 66, 56, 66, 92, 60, 254, 500, 36, 500, 500, 48, 70, 78, 500, 500, 500, 500, 94, 104, 500, 140, 500, 62, 500, 172, 500, 500, 500, 62, 102, 72, 202, 90, 48, 240, 120, 70, 500, 252, 122, 54, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858772927160987, "mean_inference_ms": 1.238552279539561, "mean_action_processing_ms": 0.14453828690481113, "mean_env_wait_ms": 0.08417596798533271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03507876396179199, "StateBufferConnector_ms": 0.0035359859466552734, "ViewRequirementAgentConnector_ms": 0.11890411376953125}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.507999999999852, "episode_len_mean": 235.6, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 15.899999999999785, 43.50000000000001, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.5, 43.900000000000006, 38.10000000000002, 45.9, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, 39.50000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 28.09999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.900000000000006, 42.10000000000001, 31.70000000000001, 46.3, 25.099999999999916, 40.10000000000002, 45.9, -50.00000000000044, 44.7, 7.699999999999669, 43.50000000000001, 43.50000000000001, -50.00000000000044, 45.1, 45.3, 42.500000000000014, 3.899999999999615, 46.5, 26.499999999999936, -50.00000000000044, 38.300000000000026, 37.300000000000026, 40.30000000000002, 43.50000000000001, 44.5, 43.50000000000001, 40.90000000000002, 44.10000000000001, 24.69999999999991, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 43.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.90000000000002, 42.900000000000006, 29.899999999999984, 41.100000000000016, 45.3, 26.09999999999993, 38.10000000000002, 43.10000000000001, -50.00000000000044, 24.899999999999913, 37.90000000000003, 44.7, 43.50000000000001], "episode_lengths": [56, 500, 84, 500, 500, 90, 342, 66, 60, 46, 500, 500, 94, 500, 500, 46, 62, 120, 42, 200, 500, 50, 500, 88, 106, 500, 84, 500, 220, 500, 90, 500, 500, 88, 500, 72, 80, 184, 38, 250, 100, 42, 500, 54, 424, 66, 66, 500, 50, 48, 76, 462, 36, 236, 500, 118, 128, 98, 66, 56, 66, 92, 60, 254, 500, 36, 500, 500, 48, 70, 78, 500, 500, 500, 500, 94, 104, 500, 140, 500, 62, 500, 172, 500, 500, 500, 62, 102, 72, 202, 90, 48, 240, 120, 70, 500, 252, 122, 54, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858772927160987, "mean_inference_ms": 1.238552279539561, "mean_action_processing_ms": 0.14453828690481113, "mean_env_wait_ms": 0.08417596798533271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03507876396179199, "StateBufferConnector_ms": 0.0035359859466552734, "ViewRequirementAgentConnector_ms": 0.11890411376953125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5683.89327956115, "num_env_steps_trained_throughput_per_sec": 5683.89327956115, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3214.26, "sample_time_ms": 2858.943, "load_time_ms": 10.288, "load_throughput": 1749534.145, "learn_time_ms": 334.409, "learn_throughput": 53826.314, "synch_weights_time_ms": 9.418}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1171, "training_iteration": 17, "trial_id": "9f288_00005", "date": "2023-10-25_15-54-58", "timestamp": 1698245698, "time_this_iter_s": 3.171841859817505, "time_total_s": 55.54121446609497, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.54121446609497, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 65.5, "ram_util_percent": 27.450000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062499994e-06, "cur_lr": 0.0003, "total_loss": 7.0425319777594675, "policy_loss": -0.0004613954780830277, "vf_loss": 7.043051571316189, "vf_explained_var": -1.9696023729112413e-06, "kl": 0.001206733246684482, "entropy": 0.5810335364606646, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.891999999999852, "episode_len_mean": 241.8, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.90000000000002, 42.900000000000006, 29.899999999999984, 41.100000000000016, 45.3, 26.09999999999993, 38.10000000000002, 43.10000000000001, -50.00000000000044, 24.899999999999913, 37.90000000000003, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 29.099999999999973, 35.10000000000004, 25.499999999999922, -50.00000000000044, 41.90000000000001, 44.7, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, 1.8999999999995865, 44.5, -50.00000000000044, 44.300000000000004, 6.499999999999652, 46.9, 32.30000000000002, 44.5, 19.299999999999834, 43.900000000000006, 42.500000000000014, 39.10000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 35.30000000000004, 12.499999999999737, 42.500000000000014, 44.7, 22.099999999999874, 25.699999999999925, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, -50.00000000000044, 43.900000000000006, 38.700000000000024, 37.10000000000003, 29.099999999999973, 42.70000000000001, 42.10000000000001, 23.29999999999989, 39.70000000000002, -50.00000000000044, 43.900000000000006, 15.699999999999783, 44.300000000000004, 44.7, -50.00000000000044, 45.3, 20.699999999999854, 29.899999999999984, 27.699999999999953, 12.499999999999737, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044], "episode_lengths": [500, 500, 500, 94, 104, 500, 140, 500, 62, 500, 172, 500, 500, 500, 62, 102, 72, 202, 90, 48, 240, 120, 70, 500, 252, 122, 54, 66, 500, 500, 500, 368, 500, 500, 38, 102, 210, 150, 246, 500, 82, 54, 82, 500, 38, 500, 482, 56, 500, 58, 436, 32, 178, 56, 308, 62, 76, 110, 142, 500, 500, 32, 68, 148, 376, 76, 54, 280, 244, 62, 500, 52, 500, 500, 56, 128, 500, 62, 114, 130, 210, 74, 80, 268, 104, 500, 62, 344, 58, 54, 500, 48, 294, 202, 224, 376, 64, 90, 308, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385507254916763, "mean_inference_ms": 1.2371305915294488, "mean_action_processing_ms": 0.1447700871602983, "mean_env_wait_ms": 0.0840074716529839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900385856628418, "StateBufferConnector_ms": 0.00551152229309082, "ViewRequirementAgentConnector_ms": 0.12424397468566895}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.891999999999852, "episode_len_mean": 241.8, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.90000000000002, 42.900000000000006, 29.899999999999984, 41.100000000000016, 45.3, 26.09999999999993, 38.10000000000002, 43.10000000000001, -50.00000000000044, 24.899999999999913, 37.90000000000003, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 29.099999999999973, 35.10000000000004, 25.499999999999922, -50.00000000000044, 41.90000000000001, 44.7, 41.90000000000001, -50.00000000000044, 46.3, -50.00000000000044, 1.8999999999995865, 44.5, -50.00000000000044, 44.300000000000004, 6.499999999999652, 46.9, 32.30000000000002, 44.5, 19.299999999999834, 43.900000000000006, 42.500000000000014, 39.10000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 35.30000000000004, 12.499999999999737, 42.500000000000014, 44.7, 22.099999999999874, 25.699999999999925, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, -50.00000000000044, 43.900000000000006, 38.700000000000024, 37.10000000000003, 29.099999999999973, 42.70000000000001, 42.10000000000001, 23.29999999999989, 39.70000000000002, -50.00000000000044, 43.900000000000006, 15.699999999999783, 44.300000000000004, 44.7, -50.00000000000044, 45.3, 20.699999999999854, 29.899999999999984, 27.699999999999953, 12.499999999999737, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044], "episode_lengths": [500, 500, 500, 94, 104, 500, 140, 500, 62, 500, 172, 500, 500, 500, 62, 102, 72, 202, 90, 48, 240, 120, 70, 500, 252, 122, 54, 66, 500, 500, 500, 368, 500, 500, 38, 102, 210, 150, 246, 500, 82, 54, 82, 500, 38, 500, 482, 56, 500, 58, 436, 32, 178, 56, 308, 62, 76, 110, 142, 500, 500, 32, 68, 148, 376, 76, 54, 280, 244, 62, 500, 52, 500, 500, 56, 128, 500, 62, 114, 130, 210, 74, 80, 268, 104, 500, 62, 344, 58, 54, 500, 48, 294, 202, 224, 376, 64, 90, 308, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385507254916763, "mean_inference_ms": 1.2371305915294488, "mean_action_processing_ms": 0.1447700871602983, "mean_env_wait_ms": 0.0840074716529839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900385856628418, "StateBufferConnector_ms": 0.00551152229309082, "ViewRequirementAgentConnector_ms": 0.12424397468566895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5619.883232036819, "num_env_steps_trained_throughput_per_sec": 5619.883232036819, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3209.634, "sample_time_ms": 2854.412, "load_time_ms": 10.289, "load_throughput": 1749469.279, "learn_time_ms": 334.256, "learn_throughput": 53851.013, "synch_weights_time_ms": 9.455}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1243, "training_iteration": 18, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-01", "timestamp": 1698245701, "time_this_iter_s": 3.2079195976257324, "time_total_s": 58.7491340637207, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.7491340637207, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.42, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531249997e-07, "cur_lr": 0.0003, "total_loss": 7.30753263897366, "policy_loss": -0.0006139112015565236, "vf_loss": 7.308208825853136, "vf_explained_var": -3.536542256673177e-07, "kl": 0.0016263312585023313, "entropy": 0.6214417272143894, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.48699999999989, "episode_len_mean": 220.92, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.10000000000003, 29.099999999999973, 42.70000000000001, 42.10000000000001, 23.29999999999989, 39.70000000000002, -50.00000000000044, 43.900000000000006, 15.699999999999783, 44.300000000000004, 44.7, -50.00000000000044, 45.3, 20.699999999999854, 29.899999999999984, 27.699999999999953, 12.499999999999737, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044, 30.499999999999993, 42.30000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 41.70000000000002, 35.10000000000004, 35.500000000000036, -50.00000000000044, 22.299999999999876, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 22.299999999999876, -50.00000000000044, -50.00000000000044, 37.90000000000003, 25.29999999999992, 44.7, 31.70000000000001, 33.70000000000004, 45.7, 28.89999999999997, 35.500000000000036, 30.499999999999993, 32.700000000000024, 28.09999999999996, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.70000000000002, 39.90000000000002, 24.899999999999913, 41.30000000000001, 43.10000000000001, 37.10000000000003, -50.00000000000044, 38.300000000000026, 38.50000000000003, 44.5, 40.30000000000002, 45.3, -50.00000000000044, 41.500000000000014, 27.49999999999995, 38.50000000000003, 45.5, 34.30000000000004, 42.10000000000001, 31.70000000000001, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 31.500000000000007, 45.7, 2.0999999999995893, 20.899999999999856, 37.10000000000003, -50.00000000000044, 37.10000000000003, -50.00000000000044, 16.699999999999797, 42.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, 44.10000000000001, 42.500000000000014, -50.00000000000044, 38.90000000000002, 43.30000000000001, 17.69999999999981, 43.50000000000001, 33.90000000000004], "episode_lengths": [130, 210, 74, 80, 268, 104, 500, 62, 344, 58, 54, 500, 48, 294, 202, 224, 376, 64, 90, 308, 500, 196, 78, 500, 68, 82, 84, 150, 146, 500, 278, 500, 168, 500, 500, 40, 278, 500, 500, 122, 248, 54, 184, 164, 44, 212, 146, 196, 174, 220, 500, 138, 500, 104, 102, 252, 88, 70, 130, 500, 118, 116, 56, 98, 48, 500, 86, 226, 116, 46, 158, 80, 184, 160, 72, 500, 500, 500, 174, 186, 44, 480, 292, 130, 500, 130, 500, 334, 76, 50, 500, 58, 60, 76, 500, 112, 68, 324, 66, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38474354504308167, "mean_inference_ms": 1.2356200103433406, "mean_action_processing_ms": 0.14448276866302426, "mean_env_wait_ms": 0.08392632200973768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03202342987060547, "StateBufferConnector_ms": 0.004508495330810547, "ViewRequirementAgentConnector_ms": 0.13639569282531738}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.48699999999989, "episode_len_mean": 220.92, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.10000000000003, 29.099999999999973, 42.70000000000001, 42.10000000000001, 23.29999999999989, 39.70000000000002, -50.00000000000044, 43.900000000000006, 15.699999999999783, 44.300000000000004, 44.7, -50.00000000000044, 45.3, 20.699999999999854, 29.899999999999984, 27.699999999999953, 12.499999999999737, 43.7, 41.100000000000016, 19.299999999999834, -50.00000000000044, 30.499999999999993, 42.30000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 41.70000000000002, 35.10000000000004, 35.500000000000036, -50.00000000000044, 22.299999999999876, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 22.299999999999876, -50.00000000000044, -50.00000000000044, 37.90000000000003, 25.29999999999992, 44.7, 31.70000000000001, 33.70000000000004, 45.7, 28.89999999999997, 35.500000000000036, 30.499999999999993, 32.700000000000024, 28.09999999999996, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.70000000000002, 39.90000000000002, 24.899999999999913, 41.30000000000001, 43.10000000000001, 37.10000000000003, -50.00000000000044, 38.300000000000026, 38.50000000000003, 44.5, 40.30000000000002, 45.3, -50.00000000000044, 41.500000000000014, 27.49999999999995, 38.50000000000003, 45.5, 34.30000000000004, 42.10000000000001, 31.70000000000001, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 31.500000000000007, 45.7, 2.0999999999995893, 20.899999999999856, 37.10000000000003, -50.00000000000044, 37.10000000000003, -50.00000000000044, 16.699999999999797, 42.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, 44.10000000000001, 42.500000000000014, -50.00000000000044, 38.90000000000002, 43.30000000000001, 17.69999999999981, 43.50000000000001, 33.90000000000004], "episode_lengths": [130, 210, 74, 80, 268, 104, 500, 62, 344, 58, 54, 500, 48, 294, 202, 224, 376, 64, 90, 308, 500, 196, 78, 500, 68, 82, 84, 150, 146, 500, 278, 500, 168, 500, 500, 40, 278, 500, 500, 122, 248, 54, 184, 164, 44, 212, 146, 196, 174, 220, 500, 138, 500, 104, 102, 252, 88, 70, 130, 500, 118, 116, 56, 98, 48, 500, 86, 226, 116, 46, 158, 80, 184, 160, 72, 500, 500, 500, 174, 186, 44, 480, 292, 130, 500, 130, 500, 334, 76, 50, 500, 58, 60, 76, 500, 112, 68, 324, 66, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38474354504308167, "mean_inference_ms": 1.2356200103433406, "mean_action_processing_ms": 0.14448276866302426, "mean_env_wait_ms": 0.08392632200973768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03202342987060547, "StateBufferConnector_ms": 0.004508495330810547, "ViewRequirementAgentConnector_ms": 0.13639569282531738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5560.731407237708, "num_env_steps_trained_throughput_per_sec": 5560.731407237708, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3207.128, "sample_time_ms": 2845.196, "load_time_ms": 10.308, "load_throughput": 1746300.772, "learn_time_ms": 341.076, "learn_throughput": 52774.211, "synch_weights_time_ms": 9.327}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1322, "training_iteration": 19, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-04", "timestamp": 1698245704, "time_this_iter_s": 3.2419838905334473, "time_total_s": 61.99111795425415, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.99111795425415, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656249986e-07, "cur_lr": 0.0003, "total_loss": 6.842177232106526, "policy_loss": -0.0002618074831035402, "vf_loss": 6.842499913109673, "vf_explained_var": -1.079506344265408e-06, "kl": 0.0014283061187875825, "entropy": 0.6083434595002069, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.67399999999986, "episode_len_mean": 243.96, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 31.500000000000007, 45.7, 2.0999999999995893, 20.899999999999856, 37.10000000000003, -50.00000000000044, 37.10000000000003, -50.00000000000044, 16.699999999999797, 42.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, 44.10000000000001, 42.500000000000014, -50.00000000000044, 38.90000000000002, 43.30000000000001, 17.69999999999981, 43.50000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, 44.300000000000004, 43.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 37.70000000000003, 36.900000000000034, 45.5, -50.00000000000044, 27.299999999999947, 37.70000000000003, 43.10000000000001, 36.50000000000003, -50.00000000000044, 43.50000000000001, 33.30000000000003, -50.00000000000044, 40.10000000000002, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044, 12.69999999999974, 33.500000000000036, 23.099999999999888, -50.00000000000044, -50.00000000000044, 24.69999999999991, 36.30000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, 42.500000000000014, 44.5, -50.00000000000044, 40.500000000000014, 38.10000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 34.900000000000034, 30.099999999999987, 31.300000000000004, 34.900000000000034, 25.499999999999922, 21.499999999999865, -50.00000000000044, 42.30000000000001, -50.00000000000044, 31.900000000000013, 41.30000000000001, -50.00000000000044, 42.500000000000014, 42.10000000000001, 44.5, -50.00000000000044, 34.50000000000004, 33.70000000000004, 41.70000000000002, 43.50000000000001, 44.7, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 35.10000000000004], "episode_lengths": [72, 500, 500, 500, 174, 186, 44, 480, 292, 130, 500, 130, 500, 334, 76, 50, 500, 58, 60, 76, 500, 112, 68, 324, 66, 162, 500, 500, 60, 500, 74, 500, 142, 58, 70, 500, 34, 500, 78, 124, 132, 46, 500, 228, 124, 70, 136, 500, 66, 168, 500, 100, 66, 500, 168, 500, 374, 166, 270, 500, 500, 254, 138, 500, 134, 500, 76, 56, 500, 96, 120, 500, 500, 264, 152, 200, 188, 152, 246, 286, 500, 78, 500, 182, 88, 500, 76, 80, 56, 500, 156, 164, 84, 66, 54, 30, 54, 68, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38494894166180316, "mean_inference_ms": 1.232611275705157, "mean_action_processing_ms": 0.14441778643466383, "mean_env_wait_ms": 0.0835656497901332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028516530990600586, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.10800552368164062}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.67399999999986, "episode_len_mean": 243.96, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 31.500000000000007, 45.7, 2.0999999999995893, 20.899999999999856, 37.10000000000003, -50.00000000000044, 37.10000000000003, -50.00000000000044, 16.699999999999797, 42.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, 44.10000000000001, 42.500000000000014, -50.00000000000044, 38.90000000000002, 43.30000000000001, 17.69999999999981, 43.50000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.900000000000034, 44.300000000000004, 43.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.30000000000001, 37.70000000000003, 36.900000000000034, 45.5, -50.00000000000044, 27.299999999999947, 37.70000000000003, 43.10000000000001, 36.50000000000003, -50.00000000000044, 43.50000000000001, 33.30000000000003, -50.00000000000044, 40.10000000000002, 43.50000000000001, -50.00000000000044, 33.30000000000003, -50.00000000000044, 12.69999999999974, 33.500000000000036, 23.099999999999888, -50.00000000000044, -50.00000000000044, 24.69999999999991, 36.30000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, 42.500000000000014, 44.5, -50.00000000000044, 40.500000000000014, 38.10000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 34.900000000000034, 30.099999999999987, 31.300000000000004, 34.900000000000034, 25.499999999999922, 21.499999999999865, -50.00000000000044, 42.30000000000001, -50.00000000000044, 31.900000000000013, 41.30000000000001, -50.00000000000044, 42.500000000000014, 42.10000000000001, 44.5, -50.00000000000044, 34.50000000000004, 33.70000000000004, 41.70000000000002, 43.50000000000001, 44.7, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 35.10000000000004], "episode_lengths": [72, 500, 500, 500, 174, 186, 44, 480, 292, 130, 500, 130, 500, 334, 76, 50, 500, 58, 60, 76, 500, 112, 68, 324, 66, 162, 500, 500, 60, 500, 74, 500, 142, 58, 70, 500, 34, 500, 78, 124, 132, 46, 500, 228, 124, 70, 136, 500, 66, 168, 500, 100, 66, 500, 168, 500, 374, 166, 270, 500, 500, 254, 138, 500, 134, 500, 76, 56, 500, 96, 120, 500, 500, 264, 152, 200, 188, 152, 246, 286, 500, 78, 500, 182, 88, 500, 76, 80, 56, 500, 156, 164, 84, 66, 54, 30, 54, 68, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38494894166180316, "mean_inference_ms": 1.232611275705157, "mean_action_processing_ms": 0.14441778643466383, "mean_env_wait_ms": 0.0835656497901332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028516530990600586, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.10800552368164062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5622.430779601823, "num_env_steps_trained_throughput_per_sec": 5622.430779601823, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3204.982, "sample_time_ms": 2845.193, "load_time_ms": 9.456, "load_throughput": 1903555.153, "learn_time_ms": 339.761, "learn_throughput": 52978.466, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1396, "training_iteration": 20, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-07", "timestamp": 1698245707, "time_this_iter_s": 3.206461191177368, "time_total_s": 65.19757914543152, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.19757914543152, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 58.82000000000001, "ram_util_percent": 27.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328124993e-07, "cur_lr": 0.0003, "total_loss": 7.048870182037353, "policy_loss": -0.0010614614519808027, "vf_loss": 7.049989318847656, "vf_explained_var": -1.965628729926215e-06, "kl": 0.0024515793269276605, "entropy": 0.5753588543997871, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.635999999999852, "episode_len_mean": 244.36, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 38.10000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 34.900000000000034, 30.099999999999987, 31.300000000000004, 34.900000000000034, 25.499999999999922, 21.499999999999865, -50.00000000000044, 42.30000000000001, -50.00000000000044, 31.900000000000013, 41.30000000000001, -50.00000000000044, 42.500000000000014, 42.10000000000001, 44.5, -50.00000000000044, 34.50000000000004, 33.70000000000004, 41.70000000000002, 43.50000000000001, 44.7, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 28.89999999999997, 42.30000000000001, 39.10000000000002, 40.10000000000002, 44.900000000000006, 10.699999999999712, 41.100000000000016, 44.300000000000004, 34.30000000000004, 39.10000000000002, 42.70000000000001, 37.70000000000003, 23.099999999999888, -50.00000000000044, 13.099999999999746, -50.00000000000044, 45.7, 39.70000000000002, 0.49999999999956657, 44.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 3.699999999999612, 40.70000000000002, 44.7, 42.70000000000001, 40.10000000000002, 39.50000000000002, 39.10000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.300000000000004, -50.00000000000044, 3.899999999999615, 25.899999999999928, 44.10000000000001, 39.50000000000002, 40.10000000000002, 44.10000000000001, -50.00000000000044, 14.299999999999763, 43.10000000000001, 44.10000000000001, -50.00000000000044, 18.29999999999982, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.10000000000003, 8.49999999999968, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [96, 120, 500, 500, 264, 152, 200, 188, 152, 246, 286, 500, 78, 500, 182, 88, 500, 76, 80, 56, 500, 156, 164, 84, 66, 54, 30, 54, 68, 500, 150, 500, 62, 500, 212, 78, 110, 100, 52, 394, 90, 58, 158, 110, 74, 124, 270, 500, 370, 500, 44, 104, 496, 60, 500, 52, 500, 464, 94, 54, 74, 100, 106, 110, 68, 500, 500, 500, 500, 54, 500, 210, 500, 500, 244, 58, 500, 462, 242, 60, 106, 100, 60, 500, 358, 70, 60, 500, 318, 500, 138, 500, 130, 416, 500, 36, 66, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844571537391113, "mean_inference_ms": 1.2318617768985765, "mean_action_processing_ms": 0.14469543403962817, "mean_env_wait_ms": 0.08376886132774765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006532669067383, "StateBufferConnector_ms": 0.006505012512207031, "ViewRequirementAgentConnector_ms": 0.10550951957702637}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.635999999999852, "episode_len_mean": 244.36, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 38.10000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 34.900000000000034, 30.099999999999987, 31.300000000000004, 34.900000000000034, 25.499999999999922, 21.499999999999865, -50.00000000000044, 42.30000000000001, -50.00000000000044, 31.900000000000013, 41.30000000000001, -50.00000000000044, 42.500000000000014, 42.10000000000001, 44.5, -50.00000000000044, 34.50000000000004, 33.70000000000004, 41.70000000000002, 43.50000000000001, 44.7, 47.1, 44.7, 43.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 28.89999999999997, 42.30000000000001, 39.10000000000002, 40.10000000000002, 44.900000000000006, 10.699999999999712, 41.100000000000016, 44.300000000000004, 34.30000000000004, 39.10000000000002, 42.70000000000001, 37.70000000000003, 23.099999999999888, -50.00000000000044, 13.099999999999746, -50.00000000000044, 45.7, 39.70000000000002, 0.49999999999956657, 44.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 3.699999999999612, 40.70000000000002, 44.7, 42.70000000000001, 40.10000000000002, 39.50000000000002, 39.10000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.300000000000004, -50.00000000000044, 3.899999999999615, 25.899999999999928, 44.10000000000001, 39.50000000000002, 40.10000000000002, 44.10000000000001, -50.00000000000044, 14.299999999999763, 43.10000000000001, 44.10000000000001, -50.00000000000044, 18.29999999999982, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.10000000000003, 8.49999999999968, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [96, 120, 500, 500, 264, 152, 200, 188, 152, 246, 286, 500, 78, 500, 182, 88, 500, 76, 80, 56, 500, 156, 164, 84, 66, 54, 30, 54, 68, 500, 150, 500, 62, 500, 212, 78, 110, 100, 52, 394, 90, 58, 158, 110, 74, 124, 270, 500, 370, 500, 44, 104, 496, 60, 500, 52, 500, 464, 94, 54, 74, 100, 106, 110, 68, 500, 500, 500, 500, 54, 500, 210, 500, 500, 244, 58, 500, 462, 242, 60, 106, 100, 60, 500, 358, 70, 60, 500, 318, 500, 138, 500, 130, 416, 500, 36, 66, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844571537391113, "mean_inference_ms": 1.2318617768985765, "mean_action_processing_ms": 0.14469543403962817, "mean_env_wait_ms": 0.08376886132774765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006532669067383, "StateBufferConnector_ms": 0.006505012512207031, "ViewRequirementAgentConnector_ms": 0.10550951957702637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5699.205919280236, "num_env_steps_trained_throughput_per_sec": 5699.205919280236, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3198.642, "sample_time_ms": 2841.433, "load_time_ms": 9.533, "load_throughput": 1888267.638, "learn_time_ms": 337.102, "learn_throughput": 53396.293, "synch_weights_time_ms": 9.305}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1465, "training_iteration": 21, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-11", "timestamp": 1698245711, "time_this_iter_s": 3.1633331775665283, "time_total_s": 68.36091232299805, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.36091232299805, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 62.949999999999996, "ram_util_percent": 27.450000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062497e-08, "cur_lr": 0.0003, "total_loss": 6.511496660444472, "policy_loss": -0.0006059533192051781, "vf_loss": 6.512154091729058, "vf_explained_var": -5.68230946858724e-07, "kl": 0.0013947037217915594, "entropy": 0.5155040721098582, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.887999999999822, "episode_len_mean": 261.76, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.099999999999973, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.300000000000004, -50.00000000000044, 3.899999999999615, 25.899999999999928, 44.10000000000001, 39.50000000000002, 40.10000000000002, 44.10000000000001, -50.00000000000044, 14.299999999999763, 43.10000000000001, 44.10000000000001, -50.00000000000044, 18.29999999999982, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.10000000000003, 8.49999999999968, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.7, 46.5, -50.00000000000044, 7.699999999999669, 42.500000000000014, -50.00000000000044, 31.1, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.300000000000026, -50.00000000000044, 46.9, 39.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 44.7, 44.900000000000006, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.5, 46.099999999999994, 37.90000000000003, 45.3, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 45.9, 45.7, 32.100000000000016, 46.099999999999994, 32.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 21.299999999999862, 46.5, 44.5, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.90000000000002, 2.299999999999592, 30.099999999999987, 44.7], "episode_lengths": [210, 500, 500, 244, 58, 500, 462, 242, 60, 106, 100, 60, 500, 358, 70, 60, 500, 318, 500, 138, 500, 130, 416, 500, 36, 66, 500, 500, 70, 500, 64, 36, 500, 424, 76, 500, 190, 32, 500, 48, 500, 500, 500, 60, 118, 500, 32, 110, 42, 500, 500, 222, 54, 52, 500, 136, 500, 500, 78, 68, 500, 96, 42, 500, 500, 500, 242, 36, 40, 122, 48, 54, 500, 46, 66, 42, 44, 180, 40, 180, 500, 154, 500, 288, 36, 56, 96, 52, 500, 500, 46, 500, 500, 500, 500, 300, 92, 478, 200, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3833633504427485, "mean_inference_ms": 1.2304429768191452, "mean_action_processing_ms": 0.14529506417587948, "mean_env_wait_ms": 0.0841666377534796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016991376876831055, "StateBufferConnector_ms": 0.010998249053955078, "ViewRequirementAgentConnector_ms": 0.12568974494934082}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.887999999999822, "episode_len_mean": 261.76, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.099999999999973, -50.00000000000044, -50.00000000000044, 25.699999999999925, 44.300000000000004, -50.00000000000044, 3.899999999999615, 25.899999999999928, 44.10000000000001, 39.50000000000002, 40.10000000000002, 44.10000000000001, -50.00000000000044, 14.299999999999763, 43.10000000000001, 44.10000000000001, -50.00000000000044, 18.29999999999982, -50.00000000000044, 36.30000000000003, -50.00000000000044, 37.10000000000003, 8.49999999999968, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.7, 46.5, -50.00000000000044, 7.699999999999669, 42.500000000000014, -50.00000000000044, 31.1, 46.9, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.300000000000026, -50.00000000000044, 46.9, 39.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 44.7, 44.900000000000006, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 46.5, 46.099999999999994, 37.90000000000003, 45.3, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 45.9, 45.7, 32.100000000000016, 46.099999999999994, 32.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 21.299999999999862, 46.5, 44.5, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.90000000000002, 2.299999999999592, 30.099999999999987, 44.7], "episode_lengths": [210, 500, 500, 244, 58, 500, 462, 242, 60, 106, 100, 60, 500, 358, 70, 60, 500, 318, 500, 138, 500, 130, 416, 500, 36, 66, 500, 500, 70, 500, 64, 36, 500, 424, 76, 500, 190, 32, 500, 48, 500, 500, 500, 60, 118, 500, 32, 110, 42, 500, 500, 222, 54, 52, 500, 136, 500, 500, 78, 68, 500, 96, 42, 500, 500, 500, 242, 36, 40, 122, 48, 54, 500, 46, 66, 42, 44, 180, 40, 180, 500, 154, 500, 288, 36, 56, 96, 52, 500, 500, 46, 500, 500, 500, 500, 300, 92, 478, 200, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3833633504427485, "mean_inference_ms": 1.2304429768191452, "mean_action_processing_ms": 0.14529506417587948, "mean_env_wait_ms": 0.0841666377534796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016991376876831055, "StateBufferConnector_ms": 0.010998249053955078, "ViewRequirementAgentConnector_ms": 0.12568974494934082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5658.96354748393, "num_env_steps_trained_throughput_per_sec": 5658.96354748393, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3191.516, "sample_time_ms": 2838.374, "load_time_ms": 8.833, "load_throughput": 2037916.559, "learn_time_ms": 333.672, "learn_throughput": 53945.227, "synch_weights_time_ms": 9.308}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1536, "training_iteration": 22, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-14", "timestamp": 1698245714, "time_this_iter_s": 3.1857869625091553, "time_total_s": 71.5466992855072, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.5466992855072, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 60.08, "ram_util_percent": 27.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031248e-08, "cur_lr": 0.0003, "total_loss": 6.303940878974067, "policy_loss": -0.0005572610431247287, "vf_loss": 6.304545995924208, "vf_explained_var": -5.973709954155816e-07, "kl": 0.001703099315714793, "entropy": 0.47945639424853853, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.057999999999826, "episode_len_mean": 250.04, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 46.099999999999994, 37.90000000000003, 45.3, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 45.9, 45.7, 32.100000000000016, 46.099999999999994, 32.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 21.299999999999862, 46.5, 44.5, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.90000000000002, 2.299999999999592, 30.099999999999987, 44.7, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.90000000000002, 45.5, 45.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, 32.100000000000016, 42.900000000000006, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 40.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 23.29999999999989, 39.70000000000002, 7.499999999999666, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.099999999999994, 45.9, 38.50000000000003, 43.50000000000001, 43.10000000000001, 34.10000000000004, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [36, 40, 122, 48, 54, 500, 46, 66, 42, 44, 180, 40, 180, 500, 154, 500, 288, 36, 56, 96, 52, 500, 500, 46, 500, 500, 500, 500, 300, 92, 478, 200, 54, 500, 500, 166, 102, 46, 50, 500, 42, 500, 500, 500, 48, 38, 500, 500, 52, 62, 500, 500, 66, 500, 102, 500, 500, 46, 54, 500, 500, 500, 500, 52, 58, 180, 72, 36, 500, 66, 500, 30, 94, 500, 128, 500, 500, 62, 500, 500, 46, 268, 104, 426, 500, 40, 36, 500, 40, 42, 116, 66, 70, 160, 46, 80, 500, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38312951817794, "mean_inference_ms": 1.230691491785533, "mean_action_processing_ms": 0.14435430149275696, "mean_env_wait_ms": 0.08414862597496192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025114774703979492, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.13298988342285156}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.057999999999826, "episode_len_mean": 250.04, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 46.099999999999994, 37.90000000000003, 45.3, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 45.9, 45.7, 32.100000000000016, 46.099999999999994, 32.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 21.299999999999862, 46.5, 44.5, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.90000000000002, 2.299999999999592, 30.099999999999987, 44.7, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.90000000000002, 45.5, 45.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, 32.100000000000016, 42.900000000000006, 46.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 40.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 23.29999999999989, 39.70000000000002, 7.499999999999666, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.099999999999994, 45.9, 38.50000000000003, 43.50000000000001, 43.10000000000001, 34.10000000000004, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [36, 40, 122, 48, 54, 500, 46, 66, 42, 44, 180, 40, 180, 500, 154, 500, 288, 36, 56, 96, 52, 500, 500, 46, 500, 500, 500, 500, 300, 92, 478, 200, 54, 500, 500, 166, 102, 46, 50, 500, 42, 500, 500, 500, 48, 38, 500, 500, 52, 62, 500, 500, 66, 500, 102, 500, 500, 46, 54, 500, 500, 500, 500, 52, 58, 180, 72, 36, 500, 66, 500, 30, 94, 500, 128, 500, 500, 62, 500, 500, 46, 268, 104, 426, 500, 40, 36, 500, 40, 42, 116, 66, 70, 160, 46, 80, 500, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38312951817794, "mean_inference_ms": 1.230691491785533, "mean_action_processing_ms": 0.14435430149275696, "mean_env_wait_ms": 0.08414862597496192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025114774703979492, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.13298988342285156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5621.002914308403, "num_env_steps_trained_throughput_per_sec": 5621.002914308403, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3194.82, "sample_time_ms": 2842.224, "load_time_ms": 8.932, "load_throughput": 2015291.96, "learn_time_ms": 333.172, "learn_throughput": 54026.077, "synch_weights_time_ms": 9.175}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1603, "training_iteration": 23, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-17", "timestamp": 1698245717, "time_this_iter_s": 3.2082865238189697, "time_total_s": 74.75498580932617, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.75498580932617, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 63.37500000000001, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.384185791015624e-08, "cur_lr": 0.0003, "total_loss": 6.591527949439155, "policy_loss": -0.00033434612883461844, "vf_loss": 6.591915946536594, "vf_explained_var": -3.4650166829427083e-06, "kl": 0.0007384219026638068, "entropy": 0.5357524712880453, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2929999999998176, "episode_len_mean": 262.66, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, 40.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 23.29999999999989, 39.70000000000002, 7.499999999999666, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.099999999999994, 45.9, 38.50000000000003, 43.50000000000001, 43.10000000000001, 34.10000000000004, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.900000000000006, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.90000000000001, 40.90000000000002, 42.30000000000001, -50.00000000000044, 36.10000000000004, 32.100000000000016, -50.00000000000044, 45.9, 41.90000000000001, 45.7, -50.00000000000044, 37.90000000000003, 43.10000000000001, 39.90000000000002, 47.3, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, 22.099999999999874, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.30000000000001, 39.90000000000002, -50.00000000000044, 36.900000000000034, 25.499999999999922, 42.900000000000006, -50.00000000000044, 41.100000000000016, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.10000000000001, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [500, 30, 94, 500, 128, 500, 500, 62, 500, 500, 46, 268, 104, 426, 500, 40, 36, 500, 40, 42, 116, 66, 70, 160, 46, 80, 500, 500, 500, 62, 500, 500, 500, 188, 72, 44, 500, 90, 500, 82, 92, 78, 500, 140, 180, 500, 42, 82, 44, 500, 122, 70, 102, 28, 58, 66, 500, 500, 500, 94, 52, 280, 90, 500, 500, 500, 500, 500, 500, 88, 86, 96, 500, 500, 500, 78, 68, 102, 500, 132, 246, 72, 500, 90, 44, 500, 38, 500, 248, 30, 500, 500, 500, 500, 74, 70, 114, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382812723340254, "mean_inference_ms": 1.229025005326851, "mean_action_processing_ms": 0.1442922427335278, "mean_env_wait_ms": 0.08393157481341701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02561640739440918, "StateBufferConnector_ms": 0.005528450012207031, "ViewRequirementAgentConnector_ms": 0.13408613204956055}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2929999999998176, "episode_len_mean": 262.66, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, 40.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 23.29999999999989, 39.70000000000002, 7.499999999999666, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.099999999999994, 45.9, 38.50000000000003, 43.50000000000001, 43.10000000000001, 34.10000000000004, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.900000000000006, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.90000000000001, 40.90000000000002, 42.30000000000001, -50.00000000000044, 36.10000000000004, 32.100000000000016, -50.00000000000044, 45.9, 41.90000000000001, 45.7, -50.00000000000044, 37.90000000000003, 43.10000000000001, 39.90000000000002, 47.3, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.900000000000006, 22.099999999999874, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.30000000000001, 39.90000000000002, -50.00000000000044, 36.900000000000034, 25.499999999999922, 42.900000000000006, -50.00000000000044, 41.100000000000016, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.10000000000001, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [500, 30, 94, 500, 128, 500, 500, 62, 500, 500, 46, 268, 104, 426, 500, 40, 36, 500, 40, 42, 116, 66, 70, 160, 46, 80, 500, 500, 500, 62, 500, 500, 500, 188, 72, 44, 500, 90, 500, 82, 92, 78, 500, 140, 180, 500, 42, 82, 44, 500, 122, 70, 102, 28, 58, 66, 500, 500, 500, 94, 52, 280, 90, 500, 500, 500, 500, 500, 500, 88, 86, 96, 500, 500, 500, 78, 68, 102, 500, 132, 246, 72, 500, 90, 44, 500, 38, 500, 248, 30, 500, 500, 500, 500, 74, 70, 114, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382812723340254, "mean_inference_ms": 1.229025005326851, "mean_action_processing_ms": 0.1442922427335278, "mean_env_wait_ms": 0.08393157481341701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02561640739440918, "StateBufferConnector_ms": 0.005528450012207031, "ViewRequirementAgentConnector_ms": 0.13408613204956055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5623.612634379047, "num_env_steps_trained_throughput_per_sec": 5623.612634379047, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3193.85, "sample_time_ms": 2835.748, "load_time_ms": 8.53, "load_throughput": 2110117.5, "learn_time_ms": 339.158, "learn_throughput": 53072.578, "synch_weights_time_ms": 9.154}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1673, "training_iteration": 24, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-20", "timestamp": 1698245720, "time_this_iter_s": 3.205789089202881, "time_total_s": 77.96077489852905, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.96077489852905, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 60.38000000000001, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.192092895507812e-08, "cur_lr": 0.0003, "total_loss": 6.920546955532497, "policy_loss": -0.0004762560957007938, "vf_loss": 6.921076594458686, "vf_explained_var": -3.70078616672092e-06, "kl": 0.0011393152560306892, "entropy": 0.5336633483568828, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.267999999999866, "episode_len_mean": 218.02, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.10000000000001, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.900000000000006, 45.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.90000000000003, 44.900000000000006, -50.00000000000044, 30.699999999999996, 45.1, -50.00000000000044, 42.70000000000001, 46.9, 43.900000000000006, 26.89999999999994, 25.499999999999922, 43.30000000000001, 46.099999999999994, 45.1, 44.300000000000004, -50.00000000000044, 44.5, 46.3, 41.70000000000002, 43.30000000000001, 40.500000000000014, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 44.300000000000004, 43.10000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.30000000000001, 37.10000000000003, 45.5, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 41.30000000000001, 45.1, 27.299999999999947, 43.50000000000001, 37.50000000000003, 11.899999999999729, 45.5, -50.00000000000044, 42.900000000000006, 33.30000000000003, 43.10000000000001, 15.899999999999785, 44.7, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.9, -50.00000000000044, 23.8999999999999, 41.90000000000001, -50.00000000000044, 29.899999999999984, 39.10000000000002, -50.00000000000044, 42.500000000000014, 40.500000000000014, 31.500000000000007, 40.500000000000014, 43.7, -50.00000000000044], "episode_lengths": [500, 248, 30, 500, 500, 500, 500, 74, 70, 114, 500, 78, 500, 500, 168, 62, 46, 500, 68, 500, 122, 52, 500, 194, 50, 500, 74, 32, 62, 232, 246, 68, 40, 50, 58, 500, 56, 38, 84, 68, 96, 36, 62, 500, 500, 60, 42, 500, 62, 38, 500, 58, 70, 500, 102, 500, 88, 130, 46, 52, 58, 500, 500, 64, 88, 50, 228, 66, 126, 382, 46, 500, 72, 168, 70, 342, 54, 102, 500, 44, 500, 36, 106, 500, 500, 68, 32, 500, 262, 82, 500, 202, 110, 500, 76, 96, 186, 96, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832071671068345, "mean_inference_ms": 1.2283960386531043, "mean_action_processing_ms": 0.14354674344726567, "mean_env_wait_ms": 0.08375675014843305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02454233169555664, "StateBufferConnector_ms": 0.008949518203735352, "ViewRequirementAgentConnector_ms": 0.1432652473449707}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.267999999999866, "episode_len_mean": 218.02, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 25.29999999999992, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.10000000000001, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.900000000000006, 45.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.90000000000003, 44.900000000000006, -50.00000000000044, 30.699999999999996, 45.1, -50.00000000000044, 42.70000000000001, 46.9, 43.900000000000006, 26.89999999999994, 25.499999999999922, 43.30000000000001, 46.099999999999994, 45.1, 44.300000000000004, -50.00000000000044, 44.5, 46.3, 41.70000000000002, 43.30000000000001, 40.500000000000014, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.9, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 44.300000000000004, 43.10000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.30000000000001, 37.10000000000003, 45.5, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 41.30000000000001, 45.1, 27.299999999999947, 43.50000000000001, 37.50000000000003, 11.899999999999729, 45.5, -50.00000000000044, 42.900000000000006, 33.30000000000003, 43.10000000000001, 15.899999999999785, 44.7, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.9, -50.00000000000044, 23.8999999999999, 41.90000000000001, -50.00000000000044, 29.899999999999984, 39.10000000000002, -50.00000000000044, 42.500000000000014, 40.500000000000014, 31.500000000000007, 40.500000000000014, 43.7, -50.00000000000044], "episode_lengths": [500, 248, 30, 500, 500, 500, 500, 74, 70, 114, 500, 78, 500, 500, 168, 62, 46, 500, 68, 500, 122, 52, 500, 194, 50, 500, 74, 32, 62, 232, 246, 68, 40, 50, 58, 500, 56, 38, 84, 68, 96, 36, 62, 500, 500, 60, 42, 500, 62, 38, 500, 58, 70, 500, 102, 500, 88, 130, 46, 52, 58, 500, 500, 64, 88, 50, 228, 66, 126, 382, 46, 500, 72, 168, 70, 342, 54, 102, 500, 44, 500, 36, 106, 500, 500, 68, 32, 500, 262, 82, 500, 202, 110, 500, 76, 96, 186, 96, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832071671068345, "mean_inference_ms": 1.2283960386531043, "mean_action_processing_ms": 0.14354674344726567, "mean_env_wait_ms": 0.08375675014843305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02454233169555664, "StateBufferConnector_ms": 0.008949518203735352, "ViewRequirementAgentConnector_ms": 0.1432652473449707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5648.612796399371, "num_env_steps_trained_throughput_per_sec": 5648.612796399371, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3191.064, "sample_time_ms": 2832.872, "load_time_ms": 8.726, "load_throughput": 2062710.465, "learn_time_ms": 339.002, "learn_throughput": 53096.963, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1760, "training_iteration": 25, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-23", "timestamp": 1698245723, "time_this_iter_s": 3.192040205001831, "time_total_s": 81.15281510353088, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.15281510353088, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 62.3, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.96046447753906e-09, "cur_lr": 0.0003, "total_loss": 6.319554032219781, "policy_loss": -8.985482984118992e-05, "vf_loss": 6.319698195987278, "vf_explained_var": 9.814898173014322e-07, "kl": 0.0006328231253127746, "entropy": 0.5430843386385176, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.8909999999998215, "episode_len_mean": 266.72, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.10000000000003, 45.5, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 41.30000000000001, 45.1, 27.299999999999947, 43.50000000000001, 37.50000000000003, 11.899999999999729, 45.5, -50.00000000000044, 42.900000000000006, 33.30000000000003, 43.10000000000001, 15.899999999999785, 44.7, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.9, -50.00000000000044, 23.8999999999999, 41.90000000000001, -50.00000000000044, 29.899999999999984, 39.10000000000002, -50.00000000000044, 42.500000000000014, 40.500000000000014, 31.500000000000007, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 26.299999999999933, 33.30000000000003, -50.00000000000044, 41.30000000000001, 45.3, -50.00000000000044, 45.3, 39.70000000000002, 6.699999999999655, 26.89999999999994, 47.3, -50.00000000000044, -50.00000000000044, 20.699999999999854, 39.90000000000002, -50.00000000000044, 42.10000000000001, 23.29999999999989, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 27.49999999999995, 20.699999999999854, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 8.699999999999683, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.30000000000002, 25.499999999999922, 45.5, 43.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 32.90000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [130, 46, 52, 58, 500, 500, 64, 88, 50, 228, 66, 126, 382, 46, 500, 72, 168, 70, 342, 54, 102, 500, 44, 500, 36, 106, 500, 500, 68, 32, 500, 262, 82, 500, 202, 110, 500, 76, 96, 186, 96, 64, 500, 500, 170, 500, 238, 168, 500, 88, 48, 500, 48, 104, 434, 232, 28, 500, 500, 294, 102, 500, 80, 268, 500, 500, 70, 500, 226, 294, 500, 98, 500, 34, 414, 58, 500, 60, 500, 500, 500, 500, 66, 500, 500, 500, 88, 500, 98, 246, 46, 64, 52, 500, 500, 500, 180, 172, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38251694028146643, "mean_inference_ms": 1.2292064070666697, "mean_action_processing_ms": 0.14353796607745978, "mean_env_wait_ms": 0.08408340084868104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000044822692871, "StateBufferConnector_ms": 0.0049285888671875, "ViewRequirementAgentConnector_ms": 0.11857414245605469}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.8909999999998215, "episode_len_mean": 266.72, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.10000000000003, 45.5, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.7, 41.30000000000001, 45.1, 27.299999999999947, 43.50000000000001, 37.50000000000003, 11.899999999999729, 45.5, -50.00000000000044, 42.900000000000006, 33.30000000000003, 43.10000000000001, 15.899999999999785, 44.7, 39.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.9, -50.00000000000044, 23.8999999999999, 41.90000000000001, -50.00000000000044, 29.899999999999984, 39.10000000000002, -50.00000000000044, 42.500000000000014, 40.500000000000014, 31.500000000000007, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 26.299999999999933, 33.30000000000003, -50.00000000000044, 41.30000000000001, 45.3, -50.00000000000044, 45.3, 39.70000000000002, 6.699999999999655, 26.89999999999994, 47.3, -50.00000000000044, -50.00000000000044, 20.699999999999854, 39.90000000000002, -50.00000000000044, 42.10000000000001, 23.29999999999989, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 27.49999999999995, 20.699999999999854, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 8.699999999999683, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.30000000000002, 25.499999999999922, 45.5, 43.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 32.90000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [130, 46, 52, 58, 500, 500, 64, 88, 50, 228, 66, 126, 382, 46, 500, 72, 168, 70, 342, 54, 102, 500, 44, 500, 36, 106, 500, 500, 68, 32, 500, 262, 82, 500, 202, 110, 500, 76, 96, 186, 96, 64, 500, 500, 170, 500, 238, 168, 500, 88, 48, 500, 48, 104, 434, 232, 28, 500, 500, 294, 102, 500, 80, 268, 500, 500, 70, 500, 226, 294, 500, 98, 500, 34, 414, 58, 500, 60, 500, 500, 500, 500, 66, 500, 500, 500, 88, 500, 98, 246, 46, 64, 52, 500, 500, 500, 180, 172, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38251694028146643, "mean_inference_ms": 1.2292064070666697, "mean_action_processing_ms": 0.14353796607745978, "mean_env_wait_ms": 0.08408340084868104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000044822692871, "StateBufferConnector_ms": 0.0049285888671875, "ViewRequirementAgentConnector_ms": 0.11857414245605469}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5629.5176154622895, "num_env_steps_trained_throughput_per_sec": 5629.5176154622895, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3193.445, "sample_time_ms": 2835.371, "load_time_ms": 8.726, "load_throughput": 2062704.829, "learn_time_ms": 338.966, "learn_throughput": 53102.647, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1817, "training_iteration": 26, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-27", "timestamp": 1698245727, "time_this_iter_s": 3.2024309635162354, "time_total_s": 84.35524606704712, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.35524606704712, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 61.52, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.98023223876953e-09, "cur_lr": 0.0003, "total_loss": 6.812764951917861, "policy_loss": -0.00042172972526815204, "vf_loss": 6.813239860534668, "vf_explained_var": -5.602836608886719e-07, "kl": 0.0011744398382069854, "entropy": 0.5314188096258375, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1929999999998022, "episode_len_mean": 283.66, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.49999999999995, 20.699999999999854, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 8.699999999999683, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.30000000000002, 25.499999999999922, 45.5, 43.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 19.69999999999984, 45.5, 46.5, 20.099999999999845, 42.900000000000006, -50.00000000000044, 31.70000000000001, 40.10000000000002, 43.7, 7.699999999999669, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, 45.1, 41.90000000000001, -50.00000000000044, 17.299999999999805, 40.500000000000014, 43.50000000000001, -50.00000000000044, 35.70000000000003, 42.900000000000006, 18.099999999999817, 43.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 0.2999999999995637, 41.500000000000014, 30.29999999999999, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, 36.70000000000003, 44.7, 39.90000000000002, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, 39.50000000000002, -50.00000000000044, 41.500000000000014, 38.300000000000026, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [226, 294, 500, 98, 500, 34, 414, 58, 500, 60, 500, 500, 500, 500, 66, 500, 500, 500, 88, 500, 98, 246, 46, 64, 52, 500, 500, 500, 180, 172, 500, 500, 500, 500, 500, 500, 500, 80, 62, 304, 46, 36, 300, 72, 500, 184, 100, 64, 424, 500, 168, 500, 500, 116, 50, 82, 500, 328, 96, 66, 500, 144, 72, 320, 70, 500, 500, 132, 500, 498, 86, 198, 500, 286, 500, 500, 58, 500, 500, 104, 54, 134, 54, 102, 42, 80, 500, 500, 66, 74, 106, 500, 86, 118, 500, 62, 64, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38222388975248295, "mean_inference_ms": 1.2286782347548566, "mean_action_processing_ms": 0.14289856092703992, "mean_env_wait_ms": 0.08392514171586207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003952026367188, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.12052106857299805}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1929999999998022, "episode_len_mean": 283.66, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.49999999999995, 20.699999999999854, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 8.699999999999683, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.30000000000002, 25.499999999999922, 45.5, 43.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 19.69999999999984, 45.5, 46.5, 20.099999999999845, 42.900000000000006, -50.00000000000044, 31.70000000000001, 40.10000000000002, 43.7, 7.699999999999669, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, 45.1, 41.90000000000001, -50.00000000000044, 17.299999999999805, 40.500000000000014, 43.50000000000001, -50.00000000000044, 35.70000000000003, 42.900000000000006, 18.099999999999817, 43.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 0.2999999999995637, 41.500000000000014, 30.29999999999999, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, 36.70000000000003, 44.7, 39.90000000000002, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, 39.50000000000002, -50.00000000000044, 41.500000000000014, 38.300000000000026, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [226, 294, 500, 98, 500, 34, 414, 58, 500, 60, 500, 500, 500, 500, 66, 500, 500, 500, 88, 500, 98, 246, 46, 64, 52, 500, 500, 500, 180, 172, 500, 500, 500, 500, 500, 500, 500, 80, 62, 304, 46, 36, 300, 72, 500, 184, 100, 64, 424, 500, 168, 500, 500, 116, 50, 82, 500, 328, 96, 66, 500, 144, 72, 320, 70, 500, 500, 132, 500, 498, 86, 198, 500, 286, 500, 500, 58, 500, 500, 104, 54, 134, 54, 102, 42, 80, 500, 500, 66, 74, 106, 500, 86, 118, 500, 62, 64, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38222388975248295, "mean_inference_ms": 1.2286782347548566, "mean_action_processing_ms": 0.14289856092703992, "mean_env_wait_ms": 0.08392514171586207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003952026367188, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.12052106857299805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5653.067775513729, "num_env_steps_trained_throughput_per_sec": 5653.067775513729, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3195.172, "sample_time_ms": 2837.014, "load_time_ms": 8.681, "load_throughput": 2073553.806, "learn_time_ms": 339.182, "learn_throughput": 53068.776, "synch_weights_time_ms": 8.901}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1885, "training_iteration": 27, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-30", "timestamp": 1698245730, "time_this_iter_s": 3.189110517501831, "time_total_s": 87.54435658454895, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.54435658454895, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 56.339999999999996, "ram_util_percent": 27.439999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384765e-09, "cur_lr": 0.0003, "total_loss": 6.758756107754177, "policy_loss": -0.0005533822708659702, "vf_loss": 6.759366925557455, "vf_explained_var": -1.1814965142144098e-06, "kl": 0.0013167639720045878, "entropy": 0.5740406857596503, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8799999999998205, "episode_len_mean": 271.82, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, -50.00000000000044, 0.2999999999995637, 41.500000000000014, 30.29999999999999, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, 36.70000000000003, 44.7, 39.90000000000002, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, 39.50000000000002, -50.00000000000044, 41.500000000000014, 38.300000000000026, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.10000000000002, -50.00000000000044, 40.10000000000002, 37.70000000000003, 38.10000000000002, 42.10000000000001, -50.00000000000044, 5.899999999999643, -50.00000000000044, 29.49999999999998, 39.70000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 35.10000000000004, 38.90000000000002, 42.70000000000001, 35.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, 29.299999999999976, 30.9, 30.9, 14.699999999999768, 43.900000000000006, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.500000000000014, -50.00000000000044, 45.1, 44.7, 36.10000000000004, 45.1, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 44.7], "episode_lengths": [500, 132, 500, 498, 86, 198, 500, 286, 500, 500, 58, 500, 500, 104, 54, 134, 54, 102, 42, 80, 500, 500, 66, 74, 106, 500, 86, 118, 500, 62, 64, 500, 500, 82, 500, 500, 434, 500, 500, 134, 500, 500, 26, 500, 500, 500, 142, 120, 500, 100, 124, 120, 80, 500, 442, 500, 206, 104, 448, 500, 500, 140, 500, 210, 500, 150, 112, 74, 144, 500, 74, 500, 134, 68, 500, 500, 120, 52, 208, 192, 192, 354, 62, 72, 500, 106, 86, 500, 50, 54, 140, 50, 500, 60, 86, 30, 500, 142, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3819356636090874, "mean_inference_ms": 1.2268542157820286, "mean_action_processing_ms": 0.14347582850298748, "mean_env_wait_ms": 0.08352150993868708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017003774642944336, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11452245712280273}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8799999999998205, "episode_len_mean": 271.82, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, -50.00000000000044, 0.2999999999995637, 41.500000000000014, 30.29999999999999, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, 36.70000000000003, 44.7, 39.90000000000002, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, 39.50000000000002, -50.00000000000044, 41.500000000000014, 38.300000000000026, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.10000000000002, -50.00000000000044, 40.10000000000002, 37.70000000000003, 38.10000000000002, 42.10000000000001, -50.00000000000044, 5.899999999999643, -50.00000000000044, 29.49999999999998, 39.70000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 35.10000000000004, 38.90000000000002, 42.70000000000001, 35.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, 29.299999999999976, 30.9, 30.9, 14.699999999999768, 43.900000000000006, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.500000000000014, -50.00000000000044, 45.1, 44.7, 36.10000000000004, 45.1, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 44.7], "episode_lengths": [500, 132, 500, 498, 86, 198, 500, 286, 500, 500, 58, 500, 500, 104, 54, 134, 54, 102, 42, 80, 500, 500, 66, 74, 106, 500, 86, 118, 500, 62, 64, 500, 500, 82, 500, 500, 434, 500, 500, 134, 500, 500, 26, 500, 500, 500, 142, 120, 500, 100, 124, 120, 80, 500, 442, 500, 206, 104, 448, 500, 500, 140, 500, 210, 500, 150, 112, 74, 144, 500, 74, 500, 134, 68, 500, 500, 120, 52, 208, 192, 192, 354, 62, 72, 500, 106, 86, 500, 50, 54, 140, 50, 500, 60, 86, 30, 500, 142, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3819356636090874, "mean_inference_ms": 1.2268542157820286, "mean_action_processing_ms": 0.14347582850298748, "mean_env_wait_ms": 0.08352150993868708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017003774642944336, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11452245712280273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5563.631057744318, "num_env_steps_trained_throughput_per_sec": 5563.631057744318, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3198.41, "sample_time_ms": 2833.027, "load_time_ms": 8.88, "load_throughput": 2026962.783, "learn_time_ms": 346.091, "learn_throughput": 52009.463, "synch_weights_time_ms": 8.841}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1951, "training_iteration": 28, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-33", "timestamp": 1698245733, "time_this_iter_s": 3.24062442779541, "time_total_s": 90.78498101234436, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.78498101234436, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 65.7, "ram_util_percent": 27.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923825e-10, "cur_lr": 0.0003, "total_loss": 7.031357860565185, "policy_loss": -0.00066891610622406, "vf_loss": 7.03208573659261, "vf_explained_var": 2.5471051534016928e-06, "kl": 0.001967858255991612, "entropy": 0.5903231037987603, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.60799999999985, "episode_len_mean": 244.62, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, 29.299999999999976, 30.9, 30.9, 14.699999999999768, 43.900000000000006, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.500000000000014, -50.00000000000044, 45.1, 44.7, 36.10000000000004, 45.1, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, 19.899999999999842, 39.70000000000002, 14.699999999999768, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, 35.70000000000003, 21.09999999999986, 46.099999999999994, 46.099999999999994, 45.3, 41.90000000000001, -50.00000000000044, 4.099999999999618, 32.50000000000002, -50.00000000000044, 40.30000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.30000000000002, 43.10000000000001, 33.500000000000036, -50.00000000000044, 43.7, 30.29999999999999, 35.70000000000003, 37.90000000000003, 33.10000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.50000000000003, 43.50000000000001, 44.300000000000004, -50.00000000000044, 47.1, 43.900000000000006, -50.00000000000044, 24.69999999999991, -50.00000000000044, 29.69999999999998, 46.3, 14.299999999999763, -50.00000000000044, 26.499999999999936, 13.899999999999757, 44.7, 43.7, 41.90000000000001, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.70000000000001, 44.300000000000004, 46.099999999999994, -50.00000000000044, 9.8999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 134, 68, 500, 500, 120, 52, 208, 192, 192, 354, 62, 72, 500, 106, 86, 500, 50, 54, 140, 50, 500, 60, 86, 30, 500, 142, 500, 54, 500, 302, 104, 354, 276, 500, 500, 46, 142, 144, 290, 40, 40, 48, 82, 500, 460, 176, 500, 98, 58, 500, 500, 310, 500, 500, 100, 178, 70, 166, 500, 64, 198, 144, 122, 170, 500, 500, 80, 500, 136, 66, 58, 500, 30, 62, 500, 254, 500, 204, 38, 358, 500, 236, 362, 54, 64, 82, 48, 80, 500, 500, 108, 74, 58, 40, 500, 402, 500, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821614023854388, "mean_inference_ms": 1.226128179869167, "mean_action_processing_ms": 0.1432086620463256, "mean_env_wait_ms": 0.08357174136149126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02394866943359375, "StateBufferConnector_ms": 0.006595134735107422, "ViewRequirementAgentConnector_ms": 0.13592028617858887}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.60799999999985, "episode_len_mean": 244.62, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, 29.299999999999976, 30.9, 30.9, 14.699999999999768, 43.900000000000006, 42.900000000000006, -50.00000000000044, 39.50000000000002, 41.500000000000014, -50.00000000000044, 45.1, 44.7, 36.10000000000004, 45.1, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.1, -50.00000000000044, 35.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, 19.899999999999842, 39.70000000000002, 14.699999999999768, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, 35.70000000000003, 21.09999999999986, 46.099999999999994, 46.099999999999994, 45.3, 41.90000000000001, -50.00000000000044, 4.099999999999618, 32.50000000000002, -50.00000000000044, 40.30000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 40.10000000000002, 32.30000000000002, 43.10000000000001, 33.500000000000036, -50.00000000000044, 43.7, 30.29999999999999, 35.70000000000003, 37.90000000000003, 33.10000000000003, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 36.50000000000003, 43.50000000000001, 44.300000000000004, -50.00000000000044, 47.1, 43.900000000000006, -50.00000000000044, 24.69999999999991, -50.00000000000044, 29.69999999999998, 46.3, 14.299999999999763, -50.00000000000044, 26.499999999999936, 13.899999999999757, 44.7, 43.7, 41.90000000000001, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.70000000000001, 44.300000000000004, 46.099999999999994, -50.00000000000044, 9.8999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 134, 68, 500, 500, 120, 52, 208, 192, 192, 354, 62, 72, 500, 106, 86, 500, 50, 54, 140, 50, 500, 60, 86, 30, 500, 142, 500, 54, 500, 302, 104, 354, 276, 500, 500, 46, 142, 144, 290, 40, 40, 48, 82, 500, 460, 176, 500, 98, 58, 500, 500, 310, 500, 500, 100, 178, 70, 166, 500, 64, 198, 144, 122, 170, 500, 500, 80, 500, 136, 66, 58, 500, 30, 62, 500, 254, 500, 204, 38, 358, 500, 236, 362, 54, 64, 82, 48, 80, 500, 500, 108, 74, 58, 40, 500, 402, 500, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821614023854388, "mean_inference_ms": 1.226128179869167, "mean_action_processing_ms": 0.1432086620463256, "mean_env_wait_ms": 0.08357174136149126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02394866943359375, "StateBufferConnector_ms": 0.006595134735107422, "ViewRequirementAgentConnector_ms": 0.13592028617858887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5616.731188081835, "num_env_steps_trained_throughput_per_sec": 5616.731188081835, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3195.183, "sample_time_ms": 2839.7, "load_time_ms": 8.777, "load_throughput": 2050781.55, "learn_time_ms": 336.172, "learn_throughput": 53544.006, "synch_weights_time_ms": 8.862}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 2022, "training_iteration": 29, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-36", "timestamp": 1698245736, "time_this_iter_s": 3.209707498550415, "time_total_s": 93.99468851089478, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.99468851089478, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 27.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619127e-10, "cur_lr": 0.0003, "total_loss": 7.389118078019884, "policy_loss": -0.0003063261095020506, "vf_loss": 7.389479446411133, "vf_explained_var": -3.5497877332899306e-07, "kl": 0.0012001844205214082, "entropy": 0.5500543336073558, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.07299999999988, "episode_len_mean": 205.02, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 42.70000000000001, 44.300000000000004, 46.099999999999994, -50.00000000000044, 9.8999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 30.699999999999996, 11.699999999999726, 47.3, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.30000000000001, 39.90000000000002, 46.5, 39.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 29.69999999999998, 45.1, 44.5, 38.700000000000024, 39.70000000000002, 37.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 35.500000000000036, 45.9, 46.9, 45.7, 13.499999999999751, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 42.70000000000001, 28.29999999999996, 39.50000000000002, 37.90000000000003, 42.30000000000001, 25.499999999999922, 45.1, 45.1, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 44.7, 45.3, 44.10000000000001, -50.00000000000044, 32.90000000000003, 39.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, 18.099999999999817, 43.7, 45.7, 45.9, 38.700000000000024, 39.10000000000002, -50.00000000000044, 37.300000000000026, 21.699999999999868, 44.7, 47.3, 38.300000000000026, 41.30000000000001, 44.10000000000001, 45.9, -50.00000000000044, 33.10000000000003, 46.9, 40.30000000000002, 41.70000000000002, 16.09999999999979, 44.7], "episode_lengths": [108, 74, 58, 40, 500, 402, 500, 74, 500, 500, 24, 500, 48, 500, 66, 194, 384, 28, 500, 136, 500, 88, 102, 36, 102, 68, 500, 500, 164, 500, 204, 50, 56, 114, 104, 128, 68, 500, 500, 28, 146, 42, 32, 44, 366, 36, 500, 90, 500, 500, 58, 44, 74, 218, 106, 122, 78, 246, 50, 50, 54, 48, 500, 500, 224, 500, 54, 48, 60, 500, 172, 108, 500, 82, 500, 58, 500, 70, 320, 64, 44, 42, 114, 110, 500, 128, 284, 54, 28, 118, 88, 60, 42, 500, 170, 32, 98, 84, 340, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831529109137575, "mean_inference_ms": 1.228457009426376, "mean_action_processing_ms": 0.14330418126124267, "mean_env_wait_ms": 0.08341634920513462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027016639709472656, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12369632720947266}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.07299999999988, "episode_len_mean": 205.02, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 42.70000000000001, 44.300000000000004, 46.099999999999994, -50.00000000000044, 9.8999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 30.699999999999996, 11.699999999999726, 47.3, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.30000000000001, 39.90000000000002, 46.5, 39.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 29.69999999999998, 45.1, 44.5, 38.700000000000024, 39.70000000000002, 37.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 35.500000000000036, 45.9, 46.9, 45.7, 13.499999999999751, 46.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, 42.70000000000001, 28.29999999999996, 39.50000000000002, 37.90000000000003, 42.30000000000001, 25.499999999999922, 45.1, 45.1, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 44.7, 45.3, 44.10000000000001, -50.00000000000044, 32.90000000000003, 39.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, 18.099999999999817, 43.7, 45.7, 45.9, 38.700000000000024, 39.10000000000002, -50.00000000000044, 37.300000000000026, 21.699999999999868, 44.7, 47.3, 38.300000000000026, 41.30000000000001, 44.10000000000001, 45.9, -50.00000000000044, 33.10000000000003, 46.9, 40.30000000000002, 41.70000000000002, 16.09999999999979, 44.7], "episode_lengths": [108, 74, 58, 40, 500, 402, 500, 74, 500, 500, 24, 500, 48, 500, 66, 194, 384, 28, 500, 136, 500, 88, 102, 36, 102, 68, 500, 500, 164, 500, 204, 50, 56, 114, 104, 128, 68, 500, 500, 28, 146, 42, 32, 44, 366, 36, 500, 90, 500, 500, 58, 44, 74, 218, 106, 122, 78, 246, 50, 50, 54, 48, 500, 500, 224, 500, 54, 48, 60, 500, 172, 108, 500, 82, 500, 58, 500, 70, 320, 64, 44, 42, 114, 110, 500, 128, 284, 54, 28, 118, 88, 60, 42, 500, 170, 32, 98, 84, 340, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831529109137575, "mean_inference_ms": 1.228457009426376, "mean_action_processing_ms": 0.14330418126124267, "mean_env_wait_ms": 0.08341634920513462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027016639709472656, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12369632720947266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5354.312539631218, "num_env_steps_trained_throughput_per_sec": 5354.312539631218, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3211.215, "sample_time_ms": 2853.482, "load_time_ms": 8.777, "load_throughput": 2050703.564, "learn_time_ms": 338.353, "learn_throughput": 53198.955, "synch_weights_time_ms": 8.73}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2113, "training_iteration": 30, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-40", "timestamp": 1698245740, "time_this_iter_s": 3.36777400970459, "time_total_s": 97.36246252059937, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.36246252059937, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 71.425, "ram_util_percent": 27.525000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309564e-10, "cur_lr": 0.0003, "total_loss": 6.762884436713325, "policy_loss": -0.00040292888879776, "vf_loss": 6.763345898522271, "vf_explained_var": -3.861056433783637e-06, "kl": 0.0012347101747875418, "entropy": 0.5854911115434435, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.509999999999874, "episode_len_mean": 215.66, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 18.099999999999817, 43.7, 45.7, 45.9, 38.700000000000024, 39.10000000000002, -50.00000000000044, 37.300000000000026, 21.699999999999868, 44.7, 47.3, 38.300000000000026, 41.30000000000001, 44.10000000000001, 45.9, -50.00000000000044, 33.10000000000003, 46.9, 40.30000000000002, 41.70000000000002, 16.09999999999979, 44.7, 30.099999999999987, 37.10000000000003, 40.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 13.899999999999757, 46.699999999999996, -50.00000000000044, -50.00000000000044, 11.29999999999972, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 1.4999999999995808, -50.00000000000044, 45.7, 31.70000000000001, -50.00000000000044, 45.7, 40.90000000000002, 25.099999999999916, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 44.900000000000006, 38.300000000000026, 33.30000000000003, 42.900000000000006, 29.299999999999976, 45.1, 45.1, 19.09999999999983, 39.300000000000026, 45.9, 36.30000000000003, 40.90000000000002, 44.10000000000001, 24.299999999999905, -50.00000000000044, 41.90000000000001, 24.899999999999913, 28.89999999999997, 46.5, -50.00000000000044, 40.90000000000002, 13.499999999999751, 45.7, -50.00000000000044, 42.30000000000001, 43.900000000000006, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, 23.099999999999888, 44.10000000000001, 37.70000000000003, 34.50000000000004, -50.00000000000044, 40.10000000000002, 45.7, 15.49999999999978, 44.5, 43.50000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044], "episode_lengths": [500, 70, 320, 64, 44, 42, 114, 110, 500, 128, 284, 54, 28, 118, 88, 60, 42, 500, 170, 32, 98, 84, 340, 54, 200, 130, 96, 38, 500, 500, 362, 34, 500, 500, 388, 34, 500, 500, 80, 486, 500, 44, 184, 500, 44, 92, 250, 500, 42, 500, 58, 52, 118, 168, 72, 208, 50, 50, 310, 108, 42, 138, 92, 60, 258, 500, 82, 252, 212, 36, 500, 92, 366, 44, 500, 78, 62, 40, 50, 500, 500, 136, 270, 60, 124, 156, 500, 100, 44, 346, 56, 66, 500, 54, 500, 500, 110, 500, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832657208900544, "mean_inference_ms": 1.2288600001914978, "mean_action_processing_ms": 0.14319099963508017, "mean_env_wait_ms": 0.08341152649147954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024023056030273438, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.14531683921813965}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.509999999999874, "episode_len_mean": 215.66, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 18.099999999999817, 43.7, 45.7, 45.9, 38.700000000000024, 39.10000000000002, -50.00000000000044, 37.300000000000026, 21.699999999999868, 44.7, 47.3, 38.300000000000026, 41.30000000000001, 44.10000000000001, 45.9, -50.00000000000044, 33.10000000000003, 46.9, 40.30000000000002, 41.70000000000002, 16.09999999999979, 44.7, 30.099999999999987, 37.10000000000003, 40.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 13.899999999999757, 46.699999999999996, -50.00000000000044, -50.00000000000044, 11.29999999999972, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 1.4999999999995808, -50.00000000000044, 45.7, 31.70000000000001, -50.00000000000044, 45.7, 40.90000000000002, 25.099999999999916, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 44.900000000000006, 38.300000000000026, 33.30000000000003, 42.900000000000006, 29.299999999999976, 45.1, 45.1, 19.09999999999983, 39.300000000000026, 45.9, 36.30000000000003, 40.90000000000002, 44.10000000000001, 24.299999999999905, -50.00000000000044, 41.90000000000001, 24.899999999999913, 28.89999999999997, 46.5, -50.00000000000044, 40.90000000000002, 13.499999999999751, 45.7, -50.00000000000044, 42.30000000000001, 43.900000000000006, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, 23.099999999999888, 44.10000000000001, 37.70000000000003, 34.50000000000004, -50.00000000000044, 40.10000000000002, 45.7, 15.49999999999978, 44.5, 43.50000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044], "episode_lengths": [500, 70, 320, 64, 44, 42, 114, 110, 500, 128, 284, 54, 28, 118, 88, 60, 42, 500, 170, 32, 98, 84, 340, 54, 200, 130, 96, 38, 500, 500, 362, 34, 500, 500, 388, 34, 500, 500, 80, 486, 500, 44, 184, 500, 44, 92, 250, 500, 42, 500, 58, 52, 118, 168, 72, 208, 50, 50, 310, 108, 42, 138, 92, 60, 258, 500, 82, 252, 212, 36, 500, 92, 366, 44, 500, 78, 62, 40, 50, 500, 500, 136, 270, 60, 124, 156, 500, 100, 44, 346, 56, 66, 500, 54, 500, 500, 110, 500, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832657208900544, "mean_inference_ms": 1.2288600001914978, "mean_action_processing_ms": 0.14319099963508017, "mean_env_wait_ms": 0.08341152649147954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024023056030273438, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.14531683921813965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5206.824188832388, "num_env_steps_trained_throughput_per_sec": 5206.824188832388, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3241.081, "sample_time_ms": 2865.448, "load_time_ms": 10.101, "load_throughput": 1782004.504, "learn_time_ms": 355.13, "learn_throughput": 50685.66, "synch_weights_time_ms": 8.63}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2189, "training_iteration": 31, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-43", "timestamp": 1698245743, "time_this_iter_s": 3.4629993438720703, "time_total_s": 100.82546186447144, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.82546186447144, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.58, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154782e-11, "cur_lr": 0.0003, "total_loss": 7.561450809902615, "policy_loss": -0.00027441232361727293, "vf_loss": 7.56178371641371, "vf_explained_var": -6.344583299424913e-07, "kl": 0.001133149316636977, "entropy": 0.5852869338459439, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.400999999999847, "episode_len_mean": 251.7, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.499999999999751, 45.7, -50.00000000000044, 42.30000000000001, 43.900000000000006, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, 23.099999999999888, 44.10000000000001, 37.70000000000003, 34.50000000000004, -50.00000000000044, 40.10000000000002, 45.7, 15.49999999999978, 44.5, 43.50000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 41.500000000000014, 42.70000000000001, 3.899999999999615, -50.00000000000044, 34.900000000000034, 13.299999999999748, 18.29999999999982, 10.499999999999709, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.7, -50.00000000000044, 9.099999999999689, 45.1, 43.7, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.70000000000004, 41.30000000000001, -50.00000000000044, 44.900000000000006, 42.900000000000006, 8.099999999999675, 32.100000000000016, -50.00000000000044, 39.10000000000002, 26.499999999999936, -50.00000000000044, 43.50000000000001, 7.699999999999669, 40.30000000000002, 39.50000000000002, 44.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.10000000000003, 22.099999999999874, -50.00000000000044, 39.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 34.70000000000004, 34.900000000000034, 31.900000000000013, -50.00000000000044, 44.10000000000001, 35.70000000000003, 36.10000000000004, 41.30000000000001, 43.10000000000001, 41.100000000000016, 42.10000000000001, 41.70000000000002, 36.30000000000003, 19.299999999999834, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 34.900000000000034, 42.70000000000001, 36.30000000000003], "episode_lengths": [366, 44, 500, 78, 62, 40, 50, 500, 500, 136, 270, 60, 124, 156, 500, 100, 44, 346, 56, 66, 500, 54, 500, 500, 110, 500, 98, 500, 500, 500, 216, 86, 74, 462, 500, 152, 368, 318, 396, 500, 250, 500, 64, 500, 410, 50, 64, 500, 384, 500, 500, 114, 500, 154, 88, 500, 52, 72, 420, 180, 500, 110, 236, 500, 66, 424, 98, 106, 52, 40, 500, 500, 170, 280, 500, 108, 80, 64, 500, 154, 152, 182, 500, 60, 144, 140, 88, 70, 90, 80, 84, 138, 308, 500, 56, 500, 92, 152, 74, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38307119533798306, "mean_inference_ms": 1.228270874861626, "mean_action_processing_ms": 0.14361124713443052, "mean_env_wait_ms": 0.08335250116439803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.01000523567199707, "ViewRequirementAgentConnector_ms": 0.1289980411529541}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.400999999999847, "episode_len_mean": 251.7, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.499999999999751, 45.7, -50.00000000000044, 42.30000000000001, 43.900000000000006, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 36.50000000000003, 23.099999999999888, 44.10000000000001, 37.70000000000003, 34.50000000000004, -50.00000000000044, 40.10000000000002, 45.7, 15.49999999999978, 44.5, 43.50000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 41.500000000000014, 42.70000000000001, 3.899999999999615, -50.00000000000044, 34.900000000000034, 13.299999999999748, 18.29999999999982, 10.499999999999709, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.7, -50.00000000000044, 9.099999999999689, 45.1, 43.7, -50.00000000000044, 11.699999999999726, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.70000000000004, 41.30000000000001, -50.00000000000044, 44.900000000000006, 42.900000000000006, 8.099999999999675, 32.100000000000016, -50.00000000000044, 39.10000000000002, 26.499999999999936, -50.00000000000044, 43.50000000000001, 7.699999999999669, 40.30000000000002, 39.50000000000002, 44.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.10000000000003, 22.099999999999874, -50.00000000000044, 39.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 34.70000000000004, 34.900000000000034, 31.900000000000013, -50.00000000000044, 44.10000000000001, 35.70000000000003, 36.10000000000004, 41.30000000000001, 43.10000000000001, 41.100000000000016, 42.10000000000001, 41.70000000000002, 36.30000000000003, 19.299999999999834, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 34.900000000000034, 42.70000000000001, 36.30000000000003], "episode_lengths": [366, 44, 500, 78, 62, 40, 50, 500, 500, 136, 270, 60, 124, 156, 500, 100, 44, 346, 56, 66, 500, 54, 500, 500, 110, 500, 98, 500, 500, 500, 216, 86, 74, 462, 500, 152, 368, 318, 396, 500, 250, 500, 64, 500, 410, 50, 64, 500, 384, 500, 500, 114, 500, 154, 88, 500, 52, 72, 420, 180, 500, 110, 236, 500, 66, 424, 98, 106, 52, 40, 500, 500, 170, 280, 500, 108, 80, 64, 500, 154, 152, 182, 500, 60, 144, 140, 88, 70, 90, 80, 84, 138, 308, 500, 56, 500, 92, 152, 74, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38307119533798306, "mean_inference_ms": 1.228270874861626, "mean_action_processing_ms": 0.14361124713443052, "mean_env_wait_ms": 0.08335250116439803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.01000523567199707, "ViewRequirementAgentConnector_ms": 0.1289980411529541}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5243.225178990951, "num_env_steps_trained_throughput_per_sec": 5243.225178990951, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3266.302, "sample_time_ms": 2870.523, "load_time_ms": 10.601, "load_throughput": 1697957.48, "learn_time_ms": 374.764, "learn_throughput": 48030.17, "synch_weights_time_ms": 8.626}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2261, "training_iteration": 32, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-47", "timestamp": 1698245747, "time_this_iter_s": 3.437999963760376, "time_total_s": 104.26346182823181, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.26346182823181, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.739999999999995, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077391e-11, "cur_lr": 0.0003, "total_loss": 6.580829355451796, "policy_loss": -0.0009213712480333116, "vf_loss": 6.581807094150119, "vf_explained_var": 3.351105584038628e-07, "kl": 0.0015873480252493108, "entropy": 0.5640304717752669, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.77599999999985, "episode_len_mean": 242.94, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 44.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.10000000000003, 22.099999999999874, -50.00000000000044, 39.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 34.70000000000004, 34.900000000000034, 31.900000000000013, -50.00000000000044, 44.10000000000001, 35.70000000000003, 36.10000000000004, 41.30000000000001, 43.10000000000001, 41.100000000000016, 42.10000000000001, 41.70000000000002, 36.30000000000003, 19.299999999999834, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 34.900000000000034, 42.70000000000001, 36.30000000000003, 7.09999999999966, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.7, 38.10000000000002, 26.89999999999994, -50.00000000000044, 40.90000000000002, 31.900000000000013, 42.30000000000001, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 29.299999999999976, 45.3, 39.300000000000026, 46.099999999999994, 40.10000000000002, 37.300000000000026, 28.09999999999996, 5.299999999999635, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 28.699999999999967, 40.70000000000002, 40.10000000000002, 44.7, 41.90000000000001, 4.099999999999618, -50.00000000000044, 45.7, 46.5, 4.099999999999618, -50.00000000000044, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 38.10000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.699999999999996, 45.1, -50.00000000000044, 45.9, 0.2999999999995637, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [106, 52, 40, 500, 500, 170, 280, 500, 108, 80, 64, 500, 154, 152, 182, 500, 60, 144, 140, 88, 70, 90, 80, 84, 138, 308, 500, 56, 500, 92, 152, 74, 138, 430, 500, 96, 500, 112, 500, 54, 120, 232, 500, 92, 182, 78, 56, 62, 500, 500, 192, 500, 208, 48, 108, 40, 100, 128, 220, 448, 150, 500, 500, 500, 500, 500, 500, 42, 500, 214, 94, 100, 54, 82, 460, 500, 44, 36, 460, 500, 48, 68, 500, 500, 40, 66, 120, 500, 122, 500, 194, 50, 500, 42, 498, 68, 68, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38287081275536505, "mean_inference_ms": 1.227625073396347, "mean_action_processing_ms": 0.14374057794868098, "mean_env_wait_ms": 0.08317003130699632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500008583068848, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.1190183162689209}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.77599999999985, "episode_len_mean": 242.94, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 44.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.10000000000003, 22.099999999999874, -50.00000000000044, 39.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 34.70000000000004, 34.900000000000034, 31.900000000000013, -50.00000000000044, 44.10000000000001, 35.70000000000003, 36.10000000000004, 41.30000000000001, 43.10000000000001, 41.100000000000016, 42.10000000000001, 41.70000000000002, 36.30000000000003, 19.299999999999834, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 34.900000000000034, 42.70000000000001, 36.30000000000003, 7.09999999999966, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.7, 38.10000000000002, 26.89999999999994, -50.00000000000044, 40.90000000000002, 31.900000000000013, 42.30000000000001, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 29.299999999999976, 45.3, 39.300000000000026, 46.099999999999994, 40.10000000000002, 37.300000000000026, 28.09999999999996, 5.299999999999635, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 28.699999999999967, 40.70000000000002, 40.10000000000002, 44.7, 41.90000000000001, 4.099999999999618, -50.00000000000044, 45.7, 46.5, 4.099999999999618, -50.00000000000044, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 38.10000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.699999999999996, 45.1, -50.00000000000044, 45.9, 0.2999999999995637, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001], "episode_lengths": [106, 52, 40, 500, 500, 170, 280, 500, 108, 80, 64, 500, 154, 152, 182, 500, 60, 144, 140, 88, 70, 90, 80, 84, 138, 308, 500, 56, 500, 92, 152, 74, 138, 430, 500, 96, 500, 112, 500, 54, 120, 232, 500, 92, 182, 78, 56, 62, 500, 500, 192, 500, 208, 48, 108, 40, 100, 128, 220, 448, 150, 500, 500, 500, 500, 500, 500, 42, 500, 214, 94, 100, 54, 82, 460, 500, 44, 36, 460, 500, 48, 68, 500, 500, 40, 66, 120, 500, 122, 500, 194, 50, 500, 42, 498, 68, 68, 500, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38287081275536505, "mean_inference_ms": 1.227625073396347, "mean_action_processing_ms": 0.14374057794868098, "mean_env_wait_ms": 0.08317003130699632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500008583068848, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.1190183162689209}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5379.555834747622, "num_env_steps_trained_throughput_per_sec": 5379.555834747622, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3280.675, "sample_time_ms": 2869.739, "load_time_ms": 11.901, "load_throughput": 1512475.274, "learn_time_ms": 388.453, "learn_throughput": 46337.6, "synch_weights_time_ms": 8.684}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2328, "training_iteration": 33, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-50", "timestamp": 1698245750, "time_this_iter_s": 3.351001262664795, "time_total_s": 107.6144630908966, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.6144630908966, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 56.760000000000005, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386954e-11, "cur_lr": 0.0003, "total_loss": 6.975487889183892, "policy_loss": -0.0003600822761654854, "vf_loss": 6.975908141665989, "vf_explained_var": -2.2437837388780383e-06, "kl": 0.0014759241252685722, "entropy": 0.6020108527607388, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1508.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.138999999999847, "episode_len_mean": 244.32, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 44.7, 41.90000000000001, 4.099999999999618, -50.00000000000044, 45.7, 46.5, 4.099999999999618, -50.00000000000044, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 38.10000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.699999999999996, 45.1, -50.00000000000044, 45.9, 0.2999999999995637, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 18.29999999999982, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.50000000000003, 33.500000000000036, 42.900000000000006, 36.900000000000034, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, 42.500000000000014, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, 37.70000000000003, 36.900000000000034, 47.5, 20.099999999999845, 35.70000000000003, 41.100000000000016, 38.50000000000003, 12.499999999999737, 44.5, 41.90000000000001, -50.00000000000044, 38.300000000000026, 40.500000000000014, 33.70000000000004, 45.9, 43.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, 14.899999999999771, 36.900000000000034, 43.7, 17.69999999999981, 23.29999999999989, 2.299999999999592, 41.90000000000001, 37.50000000000003, 44.900000000000006, 32.100000000000016, 4.299999999999621, 45.1, 46.699999999999996, -50.00000000000044, 37.50000000000003, 42.900000000000006, 44.10000000000001, 41.500000000000014, 24.299999999999905, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [100, 54, 82, 460, 500, 44, 36, 460, 500, 48, 68, 500, 500, 40, 66, 120, 500, 122, 500, 194, 50, 500, 42, 498, 68, 68, 500, 500, 66, 500, 318, 50, 500, 500, 62, 126, 166, 72, 132, 500, 206, 500, 500, 500, 500, 500, 76, 122, 76, 500, 90, 84, 500, 500, 132, 124, 132, 26, 300, 144, 90, 116, 376, 56, 82, 500, 118, 96, 164, 42, 64, 500, 74, 76, 500, 500, 222, 352, 132, 64, 324, 268, 478, 82, 126, 52, 180, 458, 50, 34, 500, 126, 72, 60, 86, 258, 500, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38324221699221056, "mean_inference_ms": 1.2291902843420757, "mean_action_processing_ms": 0.14360332587256763, "mean_env_wait_ms": 0.08341182277739531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299999237060547, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.1529858112335205}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.138999999999847, "episode_len_mean": 244.32, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 44.7, 41.90000000000001, 4.099999999999618, -50.00000000000044, 45.7, 46.5, 4.099999999999618, -50.00000000000044, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 38.10000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 30.699999999999996, 45.1, -50.00000000000044, 45.9, 0.2999999999995637, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 18.29999999999982, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.50000000000003, 33.500000000000036, 42.900000000000006, 36.900000000000034, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, 42.500000000000014, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, 37.70000000000003, 36.900000000000034, 47.5, 20.099999999999845, 35.70000000000003, 41.100000000000016, 38.50000000000003, 12.499999999999737, 44.5, 41.90000000000001, -50.00000000000044, 38.300000000000026, 40.500000000000014, 33.70000000000004, 45.9, 43.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, 14.899999999999771, 36.900000000000034, 43.7, 17.69999999999981, 23.29999999999989, 2.299999999999592, 41.90000000000001, 37.50000000000003, 44.900000000000006, 32.100000000000016, 4.299999999999621, 45.1, 46.699999999999996, -50.00000000000044, 37.50000000000003, 42.900000000000006, 44.10000000000001, 41.500000000000014, 24.299999999999905, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044], "episode_lengths": [100, 54, 82, 460, 500, 44, 36, 460, 500, 48, 68, 500, 500, 40, 66, 120, 500, 122, 500, 194, 50, 500, 42, 498, 68, 68, 500, 500, 66, 500, 318, 50, 500, 500, 62, 126, 166, 72, 132, 500, 206, 500, 500, 500, 500, 500, 76, 122, 76, 500, 90, 84, 500, 500, 132, 124, 132, 26, 300, 144, 90, 116, 376, 56, 82, 500, 118, 96, 164, 42, 64, 500, 74, 76, 500, 500, 222, 352, 132, 64, 324, 268, 478, 82, 126, 52, 180, 458, 50, 34, 500, 126, 72, 60, 86, 258, 500, 500, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38324221699221056, "mean_inference_ms": 1.2291902843420757, "mean_action_processing_ms": 0.14360332587256763, "mean_env_wait_ms": 0.08341182277739531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299999237060547, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.1529858112335205}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5131.127604066491, "num_env_steps_trained_throughput_per_sec": 5131.127604066491, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3311.396, "sample_time_ms": 2886.369, "load_time_ms": 12.924, "load_throughput": 1392806.091, "learn_time_ms": 401.403, "learn_throughput": 44842.68, "synch_weights_time_ms": 8.702}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2399, "training_iteration": 34, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-54", "timestamp": 1698245754, "time_this_iter_s": 3.5129988193511963, "time_total_s": 111.1274619102478, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.1274619102478, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 59.81999999999999, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693477e-11, "cur_lr": 0.0003, "total_loss": 6.588955593109131, "policy_loss": -0.0005150358710024091, "vf_loss": 6.589527437422011, "vf_explained_var": -1.9478797912597657e-05, "kl": 0.0017848959360242766, "entropy": 0.5680455605189005, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.844999999999823, "episode_len_mean": 267.2, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, 38.300000000000026, 40.500000000000014, 33.70000000000004, 45.9, 43.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, 14.899999999999771, 36.900000000000034, 43.7, 17.69999999999981, 23.29999999999989, 2.299999999999592, 41.90000000000001, 37.50000000000003, 44.900000000000006, 32.100000000000016, 4.299999999999621, 45.1, 46.699999999999996, -50.00000000000044, 37.50000000000003, 42.900000000000006, 44.10000000000001, 41.500000000000014, 24.299999999999905, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 16.29999999999979, 35.900000000000034, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.7, 42.70000000000001, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 33.30000000000003, 12.69999999999974, 46.3, 44.10000000000001, 42.70000000000001, 44.5, 28.499999999999964, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 37.90000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.900000000000006, 43.7, 27.099999999999945, 39.70000000000002, -50.00000000000044, 32.30000000000002, 44.10000000000001, 46.099999999999994, 43.7, 30.699999999999996], "episode_lengths": [82, 500, 118, 96, 164, 42, 64, 500, 74, 76, 500, 500, 222, 352, 132, 64, 324, 268, 478, 82, 126, 52, 180, 458, 50, 34, 500, 126, 72, 60, 86, 258, 500, 500, 30, 500, 338, 142, 500, 500, 148, 54, 74, 60, 80, 500, 500, 36, 168, 374, 38, 60, 74, 56, 216, 500, 86, 500, 80, 500, 500, 136, 110, 500, 500, 500, 500, 500, 122, 52, 500, 500, 500, 500, 500, 500, 70, 302, 500, 500, 500, 500, 48, 500, 474, 500, 52, 500, 500, 94, 72, 64, 230, 104, 500, 178, 60, 40, 64, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38345275026518416, "mean_inference_ms": 1.229770619756756, "mean_action_processing_ms": 0.1438970769900137, "mean_env_wait_ms": 0.0831720841136771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01996922492980957, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12398529052734375}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.844999999999823, "episode_len_mean": 267.2, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, 38.300000000000026, 40.500000000000014, 33.70000000000004, 45.9, 43.7, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, 14.899999999999771, 36.900000000000034, 43.7, 17.69999999999981, 23.29999999999989, 2.299999999999592, 41.90000000000001, 37.50000000000003, 44.900000000000006, 32.100000000000016, 4.299999999999621, 45.1, 46.699999999999996, -50.00000000000044, 37.50000000000003, 42.900000000000006, 44.10000000000001, 41.500000000000014, 24.299999999999905, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 16.29999999999979, 35.900000000000034, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.7, 42.70000000000001, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 33.30000000000003, 12.69999999999974, 46.3, 44.10000000000001, 42.70000000000001, 44.5, 28.499999999999964, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 37.90000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.900000000000006, 43.7, 27.099999999999945, 39.70000000000002, -50.00000000000044, 32.30000000000002, 44.10000000000001, 46.099999999999994, 43.7, 30.699999999999996], "episode_lengths": [82, 500, 118, 96, 164, 42, 64, 500, 74, 76, 500, 500, 222, 352, 132, 64, 324, 268, 478, 82, 126, 52, 180, 458, 50, 34, 500, 126, 72, 60, 86, 258, 500, 500, 30, 500, 338, 142, 500, 500, 148, 54, 74, 60, 80, 500, 500, 36, 168, 374, 38, 60, 74, 56, 216, 500, 86, 500, 80, 500, 500, 136, 110, 500, 500, 500, 500, 500, 122, 52, 500, 500, 500, 500, 500, 500, 70, 302, 500, 500, 500, 500, 48, 500, 474, 500, 52, 500, 500, 94, 72, 64, 230, 104, 500, 178, 60, 40, 64, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38345275026518416, "mean_inference_ms": 1.229770619756756, "mean_action_processing_ms": 0.1438970769900137, "mean_env_wait_ms": 0.0831720841136771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01996922492980957, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12398529052734375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5547.044887382034, "num_env_steps_trained_throughput_per_sec": 5547.044887382034, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3317.23, "sample_time_ms": 2895.072, "load_time_ms": 12.728, "load_throughput": 1414255.271, "learn_time_ms": 398.78, "learn_throughput": 45137.674, "synch_weights_time_ms": 8.553}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2463, "training_iteration": 35, "trial_id": "9f288_00005", "date": "2023-10-25_15-55-57", "timestamp": 1698245757, "time_this_iter_s": 3.249971628189087, "time_total_s": 114.37743353843689, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.37743353843689, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 65.55, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346739e-12, "cur_lr": 0.0003, "total_loss": 6.679711331261529, "policy_loss": -0.00024121784501605564, "vf_loss": 6.680008824666341, "vf_explained_var": 0.0015229768223232693, "kl": 0.001183480381715501, "entropy": 0.5617719603909387, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.322999999999817, "episode_len_mean": 272.38, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.900000000000006, 43.7, 27.099999999999945, 39.70000000000002, -50.00000000000044, 32.30000000000002, 44.10000000000001, 46.099999999999994, 43.7, 30.699999999999996, 35.900000000000034, -50.00000000000044, 45.5, 43.30000000000001, 7.899999999999672, 39.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 22.699999999999882, 42.500000000000014, -50.00000000000044, 36.30000000000003, 46.3, 44.10000000000001, 45.1, -50.00000000000044, 42.70000000000001, 32.50000000000002, 45.1, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, 36.10000000000004, 36.10000000000004, 37.10000000000003, 44.300000000000004, 45.3, 13.099999999999746, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 2.8999999999996007, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 33.10000000000003, 41.100000000000016, 33.90000000000004, 33.500000000000036, -50.00000000000044, 36.10000000000004, 32.50000000000002, 44.7, 40.30000000000002, 44.300000000000004, 43.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, 42.70000000000001, 36.30000000000003, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 70, 302, 500, 500, 500, 500, 48, 500, 474, 500, 52, 500, 500, 94, 72, 64, 230, 104, 500, 178, 60, 40, 64, 194, 142, 500, 46, 68, 422, 108, 500, 88, 500, 500, 500, 500, 500, 176, 500, 500, 274, 76, 500, 138, 38, 60, 50, 500, 74, 176, 50, 84, 500, 500, 72, 48, 140, 140, 130, 58, 48, 370, 60, 500, 500, 62, 36, 472, 270, 500, 500, 500, 82, 500, 170, 90, 162, 166, 500, 140, 176, 54, 98, 58, 64, 118, 500, 500, 500, 500, 70, 56, 500, 74, 138, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836981420258001, "mean_inference_ms": 1.2307504852492555, "mean_action_processing_ms": 0.14393904824741607, "mean_env_wait_ms": 0.08343999581268306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598094940185547, "StateBufferConnector_ms": 0.0070154666900634766, "ViewRequirementAgentConnector_ms": 0.1300032138824463}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.322999999999817, "episode_len_mean": 272.38, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 2.699999999999598, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.900000000000006, 43.7, 27.099999999999945, 39.70000000000002, -50.00000000000044, 32.30000000000002, 44.10000000000001, 46.099999999999994, 43.7, 30.699999999999996, 35.900000000000034, -50.00000000000044, 45.5, 43.30000000000001, 7.899999999999672, 39.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 22.699999999999882, 42.500000000000014, -50.00000000000044, 36.30000000000003, 46.3, 44.10000000000001, 45.1, -50.00000000000044, 42.70000000000001, 32.50000000000002, 45.1, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, 36.10000000000004, 36.10000000000004, 37.10000000000003, 44.300000000000004, 45.3, 13.099999999999746, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 2.8999999999996007, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 33.10000000000003, 41.100000000000016, 33.90000000000004, 33.500000000000036, -50.00000000000044, 36.10000000000004, 32.50000000000002, 44.7, 40.30000000000002, 44.300000000000004, 43.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, 42.70000000000001, 36.30000000000003, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 70, 302, 500, 500, 500, 500, 48, 500, 474, 500, 52, 500, 500, 94, 72, 64, 230, 104, 500, 178, 60, 40, 64, 194, 142, 500, 46, 68, 422, 108, 500, 88, 500, 500, 500, 500, 500, 176, 500, 500, 274, 76, 500, 138, 38, 60, 50, 500, 74, 176, 50, 84, 500, 500, 72, 48, 140, 140, 130, 58, 48, 370, 60, 500, 500, 62, 36, 472, 270, 500, 500, 500, 82, 500, 170, 90, 162, 166, 500, 140, 176, 54, 98, 58, 64, 118, 500, 500, 500, 500, 70, 56, 500, 74, 138, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836981420258001, "mean_inference_ms": 1.2307504852492555, "mean_action_processing_ms": 0.14393904824741607, "mean_env_wait_ms": 0.08343999581268306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598094940185547, "StateBufferConnector_ms": 0.0070154666900634766, "ViewRequirementAgentConnector_ms": 0.1300032138824463}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5170.928327780164, "num_env_steps_trained_throughput_per_sec": 5170.928327780164, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3345.587, "sample_time_ms": 2903.845, "load_time_ms": 13.027, "load_throughput": 1381707.628, "learn_time_ms": 417.962, "learn_throughput": 43066.099, "synch_weights_time_ms": 8.575}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2535, "training_iteration": 36, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-00", "timestamp": 1698245760, "time_this_iter_s": 3.4860010147094727, "time_total_s": 117.86343455314636, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.86343455314636, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 61.75999999999999, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733693e-12, "cur_lr": 0.0003, "total_loss": 6.991063446468777, "policy_loss": -0.0007240121563275655, "vf_loss": 6.991837681664361, "vf_explained_var": 0.001257210307651096, "kl": 0.001191354044082497, "entropy": 0.5020256631904179, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.33899999999987, "episode_len_mean": 222.34, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.10000000000003, 41.100000000000016, 33.90000000000004, 33.500000000000036, -50.00000000000044, 36.10000000000004, 32.50000000000002, 44.7, 40.30000000000002, 44.300000000000004, 43.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, 42.70000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, 44.7, 45.3, 35.70000000000003, 46.699999999999996, -50.00000000000044, 42.70000000000001, 28.09999999999996, 41.30000000000001, 46.3, 45.7, 46.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.10000000000002, 27.299999999999947, 42.10000000000001, 34.900000000000034, 41.100000000000016, 38.700000000000024, 46.5, 44.7, 13.299999999999748, 43.7, 38.700000000000024, 29.69999999999998, 30.9, -50.00000000000044, 46.5, 44.7, 28.499999999999964, 23.29999999999989, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 36.10000000000004, 24.69999999999991, 45.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 46.5, 41.90000000000001, 7.899999999999672, -50.00000000000044, 46.3, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 26.69999999999994, 44.7, 42.900000000000006, 44.5, -50.00000000000044, 38.700000000000024, 18.499999999999822, 45.7, 43.50000000000001, 14.899999999999771, 45.3, 45.1, 41.500000000000014, 44.900000000000006, 45.9, 34.70000000000004, 46.699999999999996], "episode_lengths": [500, 170, 90, 162, 166, 500, 140, 176, 54, 98, 58, 64, 118, 500, 500, 500, 500, 70, 56, 500, 74, 138, 500, 500, 54, 48, 144, 34, 500, 74, 220, 88, 38, 44, 38, 104, 500, 500, 94, 500, 120, 228, 80, 152, 90, 114, 36, 54, 368, 64, 114, 204, 192, 500, 36, 54, 216, 268, 500, 298, 500, 500, 500, 44, 140, 254, 50, 86, 500, 500, 500, 414, 500, 500, 36, 82, 422, 500, 38, 44, 48, 500, 500, 234, 54, 72, 56, 500, 114, 316, 44, 66, 352, 48, 50, 86, 52, 42, 154, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836244924692464, "mean_inference_ms": 1.2312183165857087, "mean_action_processing_ms": 0.1442130349284888, "mean_env_wait_ms": 0.08337484993624768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799367904663086, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.12950682640075684}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.33899999999987, "episode_len_mean": 222.34, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.10000000000003, 41.100000000000016, 33.90000000000004, 33.500000000000036, -50.00000000000044, 36.10000000000004, 32.50000000000002, 44.7, 40.30000000000002, 44.300000000000004, 43.7, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, 42.70000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, 44.7, 45.3, 35.70000000000003, 46.699999999999996, -50.00000000000044, 42.70000000000001, 28.09999999999996, 41.30000000000001, 46.3, 45.7, 46.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.10000000000002, 27.299999999999947, 42.10000000000001, 34.900000000000034, 41.100000000000016, 38.700000000000024, 46.5, 44.7, 13.299999999999748, 43.7, 38.700000000000024, 29.69999999999998, 30.9, -50.00000000000044, 46.5, 44.7, 28.499999999999964, 23.29999999999989, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 36.10000000000004, 24.69999999999991, 45.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 46.5, 41.90000000000001, 7.899999999999672, -50.00000000000044, 46.3, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 26.69999999999994, 44.7, 42.900000000000006, 44.5, -50.00000000000044, 38.700000000000024, 18.499999999999822, 45.7, 43.50000000000001, 14.899999999999771, 45.3, 45.1, 41.500000000000014, 44.900000000000006, 45.9, 34.70000000000004, 46.699999999999996], "episode_lengths": [500, 170, 90, 162, 166, 500, 140, 176, 54, 98, 58, 64, 118, 500, 500, 500, 500, 70, 56, 500, 74, 138, 500, 500, 54, 48, 144, 34, 500, 74, 220, 88, 38, 44, 38, 104, 500, 500, 94, 500, 120, 228, 80, 152, 90, 114, 36, 54, 368, 64, 114, 204, 192, 500, 36, 54, 216, 268, 500, 298, 500, 500, 500, 44, 140, 254, 50, 86, 500, 500, 500, 414, 500, 500, 36, 82, 422, 500, 38, 44, 48, 500, 500, 234, 54, 72, 56, 500, 114, 316, 44, 66, 352, 48, 50, 86, 52, 42, 154, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836244924692464, "mean_inference_ms": 1.2312183165857087, "mean_action_processing_ms": 0.1442130349284888, "mean_env_wait_ms": 0.08337484993624768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799367904663086, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.12950682640075684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5176.873425800646, "num_env_steps_trained_throughput_per_sec": 5176.873425800646, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3374.876, "sample_time_ms": 2917.235, "load_time_ms": 14.202, "load_throughput": 1267403.834, "learn_time_ms": 432.687, "learn_throughput": 41600.495, "synch_weights_time_ms": 8.675}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2612, "training_iteration": 37, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-04", "timestamp": 1698245764, "time_this_iter_s": 3.4820010662078857, "time_total_s": 121.34543561935425, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.34543561935425, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 60.660000000000004, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366847e-12, "cur_lr": 0.0003, "total_loss": 6.86544148127238, "policy_loss": -0.0001608299712340037, "vf_loss": 6.865657160017226, "vf_explained_var": 0.0022753781742519802, "kl": 0.000763900677429774, "entropy": 0.5481338851981693, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.420999999999871, "episode_len_mean": 211.52, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.69999999999994, 44.7, 42.900000000000006, 44.5, -50.00000000000044, 38.700000000000024, 18.499999999999822, 45.7, 43.50000000000001, 14.899999999999771, 45.3, 45.1, 41.500000000000014, 44.900000000000006, 45.9, 34.70000000000004, 46.699999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, 13.099999999999746, -50.00000000000044, -50.00000000000044, 47.3, 47.3, 43.30000000000001, 40.10000000000002, -50.00000000000044, 45.9, 40.500000000000014, 34.900000000000034, 32.700000000000024, 23.699999999999896, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 47.1, 28.29999999999996, 32.100000000000016, -50.00000000000044, 46.699999999999996, 33.70000000000004, 43.900000000000006, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 40.30000000000002, 45.3, 45.3, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 44.10000000000001, 44.7, 44.300000000000004, 37.300000000000026, 45.9, -50.00000000000044, 46.099999999999994, 45.5, 40.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, 41.100000000000016, -50.00000000000044, 23.499999999999893, -50.00000000000044, 44.5, 46.5, 45.7, 45.3, 44.10000000000001, 15.699999999999783, 37.90000000000003, 38.10000000000002, 13.099999999999746, 46.5, 43.7], "episode_lengths": [234, 54, 72, 56, 500, 114, 316, 44, 66, 352, 48, 50, 86, 52, 42, 154, 34, 500, 256, 500, 150, 500, 500, 500, 48, 42, 500, 500, 110, 60, 370, 500, 500, 28, 28, 68, 100, 500, 42, 96, 152, 174, 264, 54, 500, 500, 500, 170, 30, 218, 180, 500, 34, 164, 62, 64, 62, 500, 500, 500, 148, 500, 44, 98, 48, 48, 500, 58, 60, 500, 60, 54, 58, 128, 42, 500, 40, 46, 96, 500, 48, 500, 500, 48, 72, 90, 500, 266, 500, 56, 36, 44, 48, 60, 344, 122, 120, 370, 36, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38469062031925283, "mean_inference_ms": 1.2315345452937487, "mean_action_processing_ms": 0.1445263698250597, "mean_env_wait_ms": 0.08290404264665809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021009445190429688, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.14203166961669922}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.420999999999871, "episode_len_mean": 211.52, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.69999999999994, 44.7, 42.900000000000006, 44.5, -50.00000000000044, 38.700000000000024, 18.499999999999822, 45.7, 43.50000000000001, 14.899999999999771, 45.3, 45.1, 41.500000000000014, 44.900000000000006, 45.9, 34.70000000000004, 46.699999999999996, -50.00000000000044, 24.499999999999908, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.10000000000001, 13.099999999999746, -50.00000000000044, -50.00000000000044, 47.3, 47.3, 43.30000000000001, 40.10000000000002, -50.00000000000044, 45.9, 40.500000000000014, 34.900000000000034, 32.700000000000024, 23.699999999999896, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 47.1, 28.29999999999996, 32.100000000000016, -50.00000000000044, 46.699999999999996, 33.70000000000004, 43.900000000000006, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 40.30000000000002, 45.3, 45.3, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 44.10000000000001, 44.7, 44.300000000000004, 37.300000000000026, 45.9, -50.00000000000044, 46.099999999999994, 45.5, 40.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, 41.100000000000016, -50.00000000000044, 23.499999999999893, -50.00000000000044, 44.5, 46.5, 45.7, 45.3, 44.10000000000001, 15.699999999999783, 37.90000000000003, 38.10000000000002, 13.099999999999746, 46.5, 43.7], "episode_lengths": [234, 54, 72, 56, 500, 114, 316, 44, 66, 352, 48, 50, 86, 52, 42, 154, 34, 500, 256, 500, 150, 500, 500, 500, 48, 42, 500, 500, 110, 60, 370, 500, 500, 28, 28, 68, 100, 500, 42, 96, 152, 174, 264, 54, 500, 500, 500, 170, 30, 218, 180, 500, 34, 164, 62, 64, 62, 500, 500, 500, 148, 500, 44, 98, 48, 48, 500, 58, 60, 500, 60, 54, 58, 128, 42, 500, 40, 46, 96, 500, 48, 500, 500, 48, 72, 90, 500, 266, 500, 56, 36, 44, 48, 60, 344, 122, 120, 370, 36, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38469062031925283, "mean_inference_ms": 1.2315345452937487, "mean_action_processing_ms": 0.1445263698250597, "mean_env_wait_ms": 0.08290404264665809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021009445190429688, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.14203166961669922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5617.975862581644, "num_env_steps_trained_throughput_per_sec": 5617.975862581644, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3371.747, "sample_time_ms": 2925.394, "load_time_ms": 14.003, "load_throughput": 1285470.328, "learn_time_ms": 421.751, "learn_throughput": 42679.163, "synch_weights_time_ms": 8.699}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2695, "training_iteration": 38, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-07", "timestamp": 1698245767, "time_this_iter_s": 3.209001064300537, "time_total_s": 124.55443668365479, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 124.55443668365479, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 58.980000000000004, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183423e-13, "cur_lr": 0.0003, "total_loss": 7.101811525556776, "policy_loss": -0.00022601609428723652, "vf_loss": 7.102095052931044, "vf_explained_var": -0.003545102808210585, "kl": 0.0012022285218007609, "entropy": 0.5760325570901235, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.42499999999985, "episode_len_mean": 241.46, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 44.10000000000001, 44.7, 44.300000000000004, 37.300000000000026, 45.9, -50.00000000000044, 46.099999999999994, 45.5, 40.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, 41.100000000000016, -50.00000000000044, 23.499999999999893, -50.00000000000044, 44.5, 46.5, 45.7, 45.3, 44.10000000000001, 15.699999999999783, 37.90000000000003, 38.10000000000002, 13.099999999999746, 46.5, 43.7, 36.900000000000034, 19.69999999999984, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.900000000000006, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 31.900000000000013, 41.70000000000002, 28.499999999999964, 44.10000000000001, 42.30000000000001, 41.500000000000014, 44.10000000000001, -50.00000000000044, 4.899999999999629, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 21.89999999999987, 39.70000000000002, 11.699999999999726, 4.499999999999623, 5.099999999999632, -50.00000000000044, 45.9, 45.1, 29.899999999999984, 21.699999999999868, 42.70000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 35.900000000000034, 45.9, 29.69999999999998, 24.099999999999902, 30.29999999999999, 31.70000000000001, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.099999999999994, 18.499999999999822, -50.00000000000044, 20.299999999999848, -50.00000000000044, 40.500000000000014, 44.10000000000001, 40.10000000000002, 44.900000000000006, 25.099999999999916], "episode_lengths": [60, 500, 60, 54, 58, 128, 42, 500, 40, 46, 96, 500, 48, 500, 500, 48, 72, 90, 500, 266, 500, 56, 36, 44, 48, 60, 344, 122, 120, 370, 36, 64, 132, 304, 72, 500, 44, 500, 500, 500, 500, 106, 62, 500, 80, 500, 98, 500, 500, 182, 84, 216, 60, 78, 86, 60, 500, 452, 164, 500, 500, 500, 500, 500, 72, 282, 104, 384, 456, 450, 500, 42, 50, 202, 284, 74, 66, 500, 500, 500, 122, 142, 42, 204, 260, 198, 184, 58, 500, 70, 40, 316, 500, 298, 500, 96, 60, 100, 52, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38429748222453486, "mean_inference_ms": 1.230737947728188, "mean_action_processing_ms": 0.14441710162619095, "mean_env_wait_ms": 0.08309905677358245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.11799335479736328}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.42499999999985, "episode_len_mean": 241.46, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 44.10000000000001, 44.7, 44.300000000000004, 37.300000000000026, 45.9, -50.00000000000044, 46.099999999999994, 45.5, 40.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, 41.100000000000016, -50.00000000000044, 23.499999999999893, -50.00000000000044, 44.5, 46.5, 45.7, 45.3, 44.10000000000001, 15.699999999999783, 37.90000000000003, 38.10000000000002, 13.099999999999746, 46.5, 43.7, 36.900000000000034, 19.69999999999984, 42.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.900000000000006, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 31.900000000000013, 41.70000000000002, 28.499999999999964, 44.10000000000001, 42.30000000000001, 41.500000000000014, 44.10000000000001, -50.00000000000044, 4.899999999999629, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 21.89999999999987, 39.70000000000002, 11.699999999999726, 4.499999999999623, 5.099999999999632, -50.00000000000044, 45.9, 45.1, 29.899999999999984, 21.699999999999868, 42.70000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 35.900000000000034, 45.9, 29.69999999999998, 24.099999999999902, 30.29999999999999, 31.70000000000001, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.099999999999994, 18.499999999999822, -50.00000000000044, 20.299999999999848, -50.00000000000044, 40.500000000000014, 44.10000000000001, 40.10000000000002, 44.900000000000006, 25.099999999999916], "episode_lengths": [60, 500, 60, 54, 58, 128, 42, 500, 40, 46, 96, 500, 48, 500, 500, 48, 72, 90, 500, 266, 500, 56, 36, 44, 48, 60, 344, 122, 120, 370, 36, 64, 132, 304, 72, 500, 44, 500, 500, 500, 500, 106, 62, 500, 80, 500, 98, 500, 500, 182, 84, 216, 60, 78, 86, 60, 500, 452, 164, 500, 500, 500, 500, 500, 72, 282, 104, 384, 456, 450, 500, 42, 50, 202, 284, 74, 66, 500, 500, 500, 122, 142, 42, 204, 260, 198, 184, 58, 500, 70, 40, 316, 500, 298, 500, 96, 60, 100, 52, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38429748222453486, "mean_inference_ms": 1.230737947728188, "mean_action_processing_ms": 0.14441710162619095, "mean_env_wait_ms": 0.08309905677358245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.11799335479736328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5479.452309314481, "num_env_steps_trained_throughput_per_sec": 5479.452309314481, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3379.776, "sample_time_ms": 2922.075, "load_time_ms": 14.503, "load_throughput": 1241146.825, "learn_time_ms": 432.603, "learn_throughput": 41608.576, "synch_weights_time_ms": 8.796}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2763, "training_iteration": 39, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-10", "timestamp": 1698245770, "time_this_iter_s": 3.289999008178711, "time_total_s": 127.8444356918335, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.8444356918335, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 65.69999999999999, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917116e-13, "cur_lr": 0.0003, "total_loss": 6.553951221042209, "policy_loss": -0.0004514748023615943, "vf_loss": 6.5544584168328175, "vf_explained_var": -0.0006599028905232748, "kl": 0.001042946853764685, "entropy": 0.5564478033118778, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.070999999999858, "episode_len_mean": 235.0, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 45.1, 29.899999999999984, 21.699999999999868, 42.70000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 35.900000000000034, 45.9, 29.69999999999998, 24.099999999999902, 30.29999999999999, 31.70000000000001, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.099999999999994, 18.499999999999822, -50.00000000000044, 20.299999999999848, -50.00000000000044, 40.500000000000014, 44.10000000000001, 40.10000000000002, 44.900000000000006, 25.099999999999916, 42.500000000000014, -50.00000000000044, 19.69999999999984, 43.7, 45.3, 30.699999999999996, 45.3, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 41.70000000000002, 38.700000000000024, 45.5, 42.900000000000006, 42.30000000000001, 30.9, -50.00000000000044, 42.900000000000006, 32.50000000000002, 42.30000000000001, 42.30000000000001, 42.30000000000001, 22.299999999999876, 40.500000000000014, 41.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 26.499999999999936, 41.70000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 34.50000000000004, 41.30000000000001, 40.30000000000002, 44.10000000000001, 31.900000000000013, 45.9, 33.10000000000003, 13.899999999999757, 20.49999999999985, 34.900000000000034, 40.30000000000002, 43.900000000000006, -50.00000000000044, 45.1, 8.299999999999677, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 50, 202, 284, 74, 66, 500, 500, 500, 122, 142, 42, 204, 260, 198, 184, 58, 500, 70, 40, 316, 500, 298, 500, 96, 60, 100, 52, 250, 76, 500, 304, 64, 48, 194, 48, 52, 500, 72, 500, 60, 114, 500, 84, 114, 46, 72, 78, 192, 500, 72, 176, 78, 78, 78, 278, 96, 86, 38, 500, 500, 236, 84, 500, 54, 500, 86, 500, 500, 500, 164, 156, 88, 98, 60, 182, 42, 170, 362, 296, 152, 98, 62, 500, 50, 418, 46, 116, 500, 500, 42, 500, 500, 130, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841118101057816, "mean_inference_ms": 1.23163768585173, "mean_action_processing_ms": 0.14381417778946, "mean_env_wait_ms": 0.08364257248603722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299522399902344, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.12398719787597656}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.070999999999858, "episode_len_mean": 235.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 45.1, 29.899999999999984, 21.699999999999868, 42.70000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 35.900000000000034, 45.9, 29.69999999999998, 24.099999999999902, 30.29999999999999, 31.70000000000001, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.099999999999994, 18.499999999999822, -50.00000000000044, 20.299999999999848, -50.00000000000044, 40.500000000000014, 44.10000000000001, 40.10000000000002, 44.900000000000006, 25.099999999999916, 42.500000000000014, -50.00000000000044, 19.69999999999984, 43.7, 45.3, 30.699999999999996, 45.3, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 41.70000000000002, 38.700000000000024, 45.5, 42.900000000000006, 42.30000000000001, 30.9, -50.00000000000044, 42.900000000000006, 32.50000000000002, 42.30000000000001, 42.30000000000001, 42.30000000000001, 22.299999999999876, 40.500000000000014, 41.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, 26.499999999999936, 41.70000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 34.50000000000004, 41.30000000000001, 40.30000000000002, 44.10000000000001, 31.900000000000013, 45.9, 33.10000000000003, 13.899999999999757, 20.49999999999985, 34.900000000000034, 40.30000000000002, 43.900000000000006, -50.00000000000044, 45.1, 8.299999999999677, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 50, 202, 284, 74, 66, 500, 500, 500, 122, 142, 42, 204, 260, 198, 184, 58, 500, 70, 40, 316, 500, 298, 500, 96, 60, 100, 52, 250, 76, 500, 304, 64, 48, 194, 48, 52, 500, 72, 500, 60, 114, 500, 84, 114, 46, 72, 78, 192, 500, 72, 176, 78, 78, 78, 278, 96, 86, 38, 500, 500, 236, 84, 500, 54, 500, 86, 500, 500, 500, 164, 156, 88, 98, 60, 182, 42, 170, 362, 296, 152, 98, 62, 500, 50, 418, 46, 116, 500, 500, 42, 500, 500, 130, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841118101057816, "mean_inference_ms": 1.23163768585173, "mean_action_processing_ms": 0.14381417778946, "mean_env_wait_ms": 0.08364257248603722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299522399902344, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.12398719787597656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5011.134183750173, "num_env_steps_trained_throughput_per_sec": 5011.134183750173, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3402.798, "sample_time_ms": 2925.597, "load_time_ms": 15.803, "load_throughput": 1139042.9, "learn_time_ms": 450.706, "learn_throughput": 39937.321, "synch_weights_time_ms": 8.793}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2833, "training_iteration": 40, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-14", "timestamp": 1698245774, "time_this_iter_s": 3.5960001945495605, "time_total_s": 131.44043588638306, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.44043588638306, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.339999999999996, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458558e-13, "cur_lr": 0.0003, "total_loss": 7.546633328331842, "policy_loss": -0.00017279634873072305, "vf_loss": 7.5468652725219725, "vf_explained_var": 7.064607408311632e-05, "kl": 0.0016108859762815322, "entropy": 0.591909012529585, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.819999999999839, "episode_len_mean": 262.48, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.10000000000003, 13.899999999999757, 20.49999999999985, 34.900000000000034, 40.30000000000002, 43.900000000000006, -50.00000000000044, 45.1, 8.299999999999677, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, 45.1, -50.00000000000044, 31.900000000000013, 42.10000000000001, 39.70000000000002, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 34.50000000000004, 42.70000000000001, 40.90000000000002, 35.10000000000004, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 12.499999999999737, 42.70000000000001, 40.70000000000002, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 45.5, 30.9, -50.00000000000044, -50.00000000000044, 28.09999999999996, 27.099999999999945, 43.50000000000001, 33.10000000000003, 28.09999999999996, 31.900000000000013, -50.00000000000044, 30.099999999999987, 43.900000000000006, 38.10000000000002, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.3, 33.90000000000004, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.7, 22.699999999999882, 44.300000000000004, 8.49999999999968, 47.1, 4.699999999999626, 41.30000000000001, 43.7, -50.00000000000044, 18.099999999999817, 41.500000000000014, 42.30000000000001, -50.00000000000044, 34.900000000000034, 32.90000000000003, -50.00000000000044, 39.300000000000026, 13.899999999999757, 3.899999999999615, 35.10000000000004, 42.10000000000001], "episode_lengths": [170, 362, 296, 152, 98, 62, 500, 50, 418, 46, 116, 500, 500, 42, 500, 500, 130, 500, 500, 500, 500, 500, 500, 254, 50, 500, 182, 80, 104, 500, 118, 58, 500, 156, 74, 92, 150, 54, 78, 500, 500, 92, 500, 182, 500, 376, 74, 94, 500, 88, 72, 500, 42, 500, 46, 192, 500, 500, 220, 230, 66, 170, 220, 182, 500, 200, 62, 120, 202, 500, 500, 500, 114, 48, 162, 108, 500, 76, 500, 64, 274, 58, 416, 30, 454, 88, 64, 500, 320, 86, 78, 500, 152, 172, 500, 108, 362, 462, 150, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3837450139462294, "mean_inference_ms": 1.2301907912895844, "mean_action_processing_ms": 0.14412555479735853, "mean_env_wait_ms": 0.08367341573857524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.10999250411987305}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.819999999999839, "episode_len_mean": 262.48, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.10000000000003, 13.899999999999757, 20.49999999999985, 34.900000000000034, 40.30000000000002, 43.900000000000006, -50.00000000000044, 45.1, 8.299999999999677, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, 45.1, -50.00000000000044, 31.900000000000013, 42.10000000000001, 39.70000000000002, -50.00000000000044, 38.300000000000026, 44.300000000000004, -50.00000000000044, 34.50000000000004, 42.70000000000001, 40.90000000000002, 35.10000000000004, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 12.499999999999737, 42.70000000000001, 40.70000000000002, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, 45.9, -50.00000000000044, 45.5, 30.9, -50.00000000000044, -50.00000000000044, 28.09999999999996, 27.099999999999945, 43.50000000000001, 33.10000000000003, 28.09999999999996, 31.900000000000013, -50.00000000000044, 30.099999999999987, 43.900000000000006, 38.10000000000002, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.3, 33.90000000000004, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.7, 22.699999999999882, 44.300000000000004, 8.49999999999968, 47.1, 4.699999999999626, 41.30000000000001, 43.7, -50.00000000000044, 18.099999999999817, 41.500000000000014, 42.30000000000001, -50.00000000000044, 34.900000000000034, 32.90000000000003, -50.00000000000044, 39.300000000000026, 13.899999999999757, 3.899999999999615, 35.10000000000004, 42.10000000000001], "episode_lengths": [170, 362, 296, 152, 98, 62, 500, 50, 418, 46, 116, 500, 500, 42, 500, 500, 130, 500, 500, 500, 500, 500, 500, 254, 50, 500, 182, 80, 104, 500, 118, 58, 500, 156, 74, 92, 150, 54, 78, 500, 500, 92, 500, 182, 500, 376, 74, 94, 500, 88, 72, 500, 42, 500, 46, 192, 500, 500, 220, 230, 66, 170, 220, 182, 500, 200, 62, 120, 202, 500, 500, 500, 114, 48, 162, 108, 500, 76, 500, 64, 274, 58, 416, 30, 454, 88, 64, 500, 320, 86, 78, 500, 152, 172, 500, 108, 362, 462, 150, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3837450139462294, "mean_inference_ms": 1.2301907912895844, "mean_action_processing_ms": 0.14412555479735853, "mean_env_wait_ms": 0.08367341573857524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.10999250411987305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5477.829827368575, "num_env_steps_trained_throughput_per_sec": 5477.829827368575, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3385.695, "sample_time_ms": 2918.694, "load_time_ms": 15.003, "load_throughput": 1199789.466, "learn_time_ms": 441.206, "learn_throughput": 40797.254, "synch_weights_time_ms": 8.893}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2911, "training_iteration": 41, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-17", "timestamp": 1698245777, "time_this_iter_s": 3.2919704914093018, "time_total_s": 134.73240637779236, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.73240637779236, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 56.720000000000006, "ram_util_percent": 27.18}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729279e-14, "cur_lr": 0.0003, "total_loss": 6.85772885216607, "policy_loss": -0.00042184177372190686, "vf_loss": 6.858204280005561, "vf_explained_var": 1.8383396996392144e-05, "kl": 0.0007408640514363975, "entropy": 0.534856974416309, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.103999999999838, "episode_len_mean": 249.64, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 33.90000000000004, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.7, 22.699999999999882, 44.300000000000004, 8.49999999999968, 47.1, 4.699999999999626, 41.30000000000001, 43.7, -50.00000000000044, 18.099999999999817, 41.500000000000014, 42.30000000000001, -50.00000000000044, 34.900000000000034, 32.90000000000003, -50.00000000000044, 39.300000000000026, 13.899999999999757, 3.899999999999615, 35.10000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.90000000000003, -50.00000000000044, 39.300000000000026, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.10000000000003, -50.00000000000044, 40.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 42.500000000000014, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 38.50000000000003, 46.699999999999996, 43.900000000000006, -50.00000000000044, 43.50000000000001, 40.70000000000002, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 43.7, 1.099999999999575, 38.50000000000003, 17.69999999999981, 20.899999999999856, 32.100000000000016, 45.7, 30.499999999999993, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.90000000000002, 44.5, 36.30000000000003, -50.00000000000044, 36.50000000000003, 46.099999999999994, 42.10000000000001, 18.899999999999828, -50.00000000000044], "episode_lengths": [48, 162, 108, 500, 76, 500, 64, 274, 58, 416, 30, 454, 88, 64, 500, 320, 86, 78, 500, 152, 172, 500, 108, 362, 462, 150, 80, 500, 500, 500, 500, 104, 122, 500, 108, 40, 66, 500, 500, 140, 48, 500, 500, 86, 68, 500, 500, 34, 500, 130, 500, 96, 56, 500, 276, 76, 500, 90, 500, 54, 116, 34, 62, 500, 66, 94, 40, 500, 52, 500, 500, 48, 38, 74, 100, 500, 500, 44, 500, 82, 64, 490, 116, 324, 292, 180, 44, 196, 500, 138, 500, 102, 56, 138, 500, 136, 40, 80, 312, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3835788567019172, "mean_inference_ms": 1.2301354375138305, "mean_action_processing_ms": 0.1439856142370126, "mean_env_wait_ms": 0.08352430863716276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022989749908447266, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.09400248527526855}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.103999999999838, "episode_len_mean": 249.64, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 33.90000000000004, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.7, 22.699999999999882, 44.300000000000004, 8.49999999999968, 47.1, 4.699999999999626, 41.30000000000001, 43.7, -50.00000000000044, 18.099999999999817, 41.500000000000014, 42.30000000000001, -50.00000000000044, 34.900000000000034, 32.90000000000003, -50.00000000000044, 39.300000000000026, 13.899999999999757, 3.899999999999615, 35.10000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.90000000000003, -50.00000000000044, 39.300000000000026, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 45.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.10000000000003, -50.00000000000044, 40.500000000000014, 44.5, -50.00000000000044, 22.49999999999988, 42.500000000000014, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 38.50000000000003, 46.699999999999996, 43.900000000000006, -50.00000000000044, 43.50000000000001, 40.70000000000002, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 43.7, 1.099999999999575, 38.50000000000003, 17.69999999999981, 20.899999999999856, 32.100000000000016, 45.7, 30.499999999999993, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.90000000000002, 44.5, 36.30000000000003, -50.00000000000044, 36.50000000000003, 46.099999999999994, 42.10000000000001, 18.899999999999828, -50.00000000000044], "episode_lengths": [48, 162, 108, 500, 76, 500, 64, 274, 58, 416, 30, 454, 88, 64, 500, 320, 86, 78, 500, 152, 172, 500, 108, 362, 462, 150, 80, 500, 500, 500, 500, 104, 122, 500, 108, 40, 66, 500, 500, 140, 48, 500, 500, 86, 68, 500, 500, 34, 500, 130, 500, 96, 56, 500, 276, 76, 500, 90, 500, 54, 116, 34, 62, 500, 66, 94, 40, 500, 52, 500, 500, 48, 38, 74, 100, 500, 500, 44, 500, 82, 64, 490, 116, 324, 292, 180, 44, 196, 500, 138, 500, 102, 56, 138, 500, 136, 40, 80, 312, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3835788567019172, "mean_inference_ms": 1.2301354375138305, "mean_action_processing_ms": 0.1439856142370126, "mean_env_wait_ms": 0.08352430863716276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022989749908447266, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.09400248527526855}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5320.720665356199, "num_env_steps_trained_throughput_per_sec": 5320.720665356199, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3380.695, "sample_time_ms": 2915.594, "load_time_ms": 15.603, "load_throughput": 1153660.006, "learn_time_ms": 438.709, "learn_throughput": 41029.429, "synch_weights_time_ms": 8.89}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2984, "training_iteration": 42, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-21", "timestamp": 1698245781, "time_this_iter_s": 3.3879995346069336, "time_total_s": 138.1204059123993, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.1204059123993, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 55.28000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.5474735088646395e-14, "cur_lr": 0.0003, "total_loss": 6.906637668609619, "policy_loss": -0.00030507991711298623, "vf_loss": 6.907002597384983, "vf_explained_var": -0.0003649645381503635, "kl": 0.0010900660748600583, "entropy": 0.5984419027964274, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1913.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.146999999999851, "episode_len_mean": 244.24, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 46.3, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 43.7, 1.099999999999575, 38.50000000000003, 17.69999999999981, 20.899999999999856, 32.100000000000016, 45.7, 30.499999999999993, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.90000000000002, 44.5, 36.30000000000003, -50.00000000000044, 36.50000000000003, 46.099999999999994, 42.10000000000001, 18.899999999999828, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.7, 21.89999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, 41.90000000000001, 40.30000000000002, -50.00000000000044, 9.299999999999692, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.90000000000002, -50.00000000000044, 43.30000000000001, 8.099999999999675, 35.500000000000036, 35.500000000000036, 41.90000000000001, 38.50000000000003, -50.00000000000044, 44.5, 46.699999999999996, 39.70000000000002, -50.00000000000044, 1.6999999999995836, 39.50000000000002, 16.499999999999794, 32.700000000000024, 30.29999999999999, 25.899999999999928, -50.00000000000044, 38.700000000000024, 39.90000000000002, 46.099999999999994, 43.900000000000006, 39.70000000000002, 44.300000000000004, 41.70000000000002, 36.10000000000004, 11.29999999999972, 46.9, 46.9, 42.70000000000001, 44.5, 45.9, 41.90000000000001, -50.00000000000044, 29.69999999999998], "episode_lengths": [500, 48, 38, 74, 100, 500, 500, 44, 500, 82, 64, 490, 116, 324, 292, 180, 44, 196, 500, 138, 500, 102, 56, 138, 500, 136, 40, 80, 312, 500, 386, 500, 500, 170, 500, 254, 500, 500, 68, 500, 44, 282, 500, 62, 500, 72, 500, 64, 82, 98, 500, 408, 134, 500, 500, 500, 500, 66, 98, 500, 64, 500, 50, 102, 500, 68, 420, 146, 146, 82, 116, 500, 56, 34, 104, 500, 484, 106, 336, 174, 198, 242, 500, 114, 102, 40, 62, 104, 58, 84, 140, 388, 32, 32, 74, 56, 42, 82, 500, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3834924869157889, "mean_inference_ms": 1.2282901184477668, "mean_action_processing_ms": 0.144399566638947, "mean_env_wait_ms": 0.08331909559348707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993534088134766, "StateBufferConnector_ms": 0.006004810333251953, "ViewRequirementAgentConnector_ms": 0.11100459098815918}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.146999999999851, "episode_len_mean": 244.24, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, 46.3, 42.70000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, 43.7, 1.099999999999575, 38.50000000000003, 17.69999999999981, 20.899999999999856, 32.100000000000016, 45.7, 30.499999999999993, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.90000000000002, 44.5, 36.30000000000003, -50.00000000000044, 36.50000000000003, 46.099999999999994, 42.10000000000001, 18.899999999999828, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.7, 21.89999999999987, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, 41.90000000000001, 40.30000000000002, -50.00000000000044, 9.299999999999692, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, 45.1, 39.90000000000002, -50.00000000000044, 43.30000000000001, 8.099999999999675, 35.500000000000036, 35.500000000000036, 41.90000000000001, 38.50000000000003, -50.00000000000044, 44.5, 46.699999999999996, 39.70000000000002, -50.00000000000044, 1.6999999999995836, 39.50000000000002, 16.499999999999794, 32.700000000000024, 30.29999999999999, 25.899999999999928, -50.00000000000044, 38.700000000000024, 39.90000000000002, 46.099999999999994, 43.900000000000006, 39.70000000000002, 44.300000000000004, 41.70000000000002, 36.10000000000004, 11.29999999999972, 46.9, 46.9, 42.70000000000001, 44.5, 45.9, 41.90000000000001, -50.00000000000044, 29.69999999999998], "episode_lengths": [500, 48, 38, 74, 100, 500, 500, 44, 500, 82, 64, 490, 116, 324, 292, 180, 44, 196, 500, 138, 500, 102, 56, 138, 500, 136, 40, 80, 312, 500, 386, 500, 500, 170, 500, 254, 500, 500, 68, 500, 44, 282, 500, 62, 500, 72, 500, 64, 82, 98, 500, 408, 134, 500, 500, 500, 500, 66, 98, 500, 64, 500, 50, 102, 500, 68, 420, 146, 146, 82, 116, 500, 56, 34, 104, 500, 484, 106, 336, 174, 198, 242, 500, 114, 102, 40, 62, 104, 58, 84, 140, 388, 32, 32, 74, 56, 42, 82, 500, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3834924869157889, "mean_inference_ms": 1.2282901184477668, "mean_action_processing_ms": 0.144399566638947, "mean_env_wait_ms": 0.08331909559348707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993534088134766, "StateBufferConnector_ms": 0.006004810333251953, "ViewRequirementAgentConnector_ms": 0.11100459098815918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5446.2902415874905, "num_env_steps_trained_throughput_per_sec": 5446.2902415874905, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3376.595, "sample_time_ms": 2912.494, "load_time_ms": 14.702, "load_throughput": 1224282.668, "learn_time_ms": 438.712, "learn_throughput": 41029.165, "synch_weights_time_ms": 8.887}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 3054, "training_iteration": 43, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-24", "timestamp": 1698245784, "time_this_iter_s": 3.309999942779541, "time_total_s": 141.43040585517883, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 141.43040585517883, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 64.525, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323198e-14, "cur_lr": 0.0003, "total_loss": 7.1828405380249025, "policy_loss": -0.0002998567289776272, "vf_loss": 7.183197869194879, "vf_explained_var": -0.0010303391350640191, "kl": 0.0014543686321221432, "entropy": 0.5727599210209317, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.22599999999986, "episode_len_mean": 238.48, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, -50.00000000000044, 44.5, 46.699999999999996, 39.70000000000002, -50.00000000000044, 1.6999999999995836, 39.50000000000002, 16.499999999999794, 32.700000000000024, 30.29999999999999, 25.899999999999928, -50.00000000000044, 38.700000000000024, 39.90000000000002, 46.099999999999994, 43.900000000000006, 39.70000000000002, 44.300000000000004, 41.70000000000002, 36.10000000000004, 11.29999999999972, 46.9, 46.9, 42.70000000000001, 44.5, 45.9, 41.90000000000001, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.300000000000026, -50.00000000000044, 11.499999999999723, 42.10000000000001, -50.00000000000044, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 28.29999999999996, 26.69999999999994, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, 37.70000000000003, 37.70000000000003, 32.700000000000024, 44.900000000000006, 45.9, 44.5, 44.5, 34.50000000000004, -50.00000000000044, 7.09999999999966, 35.900000000000034, 2.0999999999995893, -50.00000000000044, 30.699999999999996, 42.900000000000006, 34.10000000000004, 22.699999999999882, 16.29999999999979, 30.9, 30.29999999999999, 39.300000000000026, 42.30000000000001, 45.9, 39.10000000000002, -50.00000000000044, 23.099999999999888, -50.00000000000044, 34.30000000000004, 43.10000000000001, 38.10000000000002, 40.70000000000002, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 17.299999999999805, 28.09999999999996, 41.70000000000002, 45.7, 41.70000000000002, 45.3, -50.00000000000044], "episode_lengths": [116, 500, 56, 34, 104, 500, 484, 106, 336, 174, 198, 242, 500, 114, 102, 40, 62, 104, 58, 84, 140, 388, 32, 32, 74, 56, 42, 82, 500, 204, 500, 500, 446, 500, 66, 500, 500, 44, 500, 500, 100, 108, 500, 386, 80, 500, 62, 84, 500, 500, 218, 234, 500, 112, 500, 60, 124, 124, 174, 52, 42, 56, 56, 156, 500, 430, 142, 480, 500, 194, 72, 160, 274, 338, 192, 198, 108, 78, 42, 110, 500, 270, 500, 158, 70, 120, 94, 500, 144, 500, 500, 500, 118, 328, 220, 84, 44, 84, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38365138441394353, "mean_inference_ms": 1.2278964338165483, "mean_action_processing_ms": 0.14428294383372275, "mean_env_wait_ms": 0.08320491585358548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022007226943969727, "StateBufferConnector_ms": 0.0030031204223632812, "ViewRequirementAgentConnector_ms": 0.10599017143249512}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.22599999999986, "episode_len_mean": 238.48, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, -50.00000000000044, 44.5, 46.699999999999996, 39.70000000000002, -50.00000000000044, 1.6999999999995836, 39.50000000000002, 16.499999999999794, 32.700000000000024, 30.29999999999999, 25.899999999999928, -50.00000000000044, 38.700000000000024, 39.90000000000002, 46.099999999999994, 43.900000000000006, 39.70000000000002, 44.300000000000004, 41.70000000000002, 36.10000000000004, 11.29999999999972, 46.9, 46.9, 42.70000000000001, 44.5, 45.9, 41.90000000000001, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.300000000000026, -50.00000000000044, 11.499999999999723, 42.10000000000001, -50.00000000000044, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 28.29999999999996, 26.69999999999994, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, 37.70000000000003, 37.70000000000003, 32.700000000000024, 44.900000000000006, 45.9, 44.5, 44.5, 34.50000000000004, -50.00000000000044, 7.09999999999966, 35.900000000000034, 2.0999999999995893, -50.00000000000044, 30.699999999999996, 42.900000000000006, 34.10000000000004, 22.699999999999882, 16.29999999999979, 30.9, 30.29999999999999, 39.300000000000026, 42.30000000000001, 45.9, 39.10000000000002, -50.00000000000044, 23.099999999999888, -50.00000000000044, 34.30000000000004, 43.10000000000001, 38.10000000000002, 40.70000000000002, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 17.299999999999805, 28.09999999999996, 41.70000000000002, 45.7, 41.70000000000002, 45.3, -50.00000000000044], "episode_lengths": [116, 500, 56, 34, 104, 500, 484, 106, 336, 174, 198, 242, 500, 114, 102, 40, 62, 104, 58, 84, 140, 388, 32, 32, 74, 56, 42, 82, 500, 204, 500, 500, 446, 500, 66, 500, 500, 44, 500, 500, 100, 108, 500, 386, 80, 500, 62, 84, 500, 500, 218, 234, 500, 112, 500, 60, 124, 124, 174, 52, 42, 56, 56, 156, 500, 430, 142, 480, 500, 194, 72, 160, 274, 338, 192, 198, 108, 78, 42, 110, 500, 270, 500, 158, 70, 120, 94, 500, 144, 500, 500, 500, 118, 328, 220, 84, 44, 84, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38365138441394353, "mean_inference_ms": 1.2278964338165483, "mean_action_processing_ms": 0.14428294383372275, "mean_env_wait_ms": 0.08320491585358548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022007226943969727, "StateBufferConnector_ms": 0.0030031204223632812, "ViewRequirementAgentConnector_ms": 0.10599017143249512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5429.863769146395, "num_env_steps_trained_throughput_per_sec": 5429.863769146395, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3357.295, "sample_time_ms": 2903.294, "load_time_ms": 14.806, "load_throughput": 1215759.867, "learn_time_ms": 428.406, "learn_throughput": 42016.186, "synch_weights_time_ms": 9.09}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3124, "training_iteration": 44, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-27", "timestamp": 1698245787, "time_this_iter_s": 3.321000576019287, "time_total_s": 144.75140643119812, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.75140643119812, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.80000000000001, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161599e-14, "cur_lr": 0.0003, "total_loss": 6.315218395657009, "policy_loss": -0.0005080594784683651, "vf_loss": 6.315783045026991, "vf_explained_var": 0.0005277037620544433, "kl": 0.001199510089092352, "entropy": 0.5650519238577949, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2003.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.561999999999832, "episode_len_mean": 265.04, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, 32.700000000000024, 44.900000000000006, 45.9, 44.5, 44.5, 34.50000000000004, -50.00000000000044, 7.09999999999966, 35.900000000000034, 2.0999999999995893, -50.00000000000044, 30.699999999999996, 42.900000000000006, 34.10000000000004, 22.699999999999882, 16.29999999999979, 30.9, 30.29999999999999, 39.300000000000026, 42.30000000000001, 45.9, 39.10000000000002, -50.00000000000044, 23.099999999999888, -50.00000000000044, 34.30000000000004, 43.10000000000001, 38.10000000000002, 40.70000000000002, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 17.299999999999805, 28.09999999999996, 41.70000000000002, 45.7, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 40.500000000000014, 47.1, -50.00000000000044, 42.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 14.09999999999976, 30.29999999999999, 41.30000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044, 7.899999999999672, -50.00000000000044, 28.89999999999997, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, 40.10000000000002, 33.70000000000004, -50.00000000000044, 40.90000000000002, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.5, 37.300000000000026], "episode_lengths": [124, 174, 52, 42, 56, 56, 156, 500, 430, 142, 480, 500, 194, 72, 160, 274, 338, 192, 198, 108, 78, 42, 110, 500, 270, 500, 158, 70, 120, 94, 500, 144, 500, 500, 500, 118, 328, 220, 84, 44, 84, 48, 500, 500, 500, 404, 96, 30, 500, 72, 88, 500, 500, 46, 90, 500, 140, 500, 500, 92, 360, 198, 88, 500, 124, 500, 420, 500, 500, 70, 500, 500, 56, 42, 500, 422, 500, 212, 500, 66, 500, 500, 120, 500, 58, 500, 74, 44, 500, 100, 164, 500, 92, 136, 66, 500, 500, 100, 46, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38375624633897004, "mean_inference_ms": 1.2290024550543022, "mean_action_processing_ms": 0.14396932710768848, "mean_env_wait_ms": 0.08371316190288368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.10098648071289062}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.561999999999832, "episode_len_mean": 265.04, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, 32.700000000000024, 44.900000000000006, 45.9, 44.5, 44.5, 34.50000000000004, -50.00000000000044, 7.09999999999966, 35.900000000000034, 2.0999999999995893, -50.00000000000044, 30.699999999999996, 42.900000000000006, 34.10000000000004, 22.699999999999882, 16.29999999999979, 30.9, 30.29999999999999, 39.300000000000026, 42.30000000000001, 45.9, 39.10000000000002, -50.00000000000044, 23.099999999999888, -50.00000000000044, 34.30000000000004, 43.10000000000001, 38.10000000000002, 40.70000000000002, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 17.299999999999805, 28.09999999999996, 41.70000000000002, 45.7, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 40.500000000000014, 47.1, -50.00000000000044, 42.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 14.09999999999976, 30.29999999999999, 41.30000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044, 7.899999999999672, -50.00000000000044, 28.89999999999997, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, 40.10000000000002, 33.70000000000004, -50.00000000000044, 40.90000000000002, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.5, 37.300000000000026], "episode_lengths": [124, 174, 52, 42, 56, 56, 156, 500, 430, 142, 480, 500, 194, 72, 160, 274, 338, 192, 198, 108, 78, 42, 110, 500, 270, 500, 158, 70, 120, 94, 500, 144, 500, 500, 500, 118, 328, 220, 84, 44, 84, 48, 500, 500, 500, 404, 96, 30, 500, 72, 88, 500, 500, 46, 90, 500, 140, 500, 500, 92, 360, 198, 88, 500, 124, 500, 420, 500, 500, 70, 500, 500, 56, 42, 500, 422, 500, 212, 500, 66, 500, 500, 120, 500, 58, 500, 74, 44, 500, 100, 164, 500, 92, 136, 66, 500, 500, 100, 46, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38375624633897004, "mean_inference_ms": 1.2290024550543022, "mean_action_processing_ms": 0.14396932710768848, "mean_env_wait_ms": 0.08371316190288368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.10098648071289062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5487.804527016095, "num_env_steps_trained_throughput_per_sec": 5487.804527016095, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3360.798, "sample_time_ms": 2893.097, "load_time_ms": 15.409, "load_throughput": 1168185.183, "learn_time_ms": 441.503, "learn_throughput": 40769.809, "synch_weights_time_ms": 9.19}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3181, "training_iteration": 45, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-31", "timestamp": 1698245791, "time_this_iter_s": 3.2849996089935303, "time_total_s": 148.03640604019165, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.03640604019165, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 56.239999999999995, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860807994e-15, "cur_lr": 0.0003, "total_loss": 6.6854456689622666, "policy_loss": -0.00016987051090432538, "vf_loss": 6.685665893554687, "vf_explained_var": 0.0020183881123860678, "kl": 0.0008805846211253588, "entropy": 0.5042833480570051, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2048.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.56399999999983, "episode_len_mean": 255.0, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 7.899999999999672, -50.00000000000044, 28.89999999999997, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, 40.10000000000002, 33.70000000000004, -50.00000000000044, 40.90000000000002, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.5, 37.300000000000026, 42.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 42.10000000000001, 45.7, 38.700000000000024, 47.1, 39.10000000000002, -50.00000000000044, 41.100000000000016, 45.5, 8.299999999999677, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.500000000000014, 39.90000000000002, 42.10000000000001, 32.100000000000016, 34.900000000000034, 42.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 30.499999999999993, 38.700000000000024, 44.7, 34.30000000000004, 43.7, 45.3, 45.3, 42.70000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 5.6999999999996405, 11.699999999999726, 44.900000000000006, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.699999999999996, 28.89999999999997, 34.30000000000004, 44.900000000000006, 30.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, -50.00000000000044], "episode_lengths": [42, 500, 422, 500, 212, 500, 66, 500, 500, 120, 500, 58, 500, 74, 44, 500, 100, 164, 500, 92, 136, 66, 500, 500, 100, 46, 128, 78, 500, 64, 500, 80, 44, 114, 30, 110, 500, 90, 46, 418, 62, 500, 96, 500, 76, 102, 80, 180, 152, 72, 500, 38, 500, 500, 80, 196, 114, 54, 158, 64, 48, 48, 74, 500, 102, 500, 500, 118, 500, 500, 50, 500, 48, 444, 384, 52, 40, 500, 68, 500, 56, 42, 500, 500, 500, 500, 500, 500, 470, 34, 212, 158, 52, 192, 62, 500, 500, 72, 206, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3833517527566779, "mean_inference_ms": 1.2274716217836137, "mean_action_processing_ms": 0.14383896582232736, "mean_env_wait_ms": 0.08344675564629264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037017822265625, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.13496851921081543}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.56399999999983, "episode_len_mean": 255.0, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 7.899999999999672, -50.00000000000044, 28.89999999999997, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, 40.10000000000002, 33.70000000000004, -50.00000000000044, 40.90000000000002, 36.50000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 45.5, 37.300000000000026, 42.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 42.10000000000001, 45.7, 38.700000000000024, 47.1, 39.10000000000002, -50.00000000000044, 41.100000000000016, 45.5, 8.299999999999677, 43.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.500000000000014, 39.90000000000002, 42.10000000000001, 32.100000000000016, 34.900000000000034, 42.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 30.499999999999993, 38.700000000000024, 44.7, 34.30000000000004, 43.7, 45.3, 45.3, 42.70000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 5.6999999999996405, 11.699999999999726, 44.900000000000006, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.699999999999996, 28.89999999999997, 34.30000000000004, 44.900000000000006, 30.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, -50.00000000000044], "episode_lengths": [42, 500, 422, 500, 212, 500, 66, 500, 500, 120, 500, 58, 500, 74, 44, 500, 100, 164, 500, 92, 136, 66, 500, 500, 100, 46, 128, 78, 500, 64, 500, 80, 44, 114, 30, 110, 500, 90, 46, 418, 62, 500, 96, 500, 76, 102, 80, 180, 152, 72, 500, 38, 500, 500, 80, 196, 114, 54, 158, 64, 48, 48, 74, 500, 102, 500, 500, 118, 500, 500, 50, 500, 48, 444, 384, 52, 40, 500, 68, 500, 56, 42, 500, 500, 500, 500, 500, 500, 470, 34, 212, 158, 52, 192, 62, 500, 500, 72, 206, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3833517527566779, "mean_inference_ms": 1.2274716217836137, "mean_action_processing_ms": 0.14383896582232736, "mean_env_wait_ms": 0.08344675564629264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037017822265625, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.13496851921081543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5218.904930627025, "num_env_steps_trained_throughput_per_sec": 5218.904930627025, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3357.598, "sample_time_ms": 2884.797, "load_time_ms": 16.409, "load_throughput": 1096977.066, "learn_time_ms": 445.706, "learn_throughput": 40385.365, "synch_weights_time_ms": 9.187}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3254, "training_iteration": 46, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-34", "timestamp": 1698245794, "time_this_iter_s": 3.4539995193481445, "time_total_s": 151.4904055595398, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.4904055595398, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 54.720000000000006, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430403997e-15, "cur_lr": 0.0003, "total_loss": 6.79623072942098, "policy_loss": -0.0005374207885728942, "vf_loss": 6.79681740866767, "vf_explained_var": -0.002210170692867703, "kl": 0.0012568204850948758, "entropy": 0.4931588808695475, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.95099999999981, "episode_len_mean": 266.12, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.6999999999996405, 11.699999999999726, 44.900000000000006, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.699999999999996, 28.89999999999997, 34.30000000000004, 44.900000000000006, 30.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.3, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 46.5, 29.49999999999998, 22.899999999999885, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 40.30000000000002, 44.5, 44.7, -50.00000000000044, 41.30000000000001, 42.500000000000014, 22.49999999999988, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, 18.099999999999817, -50.00000000000044, 45.9, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 38.700000000000024, -50.00000000000044, 19.69999999999984, 43.50000000000001, 45.7, 45.5, 16.29999999999979, 45.9, 42.900000000000006, 22.099999999999874, 38.50000000000003, 22.699999999999882, 41.500000000000014, 19.499999999999837, 42.70000000000001, 38.10000000000002, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [444, 384, 52, 40, 500, 68, 500, 56, 42, 500, 500, 500, 500, 500, 500, 470, 34, 212, 158, 52, 192, 62, 500, 500, 72, 206, 500, 496, 500, 500, 500, 500, 500, 56, 28, 500, 50, 58, 500, 36, 206, 272, 500, 78, 60, 500, 98, 56, 54, 500, 88, 76, 276, 40, 500, 500, 78, 500, 100, 500, 44, 320, 500, 42, 74, 52, 500, 500, 56, 114, 500, 304, 66, 44, 46, 338, 42, 72, 280, 116, 274, 86, 306, 74, 120, 500, 44, 48, 500, 500, 58, 48, 198, 500, 48, 500, 500, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831931360610461, "mean_inference_ms": 1.2280487641099451, "mean_action_processing_ms": 0.14396616343611285, "mean_env_wait_ms": 0.08364199085945934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024007320404052734, "StateBufferConnector_ms": 0.006018638610839844, "ViewRequirementAgentConnector_ms": 0.1369926929473877}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.95099999999981, "episode_len_mean": 266.12, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.6999999999996405, 11.699999999999726, 44.900000000000006, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.699999999999996, 28.89999999999997, 34.30000000000004, 44.900000000000006, 30.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.900000000000006, 29.49999999999998, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 47.3, -50.00000000000044, 45.1, 44.300000000000004, -50.00000000000044, 46.5, 29.49999999999998, 22.899999999999885, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 40.30000000000002, 44.5, 44.7, -50.00000000000044, 41.30000000000001, 42.500000000000014, 22.49999999999988, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, 18.099999999999817, -50.00000000000044, 45.9, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 38.700000000000024, -50.00000000000044, 19.69999999999984, 43.50000000000001, 45.7, 45.5, 16.29999999999979, 45.9, 42.900000000000006, 22.099999999999874, 38.50000000000003, 22.699999999999882, 41.500000000000014, 19.499999999999837, 42.70000000000001, 38.10000000000002, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [444, 384, 52, 40, 500, 68, 500, 56, 42, 500, 500, 500, 500, 500, 500, 470, 34, 212, 158, 52, 192, 62, 500, 500, 72, 206, 500, 496, 500, 500, 500, 500, 500, 56, 28, 500, 50, 58, 500, 36, 206, 272, 500, 78, 60, 500, 98, 56, 54, 500, 88, 76, 276, 40, 500, 500, 78, 500, 100, 500, 44, 320, 500, 42, 74, 52, 500, 500, 56, 114, 500, 304, 66, 44, 46, 338, 42, 72, 280, 116, 274, 86, 306, 74, 120, 500, 44, 48, 500, 500, 58, 48, 198, 500, 48, 500, 500, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831931360610461, "mean_inference_ms": 1.2280487641099451, "mean_action_processing_ms": 0.14396616343611285, "mean_env_wait_ms": 0.08364199085945934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024007320404052734, "StateBufferConnector_ms": 0.006018638610839844, "ViewRequirementAgentConnector_ms": 0.1369926929473877}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5385.996397040129, "num_env_steps_trained_throughput_per_sec": 5385.996397040129, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3343.998, "sample_time_ms": 2872.597, "load_time_ms": 16.406, "load_throughput": 1097190.691, "learn_time_ms": 444.209, "learn_throughput": 40521.451, "synch_weights_time_ms": 9.187}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3327, "training_iteration": 47, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-38", "timestamp": 1698245798, "time_this_iter_s": 3.346999406814575, "time_total_s": 154.83740496635437, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 154.83740496635437, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 66.375, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715201999e-15, "cur_lr": 0.0003, "total_loss": 6.4158828099568685, "policy_loss": -0.0002721631692515479, "vf_loss": 6.416204060448541, "vf_explained_var": -0.0019556283950805664, "kl": 0.0005435763735922213, "entropy": 0.4918492330445184, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2138.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.421999999999837, "episode_len_mean": 246.44, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 38.700000000000024, -50.00000000000044, 19.69999999999984, 43.50000000000001, 45.7, 45.5, 16.29999999999979, 45.9, 42.900000000000006, 22.099999999999874, 38.50000000000003, 22.699999999999882, 41.500000000000014, 19.499999999999837, 42.70000000000001, 38.10000000000002, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 35.900000000000034, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 40.90000000000002, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, 19.899999999999842, 44.10000000000001, 36.10000000000004, 17.099999999999802, -50.00000000000044, 35.500000000000036, 35.70000000000003, 47.1, 42.10000000000001, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.9, -50.00000000000044, 45.5, 33.90000000000004, -50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 43.900000000000006, 29.49999999999998, -50.00000000000044, 44.900000000000006, 31.70000000000001, 43.10000000000001, 45.1, 9.499999999999694, 41.30000000000001], "episode_lengths": [56, 114, 500, 304, 66, 44, 46, 338, 42, 72, 280, 116, 274, 86, 306, 74, 120, 500, 44, 48, 500, 500, 58, 48, 198, 500, 48, 500, 500, 500, 48, 500, 78, 38, 500, 500, 86, 142, 60, 44, 500, 500, 500, 58, 500, 100, 500, 500, 264, 92, 90, 38, 500, 500, 248, 302, 60, 140, 330, 500, 146, 144, 30, 80, 500, 52, 46, 500, 500, 500, 90, 42, 500, 46, 162, 500, 32, 100, 500, 500, 72, 500, 500, 300, 500, 54, 54, 500, 500, 30, 46, 62, 206, 500, 52, 184, 70, 50, 406, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831882879855776, "mean_inference_ms": 1.2265181129144362, "mean_action_processing_ms": 0.14399034053991952, "mean_env_wait_ms": 0.08356881058227021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997400283813477, "StateBufferConnector_ms": 0.0040149688720703125, "ViewRequirementAgentConnector_ms": 0.13999176025390625}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.421999999999837, "episode_len_mean": 246.44, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 38.700000000000024, -50.00000000000044, 19.69999999999984, 43.50000000000001, 45.7, 45.5, 16.29999999999979, 45.9, 42.900000000000006, 22.099999999999874, 38.50000000000003, 22.699999999999882, 41.500000000000014, 19.499999999999837, 42.70000000000001, 38.10000000000002, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 35.900000000000034, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 40.90000000000002, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 25.29999999999992, 19.899999999999842, 44.10000000000001, 36.10000000000004, 17.099999999999802, -50.00000000000044, 35.500000000000036, 35.70000000000003, 47.1, 42.10000000000001, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.9, -50.00000000000044, 45.5, 33.90000000000004, -50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 43.900000000000006, 29.49999999999998, -50.00000000000044, 44.900000000000006, 31.70000000000001, 43.10000000000001, 45.1, 9.499999999999694, 41.30000000000001], "episode_lengths": [56, 114, 500, 304, 66, 44, 46, 338, 42, 72, 280, 116, 274, 86, 306, 74, 120, 500, 44, 48, 500, 500, 58, 48, 198, 500, 48, 500, 500, 500, 48, 500, 78, 38, 500, 500, 86, 142, 60, 44, 500, 500, 500, 58, 500, 100, 500, 500, 264, 92, 90, 38, 500, 500, 248, 302, 60, 140, 330, 500, 146, 144, 30, 80, 500, 52, 46, 500, 500, 500, 90, 42, 500, 46, 162, 500, 32, 100, 500, 500, 72, 500, 500, 300, 500, 54, 54, 500, 500, 30, 46, 62, 206, 500, 52, 184, 70, 50, 406, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831882879855776, "mean_inference_ms": 1.2265181129144362, "mean_action_processing_ms": 0.14399034053991952, "mean_env_wait_ms": 0.08356881058227021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997400283813477, "StateBufferConnector_ms": 0.0040149688720703125, "ViewRequirementAgentConnector_ms": 0.13999176025390625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5395.682351904465, "num_env_steps_trained_throughput_per_sec": 5395.682351904465, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3357.198, "sample_time_ms": 2864.897, "load_time_ms": 17.006, "load_throughput": 1058466.784, "learn_time_ms": 464.412, "learn_throughput": 38758.663, "synch_weights_time_ms": 9.183}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3395, "training_iteration": 48, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-41", "timestamp": 1698245801, "time_this_iter_s": 3.3409998416900635, "time_total_s": 158.17840480804443, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.17840480804443, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 55.739999999999995, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357600999e-16, "cur_lr": 0.0003, "total_loss": 6.880594963497586, "policy_loss": -0.0004228966931502024, "vf_loss": 6.88106869591607, "vf_explained_var": -0.0010217401716444228, "kl": 0.0007928788164850036, "entropy": 0.5084022581577301, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2183.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.636999999999835, "episode_len_mean": 249.3, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 43.900000000000006, 29.49999999999998, -50.00000000000044, 44.900000000000006, 31.70000000000001, 43.10000000000001, 45.1, 9.499999999999694, 41.30000000000001, -50.00000000000044, 45.5, 47.1, 40.30000000000002, -50.00000000000044, 29.49999999999998, 46.5, 31.900000000000013, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 12.69999999999974, 25.499999999999922, 47.3, 44.7, 43.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.099999999999987, 46.3, -50.00000000000044, 44.300000000000004, 13.899999999999757, 45.7, 44.300000000000004, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.50000000000003, 40.10000000000002, 45.9, 45.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 41.100000000000016, 10.499999999999709, 28.699999999999967, 39.300000000000026, 44.300000000000004, 37.70000000000003, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.30000000000001, 45.5, 38.50000000000003, 31.300000000000004, 30.9, 39.50000000000002, 33.500000000000036, 37.70000000000003], "episode_lengths": [500, 32, 100, 500, 500, 72, 500, 500, 300, 500, 54, 54, 500, 500, 30, 46, 62, 206, 500, 52, 184, 70, 50, 406, 88, 500, 46, 30, 98, 500, 206, 36, 182, 500, 184, 500, 40, 500, 32, 374, 246, 28, 54, 64, 500, 500, 202, 500, 500, 72, 200, 38, 500, 58, 362, 44, 58, 500, 182, 500, 500, 52, 500, 116, 100, 42, 42, 46, 500, 500, 500, 82, 500, 484, 500, 500, 90, 396, 214, 108, 58, 124, 84, 64, 92, 500, 136, 500, 56, 500, 500, 386, 78, 46, 116, 188, 192, 106, 166, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836424773518162, "mean_inference_ms": 1.2271453120532616, "mean_action_processing_ms": 0.14392503907465892, "mean_env_wait_ms": 0.08346646904731149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.010003328323364258, "ViewRequirementAgentConnector_ms": 0.12803006172180176}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.636999999999835, "episode_len_mean": 249.3, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.7, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 43.900000000000006, 29.49999999999998, -50.00000000000044, 44.900000000000006, 31.70000000000001, 43.10000000000001, 45.1, 9.499999999999694, 41.30000000000001, -50.00000000000044, 45.5, 47.1, 40.30000000000002, -50.00000000000044, 29.49999999999998, 46.5, 31.900000000000013, -50.00000000000044, 31.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 12.69999999999974, 25.499999999999922, 47.3, 44.7, 43.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 42.900000000000006, 30.099999999999987, 46.3, -50.00000000000044, 44.300000000000004, 13.899999999999757, 45.7, 44.300000000000004, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 38.50000000000003, 40.10000000000002, 45.9, 45.9, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 41.100000000000016, 10.499999999999709, 28.699999999999967, 39.300000000000026, 44.300000000000004, 37.70000000000003, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.30000000000001, 45.5, 38.50000000000003, 31.300000000000004, 30.9, 39.50000000000002, 33.500000000000036, 37.70000000000003], "episode_lengths": [500, 32, 100, 500, 500, 72, 500, 500, 300, 500, 54, 54, 500, 500, 30, 46, 62, 206, 500, 52, 184, 70, 50, 406, 88, 500, 46, 30, 98, 500, 206, 36, 182, 500, 184, 500, 40, 500, 32, 374, 246, 28, 54, 64, 500, 500, 202, 500, 500, 72, 200, 38, 500, 58, 362, 44, 58, 500, 182, 500, 500, 52, 500, 116, 100, 42, 42, 46, 500, 500, 500, 82, 500, 484, 500, 500, 90, 396, 214, 108, 58, 124, 84, 64, 92, 500, 136, 500, 56, 500, 500, 386, 78, 46, 116, 188, 192, 106, 166, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836424773518162, "mean_inference_ms": 1.2271453120532616, "mean_action_processing_ms": 0.14392503907465892, "mean_env_wait_ms": 0.08346646904731149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.010003328323364258, "ViewRequirementAgentConnector_ms": 0.12803006172180176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5300.352383437663, "num_env_steps_trained_throughput_per_sec": 5300.352383437663, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3368.298, "sample_time_ms": 2865.497, "load_time_ms": 17.906, "load_throughput": 1005268.476, "learn_time_ms": 474.109, "learn_throughput": 37965.918, "synch_weights_time_ms": 9.086}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3470, "training_iteration": 49, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-44", "timestamp": 1698245804, "time_this_iter_s": 3.40099835395813, "time_total_s": 161.57940316200256, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.57940316200256, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.339999999999996, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788004996e-16, "cur_lr": 0.0003, "total_loss": 6.509004847208659, "policy_loss": -0.00012905051310857136, "vf_loss": 6.509185324774848, "vf_explained_var": -0.0006803565555148655, "kl": 0.0005855982736976431, "entropy": 0.5140612390306261, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2228.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.95599999999984, "episode_len_mean": 251.1, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.90000000000001, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 41.100000000000016, 10.499999999999709, 28.699999999999967, 39.300000000000026, 44.300000000000004, 37.70000000000003, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.30000000000001, 45.5, 38.50000000000003, 31.300000000000004, 30.9, 39.50000000000002, 33.500000000000036, 37.70000000000003, 27.299999999999947, 37.90000000000003, 34.30000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.5, 40.10000000000002, 46.099999999999994, 28.499999999999964, 46.9, 47.1, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 41.70000000000002, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 41.90000000000001, -50.00000000000044, 43.10000000000001, 45.1, 46.699999999999996, 46.3, 39.90000000000002, 37.10000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, 44.900000000000006, 18.699999999999825, 41.100000000000016, 29.299999999999976, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 17.499999999999808, 35.500000000000036, 44.300000000000004, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991], "episode_lengths": [500, 82, 500, 484, 500, 500, 90, 396, 214, 108, 58, 124, 84, 64, 92, 500, 136, 500, 56, 500, 500, 386, 78, 46, 116, 188, 192, 106, 166, 124, 228, 122, 158, 500, 114, 500, 36, 100, 40, 216, 32, 30, 500, 72, 500, 78, 500, 500, 500, 86, 84, 46, 36, 500, 500, 154, 500, 500, 134, 82, 500, 70, 50, 34, 38, 102, 130, 90, 500, 500, 500, 30, 64, 500, 212, 500, 500, 36, 500, 500, 500, 28, 500, 112, 52, 314, 90, 208, 58, 500, 500, 42, 326, 146, 58, 256, 72, 500, 500, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38329038341018856, "mean_inference_ms": 1.2262358389591625, "mean_action_processing_ms": 0.14378615717942583, "mean_env_wait_ms": 0.08357046068406512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991439819335938, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.13199067115783691}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.95599999999984, "episode_len_mean": 251.1, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.90000000000001, -50.00000000000044, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 41.100000000000016, 10.499999999999709, 28.699999999999967, 39.300000000000026, 44.300000000000004, 37.70000000000003, 41.70000000000002, 43.7, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 42.30000000000001, 45.5, 38.50000000000003, 31.300000000000004, 30.9, 39.50000000000002, 33.500000000000036, 37.70000000000003, 27.299999999999947, 37.90000000000003, 34.30000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.5, 40.10000000000002, 46.099999999999994, 28.499999999999964, 46.9, 47.1, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 41.70000000000002, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 41.90000000000001, -50.00000000000044, 43.10000000000001, 45.1, 46.699999999999996, 46.3, 39.90000000000002, 37.10000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, 44.900000000000006, 18.699999999999825, 41.100000000000016, 29.299999999999976, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 17.499999999999808, 35.500000000000036, 44.300000000000004, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991], "episode_lengths": [500, 82, 500, 484, 500, 500, 90, 396, 214, 108, 58, 124, 84, 64, 92, 500, 136, 500, 56, 500, 500, 386, 78, 46, 116, 188, 192, 106, 166, 124, 228, 122, 158, 500, 114, 500, 36, 100, 40, 216, 32, 30, 500, 72, 500, 78, 500, 500, 500, 86, 84, 46, 36, 500, 500, 154, 500, 500, 134, 82, 500, 70, 50, 34, 38, 102, 130, 90, 500, 500, 500, 30, 64, 500, 212, 500, 500, 36, 500, 500, 500, 28, 500, 112, 52, 314, 90, 208, 58, 500, 500, 42, 326, 146, 58, 256, 72, 500, 500, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38329038341018856, "mean_inference_ms": 1.2262358389591625, "mean_action_processing_ms": 0.14378615717942583, "mean_env_wait_ms": 0.08357046068406512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025991439819335938, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.13199067115783691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5407.022948173776, "num_env_steps_trained_throughput_per_sec": 5407.022948173776, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3341.998, "sample_time_ms": 2849.297, "load_time_ms": 17.106, "load_throughput": 1052282.372, "learn_time_ms": 464.606, "learn_throughput": 38742.469, "synch_weights_time_ms": 9.59}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3540, "training_iteration": 50, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-48", "timestamp": 1698245808, "time_this_iter_s": 3.3340003490448, "time_total_s": 164.91340351104736, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.91340351104736, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 56.58, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002498e-16, "cur_lr": 0.0003, "total_loss": 6.568292533026801, "policy_loss": -5.817837599251006e-06, "vf_loss": 6.568349636925591, "vf_explained_var": -0.0023007406128777398, "kl": 0.0003437970646561755, "entropy": 0.5128005729781256, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2273.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.884999999999824, "episode_len_mean": 256.78, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 43.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, 44.900000000000006, 18.699999999999825, 41.100000000000016, 29.299999999999976, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 17.499999999999808, 35.500000000000036, 44.300000000000004, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 38.700000000000024, 40.30000000000002, 33.90000000000004, 42.70000000000001, 6.499999999999652, 44.10000000000001, 43.7, 43.30000000000001, 44.5, 39.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, 34.10000000000004, 45.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.5, 41.90000000000001, 42.70000000000001, 38.300000000000026, -50.00000000000044, 38.10000000000002, 45.5, 38.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 13.299999999999748, 42.500000000000014, -50.00000000000044, -50.00000000000044, 34.50000000000004, 46.9, -50.00000000000044, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 43.7, 47.1, 45.3, 43.7, 46.3, 43.10000000000001, -50.00000000000044, 39.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.3, 48.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 64, 500, 212, 500, 500, 36, 500, 500, 500, 28, 500, 112, 52, 314, 90, 208, 58, 500, 500, 42, 326, 146, 58, 256, 72, 500, 500, 254, 500, 114, 98, 162, 74, 436, 60, 64, 68, 56, 102, 68, 500, 500, 286, 160, 44, 500, 76, 500, 36, 82, 74, 118, 500, 120, 46, 114, 500, 36, 500, 96, 368, 76, 500, 500, 156, 32, 500, 500, 64, 86, 500, 64, 30, 48, 64, 38, 70, 500, 104, 82, 500, 500, 500, 500, 500, 62, 74, 500, 500, 38, 20, 60, 500, 500, 498, 196, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382933474768736, "mean_inference_ms": 1.2271243763754396, "mean_action_processing_ms": 0.14370503349813982, "mean_env_wait_ms": 0.08369056052375713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.14998841285705566}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.884999999999824, "episode_len_mean": 256.78, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 43.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 38.90000000000002, 44.900000000000006, 18.699999999999825, 41.100000000000016, 29.299999999999976, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 17.499999999999808, 35.500000000000036, 44.300000000000004, 24.499999999999908, 42.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, -50.00000000000044, 38.700000000000024, 40.30000000000002, 33.90000000000004, 42.70000000000001, 6.499999999999652, 44.10000000000001, 43.7, 43.30000000000001, 44.5, 39.90000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, 34.10000000000004, 45.7, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.5, 41.90000000000001, 42.70000000000001, 38.300000000000026, -50.00000000000044, 38.10000000000002, 45.5, 38.700000000000024, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 13.299999999999748, 42.500000000000014, -50.00000000000044, -50.00000000000044, 34.50000000000004, 46.9, -50.00000000000044, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 43.7, 47.1, 45.3, 43.7, 46.3, 43.10000000000001, -50.00000000000044, 39.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.3, 48.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 64, 500, 212, 500, 500, 36, 500, 500, 500, 28, 500, 112, 52, 314, 90, 208, 58, 500, 500, 42, 326, 146, 58, 256, 72, 500, 500, 254, 500, 114, 98, 162, 74, 436, 60, 64, 68, 56, 102, 68, 500, 500, 286, 160, 44, 500, 76, 500, 36, 82, 74, 118, 500, 120, 46, 114, 500, 36, 500, 96, 368, 76, 500, 500, 156, 32, 500, 500, 64, 86, 500, 64, 30, 48, 64, 38, 70, 500, 104, 82, 500, 500, 500, 500, 500, 62, 74, 500, 500, 38, 20, 60, 500, 500, 498, 196, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382933474768736, "mean_inference_ms": 1.2271243763754396, "mean_action_processing_ms": 0.14370503349813982, "mean_env_wait_ms": 0.08369056052375713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.14998841285705566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5405.4043682141555, "num_env_steps_trained_throughput_per_sec": 5405.4043682141555, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3346.401, "sample_time_ms": 2846.0, "load_time_ms": 17.106, "load_throughput": 1052279.439, "learn_time_ms": 472.206, "learn_throughput": 38118.93, "synch_weights_time_ms": 9.589}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3611, "training_iteration": 51, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-51", "timestamp": 1698245811, "time_this_iter_s": 3.3349997997283936, "time_total_s": 168.24840331077576, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.24840331077576, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 67.75, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001249e-17, "cur_lr": 0.0003, "total_loss": 6.674815972646077, "policy_loss": -0.0005430694255563948, "vf_loss": 6.675412856207954, "vf_explained_var": -0.0009333451588948567, "kl": 0.0014624371536633084, "entropy": 0.5379680222935147, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2318.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.9459999999998185, "episode_len_mean": 261.18, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 43.7, 47.1, 45.3, 43.7, 46.3, 43.10000000000001, -50.00000000000044, 39.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.3, 48.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 42.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 44.10000000000001, -50.00000000000044, 30.9, 43.7, 46.9, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.7, -50.00000000000044, 42.500000000000014, 21.699999999999868, 35.30000000000004, 47.5, 31.1, 39.70000000000002, -50.00000000000044, 43.30000000000001, 12.299999999999734, 40.90000000000002, 46.5, 42.70000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, 0.2999999999995637, 42.30000000000001, -50.00000000000044, 40.30000000000002, 46.3, 45.9, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 9.699999999999697, -50.00000000000044, 44.5, 37.70000000000003, 15.699999999999783, 31.1, 47.3, 46.699999999999996, -50.00000000000044, 18.899999999999828, 33.30000000000003, 33.70000000000004, -50.00000000000044, 42.70000000000001, 10.899999999999714, 43.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006], "episode_lengths": [86, 500, 64, 30, 48, 64, 38, 70, 500, 104, 82, 500, 500, 500, 500, 500, 62, 74, 500, 500, 38, 20, 60, 500, 500, 498, 196, 500, 500, 500, 226, 80, 500, 38, 500, 500, 500, 428, 60, 500, 192, 64, 32, 500, 26, 500, 500, 106, 44, 500, 76, 284, 148, 26, 190, 104, 500, 68, 378, 92, 36, 74, 238, 500, 500, 500, 48, 86, 498, 78, 500, 98, 38, 42, 500, 36, 74, 500, 78, 500, 404, 500, 56, 124, 344, 190, 28, 34, 500, 312, 168, 164, 500, 74, 392, 68, 500, 68, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38325112252814797, "mean_inference_ms": 1.2277415233626272, "mean_action_processing_ms": 0.14344998844205895, "mean_env_wait_ms": 0.08365268853709733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299356460571289, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.15507888793945312}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.9459999999998185, "episode_len_mean": 261.18, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 43.7, 47.1, 45.3, 43.7, 46.3, 43.10000000000001, -50.00000000000044, 39.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.3, 48.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 42.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 44.10000000000001, -50.00000000000044, 30.9, 43.7, 46.9, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.7, -50.00000000000044, 42.500000000000014, 21.699999999999868, 35.30000000000004, 47.5, 31.1, 39.70000000000002, -50.00000000000044, 43.30000000000001, 12.299999999999734, 40.90000000000002, 46.5, 42.70000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, 0.2999999999995637, 42.30000000000001, -50.00000000000044, 40.30000000000002, 46.3, 45.9, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 9.699999999999697, -50.00000000000044, 44.5, 37.70000000000003, 15.699999999999783, 31.1, 47.3, 46.699999999999996, -50.00000000000044, 18.899999999999828, 33.30000000000003, 33.70000000000004, -50.00000000000044, 42.70000000000001, 10.899999999999714, 43.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006], "episode_lengths": [86, 500, 64, 30, 48, 64, 38, 70, 500, 104, 82, 500, 500, 500, 500, 500, 62, 74, 500, 500, 38, 20, 60, 500, 500, 498, 196, 500, 500, 500, 226, 80, 500, 38, 500, 500, 500, 428, 60, 500, 192, 64, 32, 500, 26, 500, 500, 106, 44, 500, 76, 284, 148, 26, 190, 104, 500, 68, 378, 92, 36, 74, 238, 500, 500, 500, 48, 86, 498, 78, 500, 98, 38, 42, 500, 36, 74, 500, 78, 500, 404, 500, 56, 124, 344, 190, 28, 34, 500, 312, 168, 164, 500, 74, 392, 68, 500, 68, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38325112252814797, "mean_inference_ms": 1.2277415233626272, "mean_action_processing_ms": 0.14344998844205895, "mean_env_wait_ms": 0.08365268853709733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299356460571289, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.15507888793945312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5257.009673778745, "num_env_steps_trained_throughput_per_sec": 5257.009673778745, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3350.501, "sample_time_ms": 2851.0, "load_time_ms": 17.306, "load_throughput": 1040117.82, "learn_time_ms": 471.206, "learn_throughput": 38199.857, "synch_weights_time_ms": 9.59}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3681, "training_iteration": 52, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-55", "timestamp": 1698245815, "time_this_iter_s": 3.428999423980713, "time_total_s": 171.67740273475647, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.67740273475647, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006246e-17, "cur_lr": 0.0003, "total_loss": 6.720650058322483, "policy_loss": -0.00014212868279880948, "vf_loss": 6.720845402611626, "vf_explained_var": -0.0007481588257683648, "kl": 0.0008248094839195296, "entropy": 0.5330086509386699, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.59099999999984, "episode_len_mean": 249.76, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 9.699999999999697, -50.00000000000044, 44.5, 37.70000000000003, 15.699999999999783, 31.1, 47.3, 46.699999999999996, -50.00000000000044, 18.899999999999828, 33.30000000000003, 33.70000000000004, -50.00000000000044, 42.70000000000001, 10.899999999999714, 43.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, 26.69999999999994, 43.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 46.099999999999994, 43.10000000000001, 45.1, 20.699999999999854, 42.70000000000001, 41.70000000000002, 44.7, 35.30000000000004, 46.5, 44.7, -50.00000000000044, 41.70000000000002, 38.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 44.900000000000006, 47.1, 25.699999999999925, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.500000000000014, 42.900000000000006, 1.8999999999995865, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.10000000000001, 36.30000000000003, 41.100000000000016, 47.1, -50.00000000000044, 38.300000000000026, 46.5, 26.69999999999994, -50.00000000000044, 27.899999999999956, 45.9, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.30000000000001, 43.10000000000001, 17.299999999999805, -50.00000000000044, 36.30000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.90000000000003], "episode_lengths": [500, 36, 74, 500, 78, 500, 404, 500, 56, 124, 344, 190, 28, 34, 500, 312, 168, 164, 500, 74, 392, 68, 500, 68, 500, 72, 234, 70, 500, 70, 500, 78, 40, 70, 50, 294, 74, 84, 54, 148, 36, 54, 500, 84, 118, 88, 500, 500, 356, 500, 52, 30, 244, 80, 500, 500, 500, 62, 500, 76, 72, 482, 82, 500, 500, 500, 96, 80, 138, 90, 30, 500, 118, 36, 234, 500, 222, 42, 60, 124, 500, 500, 500, 140, 64, 500, 500, 500, 500, 84, 78, 70, 328, 500, 138, 136, 500, 500, 178, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38310845416097467, "mean_inference_ms": 1.2257547477808157, "mean_action_processing_ms": 0.14372005585824113, "mean_env_wait_ms": 0.08352475477040723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027989864349365234, "StateBufferConnector_ms": 0.009995698928833008, "ViewRequirementAgentConnector_ms": 0.11800980567932129}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.59099999999984, "episode_len_mean": 249.76, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 9.699999999999697, -50.00000000000044, 44.5, 37.70000000000003, 15.699999999999783, 31.1, 47.3, 46.699999999999996, -50.00000000000044, 18.899999999999828, 33.30000000000003, 33.70000000000004, -50.00000000000044, 42.70000000000001, 10.899999999999714, 43.30000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, 26.69999999999994, 43.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.30000000000001, 46.099999999999994, 43.10000000000001, 45.1, 20.699999999999854, 42.70000000000001, 41.70000000000002, 44.7, 35.30000000000004, 46.5, 44.7, -50.00000000000044, 41.70000000000002, 38.300000000000026, 41.30000000000001, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 44.900000000000006, 47.1, 25.699999999999925, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.500000000000014, 42.900000000000006, 1.8999999999995865, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.10000000000001, 36.30000000000003, 41.100000000000016, 47.1, -50.00000000000044, 38.300000000000026, 46.5, 26.69999999999994, -50.00000000000044, 27.899999999999956, 45.9, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.30000000000001, 43.10000000000001, 17.299999999999805, -50.00000000000044, 36.30000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.90000000000003], "episode_lengths": [500, 36, 74, 500, 78, 500, 404, 500, 56, 124, 344, 190, 28, 34, 500, 312, 168, 164, 500, 74, 392, 68, 500, 68, 500, 72, 234, 70, 500, 70, 500, 78, 40, 70, 50, 294, 74, 84, 54, 148, 36, 54, 500, 84, 118, 88, 500, 500, 356, 500, 52, 30, 244, 80, 500, 500, 500, 62, 500, 76, 72, 482, 82, 500, 500, 500, 96, 80, 138, 90, 30, 500, 118, 36, 234, 500, 222, 42, 60, 124, 500, 500, 500, 140, 64, 500, 500, 500, 500, 84, 78, 70, 328, 500, 138, 136, 500, 500, 178, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38310845416097467, "mean_inference_ms": 1.2257547477808157, "mean_action_processing_ms": 0.14372005585824113, "mean_env_wait_ms": 0.08352475477040723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027989864349365234, "StateBufferConnector_ms": 0.009995698928833008, "ViewRequirementAgentConnector_ms": 0.11800980567932129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5384.383467092791, "num_env_steps_trained_throughput_per_sec": 5384.383467092791, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3354.301, "sample_time_ms": 2852.6, "load_time_ms": 17.306, "load_throughput": 1040116.387, "learn_time_ms": 473.303, "learn_throughput": 38030.609, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3755, "training_iteration": 53, "trial_id": "9f288_00005", "date": "2023-10-25_15-56-58", "timestamp": 1698245818, "time_this_iter_s": 3.3490002155303955, "time_total_s": 175.02640295028687, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.02640295028687, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 56.220000000000006, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503123e-17, "cur_lr": 0.0003, "total_loss": 6.806061130099827, "policy_loss": -0.0005531876244478756, "vf_loss": 6.806668853759765, "vf_explained_var": -0.0014203667640686035, "kl": 0.0012218032624979791, "entropy": 0.5454286886586084, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2408.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.472999999999826, "episode_len_mean": 270.9, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 42.10000000000001, 36.30000000000003, 41.100000000000016, 47.1, -50.00000000000044, 38.300000000000026, 46.5, 26.69999999999994, -50.00000000000044, 27.899999999999956, 45.9, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.30000000000001, 43.10000000000001, 17.299999999999805, -50.00000000000044, 36.30000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.90000000000003, 37.300000000000026, 46.3, 33.70000000000004, 36.10000000000004, 42.500000000000014, 28.89999999999997, 16.29999999999979, -50.00000000000044, -50.00000000000044, 47.1, 45.3, 31.70000000000001, -50.00000000000044, 35.900000000000034, 9.299999999999692, 32.90000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 40.500000000000014, 10.099999999999703, 46.3, 43.7, 5.6999999999996405, -50.00000000000044, 36.30000000000003, 32.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 32.30000000000002, 45.5, 36.30000000000003, -50.00000000000044, 41.70000000000002, 40.70000000000002, 39.10000000000002, 35.70000000000003, 35.30000000000004, -50.00000000000044, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 96, 80, 138, 90, 30, 500, 118, 36, 234, 500, 222, 42, 60, 124, 500, 500, 500, 140, 64, 500, 500, 500, 500, 84, 78, 70, 328, 500, 138, 136, 500, 500, 178, 122, 128, 38, 164, 140, 76, 212, 338, 500, 500, 30, 48, 184, 500, 142, 408, 172, 76, 500, 500, 124, 500, 500, 46, 66, 500, 32, 500, 500, 348, 500, 500, 500, 500, 368, 96, 400, 38, 64, 444, 500, 138, 180, 54, 500, 500, 500, 74, 500, 500, 110, 178, 46, 138, 500, 84, 94, 110, 144, 148, 500, 152, 78, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3829300048864714, "mean_inference_ms": 1.226240126179389, "mean_action_processing_ms": 0.14350909613803012, "mean_env_wait_ms": 0.083488605698737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031987905502319336, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.12901759147644043}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.472999999999826, "episode_len_mean": 270.9, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 42.10000000000001, 36.30000000000003, 41.100000000000016, 47.1, -50.00000000000044, 38.300000000000026, 46.5, 26.69999999999994, -50.00000000000044, 27.899999999999956, 45.9, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.30000000000001, 43.10000000000001, 17.299999999999805, -50.00000000000044, 36.30000000000003, 36.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.90000000000003, 37.300000000000026, 46.3, 33.70000000000004, 36.10000000000004, 42.500000000000014, 28.89999999999997, 16.29999999999979, -50.00000000000044, -50.00000000000044, 47.1, 45.3, 31.70000000000001, -50.00000000000044, 35.900000000000034, 9.299999999999692, 32.90000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 40.500000000000014, 10.099999999999703, 46.3, 43.7, 5.6999999999996405, -50.00000000000044, 36.30000000000003, 32.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 32.30000000000002, 45.5, 36.30000000000003, -50.00000000000044, 41.70000000000002, 40.70000000000002, 39.10000000000002, 35.70000000000003, 35.30000000000004, -50.00000000000044, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 96, 80, 138, 90, 30, 500, 118, 36, 234, 500, 222, 42, 60, 124, 500, 500, 500, 140, 64, 500, 500, 500, 500, 84, 78, 70, 328, 500, 138, 136, 500, 500, 178, 122, 128, 38, 164, 140, 76, 212, 338, 500, 500, 30, 48, 184, 500, 142, 408, 172, 76, 500, 500, 124, 500, 500, 46, 66, 500, 32, 500, 500, 348, 500, 500, 500, 500, 368, 96, 400, 38, 64, 444, 500, 138, 180, 54, 500, 500, 500, 74, 500, 500, 110, 178, 46, 138, 500, 84, 94, 110, 144, 148, 500, 152, 78, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3829300048864714, "mean_inference_ms": 1.226240126179389, "mean_action_processing_ms": 0.14350909613803012, "mean_env_wait_ms": 0.083488605698737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031987905502319336, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.12901759147644043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5408.65218465284, "num_env_steps_trained_throughput_per_sec": 5408.65218465284, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3355.601, "sample_time_ms": 2848.8, "load_time_ms": 16.503, "load_throughput": 1090737.551, "learn_time_ms": 479.406, "learn_throughput": 37546.466, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3820, "training_iteration": 54, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-01", "timestamp": 1698245821, "time_this_iter_s": 3.333000659942627, "time_total_s": 178.3594036102295, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.3594036102295, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 64.425, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251561e-17, "cur_lr": 0.0003, "total_loss": 7.406487867567274, "policy_loss": -0.00030629123664564556, "vf_loss": 7.406849447886149, "vf_explained_var": -0.0005956040488349067, "kl": 0.0008757261501892167, "entropy": 0.5533276511563195, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2453.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.605999999999874, "episode_len_mean": 214.68, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 35.70000000000003, 35.30000000000004, -50.00000000000044, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 30.099999999999987, -50.00000000000044, 39.90000000000002, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.500000000000036, 44.7, 37.50000000000003, 24.299999999999905, 44.900000000000006, 45.7, 44.5, 16.09999999999979, 45.7, 41.100000000000016, -50.00000000000044, 12.299999999999734, 45.9, -50.00000000000044, 43.7, 44.5, 38.700000000000024, -50.00000000000044, 46.699999999999996, 42.900000000000006, 45.5, 43.10000000000001, 47.5, 42.900000000000006, 39.300000000000026, 40.90000000000002, 39.70000000000002, 45.5, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 19.499999999999837, 39.70000000000002, 42.30000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.90000000000002, 43.900000000000006, 44.900000000000006, 37.70000000000003, 46.699999999999996, 38.50000000000003, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.900000000000006, 44.7, 44.5, -50.00000000000044, 13.099999999999746, 40.500000000000014, 22.49999999999988, 31.70000000000001, -50.00000000000044, 37.50000000000003, 40.70000000000002, 40.70000000000002, 42.900000000000006, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 8.899999999999686, 44.900000000000006], "episode_lengths": [110, 144, 148, 500, 152, 78, 500, 72, 500, 56, 200, 500, 102, 138, 500, 500, 34, 500, 168, 500, 302, 166, 54, 126, 258, 52, 44, 56, 340, 44, 90, 500, 378, 42, 500, 64, 56, 114, 500, 34, 72, 46, 70, 26, 72, 108, 92, 104, 46, 500, 76, 500, 74, 306, 104, 78, 52, 500, 84, 500, 134, 500, 92, 62, 52, 124, 34, 116, 210, 500, 500, 120, 62, 54, 56, 500, 370, 96, 276, 184, 500, 126, 94, 94, 72, 500, 30, 36, 500, 76, 128, 500, 92, 500, 122, 500, 60, 500, 412, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38330008250091746, "mean_inference_ms": 1.2263411717178903, "mean_action_processing_ms": 0.1431401078249579, "mean_env_wait_ms": 0.08346569971500163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12198495864868164}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.605999999999874, "episode_len_mean": 214.68, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 35.70000000000003, 35.30000000000004, -50.00000000000044, 34.900000000000034, 42.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 30.099999999999987, -50.00000000000044, 39.90000000000002, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.30000000000003, -50.00000000000044, 19.899999999999842, 33.500000000000036, 44.7, 37.50000000000003, 24.299999999999905, 44.900000000000006, 45.7, 44.5, 16.09999999999979, 45.7, 41.100000000000016, -50.00000000000044, 12.299999999999734, 45.9, -50.00000000000044, 43.7, 44.5, 38.700000000000024, -50.00000000000044, 46.699999999999996, 42.900000000000006, 45.5, 43.10000000000001, 47.5, 42.900000000000006, 39.300000000000026, 40.90000000000002, 39.70000000000002, 45.5, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 19.499999999999837, 39.70000000000002, 42.30000000000001, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.90000000000002, 43.900000000000006, 44.900000000000006, 37.70000000000003, 46.699999999999996, 38.50000000000003, 29.099999999999973, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.900000000000006, 44.7, 44.5, -50.00000000000044, 13.099999999999746, 40.500000000000014, 22.49999999999988, 31.70000000000001, -50.00000000000044, 37.50000000000003, 40.70000000000002, 40.70000000000002, 42.900000000000006, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 8.899999999999686, 44.900000000000006], "episode_lengths": [110, 144, 148, 500, 152, 78, 500, 72, 500, 56, 200, 500, 102, 138, 500, 500, 34, 500, 168, 500, 302, 166, 54, 126, 258, 52, 44, 56, 340, 44, 90, 500, 378, 42, 500, 64, 56, 114, 500, 34, 72, 46, 70, 26, 72, 108, 92, 104, 46, 500, 76, 500, 74, 306, 104, 78, 52, 500, 84, 500, 134, 500, 92, 62, 52, 124, 34, 116, 210, 500, 500, 120, 62, 54, 56, 500, 370, 96, 276, 184, 500, 126, 94, 94, 72, 500, 30, 36, 500, 76, 128, 500, 92, 500, 122, 500, 60, 500, 412, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38330008250091746, "mean_inference_ms": 1.2263411717178903, "mean_action_processing_ms": 0.1431401078249579, "mean_env_wait_ms": 0.08346569971500163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12198495864868164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5209.881550929471, "num_env_steps_trained_throughput_per_sec": 5209.881550929471, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3373.098, "sample_time_ms": 2852.297, "load_time_ms": 17.4, "load_throughput": 1034503.874, "learn_time_ms": 492.409, "learn_throughput": 36554.971, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3911, "training_iteration": 55, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-05", "timestamp": 1698245825, "time_this_iter_s": 3.4609696865081787, "time_total_s": 181.82037329673767, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.82037329673767, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.279999999999994, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125781e-18, "cur_lr": 0.0003, "total_loss": 6.543896198272705, "policy_loss": -0.00026512957281536525, "vf_loss": 6.544216293758816, "vf_explained_var": -0.00278857151667277, "kl": 0.0009646894157615154, "entropy": 0.5498855233192443, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2498.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.106999999999859, "episode_len_mean": 224.64, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 13.099999999999746, 40.500000000000014, 22.49999999999988, 31.70000000000001, -50.00000000000044, 37.50000000000003, 40.70000000000002, 40.70000000000002, 42.900000000000006, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 8.899999999999686, 44.900000000000006, 45.3, 44.900000000000006, 45.9, 45.9, 43.50000000000001, 23.099999999999888, 42.500000000000014, -50.00000000000044, 18.899999999999828, 41.500000000000014, 46.5, 42.10000000000001, 40.70000000000002, 45.1, 32.30000000000002, -50.00000000000044, 40.90000000000002, 33.90000000000004, 37.10000000000003, 47.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 23.8999999999999, 43.7, 45.3, 45.7, 46.5, -50.00000000000044, 43.900000000000006, 42.30000000000001, 43.50000000000001, 45.7, 38.700000000000024, 6.099999999999646, -50.00000000000044, 31.70000000000001, 29.69999999999998, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.10000000000001, 25.29999999999992, 45.5, 42.30000000000001, -50.00000000000044, 16.8999999999998, 43.7, 44.5, 33.30000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, 46.5, 46.5, -50.00000000000044], "episode_lengths": [500, 370, 96, 276, 184, 500, 126, 94, 94, 72, 500, 30, 36, 500, 76, 128, 500, 92, 500, 122, 500, 60, 500, 412, 52, 48, 52, 42, 42, 66, 270, 76, 500, 312, 86, 36, 80, 94, 50, 178, 500, 92, 162, 130, 30, 500, 68, 500, 500, 32, 500, 110, 500, 500, 80, 500, 262, 64, 48, 44, 36, 500, 62, 78, 66, 44, 114, 440, 500, 184, 204, 500, 112, 500, 500, 500, 52, 80, 248, 46, 78, 500, 332, 64, 56, 168, 102, 500, 500, 52, 136, 68, 36, 500, 500, 110, 50, 36, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38275614992351265, "mean_inference_ms": 1.2244999760223267, "mean_action_processing_ms": 0.14333289295170212, "mean_env_wait_ms": 0.08363870111573175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004501342773438, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.10099077224731445}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.106999999999859, "episode_len_mean": 224.64, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 13.099999999999746, 40.500000000000014, 22.49999999999988, 31.70000000000001, -50.00000000000044, 37.50000000000003, 40.70000000000002, 40.70000000000002, 42.900000000000006, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 42.500000000000014, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, 8.899999999999686, 44.900000000000006, 45.3, 44.900000000000006, 45.9, 45.9, 43.50000000000001, 23.099999999999888, 42.500000000000014, -50.00000000000044, 18.899999999999828, 41.500000000000014, 46.5, 42.10000000000001, 40.70000000000002, 45.1, 32.30000000000002, -50.00000000000044, 40.90000000000002, 33.90000000000004, 37.10000000000003, 47.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 23.8999999999999, 43.7, 45.3, 45.7, 46.5, -50.00000000000044, 43.900000000000006, 42.30000000000001, 43.50000000000001, 45.7, 38.700000000000024, 6.099999999999646, -50.00000000000044, 31.70000000000001, 29.69999999999998, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.10000000000001, 25.29999999999992, 45.5, 42.30000000000001, -50.00000000000044, 16.8999999999998, 43.7, 44.5, 33.30000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, 46.5, 46.5, -50.00000000000044], "episode_lengths": [500, 370, 96, 276, 184, 500, 126, 94, 94, 72, 500, 30, 36, 500, 76, 128, 500, 92, 500, 122, 500, 60, 500, 412, 52, 48, 52, 42, 42, 66, 270, 76, 500, 312, 86, 36, 80, 94, 50, 178, 500, 92, 162, 130, 30, 500, 68, 500, 500, 32, 500, 110, 500, 500, 80, 500, 262, 64, 48, 44, 36, 500, 62, 78, 66, 44, 114, 440, 500, 184, 204, 500, 112, 500, 500, 500, 52, 80, 248, 46, 78, 500, 332, 64, 56, 168, 102, 500, 500, 52, 136, 68, 36, 500, 500, 110, 50, 36, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38275614992351265, "mean_inference_ms": 1.2244999760223267, "mean_action_processing_ms": 0.14333289295170212, "mean_env_wait_ms": 0.08363870111573175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004501342773438, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.10099077224731445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5298.7903333914, "num_env_steps_trained_throughput_per_sec": 5298.7903333914, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3367.898, "sample_time_ms": 2850.697, "load_time_ms": 16.5, "load_throughput": 1090940.87, "learn_time_ms": 489.609, "learn_throughput": 36764.017, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3986, "training_iteration": 56, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-08", "timestamp": 1698245828, "time_this_iter_s": 3.4020001888275146, "time_total_s": 185.22237348556519, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.22237348556519, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.720000000000006, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628903e-18, "cur_lr": 0.0003, "total_loss": 7.078349452548557, "policy_loss": -0.00027589955263667635, "vf_loss": 7.078680345747206, "vf_explained_var": -0.0029951678382025824, "kl": 0.0009202464128217495, "entropy": 0.5490647739834256, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2543.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.508999999999831, "episode_len_mean": 260.56, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, 29.69999999999998, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.10000000000001, 25.29999999999992, 45.5, 42.30000000000001, -50.00000000000044, 16.8999999999998, 43.7, 44.5, 33.30000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 31.900000000000013, 39.70000000000002, -50.00000000000044, 42.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 29.49999999999998, 39.90000000000002, -50.00000000000044, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.3, 13.899999999999757, -50.00000000000044, -50.00000000000044, 45.7, 39.10000000000002, 16.499999999999794, 42.900000000000006, 45.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.900000000000006, 19.09999999999983, 31.70000000000001, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 34.50000000000004, 8.49999999999968, 47.1, -50.00000000000044, 39.300000000000026, 41.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 20.099999999999845, 43.10000000000001, 39.50000000000002, 45.7, 42.30000000000001, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, 41.100000000000016, 42.70000000000001, -50.00000000000044, 37.90000000000003, 15.49999999999978, -50.00000000000044], "episode_lengths": [184, 204, 500, 112, 500, 500, 500, 52, 80, 248, 46, 78, 500, 332, 64, 56, 168, 102, 500, 500, 52, 136, 68, 36, 500, 500, 110, 50, 36, 36, 500, 500, 218, 500, 182, 104, 500, 80, 234, 500, 500, 206, 102, 500, 62, 102, 500, 500, 48, 362, 500, 500, 44, 110, 336, 72, 48, 70, 500, 500, 118, 62, 310, 184, 44, 152, 500, 500, 166, 500, 500, 56, 500, 156, 416, 30, 500, 108, 88, 500, 198, 500, 300, 70, 106, 44, 78, 500, 36, 54, 500, 500, 38, 480, 90, 74, 500, 122, 346, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38262716424250504, "mean_inference_ms": 1.224929434466571, "mean_action_processing_ms": 0.14320906792293278, "mean_env_wait_ms": 0.08368034865971666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023009300231933594, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.11392569541931152}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.508999999999831, "episode_len_mean": 260.56, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, 29.69999999999998, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.10000000000001, 25.29999999999992, 45.5, 42.30000000000001, -50.00000000000044, 16.8999999999998, 43.7, 44.5, 33.30000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.50000000000003, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.1, 46.5, 46.5, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 31.900000000000013, 39.70000000000002, -50.00000000000044, 42.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 29.49999999999998, 39.90000000000002, -50.00000000000044, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.3, 13.899999999999757, -50.00000000000044, -50.00000000000044, 45.7, 39.10000000000002, 16.499999999999794, 42.900000000000006, 45.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.900000000000006, 19.09999999999983, 31.70000000000001, 45.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 34.50000000000004, 8.49999999999968, 47.1, -50.00000000000044, 39.300000000000026, 41.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 20.099999999999845, 43.10000000000001, 39.50000000000002, 45.7, 42.30000000000001, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, 41.100000000000016, 42.70000000000001, -50.00000000000044, 37.90000000000003, 15.49999999999978, -50.00000000000044], "episode_lengths": [184, 204, 500, 112, 500, 500, 500, 52, 80, 248, 46, 78, 500, 332, 64, 56, 168, 102, 500, 500, 52, 136, 68, 36, 500, 500, 110, 50, 36, 36, 500, 500, 218, 500, 182, 104, 500, 80, 234, 500, 500, 206, 102, 500, 62, 102, 500, 500, 48, 362, 500, 500, 44, 110, 336, 72, 48, 70, 500, 500, 118, 62, 310, 184, 44, 152, 500, 500, 166, 500, 500, 56, 500, 156, 416, 30, 500, 108, 88, 500, 198, 500, 300, 70, 106, 44, 78, 500, 36, 54, 500, 500, 38, 480, 90, 74, 500, 122, 346, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38262716424250504, "mean_inference_ms": 1.224929434466571, "mean_action_processing_ms": 0.14320906792293278, "mean_env_wait_ms": 0.08368034865971666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023009300231933594, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.11392569541931152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5336.495471814303, "num_env_steps_trained_throughput_per_sec": 5336.495471814303, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3371.098, "sample_time_ms": 2846.4, "load_time_ms": 16.499, "load_throughput": 1090972.4, "learn_time_ms": 497.309, "learn_throughput": 36194.785, "synch_weights_time_ms": 9.49}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 4055, "training_iteration": 57, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-12", "timestamp": 1698245832, "time_this_iter_s": 3.3779993057250977, "time_total_s": 188.60037279129028, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.60037279129028, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 55.46, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814452e-18, "cur_lr": 0.0003, "total_loss": 7.037078168657091, "policy_loss": -0.0010120674967765808, "vf_loss": 7.038144037458632, "vf_explained_var": -0.0011819124221801758, "kl": 0.0013368375633793525, "entropy": 0.5385847449302673, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2588.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.408999999999827, "episode_len_mean": 261.6, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 34.50000000000004, 8.49999999999968, 47.1, -50.00000000000044, 39.300000000000026, 41.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 20.099999999999845, 43.10000000000001, 39.50000000000002, 45.7, 42.30000000000001, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, 41.100000000000016, 42.70000000000001, -50.00000000000044, 37.90000000000003, 15.49999999999978, -50.00000000000044, 3.699999999999612, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, 45.1, 40.70000000000002, 42.10000000000001, -50.00000000000044, 32.50000000000002, 33.30000000000003, 0.09999999999956088, -50.00000000000044, 40.500000000000014, 46.099999999999994, 45.3, 42.10000000000001, 5.6999999999996405, 45.1, -50.00000000000044, 16.09999999999979, 7.699999999999669, 43.10000000000001, 42.10000000000001, -50.00000000000044, 39.90000000000002, 18.29999999999982, 23.499999999999893, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 36.30000000000003, 42.500000000000014, 22.299999999999876, 45.5, 33.500000000000036, -50.00000000000044, 44.7, 37.10000000000003, 40.30000000000002, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 12.69999999999974, 25.899999999999928, -50.00000000000044, -50.00000000000044, 32.100000000000016, 43.30000000000001, 36.900000000000034, 46.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, 46.699999999999996, -50.00000000000044, 3.699999999999612, 42.900000000000006, 43.900000000000006, 31.70000000000001], "episode_lengths": [56, 500, 156, 416, 30, 500, 108, 88, 500, 198, 500, 300, 70, 106, 44, 78, 500, 36, 54, 500, 500, 38, 480, 90, 74, 500, 122, 346, 500, 464, 42, 500, 500, 52, 146, 500, 46, 500, 58, 50, 94, 80, 500, 176, 168, 500, 500, 96, 40, 48, 80, 444, 50, 500, 340, 424, 70, 80, 500, 102, 318, 266, 500, 500, 284, 500, 138, 76, 278, 46, 166, 500, 54, 130, 98, 58, 96, 500, 500, 374, 242, 500, 500, 180, 68, 132, 38, 46, 500, 500, 500, 500, 216, 500, 34, 500, 464, 72, 62, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38235381527221873, "mean_inference_ms": 1.224761514954928, "mean_action_processing_ms": 0.1431728749821913, "mean_env_wait_ms": 0.08372788658913538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12098431587219238}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.408999999999827, "episode_len_mean": 261.6, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 34.50000000000004, 8.49999999999968, 47.1, -50.00000000000044, 39.300000000000026, 41.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 20.099999999999845, 43.10000000000001, 39.50000000000002, 45.7, 42.30000000000001, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 46.3, 2.0999999999995893, 41.100000000000016, 42.70000000000001, -50.00000000000044, 37.90000000000003, 15.49999999999978, -50.00000000000044, 3.699999999999612, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, 45.1, 40.70000000000002, 42.10000000000001, -50.00000000000044, 32.50000000000002, 33.30000000000003, 0.09999999999956088, -50.00000000000044, 40.500000000000014, 46.099999999999994, 45.3, 42.10000000000001, 5.6999999999996405, 45.1, -50.00000000000044, 16.09999999999979, 7.699999999999669, 43.10000000000001, 42.10000000000001, -50.00000000000044, 39.90000000000002, 18.29999999999982, 23.499999999999893, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 36.30000000000003, 42.500000000000014, 22.299999999999876, 45.5, 33.500000000000036, -50.00000000000044, 44.7, 37.10000000000003, 40.30000000000002, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 12.69999999999974, 25.899999999999928, -50.00000000000044, -50.00000000000044, 32.100000000000016, 43.30000000000001, 36.900000000000034, 46.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, 46.699999999999996, -50.00000000000044, 3.699999999999612, 42.900000000000006, 43.900000000000006, 31.70000000000001], "episode_lengths": [56, 500, 156, 416, 30, 500, 108, 88, 500, 198, 500, 300, 70, 106, 44, 78, 500, 36, 54, 500, 500, 38, 480, 90, 74, 500, 122, 346, 500, 464, 42, 500, 500, 52, 146, 500, 46, 500, 58, 50, 94, 80, 500, 176, 168, 500, 500, 96, 40, 48, 80, 444, 50, 500, 340, 424, 70, 80, 500, 102, 318, 266, 500, 500, 284, 500, 138, 76, 278, 46, 166, 500, 54, 130, 98, 58, 96, 500, 500, 374, 242, 500, 500, 180, 68, 132, 38, 46, 500, 500, 500, 500, 216, 500, 34, 500, 464, 72, 62, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38235381527221873, "mean_inference_ms": 1.224761514954928, "mean_action_processing_ms": 0.1431728749821913, "mean_env_wait_ms": 0.08372788658913538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12098431587219238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5373.13448132001, "num_env_steps_trained_throughput_per_sec": 5373.13448132001, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3372.498, "sample_time_ms": 2852.0, "load_time_ms": 17.202, "load_throughput": 1046380.055, "learn_time_ms": 492.403, "learn_throughput": 36555.426, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4126, "training_iteration": 58, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-15", "timestamp": 1698245835, "time_this_iter_s": 3.3550007343292236, "time_total_s": 191.9553735256195, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.9553735256195, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 57.339999999999996, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907226e-19, "cur_lr": 0.0003, "total_loss": 6.601014359792074, "policy_loss": -0.0006359297782182694, "vf_loss": 6.601704586876763, "vf_explained_var": -0.002270154158274333, "kl": 0.0018789745054290405, "entropy": 0.5426726619402568, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2633.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.514999999999823, "episode_len_mean": 260.5, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 42.500000000000014, 22.299999999999876, 45.5, 33.500000000000036, -50.00000000000044, 44.7, 37.10000000000003, 40.30000000000002, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 12.69999999999974, 25.899999999999928, -50.00000000000044, -50.00000000000044, 32.100000000000016, 43.30000000000001, 36.900000000000034, 46.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, 46.699999999999996, -50.00000000000044, 3.699999999999612, 42.900000000000006, 43.900000000000006, 31.70000000000001, 16.499999999999794, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, 46.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001, 22.899999999999885, -50.00000000000044, 41.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 22.699999999999882, 39.90000000000002, 44.10000000000001, 43.50000000000001, 3.499999999999609, 40.30000000000002, 36.30000000000003, 46.9, 43.30000000000001, -50.00000000000044, 30.099999999999987, -50.00000000000044, 41.100000000000016, 41.30000000000001, 43.30000000000001, 46.5, -50.00000000000044, 46.5, 43.10000000000001, 41.100000000000016, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.9, 6.499999999999652], "episode_lengths": [138, 76, 278, 46, 166, 500, 54, 130, 98, 58, 96, 500, 500, 374, 242, 500, 500, 180, 68, 132, 38, 46, 500, 500, 500, 500, 216, 500, 34, 500, 464, 72, 62, 184, 336, 500, 84, 44, 212, 36, 104, 500, 500, 500, 500, 58, 32, 500, 36, 500, 78, 272, 500, 88, 78, 500, 500, 500, 68, 500, 44, 500, 80, 500, 500, 56, 274, 102, 60, 66, 466, 98, 138, 32, 68, 500, 200, 500, 90, 88, 68, 36, 500, 36, 70, 90, 78, 500, 500, 90, 500, 500, 376, 56, 72, 500, 500, 470, 32, 436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3826027619878921, "mean_inference_ms": 1.2259864928207975, "mean_action_processing_ms": 0.14331248379500014, "mean_env_wait_ms": 0.08384312399918196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10298967361450195}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.514999999999823, "episode_len_mean": 260.5, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 42.500000000000014, 22.299999999999876, 45.5, 33.500000000000036, -50.00000000000044, 44.7, 37.10000000000003, 40.30000000000002, 44.300000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 12.69999999999974, 25.899999999999928, -50.00000000000044, -50.00000000000044, 32.100000000000016, 43.30000000000001, 36.900000000000034, 46.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, 46.699999999999996, -50.00000000000044, 3.699999999999612, 42.900000000000006, 43.900000000000006, 31.70000000000001, 16.499999999999794, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, 46.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001, 22.899999999999885, -50.00000000000044, 41.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 22.699999999999882, 39.90000000000002, 44.10000000000001, 43.50000000000001, 3.499999999999609, 40.30000000000002, 36.30000000000003, 46.9, 43.30000000000001, -50.00000000000044, 30.099999999999987, -50.00000000000044, 41.100000000000016, 41.30000000000001, 43.30000000000001, 46.5, -50.00000000000044, 46.5, 43.10000000000001, 41.100000000000016, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.9, 6.499999999999652], "episode_lengths": [138, 76, 278, 46, 166, 500, 54, 130, 98, 58, 96, 500, 500, 374, 242, 500, 500, 180, 68, 132, 38, 46, 500, 500, 500, 500, 216, 500, 34, 500, 464, 72, 62, 184, 336, 500, 84, 44, 212, 36, 104, 500, 500, 500, 500, 58, 32, 500, 36, 500, 78, 272, 500, 88, 78, 500, 500, 500, 68, 500, 44, 500, 80, 500, 500, 56, 274, 102, 60, 66, 466, 98, 138, 32, 68, 500, 200, 500, 90, 88, 68, 36, 500, 36, 70, 90, 78, 500, 500, 90, 500, 500, 376, 56, 72, 500, 500, 470, 32, 436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3826027619878921, "mean_inference_ms": 1.2259864928207975, "mean_action_processing_ms": 0.14331248379500014, "mean_env_wait_ms": 0.08384312399918196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10298967361450195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5397.29549981309, "num_env_steps_trained_throughput_per_sec": 5397.29549981309, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3366.398, "sample_time_ms": 2853.4, "load_time_ms": 16.302, "load_throughput": 1104137.099, "learn_time_ms": 485.803, "learn_throughput": 37052.07, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4192, "training_iteration": 59, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-18", "timestamp": 1698245838, "time_this_iter_s": 3.3400003910064697, "time_total_s": 195.29537391662598, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.29537391662598, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 67.55, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953613e-19, "cur_lr": 0.0003, "total_loss": 6.755841244591607, "policy_loss": -0.0004849990208943685, "vf_loss": 6.756374571058485, "vf_explained_var": -0.0039453228314717615, "kl": 0.001112589492145667, "entropy": 0.4831854932838016, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2678.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.957999999999855, "episode_len_mean": 221.12, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.9, 6.499999999999652, 36.900000000000034, -50.00000000000044, 38.10000000000002, 39.90000000000002, -50.00000000000044, 40.30000000000002, 46.099999999999994, -50.00000000000044, 36.30000000000003, 43.900000000000006, 44.5, 44.10000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 43.7, 46.3, 41.100000000000016, 16.29999999999979, -50.00000000000044, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.10000000000001, 45.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, 42.70000000000001, 42.30000000000001, -50.00000000000044, 44.7, 45.7, 44.10000000000001, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 13.499999999999751, 30.9, 45.1, 29.69999999999998, 30.9, 17.299999999999805, -50.00000000000044, 44.10000000000001, 46.5, 44.7, 47.1, -50.00000000000044, 41.70000000000002, 41.500000000000014, 46.099999999999994, 43.10000000000001, 37.10000000000003, 27.49999999999995, 45.5, 46.3, 41.100000000000016, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.30000000000001], "episode_lengths": [500, 90, 500, 500, 376, 56, 72, 500, 500, 470, 32, 436, 132, 500, 120, 102, 500, 98, 40, 500, 138, 62, 56, 60, 162, 500, 500, 48, 40, 500, 72, 500, 500, 54, 40, 64, 38, 90, 338, 500, 500, 44, 44, 500, 500, 58, 80, 48, 56, 26, 66, 500, 500, 90, 36, 74, 78, 500, 54, 44, 60, 64, 40, 500, 500, 500, 48, 66, 500, 366, 192, 50, 204, 192, 328, 500, 60, 36, 54, 30, 500, 84, 86, 40, 70, 130, 226, 46, 38, 90, 500, 106, 500, 130, 50, 500, 44, 500, 30, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825765145593641, "mean_inference_ms": 1.2244341931722813, "mean_action_processing_ms": 0.1429763542593656, "mean_env_wait_ms": 0.08324668352077755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.10702943801879883}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.957999999999855, "episode_len_mean": 221.12, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 46.9, 6.499999999999652, 36.900000000000034, -50.00000000000044, 38.10000000000002, 39.90000000000002, -50.00000000000044, 40.30000000000002, 46.099999999999994, -50.00000000000044, 36.30000000000003, 43.900000000000006, 44.5, 44.10000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 43.7, 46.3, 41.100000000000016, 16.29999999999979, -50.00000000000044, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.10000000000001, 45.3, 44.5, 47.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.5, 42.70000000000001, 42.30000000000001, -50.00000000000044, 44.7, 45.7, 44.10000000000001, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.50000000000001, -50.00000000000044, 13.499999999999751, 30.9, 45.1, 29.69999999999998, 30.9, 17.299999999999805, -50.00000000000044, 44.10000000000001, 46.5, 44.7, 47.1, -50.00000000000044, 41.70000000000002, 41.500000000000014, 46.099999999999994, 43.10000000000001, 37.10000000000003, 27.49999999999995, 45.5, 46.3, 41.100000000000016, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.30000000000001], "episode_lengths": [500, 90, 500, 500, 376, 56, 72, 500, 500, 470, 32, 436, 132, 500, 120, 102, 500, 98, 40, 500, 138, 62, 56, 60, 162, 500, 500, 48, 40, 500, 72, 500, 500, 54, 40, 64, 38, 90, 338, 500, 500, 44, 44, 500, 500, 58, 80, 48, 56, 26, 66, 500, 500, 90, 36, 74, 78, 500, 54, 44, 60, 64, 40, 500, 500, 500, 48, 66, 500, 366, 192, 50, 204, 192, 328, 500, 60, 36, 54, 30, 500, 84, 86, 40, 70, 130, 226, 46, 38, 90, 500, 106, 500, 130, 50, 500, 44, 500, 30, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825765145593641, "mean_inference_ms": 1.2244341931722813, "mean_action_processing_ms": 0.1429763542593656, "mean_env_wait_ms": 0.08324668352077755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.10702943801879883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5316.007216774247, "num_env_steps_trained_throughput_per_sec": 5316.007216774247, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3372.098, "sample_time_ms": 2854.3, "load_time_ms": 16.302, "load_throughput": 1104132.255, "learn_time_ms": 490.903, "learn_throughput": 36667.143, "synch_weights_time_ms": 9.093}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4280, "training_iteration": 60, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-22", "timestamp": 1698245842, "time_this_iter_s": 3.391000270843506, "time_total_s": 198.68637418746948, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.68637418746948, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 56.48, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768065e-19, "cur_lr": 0.0003, "total_loss": 6.968921724955241, "policy_loss": -0.0004004289292626911, "vf_loss": 6.9693693690829805, "vf_explained_var": 0.0005374312400817871, "kl": 0.0007475500370156219, "entropy": 0.4712633272012075, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2723.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.981999999999864, "episode_len_mean": 220.9, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 46.5, 44.7, 47.1, -50.00000000000044, 41.70000000000002, 41.500000000000014, 46.099999999999994, 43.10000000000001, 37.10000000000003, 27.49999999999995, 45.5, 46.3, 41.100000000000016, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.30000000000001, -50.00000000000044, 43.7, 45.3, 46.3, 44.10000000000001, 46.699999999999996, 45.3, 34.900000000000034, -50.00000000000044, -50.00000000000044, 36.50000000000003, 24.899999999999913, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.10000000000002, 43.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.100000000000016, 47.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 47.9, 45.7, 35.10000000000004, 0.8999999999995723, 39.50000000000002, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 44.5, 35.500000000000036, 43.7, 33.70000000000004, 46.699999999999996, 35.10000000000004, 44.7, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 4.699999999999626, -50.00000000000044, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 6.099999999999646, 22.099999999999874, 46.3, 30.499999999999993, 38.90000000000002, 34.30000000000004, 19.499999999999837, 39.90000000000002, 43.30000000000001, -50.00000000000044, 44.300000000000004, 26.89999999999994, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, 46.3, 44.900000000000006, 44.900000000000006], "episode_lengths": [500, 60, 36, 54, 30, 500, 84, 86, 40, 70, 130, 226, 46, 38, 90, 500, 106, 500, 130, 50, 500, 44, 500, 30, 68, 500, 64, 48, 38, 60, 34, 48, 152, 500, 500, 136, 252, 500, 60, 500, 500, 62, 110, 70, 500, 84, 500, 180, 28, 68, 500, 500, 148, 500, 22, 44, 150, 492, 106, 500, 500, 430, 500, 56, 146, 64, 164, 34, 150, 54, 500, 38, 500, 44, 454, 500, 500, 192, 46, 500, 440, 280, 38, 196, 112, 158, 306, 102, 68, 500, 58, 232, 32, 500, 32, 500, 148, 38, 52, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825829903696588, "mean_inference_ms": 1.2244347551866799, "mean_action_processing_ms": 0.1430821124633446, "mean_env_wait_ms": 0.0829976507678592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.1099843978881836}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.981999999999864, "episode_len_mean": 220.9, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 46.5, 44.7, 47.1, -50.00000000000044, 41.70000000000002, 41.500000000000014, 46.099999999999994, 43.10000000000001, 37.10000000000003, 27.49999999999995, 45.5, 46.3, 41.100000000000016, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.30000000000001, -50.00000000000044, 43.7, 45.3, 46.3, 44.10000000000001, 46.699999999999996, 45.3, 34.900000000000034, -50.00000000000044, -50.00000000000044, 36.50000000000003, 24.899999999999913, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.10000000000002, 43.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.100000000000016, 47.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 47.9, 45.7, 35.10000000000004, 0.8999999999995723, 39.50000000000002, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 44.5, 35.500000000000036, 43.7, 33.70000000000004, 46.699999999999996, 35.10000000000004, 44.7, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 4.699999999999626, -50.00000000000044, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 6.099999999999646, 22.099999999999874, 46.3, 30.499999999999993, 38.90000000000002, 34.30000000000004, 19.499999999999837, 39.90000000000002, 43.30000000000001, -50.00000000000044, 44.300000000000004, 26.89999999999994, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, 46.3, 44.900000000000006, 44.900000000000006], "episode_lengths": [500, 60, 36, 54, 30, 500, 84, 86, 40, 70, 130, 226, 46, 38, 90, 500, 106, 500, 130, 50, 500, 44, 500, 30, 68, 500, 64, 48, 38, 60, 34, 48, 152, 500, 500, 136, 252, 500, 60, 500, 500, 62, 110, 70, 500, 84, 500, 180, 28, 68, 500, 500, 148, 500, 22, 44, 150, 492, 106, 500, 500, 430, 500, 56, 146, 64, 164, 34, 150, 54, 500, 38, 500, 44, 454, 500, 500, 192, 46, 500, 440, 280, 38, 196, 112, 158, 306, 102, 68, 500, 58, 232, 32, 500, 32, 500, 148, 38, 52, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825829903696588, "mean_inference_ms": 1.2244347551866799, "mean_action_processing_ms": 0.1430821124633446, "mean_env_wait_ms": 0.0829976507678592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.1099843978881836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5273.951264124621, "num_env_steps_trained_throughput_per_sec": 5273.951264124621, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3380.398, "sample_time_ms": 2854.0, "load_time_ms": 17.502, "load_throughput": 1028430.195, "learn_time_ms": 498.403, "learn_throughput": 36115.361, "synch_weights_time_ms": 9.093}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4355, "training_iteration": 61, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-25", "timestamp": 1698245845, "time_this_iter_s": 3.4190003871917725, "time_total_s": 202.10537457466125, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.10537457466125, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 55.56, "ram_util_percent": 27.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884032e-20, "cur_lr": 0.0003, "total_loss": 6.7828787061903215, "policy_loss": -0.00018685046169492935, "vf_loss": 6.783114231957329, "vf_explained_var": -0.00588503811094496, "kl": 0.0003091402658561214, "entropy": 0.4860334654649099, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2768.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.850999999999836, "episode_len_mean": 247.16, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.699999999999626, -50.00000000000044, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 6.099999999999646, 22.099999999999874, 46.3, 30.499999999999993, 38.90000000000002, 34.30000000000004, 19.499999999999837, 39.90000000000002, 43.30000000000001, -50.00000000000044, 44.300000000000004, 26.89999999999994, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, 46.3, 44.900000000000006, 44.900000000000006, -50.00000000000044, 20.49999999999985, 29.299999999999976, 12.899999999999743, 43.900000000000006, 47.7, 37.70000000000003, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.70000000000002, 45.7, -50.00000000000044, 33.90000000000004, 36.900000000000034, 42.500000000000014, 40.10000000000002, 41.70000000000002, -50.00000000000044, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 45.9, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.9, 44.7, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.099999999999994, 44.300000000000004, 33.500000000000036, 23.8999999999999, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 22.699999999999882, 46.5, 44.900000000000006, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, -50.00000000000044, 33.10000000000003, 45.3], "episode_lengths": [454, 500, 500, 192, 46, 500, 440, 280, 38, 196, 112, 158, 306, 102, 68, 500, 58, 232, 32, 500, 32, 500, 148, 38, 52, 52, 500, 296, 208, 372, 62, 24, 124, 500, 102, 68, 84, 44, 500, 162, 132, 76, 100, 84, 500, 44, 36, 500, 500, 50, 500, 52, 50, 500, 500, 42, 150, 500, 500, 500, 500, 66, 56, 500, 108, 500, 32, 54, 500, 500, 250, 40, 58, 166, 262, 500, 36, 88, 500, 38, 424, 500, 274, 36, 52, 70, 500, 98, 500, 182, 60, 500, 500, 500, 500, 92, 58, 500, 170, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38263011950841197, "mean_inference_ms": 1.2229609791405358, "mean_action_processing_ms": 0.14338847132749788, "mean_env_wait_ms": 0.08333943322648463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027994632720947266, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.1279911994934082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.850999999999836, "episode_len_mean": 247.16, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.699999999999626, -50.00000000000044, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 6.099999999999646, 22.099999999999874, 46.3, 30.499999999999993, 38.90000000000002, 34.30000000000004, 19.499999999999837, 39.90000000000002, 43.30000000000001, -50.00000000000044, 44.300000000000004, 26.89999999999994, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 35.30000000000004, 46.3, 44.900000000000006, 44.900000000000006, -50.00000000000044, 20.49999999999985, 29.299999999999976, 12.899999999999743, 43.900000000000006, 47.7, 37.70000000000003, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.70000000000002, 45.7, -50.00000000000044, 33.90000000000004, 36.900000000000034, 42.500000000000014, 40.10000000000002, 41.70000000000002, -50.00000000000044, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 45.9, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.9, 44.7, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.099999999999994, 44.300000000000004, 33.500000000000036, 23.8999999999999, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 22.699999999999882, 46.5, 44.900000000000006, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, -50.00000000000044, 33.10000000000003, 45.3], "episode_lengths": [454, 500, 500, 192, 46, 500, 440, 280, 38, 196, 112, 158, 306, 102, 68, 500, 58, 232, 32, 500, 32, 500, 148, 38, 52, 52, 500, 296, 208, 372, 62, 24, 124, 500, 102, 68, 84, 44, 500, 162, 132, 76, 100, 84, 500, 44, 36, 500, 500, 50, 500, 52, 50, 500, 500, 42, 150, 500, 500, 500, 500, 66, 56, 500, 108, 500, 32, 54, 500, 500, 250, 40, 58, 166, 262, 500, 36, 88, 500, 38, 424, 500, 274, 36, 52, 70, 500, 98, 500, 182, 60, 500, 500, 500, 500, 92, 58, 500, 170, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38263011950841197, "mean_inference_ms": 1.2229609791405358, "mean_action_processing_ms": 0.14338847132749788, "mean_env_wait_ms": 0.08333943322648463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027994632720947266, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.1279911994934082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5319.144340131709, "num_env_steps_trained_throughput_per_sec": 5319.144340131709, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3376.398, "sample_time_ms": 2850.3, "load_time_ms": 16.703, "load_throughput": 1077671.637, "learn_time_ms": 498.703, "learn_throughput": 36093.649, "synch_weights_time_ms": 9.193}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4429, "training_iteration": 62, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-29", "timestamp": 1698245849, "time_this_iter_s": 3.389000177383423, "time_total_s": 205.49437475204468, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.49437475204468, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 55.739999999999995, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942016e-20, "cur_lr": 0.0003, "total_loss": 6.382569471995036, "policy_loss": -0.0001832962863975101, "vf_loss": 6.3828023910522464, "vf_explained_var": 0.0010685324668884277, "kl": 0.000748384291387083, "entropy": 0.49612372053994075, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2813.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.976999999999815, "episode_len_mean": 265.84, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 44.7, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.099999999999994, 44.300000000000004, 33.500000000000036, 23.8999999999999, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 22.699999999999882, 46.5, 44.900000000000006, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, -50.00000000000044, 33.10000000000003, 45.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 22.49999999999988, 45.9, 33.30000000000003, 46.3, 44.300000000000004, 37.70000000000003, 25.699999999999925, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.70000000000001, 20.49999999999985, 47.7, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 34.30000000000004, 15.899999999999785, -50.00000000000044, 43.7, 46.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 42.70000000000001, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 40.500000000000014, 40.70000000000002, 19.09999999999983, -50.00000000000044, 40.10000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 16.499999999999794, 43.50000000000001, -50.00000000000044], "episode_lengths": [32, 54, 500, 500, 250, 40, 58, 166, 262, 500, 36, 88, 500, 38, 424, 500, 274, 36, 52, 70, 500, 98, 500, 182, 60, 500, 500, 500, 500, 92, 58, 500, 170, 48, 500, 50, 50, 500, 28, 500, 36, 48, 500, 276, 42, 168, 38, 58, 124, 244, 500, 38, 500, 58, 40, 500, 114, 500, 500, 500, 500, 42, 500, 500, 184, 296, 24, 500, 252, 500, 500, 158, 342, 500, 64, 36, 500, 130, 500, 500, 76, 62, 74, 500, 84, 46, 500, 500, 32, 96, 94, 310, 500, 100, 500, 180, 500, 336, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38241141589475064, "mean_inference_ms": 1.2237712878276532, "mean_action_processing_ms": 0.14330749918384417, "mean_env_wait_ms": 0.08379922539425053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599310874938965, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1589655876159668}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.976999999999815, "episode_len_mean": 265.84, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 44.7, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.099999999999994, 44.300000000000004, 33.500000000000036, 23.8999999999999, -50.00000000000044, 46.5, 41.30000000000001, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 22.699999999999882, 46.5, 44.900000000000006, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, -50.00000000000044, 33.10000000000003, 45.3, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 22.49999999999988, 45.9, 33.30000000000003, 46.3, 44.300000000000004, 37.70000000000003, 25.699999999999925, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.70000000000001, 20.49999999999985, 47.7, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 34.30000000000004, 15.899999999999785, -50.00000000000044, 43.7, 46.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 42.70000000000001, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 40.500000000000014, 40.70000000000002, 19.09999999999983, -50.00000000000044, 40.10000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 16.499999999999794, 43.50000000000001, -50.00000000000044], "episode_lengths": [32, 54, 500, 500, 250, 40, 58, 166, 262, 500, 36, 88, 500, 38, 424, 500, 274, 36, 52, 70, 500, 98, 500, 182, 60, 500, 500, 500, 500, 92, 58, 500, 170, 48, 500, 50, 50, 500, 28, 500, 36, 48, 500, 276, 42, 168, 38, 58, 124, 244, 500, 38, 500, 58, 40, 500, 114, 500, 500, 500, 500, 42, 500, 500, 184, 296, 24, 500, 252, 500, 500, 158, 342, 500, 64, 36, 500, 130, 500, 500, 76, 62, 74, 500, 84, 46, 500, 500, 32, 96, 94, 310, 500, 100, 500, 180, 500, 336, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38241141589475064, "mean_inference_ms": 1.2237712878276532, "mean_action_processing_ms": 0.14330749918384417, "mean_env_wait_ms": 0.08379922539425053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599310874938965, "StateBufferConnector_ms": 0.0040035247802734375, "ViewRequirementAgentConnector_ms": 0.1589655876159668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5389.2205412843105, "num_env_steps_trained_throughput_per_sec": 5389.2205412843105, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3376.098, "sample_time_ms": 2853.0, "load_time_ms": 17.803, "load_throughput": 1011088.49, "learn_time_ms": 494.703, "learn_throughput": 36385.486, "synch_weights_time_ms": 9.092}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4495, "training_iteration": 63, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-32", "timestamp": 1698245852, "time_this_iter_s": 3.344999313354492, "time_total_s": 208.83937406539917, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.83937406539917, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 65.075, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.168404344971008e-20, "cur_lr": 0.0003, "total_loss": 6.250236701965332, "policy_loss": -0.0006242180864016215, "vf_loss": 6.250908427768284, "vf_explained_var": -0.0011794037289089626, "kl": 0.0009061282743913699, "entropy": 0.47481690115398834, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2858.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.823999999999825, "episode_len_mean": 252.38, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 15.899999999999785, -50.00000000000044, 43.7, 46.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 42.70000000000001, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 40.500000000000014, 40.70000000000002, 19.09999999999983, -50.00000000000044, 40.10000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 16.499999999999794, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.5, 41.90000000000001, 45.9, 46.099999999999994, 42.10000000000001, -50.00000000000044, 44.300000000000004, 43.50000000000001, 43.50000000000001, 46.699999999999996, 43.7, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 31.70000000000001, 35.30000000000004, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 46.9, -50.00000000000044, 41.500000000000014, 15.899999999999785, 39.90000000000002, 46.3, 45.3, 46.9, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.90000000000002, 39.10000000000002, 27.299999999999947, -50.00000000000044], "episode_lengths": [500, 158, 342, 500, 64, 36, 500, 130, 500, 500, 76, 62, 74, 500, 84, 46, 500, 500, 32, 96, 94, 310, 500, 100, 500, 180, 500, 336, 66, 500, 500, 500, 500, 500, 74, 500, 500, 206, 500, 500, 500, 44, 500, 44, 76, 500, 500, 66, 500, 500, 500, 402, 56, 82, 42, 40, 80, 500, 58, 66, 66, 34, 64, 48, 58, 500, 500, 80, 64, 80, 500, 500, 40, 58, 184, 148, 96, 44, 500, 500, 54, 40, 32, 500, 86, 342, 102, 38, 48, 32, 46, 134, 48, 500, 500, 100, 112, 110, 228, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38219648330816386, "mean_inference_ms": 1.2243943395759975, "mean_action_processing_ms": 0.1433485340511229, "mean_env_wait_ms": 0.08345855667296238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004024505615234, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1419680118560791}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.823999999999825, "episode_len_mean": 252.38, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 15.899999999999785, -50.00000000000044, 43.7, 46.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 42.70000000000001, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 40.500000000000014, 40.70000000000002, 19.09999999999983, -50.00000000000044, 40.10000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 16.499999999999794, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.5, 41.90000000000001, 45.9, 46.099999999999994, 42.10000000000001, -50.00000000000044, 44.300000000000004, 43.50000000000001, 43.50000000000001, 46.699999999999996, 43.7, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 31.70000000000001, 35.30000000000004, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 46.9, -50.00000000000044, 41.500000000000014, 15.899999999999785, 39.90000000000002, 46.3, 45.3, 46.9, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.90000000000002, 39.10000000000002, 27.299999999999947, -50.00000000000044], "episode_lengths": [500, 158, 342, 500, 64, 36, 500, 130, 500, 500, 76, 62, 74, 500, 84, 46, 500, 500, 32, 96, 94, 310, 500, 100, 500, 180, 500, 336, 66, 500, 500, 500, 500, 500, 74, 500, 500, 206, 500, 500, 500, 44, 500, 44, 76, 500, 500, 66, 500, 500, 500, 402, 56, 82, 42, 40, 80, 500, 58, 66, 66, 34, 64, 48, 58, 500, 500, 80, 64, 80, 500, 500, 40, 58, 184, 148, 96, 44, 500, 500, 54, 40, 32, 500, 86, 342, 102, 38, 48, 32, 46, 134, 48, 500, 500, 100, 112, 110, 228, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38219648330816386, "mean_inference_ms": 1.2243943395759975, "mean_action_processing_ms": 0.1433485340511229, "mean_env_wait_ms": 0.08345855667296238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030004024505615234, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1419680118560791}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5382.7722704509415, "num_env_steps_trained_throughput_per_sec": 5382.7722704509415, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3377.698, "sample_time_ms": 2858.2, "load_time_ms": 18.603, "load_throughput": 967597.497, "learn_time_ms": 490.206, "learn_throughput": 36719.287, "synch_weights_time_ms": 9.189}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4565, "training_iteration": 64, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-35", "timestamp": 1698245855, "time_this_iter_s": 3.3489997386932373, "time_total_s": 212.1883738040924, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.1883738040924, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 58.34000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.084202172485504e-20, "cur_lr": 0.0003, "total_loss": 6.744925944010417, "policy_loss": -0.00042293123486969203, "vf_loss": 6.745398214128282, "vf_explained_var": -0.003931772708892822, "kl": 0.0009221194390748779, "entropy": 0.492756661441591, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2903.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.950999999999831, "episode_len_mean": 246.14, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.300000000000004, 31.70000000000001, 35.30000000000004, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 46.9, -50.00000000000044, 41.500000000000014, 15.899999999999785, 39.90000000000002, 46.3, 45.3, 46.9, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.90000000000002, 39.10000000000002, 27.299999999999947, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 34.50000000000004, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.7, 47.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.299999999999947, 9.299999999999692, 45.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, 44.7, 40.10000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 4.899999999999629, 18.899999999999828, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 15.699999999999783, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 44.5, -50.00000000000044, 47.1, -50.00000000000044, 45.7, 43.50000000000001, 43.900000000000006, 42.30000000000001, 19.899999999999842, 41.90000000000001, 41.30000000000001, -50.00000000000044, 44.900000000000006, 21.299999999999862], "episode_lengths": [40, 58, 184, 148, 96, 44, 500, 500, 54, 40, 32, 500, 86, 342, 102, 38, 48, 32, 46, 134, 48, 500, 500, 100, 112, 110, 228, 500, 500, 328, 500, 156, 76, 500, 122, 500, 500, 500, 32, 60, 46, 500, 500, 64, 28, 500, 48, 500, 500, 74, 228, 408, 42, 500, 500, 96, 500, 52, 60, 500, 54, 100, 500, 70, 500, 46, 500, 36, 500, 452, 312, 138, 500, 500, 500, 96, 82, 70, 500, 500, 36, 344, 500, 46, 500, 42, 56, 500, 30, 500, 44, 66, 62, 78, 302, 82, 88, 500, 52, 288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820728532259286, "mean_inference_ms": 1.2231461765405796, "mean_action_processing_ms": 0.1433108463109668, "mean_env_wait_ms": 0.08311790352715259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019009113311767578, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.12793660163879395}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.950999999999831, "episode_len_mean": 246.14, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.300000000000004, 31.70000000000001, 35.30000000000004, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 46.9, -50.00000000000044, 41.500000000000014, 15.899999999999785, 39.90000000000002, 46.3, 45.3, 46.9, 45.5, 36.70000000000003, 45.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.90000000000002, 39.10000000000002, 27.299999999999947, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 34.50000000000004, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.7, 47.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.299999999999947, 9.299999999999692, 45.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 44.10000000000001, -50.00000000000044, 44.7, 40.10000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 4.899999999999629, 18.899999999999828, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 15.699999999999783, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 44.5, -50.00000000000044, 47.1, -50.00000000000044, 45.7, 43.50000000000001, 43.900000000000006, 42.30000000000001, 19.899999999999842, 41.90000000000001, 41.30000000000001, -50.00000000000044, 44.900000000000006, 21.299999999999862], "episode_lengths": [40, 58, 184, 148, 96, 44, 500, 500, 54, 40, 32, 500, 86, 342, 102, 38, 48, 32, 46, 134, 48, 500, 500, 100, 112, 110, 228, 500, 500, 328, 500, 156, 76, 500, 122, 500, 500, 500, 32, 60, 46, 500, 500, 64, 28, 500, 48, 500, 500, 74, 228, 408, 42, 500, 500, 96, 500, 52, 60, 500, 54, 100, 500, 70, 500, 46, 500, 36, 500, 452, 312, 138, 500, 500, 500, 96, 82, 70, 500, 500, 36, 344, 500, 46, 500, 42, 56, 500, 30, 500, 44, 66, 62, 78, 302, 82, 88, 500, 52, 288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820728532259286, "mean_inference_ms": 1.2231461765405796, "mean_action_processing_ms": 0.1433108463109668, "mean_env_wait_ms": 0.08311790352715259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019009113311767578, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.12793660163879395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5306.646357814193, "num_env_steps_trained_throughput_per_sec": 5306.646357814193, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3371.398, "sample_time_ms": 2852.5, "load_time_ms": 17.603, "load_throughput": 1022561.745, "learn_time_ms": 490.206, "learn_throughput": 36719.289, "synch_weights_time_ms": 9.589}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4637, "training_iteration": 65, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-39", "timestamp": 1698245859, "time_this_iter_s": 3.3969719409942627, "time_total_s": 215.58534574508667, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.58534574508667, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 54.260000000000005, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.42101086242752e-21, "cur_lr": 0.0003, "total_loss": 6.3320604854159885, "policy_loss": -0.0003509761972559823, "vf_loss": 6.332461865743001, "vf_explained_var": 0.0012351883782280816, "kl": 0.0008883564373768927, "entropy": 0.5034539348549313, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2948.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.26199999999981, "episode_len_mean": 268.0, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 4.899999999999629, 18.899999999999828, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 15.699999999999783, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 44.5, -50.00000000000044, 47.1, -50.00000000000044, 45.7, 43.50000000000001, 43.900000000000006, 42.30000000000001, 19.899999999999842, 41.90000000000001, 41.30000000000001, -50.00000000000044, 44.900000000000006, 21.299999999999862, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 20.099999999999845, -50.00000000000044, 46.3, 42.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.7, 20.49999999999985, 45.1, 28.89999999999997, 40.90000000000002, -50.00000000000044, 44.10000000000001, 44.300000000000004, 35.70000000000003, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 8.699999999999683, 40.70000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, 27.299999999999947, 44.7, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 46.699999999999996, 34.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.90000000000002, 44.900000000000006, -50.00000000000044, 16.699999999999797, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 22.49999999999988, -50.00000000000044], "episode_lengths": [500, 70, 500, 46, 500, 36, 500, 452, 312, 138, 500, 500, 500, 96, 82, 70, 500, 500, 36, 344, 500, 46, 500, 42, 56, 500, 30, 500, 44, 66, 62, 78, 302, 82, 88, 500, 52, 288, 500, 500, 44, 500, 300, 500, 38, 76, 196, 500, 500, 70, 54, 296, 50, 212, 92, 500, 60, 58, 144, 36, 500, 50, 500, 500, 48, 414, 94, 500, 68, 500, 42, 228, 54, 64, 58, 500, 500, 500, 500, 272, 34, 152, 500, 500, 114, 68, 500, 500, 464, 102, 52, 500, 334, 38, 500, 500, 90, 40, 276, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38211764855711855, "mean_inference_ms": 1.2235263013188578, "mean_action_processing_ms": 0.14328689726750324, "mean_env_wait_ms": 0.08322571310879592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000904083251953, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11097860336303711}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.26199999999981, "episode_len_mean": 268.0, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 4.899999999999629, 18.899999999999828, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, 15.699999999999783, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 44.5, -50.00000000000044, 47.1, -50.00000000000044, 45.7, 43.50000000000001, 43.900000000000006, 42.30000000000001, 19.899999999999842, 41.90000000000001, 41.30000000000001, -50.00000000000044, 44.900000000000006, 21.299999999999862, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 20.099999999999845, -50.00000000000044, 46.3, 42.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.7, 20.49999999999985, 45.1, 28.89999999999997, 40.90000000000002, -50.00000000000044, 44.10000000000001, 44.300000000000004, 35.70000000000003, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 8.699999999999683, 40.70000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, 27.299999999999947, 44.7, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 46.699999999999996, 34.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.90000000000002, 44.900000000000006, -50.00000000000044, 16.699999999999797, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 22.49999999999988, -50.00000000000044], "episode_lengths": [500, 70, 500, 46, 500, 36, 500, 452, 312, 138, 500, 500, 500, 96, 82, 70, 500, 500, 36, 344, 500, 46, 500, 42, 56, 500, 30, 500, 44, 66, 62, 78, 302, 82, 88, 500, 52, 288, 500, 500, 44, 500, 300, 500, 38, 76, 196, 500, 500, 70, 54, 296, 50, 212, 92, 500, 60, 58, 144, 36, 500, 50, 500, 500, 48, 414, 94, 500, 68, 500, 42, 228, 54, 64, 58, 500, 500, 500, 500, 272, 34, 152, 500, 500, 114, 68, 500, 500, 464, 102, 52, 500, 334, 38, 500, 500, 90, 40, 276, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38211764855711855, "mean_inference_ms": 1.2235263013188578, "mean_action_processing_ms": 0.14328689726750324, "mean_env_wait_ms": 0.08322571310879592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000904083251953, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11097860336303711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5320.720290375876, "num_env_steps_trained_throughput_per_sec": 5320.720290375876, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3369.998, "sample_time_ms": 2857.1, "load_time_ms": 18.703, "load_throughput": 962408.371, "learn_time_ms": 483.203, "learn_throughput": 37251.463, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4699, "training_iteration": 66, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-42", "timestamp": 1698245862, "time_this_iter_s": 3.38800048828125, "time_total_s": 218.97334623336792, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.97334623336792, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.71050543121376e-21, "cur_lr": 0.0003, "total_loss": 6.899478594462077, "policy_loss": -0.0001591670016447703, "vf_loss": 6.899687046474881, "vf_explained_var": 0.00013793574439154732, "kl": 0.0005913586177535359, "entropy": 0.49284448226292926, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2993.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9759999999998035, "episode_len_mean": 280.84, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 27.299999999999947, 44.7, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 46.699999999999996, 34.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.90000000000002, 44.900000000000006, -50.00000000000044, 16.699999999999797, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 42.30000000000001, 44.300000000000004, 33.90000000000004, -50.00000000000044, 36.30000000000003, 44.10000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 35.70000000000003, -50.00000000000044, 40.30000000000002, 45.3, 38.300000000000026, -50.00000000000044, 26.89999999999994, 11.899999999999729, 3.899999999999615, -50.00000000000044, 43.10000000000001, 43.10000000000001, 32.90000000000003, 44.5, 46.5, 46.9, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.70000000000003, 44.300000000000004, 42.10000000000001, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 6.299999999999649, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, -50.00000000000044, 46.5, 20.299999999999848, 43.900000000000006, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 42, 228, 54, 64, 58, 500, 500, 500, 500, 272, 34, 152, 500, 500, 114, 68, 500, 500, 464, 102, 52, 500, 334, 38, 500, 500, 90, 40, 276, 500, 500, 500, 472, 78, 58, 162, 500, 138, 60, 500, 194, 500, 500, 158, 500, 144, 500, 98, 48, 118, 500, 232, 382, 462, 500, 70, 70, 172, 56, 36, 32, 500, 500, 82, 112, 74, 500, 500, 500, 68, 134, 58, 80, 500, 72, 138, 500, 500, 162, 74, 438, 500, 44, 500, 66, 164, 500, 500, 500, 500, 500, 86, 54, 500, 36, 298, 62, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38224588796510206, "mean_inference_ms": 1.2239336264442906, "mean_action_processing_ms": 0.14290197181908645, "mean_env_wait_ms": 0.08347212261933537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020007848739624023, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.12400984764099121}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9759999999998035, "episode_len_mean": 280.84, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 27.299999999999947, 44.7, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 46.699999999999996, 34.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.90000000000002, 44.900000000000006, -50.00000000000044, 16.699999999999797, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.099999999999994, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 42.30000000000001, 44.300000000000004, 33.90000000000004, -50.00000000000044, 36.30000000000003, 44.10000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 35.70000000000003, -50.00000000000044, 40.30000000000002, 45.3, 38.300000000000026, -50.00000000000044, 26.89999999999994, 11.899999999999729, 3.899999999999615, -50.00000000000044, 43.10000000000001, 43.10000000000001, 32.90000000000003, 44.5, 46.5, 46.9, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 36.70000000000003, 44.300000000000004, 42.10000000000001, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 6.299999999999649, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, -50.00000000000044, 46.5, 20.299999999999848, 43.900000000000006, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 42, 228, 54, 64, 58, 500, 500, 500, 500, 272, 34, 152, 500, 500, 114, 68, 500, 500, 464, 102, 52, 500, 334, 38, 500, 500, 90, 40, 276, 500, 500, 500, 472, 78, 58, 162, 500, 138, 60, 500, 194, 500, 500, 158, 500, 144, 500, 98, 48, 118, 500, 232, 382, 462, 500, 70, 70, 172, 56, 36, 32, 500, 500, 82, 112, 74, 500, 500, 500, 68, 134, 58, 80, 500, 72, 138, 500, 500, 162, 74, 438, 500, 44, 500, 66, 164, 500, 500, 500, 500, 500, 86, 54, 500, 36, 298, 62, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38224588796510206, "mean_inference_ms": 1.2239336264442906, "mean_action_processing_ms": 0.14290197181908645, "mean_env_wait_ms": 0.08347212261933537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020007848739624023, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.12400984764099121}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5405.40475522577, "num_env_steps_trained_throughput_per_sec": 5405.40475522577, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3365.698, "sample_time_ms": 2863.797, "load_time_ms": 18.707, "load_throughput": 962225.607, "learn_time_ms": 472.299, "learn_throughput": 38111.42, "synch_weights_time_ms": 9.496}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4768, "training_iteration": 67, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-46", "timestamp": 1698245866, "time_this_iter_s": 3.3349997997283936, "time_total_s": 222.3083460330963, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.3083460330963, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 66.575, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.35525271560688e-21, "cur_lr": 0.0003, "total_loss": 6.750936656528049, "policy_loss": -0.0005565405098928346, "vf_loss": 6.751543098025852, "vf_explained_var": -0.002497647868262397, "kl": 0.0012166402794668507, "entropy": 0.4995123750633664, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3038.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.043999999999827, "episode_len_mean": 260.22, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, 36.70000000000003, 44.300000000000004, 42.10000000000001, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 6.299999999999649, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, -50.00000000000044, 46.5, 20.299999999999848, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.500000000000014, 44.900000000000006, 39.10000000000002, -50.00000000000044, 46.5, 41.500000000000014, -50.00000000000044, 42.10000000000001, 22.49999999999988, -50.00000000000044, 35.900000000000034, 25.699999999999925, 15.299999999999777, 41.70000000000002, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 0.49999999999956657, 44.300000000000004, 42.70000000000001, -50.00000000000044, 14.299999999999763, 43.50000000000001, -50.00000000000044, 15.899999999999785, 5.299999999999635, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 3.499999999999609, 40.500000000000014, 42.30000000000001, 39.70000000000002, 45.9, -50.00000000000044, 33.30000000000003, 32.700000000000024, 40.90000000000002, 34.10000000000004, -50.00000000000044, 44.900000000000006, 42.500000000000014, 46.699999999999996, 35.500000000000036, 47.1, 35.900000000000034, 26.09999999999993, 45.1, 46.699999999999996, -50.00000000000044, 41.90000000000001, 31.300000000000004, 16.699999999999797], "episode_lengths": [500, 500, 68, 134, 58, 80, 500, 72, 138, 500, 500, 162, 74, 438, 500, 44, 500, 66, 164, 500, 500, 500, 500, 500, 86, 54, 500, 36, 298, 62, 500, 60, 500, 66, 500, 500, 500, 80, 86, 52, 110, 500, 36, 86, 500, 80, 276, 500, 142, 244, 348, 84, 160, 500, 36, 500, 204, 500, 500, 54, 500, 34, 500, 496, 58, 74, 500, 358, 66, 500, 342, 448, 46, 500, 74, 500, 466, 96, 78, 104, 42, 500, 168, 174, 92, 160, 500, 52, 76, 34, 146, 30, 142, 240, 50, 34, 500, 82, 188, 334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820923693626561, "mean_inference_ms": 1.2233557223030898, "mean_action_processing_ms": 0.1430811424452355, "mean_env_wait_ms": 0.08326793691928992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002500534057617, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.13700628280639648}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.043999999999827, "episode_len_mean": 260.22, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, 36.70000000000003, 44.300000000000004, 42.10000000000001, -50.00000000000044, 42.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 6.299999999999649, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, -50.00000000000044, 46.5, 20.299999999999848, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.500000000000014, 44.900000000000006, 39.10000000000002, -50.00000000000044, 46.5, 41.500000000000014, -50.00000000000044, 42.10000000000001, 22.49999999999988, -50.00000000000044, 35.900000000000034, 25.699999999999925, 15.299999999999777, 41.70000000000002, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 0.49999999999956657, 44.300000000000004, 42.70000000000001, -50.00000000000044, 14.299999999999763, 43.50000000000001, -50.00000000000044, 15.899999999999785, 5.299999999999635, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 3.499999999999609, 40.500000000000014, 42.30000000000001, 39.70000000000002, 45.9, -50.00000000000044, 33.30000000000003, 32.700000000000024, 40.90000000000002, 34.10000000000004, -50.00000000000044, 44.900000000000006, 42.500000000000014, 46.699999999999996, 35.500000000000036, 47.1, 35.900000000000034, 26.09999999999993, 45.1, 46.699999999999996, -50.00000000000044, 41.90000000000001, 31.300000000000004, 16.699999999999797], "episode_lengths": [500, 500, 68, 134, 58, 80, 500, 72, 138, 500, 500, 162, 74, 438, 500, 44, 500, 66, 164, 500, 500, 500, 500, 500, 86, 54, 500, 36, 298, 62, 500, 60, 500, 66, 500, 500, 500, 80, 86, 52, 110, 500, 36, 86, 500, 80, 276, 500, 142, 244, 348, 84, 160, 500, 36, 500, 204, 500, 500, 54, 500, 34, 500, 496, 58, 74, 500, 358, 66, 500, 342, 448, 46, 500, 74, 500, 466, 96, 78, 104, 42, 500, 168, 174, 92, 160, 500, 52, 76, 34, 146, 30, 142, 240, 50, 34, 500, 82, 188, 334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820923693626561, "mean_inference_ms": 1.2233557223030898, "mean_action_processing_ms": 0.1430811424452355, "mean_env_wait_ms": 0.08326793691928992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002500534057617, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.13700628280639648}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5410.279301584799, "num_env_steps_trained_throughput_per_sec": 5410.279301584799, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3363.398, "sample_time_ms": 2859.397, "load_time_ms": 17.804, "load_throughput": 1011027.56, "learn_time_ms": 475.502, "learn_throughput": 37854.708, "synch_weights_time_ms": 9.396}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4836, "training_iteration": 68, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-49", "timestamp": 1698245869, "time_this_iter_s": 3.332000494003296, "time_total_s": 225.6403465270996, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.6403465270996, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.239999999999995, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.7762635780344e-22, "cur_lr": 0.0003, "total_loss": 6.447402487860786, "policy_loss": -0.0003573983079857296, "vf_loss": 6.447809134589301, "vf_explained_var": -0.001989440123240153, "kl": 0.0012929506429442325, "entropy": 0.4921442806720734, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3083.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.860999999999824, "episode_len_mean": 267.04, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 0.49999999999956657, 44.300000000000004, 42.70000000000001, -50.00000000000044, 14.299999999999763, 43.50000000000001, -50.00000000000044, 15.899999999999785, 5.299999999999635, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 3.499999999999609, 40.500000000000014, 42.30000000000001, 39.70000000000002, 45.9, -50.00000000000044, 33.30000000000003, 32.700000000000024, 40.90000000000002, 34.10000000000004, -50.00000000000044, 44.900000000000006, 42.500000000000014, 46.699999999999996, 35.500000000000036, 47.1, 35.900000000000034, 26.09999999999993, 45.1, 46.699999999999996, -50.00000000000044, 41.90000000000001, 31.300000000000004, 16.699999999999797, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 40.70000000000002, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 39.300000000000026, 44.300000000000004, -50.00000000000044, 45.1, 38.50000000000003, 35.70000000000003, 45.9, -50.00000000000044, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 41.500000000000014, 39.10000000000002, 24.69999999999991, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 45.7, 18.099999999999817, 45.9, -50.00000000000044, -50.00000000000044, 21.499999999999865, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, 42.70000000000001, 46.5, 31.500000000000007, 46.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.10000000000004], "episode_lengths": [500, 34, 500, 496, 58, 74, 500, 358, 66, 500, 342, 448, 46, 500, 74, 500, 466, 96, 78, 104, 42, 500, 168, 174, 92, 160, 500, 52, 76, 34, 146, 30, 142, 240, 50, 34, 500, 82, 188, 334, 500, 500, 96, 500, 500, 292, 500, 500, 500, 118, 94, 156, 500, 500, 72, 108, 58, 500, 50, 116, 144, 42, 500, 66, 146, 500, 500, 500, 256, 500, 44, 86, 110, 254, 500, 500, 128, 60, 44, 320, 42, 500, 500, 286, 316, 500, 58, 500, 500, 280, 500, 74, 36, 186, 36, 500, 500, 96, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38199357377690335, "mean_inference_ms": 1.2242329200717657, "mean_action_processing_ms": 0.14296216194617045, "mean_env_wait_ms": 0.08322358051298138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030000925064086914, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12399673461914062}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.860999999999824, "episode_len_mean": 267.04, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 0.49999999999956657, 44.300000000000004, 42.70000000000001, -50.00000000000044, 14.299999999999763, 43.50000000000001, -50.00000000000044, 15.899999999999785, 5.299999999999635, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 3.499999999999609, 40.500000000000014, 42.30000000000001, 39.70000000000002, 45.9, -50.00000000000044, 33.30000000000003, 32.700000000000024, 40.90000000000002, 34.10000000000004, -50.00000000000044, 44.900000000000006, 42.500000000000014, 46.699999999999996, 35.500000000000036, 47.1, 35.900000000000034, 26.09999999999993, 45.1, 46.699999999999996, -50.00000000000044, 41.90000000000001, 31.300000000000004, 16.699999999999797, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 40.70000000000002, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 39.300000000000026, 44.300000000000004, -50.00000000000044, 45.1, 38.50000000000003, 35.70000000000003, 45.9, -50.00000000000044, 43.50000000000001, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 45.7, 41.500000000000014, 39.10000000000002, 24.69999999999991, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.10000000000001, 45.7, 18.099999999999817, 45.9, -50.00000000000044, -50.00000000000044, 21.499999999999865, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, 42.70000000000001, 46.5, 31.500000000000007, 46.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.10000000000004], "episode_lengths": [500, 34, 500, 496, 58, 74, 500, 358, 66, 500, 342, 448, 46, 500, 74, 500, 466, 96, 78, 104, 42, 500, 168, 174, 92, 160, 500, 52, 76, 34, 146, 30, 142, 240, 50, 34, 500, 82, 188, 334, 500, 500, 96, 500, 500, 292, 500, 500, 500, 118, 94, 156, 500, 500, 72, 108, 58, 500, 50, 116, 144, 42, 500, 66, 146, 500, 500, 500, 256, 500, 44, 86, 110, 254, 500, 500, 128, 60, 44, 320, 42, 500, 500, 286, 316, 500, 58, 500, 500, 280, 500, 74, 36, 186, 36, 500, 500, 96, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38199357377690335, "mean_inference_ms": 1.2242329200717657, "mean_action_processing_ms": 0.14296216194617045, "mean_env_wait_ms": 0.08322358051298138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030000925064086914, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12399673461914062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5353.954857770441, "num_env_steps_trained_throughput_per_sec": 5353.954857770441, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3366.098, "sample_time_ms": 2857.497, "load_time_ms": 17.706, "load_throughput": 1016579.171, "learn_time_ms": 480.102, "learn_throughput": 37492.013, "synch_weights_time_ms": 9.494}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4896, "training_iteration": 69, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-52", "timestamp": 1698245872, "time_this_iter_s": 3.3669991493225098, "time_total_s": 229.00734567642212, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.00734567642212, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 56.019999999999996, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172e-22, "cur_lr": 0.0003, "total_loss": 6.99991200764974, "policy_loss": -0.0005416678885618846, "vf_loss": 7.000505532158746, "vf_explained_var": -0.002591338422563341, "kl": 0.0010813326473175444, "entropy": 0.5192086292637719, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3128.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.037999999999844, "episode_len_mean": 240.3, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.499999999999865, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, 42.70000000000001, 46.5, 31.500000000000007, 46.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.10000000000004, 45.1, -50.00000000000044, 40.10000000000002, 24.099999999999902, 41.30000000000001, 42.10000000000001, 42.70000000000001, 44.7, 10.699999999999712, -50.00000000000044, 43.7, 16.8999999999998, -50.00000000000044, 16.8999999999998, 37.50000000000003, 43.7, 45.7, -50.00000000000044, 37.10000000000003, 45.9, 43.900000000000006, 42.10000000000001, -50.00000000000044, 46.099999999999994, 46.699999999999996, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, 45.7, 28.89999999999997, 41.70000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.5, 36.10000000000004, 37.70000000000003, 42.10000000000001, 43.7, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 18.899999999999828, 36.900000000000034, 37.50000000000003, 42.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 38.700000000000024, 44.7, 44.7, 44.5, 43.7, -50.00000000000044, 36.900000000000034, 27.299999999999947, 44.10000000000001, 46.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 30.29999999999999, -50.00000000000044, -50.00000000000044, 37.90000000000003], "episode_lengths": [286, 316, 500, 58, 500, 500, 280, 500, 74, 36, 186, 36, 500, 500, 96, 500, 150, 50, 500, 100, 260, 88, 80, 74, 54, 394, 500, 64, 332, 500, 332, 126, 64, 44, 500, 130, 42, 62, 80, 500, 40, 34, 92, 42, 500, 500, 500, 478, 44, 212, 84, 500, 500, 108, 500, 78, 500, 40, 500, 500, 128, 36, 140, 124, 80, 64, 66, 500, 52, 500, 60, 500, 312, 132, 126, 76, 500, 68, 500, 56, 48, 500, 114, 54, 54, 56, 64, 500, 132, 228, 60, 38, 86, 500, 500, 110, 198, 500, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38175589604854865, "mean_inference_ms": 1.2231289946984167, "mean_action_processing_ms": 0.1428765929778647, "mean_env_wait_ms": 0.08336715890711409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019019365310668945, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.09801054000854492}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.037999999999844, "episode_len_mean": 240.3, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.499999999999865, 18.499999999999822, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, 42.70000000000001, 46.5, 31.500000000000007, 46.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 35.10000000000004, 45.1, -50.00000000000044, 40.10000000000002, 24.099999999999902, 41.30000000000001, 42.10000000000001, 42.70000000000001, 44.7, 10.699999999999712, -50.00000000000044, 43.7, 16.8999999999998, -50.00000000000044, 16.8999999999998, 37.50000000000003, 43.7, 45.7, -50.00000000000044, 37.10000000000003, 45.9, 43.900000000000006, 42.10000000000001, -50.00000000000044, 46.099999999999994, 46.699999999999996, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, 45.7, 28.89999999999997, 41.70000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.5, 36.10000000000004, 37.70000000000003, 42.10000000000001, 43.7, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 18.899999999999828, 36.900000000000034, 37.50000000000003, 42.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 38.700000000000024, 44.7, 44.7, 44.5, 43.7, -50.00000000000044, 36.900000000000034, 27.299999999999947, 44.10000000000001, 46.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 30.29999999999999, -50.00000000000044, -50.00000000000044, 37.90000000000003], "episode_lengths": [286, 316, 500, 58, 500, 500, 280, 500, 74, 36, 186, 36, 500, 500, 96, 500, 150, 50, 500, 100, 260, 88, 80, 74, 54, 394, 500, 64, 332, 500, 332, 126, 64, 44, 500, 130, 42, 62, 80, 500, 40, 34, 92, 42, 500, 500, 500, 478, 44, 212, 84, 500, 500, 108, 500, 78, 500, 40, 500, 500, 128, 36, 140, 124, 80, 64, 66, 500, 52, 500, 60, 500, 312, 132, 126, 76, 500, 68, 500, 56, 48, 500, 114, 54, 54, 56, 64, 500, 132, 228, 60, 38, 86, 500, 500, 110, 198, 500, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38175589604854865, "mean_inference_ms": 1.2231289946984167, "mean_action_processing_ms": 0.1428765929778647, "mean_env_wait_ms": 0.08336715890711409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019019365310668945, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.09801054000854492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5297.232920535267, "num_env_steps_trained_throughput_per_sec": 5297.232920535267, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3367.298, "sample_time_ms": 2856.297, "load_time_ms": 18.406, "load_throughput": 977928.794, "learn_time_ms": 481.902, "learn_throughput": 37351.97, "synch_weights_time_ms": 9.494}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4979, "training_iteration": 70, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-56", "timestamp": 1698245876, "time_this_iter_s": 3.4039993286132812, "time_total_s": 232.4113450050354, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.4113450050354, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 55.46, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086e-22, "cur_lr": 0.0003, "total_loss": 6.523283089531793, "policy_loss": -0.00038674564825163946, "vf_loss": 6.523723114861382, "vf_explained_var": -0.003753206464979384, "kl": 0.0011937452564754697, "entropy": 0.5329793790976206, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3173.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.759999999999826, "episode_len_mean": 263.02, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, 42.10000000000001, 43.7, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 18.899999999999828, 36.900000000000034, 37.50000000000003, 42.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 38.700000000000024, 44.7, 44.7, 44.5, 43.7, -50.00000000000044, 36.900000000000034, 27.299999999999947, 44.10000000000001, 46.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 30.29999999999999, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.500000000000014, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 37.50000000000003, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 42.70000000000001, 44.7, 44.5, 43.30000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.30000000000002, 38.50000000000003, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 19.09999999999983, 31.1, 26.09999999999993, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.5, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834], "episode_lengths": [124, 80, 64, 66, 500, 52, 500, 60, 500, 312, 132, 126, 76, 500, 68, 500, 56, 48, 500, 114, 54, 54, 56, 64, 500, 132, 228, 60, 38, 86, 500, 500, 110, 198, 500, 500, 122, 500, 500, 500, 90, 500, 86, 44, 52, 500, 500, 500, 120, 126, 62, 500, 42, 74, 500, 276, 500, 500, 246, 500, 74, 54, 56, 68, 134, 500, 500, 54, 500, 500, 152, 98, 116, 500, 156, 500, 50, 500, 70, 310, 190, 240, 88, 218, 500, 56, 84, 500, 52, 160, 500, 156, 500, 500, 482, 78, 500, 500, 500, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3818912671510747, "mean_inference_ms": 1.222967804073288, "mean_action_processing_ms": 0.14312618551606465, "mean_env_wait_ms": 0.08362036396563502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02801036834716797, "StateBufferConnector_ms": 0.004995584487915039, "ViewRequirementAgentConnector_ms": 0.11099886894226074}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.759999999999826, "episode_len_mean": 263.02, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, 42.10000000000001, 43.7, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 18.899999999999828, 36.900000000000034, 37.50000000000003, 42.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 38.700000000000024, 44.7, 44.7, 44.5, 43.7, -50.00000000000044, 36.900000000000034, 27.299999999999947, 44.10000000000001, 46.3, 41.500000000000014, -50.00000000000044, -50.00000000000044, 39.10000000000002, 30.29999999999999, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 41.500000000000014, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 37.50000000000003, 43.900000000000006, -50.00000000000044, 45.9, 42.70000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 42.70000000000001, 44.7, 44.5, 43.30000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, 40.30000000000002, 38.50000000000003, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 19.09999999999983, 31.1, 26.09999999999993, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.5, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834], "episode_lengths": [124, 80, 64, 66, 500, 52, 500, 60, 500, 312, 132, 126, 76, 500, 68, 500, 56, 48, 500, 114, 54, 54, 56, 64, 500, 132, 228, 60, 38, 86, 500, 500, 110, 198, 500, 500, 122, 500, 500, 500, 90, 500, 86, 44, 52, 500, 500, 500, 120, 126, 62, 500, 42, 74, 500, 276, 500, 500, 246, 500, 74, 54, 56, 68, 134, 500, 500, 54, 500, 500, 152, 98, 116, 500, 156, 500, 50, 500, 70, 310, 190, 240, 88, 218, 500, 56, 84, 500, 52, 160, 500, 156, 500, 500, 482, 78, 500, 500, 500, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3818912671510747, "mean_inference_ms": 1.222967804073288, "mean_action_processing_ms": 0.14312618551606465, "mean_env_wait_ms": 0.08362036396563502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02801036834716797, "StateBufferConnector_ms": 0.004995584487915039, "ViewRequirementAgentConnector_ms": 0.11099886894226074}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5339.656830335812, "num_env_steps_trained_throughput_per_sec": 5339.656830335812, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3363.098, "sample_time_ms": 2857.997, "load_time_ms": 17.206, "load_throughput": 1046133.569, "learn_time_ms": 477.002, "learn_throughput": 37735.672, "synch_weights_time_ms": 9.694}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 5042, "training_iteration": 71, "trial_id": "9f288_00005", "date": "2023-10-25_15-57-59", "timestamp": 1698245879, "time_this_iter_s": 3.37600040435791, "time_total_s": 235.7873454093933, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.7873454093933, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 66.19999999999999, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543e-23, "cur_lr": 0.0003, "total_loss": 6.697820546891954, "policy_loss": -0.00016883905563089583, "vf_loss": 6.6980403476291235, "vf_explained_var": -0.0016944607098897297, "kl": 0.0010251730968826047, "entropy": 0.5088075207339393, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3218.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.518999999999834, "episode_len_mean": 250.46, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 19.09999999999983, 31.1, 26.09999999999993, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.5, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.300000000000004, 41.70000000000002, 38.700000000000024, 25.29999999999992, 41.500000000000014, 42.70000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 46.9, 42.30000000000001, 38.300000000000026, 43.900000000000006, 36.30000000000003, 41.100000000000016, 44.10000000000001, -50.00000000000044, 28.699999999999967, 43.7, -50.00000000000044, 17.099999999999802, -50.00000000000044, 42.70000000000001, 21.499999999999865, 30.29999999999999, -50.00000000000044, 46.5, 42.900000000000006, 42.70000000000001, 45.5, 45.1, 45.9, 35.900000000000034, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 44.900000000000006, 40.70000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 42.10000000000001, 42.900000000000006, 37.300000000000026, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.300000000000004, 44.7, 47.7, 41.90000000000001, 44.900000000000006, 45.3, 46.699999999999996, -50.00000000000044], "episode_lengths": [500, 50, 500, 70, 310, 190, 240, 88, 218, 500, 56, 84, 500, 52, 160, 500, 156, 500, 500, 482, 78, 500, 500, 500, 308, 500, 58, 84, 114, 248, 86, 74, 500, 26, 500, 500, 500, 360, 500, 32, 78, 118, 62, 138, 90, 60, 500, 214, 64, 500, 330, 500, 74, 286, 198, 500, 36, 72, 74, 46, 50, 42, 142, 64, 500, 500, 500, 500, 500, 500, 58, 500, 88, 500, 500, 82, 500, 48, 52, 94, 278, 500, 500, 86, 500, 46, 80, 72, 128, 158, 62, 500, 58, 54, 24, 82, 52, 48, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38187010400926213, "mean_inference_ms": 1.222516933378107, "mean_action_processing_ms": 0.14290413508085723, "mean_env_wait_ms": 0.08337791003942811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028054237365722656, "StateBufferConnector_ms": 0.004994630813598633, "ViewRequirementAgentConnector_ms": 0.11098456382751465}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.518999999999834, "episode_len_mean": 250.46, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 19.09999999999983, 31.1, 26.09999999999993, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.5, 41.70000000000002, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.300000000000004, 41.70000000000002, 38.700000000000024, 25.29999999999992, 41.500000000000014, 42.70000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, 46.9, 42.30000000000001, 38.300000000000026, 43.900000000000006, 36.30000000000003, 41.100000000000016, 44.10000000000001, -50.00000000000044, 28.699999999999967, 43.7, -50.00000000000044, 17.099999999999802, -50.00000000000044, 42.70000000000001, 21.499999999999865, 30.29999999999999, -50.00000000000044, 46.5, 42.900000000000006, 42.70000000000001, 45.5, 45.1, 45.9, 35.900000000000034, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 44.900000000000006, 40.70000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 42.10000000000001, 42.900000000000006, 37.300000000000026, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.300000000000004, 44.7, 47.7, 41.90000000000001, 44.900000000000006, 45.3, 46.699999999999996, -50.00000000000044], "episode_lengths": [500, 50, 500, 70, 310, 190, 240, 88, 218, 500, 56, 84, 500, 52, 160, 500, 156, 500, 500, 482, 78, 500, 500, 500, 308, 500, 58, 84, 114, 248, 86, 74, 500, 26, 500, 500, 500, 360, 500, 32, 78, 118, 62, 138, 90, 60, 500, 214, 64, 500, 330, 500, 74, 286, 198, 500, 36, 72, 74, 46, 50, 42, 142, 64, 500, 500, 500, 500, 500, 500, 58, 500, 88, 500, 500, 82, 500, 48, 52, 94, 278, 500, 500, 86, 500, 46, 80, 72, 128, 158, 62, 500, 58, 54, 24, 82, 52, 48, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38187010400926213, "mean_inference_ms": 1.222516933378107, "mean_action_processing_ms": 0.14290413508085723, "mean_env_wait_ms": 0.08337791003942811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028054237365722656, "StateBufferConnector_ms": 0.004994630813598633, "ViewRequirementAgentConnector_ms": 0.11098456382751465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5349.176305543845, "num_env_steps_trained_throughput_per_sec": 5349.176305543845, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3361.198, "sample_time_ms": 2854.797, "load_time_ms": 18.109, "load_throughput": 993965.859, "learn_time_ms": 477.596, "learn_throughput": 37688.737, "synch_weights_time_ms": 9.597}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 5117, "training_iteration": 72, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-03", "timestamp": 1698245883, "time_this_iter_s": 3.370999574661255, "time_total_s": 239.15834498405457, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.15834498405457, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 55.239999999999995, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715e-23, "cur_lr": 0.0003, "total_loss": 6.516701115502252, "policy_loss": -5.698613822460175e-05, "vf_loss": 6.516806719038222, "vf_explained_var": -0.006049964163038466, "kl": 0.0005426734404510272, "entropy": 0.4858704209327698, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3263.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.964999999999886, "episode_len_mean": 196.1, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.300000000000004, 44.7, 47.7, 41.90000000000001, 44.900000000000006, 45.3, 46.699999999999996, -50.00000000000044, 24.69999999999991, 42.30000000000001, 44.300000000000004, 22.899999999999885, 24.899999999999913, 37.300000000000026, 40.70000000000002, 19.899999999999842, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 33.500000000000036, 46.699999999999996, 44.900000000000006, 45.1, 46.3, 47.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.70000000000002, 46.099999999999994, 41.30000000000001, 37.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, 39.10000000000002, 42.500000000000014, 42.900000000000006, 39.300000000000026, 44.5, -50.00000000000044, 45.7, 44.300000000000004, 44.900000000000006, 37.90000000000003, 43.7, -50.00000000000044, 28.89999999999997, 5.499999999999638, 44.7, -50.00000000000044, 45.9, 38.90000000000002, 40.500000000000014, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 32.30000000000002, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.90000000000003, 46.5, 45.5, 35.500000000000036, 45.5, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.10000000000001, 32.100000000000016, 42.30000000000001, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.10000000000001, 44.900000000000006], "episode_lengths": [128, 158, 62, 500, 58, 54, 24, 82, 52, 48, 34, 500, 254, 78, 58, 272, 252, 128, 94, 302, 62, 74, 500, 500, 156, 166, 34, 52, 50, 38, 28, 500, 500, 64, 500, 84, 40, 88, 126, 106, 500, 500, 58, 48, 500, 110, 76, 72, 108, 56, 500, 44, 58, 52, 122, 64, 500, 212, 446, 54, 500, 42, 112, 96, 54, 110, 500, 500, 108, 178, 500, 36, 74, 500, 64, 500, 40, 500, 122, 36, 46, 146, 46, 500, 90, 34, 500, 500, 112, 70, 180, 78, 500, 38, 34, 500, 156, 500, 70, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821076413935056, "mean_inference_ms": 1.2225214960905666, "mean_action_processing_ms": 0.1431811985957179, "mean_env_wait_ms": 0.0831503553090101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025993824005126953, "StateBufferConnector_ms": 0.004002571105957031, "ViewRequirementAgentConnector_ms": 0.1470012664794922}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.964999999999886, "episode_len_mean": 196.1, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.300000000000004, 44.7, 47.7, 41.90000000000001, 44.900000000000006, 45.3, 46.699999999999996, -50.00000000000044, 24.69999999999991, 42.30000000000001, 44.300000000000004, 22.899999999999885, 24.899999999999913, 37.300000000000026, 40.70000000000002, 19.899999999999842, 43.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 33.500000000000036, 46.699999999999996, 44.900000000000006, 45.1, 46.3, 47.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 41.70000000000002, 46.099999999999994, 41.30000000000001, 37.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, 39.10000000000002, 42.500000000000014, 42.900000000000006, 39.300000000000026, 44.5, -50.00000000000044, 45.7, 44.300000000000004, 44.900000000000006, 37.90000000000003, 43.7, -50.00000000000044, 28.89999999999997, 5.499999999999638, 44.7, -50.00000000000044, 45.9, 38.90000000000002, 40.500000000000014, 44.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 32.30000000000002, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.90000000000003, 46.5, 45.5, 35.500000000000036, 45.5, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.10000000000001, 32.100000000000016, 42.30000000000001, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.10000000000001, 44.900000000000006], "episode_lengths": [128, 158, 62, 500, 58, 54, 24, 82, 52, 48, 34, 500, 254, 78, 58, 272, 252, 128, 94, 302, 62, 74, 500, 500, 156, 166, 34, 52, 50, 38, 28, 500, 500, 64, 500, 84, 40, 88, 126, 106, 500, 500, 58, 48, 500, 110, 76, 72, 108, 56, 500, 44, 58, 52, 122, 64, 500, 212, 446, 54, 500, 42, 112, 96, 54, 110, 500, 500, 108, 178, 500, 36, 74, 500, 64, 500, 40, 500, 122, 36, 46, 146, 46, 500, 90, 34, 500, 500, 112, 70, 180, 78, 500, 38, 34, 500, 156, 500, 70, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821076413935056, "mean_inference_ms": 1.2225214960905666, "mean_action_processing_ms": 0.1431811985957179, "mean_env_wait_ms": 0.0831503553090101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025993824005126953, "StateBufferConnector_ms": 0.004002571105957031, "ViewRequirementAgentConnector_ms": 0.1470012664794922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5305.0388454274935, "num_env_steps_trained_throughput_per_sec": 5305.0388454274935, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3366.498, "sample_time_ms": 2860.501, "load_time_ms": 17.806, "load_throughput": 1010892.186, "learn_time_ms": 477.496, "learn_throughput": 37696.622, "synch_weights_time_ms": 9.597}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5205, "training_iteration": 73, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-06", "timestamp": 1698245886, "time_this_iter_s": 3.3980000019073486, "time_total_s": 242.5563449859619, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.5563449859619, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 58.6, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.11758236813575e-23, "cur_lr": 0.0003, "total_loss": 6.6940103530883786, "policy_loss": -0.0005207955837249756, "vf_loss": 6.694581402672662, "vf_explained_var": -0.011327535576290555, "kl": 0.0006285252842392057, "entropy": 0.5030413495169745, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.547999999999849, "episode_len_mean": 235.18, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 45.5, 35.500000000000036, 45.5, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.10000000000001, 32.100000000000016, 42.30000000000001, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 43.7, 42.70000000000001, -50.00000000000044, 45.5, 45.3, 43.10000000000001, -50.00000000000044, 35.30000000000004, 45.3, 36.70000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 47.9, -50.00000000000044, 44.5, 36.70000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 40.30000000000002, 45.3, 43.7, 43.10000000000001, -50.00000000000044, 21.299999999999862, 34.900000000000034, 45.9, 40.70000000000002, 33.90000000000004, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 22.899999999999885, 21.89999999999987, 46.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 38.10000000000002, 35.900000000000034, -50.00000000000044, 29.899999999999984, 46.9, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.10000000000001, 42.500000000000014, 44.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.699999999999996, -50.00000000000044], "episode_lengths": [36, 46, 146, 46, 500, 90, 34, 500, 500, 112, 70, 180, 78, 500, 38, 34, 500, 156, 500, 70, 52, 500, 500, 500, 372, 500, 500, 54, 500, 86, 64, 74, 500, 46, 48, 70, 500, 148, 48, 134, 162, 500, 500, 48, 46, 22, 500, 56, 134, 78, 500, 500, 108, 500, 98, 48, 64, 70, 500, 288, 152, 42, 94, 162, 500, 36, 60, 500, 272, 282, 32, 62, 500, 500, 500, 42, 44, 120, 142, 500, 202, 32, 38, 500, 500, 40, 80, 76, 56, 126, 500, 500, 156, 84, 122, 500, 500, 376, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817075572476529, "mean_inference_ms": 1.2221303608748126, "mean_action_processing_ms": 0.14318482805331956, "mean_env_wait_ms": 0.08328858314659231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.13399863243103027}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.547999999999849, "episode_len_mean": 235.18, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 45.5, 35.500000000000036, 45.5, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 43.10000000000001, 32.100000000000016, 42.30000000000001, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 34.50000000000004, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 43.7, 42.70000000000001, -50.00000000000044, 45.5, 45.3, 43.10000000000001, -50.00000000000044, 35.30000000000004, 45.3, 36.70000000000003, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 47.9, -50.00000000000044, 44.5, 36.70000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 40.30000000000002, 45.3, 43.7, 43.10000000000001, -50.00000000000044, 21.299999999999862, 34.900000000000034, 45.9, 40.70000000000002, 33.90000000000004, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 22.899999999999885, 21.89999999999987, 46.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.7, 38.10000000000002, 35.900000000000034, -50.00000000000044, 29.899999999999984, 46.9, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.10000000000001, 42.500000000000014, 44.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.699999999999996, -50.00000000000044], "episode_lengths": [36, 46, 146, 46, 500, 90, 34, 500, 500, 112, 70, 180, 78, 500, 38, 34, 500, 156, 500, 70, 52, 500, 500, 500, 372, 500, 500, 54, 500, 86, 64, 74, 500, 46, 48, 70, 500, 148, 48, 134, 162, 500, 500, 48, 46, 22, 500, 56, 134, 78, 500, 500, 108, 500, 98, 48, 64, 70, 500, 288, 152, 42, 94, 162, 500, 36, 60, 500, 272, 282, 32, 62, 500, 500, 500, 42, 44, 120, 142, 500, 202, 32, 38, 500, 500, 40, 80, 76, 56, 126, 500, 500, 156, 84, 122, 500, 500, 376, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817075572476529, "mean_inference_ms": 1.2221303608748126, "mean_action_processing_ms": 0.14318482805331956, "mean_env_wait_ms": 0.08328858314659231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.13399863243103027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5433.141053670292, "num_env_steps_trained_throughput_per_sec": 5433.141053670292, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3363.398, "sample_time_ms": 2855.8, "load_time_ms": 17.106, "load_throughput": 1052261.839, "learn_time_ms": 479.893, "learn_throughput": 37508.326, "synch_weights_time_ms": 9.4}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5284, "training_iteration": 74, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-09", "timestamp": 1698245889, "time_this_iter_s": 3.318000555038452, "time_total_s": 245.87434554100037, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.87434554100037, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 54.86, "ram_util_percent": 27.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.058791184067875e-23, "cur_lr": 0.0003, "total_loss": 6.8819360521104604, "policy_loss": -0.00032039864195717704, "vf_loss": 6.88230676651001, "vf_explained_var": -0.009665266672770182, "kl": 0.0006921434586127854, "entropy": 0.5025087813536326, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3353.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.836999999999858, "episode_len_mean": 227.32, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.10000000000001, 42.500000000000014, 44.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.699999999999996, -50.00000000000044, 34.50000000000004, 37.90000000000003, 46.9, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, -50.00000000000044, 43.30000000000001, 22.699999999999882, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 16.8999999999998, -50.00000000000044, 15.699999999999783, 25.29999999999992, 11.899999999999729, 38.10000000000002, 39.50000000000002, 45.3, 47.1, 34.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5, 42.70000000000001, 44.7, 26.499999999999936, -50.00000000000044, 41.70000000000002, 43.30000000000001, 45.7, 43.10000000000001, 34.10000000000004, 42.900000000000006, 26.69999999999994, 21.499999999999865, 46.099999999999994, 45.5, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, 44.300000000000004, 38.10000000000002, -50.00000000000044, 46.9, 44.10000000000001, 46.099999999999994, 44.300000000000004, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 45.7, 39.90000000000002, -50.00000000000044, 43.7, 41.100000000000016, 45.9, 36.10000000000004, -50.00000000000044, 45.7, 36.30000000000003], "episode_lengths": [38, 500, 500, 40, 80, 76, 56, 126, 500, 500, 156, 84, 122, 500, 500, 376, 34, 500, 156, 122, 32, 500, 500, 32, 70, 500, 68, 274, 48, 62, 500, 500, 88, 332, 500, 344, 248, 382, 120, 106, 48, 30, 154, 500, 500, 58, 500, 500, 500, 48, 500, 500, 56, 74, 54, 236, 500, 84, 68, 44, 70, 160, 72, 234, 286, 40, 46, 58, 500, 112, 500, 60, 58, 120, 500, 32, 60, 40, 58, 80, 112, 500, 500, 42, 500, 76, 500, 62, 64, 500, 44, 102, 500, 64, 90, 42, 140, 500, 44, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38147170745612496, "mean_inference_ms": 1.2218053680826173, "mean_action_processing_ms": 0.14336480804569474, "mean_env_wait_ms": 0.08329196784790728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019016027450561523, "StateBufferConnector_ms": 0.007987260818481445, "ViewRequirementAgentConnector_ms": 0.127974271774292}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.836999999999858, "episode_len_mean": 227.32, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.10000000000001, 42.500000000000014, 44.5, 37.50000000000003, -50.00000000000044, -50.00000000000044, 34.50000000000004, 41.70000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.699999999999996, -50.00000000000044, 34.50000000000004, 37.90000000000003, 46.9, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, -50.00000000000044, 43.30000000000001, 22.699999999999882, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 16.8999999999998, -50.00000000000044, 15.699999999999783, 25.29999999999992, 11.899999999999729, 38.10000000000002, 39.50000000000002, 45.3, 47.1, 34.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5, 42.70000000000001, 44.7, 26.499999999999936, -50.00000000000044, 41.70000000000002, 43.30000000000001, 45.7, 43.10000000000001, 34.10000000000004, 42.900000000000006, 26.69999999999994, 21.499999999999865, 46.099999999999994, 45.5, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, 44.300000000000004, 38.10000000000002, -50.00000000000044, 46.9, 44.10000000000001, 46.099999999999994, 44.300000000000004, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 45.7, 39.90000000000002, -50.00000000000044, 43.7, 41.100000000000016, 45.9, 36.10000000000004, -50.00000000000044, 45.7, 36.30000000000003], "episode_lengths": [38, 500, 500, 40, 80, 76, 56, 126, 500, 500, 156, 84, 122, 500, 500, 376, 34, 500, 156, 122, 32, 500, 500, 32, 70, 500, 68, 274, 48, 62, 500, 500, 88, 332, 500, 344, 248, 382, 120, 106, 48, 30, 154, 500, 500, 58, 500, 500, 500, 48, 500, 500, 56, 74, 54, 236, 500, 84, 68, 44, 70, 160, 72, 234, 286, 40, 46, 58, 500, 112, 500, 60, 58, 120, 500, 32, 60, 40, 58, 80, 112, 500, 500, 42, 500, 76, 500, 62, 64, 500, 44, 102, 500, 64, 90, 42, 140, 500, 44, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38147170745612496, "mean_inference_ms": 1.2218053680826173, "mean_action_processing_ms": 0.14336480804569474, "mean_env_wait_ms": 0.08329196784790728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019016027450561523, "StateBufferConnector_ms": 0.007987260818481445, "ViewRequirementAgentConnector_ms": 0.127974271774292}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5358.737771288085, "num_env_steps_trained_throughput_per_sec": 5358.737771288085, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3360.101, "sample_time_ms": 2859.303, "load_time_ms": 17.206, "load_throughput": 1046150.964, "learn_time_ms": 473.296, "learn_throughput": 38031.13, "synch_weights_time_ms": 9.197}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5366, "training_iteration": 75, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-13", "timestamp": 1698245893, "time_this_iter_s": 3.363999605178833, "time_total_s": 249.2383451461792, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.2383451461792, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 66.15, "ram_util_percent": 27.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339375e-24, "cur_lr": 0.0003, "total_loss": 6.1998682551913795, "policy_loss": -0.0002109177824523714, "vf_loss": 6.200127273135715, "vf_explained_var": -0.005746046702067058, "kl": 0.0009212079278733478, "entropy": 0.4811466740237342, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3398.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.878999999999847, "episode_len_mean": 226.88, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, 44.300000000000004, 38.10000000000002, -50.00000000000044, 46.9, 44.10000000000001, 46.099999999999994, 44.300000000000004, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 45.7, 39.90000000000002, -50.00000000000044, 43.7, 41.100000000000016, 45.9, 36.10000000000004, -50.00000000000044, 45.7, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 42.70000000000001, -50.00000000000044, 18.29999999999982, 46.699999999999996, 45.3, -50.00000000000044, 41.500000000000014, 39.70000000000002, -50.00000000000044, 46.9, 0.6999999999995694, 45.7, 46.699999999999996, 46.699999999999996, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 41.30000000000001, 43.50000000000001, 44.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.7, 41.100000000000016, -50.00000000000044, 43.50000000000001, 38.700000000000024, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 44.300000000000004, 40.90000000000002, 15.299999999999777, 36.70000000000003, 35.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.3, 23.8999999999999, -50.00000000000044, 28.499999999999964, 31.70000000000001, 40.30000000000002], "episode_lengths": [46, 58, 500, 112, 500, 60, 58, 120, 500, 32, 60, 40, 58, 80, 112, 500, 500, 42, 500, 76, 500, 62, 64, 500, 44, 102, 500, 64, 90, 42, 140, 500, 44, 138, 500, 500, 500, 56, 82, 500, 500, 42, 42, 74, 500, 318, 34, 48, 500, 86, 104, 500, 32, 494, 44, 34, 34, 286, 500, 500, 46, 46, 500, 500, 500, 500, 500, 88, 58, 88, 66, 54, 500, 74, 500, 64, 90, 500, 66, 114, 500, 22, 34, 36, 58, 92, 348, 134, 150, 500, 50, 500, 48, 500, 48, 262, 500, 216, 184, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813080937033295, "mean_inference_ms": 1.2217610815889137, "mean_action_processing_ms": 0.143676264172792, "mean_env_wait_ms": 0.08352965299496563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028009414672851562, "StateBufferConnector_ms": 0.006987094879150391, "ViewRequirementAgentConnector_ms": 0.1249701976776123}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.878999999999847, "episode_len_mean": 226.88, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, 44.300000000000004, 38.10000000000002, -50.00000000000044, 46.9, 44.10000000000001, 46.099999999999994, 44.300000000000004, 42.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 45.7, 39.90000000000002, -50.00000000000044, 43.7, 41.100000000000016, 45.9, 36.10000000000004, -50.00000000000044, 45.7, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 42.70000000000001, -50.00000000000044, 18.29999999999982, 46.699999999999996, 45.3, -50.00000000000044, 41.500000000000014, 39.70000000000002, -50.00000000000044, 46.9, 0.6999999999995694, 45.7, 46.699999999999996, 46.699999999999996, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.300000000000004, 41.30000000000001, 43.50000000000001, 44.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.7, 41.100000000000016, -50.00000000000044, 43.50000000000001, 38.700000000000024, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 44.300000000000004, 40.90000000000002, 15.299999999999777, 36.70000000000003, 35.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.3, 23.8999999999999, -50.00000000000044, 28.499999999999964, 31.70000000000001, 40.30000000000002], "episode_lengths": [46, 58, 500, 112, 500, 60, 58, 120, 500, 32, 60, 40, 58, 80, 112, 500, 500, 42, 500, 76, 500, 62, 64, 500, 44, 102, 500, 64, 90, 42, 140, 500, 44, 138, 500, 500, 500, 56, 82, 500, 500, 42, 42, 74, 500, 318, 34, 48, 500, 86, 104, 500, 32, 494, 44, 34, 34, 286, 500, 500, 46, 46, 500, 500, 500, 500, 500, 88, 58, 88, 66, 54, 500, 74, 500, 64, 90, 500, 66, 114, 500, 22, 34, 36, 58, 92, 348, 134, 150, 500, 50, 500, 48, 500, 48, 262, 500, 216, 184, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813080937033295, "mean_inference_ms": 1.2217610815889137, "mean_action_processing_ms": 0.143676264172792, "mean_env_wait_ms": 0.08352965299496563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028009414672851562, "StateBufferConnector_ms": 0.006987094879150391, "ViewRequirementAgentConnector_ms": 0.1249701976776123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5284.786152192658, "num_env_steps_trained_throughput_per_sec": 5284.786152192658, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3362.401, "sample_time_ms": 2855.904, "load_time_ms": 17.009, "load_throughput": 1058284.289, "learn_time_ms": 479.196, "learn_throughput": 37562.909, "synch_weights_time_ms": 9.094}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5432, "training_iteration": 76, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-16", "timestamp": 1698245896, "time_this_iter_s": 3.4109997749328613, "time_total_s": 252.64934492111206, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.64934492111206, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 58.040000000000006, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696876e-24, "cur_lr": 0.0003, "total_loss": 6.748194652133518, "policy_loss": -0.0003444957650370068, "vf_loss": 6.748588583204481, "vf_explained_var": -0.011666373411814372, "kl": 0.0006801911671952136, "entropy": 0.4946587211555905, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3443.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.901999999999843, "episode_len_mean": 241.64, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 41.100000000000016, -50.00000000000044, 43.50000000000001, 38.700000000000024, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 44.300000000000004, 40.90000000000002, 15.299999999999777, 36.70000000000003, 35.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.3, 23.8999999999999, -50.00000000000044, 28.499999999999964, 31.70000000000001, 40.30000000000002, -50.00000000000044, 44.300000000000004, 38.300000000000026, 39.90000000000002, 44.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.10000000000001, 39.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 41.30000000000001, 8.49999999999968, 41.30000000000001, -50.00000000000044, 46.9, 40.30000000000002, 43.7, 43.50000000000001, 40.30000000000002, -50.00000000000044, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 23.8999999999999, 40.30000000000002, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 20.699999999999854, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 36.50000000000003, -50.00000000000044, 29.099999999999973, 34.30000000000004, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 41.90000000000001, 44.7, 31.900000000000013, 45.5, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967], "episode_lengths": [64, 90, 500, 66, 114, 500, 22, 34, 36, 58, 92, 348, 134, 150, 500, 50, 500, 48, 500, 48, 262, 500, 216, 184, 98, 500, 58, 118, 102, 54, 500, 60, 500, 104, 500, 70, 102, 34, 500, 500, 500, 500, 174, 30, 38, 500, 500, 56, 88, 416, 88, 500, 32, 98, 64, 66, 98, 500, 72, 46, 500, 500, 262, 98, 54, 46, 500, 500, 294, 174, 500, 500, 36, 40, 500, 38, 500, 84, 136, 500, 210, 158, 500, 86, 62, 500, 82, 54, 182, 46, 88, 80, 500, 500, 182, 276, 500, 500, 500, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3811725490113625, "mean_inference_ms": 1.2221960057029295, "mean_action_processing_ms": 0.1431402782238923, "mean_env_wait_ms": 0.08356211852091754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02201080322265625, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.13503742218017578}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.901999999999843, "episode_len_mean": 241.64, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 41.100000000000016, -50.00000000000044, 43.50000000000001, 38.700000000000024, -50.00000000000044, 47.9, 46.699999999999996, 46.5, 44.300000000000004, 40.90000000000002, 15.299999999999777, 36.70000000000003, 35.10000000000004, -50.00000000000044, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 45.3, 23.8999999999999, -50.00000000000044, 28.499999999999964, 31.70000000000001, 40.30000000000002, -50.00000000000044, 44.300000000000004, 38.300000000000026, 39.90000000000002, 44.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.10000000000001, 39.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 44.5, 41.30000000000001, 8.49999999999968, 41.30000000000001, -50.00000000000044, 46.9, 40.30000000000002, 43.7, 43.50000000000001, 40.30000000000002, -50.00000000000044, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 23.8999999999999, 40.30000000000002, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 20.699999999999854, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 36.50000000000003, -50.00000000000044, 29.099999999999973, 34.30000000000004, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 41.90000000000001, 44.7, 31.900000000000013, 45.5, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967], "episode_lengths": [64, 90, 500, 66, 114, 500, 22, 34, 36, 58, 92, 348, 134, 150, 500, 50, 500, 48, 500, 48, 262, 500, 216, 184, 98, 500, 58, 118, 102, 54, 500, 60, 500, 104, 500, 70, 102, 34, 500, 500, 500, 500, 174, 30, 38, 500, 500, 56, 88, 416, 88, 500, 32, 98, 64, 66, 98, 500, 72, 46, 500, 500, 262, 98, 54, 46, 500, 500, 294, 174, 500, 500, 36, 40, 500, 38, 500, 84, 136, 500, 210, 158, 500, 86, 62, 500, 82, 54, 182, 46, 88, 80, 500, 500, 182, 276, 500, 500, 500, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3811725490113625, "mean_inference_ms": 1.2221960057029295, "mean_action_processing_ms": 0.1431402782238923, "mean_env_wait_ms": 0.08356211852091754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02201080322265625, "StateBufferConnector_ms": 0.0029976367950439453, "ViewRequirementAgentConnector_ms": 0.13503742218017578}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5320.71804049505, "num_env_steps_trained_throughput_per_sec": 5320.71804049505, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3367.702, "sample_time_ms": 2860.504, "load_time_ms": 16.206, "load_throughput": 1110715.928, "learn_time_ms": 480.499, "learn_throughput": 37461.054, "synch_weights_time_ms": 9.194}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5507, "training_iteration": 77, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-20", "timestamp": 1698245900, "time_this_iter_s": 3.38800048828125, "time_total_s": 256.0373454093933, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.0373454093933, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.06, "ram_util_percent": 27.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848438e-24, "cur_lr": 0.0003, "total_loss": 6.866439353095161, "policy_loss": -0.0007377136912610796, "vf_loss": 6.8672271622551815, "vf_explained_var": 0.0006647825241088868, "kl": 0.0014172857700032182, "entropy": 0.5002704699834187, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3488.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.098999999999822, "episode_len_mean": 264.64, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.699999999999854, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 36.50000000000003, -50.00000000000044, 29.099999999999973, 34.30000000000004, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 41.90000000000001, 44.7, 31.900000000000013, 45.5, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 22.699999999999882, 34.70000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 16.29999999999979, 45.3, 44.10000000000001, 45.7, -50.00000000000044, 34.900000000000034, -50.00000000000044, 23.699999999999896, 43.30000000000001, 5.299999999999635, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.499999999999893, 43.900000000000006, 45.1, -50.00000000000044, 44.7, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, 43.900000000000006, 46.699999999999996, 17.499999999999808, 45.1, -50.00000000000044, 13.899999999999757, 31.900000000000013, 42.70000000000001, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.3], "episode_lengths": [294, 174, 500, 500, 36, 40, 500, 38, 500, 84, 136, 500, 210, 158, 500, 86, 62, 500, 82, 54, 182, 46, 88, 80, 500, 500, 182, 276, 500, 500, 500, 214, 274, 154, 500, 52, 500, 338, 48, 60, 44, 500, 152, 500, 264, 68, 448, 58, 500, 62, 500, 46, 500, 500, 60, 266, 62, 50, 500, 54, 46, 98, 500, 500, 256, 44, 500, 40, 500, 100, 44, 500, 500, 58, 500, 500, 500, 74, 46, 62, 34, 326, 50, 500, 362, 182, 74, 50, 500, 120, 500, 290, 500, 184, 500, 118, 500, 500, 176, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814289971396744, "mean_inference_ms": 1.222897236963368, "mean_action_processing_ms": 0.14317620361836048, "mean_env_wait_ms": 0.08372834362709802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994373321533203, "StateBufferConnector_ms": 0.003996133804321289, "ViewRequirementAgentConnector_ms": 0.12274718284606934}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.098999999999822, "episode_len_mean": 264.64, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.699999999999854, 32.700000000000024, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 36.50000000000003, -50.00000000000044, 29.099999999999973, 34.30000000000004, -50.00000000000044, 41.500000000000014, 43.900000000000006, -50.00000000000044, 41.90000000000001, 44.7, 31.900000000000013, 45.5, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, 22.699999999999882, 34.70000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 16.29999999999979, 45.3, 44.10000000000001, 45.7, -50.00000000000044, 34.900000000000034, -50.00000000000044, 23.699999999999896, 43.30000000000001, 5.299999999999635, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.499999999999893, 43.900000000000006, 45.1, -50.00000000000044, 44.7, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, 43.900000000000006, 46.699999999999996, 17.499999999999808, 45.1, -50.00000000000044, 13.899999999999757, 31.900000000000013, 42.70000000000001, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.3], "episode_lengths": [294, 174, 500, 500, 36, 40, 500, 38, 500, 84, 136, 500, 210, 158, 500, 86, 62, 500, 82, 54, 182, 46, 88, 80, 500, 500, 182, 276, 500, 500, 500, 214, 274, 154, 500, 52, 500, 338, 48, 60, 44, 500, 152, 500, 264, 68, 448, 58, 500, 62, 500, 46, 500, 500, 60, 266, 62, 50, 500, 54, 46, 98, 500, 500, 256, 44, 500, 40, 500, 100, 44, 500, 500, 58, 500, 500, 500, 74, 46, 62, 34, 326, 50, 500, 362, 182, 74, 50, 500, 120, 500, 290, 500, 184, 500, 118, 500, 500, 176, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814289971396744, "mean_inference_ms": 1.222897236963368, "mean_action_processing_ms": 0.14317620361836048, "mean_env_wait_ms": 0.08372834362709802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994373321533203, "StateBufferConnector_ms": 0.003996133804321289, "ViewRequirementAgentConnector_ms": 0.12274718284606934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5267.7775653540275, "num_env_steps_trained_throughput_per_sec": 5267.7775653540275, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3376.702, "sample_time_ms": 2867.104, "load_time_ms": 16.305, "load_throughput": 1103922.375, "learn_time_ms": 482.699, "learn_throughput": 37290.304, "synch_weights_time_ms": 9.294}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5575, "training_iteration": 78, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-23", "timestamp": 1698245903, "time_this_iter_s": 3.421999931335449, "time_total_s": 259.45934534072876, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.45934534072876, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 60.080000000000005, "ram_util_percent": 27.340000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424219e-25, "cur_lr": 0.0003, "total_loss": 6.647781531016032, "policy_loss": -0.00017794544498125713, "vf_loss": 6.648013125525581, "vf_explained_var": -0.00601763990190294, "kl": 0.000691193205784657, "entropy": 0.5369514067967732, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.616999999999853, "episode_len_mean": 229.52, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 13.899999999999757, 31.900000000000013, 42.70000000000001, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.3, -50.00000000000044, 46.3, 39.90000000000002, 46.099999999999994, 35.500000000000036, -50.00000000000044, 46.099999999999994, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 43.7, 45.9, 44.5, 42.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 17.499999999999808, 34.70000000000004, 43.10000000000001, 42.30000000000001, 46.699999999999996, 47.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.699999999999825, 45.3, 40.10000000000002, 44.5, -50.00000000000044, 10.899999999999714, 46.099999999999994, 42.900000000000006, 46.9, 44.7, 47.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, 39.70000000000002, 28.89999999999997, -50.00000000000044, 1.299999999999578, 41.30000000000001, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, 46.5, 36.900000000000034, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 37.50000000000003, 20.099999999999845, 42.30000000000001, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 31.70000000000001, 42.30000000000001, 42.500000000000014, -50.00000000000044, 44.900000000000006, 44.300000000000004, 43.50000000000001], "episode_lengths": [500, 362, 182, 74, 50, 500, 120, 500, 290, 500, 184, 500, 118, 500, 500, 176, 48, 500, 38, 102, 40, 146, 500, 40, 140, 500, 500, 50, 64, 42, 56, 78, 88, 500, 500, 46, 500, 94, 326, 154, 70, 78, 34, 24, 64, 500, 500, 500, 62, 314, 48, 100, 56, 500, 392, 40, 72, 32, 54, 26, 500, 500, 150, 104, 212, 500, 488, 88, 500, 46, 60, 500, 64, 36, 132, 500, 56, 78, 500, 48, 500, 126, 126, 300, 78, 500, 40, 42, 500, 500, 38, 500, 52, 184, 78, 76, 500, 52, 58, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817580968349905, "mean_inference_ms": 1.222326094643774, "mean_action_processing_ms": 0.14283195293767914, "mean_env_wait_ms": 0.08333908921116899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029934406280517578, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.12572479248046875}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.616999999999853, "episode_len_mean": 229.52, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 13.899999999999757, 31.900000000000013, 42.70000000000001, 45.1, -50.00000000000044, 38.10000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.3, -50.00000000000044, 46.3, 39.90000000000002, 46.099999999999994, 35.500000000000036, -50.00000000000044, 46.099999999999994, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 43.7, 45.9, 44.5, 42.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 17.499999999999808, 34.70000000000004, 43.10000000000001, 42.30000000000001, 46.699999999999996, 47.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.699999999999825, 45.3, 40.10000000000002, 44.5, -50.00000000000044, 10.899999999999714, 46.099999999999994, 42.900000000000006, 46.9, 44.7, 47.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, 39.70000000000002, 28.89999999999997, -50.00000000000044, 1.299999999999578, 41.30000000000001, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, 46.5, 36.900000000000034, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 37.50000000000003, 20.099999999999845, 42.30000000000001, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 31.70000000000001, 42.30000000000001, 42.500000000000014, -50.00000000000044, 44.900000000000006, 44.300000000000004, 43.50000000000001], "episode_lengths": [500, 362, 182, 74, 50, 500, 120, 500, 290, 500, 184, 500, 118, 500, 500, 176, 48, 500, 38, 102, 40, 146, 500, 40, 140, 500, 500, 50, 64, 42, 56, 78, 88, 500, 500, 46, 500, 94, 326, 154, 70, 78, 34, 24, 64, 500, 500, 500, 62, 314, 48, 100, 56, 500, 392, 40, 72, 32, 54, 26, 500, 500, 150, 104, 212, 500, 488, 88, 500, 46, 60, 500, 64, 36, 132, 500, 56, 78, 500, 48, 500, 126, 126, 300, 78, 500, 40, 42, 500, 500, 38, 500, 52, 184, 78, 76, 500, 52, 58, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817580968349905, "mean_inference_ms": 1.222326094643774, "mean_action_processing_ms": 0.14283195293767914, "mean_env_wait_ms": 0.08333908921116899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029934406280517578, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.12572479248046875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5327.018030196102, "num_env_steps_trained_throughput_per_sec": 5327.018030196102, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3378.402, "sample_time_ms": 2867.504, "load_time_ms": 17.303, "load_throughput": 1040304.137, "learn_time_ms": 482.999, "learn_throughput": 37267.146, "synch_weights_time_ms": 9.196}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5658, "training_iteration": 79, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-26", "timestamp": 1698245906, "time_this_iter_s": 3.383999824523926, "time_total_s": 262.8433451652527, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.8433451652527, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 65.825, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121095e-25, "cur_lr": 0.0003, "total_loss": 6.3830114470587835, "policy_loss": -0.000537594821718004, "vf_loss": 6.383600150214301, "vf_explained_var": -0.0033471438619825577, "kl": 0.001081057035872214, "entropy": 0.5113046904404958, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3578.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.240999999999824, "episode_len_mean": 253.22, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.299999999999578, 41.30000000000001, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, 46.5, 36.900000000000034, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 37.50000000000003, 20.099999999999845, 42.30000000000001, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 31.70000000000001, 42.30000000000001, 42.500000000000014, -50.00000000000044, 44.900000000000006, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.70000000000002, 45.3, 46.699999999999996, -50.00000000000044, 12.69999999999974, -50.00000000000044, 36.900000000000034, 44.900000000000006, 44.900000000000006, -50.00000000000044, 44.10000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 27.899999999999956, 12.099999999999731, -50.00000000000044, 45.3, 41.30000000000001, 44.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.50000000000001, 42.70000000000001, 42.900000000000006, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 41.100000000000016, 20.299999999999848, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 44.300000000000004, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, 11.699999999999726, 40.10000000000002, 43.900000000000006, 43.30000000000001], "episode_lengths": [488, 88, 500, 46, 60, 500, 64, 36, 132, 500, 56, 78, 500, 48, 500, 126, 126, 300, 78, 500, 40, 42, 500, 500, 38, 500, 52, 184, 78, 76, 500, 52, 58, 66, 500, 500, 500, 500, 128, 84, 48, 34, 500, 374, 500, 132, 52, 52, 500, 60, 148, 500, 500, 36, 500, 500, 48, 222, 380, 500, 48, 88, 54, 500, 204, 500, 66, 74, 72, 500, 134, 500, 500, 58, 500, 32, 58, 500, 500, 138, 500, 500, 500, 58, 52, 90, 298, 500, 78, 60, 500, 58, 208, 500, 500, 70, 384, 100, 62, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38186139840719796, "mean_inference_ms": 1.2225951249934064, "mean_action_processing_ms": 0.1433134706197775, "mean_env_wait_ms": 0.08336192638989096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03992438316345215, "StateBufferConnector_ms": 0.009011030197143555, "ViewRequirementAgentConnector_ms": 0.13798880577087402}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.240999999999824, "episode_len_mean": 253.22, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.299999999999578, 41.30000000000001, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 43.7, 46.5, 36.900000000000034, -50.00000000000044, 44.5, 42.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 37.50000000000003, 37.50000000000003, 20.099999999999845, 42.30000000000001, -50.00000000000044, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.900000000000006, 31.70000000000001, 42.30000000000001, 42.500000000000014, -50.00000000000044, 44.900000000000006, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.70000000000002, 45.3, 46.699999999999996, -50.00000000000044, 12.69999999999974, -50.00000000000044, 36.900000000000034, 44.900000000000006, 44.900000000000006, -50.00000000000044, 44.10000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 27.899999999999956, 12.099999999999731, -50.00000000000044, 45.3, 41.30000000000001, 44.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.50000000000001, 42.70000000000001, 42.900000000000006, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 41.100000000000016, 20.299999999999848, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 44.300000000000004, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, 11.699999999999726, 40.10000000000002, 43.900000000000006, 43.30000000000001], "episode_lengths": [488, 88, 500, 46, 60, 500, 64, 36, 132, 500, 56, 78, 500, 48, 500, 126, 126, 300, 78, 500, 40, 42, 500, 500, 38, 500, 52, 184, 78, 76, 500, 52, 58, 66, 500, 500, 500, 500, 128, 84, 48, 34, 500, 374, 500, 132, 52, 52, 500, 60, 148, 500, 500, 36, 500, 500, 48, 222, 380, 500, 48, 88, 54, 500, 204, 500, 66, 74, 72, 500, 134, 500, 500, 58, 500, 32, 58, 500, 500, 138, 500, 500, 500, 58, 52, 90, 298, 500, 78, 60, 500, 58, 208, 500, 500, 70, 384, 100, 62, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38186139840719796, "mean_inference_ms": 1.2225951249934064, "mean_action_processing_ms": 0.1433134706197775, "mean_env_wait_ms": 0.08336192638989096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03992438316345215, "StateBufferConnector_ms": 0.009011030197143555, "ViewRequirementAgentConnector_ms": 0.13798880577087402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5466.139138823297, "num_env_steps_trained_throughput_per_sec": 5466.139138823297, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3367.802, "sample_time_ms": 2867.904, "load_time_ms": 16.803, "load_throughput": 1071249.289, "learn_time_ms": 472.599, "learn_throughput": 38087.236, "synch_weights_time_ms": 9.096}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5724, "training_iteration": 80, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-30", "timestamp": 1698245910, "time_this_iter_s": 3.297001600265503, "time_total_s": 266.1403467655182, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.1403467655182, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.3, "ram_util_percent": 27.359999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060548e-25, "cur_lr": 0.0003, "total_loss": 6.526306184132894, "policy_loss": -0.0003784477710723877, "vf_loss": 6.526739639706082, "vf_explained_var": -0.009690385394626194, "kl": 0.0014736918573918147, "entropy": 0.5497513552506764, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3623.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.268999999999827, "episode_len_mean": 262.94, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 42.70000000000001, 42.900000000000006, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 41.100000000000016, 20.299999999999848, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 44.300000000000004, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, 11.699999999999726, 40.10000000000002, 43.900000000000006, 43.30000000000001, -50.00000000000044, 42.900000000000006, 42.70000000000001, 37.10000000000003, 38.90000000000002, 45.7, 13.899999999999757, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.30000000000001, 31.900000000000013, -50.00000000000044, 37.70000000000003, 45.9, 29.899999999999984, 37.300000000000026, -50.00000000000044, 43.7, 32.100000000000016, -50.00000000000044, 39.10000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.70000000000002, 25.499999999999922, -50.00000000000044, 3.499999999999609, -50.00000000000044, 45.3, 38.700000000000024, 39.50000000000002, 40.90000000000002, 38.10000000000002, -50.00000000000044, 40.90000000000002, 43.10000000000001, 37.300000000000026, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 7.499999999999666, 28.89999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, 45.7, 43.50000000000001, 32.90000000000003], "episode_lengths": [500, 66, 74, 72, 500, 134, 500, 500, 58, 500, 32, 58, 500, 500, 138, 500, 500, 500, 58, 52, 90, 298, 500, 78, 60, 500, 58, 208, 500, 500, 70, 384, 100, 62, 68, 500, 72, 74, 130, 112, 44, 362, 500, 280, 500, 500, 88, 182, 500, 124, 42, 202, 128, 500, 64, 180, 500, 110, 132, 500, 500, 500, 88, 52, 500, 500, 52, 500, 500, 178, 500, 104, 246, 500, 466, 500, 48, 114, 106, 92, 120, 500, 92, 70, 128, 56, 62, 500, 500, 500, 500, 40, 426, 212, 500, 82, 134, 44, 66, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38172861277771164, "mean_inference_ms": 1.2223142654889734, "mean_action_processing_ms": 0.1432931812942827, "mean_env_wait_ms": 0.08345389293210395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700661659240723, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.125993013381958}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.268999999999827, "episode_len_mean": 262.94, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 42.70000000000001, 42.900000000000006, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 41.100000000000016, 20.299999999999848, -50.00000000000044, 42.30000000000001, 44.10000000000001, -50.00000000000044, 44.300000000000004, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, 11.699999999999726, 40.10000000000002, 43.900000000000006, 43.30000000000001, -50.00000000000044, 42.900000000000006, 42.70000000000001, 37.10000000000003, 38.90000000000002, 45.7, 13.899999999999757, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.30000000000001, 31.900000000000013, -50.00000000000044, 37.70000000000003, 45.9, 29.899999999999984, 37.300000000000026, -50.00000000000044, 43.7, 32.100000000000016, -50.00000000000044, 39.10000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 39.70000000000002, 25.499999999999922, -50.00000000000044, 3.499999999999609, -50.00000000000044, 45.3, 38.700000000000024, 39.50000000000002, 40.90000000000002, 38.10000000000002, -50.00000000000044, 40.90000000000002, 43.10000000000001, 37.300000000000026, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 7.499999999999666, 28.89999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, 45.7, 43.50000000000001, 32.90000000000003], "episode_lengths": [500, 66, 74, 72, 500, 134, 500, 500, 58, 500, 32, 58, 500, 500, 138, 500, 500, 500, 58, 52, 90, 298, 500, 78, 60, 500, 58, 208, 500, 500, 70, 384, 100, 62, 68, 500, 72, 74, 130, 112, 44, 362, 500, 280, 500, 500, 88, 182, 500, 124, 42, 202, 128, 500, 64, 180, 500, 110, 132, 500, 500, 500, 88, 52, 500, 500, 52, 500, 500, 178, 500, 104, 246, 500, 466, 500, 48, 114, 106, 92, 120, 500, 92, 70, 128, 56, 62, 500, 500, 500, 500, 40, 426, 212, 500, 82, 134, 44, 66, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38172861277771164, "mean_inference_ms": 1.2223142654889734, "mean_action_processing_ms": 0.1432931812942827, "mean_env_wait_ms": 0.08345389293210395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700661659240723, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.125993013381958}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5047.672146259827, "num_env_steps_trained_throughput_per_sec": 5047.672146259827, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3387.301, "sample_time_ms": 2890.104, "load_time_ms": 16.603, "load_throughput": 1084157.445, "learn_time_ms": 470.299, "learn_throughput": 38273.508, "synch_weights_time_ms": 8.796}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5789, "training_iteration": 81, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-33", "timestamp": 1698245913, "time_this_iter_s": 3.5710017681121826, "time_total_s": 269.71134853363037, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.71134853363037, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 55.9, "ram_util_percent": 27.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530274e-26, "cur_lr": 0.0003, "total_loss": 6.684109984503852, "policy_loss": -0.00015750019293692377, "vf_loss": 6.684323098924425, "vf_explained_var": 0.0004229015774197049, "kl": 0.0005805042699749821, "entropy": 0.5558310959074232, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3668.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.672999999999829, "episode_len_mean": 258.92, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.499999999999922, -50.00000000000044, 3.499999999999609, -50.00000000000044, 45.3, 38.700000000000024, 39.50000000000002, 40.90000000000002, 38.10000000000002, -50.00000000000044, 40.90000000000002, 43.10000000000001, 37.300000000000026, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 7.499999999999666, 28.89999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, 45.7, 43.50000000000001, 32.90000000000003, -50.00000000000044, -50.00000000000044, 19.899999999999842, 19.69999999999984, 31.70000000000001, 44.5, 40.500000000000014, -50.00000000000044, 1.4999999999995808, 43.900000000000006, 38.700000000000024, 31.500000000000007, -50.00000000000044, 31.500000000000007, 43.30000000000001, 44.10000000000001, 44.5, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.300000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 27.299999999999947, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, 39.50000000000002, 42.70000000000001, 43.7, -50.00000000000044, 22.49999999999988, 44.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 7.499999999999666, -50.00000000000044, 43.30000000000001, 45.5, 42.70000000000001, 45.9, 40.70000000000002, 38.90000000000002, 42.10000000000001, 38.700000000000024, -50.00000000000044, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [246, 500, 466, 500, 48, 114, 106, 92, 120, 500, 92, 70, 128, 56, 62, 500, 500, 500, 500, 40, 426, 212, 500, 82, 134, 44, 66, 172, 500, 500, 302, 304, 184, 56, 96, 500, 486, 62, 114, 186, 500, 186, 68, 60, 56, 52, 500, 82, 500, 500, 88, 60, 500, 42, 500, 100, 500, 500, 142, 58, 500, 98, 500, 228, 500, 54, 500, 500, 116, 66, 106, 74, 64, 500, 276, 52, 228, 500, 500, 500, 500, 92, 500, 72, 426, 500, 68, 46, 74, 42, 94, 112, 80, 114, 500, 52, 198, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815515390123004, "mean_inference_ms": 1.2220067843817737, "mean_action_processing_ms": 0.14330372345660466, "mean_env_wait_ms": 0.08345140222420784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200578689575195, "StateBufferConnector_ms": 0.0069963932037353516, "ViewRequirementAgentConnector_ms": 0.1269969940185547}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.672999999999829, "episode_len_mean": 258.92, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.499999999999922, -50.00000000000044, 3.499999999999609, -50.00000000000044, 45.3, 38.700000000000024, 39.50000000000002, 40.90000000000002, 38.10000000000002, -50.00000000000044, 40.90000000000002, 43.10000000000001, 37.300000000000026, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 7.499999999999666, 28.89999999999997, -50.00000000000044, 41.90000000000001, 36.70000000000003, 45.7, 43.50000000000001, 32.90000000000003, -50.00000000000044, -50.00000000000044, 19.899999999999842, 19.69999999999984, 31.70000000000001, 44.5, 40.500000000000014, -50.00000000000044, 1.4999999999995808, 43.900000000000006, 38.700000000000024, 31.500000000000007, -50.00000000000044, 31.500000000000007, 43.30000000000001, 44.10000000000001, 44.5, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 44.300000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 27.299999999999947, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.50000000000001, 39.50000000000002, 42.70000000000001, 43.7, -50.00000000000044, 22.49999999999988, 44.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 7.499999999999666, -50.00000000000044, 43.30000000000001, 45.5, 42.70000000000001, 45.9, 40.70000000000002, 38.90000000000002, 42.10000000000001, 38.700000000000024, -50.00000000000044, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [246, 500, 466, 500, 48, 114, 106, 92, 120, 500, 92, 70, 128, 56, 62, 500, 500, 500, 500, 40, 426, 212, 500, 82, 134, 44, 66, 172, 500, 500, 302, 304, 184, 56, 96, 500, 486, 62, 114, 186, 500, 186, 68, 60, 56, 52, 500, 82, 500, 500, 88, 60, 500, 42, 500, 100, 500, 500, 142, 58, 500, 98, 500, 228, 500, 54, 500, 500, 116, 66, 106, 74, 64, 500, 276, 52, 228, 500, 500, 500, 500, 92, 500, 72, 426, 500, 68, 46, 74, 42, 94, 112, 80, 114, 500, 52, 198, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815515390123004, "mean_inference_ms": 1.2220067843817737, "mean_action_processing_ms": 0.14330372345660466, "mean_env_wait_ms": 0.08345140222420784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200578689575195, "StateBufferConnector_ms": 0.0069963932037353516, "ViewRequirementAgentConnector_ms": 0.1269969940185547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5312.870052910217, "num_env_steps_trained_throughput_per_sec": 5312.870052910217, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3389.601, "sample_time_ms": 2894.104, "load_time_ms": 15.7, "load_throughput": 1146527.682, "learn_time_ms": 469.502, "learn_throughput": 38338.47, "synch_weights_time_ms": 8.796}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5861, "training_iteration": 82, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-37", "timestamp": 1698245917, "time_this_iter_s": 3.392997980117798, "time_total_s": 273.10434651374817, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.10434651374817, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 56.25999999999999, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765137e-26, "cur_lr": 0.0003, "total_loss": 6.73002380794949, "policy_loss": -0.0001227509333855576, "vf_loss": 6.730202356974284, "vf_explained_var": -0.0009556677606370714, "kl": 0.0005739878939915381, "entropy": 0.5575038141674465, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3713.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.449999999999829, "episode_len_mean": 256.14, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 22.49999999999988, 44.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 7.499999999999666, -50.00000000000044, 43.30000000000001, 45.5, 42.70000000000001, 45.9, 40.70000000000002, 38.90000000000002, 42.10000000000001, 38.700000000000024, -50.00000000000044, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.699999999999996, 36.70000000000003, -50.00000000000044, 18.29999999999982, 15.099999999999774, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, 37.50000000000003, 21.299999999999862, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.3, 33.500000000000036, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.100000000000016, 15.099999999999774, 40.500000000000014, -50.00000000000044, 45.5, 43.50000000000001, 44.5, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, 42.10000000000001, -50.00000000000044, 41.90000000000001, 44.10000000000001, 40.90000000000002, 44.10000000000001, 46.9, 46.699999999999996, 44.900000000000006, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.1, 43.7, 47.1, 38.10000000000002, 36.900000000000034, 43.10000000000001, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.899999999999757], "episode_lengths": [64, 500, 276, 52, 228, 500, 500, 500, 500, 92, 500, 72, 426, 500, 68, 46, 74, 42, 94, 112, 80, 114, 500, 52, 198, 500, 500, 500, 114, 500, 34, 134, 500, 318, 350, 134, 500, 38, 500, 126, 288, 500, 76, 500, 48, 166, 500, 500, 64, 40, 82, 500, 500, 500, 134, 500, 136, 500, 90, 350, 96, 500, 46, 66, 56, 62, 500, 72, 500, 292, 80, 500, 82, 60, 92, 60, 32, 34, 52, 68, 64, 500, 500, 54, 500, 190, 64, 30, 120, 132, 70, 500, 326, 500, 500, 88, 500, 52, 500, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814618937140385, "mean_inference_ms": 1.2224241944703917, "mean_action_processing_ms": 0.14337185199915373, "mean_env_wait_ms": 0.08366936087378964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299593925476074, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.11400127410888672}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.449999999999829, "episode_len_mean": 256.14, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 22.49999999999988, 44.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 7.499999999999666, -50.00000000000044, 43.30000000000001, 45.5, 42.70000000000001, 45.9, 40.70000000000002, 38.90000000000002, 42.10000000000001, 38.700000000000024, -50.00000000000044, 44.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.699999999999996, 36.70000000000003, -50.00000000000044, 18.29999999999982, 15.099999999999774, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, 37.50000000000003, 21.299999999999862, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.3, 33.500000000000036, -50.00000000000044, -50.00000000000044, 43.7, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 36.50000000000003, -50.00000000000044, 41.100000000000016, 15.099999999999774, 40.500000000000014, -50.00000000000044, 45.5, 43.50000000000001, 44.5, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.899999999999856, 42.10000000000001, -50.00000000000044, 41.90000000000001, 44.10000000000001, 40.90000000000002, 44.10000000000001, 46.9, 46.699999999999996, 44.900000000000006, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.1, 43.7, 47.1, 38.10000000000002, 36.900000000000034, 43.10000000000001, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.899999999999757], "episode_lengths": [64, 500, 276, 52, 228, 500, 500, 500, 500, 92, 500, 72, 426, 500, 68, 46, 74, 42, 94, 112, 80, 114, 500, 52, 198, 500, 500, 500, 114, 500, 34, 134, 500, 318, 350, 134, 500, 38, 500, 126, 288, 500, 76, 500, 48, 166, 500, 500, 64, 40, 82, 500, 500, 500, 134, 500, 136, 500, 90, 350, 96, 500, 46, 66, 56, 62, 500, 72, 500, 292, 80, 500, 82, 60, 92, 60, 32, 34, 52, 68, 64, 500, 500, 54, 500, 190, 64, 30, 120, 132, 70, 500, 326, 500, 500, 88, 500, 52, 500, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814618937140385, "mean_inference_ms": 1.2224241944703917, "mean_action_processing_ms": 0.14337185199915373, "mean_env_wait_ms": 0.08366936087378964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299593925476074, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.11400127410888672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5334.9116721035125, "num_env_steps_trained_throughput_per_sec": 5334.9116721035125, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3387.701, "sample_time_ms": 2883.0, "load_time_ms": 15.903, "load_throughput": 1131875.768, "learn_time_ms": 478.402, "learn_throughput": 37625.242, "synch_weights_time_ms": 8.696}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5933, "training_iteration": 83, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-40", "timestamp": 1698245920, "time_this_iter_s": 3.378000497817993, "time_total_s": 276.48234701156616, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.48234701156616, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 55.06, "ram_util_percent": 27.359999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825684e-26, "cur_lr": 0.0003, "total_loss": 6.81110684076945, "policy_loss": -0.0003168535211847888, "vf_loss": 6.811479091644287, "vf_explained_var": -0.0067427025900946725, "kl": 0.0012595841695706945, "entropy": 0.5537880102793376, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3758.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.330999999999854, "episode_len_mean": 232.38, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.10000000000001, 46.9, 46.699999999999996, 44.900000000000006, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.1, 43.7, 47.1, 38.10000000000002, 36.900000000000034, 43.10000000000001, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 33.70000000000004, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, 47.1, 41.90000000000001, 38.90000000000002, 44.5, 20.099999999999845, 45.5, 42.10000000000001, -50.00000000000044, 46.3, 33.30000000000003, 46.099999999999994, 19.09999999999983, 44.900000000000006, 41.90000000000001, 42.30000000000001, -50.00000000000044, 42.70000000000001, 42.10000000000001, 32.100000000000016, 31.300000000000004, 44.5, 34.10000000000004, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, 19.69999999999984, 44.10000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 45.3, 44.10000000000001, 40.90000000000002, 38.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, 43.900000000000006, 45.9, 45.3, 43.50000000000001, 42.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 4.299999999999621, 42.900000000000006, 20.899999999999856], "episode_lengths": [92, 60, 32, 34, 52, 68, 64, 500, 500, 54, 500, 190, 64, 30, 120, 132, 70, 500, 326, 500, 500, 88, 500, 52, 500, 362, 500, 500, 500, 500, 142, 164, 40, 380, 500, 500, 30, 82, 112, 56, 300, 46, 80, 500, 38, 168, 40, 310, 52, 82, 78, 500, 74, 80, 180, 188, 56, 160, 500, 100, 48, 500, 500, 304, 60, 500, 202, 500, 42, 36, 500, 48, 60, 92, 118, 500, 88, 500, 60, 98, 500, 62, 42, 48, 66, 72, 500, 122, 500, 500, 192, 500, 40, 52, 500, 500, 36, 458, 72, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814613508390064, "mean_inference_ms": 1.2203164902424772, "mean_action_processing_ms": 0.14370340965236728, "mean_env_wait_ms": 0.08341755488221338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499460220336914, "StateBufferConnector_ms": 0.008006572723388672, "ViewRequirementAgentConnector_ms": 0.11898040771484375}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.330999999999854, "episode_len_mean": 232.38, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.10000000000001, 46.9, 46.699999999999996, 44.900000000000006, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 31.1, 43.7, 47.1, 38.10000000000002, 36.900000000000034, 43.10000000000001, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 33.70000000000004, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, 47.1, 41.90000000000001, 38.90000000000002, 44.5, 20.099999999999845, 45.5, 42.10000000000001, -50.00000000000044, 46.3, 33.30000000000003, 46.099999999999994, 19.09999999999983, 44.900000000000006, 41.90000000000001, 42.30000000000001, -50.00000000000044, 42.70000000000001, 42.10000000000001, 32.100000000000016, 31.300000000000004, 44.5, 34.10000000000004, -50.00000000000044, 40.10000000000002, 45.3, -50.00000000000044, -50.00000000000044, 19.69999999999984, 44.10000000000001, -50.00000000000044, 29.899999999999984, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 45.3, 44.10000000000001, 40.90000000000002, 38.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, 43.900000000000006, 45.9, 45.3, 43.50000000000001, 42.900000000000006, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 4.299999999999621, 42.900000000000006, 20.899999999999856], "episode_lengths": [92, 60, 32, 34, 52, 68, 64, 500, 500, 54, 500, 190, 64, 30, 120, 132, 70, 500, 326, 500, 500, 88, 500, 52, 500, 362, 500, 500, 500, 500, 142, 164, 40, 380, 500, 500, 30, 82, 112, 56, 300, 46, 80, 500, 38, 168, 40, 310, 52, 82, 78, 500, 74, 80, 180, 188, 56, 160, 500, 100, 48, 500, 500, 304, 60, 500, 202, 500, 42, 36, 500, 48, 60, 92, 118, 500, 88, 500, 60, 98, 500, 62, 42, 48, 66, 72, 500, 122, 500, 500, 192, 500, 40, 52, 500, 500, 36, 458, 72, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814613508390064, "mean_inference_ms": 1.2203164902424772, "mean_action_processing_ms": 0.14370340965236728, "mean_env_wait_ms": 0.08341755488221338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499460220336914, "StateBufferConnector_ms": 0.008006572723388672, "ViewRequirementAgentConnector_ms": 0.11898040771484375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5402.155424857974, "num_env_steps_trained_throughput_per_sec": 5402.155424857974, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3389.601, "sample_time_ms": 2883.501, "load_time_ms": 15.703, "load_throughput": 1146292.674, "learn_time_ms": 479.905, "learn_throughput": 37507.402, "synch_weights_time_ms": 8.893}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 6007, "training_iteration": 84, "trial_id": "9f288_00005", "date": "2023-10-25_15-58-44", "timestamp": 1698245924, "time_this_iter_s": 3.3380014896392822, "time_total_s": 279.82034850120544, "pid": 20272, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.82034850120544, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 66.175, "ram_util_percent": 27.3}}
