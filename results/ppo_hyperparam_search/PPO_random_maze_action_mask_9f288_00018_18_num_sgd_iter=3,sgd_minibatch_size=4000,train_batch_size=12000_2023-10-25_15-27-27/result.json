{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 9.391700744628906, "policy_loss": -0.0009629312488767835, "vf_loss": 9.392545806037056, "vf_explained_var": -5.666414896647135e-05, "kl": 0.0009436139370204834, "entropy": 0.7044431699646844, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 37.300000000000026, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -35.97083333333372, "episode_len_mean": 464.0833333333333, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 13.299999999999748, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 128, 500, 500, 500, 392, 500, 500, 500, 500, 500, 374, 500, 368, 376, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771633257121196, "mean_inference_ms": 1.1830572640542543, "mean_action_processing_ms": 0.14055086857392077, "mean_env_wait_ms": 0.08571233266677374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045427680015563965, "StateBufferConnector_ms": 0.008322795232137045, "ViewRequirementAgentConnector_ms": 0.10422269503275554}}, "episode_reward_max": 37.300000000000026, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -35.97083333333372, "episode_len_mean": 464.0833333333333, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 13.299999999999748, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 128, 500, 500, 500, 392, 500, 500, 500, 500, 500, 374, 500, 368, 376, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771633257121196, "mean_inference_ms": 1.1830572640542543, "mean_action_processing_ms": 0.14055086857392077, "mean_env_wait_ms": 0.08571233266677374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045427680015563965, "StateBufferConnector_ms": 0.008322795232137045, "ViewRequirementAgentConnector_ms": 0.10422269503275554}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6150.765692096128, "num_env_steps_trained_throughput_per_sec": 6150.765692096128, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 1950.977, "sample_time_ms": 1864.494, "load_time_ms": 6.826, "load_throughput": 1758003.772, "learn_time_ms": 64.916, "learn_throughput": 184853.213, "synch_weights_time_ms": 11.74}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 24, "training_iteration": 1, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-41", "timestamp": 1698249701, "time_this_iter_s": 1.9559736251831055, "time_total_s": 1.9559736251831055, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 1.9559736251831055, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.36666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.20250309838189, "policy_loss": -0.0022468740741411843, "vf_loss": 9.20435259077284, "vf_explained_var": -3.747807608710395e-05, "kl": 0.004678449314471638, "entropy": 0.7018156713909574, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 38.90000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -15.95714285714315, "episode_len_mean": 392.17857142857144, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 13.299999999999748, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, 16.29999999999979, 38.90000000000002, -50.00000000000044, 21.299999999999862, 29.899999999999984, 38.700000000000024, 33.10000000000003, -50.00000000000044, -50.00000000000044, 6.299999999999649, 22.099999999999874, -50.00000000000044, 31.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 36.30000000000003, 31.900000000000013, -50.00000000000044, 28.699999999999967, 32.50000000000002, 2.499999999999595, -50.00000000000044, 6.8999999999996575, 38.10000000000002, 15.699999999999783, -50.00000000000044, 17.099999999999802, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 128, 500, 500, 500, 392, 500, 500, 500, 500, 500, 374, 500, 368, 376, 500, 500, 500, 462, 338, 112, 500, 288, 202, 114, 170, 500, 500, 438, 280, 500, 190, 130, 500, 500, 188, 500, 138, 182, 500, 214, 176, 476, 500, 432, 120, 344, 500, 330, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37545820323326523, "mean_inference_ms": 1.1857785767106255, "mean_action_processing_ms": 0.1403498504198637, "mean_env_wait_ms": 0.08531430406865141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03377326897212437, "StateBufferConnector_ms": 0.005353348595755441, "ViewRequirementAgentConnector_ms": 0.10716744831630162}}, "episode_reward_max": 38.90000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -15.95714285714315, "episode_len_mean": 392.17857142857144, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 13.299999999999748, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, 16.29999999999979, 38.90000000000002, -50.00000000000044, 21.299999999999862, 29.899999999999984, 38.700000000000024, 33.10000000000003, -50.00000000000044, -50.00000000000044, 6.299999999999649, 22.099999999999874, -50.00000000000044, 31.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 36.30000000000003, 31.900000000000013, -50.00000000000044, 28.699999999999967, 32.50000000000002, 2.499999999999595, -50.00000000000044, 6.8999999999996575, 38.10000000000002, 15.699999999999783, -50.00000000000044, 17.099999999999802, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 128, 500, 500, 500, 392, 500, 500, 500, 500, 500, 374, 500, 368, 376, 500, 500, 500, 462, 338, 112, 500, 288, 202, 114, 170, 500, 500, 438, 280, 500, 190, 130, 500, 500, 188, 500, 138, 182, 500, 214, 176, 476, 500, 432, 120, 344, 500, 330, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37545820323326523, "mean_inference_ms": 1.1857785767106255, "mean_action_processing_ms": 0.1403498504198637, "mean_env_wait_ms": 0.08531430406865141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03377326897212437, "StateBufferConnector_ms": 0.005353348595755441, "ViewRequirementAgentConnector_ms": 0.10716744831630162}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6144.396025525082, "num_env_steps_trained_throughput_per_sec": 6144.396025525082, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 1951.988, "sample_time_ms": 1867.528, "load_time_ms": 7.413, "load_throughput": 1618719.282, "learn_time_ms": 63.283, "learn_throughput": 189623.057, "synch_weights_time_ms": 11.263}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 56, "training_iteration": 2, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-43", "timestamp": 1698249703, "time_this_iter_s": 1.9569969177246094, "time_total_s": 3.912970542907715, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.912970542907715, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 64.39999999999999, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 9.137347433302137, "policy_loss": 0.000540528032514784, "vf_loss": 9.136792182922363, "vf_explained_var": -0.0002330674065483941, "kl": 0.0017190787279004224, "entropy": 0.7111154794692993, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.889690721649733, "episode_len_mean": 353.29896907216494, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 13.299999999999748, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, 16.29999999999979, 38.90000000000002, -50.00000000000044, 21.299999999999862, 29.899999999999984, 38.700000000000024, 33.10000000000003, -50.00000000000044, -50.00000000000044, 6.299999999999649, 22.099999999999874, -50.00000000000044, 31.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 36.30000000000003, 31.900000000000013, -50.00000000000044, 28.699999999999967, 32.50000000000002, 2.499999999999595, -50.00000000000044, 6.8999999999996575, 38.10000000000002, 15.699999999999783, -50.00000000000044, 17.099999999999802, -50.00000000000044, 26.299999999999933, 0.09999999999956088, 37.90000000000003, 36.50000000000003, -50.00000000000044, 10.699999999999712, 38.300000000000026, -50.00000000000044, 27.699999999999953, 6.299999999999649, 33.70000000000004, 25.499999999999922, 22.899999999999885, 2.499999999999595, -50.00000000000044, 45.3, 26.69999999999994, 39.70000000000002, 42.500000000000014, 5.099999999999632, -50.00000000000044, -50.00000000000044, 28.699999999999967, 11.099999999999717, 12.099999999999731, 41.100000000000016, 36.30000000000003, 34.30000000000004, 4.499999999999623, 34.70000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 26.299999999999933, 9.699999999999697, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 128, 500, 500, 500, 392, 500, 500, 500, 500, 500, 374, 500, 368, 376, 500, 500, 500, 462, 338, 112, 500, 288, 202, 114, 170, 500, 500, 438, 280, 500, 190, 130, 500, 500, 188, 500, 138, 182, 500, 214, 176, 476, 500, 432, 120, 344, 500, 330, 500, 238, 500, 122, 136, 500, 394, 118, 500, 224, 438, 164, 246, 272, 476, 500, 48, 234, 104, 76, 450, 500, 500, 214, 390, 380, 90, 138, 158, 456, 154, 500, 114, 500, 144, 92, 500, 500, 96, 238, 404, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761590251289042, "mean_inference_ms": 1.1913096933719787, "mean_action_processing_ms": 0.138850390983528, "mean_env_wait_ms": 0.08452799067456819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03163249222273679, "StateBufferConnector_ms": 0.007211547536948293, "ViewRequirementAgentConnector_ms": 0.11549782507198374}}, "episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.889690721649733, "episode_len_mean": 353.29896907216494, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.69999999999974, -50.00000000000044, 13.299999999999748, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, 16.29999999999979, 38.90000000000002, -50.00000000000044, 21.299999999999862, 29.899999999999984, 38.700000000000024, 33.10000000000003, -50.00000000000044, -50.00000000000044, 6.299999999999649, 22.099999999999874, -50.00000000000044, 31.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 36.30000000000003, 31.900000000000013, -50.00000000000044, 28.699999999999967, 32.50000000000002, 2.499999999999595, -50.00000000000044, 6.8999999999996575, 38.10000000000002, 15.699999999999783, -50.00000000000044, 17.099999999999802, -50.00000000000044, 26.299999999999933, 0.09999999999956088, 37.90000000000003, 36.50000000000003, -50.00000000000044, 10.699999999999712, 38.300000000000026, -50.00000000000044, 27.699999999999953, 6.299999999999649, 33.70000000000004, 25.499999999999922, 22.899999999999885, 2.499999999999595, -50.00000000000044, 45.3, 26.69999999999994, 39.70000000000002, 42.500000000000014, 5.099999999999632, -50.00000000000044, -50.00000000000044, 28.699999999999967, 11.099999999999717, 12.099999999999731, 41.100000000000016, 36.30000000000003, 34.30000000000004, 4.499999999999623, 34.70000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 26.299999999999933, 9.699999999999697, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 128, 500, 500, 500, 392, 500, 500, 500, 500, 500, 374, 500, 368, 376, 500, 500, 500, 462, 338, 112, 500, 288, 202, 114, 170, 500, 500, 438, 280, 500, 190, 130, 500, 500, 188, 500, 138, 182, 500, 214, 176, 476, 500, 432, 120, 344, 500, 330, 500, 238, 500, 122, 136, 500, 394, 118, 500, 224, 438, 164, 246, 272, 476, 500, 48, 234, 104, 76, 450, 500, 500, 214, 390, 380, 90, 138, 158, 456, 154, 500, 114, 500, 144, 92, 500, 500, 96, 238, 404, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3761590251289042, "mean_inference_ms": 1.1913096933719787, "mean_action_processing_ms": 0.138850390983528, "mean_env_wait_ms": 0.08452799067456819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03163249222273679, "StateBufferConnector_ms": 0.007211547536948293, "ViewRequirementAgentConnector_ms": 0.11549782507198374}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5426.127094645031, "num_env_steps_trained_throughput_per_sec": 5426.127094645031, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2038.499, "sample_time_ms": 1897.682, "load_time_ms": 10.276, "load_throughput": 1167769.594, "learn_time_ms": 116.799, "learn_throughput": 102740.573, "synch_weights_time_ms": 11.742}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 97, "training_iteration": 3, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-45", "timestamp": 1698249705, "time_this_iter_s": 2.2163898944854736, "time_total_s": 6.1293604373931885, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.1293604373931885, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 65.39999999999999, "ram_util_percent": 27.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 8.98288599650065, "policy_loss": -0.001665974087599251, "vf_loss": 8.984526210361057, "vf_explained_var": -2.700752682156033e-05, "kl": 0.0038817708383349883, "entropy": 0.7108900215890672, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3379999999997967, "episode_len_mean": 317.32, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.299999999999649, 22.099999999999874, -50.00000000000044, 31.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 36.30000000000003, 31.900000000000013, -50.00000000000044, 28.699999999999967, 32.50000000000002, 2.499999999999595, -50.00000000000044, 6.8999999999996575, 38.10000000000002, 15.699999999999783, -50.00000000000044, 17.099999999999802, -50.00000000000044, 26.299999999999933, 0.09999999999956088, 37.90000000000003, 36.50000000000003, -50.00000000000044, 10.699999999999712, 38.300000000000026, -50.00000000000044, 27.699999999999953, 6.299999999999649, 33.70000000000004, 25.499999999999922, 22.899999999999885, 2.499999999999595, -50.00000000000044, 45.3, 26.69999999999994, 39.70000000000002, 42.500000000000014, 5.099999999999632, -50.00000000000044, -50.00000000000044, 28.699999999999967, 11.099999999999717, 12.099999999999731, 41.100000000000016, 36.30000000000003, 34.30000000000004, 4.499999999999623, 34.70000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 26.299999999999933, 9.699999999999697, -50.00000000000044, -50.00000000000044, 24.299999999999905, 19.499999999999837, 29.69999999999998, -50.00000000000044, 46.9, 36.70000000000003, 3.2999999999996064, -50.00000000000044, 30.099999999999987, 25.29999999999992, -50.00000000000044, 27.49999999999995, 41.500000000000014, 27.299999999999947, 39.300000000000026, 10.499999999999709, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 2.299999999999592, 29.49999999999998, 39.300000000000026, 18.899999999999828, 32.700000000000024, 17.899999999999814, -50.00000000000044, 36.900000000000034, 14.09999999999976], "episode_lengths": [438, 280, 500, 190, 130, 500, 500, 188, 500, 138, 182, 500, 214, 176, 476, 500, 432, 120, 344, 500, 330, 500, 238, 500, 122, 136, 500, 394, 118, 500, 224, 438, 164, 246, 272, 476, 500, 48, 234, 104, 76, 450, 500, 500, 214, 390, 380, 90, 138, 158, 456, 154, 500, 114, 500, 144, 92, 500, 500, 96, 238, 404, 500, 500, 258, 306, 204, 500, 32, 134, 468, 500, 200, 248, 500, 226, 86, 228, 108, 396, 66, 500, 500, 104, 164, 500, 500, 500, 466, 500, 500, 478, 206, 108, 312, 174, 322, 500, 132, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37850766341947273, "mean_inference_ms": 1.1997888700787818, "mean_action_processing_ms": 0.1382380779496336, "mean_env_wait_ms": 0.08409469874655745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02577662467956543, "StateBufferConnector_ms": 0.008992671966552734, "ViewRequirementAgentConnector_ms": 0.12102246284484863}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3379999999997967, "episode_len_mean": 317.32, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.299999999999649, 22.099999999999874, -50.00000000000044, 31.1, 37.10000000000003, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 36.30000000000003, 31.900000000000013, -50.00000000000044, 28.699999999999967, 32.50000000000002, 2.499999999999595, -50.00000000000044, 6.8999999999996575, 38.10000000000002, 15.699999999999783, -50.00000000000044, 17.099999999999802, -50.00000000000044, 26.299999999999933, 0.09999999999956088, 37.90000000000003, 36.50000000000003, -50.00000000000044, 10.699999999999712, 38.300000000000026, -50.00000000000044, 27.699999999999953, 6.299999999999649, 33.70000000000004, 25.499999999999922, 22.899999999999885, 2.499999999999595, -50.00000000000044, 45.3, 26.69999999999994, 39.70000000000002, 42.500000000000014, 5.099999999999632, -50.00000000000044, -50.00000000000044, 28.699999999999967, 11.099999999999717, 12.099999999999731, 41.100000000000016, 36.30000000000003, 34.30000000000004, 4.499999999999623, 34.70000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 26.299999999999933, 9.699999999999697, -50.00000000000044, -50.00000000000044, 24.299999999999905, 19.499999999999837, 29.69999999999998, -50.00000000000044, 46.9, 36.70000000000003, 3.2999999999996064, -50.00000000000044, 30.099999999999987, 25.29999999999992, -50.00000000000044, 27.49999999999995, 41.500000000000014, 27.299999999999947, 39.300000000000026, 10.499999999999709, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 2.299999999999592, 29.49999999999998, 39.300000000000026, 18.899999999999828, 32.700000000000024, 17.899999999999814, -50.00000000000044, 36.900000000000034, 14.09999999999976], "episode_lengths": [438, 280, 500, 190, 130, 500, 500, 188, 500, 138, 182, 500, 214, 176, 476, 500, 432, 120, 344, 500, 330, 500, 238, 500, 122, 136, 500, 394, 118, 500, 224, 438, 164, 246, 272, 476, 500, 48, 234, 104, 76, 450, 500, 500, 214, 390, 380, 90, 138, 158, 456, 154, 500, 114, 500, 144, 92, 500, 500, 96, 238, 404, 500, 500, 258, 306, 204, 500, 32, 134, 468, 500, 200, 248, 500, 226, 86, 228, 108, 396, 66, 500, 500, 104, 164, 500, 500, 500, 466, 500, 500, 478, 206, 108, 312, 174, 322, 500, 132, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37850766341947273, "mean_inference_ms": 1.1997888700787818, "mean_action_processing_ms": 0.1382380779496336, "mean_env_wait_ms": 0.08409469874655745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02577662467956543, "StateBufferConnector_ms": 0.008992671966552734, "ViewRequirementAgentConnector_ms": 0.12102246284484863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5215.334342447971, "num_env_steps_trained_throughput_per_sec": 5215.334342447971, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2104.101, "sample_time_ms": 1914.873, "load_time_ms": 12.134, "load_throughput": 988984.531, "learn_time_ms": 164.074, "learn_throughput": 73137.516, "synch_weights_time_ms": 11.27}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 134, "training_iteration": 4, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-47", "timestamp": 1698249707, "time_this_iter_s": 2.3059170246124268, "time_total_s": 8.435277462005615, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.435277462005615, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 58.166666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 9.036465220981174, "policy_loss": 0.0008347373869684008, "vf_loss": 9.035676002502441, "vf_explained_var": 8.629428015814887e-06, "kl": 0.0016564118394247391, "entropy": 0.6583143671353658, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.641999999999817, "episode_len_mean": 294.3, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.099999999999717, 12.099999999999731, 41.100000000000016, 36.30000000000003, 34.30000000000004, 4.499999999999623, 34.70000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 26.299999999999933, 9.699999999999697, -50.00000000000044, -50.00000000000044, 24.299999999999905, 19.499999999999837, 29.69999999999998, -50.00000000000044, 46.9, 36.70000000000003, 3.2999999999996064, -50.00000000000044, 30.099999999999987, 25.29999999999992, -50.00000000000044, 27.49999999999995, 41.500000000000014, 27.299999999999947, 39.300000000000026, 10.499999999999709, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 2.299999999999592, 29.49999999999998, 39.300000000000026, 18.899999999999828, 32.700000000000024, 17.899999999999814, -50.00000000000044, 36.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 15.899999999999785, 37.70000000000003, 41.30000000000001, 2.8999999999996007, 28.699999999999967, 37.50000000000003, -50.00000000000044, 41.500000000000014, 25.499999999999922, 39.90000000000002, 40.10000000000002, 32.90000000000003, 41.70000000000002, -50.00000000000044, 41.70000000000002, 4.899999999999629, 41.90000000000001, 41.100000000000016, 19.09999999999983, 2.499999999999595, 3.499999999999609, -50.00000000000044, 33.90000000000004, 41.90000000000001, 39.70000000000002, 40.70000000000002, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 6.499999999999652, 41.30000000000001, 31.1, 37.50000000000003, -50.00000000000044, 39.50000000000002, 31.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 39.70000000000002, 37.10000000000003, 24.099999999999902], "episode_lengths": [390, 380, 90, 138, 158, 456, 154, 500, 114, 500, 144, 92, 500, 500, 96, 238, 404, 500, 500, 258, 306, 204, 500, 32, 134, 468, 500, 200, 248, 500, 226, 86, 228, 108, 396, 66, 500, 500, 104, 164, 500, 500, 500, 466, 500, 500, 478, 206, 108, 312, 174, 322, 500, 132, 360, 500, 500, 342, 124, 88, 472, 214, 126, 500, 86, 246, 102, 100, 172, 84, 500, 84, 452, 82, 90, 310, 476, 466, 500, 162, 82, 104, 94, 500, 372, 500, 500, 436, 88, 190, 126, 500, 106, 190, 500, 230, 500, 104, 130, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38022379433864223, "mean_inference_ms": 1.2067542595860814, "mean_action_processing_ms": 0.13974470141948406, "mean_env_wait_ms": 0.08393327002945694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025763273239135742, "StateBufferConnector_ms": 0.010991096496582031, "ViewRequirementAgentConnector_ms": 0.11998820304870605}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.641999999999817, "episode_len_mean": 294.3, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.099999999999717, 12.099999999999731, 41.100000000000016, 36.30000000000003, 34.30000000000004, 4.499999999999623, 34.70000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 26.299999999999933, 9.699999999999697, -50.00000000000044, -50.00000000000044, 24.299999999999905, 19.499999999999837, 29.69999999999998, -50.00000000000044, 46.9, 36.70000000000003, 3.2999999999996064, -50.00000000000044, 30.099999999999987, 25.29999999999992, -50.00000000000044, 27.49999999999995, 41.500000000000014, 27.299999999999947, 39.300000000000026, 10.499999999999709, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 2.299999999999592, 29.49999999999998, 39.300000000000026, 18.899999999999828, 32.700000000000024, 17.899999999999814, -50.00000000000044, 36.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 15.899999999999785, 37.70000000000003, 41.30000000000001, 2.8999999999996007, 28.699999999999967, 37.50000000000003, -50.00000000000044, 41.500000000000014, 25.499999999999922, 39.90000000000002, 40.10000000000002, 32.90000000000003, 41.70000000000002, -50.00000000000044, 41.70000000000002, 4.899999999999629, 41.90000000000001, 41.100000000000016, 19.09999999999983, 2.499999999999595, 3.499999999999609, -50.00000000000044, 33.90000000000004, 41.90000000000001, 39.70000000000002, 40.70000000000002, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 6.499999999999652, 41.30000000000001, 31.1, 37.50000000000003, -50.00000000000044, 39.50000000000002, 31.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 39.70000000000002, 37.10000000000003, 24.099999999999902], "episode_lengths": [390, 380, 90, 138, 158, 456, 154, 500, 114, 500, 144, 92, 500, 500, 96, 238, 404, 500, 500, 258, 306, 204, 500, 32, 134, 468, 500, 200, 248, 500, 226, 86, 228, 108, 396, 66, 500, 500, 104, 164, 500, 500, 500, 466, 500, 500, 478, 206, 108, 312, 174, 322, 500, 132, 360, 500, 500, 342, 124, 88, 472, 214, 126, 500, 86, 246, 102, 100, 172, 84, 500, 84, 452, 82, 90, 310, 476, 466, 500, 162, 82, 104, 94, 500, 372, 500, 500, 436, 88, 190, 126, 500, 106, 190, 500, 230, 500, 104, 130, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38022379433864223, "mean_inference_ms": 1.2067542595860814, "mean_action_processing_ms": 0.13974470141948406, "mean_env_wait_ms": 0.08393327002945694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025763273239135742, "StateBufferConnector_ms": 0.010991096496582031, "ViewRequirementAgentConnector_ms": 0.11998820304870605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5730.076142738775, "num_env_steps_trained_throughput_per_sec": 5730.076142738775, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2102.124, "sample_time_ms": 1920.393, "load_time_ms": 11.763, "load_throughput": 1020118.932, "learn_time_ms": 156.797, "learn_throughput": 76532.11, "synch_weights_time_ms": 11.369}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 179, "training_iteration": 5, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-49", "timestamp": 1698249709, "time_this_iter_s": 2.1007518768310547, "time_total_s": 10.53602933883667, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.53602933883667, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 58.03333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 9.140694088406033, "policy_loss": -0.0011425724046097861, "vf_loss": 9.141899956597221, "vf_explained_var": -1.020563973320855e-05, "kl": 0.0010012236844987557, "entropy": 0.6968194776111178, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.102999999999831, "episode_len_mean": 284.7, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 2.299999999999592, 29.49999999999998, 39.300000000000026, 18.899999999999828, 32.700000000000024, 17.899999999999814, -50.00000000000044, 36.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 15.899999999999785, 37.70000000000003, 41.30000000000001, 2.8999999999996007, 28.699999999999967, 37.50000000000003, -50.00000000000044, 41.500000000000014, 25.499999999999922, 39.90000000000002, 40.10000000000002, 32.90000000000003, 41.70000000000002, -50.00000000000044, 41.70000000000002, 4.899999999999629, 41.90000000000001, 41.100000000000016, 19.09999999999983, 2.499999999999595, 3.499999999999609, -50.00000000000044, 33.90000000000004, 41.90000000000001, 39.70000000000002, 40.70000000000002, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 6.499999999999652, 41.30000000000001, 31.1, 37.50000000000003, -50.00000000000044, 39.50000000000002, 31.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 39.70000000000002, 37.10000000000003, 24.099999999999902, -50.00000000000044, -50.00000000000044, 28.09999999999996, 42.30000000000001, 12.299999999999734, 44.900000000000006, 37.70000000000003, 28.29999999999996, -50.00000000000044, 9.8999999999997, -50.00000000000044, 39.90000000000002, 40.10000000000002, 32.90000000000003, -50.00000000000044, 16.699999999999797, 42.30000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 40.70000000000002, 25.899999999999928, 15.099999999999774, 31.500000000000007, 32.90000000000003, 26.299999999999933, -50.00000000000044, 42.500000000000014, 26.499999999999936, -50.00000000000044, 32.30000000000002, 35.900000000000034, 27.099999999999945, 36.10000000000004, -50.00000000000044, 37.90000000000003, 36.900000000000034, 19.299999999999834, 36.900000000000034], "episode_lengths": [500, 500, 466, 500, 500, 478, 206, 108, 312, 174, 322, 500, 132, 360, 500, 500, 342, 124, 88, 472, 214, 126, 500, 86, 246, 102, 100, 172, 84, 500, 84, 452, 82, 90, 310, 476, 466, 500, 162, 82, 104, 94, 500, 372, 500, 500, 436, 88, 190, 126, 500, 106, 190, 500, 230, 500, 104, 130, 260, 500, 500, 220, 78, 378, 52, 124, 218, 500, 402, 500, 102, 100, 172, 500, 334, 78, 500, 172, 500, 500, 214, 94, 242, 350, 186, 172, 238, 500, 76, 236, 500, 178, 142, 230, 140, 500, 122, 132, 308, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3804428216734946, "mean_inference_ms": 1.208385284678393, "mean_action_processing_ms": 0.14065142385062454, "mean_env_wait_ms": 0.08407342073102278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598881721496582, "StateBufferConnector_ms": 0.01299595832824707, "ViewRequirementAgentConnector_ms": 0.12108397483825684}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.102999999999831, "episode_len_mean": 284.7, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 2.299999999999592, 29.49999999999998, 39.300000000000026, 18.899999999999828, 32.700000000000024, 17.899999999999814, -50.00000000000044, 36.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 15.899999999999785, 37.70000000000003, 41.30000000000001, 2.8999999999996007, 28.699999999999967, 37.50000000000003, -50.00000000000044, 41.500000000000014, 25.499999999999922, 39.90000000000002, 40.10000000000002, 32.90000000000003, 41.70000000000002, -50.00000000000044, 41.70000000000002, 4.899999999999629, 41.90000000000001, 41.100000000000016, 19.09999999999983, 2.499999999999595, 3.499999999999609, -50.00000000000044, 33.90000000000004, 41.90000000000001, 39.70000000000002, 40.70000000000002, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 6.499999999999652, 41.30000000000001, 31.1, 37.50000000000003, -50.00000000000044, 39.50000000000002, 31.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 39.70000000000002, 37.10000000000003, 24.099999999999902, -50.00000000000044, -50.00000000000044, 28.09999999999996, 42.30000000000001, 12.299999999999734, 44.900000000000006, 37.70000000000003, 28.29999999999996, -50.00000000000044, 9.8999999999997, -50.00000000000044, 39.90000000000002, 40.10000000000002, 32.90000000000003, -50.00000000000044, 16.699999999999797, 42.30000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 40.70000000000002, 25.899999999999928, 15.099999999999774, 31.500000000000007, 32.90000000000003, 26.299999999999933, -50.00000000000044, 42.500000000000014, 26.499999999999936, -50.00000000000044, 32.30000000000002, 35.900000000000034, 27.099999999999945, 36.10000000000004, -50.00000000000044, 37.90000000000003, 36.900000000000034, 19.299999999999834, 36.900000000000034], "episode_lengths": [500, 500, 466, 500, 500, 478, 206, 108, 312, 174, 322, 500, 132, 360, 500, 500, 342, 124, 88, 472, 214, 126, 500, 86, 246, 102, 100, 172, 84, 500, 84, 452, 82, 90, 310, 476, 466, 500, 162, 82, 104, 94, 500, 372, 500, 500, 436, 88, 190, 126, 500, 106, 190, 500, 230, 500, 104, 130, 260, 500, 500, 220, 78, 378, 52, 124, 218, 500, 402, 500, 102, 100, 172, 500, 334, 78, 500, 172, 500, 500, 214, 94, 242, 350, 186, 172, 238, 500, 76, 236, 500, 178, 142, 230, 140, 500, 122, 132, 308, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3804428216734946, "mean_inference_ms": 1.208385284678393, "mean_action_processing_ms": 0.14065142385062454, "mean_env_wait_ms": 0.08407342073102278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02598881721496582, "StateBufferConnector_ms": 0.01299595832824707, "ViewRequirementAgentConnector_ms": 0.12108397483825684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4907.313793380482, "num_env_steps_trained_throughput_per_sec": 4907.313793380482, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2159.325, "sample_time_ms": 1964.453, "load_time_ms": 12.763, "load_throughput": 940230.732, "learn_time_ms": 169.245, "learn_throughput": 70903.143, "synch_weights_time_ms": 11.029}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 220, "training_iteration": 6, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-52", "timestamp": 1698249712, "time_this_iter_s": 2.450326442718506, "time_total_s": 12.986355781555176, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.986355781555176, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.425, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 9.146491156684029, "policy_loss": -0.00025327793425983854, "vf_loss": 9.146803220113119, "vf_explained_var": -1.014603508843316e-05, "kl": 0.001171588355242016, "entropy": 0.6221099098523458, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.04599999999984, "episode_len_mean": 280.28, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 6.499999999999652, 41.30000000000001, 31.1, 37.50000000000003, -50.00000000000044, 39.50000000000002, 31.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 39.70000000000002, 37.10000000000003, 24.099999999999902, -50.00000000000044, -50.00000000000044, 28.09999999999996, 42.30000000000001, 12.299999999999734, 44.900000000000006, 37.70000000000003, 28.29999999999996, -50.00000000000044, 9.8999999999997, -50.00000000000044, 39.90000000000002, 40.10000000000002, 32.90000000000003, -50.00000000000044, 16.699999999999797, 42.30000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 40.70000000000002, 25.899999999999928, 15.099999999999774, 31.500000000000007, 32.90000000000003, 26.299999999999933, -50.00000000000044, 42.500000000000014, 26.499999999999936, -50.00000000000044, 32.30000000000002, 35.900000000000034, 27.099999999999945, 36.10000000000004, -50.00000000000044, 37.90000000000003, 36.900000000000034, 19.299999999999834, 36.900000000000034, 0.09999999999956088, 1.8999999999995865, 28.499999999999964, -50.00000000000044, 40.30000000000002, 29.899999999999984, -50.00000000000044, 9.299999999999692, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.299999999999976, -50.00000000000044, 34.900000000000034, 34.50000000000004, 23.499999999999893, 26.69999999999994, 22.699999999999882, 41.500000000000014, -50.00000000000044, 13.299999999999748, 18.899999999999828, 23.699999999999896, 45.3, -50.00000000000044, 40.500000000000014, 32.100000000000016, 41.30000000000001, -50.00000000000044, 31.500000000000007, 13.099999999999746, 23.29999999999989, 38.50000000000003, 26.299999999999933, 33.500000000000036, 44.7, 36.900000000000034, 13.299999999999748, 28.499999999999964, 46.3, -50.00000000000044], "episode_lengths": [500, 372, 500, 500, 436, 88, 190, 126, 500, 106, 190, 500, 230, 500, 104, 130, 260, 500, 500, 220, 78, 378, 52, 124, 218, 500, 402, 500, 102, 100, 172, 500, 334, 78, 500, 172, 500, 500, 214, 94, 242, 350, 186, 172, 238, 500, 76, 236, 500, 178, 142, 230, 140, 500, 122, 132, 308, 132, 500, 482, 216, 500, 98, 202, 500, 408, 292, 500, 500, 92, 208, 500, 152, 156, 266, 234, 274, 86, 500, 368, 312, 264, 48, 500, 96, 180, 88, 500, 186, 370, 268, 116, 238, 166, 54, 132, 368, 216, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37983725652350403, "mean_inference_ms": 1.2097403432783629, "mean_action_processing_ms": 0.14066543505967427, "mean_env_wait_ms": 0.0840602918315723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992517471313477, "StateBufferConnector_ms": 0.013999700546264648, "ViewRequirementAgentConnector_ms": 0.11409664154052734}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.04599999999984, "episode_len_mean": 280.28, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 6.499999999999652, 41.30000000000001, 31.1, 37.50000000000003, -50.00000000000044, 39.50000000000002, 31.1, -50.00000000000044, 27.099999999999945, -50.00000000000044, 39.70000000000002, 37.10000000000003, 24.099999999999902, -50.00000000000044, -50.00000000000044, 28.09999999999996, 42.30000000000001, 12.299999999999734, 44.900000000000006, 37.70000000000003, 28.29999999999996, -50.00000000000044, 9.8999999999997, -50.00000000000044, 39.90000000000002, 40.10000000000002, 32.90000000000003, -50.00000000000044, 16.699999999999797, 42.30000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 28.699999999999967, 40.70000000000002, 25.899999999999928, 15.099999999999774, 31.500000000000007, 32.90000000000003, 26.299999999999933, -50.00000000000044, 42.500000000000014, 26.499999999999936, -50.00000000000044, 32.30000000000002, 35.900000000000034, 27.099999999999945, 36.10000000000004, -50.00000000000044, 37.90000000000003, 36.900000000000034, 19.299999999999834, 36.900000000000034, 0.09999999999956088, 1.8999999999995865, 28.499999999999964, -50.00000000000044, 40.30000000000002, 29.899999999999984, -50.00000000000044, 9.299999999999692, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.299999999999976, -50.00000000000044, 34.900000000000034, 34.50000000000004, 23.499999999999893, 26.69999999999994, 22.699999999999882, 41.500000000000014, -50.00000000000044, 13.299999999999748, 18.899999999999828, 23.699999999999896, 45.3, -50.00000000000044, 40.500000000000014, 32.100000000000016, 41.30000000000001, -50.00000000000044, 31.500000000000007, 13.099999999999746, 23.29999999999989, 38.50000000000003, 26.299999999999933, 33.500000000000036, 44.7, 36.900000000000034, 13.299999999999748, 28.499999999999964, 46.3, -50.00000000000044], "episode_lengths": [500, 372, 500, 500, 436, 88, 190, 126, 500, 106, 190, 500, 230, 500, 104, 130, 260, 500, 500, 220, 78, 378, 52, 124, 218, 500, 402, 500, 102, 100, 172, 500, 334, 78, 500, 172, 500, 500, 214, 94, 242, 350, 186, 172, 238, 500, 76, 236, 500, 178, 142, 230, 140, 500, 122, 132, 308, 132, 500, 482, 216, 500, 98, 202, 500, 408, 292, 500, 500, 92, 208, 500, 152, 156, 266, 234, 274, 86, 500, 368, 312, 264, 48, 500, 96, 180, 88, 500, 186, 370, 268, 116, 238, 166, 54, 132, 368, 216, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37983725652350403, "mean_inference_ms": 1.2097403432783629, "mean_action_processing_ms": 0.14066543505967427, "mean_env_wait_ms": 0.0840602918315723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020992517471313477, "StateBufferConnector_ms": 0.013999700546264648, "ViewRequirementAgentConnector_ms": 0.11409664154052734}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5933.120724031571, "num_env_steps_trained_throughput_per_sec": 5933.120724031571, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2139.785, "sample_time_ms": 1959.135, "load_time_ms": 11.916, "load_throughput": 1007012.748, "learn_time_ms": 156.174, "learn_throughput": 76837.518, "synch_weights_time_ms": 10.702}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 262, "training_iteration": 7, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-54", "timestamp": 1698249714, "time_this_iter_s": 2.0282533168792725, "time_total_s": 15.014609098434448, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.014609098434448, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 60.46666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 8.788241386413574, "policy_loss": -0.0002256841916177008, "vf_loss": 8.788522296481663, "vf_explained_var": -7.97377692328559e-06, "kl": 0.00019576621912165137, "entropy": 0.5609306693077087, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.921999999999839, "episode_len_mean": 271.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 26.499999999999936, -50.00000000000044, 32.30000000000002, 35.900000000000034, 27.099999999999945, 36.10000000000004, -50.00000000000044, 37.90000000000003, 36.900000000000034, 19.299999999999834, 36.900000000000034, 0.09999999999956088, 1.8999999999995865, 28.499999999999964, -50.00000000000044, 40.30000000000002, 29.899999999999984, -50.00000000000044, 9.299999999999692, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.299999999999976, -50.00000000000044, 34.900000000000034, 34.50000000000004, 23.499999999999893, 26.69999999999994, 22.699999999999882, 41.500000000000014, -50.00000000000044, 13.299999999999748, 18.899999999999828, 23.699999999999896, 45.3, -50.00000000000044, 40.500000000000014, 32.100000000000016, 41.30000000000001, -50.00000000000044, 31.500000000000007, 13.099999999999746, 23.29999999999989, 38.50000000000003, 26.299999999999933, 33.500000000000036, 44.7, 36.900000000000034, 13.299999999999748, 28.499999999999964, 46.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 19.69999999999984, 43.900000000000006, 35.70000000000003, 26.499999999999936, 46.5, 39.90000000000002, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.9, 10.499999999999709, 43.30000000000001, 19.09999999999983, 6.299999999999649, -50.00000000000044, 38.700000000000024, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.699999999999996, 43.30000000000001, 0.8999999999995723, 32.100000000000016, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 15.699999999999783, 36.900000000000034], "episode_lengths": [76, 236, 500, 178, 142, 230, 140, 500, 122, 132, 308, 132, 500, 482, 216, 500, 98, 202, 500, 408, 292, 500, 500, 92, 208, 500, 152, 156, 266, 234, 274, 86, 500, 368, 312, 264, 48, 500, 96, 180, 88, 500, 186, 370, 268, 116, 238, 166, 54, 132, 368, 216, 38, 500, 84, 500, 66, 304, 62, 144, 236, 36, 102, 78, 80, 500, 500, 72, 500, 82, 500, 32, 396, 68, 310, 438, 500, 114, 500, 406, 500, 500, 50, 68, 500, 500, 340, 500, 500, 74, 194, 68, 492, 180, 160, 500, 70, 500, 344, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801707915571341, "mean_inference_ms": 1.2102629782267391, "mean_action_processing_ms": 0.14068171746743718, "mean_env_wait_ms": 0.08428390019853266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099895477294922, "StateBufferConnector_ms": 0.009001731872558594, "ViewRequirementAgentConnector_ms": 0.11702108383178711}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.921999999999839, "episode_len_mean": 271.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 26.499999999999936, -50.00000000000044, 32.30000000000002, 35.900000000000034, 27.099999999999945, 36.10000000000004, -50.00000000000044, 37.90000000000003, 36.900000000000034, 19.299999999999834, 36.900000000000034, 0.09999999999956088, 1.8999999999995865, 28.499999999999964, -50.00000000000044, 40.30000000000002, 29.899999999999984, -50.00000000000044, 9.299999999999692, 20.899999999999856, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.299999999999976, -50.00000000000044, 34.900000000000034, 34.50000000000004, 23.499999999999893, 26.69999999999994, 22.699999999999882, 41.500000000000014, -50.00000000000044, 13.299999999999748, 18.899999999999828, 23.699999999999896, 45.3, -50.00000000000044, 40.500000000000014, 32.100000000000016, 41.30000000000001, -50.00000000000044, 31.500000000000007, 13.099999999999746, 23.29999999999989, 38.50000000000003, 26.299999999999933, 33.500000000000036, 44.7, 36.900000000000034, 13.299999999999748, 28.499999999999964, 46.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 19.69999999999984, 43.900000000000006, 35.70000000000003, 26.499999999999936, 46.5, 39.90000000000002, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.9, 10.499999999999709, 43.30000000000001, 19.09999999999983, 6.299999999999649, -50.00000000000044, 38.700000000000024, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.699999999999996, 43.30000000000001, 0.8999999999995723, 32.100000000000016, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 15.699999999999783, 36.900000000000034], "episode_lengths": [76, 236, 500, 178, 142, 230, 140, 500, 122, 132, 308, 132, 500, 482, 216, 500, 98, 202, 500, 408, 292, 500, 500, 92, 208, 500, 152, 156, 266, 234, 274, 86, 500, 368, 312, 264, 48, 500, 96, 180, 88, 500, 186, 370, 268, 116, 238, 166, 54, 132, 368, 216, 38, 500, 84, 500, 66, 304, 62, 144, 236, 36, 102, 78, 80, 500, 500, 72, 500, 82, 500, 32, 396, 68, 310, 438, 500, 114, 500, 406, 500, 500, 50, 68, 500, 500, 340, 500, 500, 74, 194, 68, 492, 180, 160, 500, 70, 500, 344, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801707915571341, "mean_inference_ms": 1.2102629782267391, "mean_action_processing_ms": 0.14068171746743718, "mean_env_wait_ms": 0.08428390019853266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099895477294922, "StateBufferConnector_ms": 0.009001731872558594, "ViewRequirementAgentConnector_ms": 0.11702108383178711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5494.225357601448, "num_env_steps_trained_throughput_per_sec": 5494.225357601448, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2145.325, "sample_time_ms": 1955.618, "load_time_ms": 12.677, "load_throughput": 946615.19, "learn_time_ms": 164.54, "learn_throughput": 72930.518, "synch_weights_time_ms": 10.739}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 308, "training_iteration": 8, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-56", "timestamp": 1698249716, "time_this_iter_s": 2.189974069595337, "time_total_s": 17.204583168029785, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.204583168029785, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 60.96666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 8.994900915357801, "policy_loss": -0.0003815545803970761, "vf_loss": 8.995340665181478, "vf_explained_var": -4.3643845452202695e-06, "kl": 0.00033854616533012124, "entropy": 0.5820797350671556, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.373999999999855, "episode_len_mean": 246.98, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 19.69999999999984, 43.900000000000006, 35.70000000000003, 26.499999999999936, 46.5, 39.90000000000002, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.9, 10.499999999999709, 43.30000000000001, 19.09999999999983, 6.299999999999649, -50.00000000000044, 38.700000000000024, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.699999999999996, 43.30000000000001, 0.8999999999995723, 32.100000000000016, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 15.699999999999783, 36.900000000000034, -50.00000000000044, 36.30000000000003, 34.900000000000034, -50.00000000000044, 13.899999999999757, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.900000000000006, 38.700000000000024, 44.300000000000004, 45.9, 17.899999999999814, 31.900000000000013, 40.500000000000014, 43.30000000000001, 43.50000000000001, 35.70000000000003, 46.699999999999996, 41.30000000000001, 28.499999999999964, 8.49999999999968, 35.10000000000004, 41.70000000000002, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 29.899999999999984, 38.90000000000002, 40.500000000000014, -50.00000000000044, 34.70000000000004, 30.9, -50.00000000000044, 34.50000000000004, 31.900000000000013, 31.1, 38.700000000000024, -50.00000000000044, 47.1, 42.900000000000006, 44.7, 35.900000000000034, 41.500000000000014, 28.09999999999996, 38.50000000000003, -50.00000000000044, 38.90000000000002, 40.90000000000002, -50.00000000000044], "episode_lengths": [500, 84, 500, 66, 304, 62, 144, 236, 36, 102, 78, 80, 500, 500, 72, 500, 82, 500, 32, 396, 68, 310, 438, 500, 114, 500, 406, 500, 500, 50, 68, 500, 500, 340, 500, 500, 74, 194, 68, 492, 180, 160, 500, 70, 500, 344, 132, 500, 138, 152, 500, 362, 500, 144, 500, 72, 114, 58, 42, 322, 182, 96, 68, 66, 144, 34, 88, 216, 416, 150, 84, 58, 50, 500, 500, 500, 38, 202, 112, 96, 500, 154, 192, 500, 156, 182, 190, 114, 500, 30, 72, 54, 142, 86, 220, 116, 500, 112, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814831435094911, "mean_inference_ms": 1.2117323163532052, "mean_action_processing_ms": 0.14020885115628523, "mean_env_wait_ms": 0.08423243314807059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030999183654785156, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.12914013862609863}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.373999999999855, "episode_len_mean": 246.98, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 19.69999999999984, 43.900000000000006, 35.70000000000003, 26.499999999999936, 46.5, 39.90000000000002, 42.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.9, 10.499999999999709, 43.30000000000001, 19.09999999999983, 6.299999999999649, -50.00000000000044, 38.700000000000024, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.699999999999996, 43.30000000000001, 0.8999999999995723, 32.100000000000016, 34.10000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 15.699999999999783, 36.900000000000034, -50.00000000000044, 36.30000000000003, 34.900000000000034, -50.00000000000044, 13.899999999999757, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.900000000000006, 38.700000000000024, 44.300000000000004, 45.9, 17.899999999999814, 31.900000000000013, 40.500000000000014, 43.30000000000001, 43.50000000000001, 35.70000000000003, 46.699999999999996, 41.30000000000001, 28.499999999999964, 8.49999999999968, 35.10000000000004, 41.70000000000002, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 29.899999999999984, 38.90000000000002, 40.500000000000014, -50.00000000000044, 34.70000000000004, 30.9, -50.00000000000044, 34.50000000000004, 31.900000000000013, 31.1, 38.700000000000024, -50.00000000000044, 47.1, 42.900000000000006, 44.7, 35.900000000000034, 41.500000000000014, 28.09999999999996, 38.50000000000003, -50.00000000000044, 38.90000000000002, 40.90000000000002, -50.00000000000044], "episode_lengths": [500, 84, 500, 66, 304, 62, 144, 236, 36, 102, 78, 80, 500, 500, 72, 500, 82, 500, 32, 396, 68, 310, 438, 500, 114, 500, 406, 500, 500, 50, 68, 500, 500, 340, 500, 500, 74, 194, 68, 492, 180, 160, 500, 70, 500, 344, 132, 500, 138, 152, 500, 362, 500, 144, 500, 72, 114, 58, 42, 322, 182, 96, 68, 66, 144, 34, 88, 216, 416, 150, 84, 58, 50, 500, 500, 500, 38, 202, 112, 96, 500, 154, 192, 500, 156, 182, 190, 114, 500, 30, 72, 54, 142, 86, 220, 116, 500, 112, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814831435094911, "mean_inference_ms": 1.2117323163532052, "mean_action_processing_ms": 0.14020885115628523, "mean_env_wait_ms": 0.08423243314807059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030999183654785156, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.12914013862609863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5208.586341987707, "num_env_steps_trained_throughput_per_sec": 5208.586341987707, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2162.943, "sample_time_ms": 1956.033, "load_time_ms": 13.125, "load_throughput": 914295.236, "learn_time_ms": 181.325, "learn_throughput": 66179.653, "synch_weights_time_ms": 10.682}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 361, "training_iteration": 9, "trial_id": "9f288_00018", "date": "2023-10-25_17-01-58", "timestamp": 1698249718, "time_this_iter_s": 2.307886838912964, "time_total_s": 19.51247000694275, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.51247000694275, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 8.784042358398438, "policy_loss": 7.217092853453424e-05, "vf_loss": 8.784030278523764, "vf_explained_var": -1.104010476006402e-05, "kl": 0.0001237745312449887, "entropy": 0.5988776418897841, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.396999999999867, "episode_len_mean": 231.76, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.899999999999757, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.900000000000006, 38.700000000000024, 44.300000000000004, 45.9, 17.899999999999814, 31.900000000000013, 40.500000000000014, 43.30000000000001, 43.50000000000001, 35.70000000000003, 46.699999999999996, 41.30000000000001, 28.499999999999964, 8.49999999999968, 35.10000000000004, 41.70000000000002, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 29.899999999999984, 38.90000000000002, 40.500000000000014, -50.00000000000044, 34.70000000000004, 30.9, -50.00000000000044, 34.50000000000004, 31.900000000000013, 31.1, 38.700000000000024, -50.00000000000044, 47.1, 42.900000000000006, 44.7, 35.900000000000034, 41.500000000000014, 28.09999999999996, 38.50000000000003, -50.00000000000044, 38.90000000000002, 40.90000000000002, -50.00000000000044, 8.49999999999968, 43.900000000000006, -50.00000000000044, 43.50000000000001, 31.900000000000013, 42.10000000000001, -50.00000000000044, 41.70000000000002, 40.70000000000002, 40.70000000000002, -50.00000000000044, 37.300000000000026, 43.7, -50.00000000000044, 8.299999999999677, 45.9, -50.00000000000044, 39.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 21.89999999999987, 40.90000000000002, 33.30000000000003, -50.00000000000044, 44.5, 25.699999999999925, 45.1, 40.70000000000002, 41.70000000000002, 43.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.10000000000001, 40.10000000000002, 6.299999999999649, 42.500000000000014, -50.00000000000044], "episode_lengths": [362, 500, 144, 500, 72, 114, 58, 42, 322, 182, 96, 68, 66, 144, 34, 88, 216, 416, 150, 84, 58, 50, 500, 500, 500, 38, 202, 112, 96, 500, 154, 192, 500, 156, 182, 190, 114, 500, 30, 72, 54, 142, 86, 220, 116, 500, 112, 92, 500, 416, 62, 500, 66, 182, 80, 500, 84, 94, 94, 500, 128, 64, 500, 418, 42, 500, 110, 72, 500, 500, 146, 282, 92, 168, 500, 56, 244, 50, 94, 84, 68, 126, 500, 500, 46, 500, 500, 500, 248, 48, 500, 92, 500, 100, 500, 80, 100, 438, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38195194336796817, "mean_inference_ms": 1.2115334257862735, "mean_action_processing_ms": 0.14069197795985144, "mean_env_wait_ms": 0.08419987880695926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024085521697998047, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.12887310981750488}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.396999999999867, "episode_len_mean": 231.76, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.899999999999757, -50.00000000000044, 35.70000000000003, -50.00000000000044, 42.900000000000006, 38.700000000000024, 44.300000000000004, 45.9, 17.899999999999814, 31.900000000000013, 40.500000000000014, 43.30000000000001, 43.50000000000001, 35.70000000000003, 46.699999999999996, 41.30000000000001, 28.499999999999964, 8.49999999999968, 35.10000000000004, 41.70000000000002, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 29.899999999999984, 38.90000000000002, 40.500000000000014, -50.00000000000044, 34.70000000000004, 30.9, -50.00000000000044, 34.50000000000004, 31.900000000000013, 31.1, 38.700000000000024, -50.00000000000044, 47.1, 42.900000000000006, 44.7, 35.900000000000034, 41.500000000000014, 28.09999999999996, 38.50000000000003, -50.00000000000044, 38.90000000000002, 40.90000000000002, -50.00000000000044, 8.49999999999968, 43.900000000000006, -50.00000000000044, 43.50000000000001, 31.900000000000013, 42.10000000000001, -50.00000000000044, 41.70000000000002, 40.70000000000002, 40.70000000000002, -50.00000000000044, 37.300000000000026, 43.7, -50.00000000000044, 8.299999999999677, 45.9, -50.00000000000044, 39.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 21.89999999999987, 40.90000000000002, 33.30000000000003, -50.00000000000044, 44.5, 25.699999999999925, 45.1, 40.70000000000002, 41.70000000000002, 43.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.10000000000001, 40.10000000000002, 6.299999999999649, 42.500000000000014, -50.00000000000044], "episode_lengths": [362, 500, 144, 500, 72, 114, 58, 42, 322, 182, 96, 68, 66, 144, 34, 88, 216, 416, 150, 84, 58, 50, 500, 500, 500, 38, 202, 112, 96, 500, 154, 192, 500, 156, 182, 190, 114, 500, 30, 72, 54, 142, 86, 220, 116, 500, 112, 92, 500, 416, 62, 500, 66, 182, 80, 500, 84, 94, 94, 500, 128, 64, 500, 418, 42, 500, 110, 72, 500, 500, 146, 282, 92, 168, 500, 56, 244, 50, 94, 84, 68, 126, 500, 500, 46, 500, 500, 500, 248, 48, 500, 92, 500, 100, 500, 80, 100, 438, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38195194336796817, "mean_inference_ms": 1.2115334257862735, "mean_action_processing_ms": 0.14069197795985144, "mean_env_wait_ms": 0.08419987880695926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024085521697998047, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.12887310981750488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5924.571015306151, "num_env_steps_trained_throughput_per_sec": 5924.571015306151, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2149.195, "sample_time_ms": 1953.415, "load_time_ms": 12.512, "load_throughput": 959081.69, "learn_time_ms": 170.833, "learn_throughput": 70243.935, "synch_weights_time_ms": 10.734}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 412, "training_iteration": 10, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-00", "timestamp": 1698249720, "time_this_iter_s": 2.0314626693725586, "time_total_s": 21.543932676315308, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.543932676315308, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.866666666666674, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 8.780242178175184, "policy_loss": -0.00033719672097100154, "vf_loss": 8.780638800726997, "vf_explained_var": 5.3313043382432725e-06, "kl": 0.0002706794298818544, "entropy": 0.5942081014315287, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.219999999999834, "episode_len_mean": 258.44, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 28.09999999999996, 38.50000000000003, -50.00000000000044, 38.90000000000002, 40.90000000000002, -50.00000000000044, 8.49999999999968, 43.900000000000006, -50.00000000000044, 43.50000000000001, 31.900000000000013, 42.10000000000001, -50.00000000000044, 41.70000000000002, 40.70000000000002, 40.70000000000002, -50.00000000000044, 37.300000000000026, 43.7, -50.00000000000044, 8.299999999999677, 45.9, -50.00000000000044, 39.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 21.89999999999987, 40.90000000000002, 33.30000000000003, -50.00000000000044, 44.5, 25.699999999999925, 45.1, 40.70000000000002, 41.70000000000002, 43.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.10000000000001, 40.10000000000002, 6.299999999999649, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.099999999999973, 45.3, -50.00000000000044, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 45.3, 39.10000000000002, 43.7, 44.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.70000000000001, 32.90000000000003, 44.900000000000006, 41.90000000000001, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.10000000000002], "episode_lengths": [86, 220, 116, 500, 112, 92, 500, 416, 62, 500, 66, 182, 80, 500, 84, 94, 94, 500, 128, 64, 500, 418, 42, 500, 110, 72, 500, 500, 146, 282, 92, 168, 500, 56, 244, 50, 94, 84, 68, 126, 500, 500, 46, 500, 500, 500, 248, 48, 500, 92, 500, 100, 500, 80, 100, 438, 76, 500, 500, 76, 268, 500, 500, 500, 500, 80, 210, 48, 500, 74, 102, 500, 500, 72, 120, 500, 500, 500, 102, 68, 302, 500, 500, 48, 110, 64, 52, 104, 500, 500, 78, 184, 172, 52, 82, 500, 46, 44, 500, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38059721508287564, "mean_inference_ms": 1.2117298887588646, "mean_action_processing_ms": 0.1414874654710202, "mean_env_wait_ms": 0.08395321428380692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208733558654785, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.12962079048156738}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.219999999999834, "episode_len_mean": 258.44, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 28.09999999999996, 38.50000000000003, -50.00000000000044, 38.90000000000002, 40.90000000000002, -50.00000000000044, 8.49999999999968, 43.900000000000006, -50.00000000000044, 43.50000000000001, 31.900000000000013, 42.10000000000001, -50.00000000000044, 41.70000000000002, 40.70000000000002, 40.70000000000002, -50.00000000000044, 37.300000000000026, 43.7, -50.00000000000044, 8.299999999999677, 45.9, -50.00000000000044, 39.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 21.89999999999987, 40.90000000000002, 33.30000000000003, -50.00000000000044, 44.5, 25.699999999999925, 45.1, 40.70000000000002, 41.70000000000002, 43.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.10000000000001, 40.10000000000002, 6.299999999999649, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.099999999999973, 45.3, -50.00000000000044, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 45.3, 39.10000000000002, 43.7, 44.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.70000000000001, 32.90000000000003, 44.900000000000006, 41.90000000000001, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.10000000000002], "episode_lengths": [86, 220, 116, 500, 112, 92, 500, 416, 62, 500, 66, 182, 80, 500, 84, 94, 94, 500, 128, 64, 500, 418, 42, 500, 110, 72, 500, 500, 146, 282, 92, 168, 500, 56, 244, 50, 94, 84, 68, 126, 500, 500, 46, 500, 500, 500, 248, 48, 500, 92, 500, 100, 500, 80, 100, 438, 76, 500, 500, 76, 268, 500, 500, 500, 500, 80, 210, 48, 500, 74, 102, 500, 500, 72, 120, 500, 500, 500, 102, 68, 302, 500, 500, 48, 110, 64, 52, 104, 500, 500, 78, 184, 172, 52, 82, 500, 46, 44, 500, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38059721508287564, "mean_inference_ms": 1.2117298887588646, "mean_action_processing_ms": 0.1414874654710202, "mean_env_wait_ms": 0.08395321428380692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208733558654785, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.12962079048156738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5663.5470354952, "num_env_steps_trained_throughput_per_sec": 5663.5470354952, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2165.979, "sample_time_ms": 1961.327, "load_time_ms": 12.809, "load_throughput": 936854.186, "learn_time_ms": 179.682, "learn_throughput": 66784.629, "synch_weights_time_ms": 10.66}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 454, "training_iteration": 11, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-03", "timestamp": 1698249723, "time_this_iter_s": 2.123807907104492, "time_total_s": 23.6677405834198, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.6677405834198, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 8.705643971761068, "policy_loss": -0.0004493362373775906, "vf_loss": 8.706154717339409, "vf_explained_var": -9.828143649631076e-06, "kl": 0.0005225628594745205, "entropy": 0.6164930595291985, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.059999999999832, "episode_len_mean": 260.04, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.10000000000002, -50.00000000000044, 42.10000000000001, 40.10000000000002, 6.299999999999649, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.099999999999973, 45.3, -50.00000000000044, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 45.3, 39.10000000000002, 43.7, 44.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.70000000000001, 32.90000000000003, 44.900000000000006, 41.90000000000001, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 42.30000000000001, 40.70000000000002, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.100000000000016, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 47.5, 26.09999999999993, 40.70000000000002, -50.00000000000044, 45.7, 38.700000000000024, 41.70000000000002, 46.9, -50.00000000000044, 43.900000000000006, 35.30000000000004, 11.29999999999972, 43.50000000000001, 39.10000000000002, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 44.7, 31.70000000000001, 10.099999999999703, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.499999999999993, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 32.30000000000002, 37.50000000000003, -50.00000000000044], "episode_lengths": [500, 100, 500, 80, 100, 438, 76, 500, 500, 76, 268, 500, 500, 500, 500, 80, 210, 48, 500, 74, 102, 500, 500, 72, 120, 500, 500, 500, 102, 68, 302, 500, 500, 48, 110, 64, 52, 104, 500, 500, 78, 184, 172, 52, 82, 500, 46, 44, 500, 110, 500, 500, 304, 78, 94, 500, 262, 500, 500, 500, 158, 180, 500, 50, 50, 500, 26, 240, 94, 500, 44, 114, 84, 32, 500, 62, 148, 388, 66, 110, 254, 500, 46, 500, 54, 54, 184, 400, 112, 68, 184, 196, 60, 500, 500, 42, 500, 178, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3800526938951549, "mean_inference_ms": 1.213824393387061, "mean_action_processing_ms": 0.1414652601034765, "mean_env_wait_ms": 0.08386881766486212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023078441619873047, "StateBufferConnector_ms": 0.008998394012451172, "ViewRequirementAgentConnector_ms": 0.11446881294250488}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.059999999999832, "episode_len_mean": 260.04, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.10000000000002, -50.00000000000044, 42.10000000000001, 40.10000000000002, 6.299999999999649, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.099999999999973, 45.3, -50.00000000000044, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, 45.3, 39.10000000000002, 43.7, 44.900000000000006, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.70000000000001, 32.90000000000003, 44.900000000000006, 41.90000000000001, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 42.30000000000001, 40.70000000000002, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.100000000000016, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 47.5, 26.09999999999993, 40.70000000000002, -50.00000000000044, 45.7, 38.700000000000024, 41.70000000000002, 46.9, -50.00000000000044, 43.900000000000006, 35.30000000000004, 11.29999999999972, 43.50000000000001, 39.10000000000002, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 44.7, 31.70000000000001, 10.099999999999703, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.499999999999993, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 32.30000000000002, 37.50000000000003, -50.00000000000044], "episode_lengths": [500, 100, 500, 80, 100, 438, 76, 500, 500, 76, 268, 500, 500, 500, 500, 80, 210, 48, 500, 74, 102, 500, 500, 72, 120, 500, 500, 500, 102, 68, 302, 500, 500, 48, 110, 64, 52, 104, 500, 500, 78, 184, 172, 52, 82, 500, 46, 44, 500, 110, 500, 500, 304, 78, 94, 500, 262, 500, 500, 500, 158, 180, 500, 50, 50, 500, 26, 240, 94, 500, 44, 114, 84, 32, 500, 62, 148, 388, 66, 110, 254, 500, 46, 500, 54, 54, 184, 400, 112, 68, 184, 196, 60, 500, 500, 42, 500, 178, 126, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3800526938951549, "mean_inference_ms": 1.213824393387061, "mean_action_processing_ms": 0.1414652601034765, "mean_env_wait_ms": 0.08386881766486212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023078441619873047, "StateBufferConnector_ms": 0.008998394012451172, "ViewRequirementAgentConnector_ms": 0.11446881294250488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5497.70312108139, "num_env_steps_trained_throughput_per_sec": 5497.70312108139, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2188.952, "sample_time_ms": 1965.759, "load_time_ms": 13.583, "load_throughput": 883439.139, "learn_time_ms": 197.632, "learn_throughput": 60718.933, "synch_weights_time_ms": 10.575}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 504, "training_iteration": 12, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-05", "timestamp": 1698249725, "time_this_iter_s": 2.1885111331939697, "time_total_s": 25.85625171661377, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.85625171661377, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 61.166666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 8.66182412041558, "policy_loss": -0.00013309862050745223, "vf_loss": 8.66201040479872, "vf_explained_var": -7.245275709364149e-06, "kl": 0.00034829757669285755, "entropy": 0.5341770748297373, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.722999999999848, "episode_len_mean": 248.46, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, 32.90000000000003, 44.900000000000006, 41.90000000000001, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 42.30000000000001, 40.70000000000002, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.100000000000016, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 47.5, 26.09999999999993, 40.70000000000002, -50.00000000000044, 45.7, 38.700000000000024, 41.70000000000002, 46.9, -50.00000000000044, 43.900000000000006, 35.30000000000004, 11.29999999999972, 43.50000000000001, 39.10000000000002, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 44.7, 31.70000000000001, 10.099999999999703, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.499999999999993, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 32.30000000000002, 37.50000000000003, -50.00000000000044, 29.099999999999973, 35.10000000000004, 42.10000000000001, 42.30000000000001, 43.30000000000001, 41.90000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.900000000000006, 44.10000000000001, 5.299999999999635, 34.900000000000034, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, 19.899999999999842, 32.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 28.29999999999996, 44.300000000000004, -50.00000000000044, 13.499999999999751, 45.5, 24.899999999999913, -50.00000000000044, 32.90000000000003, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, 46.3, 34.50000000000004, 45.1, -50.00000000000044], "episode_lengths": [184, 172, 52, 82, 500, 46, 44, 500, 110, 500, 500, 304, 78, 94, 500, 262, 500, 500, 500, 158, 180, 500, 50, 50, 500, 26, 240, 94, 500, 44, 114, 84, 32, 500, 62, 148, 388, 66, 110, 254, 500, 46, 500, 54, 54, 184, 400, 112, 68, 184, 196, 60, 500, 500, 42, 500, 178, 126, 500, 210, 150, 80, 78, 68, 82, 500, 96, 500, 72, 60, 448, 152, 500, 500, 320, 500, 56, 62, 500, 302, 180, 500, 50, 500, 218, 58, 500, 366, 46, 252, 500, 172, 500, 216, 76, 500, 38, 156, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3807453126041711, "mean_inference_ms": 1.2148758419677579, "mean_action_processing_ms": 0.1413219624271832, "mean_env_wait_ms": 0.0839563911447491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.007995367050170898, "ViewRequirementAgentConnector_ms": 0.10001540184020996}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.722999999999848, "episode_len_mean": 248.46, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, 32.90000000000003, 44.900000000000006, 41.90000000000001, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, 42.30000000000001, 40.70000000000002, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 32.100000000000016, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 47.5, 26.09999999999993, 40.70000000000002, -50.00000000000044, 45.7, 38.700000000000024, 41.70000000000002, 46.9, -50.00000000000044, 43.900000000000006, 35.30000000000004, 11.29999999999972, 43.50000000000001, 39.10000000000002, 24.69999999999991, -50.00000000000044, 45.5, -50.00000000000044, 44.7, 44.7, 31.70000000000001, 10.099999999999703, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.499999999999993, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 32.30000000000002, 37.50000000000003, -50.00000000000044, 29.099999999999973, 35.10000000000004, 42.10000000000001, 42.30000000000001, 43.30000000000001, 41.90000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.900000000000006, 44.10000000000001, 5.299999999999635, 34.900000000000034, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, 19.899999999999842, 32.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 28.29999999999996, 44.300000000000004, -50.00000000000044, 13.499999999999751, 45.5, 24.899999999999913, -50.00000000000044, 32.90000000000003, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, 46.3, 34.50000000000004, 45.1, -50.00000000000044], "episode_lengths": [184, 172, 52, 82, 500, 46, 44, 500, 110, 500, 500, 304, 78, 94, 500, 262, 500, 500, 500, 158, 180, 500, 50, 50, 500, 26, 240, 94, 500, 44, 114, 84, 32, 500, 62, 148, 388, 66, 110, 254, 500, 46, 500, 54, 54, 184, 400, 112, 68, 184, 196, 60, 500, 500, 42, 500, 178, 126, 500, 210, 150, 80, 78, 68, 82, 500, 96, 500, 72, 60, 448, 152, 500, 500, 320, 500, 56, 62, 500, 302, 180, 500, 50, 500, 218, 58, 500, 366, 46, 252, 500, 172, 500, 216, 76, 500, 38, 156, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3807453126041711, "mean_inference_ms": 1.2148758419677579, "mean_action_processing_ms": 0.1413219624271832, "mean_env_wait_ms": 0.0839563911447491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.007995367050170898, "ViewRequirementAgentConnector_ms": 0.10001540184020996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5730.654181771811, "num_env_steps_trained_throughput_per_sec": 5730.654181771811, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2177.2, "sample_time_ms": 1964.969, "load_time_ms": 12.983, "load_throughput": 924276.249, "learn_time_ms": 187.44, "learn_throughput": 64020.531, "synch_weights_time_ms": 10.306}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 545, "training_iteration": 13, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-07", "timestamp": 1698249727, "time_this_iter_s": 2.1000115871429443, "time_total_s": 27.956263303756714, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 27.956263303756714, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 8.667159928215874, "policy_loss": 4.4564406077067055e-05, "vf_loss": 8.667166815863716, "vf_explained_var": -7.490317026774089e-06, "kl": 0.0001304866814027466, "entropy": 0.5127654241191016, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.812999999999835, "episode_len_mean": 247.54, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.30000000000002, 37.50000000000003, -50.00000000000044, 29.099999999999973, 35.10000000000004, 42.10000000000001, 42.30000000000001, 43.30000000000001, 41.90000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.900000000000006, 44.10000000000001, 5.299999999999635, 34.900000000000034, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, 19.899999999999842, 32.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 28.29999999999996, 44.300000000000004, -50.00000000000044, 13.499999999999751, 45.5, 24.899999999999913, -50.00000000000044, 32.90000000000003, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, 46.3, 34.50000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 39.300000000000026, 35.10000000000004, 42.10000000000001, -50.00000000000044, 41.100000000000016, 39.10000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 13.899999999999757, 45.5, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 46.099999999999994, -50.00000000000044, 45.7, 9.099999999999689, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, 44.300000000000004, 47.3, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, 46.099999999999994, 12.899999999999743, 35.30000000000004, 45.3, 43.30000000000001, 41.500000000000014, 46.3], "episode_lengths": [500, 178, 126, 500, 210, 150, 80, 78, 68, 82, 500, 96, 500, 72, 60, 448, 152, 500, 500, 320, 500, 56, 62, 500, 302, 180, 500, 50, 500, 218, 58, 500, 366, 46, 252, 500, 172, 500, 216, 76, 500, 38, 156, 50, 500, 500, 500, 36, 500, 96, 40, 108, 150, 80, 500, 90, 110, 500, 40, 58, 500, 362, 46, 500, 32, 56, 500, 40, 500, 192, 40, 500, 44, 410, 68, 500, 500, 68, 44, 58, 28, 500, 500, 292, 500, 34, 500, 500, 52, 46, 264, 500, 52, 40, 372, 148, 48, 68, 86, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808990955080669, "mean_inference_ms": 1.2149082091292303, "mean_action_processing_ms": 0.14077881403905132, "mean_env_wait_ms": 0.0838721642206447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499699592590332, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.12976408004760742}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.812999999999835, "episode_len_mean": 247.54, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.30000000000002, 37.50000000000003, -50.00000000000044, 29.099999999999973, 35.10000000000004, 42.10000000000001, 42.30000000000001, 43.30000000000001, 41.90000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.900000000000006, 44.10000000000001, 5.299999999999635, 34.900000000000034, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, 19.899999999999842, 32.100000000000016, -50.00000000000044, 45.1, -50.00000000000044, 28.29999999999996, 44.300000000000004, -50.00000000000044, 13.499999999999751, 45.5, 24.899999999999913, -50.00000000000044, 32.90000000000003, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, 46.3, 34.50000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 39.300000000000026, 35.10000000000004, 42.10000000000001, -50.00000000000044, 41.100000000000016, 39.10000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 13.899999999999757, 45.5, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 46.099999999999994, -50.00000000000044, 45.7, 9.099999999999689, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, 44.300000000000004, 47.3, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, 46.099999999999994, 12.899999999999743, 35.30000000000004, 45.3, 43.30000000000001, 41.500000000000014, 46.3], "episode_lengths": [500, 178, 126, 500, 210, 150, 80, 78, 68, 82, 500, 96, 500, 72, 60, 448, 152, 500, 500, 320, 500, 56, 62, 500, 302, 180, 500, 50, 500, 218, 58, 500, 366, 46, 252, 500, 172, 500, 216, 76, 500, 38, 156, 50, 500, 500, 500, 36, 500, 96, 40, 108, 150, 80, 500, 90, 110, 500, 40, 58, 500, 362, 46, 500, 32, 56, 500, 40, 500, 192, 40, 500, 44, 410, 68, 500, 500, 68, 44, 58, 28, 500, 500, 292, 500, 34, 500, 500, 52, 46, 264, 500, 52, 40, 372, 148, 48, 68, 86, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3808990955080669, "mean_inference_ms": 1.2149082091292303, "mean_action_processing_ms": 0.14077881403905132, "mean_env_wait_ms": 0.0838721642206447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499699592590332, "StateBufferConnector_ms": 0.0070035457611083984, "ViewRequirementAgentConnector_ms": 0.12976408004760742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5388.206669124627, "num_env_steps_trained_throughput_per_sec": 5388.206669124627, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2169.818, "sample_time_ms": 1963.734, "load_time_ms": 13.055, "load_throughput": 919161.842, "learn_time_ms": 181.305, "learn_throughput": 66186.654, "synch_weights_time_ms": 10.22}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 600, "training_iteration": 14, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-09", "timestamp": 1698249729, "time_this_iter_s": 2.232084035873413, "time_total_s": 30.188347339630127, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.188347339630127, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 64.46666666666665, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 8.372517691718208, "policy_loss": -0.00012446691592534384, "vf_loss": 8.372690200805664, "vf_explained_var": -4.914071824815538e-06, "kl": 3.5087797910035886e-05, "entropy": 0.4771403703424666, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.349999999999842, "episode_len_mean": 237.18, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 39.300000000000026, 35.10000000000004, 42.10000000000001, -50.00000000000044, 41.100000000000016, 39.10000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 13.899999999999757, 45.5, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 46.099999999999994, -50.00000000000044, 45.7, 9.099999999999689, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, 44.300000000000004, 47.3, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, 46.099999999999994, 12.899999999999743, 35.30000000000004, 45.3, 43.30000000000001, 41.500000000000014, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 40.30000000000002, 43.7, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 23.8999999999999, -50.00000000000044, -50.00000000000044, 42.10000000000001, 19.09999999999983, 47.3, -50.00000000000044, 43.900000000000006, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, 42.70000000000001, 36.30000000000003, 45.3, 39.70000000000002, 33.30000000000003, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, 24.899999999999913, 2.0999999999995893, 29.49999999999998], "episode_lengths": [36, 500, 96, 40, 108, 150, 80, 500, 90, 110, 500, 40, 58, 500, 362, 46, 500, 32, 56, 500, 40, 500, 192, 40, 500, 44, 410, 68, 500, 500, 68, 44, 58, 28, 500, 500, 292, 500, 34, 500, 500, 52, 46, 264, 500, 52, 40, 372, 148, 48, 68, 86, 38, 500, 56, 500, 82, 56, 500, 98, 64, 48, 500, 332, 500, 76, 500, 70, 44, 500, 118, 500, 136, 262, 500, 500, 80, 310, 28, 500, 62, 44, 66, 500, 500, 58, 192, 500, 74, 138, 48, 104, 168, 66, 64, 500, 500, 252, 480, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3816928898252892, "mean_inference_ms": 1.2158538720644745, "mean_action_processing_ms": 0.14066563769563822, "mean_env_wait_ms": 0.08399522651442631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002914428710938, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.11803460121154785}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.349999999999842, "episode_len_mean": 237.18, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 39.300000000000026, 35.10000000000004, 42.10000000000001, -50.00000000000044, 41.100000000000016, 39.10000000000002, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 13.899999999999757, 45.5, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 46.099999999999994, -50.00000000000044, 45.7, 9.099999999999689, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.7, 44.300000000000004, 47.3, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 23.699999999999896, -50.00000000000044, 44.900000000000006, 46.099999999999994, 12.899999999999743, 35.30000000000004, 45.3, 43.30000000000001, 41.500000000000014, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 40.30000000000002, 43.7, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 23.8999999999999, -50.00000000000044, -50.00000000000044, 42.10000000000001, 19.09999999999983, 47.3, -50.00000000000044, 43.900000000000006, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, 42.70000000000001, 36.30000000000003, 45.3, 39.70000000000002, 33.30000000000003, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, 24.899999999999913, 2.0999999999995893, 29.49999999999998], "episode_lengths": [36, 500, 96, 40, 108, 150, 80, 500, 90, 110, 500, 40, 58, 500, 362, 46, 500, 32, 56, 500, 40, 500, 192, 40, 500, 44, 410, 68, 500, 500, 68, 44, 58, 28, 500, 500, 292, 500, 34, 500, 500, 52, 46, 264, 500, 52, 40, 372, 148, 48, 68, 86, 38, 500, 56, 500, 82, 56, 500, 98, 64, 48, 500, 332, 500, 76, 500, 70, 44, 500, 118, 500, 136, 262, 500, 500, 80, 310, 28, 500, 62, 44, 66, 500, 500, 58, 192, 500, 74, 138, 48, 104, 168, 66, 64, 500, 500, 252, 480, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3816928898252892, "mean_inference_ms": 1.2158538720644745, "mean_action_processing_ms": 0.14066563769563822, "mean_env_wait_ms": 0.08399522651442631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002914428710938, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.11803460121154785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5972.331909813977, "num_env_steps_trained_throughput_per_sec": 5972.331909813977, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2161.323, "sample_time_ms": 1960.185, "load_time_ms": 12.93, "load_throughput": 928095.65, "learn_time_ms": 176.672, "learn_throughput": 67922.338, "synch_weights_time_ms": 10.033}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 647, "training_iteration": 15, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-11", "timestamp": 1698249731, "time_this_iter_s": 2.014263391494751, "time_total_s": 32.20261073112488, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.20261073112488, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 57.26666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 7.782282670338948, "policy_loss": -6.0236909323268465e-06, "vf_loss": 7.782339307996962, "vf_explained_var": 3.7286016676161025e-06, "kl": 7.838304593121848e-05, "entropy": 0.5050625138812594, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 140.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.613999999999841, "episode_len_mean": 244.52, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 41.500000000000014, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 40.30000000000002, 43.7, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 23.8999999999999, -50.00000000000044, -50.00000000000044, 42.10000000000001, 19.09999999999983, 47.3, -50.00000000000044, 43.900000000000006, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, 42.70000000000001, 36.30000000000003, 45.3, 39.70000000000002, 33.30000000000003, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, 24.899999999999913, 2.0999999999995893, 29.49999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 1.8999999999995865, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, -50.00000000000044, 31.500000000000007, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 43.10000000000001, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.900000000000013, 47.7, -50.00000000000044, 33.70000000000004, 41.30000000000001, 10.299999999999706, 46.3, 37.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.50000000000002, 35.900000000000034, 30.9, 45.7, 45.1, 44.5, 47.1, -50.00000000000044, 46.699999999999996], "episode_lengths": [68, 86, 38, 500, 56, 500, 82, 56, 500, 98, 64, 48, 500, 332, 500, 76, 500, 70, 44, 500, 118, 500, 136, 262, 500, 500, 80, 310, 28, 500, 62, 44, 66, 500, 500, 58, 192, 500, 74, 138, 48, 104, 168, 66, 64, 500, 500, 252, 480, 206, 500, 40, 500, 48, 500, 66, 482, 48, 500, 120, 500, 30, 500, 186, 100, 500, 500, 38, 500, 500, 500, 56, 500, 64, 70, 184, 38, 500, 500, 62, 182, 24, 500, 164, 88, 398, 38, 124, 500, 74, 500, 106, 142, 192, 44, 50, 56, 30, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38143173988385376, "mean_inference_ms": 1.2136825202234127, "mean_action_processing_ms": 0.13985624133590568, "mean_env_wait_ms": 0.08387560698229692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0290067195892334, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.1330726146697998}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.613999999999841, "episode_len_mean": 244.52, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 41.500000000000014, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 40.30000000000002, 43.7, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 42.500000000000014, -50.00000000000044, 43.10000000000001, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 23.8999999999999, -50.00000000000044, -50.00000000000044, 42.10000000000001, 19.09999999999983, 47.3, -50.00000000000044, 43.900000000000006, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 30.9, -50.00000000000044, 42.70000000000001, 36.30000000000003, 45.3, 39.70000000000002, 33.30000000000003, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, 24.899999999999913, 2.0999999999995893, 29.49999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 1.8999999999995865, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, -50.00000000000044, 31.500000000000007, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 43.10000000000001, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.900000000000013, 47.7, -50.00000000000044, 33.70000000000004, 41.30000000000001, 10.299999999999706, 46.3, 37.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.50000000000002, 35.900000000000034, 30.9, 45.7, 45.1, 44.5, 47.1, -50.00000000000044, 46.699999999999996], "episode_lengths": [68, 86, 38, 500, 56, 500, 82, 56, 500, 98, 64, 48, 500, 332, 500, 76, 500, 70, 44, 500, 118, 500, 136, 262, 500, 500, 80, 310, 28, 500, 62, 44, 66, 500, 500, 58, 192, 500, 74, 138, 48, 104, 168, 66, 64, 500, 500, 252, 480, 206, 500, 40, 500, 48, 500, 66, 482, 48, 500, 120, 500, 30, 500, 186, 100, 500, 500, 38, 500, 500, 500, 56, 500, 64, 70, 184, 38, 500, 500, 62, 182, 24, 500, 164, 88, 398, 38, 124, 500, 74, 500, 106, 142, 192, 44, 50, 56, 30, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38143173988385376, "mean_inference_ms": 1.2136825202234127, "mean_action_processing_ms": 0.13985624133590568, "mean_env_wait_ms": 0.08387560698229692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0290067195892334, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.1330726146697998}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5583.00355534613, "num_env_steps_trained_throughput_per_sec": 5583.00355534613, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2131.728, "sample_time_ms": 1930.861, "load_time_ms": 12.028, "load_throughput": 997693.625, "learn_time_ms": 177.337, "learn_throughput": 67667.964, "synch_weights_time_ms": 10.1}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 697, "training_iteration": 16, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-13", "timestamp": 1698249733, "time_this_iter_s": 2.155378818511963, "time_total_s": 34.35798954963684, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.35798954963684, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 63.43333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 7.866355260213216, "policy_loss": 1.8021298779381646e-05, "vf_loss": 7.866387420230442, "vf_explained_var": -1.099374559190538e-06, "kl": 2.2577933591616528e-05, "entropy": 0.5038938124974569, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.417999999999829, "episode_len_mean": 256.48, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 24.899999999999913, 2.0999999999995893, 29.49999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 1.8999999999995865, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, -50.00000000000044, 31.500000000000007, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 43.10000000000001, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.900000000000013, 47.7, -50.00000000000044, 33.70000000000004, 41.30000000000001, 10.299999999999706, 46.3, 37.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.50000000000002, 35.900000000000034, 30.9, 45.7, 45.1, 44.5, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.70000000000003, 44.900000000000006, 44.10000000000001, -50.00000000000044, 42.10000000000001, 40.90000000000002, -50.00000000000044, 40.90000000000002, 12.099999999999731, 10.499999999999709, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 47.7, 44.900000000000006, 34.900000000000034, 43.50000000000001, 43.7, 35.500000000000036, 5.499999999999638, 44.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 18.699999999999825, 41.500000000000014, 27.099999999999945, 44.5, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 35.70000000000003, 46.9, 42.500000000000014, -50.00000000000044, 36.10000000000004], "episode_lengths": [500, 500, 252, 480, 206, 500, 40, 500, 48, 500, 66, 482, 48, 500, 120, 500, 30, 500, 186, 100, 500, 500, 38, 500, 500, 500, 56, 500, 64, 70, 184, 38, 500, 500, 62, 182, 24, 500, 164, 88, 398, 38, 124, 500, 74, 500, 106, 142, 192, 44, 50, 56, 30, 500, 34, 500, 500, 500, 72, 80, 500, 124, 52, 60, 500, 80, 92, 500, 92, 380, 396, 80, 500, 500, 102, 500, 24, 52, 152, 66, 64, 146, 446, 60, 500, 446, 500, 314, 86, 230, 56, 108, 500, 80, 500, 144, 32, 76, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38031915096097846, "mean_inference_ms": 1.212124729963855, "mean_action_processing_ms": 0.1397823686660708, "mean_env_wait_ms": 0.08347201910164087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000640869140625, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.14706134796142578}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.417999999999829, "episode_len_mean": 256.48, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 24.899999999999913, 2.0999999999995893, 29.49999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 1.8999999999995865, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, -50.00000000000044, 31.500000000000007, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.7, 43.10000000000001, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.900000000000013, 47.7, -50.00000000000044, 33.70000000000004, 41.30000000000001, 10.299999999999706, 46.3, 37.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.50000000000002, 35.900000000000034, 30.9, 45.7, 45.1, 44.5, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.70000000000003, 44.900000000000006, 44.10000000000001, -50.00000000000044, 42.10000000000001, 40.90000000000002, -50.00000000000044, 40.90000000000002, 12.099999999999731, 10.499999999999709, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 47.7, 44.900000000000006, 34.900000000000034, 43.50000000000001, 43.7, 35.500000000000036, 5.499999999999638, 44.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 18.699999999999825, 41.500000000000014, 27.099999999999945, 44.5, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 35.70000000000003, 46.9, 42.500000000000014, -50.00000000000044, 36.10000000000004], "episode_lengths": [500, 500, 252, 480, 206, 500, 40, 500, 48, 500, 66, 482, 48, 500, 120, 500, 30, 500, 186, 100, 500, 500, 38, 500, 500, 500, 56, 500, 64, 70, 184, 38, 500, 500, 62, 182, 24, 500, 164, 88, 398, 38, 124, 500, 74, 500, 106, 142, 192, 44, 50, 56, 30, 500, 34, 500, 500, 500, 72, 80, 500, 124, 52, 60, 500, 80, 92, 500, 92, 380, 396, 80, 500, 500, 102, 500, 24, 52, 152, 66, 64, 146, 446, 60, 500, 446, 500, 314, 86, 230, 56, 108, 500, 80, 500, 144, 32, 76, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38031915096097846, "mean_inference_ms": 1.212124729963855, "mean_action_processing_ms": 0.1397823686660708, "mean_env_wait_ms": 0.08347201910164087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000640869140625, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.14706134796142578}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5962.98214694449, "num_env_steps_trained_throughput_per_sec": 5962.98214694449, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2130.716, "sample_time_ms": 1929.775, "load_time_ms": 11.918, "load_throughput": 1006878.638, "learn_time_ms": 177.437, "learn_throughput": 67629.776, "synch_weights_time_ms": 10.183}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 742, "training_iteration": 17, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-15", "timestamp": 1698249735, "time_this_iter_s": 2.018428087234497, "time_total_s": 36.37641763687134, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.37641763687134, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 59.633333333333326, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 6.89029582341512, "policy_loss": -1.1318259769015842e-05, "vf_loss": 6.890358024173313, "vf_explained_var": 1.5960799323187934e-06, "kl": 1.2813364025513843e-05, "entropy": 0.5102952851189507, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.854999999999817, "episode_len_mean": 267.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.299999999999706, 46.3, 37.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.50000000000002, 35.900000000000034, 30.9, 45.7, 45.1, 44.5, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.70000000000003, 44.900000000000006, 44.10000000000001, -50.00000000000044, 42.10000000000001, 40.90000000000002, -50.00000000000044, 40.90000000000002, 12.099999999999731, 10.499999999999709, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 47.7, 44.900000000000006, 34.900000000000034, 43.50000000000001, 43.7, 35.500000000000036, 5.499999999999638, 44.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 18.699999999999825, 41.500000000000014, 27.099999999999945, 44.5, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 35.70000000000003, 46.9, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.099999999999994, 43.10000000000001, 41.70000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 8.699999999999683, 45.9, 43.7, 34.900000000000034, 3.499999999999609, -50.00000000000044, 45.3, 42.30000000000001], "episode_lengths": [398, 38, 124, 500, 74, 500, 106, 142, 192, 44, 50, 56, 30, 500, 34, 500, 500, 500, 72, 80, 500, 124, 52, 60, 500, 80, 92, 500, 92, 380, 396, 80, 500, 500, 102, 500, 24, 52, 152, 66, 64, 146, 446, 60, 500, 446, 500, 314, 86, 230, 56, 108, 500, 80, 500, 144, 32, 76, 500, 140, 500, 40, 70, 84, 40, 62, 500, 500, 282, 500, 500, 130, 500, 142, 56, 500, 500, 94, 500, 500, 500, 500, 500, 206, 500, 58, 500, 500, 500, 500, 500, 60, 414, 42, 64, 152, 466, 500, 48, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37915312871491486, "mean_inference_ms": 1.21231804031475, "mean_action_processing_ms": 0.13975503535691788, "mean_env_wait_ms": 0.08345047181629894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.1399843692779541}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.854999999999817, "episode_len_mean": 267.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.299999999999706, 46.3, 37.70000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.50000000000002, 35.900000000000034, 30.9, 45.7, 45.1, 44.5, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.70000000000003, 44.900000000000006, 44.10000000000001, -50.00000000000044, 42.10000000000001, 40.90000000000002, -50.00000000000044, 40.90000000000002, 12.099999999999731, 10.499999999999709, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 47.7, 44.900000000000006, 34.900000000000034, 43.50000000000001, 43.7, 35.500000000000036, 5.499999999999638, 44.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 18.699999999999825, 41.500000000000014, 27.099999999999945, 44.5, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 35.70000000000003, 46.9, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.099999999999994, 43.10000000000001, 41.70000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 8.699999999999683, 45.9, 43.7, 34.900000000000034, 3.499999999999609, -50.00000000000044, 45.3, 42.30000000000001], "episode_lengths": [398, 38, 124, 500, 74, 500, 106, 142, 192, 44, 50, 56, 30, 500, 34, 500, 500, 500, 72, 80, 500, 124, 52, 60, 500, 80, 92, 500, 92, 380, 396, 80, 500, 500, 102, 500, 24, 52, 152, 66, 64, 146, 446, 60, 500, 446, 500, 314, 86, 230, 56, 108, 500, 80, 500, 144, 32, 76, 500, 140, 500, 40, 70, 84, 40, 62, 500, 500, 282, 500, 500, 130, 500, 142, 56, 500, 500, 94, 500, 500, 500, 500, 500, 206, 500, 58, 500, 500, 500, 500, 500, 60, 414, 42, 64, 152, 466, 500, 48, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37915312871491486, "mean_inference_ms": 1.21231804031475, "mean_action_processing_ms": 0.13975503535691788, "mean_env_wait_ms": 0.08345047181629894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.1399843692779541}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5680.980017668816, "num_env_steps_trained_throughput_per_sec": 5680.980017668816, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2123.536, "sample_time_ms": 1928.765, "load_time_ms": 11.318, "load_throughput": 1060258.726, "learn_time_ms": 171.77, "learn_throughput": 69860.686, "synch_weights_time_ms": 9.98}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 782, "training_iteration": 18, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-18", "timestamp": 1698249738, "time_this_iter_s": 2.1173150539398193, "time_total_s": 38.49373269081116, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.49373269081116, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 63.36666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 6.959528711107042, "policy_loss": -0.00032485152284304303, "vf_loss": 6.9599038230048285, "vf_explained_var": 5.960464477539063e-08, "kl": 0.00015901530918998534, "entropy": 0.5026258031527201, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8749999999998193, "episode_len_mean": 266.86, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 35.70000000000003, 46.9, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.099999999999994, 43.10000000000001, 41.70000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 8.699999999999683, 45.9, 43.7, 34.900000000000034, 3.499999999999609, -50.00000000000044, 45.3, 42.30000000000001, -50.00000000000044, 41.90000000000001, 37.50000000000003, 41.100000000000016, 26.499999999999936, -50.00000000000044, 45.7, 34.10000000000004, 31.300000000000004, -50.00000000000044, 40.10000000000002, 45.7, 37.10000000000003, 45.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 23.8999999999999, 37.90000000000003, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, 20.699999999999854, 45.7, 29.299999999999976, 43.50000000000001, -50.00000000000044, 37.70000000000003, 41.70000000000002, 42.30000000000001, 45.5, 12.299999999999734, 44.7, 40.30000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [108, 500, 80, 500, 144, 32, 76, 500, 140, 500, 40, 70, 84, 40, 62, 500, 500, 282, 500, 500, 130, 500, 142, 56, 500, 500, 94, 500, 500, 500, 500, 500, 206, 500, 58, 500, 500, 500, 500, 500, 60, 414, 42, 64, 152, 466, 500, 48, 78, 500, 82, 126, 90, 236, 500, 44, 160, 188, 500, 100, 44, 130, 46, 88, 52, 500, 500, 124, 500, 50, 500, 500, 42, 500, 70, 42, 500, 262, 122, 500, 50, 116, 500, 294, 44, 208, 66, 500, 124, 84, 78, 46, 378, 54, 98, 238, 500, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900231525878425, "mean_inference_ms": 1.2129966749838108, "mean_action_processing_ms": 0.13981331713458084, "mean_env_wait_ms": 0.08378588578045511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027003049850463867, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11999058723449707}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8749999999998193, "episode_len_mean": 266.86, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 35.70000000000003, 46.9, 42.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.099999999999994, 43.10000000000001, 41.70000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 8.699999999999683, 45.9, 43.7, 34.900000000000034, 3.499999999999609, -50.00000000000044, 45.3, 42.30000000000001, -50.00000000000044, 41.90000000000001, 37.50000000000003, 41.100000000000016, 26.499999999999936, -50.00000000000044, 45.7, 34.10000000000004, 31.300000000000004, -50.00000000000044, 40.10000000000002, 45.7, 37.10000000000003, 45.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 23.8999999999999, 37.90000000000003, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, 20.699999999999854, 45.7, 29.299999999999976, 43.50000000000001, -50.00000000000044, 37.70000000000003, 41.70000000000002, 42.30000000000001, 45.5, 12.299999999999734, 44.7, 40.30000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [108, 500, 80, 500, 144, 32, 76, 500, 140, 500, 40, 70, 84, 40, 62, 500, 500, 282, 500, 500, 130, 500, 142, 56, 500, 500, 94, 500, 500, 500, 500, 500, 206, 500, 58, 500, 500, 500, 500, 500, 60, 414, 42, 64, 152, 466, 500, 48, 78, 500, 82, 126, 90, 236, 500, 44, 160, 188, 500, 100, 44, 130, 46, 88, 52, 500, 500, 124, 500, 50, 500, 500, 42, 500, 70, 42, 500, 262, 122, 500, 50, 116, 500, 294, 44, 208, 66, 500, 124, 84, 78, 46, 378, 54, 98, 238, 500, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900231525878425, "mean_inference_ms": 1.2129966749838108, "mean_action_processing_ms": 0.13981331713458084, "mean_env_wait_ms": 0.08378588578045511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027003049850463867, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11999058723449707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5509.429046777385, "num_env_steps_trained_throughput_per_sec": 5509.429046777385, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2110.955, "sample_time_ms": 1926.547, "load_time_ms": 11.438, "load_throughput": 1049115.858, "learn_time_ms": 161.409, "learn_throughput": 74345.441, "synch_weights_time_ms": 9.959}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 833, "training_iteration": 19, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-20", "timestamp": 1698249740, "time_this_iter_s": 2.1830832958221436, "time_total_s": 40.6768159866333, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.6768159866333, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 59.29999999999999, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 6.843435605367024, "policy_loss": 7.123520804776085e-05, "vf_loss": 6.843417485555013, "vf_explained_var": -1.7484029134114583e-06, "kl": 7.119005062961037e-05, "entropy": 0.5314861436684927, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.890999999999841, "episode_len_mean": 246.74, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 41.90000000000001, 37.50000000000003, 41.100000000000016, 26.499999999999936, -50.00000000000044, 45.7, 34.10000000000004, 31.300000000000004, -50.00000000000044, 40.10000000000002, 45.7, 37.10000000000003, 45.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 23.8999999999999, 37.90000000000003, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, 20.699999999999854, 45.7, 29.299999999999976, 43.50000000000001, -50.00000000000044, 37.70000000000003, 41.70000000000002, 42.30000000000001, 45.5, 12.299999999999734, 44.7, 40.30000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 43.900000000000006, 28.09999999999996, 34.30000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.699999999999996, -50.00000000000044, 41.30000000000001, 44.300000000000004, 44.7, 34.900000000000034, 31.500000000000007, 43.900000000000006, 11.099999999999717, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.5, 44.300000000000004, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 500, 82, 126, 90, 236, 500, 44, 160, 188, 500, 100, 44, 130, 46, 88, 52, 500, 500, 124, 500, 50, 500, 500, 42, 500, 70, 42, 500, 262, 122, 500, 50, 116, 500, 294, 44, 208, 66, 500, 124, 84, 78, 46, 378, 54, 98, 238, 500, 500, 42, 500, 500, 500, 500, 30, 96, 52, 76, 60, 500, 500, 240, 500, 500, 54, 140, 62, 220, 158, 500, 500, 72, 500, 500, 150, 34, 500, 88, 58, 54, 152, 186, 62, 390, 128, 500, 500, 78, 500, 102, 500, 500, 88, 56, 58, 58, 76, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37981325212786354, "mean_inference_ms": 1.2139064489069284, "mean_action_processing_ms": 0.140641113447642, "mean_env_wait_ms": 0.083819438500509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034003496170043945, "StateBufferConnector_ms": 0.0045032501220703125, "ViewRequirementAgentConnector_ms": 0.11102032661437988}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.890999999999841, "episode_len_mean": 246.74, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 41.90000000000001, 37.50000000000003, 41.100000000000016, 26.499999999999936, -50.00000000000044, 45.7, 34.10000000000004, 31.300000000000004, -50.00000000000044, 40.10000000000002, 45.7, 37.10000000000003, 45.5, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 23.8999999999999, 37.90000000000003, -50.00000000000044, 45.1, 38.50000000000003, -50.00000000000044, 20.699999999999854, 45.7, 29.299999999999976, 43.50000000000001, -50.00000000000044, 37.70000000000003, 41.70000000000002, 42.30000000000001, 45.5, 12.299999999999734, 44.7, 40.30000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 43.900000000000006, 28.09999999999996, 34.30000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.699999999999996, -50.00000000000044, 41.30000000000001, 44.300000000000004, 44.7, 34.900000000000034, 31.500000000000007, 43.900000000000006, 11.099999999999717, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.5, 44.300000000000004, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 500, 82, 126, 90, 236, 500, 44, 160, 188, 500, 100, 44, 130, 46, 88, 52, 500, 500, 124, 500, 50, 500, 500, 42, 500, 70, 42, 500, 262, 122, 500, 50, 116, 500, 294, 44, 208, 66, 500, 124, 84, 78, 46, 378, 54, 98, 238, 500, 500, 42, 500, 500, 500, 500, 30, 96, 52, 76, 60, 500, 500, 240, 500, 500, 54, 140, 62, 220, 158, 500, 500, 72, 500, 500, 150, 34, 500, 88, 58, 54, 152, 186, 62, 390, 128, 500, 500, 78, 500, 102, 500, 500, 88, 56, 58, 58, 76, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37981325212786354, "mean_inference_ms": 1.2139064489069284, "mean_action_processing_ms": 0.140641113447642, "mean_env_wait_ms": 0.083819438500509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034003496170043945, "StateBufferConnector_ms": 0.0045032501220703125, "ViewRequirementAgentConnector_ms": 0.11102032661437988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5844.79188960359, "num_env_steps_trained_throughput_per_sec": 5844.79188960359, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2113.72, "sample_time_ms": 1924.596, "load_time_ms": 11.538, "load_throughput": 1040079.848, "learn_time_ms": 166.143, "learn_throughput": 72226.89, "synch_weights_time_ms": 9.64}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 881, "training_iteration": 20, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-22", "timestamp": 1698249742, "time_this_iter_s": 2.0591073036193848, "time_total_s": 42.735923290252686, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.735923290252686, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 59.56666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 6.411724991268581, "policy_loss": -0.0002560449971093072, "vf_loss": 6.4120354652404785, "vf_explained_var": 2.2252400716145835e-06, "kl": 0.00022428548335855995, "entropy": 0.5453349285655551, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.2659999999998295, "episode_len_mean": 257.98, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.299999999999734, 44.7, 40.30000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 43.900000000000006, 28.09999999999996, 34.30000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.699999999999996, -50.00000000000044, 41.30000000000001, 44.300000000000004, 44.7, 34.900000000000034, 31.500000000000007, 43.900000000000006, 11.099999999999717, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.5, 44.300000000000004, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 40.70000000000002, 38.10000000000002, -50.00000000000044, 30.499999999999993, 39.50000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.10000000000002, 42.500000000000014, 39.90000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.300000000000004, 44.10000000000001, 7.899999999999672, 44.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.70000000000002, 43.7, 36.50000000000003, 41.30000000000001, 45.3, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 32.700000000000024, 42.70000000000001, 42.900000000000006, 44.900000000000006], "episode_lengths": [378, 54, 98, 238, 500, 500, 42, 500, 500, 500, 500, 30, 96, 52, 76, 60, 500, 500, 240, 500, 500, 54, 140, 62, 220, 158, 500, 500, 72, 500, 500, 150, 34, 500, 88, 58, 54, 152, 186, 62, 390, 128, 500, 500, 78, 500, 102, 500, 500, 88, 56, 58, 58, 76, 500, 500, 500, 70, 28, 500, 144, 500, 94, 120, 500, 196, 106, 278, 500, 500, 464, 100, 76, 102, 500, 94, 500, 58, 60, 422, 56, 500, 500, 38, 500, 500, 440, 104, 64, 136, 88, 48, 108, 500, 44, 500, 174, 74, 72, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793893523616073, "mean_inference_ms": 1.2130765782371193, "mean_action_processing_ms": 0.14054853974074719, "mean_env_wait_ms": 0.0836032277471852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.007503509521484375, "ViewRequirementAgentConnector_ms": 0.11602950096130371}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.2659999999998295, "episode_len_mean": 257.98, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.299999999999734, 44.7, 40.30000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 43.900000000000006, 28.09999999999996, 34.30000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.699999999999996, -50.00000000000044, 41.30000000000001, 44.300000000000004, 44.7, 34.900000000000034, 31.500000000000007, 43.900000000000006, 11.099999999999717, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.5, 44.300000000000004, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 40.70000000000002, 38.10000000000002, -50.00000000000044, 30.499999999999993, 39.50000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.10000000000002, 42.500000000000014, 39.90000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.300000000000004, 44.10000000000001, 7.899999999999672, 44.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.70000000000002, 43.7, 36.50000000000003, 41.30000000000001, 45.3, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 32.700000000000024, 42.70000000000001, 42.900000000000006, 44.900000000000006], "episode_lengths": [378, 54, 98, 238, 500, 500, 42, 500, 500, 500, 500, 30, 96, 52, 76, 60, 500, 500, 240, 500, 500, 54, 140, 62, 220, 158, 500, 500, 72, 500, 500, 150, 34, 500, 88, 58, 54, 152, 186, 62, 390, 128, 500, 500, 78, 500, 102, 500, 500, 88, 56, 58, 58, 76, 500, 500, 500, 70, 28, 500, 144, 500, 94, 120, 500, 196, 106, 278, 500, 500, 464, 100, 76, 102, 500, 94, 500, 58, 60, 422, 56, 500, 500, 38, 500, 500, 440, 104, 64, 136, 88, 48, 108, 500, 44, 500, 174, 74, 72, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793893523616073, "mean_inference_ms": 1.2130765782371193, "mean_action_processing_ms": 0.14054853974074719, "mean_env_wait_ms": 0.0836032277471852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.007503509521484375, "ViewRequirementAgentConnector_ms": 0.11602950096130371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5252.465749993738, "num_env_steps_trained_throughput_per_sec": 5252.465749993738, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2130.303, "sample_time_ms": 1920.862, "load_time_ms": 12.354, "load_throughput": 971368.402, "learn_time_ms": 185.711, "learn_throughput": 64616.502, "synch_weights_time_ms": 9.499}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 925, "training_iteration": 21, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-24", "timestamp": 1698249744, "time_this_iter_s": 2.289638042449951, "time_total_s": 45.02556133270264, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.02556133270264, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 61.86666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 6.213386429680718, "policy_loss": -0.00016980038748847114, "vf_loss": 6.213608158959283, "vf_explained_var": -1.3907750447591147e-07, "kl": 0.00030651803551348975, "entropy": 0.519618786043591, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 194.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.371999999999814, "episode_len_mean": 266.88, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.5, 44.300000000000004, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 40.70000000000002, 38.10000000000002, -50.00000000000044, 30.499999999999993, 39.50000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.10000000000002, 42.500000000000014, 39.90000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.300000000000004, 44.10000000000001, 7.899999999999672, 44.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.70000000000002, 43.7, 36.50000000000003, 41.30000000000001, 45.3, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 32.700000000000024, 42.70000000000001, 42.900000000000006, 44.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044, 35.30000000000004, 37.90000000000003, 42.900000000000006, 45.5, 41.70000000000002, 44.7, -50.00000000000044, 45.9, 45.1, 38.300000000000026, 44.900000000000006, -50.00000000000044, 25.499999999999922, 39.90000000000002, 31.70000000000001, 41.500000000000014, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 78, 500, 102, 500, 500, 88, 56, 58, 58, 76, 500, 500, 500, 70, 28, 500, 144, 500, 94, 120, 500, 196, 106, 278, 500, 500, 464, 100, 76, 102, 500, 94, 500, 58, 60, 422, 56, 500, 500, 38, 500, 500, 440, 104, 64, 136, 88, 48, 108, 500, 44, 500, 174, 74, 72, 52, 500, 362, 500, 56, 500, 54, 500, 500, 500, 500, 500, 76, 500, 80, 60, 500, 148, 122, 72, 46, 84, 54, 500, 42, 50, 118, 52, 500, 246, 102, 184, 86, 74, 500, 54, 500, 500, 500, 40, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793521919260161, "mean_inference_ms": 1.2131467391871054, "mean_action_processing_ms": 0.1405586699231702, "mean_env_wait_ms": 0.08357573809544537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000284194946289, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.11499333381652832}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.371999999999814, "episode_len_mean": 266.88, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.5, 44.300000000000004, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 40.70000000000002, 38.10000000000002, -50.00000000000044, 30.499999999999993, 39.50000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.10000000000002, 42.500000000000014, 39.90000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 44.300000000000004, 44.10000000000001, 7.899999999999672, 44.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.70000000000002, 43.7, 36.50000000000003, 41.30000000000001, 45.3, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 32.700000000000024, 42.70000000000001, 42.900000000000006, 44.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044, 35.30000000000004, 37.90000000000003, 42.900000000000006, 45.5, 41.70000000000002, 44.7, -50.00000000000044, 45.9, 45.1, 38.300000000000026, 44.900000000000006, -50.00000000000044, 25.499999999999922, 39.90000000000002, 31.70000000000001, 41.500000000000014, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 78, 500, 102, 500, 500, 88, 56, 58, 58, 76, 500, 500, 500, 70, 28, 500, 144, 500, 94, 120, 500, 196, 106, 278, 500, 500, 464, 100, 76, 102, 500, 94, 500, 58, 60, 422, 56, 500, 500, 38, 500, 500, 440, 104, 64, 136, 88, 48, 108, 500, 44, 500, 174, 74, 72, 52, 500, 362, 500, 56, 500, 54, 500, 500, 500, 500, 500, 76, 500, 80, 60, 500, 148, 122, 72, 46, 84, 54, 500, 42, 50, 118, 52, 500, 246, 102, 184, 86, 74, 500, 54, 500, 500, 500, 40, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793521919260161, "mean_inference_ms": 1.2131467391871054, "mean_action_processing_ms": 0.1405586699231702, "mean_env_wait_ms": 0.08357573809544537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000284194946289, "StateBufferConnector_ms": 0.0069959163665771484, "ViewRequirementAgentConnector_ms": 0.11499333381652832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5843.762437761846, "num_env_steps_trained_throughput_per_sec": 5843.762437761846, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2117.377, "sample_time_ms": 1924.95, "load_time_ms": 11.38, "load_throughput": 1054456.793, "learn_time_ms": 169.699, "learn_throughput": 70713.38, "synch_weights_time_ms": 9.472}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 967, "training_iteration": 22, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-26", "timestamp": 1698249746, "time_this_iter_s": 2.0584805011749268, "time_total_s": 47.08404183387756, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.08404183387756, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 5.95179197523329, "policy_loss": 0.00013046421938472323, "vf_loss": 5.951713562011719, "vf_explained_var": -2.4371676974826387e-06, "kl": 3.829499472532108e-05, "entropy": 0.5204122894340091, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.451999999999815, "episode_len_mean": 266.08, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 6.099999999999646, 39.70000000000002, 43.7, 36.50000000000003, 41.30000000000001, 45.3, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 32.700000000000024, 42.70000000000001, 42.900000000000006, 44.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044, 35.30000000000004, 37.90000000000003, 42.900000000000006, 45.5, 41.70000000000002, 44.7, -50.00000000000044, 45.9, 45.1, 38.300000000000026, 44.900000000000006, -50.00000000000044, 25.499999999999922, 39.90000000000002, 31.70000000000001, 41.500000000000014, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.299999999999848, 41.100000000000016, -50.00000000000044, 19.499999999999837, 40.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 43.900000000000006, 46.099999999999994, 27.699999999999953, 31.70000000000001, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 36.900000000000034, -50.00000000000044, 25.699999999999925, -50.00000000000044], "episode_lengths": [500, 500, 440, 104, 64, 136, 88, 48, 108, 500, 44, 500, 174, 74, 72, 52, 500, 362, 500, 56, 500, 54, 500, 500, 500, 500, 500, 76, 500, 80, 60, 500, 148, 122, 72, 46, 84, 54, 500, 42, 50, 118, 52, 500, 246, 102, 184, 86, 74, 500, 54, 500, 500, 500, 40, 500, 500, 500, 500, 336, 38, 500, 82, 500, 500, 500, 500, 72, 298, 90, 500, 306, 98, 50, 500, 90, 80, 500, 62, 40, 224, 184, 48, 500, 30, 500, 42, 82, 32, 140, 500, 500, 86, 500, 500, 56, 132, 500, 244, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796156145063273, "mean_inference_ms": 1.2131818916814832, "mean_action_processing_ms": 0.1404745174979397, "mean_env_wait_ms": 0.0836509896981518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180056095123291, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.11999654769897461}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.451999999999815, "episode_len_mean": 266.08, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 6.099999999999646, 39.70000000000002, 43.7, 36.50000000000003, 41.30000000000001, 45.3, 39.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 32.700000000000024, 42.70000000000001, 42.900000000000006, 44.900000000000006, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 44.10000000000001, -50.00000000000044, 35.30000000000004, 37.90000000000003, 42.900000000000006, 45.5, 41.70000000000002, 44.7, -50.00000000000044, 45.9, 45.1, 38.300000000000026, 44.900000000000006, -50.00000000000044, 25.499999999999922, 39.90000000000002, 31.70000000000001, 41.500000000000014, 42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.299999999999848, 41.100000000000016, -50.00000000000044, 19.499999999999837, 40.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 43.900000000000006, 46.099999999999994, 27.699999999999953, 31.70000000000001, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 36.900000000000034, -50.00000000000044, 25.699999999999925, -50.00000000000044], "episode_lengths": [500, 500, 440, 104, 64, 136, 88, 48, 108, 500, 44, 500, 174, 74, 72, 52, 500, 362, 500, 56, 500, 54, 500, 500, 500, 500, 500, 76, 500, 80, 60, 500, 148, 122, 72, 46, 84, 54, 500, 42, 50, 118, 52, 500, 246, 102, 184, 86, 74, 500, 54, 500, 500, 500, 40, 500, 500, 500, 500, 336, 38, 500, 82, 500, 500, 500, 500, 72, 298, 90, 500, 306, 98, 50, 500, 90, 80, 500, 62, 40, 224, 184, 48, 500, 30, 500, 42, 82, 32, 140, 500, 500, 86, 500, 500, 56, 132, 500, 244, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796156145063273, "mean_inference_ms": 1.2131818916814832, "mean_action_processing_ms": 0.1404745174979397, "mean_env_wait_ms": 0.0836509896981518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0180056095123291, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.11999654769897461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5710.959133995955, "num_env_steps_trained_throughput_per_sec": 5710.959133995955, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2118.099, "sample_time_ms": 1922.027, "load_time_ms": 11.18, "load_throughput": 1073329.665, "learn_time_ms": 173.645, "learn_throughput": 69106.598, "synch_weights_time_ms": 9.471}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1009, "training_iteration": 23, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-28", "timestamp": 1698249748, "time_this_iter_s": 2.1072206497192383, "time_total_s": 49.1912624835968, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.1912624835968, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 63.666666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 5.825022273593479, "policy_loss": -2.2190312544504803e-05, "vf_loss": 5.825094434950087, "vf_explained_var": -2.0662943522135415e-06, "kl": 9.34996432909606e-06, "entropy": 0.4998089075088501, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 212.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8149999999998065, "episode_len_mean": 267.42, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.299999999999848, 41.100000000000016, -50.00000000000044, 19.499999999999837, 40.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 43.900000000000006, 46.099999999999994, 27.699999999999953, 31.70000000000001, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 36.900000000000034, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.70000000000001, 22.49999999999988, 47.1, -50.00000000000044, 45.3, 44.7, 46.699999999999996, 45.1, 45.1, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 35.70000000000003, 45.1, 46.5, 44.300000000000004, 37.300000000000026, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 46.9, 38.10000000000002], "episode_lengths": [74, 500, 54, 500, 500, 500, 40, 500, 500, 500, 500, 336, 38, 500, 82, 500, 500, 500, 500, 72, 298, 90, 500, 306, 98, 50, 500, 90, 80, 500, 62, 40, 224, 184, 48, 500, 30, 500, 42, 82, 32, 140, 500, 500, 86, 500, 500, 56, 132, 500, 244, 500, 500, 500, 500, 74, 40, 500, 500, 500, 500, 56, 500, 500, 500, 68, 180, 500, 74, 276, 30, 500, 48, 54, 34, 50, 50, 50, 98, 500, 500, 500, 58, 500, 36, 24, 500, 144, 50, 36, 58, 128, 50, 50, 500, 500, 78, 86, 32, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37907050489199845, "mean_inference_ms": 1.2135777471735623, "mean_action_processing_ms": 0.14050349706347984, "mean_env_wait_ms": 0.08360070760816866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200045108795166, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.12000370025634766}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8149999999998065, "episode_len_mean": 267.42, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 20.299999999999848, 41.100000000000016, -50.00000000000044, 19.499999999999837, 40.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 43.900000000000006, 46.099999999999994, 27.699999999999953, 31.70000000000001, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 36.900000000000034, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.70000000000001, 22.49999999999988, 47.1, -50.00000000000044, 45.3, 44.7, 46.699999999999996, 45.1, 45.1, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 35.70000000000003, 45.1, 46.5, 44.300000000000004, 37.300000000000026, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 46.9, 38.10000000000002], "episode_lengths": [74, 500, 54, 500, 500, 500, 40, 500, 500, 500, 500, 336, 38, 500, 82, 500, 500, 500, 500, 72, 298, 90, 500, 306, 98, 50, 500, 90, 80, 500, 62, 40, 224, 184, 48, 500, 30, 500, 42, 82, 32, 140, 500, 500, 86, 500, 500, 56, 132, 500, 244, 500, 500, 500, 500, 74, 40, 500, 500, 500, 500, 56, 500, 500, 500, 68, 180, 500, 74, 276, 30, 500, 48, 54, 34, 50, 50, 50, 98, 500, 500, 500, 58, 500, 36, 24, 500, 144, 50, 36, 58, 128, 50, 50, 500, 500, 78, 86, 32, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37907050489199845, "mean_inference_ms": 1.2135777471735623, "mean_action_processing_ms": 0.14050349706347984, "mean_env_wait_ms": 0.08360070760816866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200045108795166, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.12000370025634766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5542.212592886556, "num_env_steps_trained_throughput_per_sec": 5542.212592886556, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2111.91, "sample_time_ms": 1916.973, "load_time_ms": 11.091, "load_throughput": 1081940.335, "learn_time_ms": 172.425, "learn_throughput": 69595.281, "synch_weights_time_ms": 9.544}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1057, "training_iteration": 24, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-31", "timestamp": 1698249751, "time_this_iter_s": 2.1691958904266357, "time_total_s": 51.36045837402344, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.36045837402344, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 63.06666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 5.6879515118069115, "policy_loss": -0.00010698381811380386, "vf_loss": 5.688106695810954, "vf_explained_var": -5.430645412868923e-07, "kl": 6.284019819307534e-05, "entropy": 0.4835637840959761, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.384000000000214, "episode_len_mean": 284.36, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 36.900000000000034, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.70000000000001, 22.49999999999988, 47.1, -50.00000000000044, 45.3, 44.7, 46.699999999999996, 45.1, 45.1, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 35.70000000000003, 45.1, 46.5, 44.300000000000004, 37.300000000000026, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 30.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 9.099999999999689, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 500, 42, 82, 32, 140, 500, 500, 86, 500, 500, 56, 132, 500, 244, 500, 500, 500, 500, 74, 40, 500, 500, 500, 500, 56, 500, 500, 500, 68, 180, 500, 74, 276, 30, 500, 48, 54, 34, 50, 50, 50, 98, 500, 500, 500, 58, 500, 36, 24, 500, 144, 50, 36, 58, 128, 50, 50, 500, 500, 78, 86, 32, 120, 500, 500, 500, 130, 500, 500, 46, 500, 32, 192, 500, 60, 500, 118, 500, 500, 50, 46, 500, 154, 500, 500, 500, 500, 500, 50, 500, 88, 500, 500, 48, 410, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37862086770294257, "mean_inference_ms": 1.2146516659582276, "mean_action_processing_ms": 0.14059418077564062, "mean_env_wait_ms": 0.08361253586104236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005123138427734, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11199355125427246}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.384000000000214, "episode_len_mean": 284.36, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 36.900000000000034, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 32.100000000000016, -50.00000000000044, 42.70000000000001, 22.49999999999988, 47.1, -50.00000000000044, 45.3, 44.7, 46.699999999999996, 45.1, 45.1, 45.1, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.5, 47.7, -50.00000000000044, 35.70000000000003, 45.1, 46.5, 44.300000000000004, 37.300000000000026, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 30.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 9.099999999999689, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 500, 42, 82, 32, 140, 500, 500, 86, 500, 500, 56, 132, 500, 244, 500, 500, 500, 500, 74, 40, 500, 500, 500, 500, 56, 500, 500, 500, 68, 180, 500, 74, 276, 30, 500, 48, 54, 34, 50, 50, 50, 98, 500, 500, 500, 58, 500, 36, 24, 500, 144, 50, 36, 58, 128, 50, 50, 500, 500, 78, 86, 32, 120, 500, 500, 500, 130, 500, 500, 46, 500, 32, 192, 500, 60, 500, 118, 500, 500, 50, 46, 500, 154, 500, 500, 500, 500, 500, 50, 500, 88, 500, 500, 48, 410, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37862086770294257, "mean_inference_ms": 1.2146516659582276, "mean_action_processing_ms": 0.14059418077564062, "mean_env_wait_ms": 0.08361253586104236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005123138427734, "StateBufferConnector_ms": 0.0019989013671875, "ViewRequirementAgentConnector_ms": 0.11199355125427246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5767.278839890204, "num_env_steps_trained_throughput_per_sec": 5767.278839890204, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2119.054, "sample_time_ms": 1919.266, "load_time_ms": 11.192, "load_throughput": 1072211.564, "learn_time_ms": 177.165, "learn_throughput": 67733.357, "synch_weights_time_ms": 9.455}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1093, "training_iteration": 25, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-33", "timestamp": 1698249753, "time_this_iter_s": 2.0866966247558594, "time_total_s": 53.4471549987793, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.4471549987793, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 6.874280505710178, "policy_loss": -0.0002662854062186347, "vf_loss": 6.874597072601318, "vf_explained_var": -3.337860107421875e-06, "kl": 0.0002535357736645791, "entropy": 0.5005188783009847, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3069999999998039, "episode_len_mean": 272.5, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, 45.1, 46.5, 44.300000000000004, 37.300000000000026, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 30.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 9.099999999999689, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 28.499999999999964, 21.699999999999868, 33.30000000000003, 45.9, 44.900000000000006, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.29999999999996, 42.30000000000001, 16.8999999999998, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 43.50000000000001, 44.900000000000006, 38.50000000000003, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.4999999999995808, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044], "episode_lengths": [144, 50, 36, 58, 128, 50, 50, 500, 500, 78, 86, 32, 120, 500, 500, 500, 130, 500, 500, 46, 500, 32, 192, 500, 60, 500, 118, 500, 500, 50, 46, 500, 154, 500, 500, 500, 500, 500, 50, 500, 88, 500, 500, 48, 410, 500, 36, 500, 500, 500, 54, 216, 284, 168, 42, 52, 500, 48, 74, 500, 66, 80, 500, 88, 72, 500, 500, 500, 104, 500, 218, 78, 332, 500, 46, 76, 500, 42, 36, 66, 52, 116, 500, 66, 46, 500, 80, 94, 62, 500, 500, 42, 500, 98, 500, 486, 500, 500, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37821047296027904, "mean_inference_ms": 1.2128329525192765, "mean_action_processing_ms": 0.14020487144459898, "mean_env_wait_ms": 0.08360393607810251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199625015258789, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.1407787799835205}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3069999999998039, "episode_len_mean": 272.5, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, 45.1, 46.5, 44.300000000000004, 37.300000000000026, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 41.500000000000014, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 30.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 9.099999999999689, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 28.499999999999964, 21.699999999999868, 33.30000000000003, 45.9, 44.900000000000006, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.29999999999996, 42.30000000000001, 16.8999999999998, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 43.50000000000001, 44.900000000000006, 38.50000000000003, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.4999999999995808, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044], "episode_lengths": [144, 50, 36, 58, 128, 50, 50, 500, 500, 78, 86, 32, 120, 500, 500, 500, 130, 500, 500, 46, 500, 32, 192, 500, 60, 500, 118, 500, 500, 50, 46, 500, 154, 500, 500, 500, 500, 500, 50, 500, 88, 500, 500, 48, 410, 500, 36, 500, 500, 500, 54, 216, 284, 168, 42, 52, 500, 48, 74, 500, 66, 80, 500, 88, 72, 500, 500, 500, 104, 500, 218, 78, 332, 500, 46, 76, 500, 42, 36, 66, 52, 116, 500, 66, 46, 500, 80, 94, 62, 500, 500, 42, 500, 98, 500, 486, 500, 500, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37821047296027904, "mean_inference_ms": 1.2128329525192765, "mean_action_processing_ms": 0.14020487144459898, "mean_env_wait_ms": 0.08360393607810251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199625015258789, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.1407787799835205}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5360.764895286377, "num_env_steps_trained_throughput_per_sec": 5360.764895286377, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2127.965, "sample_time_ms": 1922.036, "load_time_ms": 12.095, "load_throughput": 992104.581, "learn_time_ms": 182.368, "learn_throughput": 65800.952, "synch_weights_time_ms": 9.389}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1144, "training_iteration": 26, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-35", "timestamp": 1698249755, "time_this_iter_s": 2.2439680099487305, "time_total_s": 55.69112300872803, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.69112300872803, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 6.447647200690375, "policy_loss": -0.00019598897132608626, "vf_loss": 6.447895950741238, "vf_explained_var": -2.914004855685764e-07, "kl": 0.0003124160910298694, "entropy": 0.5263299445311228, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.57899999999981, "episode_len_mean": 269.82, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 9.099999999999689, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 28.499999999999964, 21.699999999999868, 33.30000000000003, 45.9, 44.900000000000006, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.29999999999996, 42.30000000000001, 16.8999999999998, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 43.50000000000001, 44.900000000000006, 38.50000000000003, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.4999999999995808, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.5, 35.70000000000003, 44.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 43.900000000000006, 43.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, 19.499999999999837, 46.3, 44.900000000000006, 43.30000000000001, 16.699999999999797, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 0.49999999999956657, 45.7, -50.00000000000044, 38.50000000000003, 45.7, 43.30000000000001, 42.500000000000014, 40.500000000000014, -50.00000000000044], "episode_lengths": [48, 410, 500, 36, 500, 500, 500, 54, 216, 284, 168, 42, 52, 500, 48, 74, 500, 66, 80, 500, 88, 72, 500, 500, 500, 104, 500, 218, 78, 332, 500, 46, 76, 500, 42, 36, 66, 52, 116, 500, 66, 46, 500, 80, 94, 62, 500, 500, 42, 500, 98, 500, 486, 500, 500, 74, 500, 500, 114, 56, 144, 54, 500, 42, 500, 500, 500, 174, 500, 136, 106, 500, 500, 500, 500, 500, 286, 62, 62, 254, 500, 500, 306, 38, 52, 68, 334, 500, 244, 500, 58, 496, 44, 500, 116, 44, 68, 76, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378151230241799, "mean_inference_ms": 1.2184391649344877, "mean_action_processing_ms": 0.1397663314522125, "mean_env_wait_ms": 0.08398464435316758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198122978210449, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.121795654296875}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.57899999999981, "episode_len_mean": 269.82, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 9.099999999999689, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 28.499999999999964, 21.699999999999868, 33.30000000000003, 45.9, 44.900000000000006, -50.00000000000044, 45.3, 42.70000000000001, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.29999999999996, 42.30000000000001, 16.8999999999998, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 43.50000000000001, 44.900000000000006, 38.50000000000003, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.4999999999995808, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.5, 35.70000000000003, 44.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 43.900000000000006, 43.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, 19.499999999999837, 46.3, 44.900000000000006, 43.30000000000001, 16.699999999999797, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 0.49999999999956657, 45.7, -50.00000000000044, 38.50000000000003, 45.7, 43.30000000000001, 42.500000000000014, 40.500000000000014, -50.00000000000044], "episode_lengths": [48, 410, 500, 36, 500, 500, 500, 54, 216, 284, 168, 42, 52, 500, 48, 74, 500, 66, 80, 500, 88, 72, 500, 500, 500, 104, 500, 218, 78, 332, 500, 46, 76, 500, 42, 36, 66, 52, 116, 500, 66, 46, 500, 80, 94, 62, 500, 500, 42, 500, 98, 500, 486, 500, 500, 74, 500, 500, 114, 56, 144, 54, 500, 42, 500, 500, 500, 174, 500, 136, 106, 500, 500, 500, 500, 500, 286, 62, 62, 254, 500, 500, 306, 38, 52, 68, 334, 500, 244, 500, 58, 496, 44, 500, 116, 44, 68, 76, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378151230241799, "mean_inference_ms": 1.2184391649344877, "mean_action_processing_ms": 0.1397663314522125, "mean_env_wait_ms": 0.08398464435316758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198122978210449, "StateBufferConnector_ms": 0.00799870491027832, "ViewRequirementAgentConnector_ms": 0.121795654296875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4573.575359295149, "num_env_steps_trained_throughput_per_sec": 4573.575359295149, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2189.1, "sample_time_ms": 1981.971, "load_time_ms": 12.12, "load_throughput": 990104.161, "learn_time_ms": 183.615, "learn_throughput": 65354.191, "synch_weights_time_ms": 9.318}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1187, "training_iteration": 27, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-38", "timestamp": 1698249758, "time_this_iter_s": 2.628765344619751, "time_total_s": 58.31988835334778, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.31988835334778, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 6.80488125483195, "policy_loss": 5.786472724543678e-05, "vf_loss": 6.804880036248101, "vf_explained_var": -1.4636251661512588e-06, "kl": 0.00026286515554198157, "entropy": 0.5667113131946988, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7499999999998175, "episode_len_mean": 273.12, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, 1.4999999999995808, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.5, 35.70000000000003, 44.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 43.900000000000006, 43.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, 19.499999999999837, 46.3, 44.900000000000006, 43.30000000000001, 16.699999999999797, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 0.49999999999956657, 45.7, -50.00000000000044, 38.50000000000003, 45.7, 43.30000000000001, 42.500000000000014, 40.500000000000014, -50.00000000000044, 21.499999999999865, 41.70000000000002, -50.00000000000044, 31.500000000000007, 44.10000000000001, 46.099999999999994, -50.00000000000044, 35.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.699999999999996, 42.10000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.50000000000004, 36.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 42.30000000000001, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003], "episode_lengths": [500, 98, 500, 486, 500, 500, 74, 500, 500, 114, 56, 144, 54, 500, 42, 500, 500, 500, 174, 500, 136, 106, 500, 500, 500, 500, 500, 286, 62, 62, 254, 500, 500, 306, 38, 52, 68, 334, 500, 244, 500, 58, 496, 44, 500, 116, 44, 68, 76, 96, 500, 286, 84, 500, 186, 60, 40, 500, 142, 98, 72, 36, 500, 124, 140, 194, 80, 178, 98, 500, 74, 500, 80, 88, 64, 244, 500, 500, 154, 156, 134, 50, 500, 500, 232, 54, 500, 32, 500, 78, 432, 500, 500, 500, 44, 62, 206, 500, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777901537844305, "mean_inference_ms": 1.225688068672537, "mean_action_processing_ms": 0.13988084531007572, "mean_env_wait_ms": 0.08416925746692654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031738996505737305, "StateBufferConnector_ms": 0.0051577091217041016, "ViewRequirementAgentConnector_ms": 0.09830451011657715}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7499999999998175, "episode_len_mean": 273.12, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, 1.4999999999995808, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.5, 35.70000000000003, 44.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.50000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 43.900000000000006, 43.900000000000006, 24.69999999999991, -50.00000000000044, -50.00000000000044, 19.499999999999837, 46.3, 44.900000000000006, 43.30000000000001, 16.699999999999797, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 0.49999999999956657, 45.7, -50.00000000000044, 38.50000000000003, 45.7, 43.30000000000001, 42.500000000000014, 40.500000000000014, -50.00000000000044, 21.499999999999865, 41.70000000000002, -50.00000000000044, 31.500000000000007, 44.10000000000001, 46.099999999999994, -50.00000000000044, 35.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.699999999999996, 42.10000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.50000000000004, 36.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 42.30000000000001, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003], "episode_lengths": [500, 98, 500, 486, 500, 500, 74, 500, 500, 114, 56, 144, 54, 500, 42, 500, 500, 500, 174, 500, 136, 106, 500, 500, 500, 500, 500, 286, 62, 62, 254, 500, 500, 306, 38, 52, 68, 334, 500, 244, 500, 58, 496, 44, 500, 116, 44, 68, 76, 96, 500, 286, 84, 500, 186, 60, 40, 500, 142, 98, 72, 36, 500, 124, 140, 194, 80, 178, 98, 500, 74, 500, 80, 88, 64, 244, 500, 500, 154, 156, 134, 50, 500, 500, 232, 54, 500, 32, 500, 78, 432, 500, 500, 500, 44, 62, 206, 500, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777901537844305, "mean_inference_ms": 1.225688068672537, "mean_action_processing_ms": 0.13988084531007572, "mean_env_wait_ms": 0.08416925746692654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031738996505737305, "StateBufferConnector_ms": 0.0051577091217041016, "ViewRequirementAgentConnector_ms": 0.09830451011657715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5606.659954787271, "num_env_steps_trained_throughput_per_sec": 5606.659954787271, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2191.9, "sample_time_ms": 1981.913, "load_time_ms": 12.696, "load_throughput": 945209.468, "learn_time_ms": 186.097, "learn_throughput": 64482.36, "synch_weights_time_ms": 9.318}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1236, "training_iteration": 28, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-40", "timestamp": 1698249760, "time_this_iter_s": 2.145311117172241, "time_total_s": 60.46519947052002, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.46519947052002, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 61.6, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 6.678451326158312, "policy_loss": -0.0002684202045202255, "vf_loss": 6.678772078620063, "vf_explained_var": -1.1391109890407986e-06, "kl": 0.00017982849701386131, "entropy": 0.5257350901762644, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.232999999999844, "episode_len_mean": 253.32, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 38.50000000000003, 45.7, 43.30000000000001, 42.500000000000014, 40.500000000000014, -50.00000000000044, 21.499999999999865, 41.70000000000002, -50.00000000000044, 31.500000000000007, 44.10000000000001, 46.099999999999994, -50.00000000000044, 35.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.699999999999996, 42.10000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.50000000000004, 36.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 42.30000000000001, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 43.7, 9.299999999999692, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 24.299999999999905, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.90000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.7, 41.100000000000016, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 28.09999999999996, 44.10000000000001, -50.00000000000044, 31.70000000000001, 30.499999999999993], "episode_lengths": [44, 500, 116, 44, 68, 76, 96, 500, 286, 84, 500, 186, 60, 40, 500, 142, 98, 72, 36, 500, 124, 140, 194, 80, 178, 98, 500, 74, 500, 80, 88, 64, 244, 500, 500, 154, 156, 134, 50, 500, 500, 232, 54, 500, 32, 500, 78, 432, 500, 500, 500, 44, 62, 206, 500, 500, 122, 64, 64, 500, 62, 500, 90, 64, 408, 46, 110, 500, 500, 66, 156, 500, 500, 90, 500, 128, 258, 32, 500, 134, 500, 500, 102, 162, 500, 136, 500, 64, 90, 78, 500, 500, 500, 200, 500, 220, 60, 500, 184, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777214873904253, "mean_inference_ms": 1.2260537353160301, "mean_action_processing_ms": 0.1401650584498946, "mean_env_wait_ms": 0.0840755409289505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025753498077392578, "StateBufferConnector_ms": 0.006096363067626953, "ViewRequirementAgentConnector_ms": 0.10789990425109863}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.232999999999844, "episode_len_mean": 253.32, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 38.50000000000003, 45.7, 43.30000000000001, 42.500000000000014, 40.500000000000014, -50.00000000000044, 21.499999999999865, 41.70000000000002, -50.00000000000044, 31.500000000000007, 44.10000000000001, 46.099999999999994, -50.00000000000044, 35.900000000000034, 40.30000000000002, 42.900000000000006, 46.5, -50.00000000000044, 37.70000000000003, 36.10000000000004, 30.699999999999996, 42.10000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.10000000000001, 41.30000000000001, 43.7, 25.699999999999925, -50.00000000000044, -50.00000000000044, 34.70000000000004, 34.50000000000004, 36.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, 26.89999999999994, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 42.30000000000001, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 43.7, 9.299999999999692, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 24.299999999999905, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.90000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.7, 41.100000000000016, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 28.09999999999996, 44.10000000000001, -50.00000000000044, 31.70000000000001, 30.499999999999993], "episode_lengths": [44, 500, 116, 44, 68, 76, 96, 500, 286, 84, 500, 186, 60, 40, 500, 142, 98, 72, 36, 500, 124, 140, 194, 80, 178, 98, 500, 74, 500, 80, 88, 64, 244, 500, 500, 154, 156, 134, 50, 500, 500, 232, 54, 500, 32, 500, 78, 432, 500, 500, 500, 44, 62, 206, 500, 500, 122, 64, 64, 500, 62, 500, 90, 64, 408, 46, 110, 500, 500, 66, 156, 500, 500, 90, 500, 128, 258, 32, 500, 134, 500, 500, 102, 162, 500, 136, 500, 64, 90, 78, 500, 500, 500, 200, 500, 220, 60, 500, 184, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777214873904253, "mean_inference_ms": 1.2260537353160301, "mean_action_processing_ms": 0.1401650584498946, "mean_env_wait_ms": 0.0840755409289505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025753498077392578, "StateBufferConnector_ms": 0.006096363067626953, "ViewRequirementAgentConnector_ms": 0.10789990425109863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5953.549638948495, "num_env_steps_trained_throughput_per_sec": 5953.549638948495, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2175.652, "sample_time_ms": 1980.221, "load_time_ms": 11.704, "load_throughput": 1025264.058, "learn_time_ms": 172.479, "learn_throughput": 69573.549, "synch_weights_time_ms": 9.371}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1279, "training_iteration": 29, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-42", "timestamp": 1698249762, "time_this_iter_s": 2.020602226257324, "time_total_s": 62.485801696777344, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.485801696777344, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 7.22923829820421, "policy_loss": -1.8796676562892066e-05, "vf_loss": 7.229315121968587, "vf_explained_var": -4.3047799004448785e-07, "kl": 0.00022547858812218792, "entropy": 0.5806251168251038, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.848999999999826, "episode_len_mean": 267.14, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 43.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 43.7, 9.299999999999692, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 24.299999999999905, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.90000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.7, 41.100000000000016, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 28.09999999999996, 44.10000000000001, -50.00000000000044, 31.70000000000001, 30.499999999999993, -50.00000000000044, 45.3, 39.300000000000026, 35.900000000000034, -50.00000000000044, 41.100000000000016, 45.7, 43.50000000000001, 41.70000000000002, 16.499999999999794, -50.00000000000044, 28.09999999999996, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.099999999999994, 15.299999999999777, 44.10000000000001, 26.499999999999936, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.300000000000026, 40.10000000000002, -50.00000000000044, 10.699999999999712, -50.00000000000044, 41.30000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.699999999999996, 45.3, 45.5, 33.30000000000003, 38.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 62, 206, 500, 500, 122, 64, 64, 500, 62, 500, 90, 64, 408, 46, 110, 500, 500, 66, 156, 500, 500, 90, 500, 128, 258, 32, 500, 134, 500, 500, 102, 162, 500, 136, 500, 64, 90, 78, 500, 500, 500, 200, 500, 220, 60, 500, 184, 196, 500, 48, 108, 142, 500, 90, 44, 66, 84, 336, 500, 220, 436, 48, 500, 500, 224, 40, 348, 60, 236, 500, 70, 500, 128, 100, 500, 394, 500, 88, 62, 500, 68, 68, 60, 500, 500, 500, 500, 82, 182, 108, 500, 194, 48, 46, 168, 120, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37782971308395574, "mean_inference_ms": 1.2259069788829688, "mean_action_processing_ms": 0.1401270260504798, "mean_env_wait_ms": 0.08410415854304326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026533842086791992, "StateBufferConnector_ms": 0.006935834884643555, "ViewRequirementAgentConnector_ms": 0.10326051712036133}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.848999999999826, "episode_len_mean": 267.14, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 43.900000000000006, 29.49999999999998, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 43.7, 9.299999999999692, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.300000000000026, 24.299999999999905, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 33.90000000000004, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.7, 41.100000000000016, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 28.09999999999996, 44.10000000000001, -50.00000000000044, 31.70000000000001, 30.499999999999993, -50.00000000000044, 45.3, 39.300000000000026, 35.900000000000034, -50.00000000000044, 41.100000000000016, 45.7, 43.50000000000001, 41.70000000000002, 16.499999999999794, -50.00000000000044, 28.09999999999996, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.099999999999994, 15.299999999999777, 44.10000000000001, 26.499999999999936, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.300000000000026, 40.10000000000002, -50.00000000000044, 10.699999999999712, -50.00000000000044, 41.30000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.699999999999996, 45.3, 45.5, 33.30000000000003, 38.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 62, 206, 500, 500, 122, 64, 64, 500, 62, 500, 90, 64, 408, 46, 110, 500, 500, 66, 156, 500, 500, 90, 500, 128, 258, 32, 500, 134, 500, 500, 102, 162, 500, 136, 500, 64, 90, 78, 500, 500, 500, 200, 500, 220, 60, 500, 184, 196, 500, 48, 108, 142, 500, 90, 44, 66, 84, 336, 500, 220, 436, 48, 500, 500, 224, 40, 348, 60, 236, 500, 70, 500, 128, 100, 500, 394, 500, 88, 62, 500, 68, 68, 60, 500, 500, 500, 500, 82, 182, 108, 500, 194, 48, 46, 168, 120, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37782971308395574, "mean_inference_ms": 1.2259069788829688, "mean_action_processing_ms": 0.1401270260504798, "mean_env_wait_ms": 0.08410415854304326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026533842086791992, "StateBufferConnector_ms": 0.006935834884643555, "ViewRequirementAgentConnector_ms": 0.10326051712036133}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5568.8336978091065, "num_env_steps_trained_throughput_per_sec": 5568.8336978091065, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2185.826, "sample_time_ms": 1979.676, "load_time_ms": 12.341, "load_throughput": 972338.578, "learn_time_ms": 182.362, "learn_throughput": 65803.283, "synch_weights_time_ms": 9.575}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1329, "training_iteration": 30, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-44", "timestamp": 1698249764, "time_this_iter_s": 2.1598472595214844, "time_total_s": 64.64564895629883, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.64564895629883, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 7.098883363935682, "policy_loss": 0.00012622815039422776, "vf_loss": 7.09881575902303, "vf_explained_var": 1.457002427842882e-07, "kl": 2.8520596490327283e-05, "entropy": 0.5857363475693597, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.385999999999841, "episode_len_mean": 256.82, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.70000000000001, 30.499999999999993, -50.00000000000044, 45.3, 39.300000000000026, 35.900000000000034, -50.00000000000044, 41.100000000000016, 45.7, 43.50000000000001, 41.70000000000002, 16.499999999999794, -50.00000000000044, 28.09999999999996, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.099999999999994, 15.299999999999777, 44.10000000000001, 26.499999999999936, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.300000000000026, 40.10000000000002, -50.00000000000044, 10.699999999999712, -50.00000000000044, 41.30000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.699999999999996, 45.3, 45.5, 33.30000000000003, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 41.500000000000014, 43.10000000000001, 37.70000000000003, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, 45.5, 44.5, -50.00000000000044, 42.70000000000001, 25.899999999999928, 43.50000000000001, 38.300000000000026, 41.30000000000001, 27.899999999999956, 38.10000000000002, 43.50000000000001, 26.09999999999993, 41.70000000000002, 20.899999999999856, 42.30000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 20.299999999999848, -50.00000000000044, 25.29999999999992, 42.900000000000006, 6.8999999999996575, 36.900000000000034, 32.50000000000002, 33.70000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 184, 196, 500, 48, 108, 142, 500, 90, 44, 66, 84, 336, 500, 220, 436, 48, 500, 500, 224, 40, 348, 60, 236, 500, 70, 500, 128, 100, 500, 394, 500, 88, 62, 500, 68, 68, 60, 500, 500, 500, 500, 82, 182, 108, 500, 194, 48, 46, 168, 120, 500, 500, 48, 130, 500, 86, 70, 124, 500, 296, 500, 500, 500, 36, 98, 500, 500, 104, 164, 46, 56, 500, 74, 242, 66, 118, 88, 222, 120, 66, 240, 84, 292, 78, 500, 500, 266, 298, 500, 248, 72, 432, 132, 176, 164, 50, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37792065968259847, "mean_inference_ms": 1.2248680137830608, "mean_action_processing_ms": 0.13976868183125604, "mean_env_wait_ms": 0.08429871140999927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03653097152709961, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.11565494537353516}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.385999999999841, "episode_len_mean": 256.82, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 31.70000000000001, 30.499999999999993, -50.00000000000044, 45.3, 39.300000000000026, 35.900000000000034, -50.00000000000044, 41.100000000000016, 45.7, 43.50000000000001, 41.70000000000002, 16.499999999999794, -50.00000000000044, 28.09999999999996, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.099999999999994, 15.299999999999777, 44.10000000000001, 26.499999999999936, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.300000000000026, 40.10000000000002, -50.00000000000044, 10.699999999999712, -50.00000000000044, 41.30000000000001, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.699999999999996, 45.3, 45.5, 33.30000000000003, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 41.500000000000014, 43.10000000000001, 37.70000000000003, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, 45.5, 44.5, -50.00000000000044, 42.70000000000001, 25.899999999999928, 43.50000000000001, 38.300000000000026, 41.30000000000001, 27.899999999999956, 38.10000000000002, 43.50000000000001, 26.09999999999993, 41.70000000000002, 20.899999999999856, 42.30000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 20.299999999999848, -50.00000000000044, 25.29999999999992, 42.900000000000006, 6.8999999999996575, 36.900000000000034, 32.50000000000002, 33.70000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 184, 196, 500, 48, 108, 142, 500, 90, 44, 66, 84, 336, 500, 220, 436, 48, 500, 500, 224, 40, 348, 60, 236, 500, 70, 500, 128, 100, 500, 394, 500, 88, 62, 500, 68, 68, 60, 500, 500, 500, 500, 82, 182, 108, 500, 194, 48, 46, 168, 120, 500, 500, 48, 130, 500, 86, 70, 124, 500, 296, 500, 500, 500, 36, 98, 500, 500, 104, 164, 46, 56, 500, 74, 242, 66, 118, 88, 222, 120, 66, 240, 84, 292, 78, 500, 500, 266, 298, 500, 248, 72, 432, 132, 176, 164, 50, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37792065968259847, "mean_inference_ms": 1.2248680137830608, "mean_action_processing_ms": 0.13976868183125604, "mean_env_wait_ms": 0.08429871140999927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03653097152709961, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.11565494537353516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5584.143902659565, "num_env_steps_trained_throughput_per_sec": 5584.143902659565, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2172.156, "sample_time_ms": 1975.547, "load_time_ms": 12.032, "load_throughput": 997325.915, "learn_time_ms": 173.264, "learn_throughput": 69258.672, "synch_weights_time_ms": 9.517}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1376, "training_iteration": 31, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-46", "timestamp": 1698249766, "time_this_iter_s": 2.1559367179870605, "time_total_s": 66.80158567428589, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.80158567428589, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 58.833333333333336, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 7.312385294172499, "policy_loss": 5.702113008333577e-05, "vf_loss": 7.312388685014513, "vf_explained_var": -2.7683046129014756e-06, "kl": 5.509588780149165e-05, "entropy": 0.6050894790225558, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 284.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.922999999999856, "episode_len_mean": 246.5, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 41.500000000000014, 43.10000000000001, 37.70000000000003, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, 45.5, 44.5, -50.00000000000044, 42.70000000000001, 25.899999999999928, 43.50000000000001, 38.300000000000026, 41.30000000000001, 27.899999999999956, 38.10000000000002, 43.50000000000001, 26.09999999999993, 41.70000000000002, 20.899999999999856, 42.30000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 20.299999999999848, -50.00000000000044, 25.29999999999992, 42.900000000000006, 6.8999999999996575, 36.900000000000034, 32.50000000000002, 33.70000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 34.10000000000004, 37.10000000000003, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 23.29999999999989, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 24.899999999999913, 26.69999999999994, 35.30000000000004, 42.10000000000001, 43.10000000000001, 45.3, 42.30000000000001, 44.5, 44.900000000000006, 33.70000000000004, 22.099999999999874, 33.500000000000036, 44.5, -50.00000000000044, 33.70000000000004, 18.699999999999825, 6.8999999999996575, 40.30000000000002, 39.70000000000002, 19.69999999999984, 44.10000000000001, 39.70000000000002, 26.89999999999994, -50.00000000000044, 38.300000000000026, 45.1, 38.90000000000002, 42.30000000000001, 13.699999999999754, 42.10000000000001, -50.00000000000044, 5.499999999999638], "episode_lengths": [500, 500, 48, 130, 500, 86, 70, 124, 500, 296, 500, 500, 500, 36, 98, 500, 500, 104, 164, 46, 56, 500, 74, 242, 66, 118, 88, 222, 120, 66, 240, 84, 292, 78, 500, 500, 266, 298, 500, 248, 72, 432, 132, 176, 164, 50, 500, 500, 500, 154, 500, 160, 130, 474, 500, 500, 500, 28, 46, 268, 500, 72, 500, 64, 500, 172, 52, 500, 252, 234, 148, 80, 70, 48, 78, 56, 52, 164, 280, 166, 56, 500, 164, 314, 432, 98, 104, 304, 60, 104, 232, 500, 118, 50, 112, 78, 364, 80, 500, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37824643120919577, "mean_inference_ms": 1.2238605860312461, "mean_action_processing_ms": 0.13961519964853436, "mean_env_wait_ms": 0.0842767811337036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032999515533447266, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12798404693603516}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.922999999999856, "episode_len_mean": 246.5, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.3, 37.10000000000003, -50.00000000000044, 41.500000000000014, 43.10000000000001, 37.70000000000003, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.70000000000004, 45.5, 44.5, -50.00000000000044, 42.70000000000001, 25.899999999999928, 43.50000000000001, 38.300000000000026, 41.30000000000001, 27.899999999999956, 38.10000000000002, 43.50000000000001, 26.09999999999993, 41.70000000000002, 20.899999999999856, 42.30000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 20.299999999999848, -50.00000000000044, 25.29999999999992, 42.900000000000006, 6.8999999999996575, 36.900000000000034, 32.50000000000002, 33.70000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 34.10000000000004, 37.10000000000003, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 23.29999999999989, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 24.899999999999913, 26.69999999999994, 35.30000000000004, 42.10000000000001, 43.10000000000001, 45.3, 42.30000000000001, 44.5, 44.900000000000006, 33.70000000000004, 22.099999999999874, 33.500000000000036, 44.5, -50.00000000000044, 33.70000000000004, 18.699999999999825, 6.8999999999996575, 40.30000000000002, 39.70000000000002, 19.69999999999984, 44.10000000000001, 39.70000000000002, 26.89999999999994, -50.00000000000044, 38.300000000000026, 45.1, 38.90000000000002, 42.30000000000001, 13.699999999999754, 42.10000000000001, -50.00000000000044, 5.499999999999638], "episode_lengths": [500, 500, 48, 130, 500, 86, 70, 124, 500, 296, 500, 500, 500, 36, 98, 500, 500, 104, 164, 46, 56, 500, 74, 242, 66, 118, 88, 222, 120, 66, 240, 84, 292, 78, 500, 500, 266, 298, 500, 248, 72, 432, 132, 176, 164, 50, 500, 500, 500, 154, 500, 160, 130, 474, 500, 500, 500, 28, 46, 268, 500, 72, 500, 64, 500, 172, 52, 500, 252, 234, 148, 80, 70, 48, 78, 56, 52, 164, 280, 166, 56, 500, 164, 314, 432, 98, 104, 304, 60, 104, 232, 500, 118, 50, 112, 78, 364, 80, 500, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37824643120919577, "mean_inference_ms": 1.2238605860312461, "mean_action_processing_ms": 0.13961519964853436, "mean_env_wait_ms": 0.0842767811337036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032999515533447266, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12798404693603516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5799.001862348439, "num_env_steps_trained_throughput_per_sec": 5799.001862348439, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2173.741, "sample_time_ms": 1972.737, "load_time_ms": 12.234, "load_throughput": 980840.771, "learn_time_ms": 177.426, "learn_throughput": 67633.674, "synch_weights_time_ms": 9.547}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1427, "training_iteration": 32, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-48", "timestamp": 1698249768, "time_this_iter_s": 2.0750279426574707, "time_total_s": 68.87661361694336, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.87661361694336, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.333333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 7.2043238215976295, "policy_loss": 6.792032056384616e-06, "vf_loss": 7.204379982418484, "vf_explained_var": 3.4438239203559027e-07, "kl": 4.384005532326935e-06, "entropy": 0.6308833360671997, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.56399999999988, "episode_len_mean": 225.14, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.10000000000004, 37.10000000000003, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 23.29999999999989, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 24.899999999999913, 26.69999999999994, 35.30000000000004, 42.10000000000001, 43.10000000000001, 45.3, 42.30000000000001, 44.5, 44.900000000000006, 33.70000000000004, 22.099999999999874, 33.500000000000036, 44.5, -50.00000000000044, 33.70000000000004, 18.699999999999825, 6.8999999999996575, 40.30000000000002, 39.70000000000002, 19.69999999999984, 44.10000000000001, 39.70000000000002, 26.89999999999994, -50.00000000000044, 38.300000000000026, 45.1, 38.90000000000002, 42.30000000000001, 13.699999999999754, 42.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 24.099999999999902, 40.10000000000002, -50.00000000000044, 38.700000000000024, 37.50000000000003, 29.099999999999973, 24.099999999999902, 44.300000000000004, 33.70000000000004, 36.30000000000003, 29.299999999999976, 40.70000000000002, 44.10000000000001, -50.00000000000044, 38.90000000000002, 36.30000000000003, -50.00000000000044, 38.90000000000002, 45.1, 37.10000000000003, -50.00000000000044, 3.2999999999996064, 41.70000000000002, 43.50000000000001, -50.00000000000044, 44.300000000000004, 31.900000000000013, 44.300000000000004, 26.299999999999933, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 44.300000000000004, 13.299999999999748, 41.70000000000002, 43.900000000000006, 44.300000000000004, 44.300000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 35.500000000000036, -50.00000000000044, 42.900000000000006, 41.90000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044], "episode_lengths": [160, 130, 474, 500, 500, 500, 28, 46, 268, 500, 72, 500, 64, 500, 172, 52, 500, 252, 234, 148, 80, 70, 48, 78, 56, 52, 164, 280, 166, 56, 500, 164, 314, 432, 98, 104, 304, 60, 104, 232, 500, 118, 50, 112, 78, 364, 80, 500, 446, 500, 260, 100, 500, 114, 126, 210, 260, 58, 164, 138, 208, 94, 60, 500, 112, 138, 500, 112, 50, 130, 500, 468, 84, 66, 500, 58, 182, 58, 238, 178, 500, 70, 500, 36, 58, 368, 84, 62, 58, 58, 220, 500, 120, 146, 500, 72, 82, 204, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787644398549633, "mean_inference_ms": 1.2234172368411398, "mean_action_processing_ms": 0.13975659094851797, "mean_env_wait_ms": 0.08412246695015456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024897098541259766, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.12444448471069336}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.56399999999988, "episode_len_mean": 225.14, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.10000000000004, 37.10000000000003, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.5, 23.29999999999989, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, 44.900000000000006, -50.00000000000044, 24.899999999999913, 26.69999999999994, 35.30000000000004, 42.10000000000001, 43.10000000000001, 45.3, 42.30000000000001, 44.5, 44.900000000000006, 33.70000000000004, 22.099999999999874, 33.500000000000036, 44.5, -50.00000000000044, 33.70000000000004, 18.699999999999825, 6.8999999999996575, 40.30000000000002, 39.70000000000002, 19.69999999999984, 44.10000000000001, 39.70000000000002, 26.89999999999994, -50.00000000000044, 38.300000000000026, 45.1, 38.90000000000002, 42.30000000000001, 13.699999999999754, 42.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 24.099999999999902, 40.10000000000002, -50.00000000000044, 38.700000000000024, 37.50000000000003, 29.099999999999973, 24.099999999999902, 44.300000000000004, 33.70000000000004, 36.30000000000003, 29.299999999999976, 40.70000000000002, 44.10000000000001, -50.00000000000044, 38.90000000000002, 36.30000000000003, -50.00000000000044, 38.90000000000002, 45.1, 37.10000000000003, -50.00000000000044, 3.2999999999996064, 41.70000000000002, 43.50000000000001, -50.00000000000044, 44.300000000000004, 31.900000000000013, 44.300000000000004, 26.299999999999933, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 44.300000000000004, 13.299999999999748, 41.70000000000002, 43.900000000000006, 44.300000000000004, 44.300000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 35.500000000000036, -50.00000000000044, 42.900000000000006, 41.90000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044], "episode_lengths": [160, 130, 474, 500, 500, 500, 28, 46, 268, 500, 72, 500, 64, 500, 172, 52, 500, 252, 234, 148, 80, 70, 48, 78, 56, 52, 164, 280, 166, 56, 500, 164, 314, 432, 98, 104, 304, 60, 104, 232, 500, 118, 50, 112, 78, 364, 80, 500, 446, 500, 260, 100, 500, 114, 126, 210, 260, 58, 164, 138, 208, 94, 60, 500, 112, 138, 500, 112, 50, 130, 500, 468, 84, 66, 500, 58, 182, 58, 238, 178, 500, 70, 500, 36, 58, 368, 84, 62, 58, 58, 220, 500, 120, 146, 500, 72, 82, 204, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787644398549633, "mean_inference_ms": 1.2234172368411398, "mean_action_processing_ms": 0.13975659094851797, "mean_env_wait_ms": 0.08412246695015456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024897098541259766, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.12444448471069336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5360.658126248791, "num_env_steps_trained_throughput_per_sec": 5360.658126248791, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2187.472, "sample_time_ms": 1976.265, "load_time_ms": 12.939, "load_throughput": 927459.456, "learn_time_ms": 186.899, "learn_throughput": 64205.672, "synch_weights_time_ms": 9.572}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1478, "training_iteration": 33, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-51", "timestamp": 1698249771, "time_this_iter_s": 2.2435266971588135, "time_total_s": 71.12014031410217, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.12014031410217, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 60.53333333333334, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 7.48988135655721, "policy_loss": -0.00016052275896072388, "vf_loss": 7.4901012314690485, "vf_explained_var": 9.934107462565105e-08, "kl": 0.000107500026782898, "entropy": 0.5914833479457431, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 302.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.375999999999847, "episode_len_mean": 256.96, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 45.1, 38.90000000000002, 42.30000000000001, 13.699999999999754, 42.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 24.099999999999902, 40.10000000000002, -50.00000000000044, 38.700000000000024, 37.50000000000003, 29.099999999999973, 24.099999999999902, 44.300000000000004, 33.70000000000004, 36.30000000000003, 29.299999999999976, 40.70000000000002, 44.10000000000001, -50.00000000000044, 38.90000000000002, 36.30000000000003, -50.00000000000044, 38.90000000000002, 45.1, 37.10000000000003, -50.00000000000044, 3.2999999999996064, 41.70000000000002, 43.50000000000001, -50.00000000000044, 44.300000000000004, 31.900000000000013, 44.300000000000004, 26.299999999999933, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 44.300000000000004, 13.299999999999748, 41.70000000000002, 43.900000000000006, 44.300000000000004, 44.300000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 35.500000000000036, -50.00000000000044, 42.900000000000006, 41.90000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 18.699999999999825, 19.899999999999842, -50.00000000000044, 23.8999999999999, 41.30000000000001, 3.499999999999609, 15.899999999999785, -50.00000000000044, 40.10000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 40.70000000000002, 39.90000000000002, 42.900000000000006, -50.00000000000044, 25.099999999999916, 36.10000000000004, 39.10000000000002, 37.10000000000003, -50.00000000000044, 1.299999999999578, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.500000000000014, -50.00000000000044, 41.70000000000002, 25.499999999999922], "episode_lengths": [118, 50, 112, 78, 364, 80, 500, 446, 500, 260, 100, 500, 114, 126, 210, 260, 58, 164, 138, 208, 94, 60, 500, 112, 138, 500, 112, 50, 130, 500, 468, 84, 66, 500, 58, 182, 58, 238, 178, 500, 70, 500, 36, 58, 368, 84, 62, 58, 58, 220, 500, 120, 146, 500, 72, 82, 204, 500, 500, 500, 260, 98, 500, 500, 130, 500, 314, 302, 500, 262, 88, 466, 342, 500, 100, 500, 450, 500, 500, 500, 258, 94, 102, 72, 500, 250, 140, 110, 130, 500, 488, 52, 68, 500, 500, 142, 96, 500, 84, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783059905695358, "mean_inference_ms": 1.22411811565814, "mean_action_processing_ms": 0.140019864887985, "mean_env_wait_ms": 0.08391438651331412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028423547744750977, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.11595010757446289}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.375999999999847, "episode_len_mean": 256.96, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 45.1, 38.90000000000002, 42.30000000000001, 13.699999999999754, 42.10000000000001, -50.00000000000044, 5.499999999999638, -50.00000000000044, 24.099999999999902, 40.10000000000002, -50.00000000000044, 38.700000000000024, 37.50000000000003, 29.099999999999973, 24.099999999999902, 44.300000000000004, 33.70000000000004, 36.30000000000003, 29.299999999999976, 40.70000000000002, 44.10000000000001, -50.00000000000044, 38.90000000000002, 36.30000000000003, -50.00000000000044, 38.90000000000002, 45.1, 37.10000000000003, -50.00000000000044, 3.2999999999996064, 41.70000000000002, 43.50000000000001, -50.00000000000044, 44.300000000000004, 31.900000000000013, 44.300000000000004, 26.299999999999933, 32.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 44.300000000000004, 13.299999999999748, 41.70000000000002, 43.900000000000006, 44.300000000000004, 44.300000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 35.500000000000036, -50.00000000000044, 42.900000000000006, 41.90000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 18.699999999999825, 19.899999999999842, -50.00000000000044, 23.8999999999999, 41.30000000000001, 3.499999999999609, 15.899999999999785, -50.00000000000044, 40.10000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 40.70000000000002, 39.90000000000002, 42.900000000000006, -50.00000000000044, 25.099999999999916, 36.10000000000004, 39.10000000000002, 37.10000000000003, -50.00000000000044, 1.299999999999578, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.500000000000014, -50.00000000000044, 41.70000000000002, 25.499999999999922], "episode_lengths": [118, 50, 112, 78, 364, 80, 500, 446, 500, 260, 100, 500, 114, 126, 210, 260, 58, 164, 138, 208, 94, 60, 500, 112, 138, 500, 112, 50, 130, 500, 468, 84, 66, 500, 58, 182, 58, 238, 178, 500, 70, 500, 36, 58, 368, 84, 62, 58, 58, 220, 500, 120, 146, 500, 72, 82, 204, 500, 500, 500, 260, 98, 500, 500, 130, 500, 314, 302, 500, 262, 88, 466, 342, 500, 100, 500, 450, 500, 500, 500, 258, 94, 102, 72, 500, 250, 140, 110, 130, 500, 488, 52, 68, 500, 500, 142, 96, 500, 84, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783059905695358, "mean_inference_ms": 1.22411811565814, "mean_action_processing_ms": 0.140019864887985, "mean_env_wait_ms": 0.08391438651331412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028423547744750977, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.11595010757446289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5942.856225253915, "num_env_steps_trained_throughput_per_sec": 5942.856225253915, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2172.875, "sample_time_ms": 1978.147, "load_time_ms": 11.889, "load_throughput": 1009366.324, "learn_time_ms": 171.378, "learn_throughput": 70020.591, "synch_weights_time_ms": 9.59}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1519, "training_iteration": 34, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-53", "timestamp": 1698249773, "time_this_iter_s": 2.023231267929077, "time_total_s": 73.14337158203125, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.14337158203125, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 60.633333333333326, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 7.038305547502306, "policy_loss": -1.2596448262532553e-05, "vf_loss": 7.0383777088589135, "vf_explained_var": -1.6954210069444444e-06, "kl": 0.00010033772451202417, "entropy": 0.5962104664908515, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.750999999999821, "episode_len_mean": 278.16, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.299999999999748, 41.70000000000002, 43.900000000000006, 44.300000000000004, 44.300000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 35.500000000000036, -50.00000000000044, 42.900000000000006, 41.90000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 18.699999999999825, 19.899999999999842, -50.00000000000044, 23.8999999999999, 41.30000000000001, 3.499999999999609, 15.899999999999785, -50.00000000000044, 40.10000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 40.70000000000002, 39.90000000000002, 42.900000000000006, -50.00000000000044, 25.099999999999916, 36.10000000000004, 39.10000000000002, 37.10000000000003, -50.00000000000044, 1.299999999999578, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.500000000000014, -50.00000000000044, 41.70000000000002, 25.499999999999922, -50.00000000000044, 38.300000000000026, 25.699999999999925, 7.499999999999666, 44.5, 38.10000000000002, -50.00000000000044, 20.49999999999985, 46.3, 35.70000000000003, 45.5, 45.7, 36.50000000000003, 39.10000000000002, -50.00000000000044, 46.3, 44.10000000000001, 18.499999999999822, -50.00000000000044, 18.499999999999822, 42.10000000000001, 45.3, 40.90000000000002, 31.1, -50.00000000000044, 17.299999999999805, 42.900000000000006, 37.50000000000003, 26.09999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, 38.300000000000026, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044], "episode_lengths": [368, 84, 62, 58, 58, 220, 500, 120, 146, 500, 72, 82, 204, 500, 500, 500, 260, 98, 500, 500, 130, 500, 314, 302, 500, 262, 88, 466, 342, 500, 100, 500, 450, 500, 500, 500, 258, 94, 102, 72, 500, 250, 140, 110, 130, 500, 488, 52, 68, 500, 500, 142, 96, 500, 84, 246, 500, 118, 244, 426, 56, 120, 500, 296, 38, 144, 46, 44, 136, 110, 500, 38, 60, 316, 500, 316, 80, 48, 92, 190, 500, 328, 72, 126, 240, 122, 500, 500, 454, 500, 500, 118, 98, 500, 500, 500, 500, 132, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37809522525741796, "mean_inference_ms": 1.224912286494804, "mean_action_processing_ms": 0.1400402535617623, "mean_env_wait_ms": 0.08395488706170283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025550365447998047, "StateBufferConnector_ms": 0.003991365432739258, "ViewRequirementAgentConnector_ms": 0.12097835540771484}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.750999999999821, "episode_len_mean": 278.16, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.299999999999748, 41.70000000000002, 43.900000000000006, 44.300000000000004, 44.300000000000004, 28.09999999999996, -50.00000000000044, 38.10000000000002, 35.500000000000036, -50.00000000000044, 42.900000000000006, 41.90000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 18.699999999999825, 19.899999999999842, -50.00000000000044, 23.8999999999999, 41.30000000000001, 3.499999999999609, 15.899999999999785, -50.00000000000044, 40.10000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 40.70000000000002, 39.90000000000002, 42.900000000000006, -50.00000000000044, 25.099999999999916, 36.10000000000004, 39.10000000000002, 37.10000000000003, -50.00000000000044, 1.299999999999578, 44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.500000000000014, -50.00000000000044, 41.70000000000002, 25.499999999999922, -50.00000000000044, 38.300000000000026, 25.699999999999925, 7.499999999999666, 44.5, 38.10000000000002, -50.00000000000044, 20.49999999999985, 46.3, 35.70000000000003, 45.5, 45.7, 36.50000000000003, 39.10000000000002, -50.00000000000044, 46.3, 44.10000000000001, 18.499999999999822, -50.00000000000044, 18.499999999999822, 42.10000000000001, 45.3, 40.90000000000002, 31.1, -50.00000000000044, 17.299999999999805, 42.900000000000006, 37.50000000000003, 26.09999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, 38.300000000000026, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044], "episode_lengths": [368, 84, 62, 58, 58, 220, 500, 120, 146, 500, 72, 82, 204, 500, 500, 500, 260, 98, 500, 500, 130, 500, 314, 302, 500, 262, 88, 466, 342, 500, 100, 500, 450, 500, 500, 500, 258, 94, 102, 72, 500, 250, 140, 110, 130, 500, 488, 52, 68, 500, 500, 142, 96, 500, 84, 246, 500, 118, 244, 426, 56, 120, 500, 296, 38, 144, 46, 44, 136, 110, 500, 38, 60, 316, 500, 316, 80, 48, 92, 190, 500, 328, 72, 126, 240, 122, 500, 500, 454, 500, 500, 118, 98, 500, 500, 500, 500, 132, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37809522525741796, "mean_inference_ms": 1.224912286494804, "mean_action_processing_ms": 0.1400402535617623, "mean_env_wait_ms": 0.08395488706170283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025550365447998047, "StateBufferConnector_ms": 0.003991365432739258, "ViewRequirementAgentConnector_ms": 0.12097835540771484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5497.136296556479, "num_env_steps_trained_throughput_per_sec": 5497.136296556479, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2183.1, "sample_time_ms": 1978.34, "load_time_ms": 12.7, "load_throughput": 944875.873, "learn_time_ms": 180.702, "learn_throughput": 66407.547, "synch_weights_time_ms": 9.687}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1563, "training_iteration": 35, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-55", "timestamp": 1698249775, "time_this_iter_s": 2.1889498233795166, "time_total_s": 75.33232140541077, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.33232140541077, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 62.46666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 7.06863366232978, "policy_loss": -0.0004017761804991298, "vf_loss": 7.0690915319654675, "vf_explained_var": -1.4967388576931423e-06, "kl": 0.00020567299622421665, "entropy": 0.5617293185657926, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 320.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.257999999999841, "episode_len_mean": 258.12, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.500000000000014, -50.00000000000044, 41.70000000000002, 25.499999999999922, -50.00000000000044, 38.300000000000026, 25.699999999999925, 7.499999999999666, 44.5, 38.10000000000002, -50.00000000000044, 20.49999999999985, 46.3, 35.70000000000003, 45.5, 45.7, 36.50000000000003, 39.10000000000002, -50.00000000000044, 46.3, 44.10000000000001, 18.499999999999822, -50.00000000000044, 18.499999999999822, 42.10000000000001, 45.3, 40.90000000000002, 31.1, -50.00000000000044, 17.299999999999805, 42.900000000000006, 37.50000000000003, 26.09999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, 38.300000000000026, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 42.70000000000001, 45.5, 42.500000000000014, 39.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 34.50000000000004, 27.299999999999947, 39.50000000000002, -50.00000000000044, 6.499999999999652, 13.899999999999757, 19.899999999999842, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, 46.699999999999996, -50.00000000000044, 23.29999999999989, 27.49999999999995, 23.8999999999999, -50.00000000000044, 23.499999999999893, 11.499999999999723, 33.10000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 31.900000000000013, 44.300000000000004, 33.90000000000004, 43.30000000000001, 43.7, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 68, 500, 500, 142, 96, 500, 84, 246, 500, 118, 244, 426, 56, 120, 500, 296, 38, 144, 46, 44, 136, 110, 500, 38, 60, 316, 500, 316, 80, 48, 92, 190, 500, 328, 72, 126, 240, 122, 500, 500, 454, 500, 500, 118, 98, 500, 500, 500, 500, 132, 90, 500, 74, 46, 76, 110, 500, 56, 500, 156, 228, 106, 500, 436, 362, 302, 122, 92, 500, 500, 382, 86, 500, 60, 96, 88, 34, 500, 268, 226, 262, 500, 266, 386, 170, 66, 500, 500, 116, 500, 182, 58, 162, 68, 64, 152, 68, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780615368368285, "mean_inference_ms": 1.2239316796426543, "mean_action_processing_ms": 0.14000358306957103, "mean_env_wait_ms": 0.08391175401073467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021544218063354492, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11910700798034668}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.257999999999841, "episode_len_mean": 258.12, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 40.500000000000014, -50.00000000000044, 41.70000000000002, 25.499999999999922, -50.00000000000044, 38.300000000000026, 25.699999999999925, 7.499999999999666, 44.5, 38.10000000000002, -50.00000000000044, 20.49999999999985, 46.3, 35.70000000000003, 45.5, 45.7, 36.50000000000003, 39.10000000000002, -50.00000000000044, 46.3, 44.10000000000001, 18.499999999999822, -50.00000000000044, 18.499999999999822, 42.10000000000001, 45.3, 40.90000000000002, 31.1, -50.00000000000044, 17.299999999999805, 42.900000000000006, 37.50000000000003, 26.09999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, 38.300000000000026, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 42.70000000000001, 45.5, 42.500000000000014, 39.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 34.50000000000004, 27.299999999999947, 39.50000000000002, -50.00000000000044, 6.499999999999652, 13.899999999999757, 19.899999999999842, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, 46.699999999999996, -50.00000000000044, 23.29999999999989, 27.49999999999995, 23.8999999999999, -50.00000000000044, 23.499999999999893, 11.499999999999723, 33.10000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 31.900000000000013, 44.300000000000004, 33.90000000000004, 43.30000000000001, 43.7, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 68, 500, 500, 142, 96, 500, 84, 246, 500, 118, 244, 426, 56, 120, 500, 296, 38, 144, 46, 44, 136, 110, 500, 38, 60, 316, 500, 316, 80, 48, 92, 190, 500, 328, 72, 126, 240, 122, 500, 500, 454, 500, 500, 118, 98, 500, 500, 500, 500, 132, 90, 500, 74, 46, 76, 110, 500, 56, 500, 156, 228, 106, 500, 436, 362, 302, 122, 92, 500, 500, 382, 86, 500, 60, 96, 88, 34, 500, 268, 226, 262, 500, 266, 386, 170, 66, 500, 500, 116, 500, 182, 58, 162, 68, 64, 152, 68, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780615368368285, "mean_inference_ms": 1.2239316796426543, "mean_action_processing_ms": 0.14000358306957103, "mean_env_wait_ms": 0.08391175401073467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021544218063354492, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11910700798034668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5643.99647802827, "num_env_steps_trained_throughput_per_sec": 5643.99647802827, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2171.866, "sample_time_ms": 1975.865, "load_time_ms": 12.602, "load_throughput": 952195.919, "learn_time_ms": 172.174, "learn_throughput": 69697.089, "synch_weights_time_ms": 9.654}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1610, "training_iteration": 36, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-57", "timestamp": 1698249777, "time_this_iter_s": 2.1311466693878174, "time_total_s": 77.46346807479858, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.46346807479858, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 61.333333333333336, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 7.321564515431722, "policy_loss": -0.00038333444131745235, "vf_loss": 7.322008821699354, "vf_explained_var": -7.483694288465712e-07, "kl": 0.00048071858163388644, "entropy": 0.6110880441135831, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.280999999999833, "episode_len_mean": 272.88, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 42.70000000000001, 45.5, 42.500000000000014, 39.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 34.50000000000004, 27.299999999999947, 39.50000000000002, -50.00000000000044, 6.499999999999652, 13.899999999999757, 19.899999999999842, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, 46.699999999999996, -50.00000000000044, 23.29999999999989, 27.49999999999995, 23.8999999999999, -50.00000000000044, 23.499999999999893, 11.499999999999723, 33.10000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 31.900000000000013, 44.300000000000004, 33.90000000000004, 43.30000000000001, 43.7, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.10000000000002, 17.299999999999805, -50.00000000000044, 38.300000000000026, 47.3, -50.00000000000044, 35.900000000000034, 15.099999999999774, 40.90000000000002, 12.299999999999734, 32.700000000000024, 23.8999999999999, 42.500000000000014, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 36.900000000000034, 7.499999999999666, -50.00000000000044, 34.900000000000034, 22.699999999999882, 17.499999999999808, 31.900000000000013, 35.10000000000004, 28.499999999999964, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, 26.89999999999994, 40.90000000000002, 45.7, 37.300000000000026, 27.49999999999995, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 132, 90, 500, 74, 46, 76, 110, 500, 56, 500, 156, 228, 106, 500, 436, 362, 302, 122, 92, 500, 500, 382, 86, 500, 60, 96, 88, 34, 500, 268, 226, 262, 500, 266, 386, 170, 66, 500, 500, 116, 500, 182, 58, 162, 68, 64, 152, 68, 500, 500, 500, 204, 326, 142, 500, 500, 122, 100, 328, 500, 118, 28, 500, 142, 350, 92, 378, 174, 262, 76, 36, 32, 500, 500, 500, 102, 132, 426, 500, 152, 274, 326, 182, 150, 216, 500, 500, 476, 500, 72, 232, 92, 44, 128, 226, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37823783773501307, "mean_inference_ms": 1.2236255385359414, "mean_action_processing_ms": 0.14049639340446635, "mean_env_wait_ms": 0.08399373835535638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017827510833740234, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.11345458030700684}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.280999999999833, "episode_len_mean": 272.88, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 42.70000000000001, 45.5, 42.500000000000014, 39.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 34.50000000000004, 27.299999999999947, 39.50000000000002, -50.00000000000044, 6.499999999999652, 13.899999999999757, 19.899999999999842, 37.90000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, 46.699999999999996, -50.00000000000044, 23.29999999999989, 27.49999999999995, 23.8999999999999, -50.00000000000044, 23.499999999999893, 11.499999999999723, 33.10000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 31.900000000000013, 44.300000000000004, 33.90000000000004, 43.30000000000001, 43.7, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.10000000000002, 17.299999999999805, -50.00000000000044, 38.300000000000026, 47.3, -50.00000000000044, 35.900000000000034, 15.099999999999774, 40.90000000000002, 12.299999999999734, 32.700000000000024, 23.8999999999999, 42.500000000000014, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 36.900000000000034, 7.499999999999666, -50.00000000000044, 34.900000000000034, 22.699999999999882, 17.499999999999808, 31.900000000000013, 35.10000000000004, 28.499999999999964, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, 26.89999999999994, 40.90000000000002, 45.7, 37.300000000000026, 27.49999999999995, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 132, 90, 500, 74, 46, 76, 110, 500, 56, 500, 156, 228, 106, 500, 436, 362, 302, 122, 92, 500, 500, 382, 86, 500, 60, 96, 88, 34, 500, 268, 226, 262, 500, 266, 386, 170, 66, 500, 500, 116, 500, 182, 58, 162, 68, 64, 152, 68, 500, 500, 500, 204, 326, 142, 500, 500, 122, 100, 328, 500, 118, 28, 500, 142, 350, 92, 378, 174, 262, 76, 36, 32, 500, 500, 500, 102, 132, 426, 500, 152, 274, 326, 182, 150, 216, 500, 500, 476, 500, 72, 232, 92, 44, 128, 226, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37823783773501307, "mean_inference_ms": 1.2236255385359414, "mean_action_processing_ms": 0.14049639340446635, "mean_env_wait_ms": 0.08399373835535638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017827510833740234, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.11345458030700684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5695.409987066083, "num_env_steps_trained_throughput_per_sec": 5695.409987066083, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2120.186, "sample_time_ms": 1921.113, "load_time_ms": 12.708, "load_throughput": 944278.475, "learn_time_ms": 174.947, "learn_throughput": 68592.09, "synch_weights_time_ms": 9.746}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1656, "training_iteration": 37, "trial_id": "9f288_00018", "date": "2023-10-25_17-02-59", "timestamp": 1698249779, "time_this_iter_s": 2.111966609954834, "time_total_s": 79.57543468475342, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.57543468475342, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 60.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 6.516821013556586, "policy_loss": -0.00010474522908528645, "vf_loss": 6.51698652903239, "vf_explained_var": 4.967053731282552e-07, "kl": 0.000291306651774903, "entropy": 0.6078459024429321, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.531999999999847, "episode_len_mean": 255.38, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, 44.300000000000004, 33.90000000000004, 43.30000000000001, 43.7, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.10000000000002, 17.299999999999805, -50.00000000000044, 38.300000000000026, 47.3, -50.00000000000044, 35.900000000000034, 15.099999999999774, 40.90000000000002, 12.299999999999734, 32.700000000000024, 23.8999999999999, 42.500000000000014, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 36.900000000000034, 7.499999999999666, -50.00000000000044, 34.900000000000034, 22.699999999999882, 17.499999999999808, 31.900000000000013, 35.10000000000004, 28.499999999999964, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, 26.89999999999994, 40.90000000000002, 45.7, 37.300000000000026, 27.49999999999995, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 24.099999999999902, 37.10000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 28.699999999999967, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, 41.90000000000001, 41.100000000000016, 34.50000000000004, 43.50000000000001, 19.299999999999834, -50.00000000000044, 36.900000000000034, 43.7, 26.89999999999994, 41.70000000000002, -50.00000000000044, 32.700000000000024, 45.5, 43.30000000000001, -50.00000000000044, 47.1], "episode_lengths": [182, 58, 162, 68, 64, 152, 68, 500, 500, 500, 204, 326, 142, 500, 500, 122, 100, 328, 500, 118, 28, 500, 142, 350, 92, 378, 174, 262, 76, 36, 32, 500, 500, 500, 102, 132, 426, 500, 152, 274, 326, 182, 150, 216, 500, 500, 476, 500, 72, 232, 92, 44, 128, 226, 500, 66, 500, 500, 500, 190, 88, 50, 60, 500, 500, 376, 500, 500, 136, 500, 48, 260, 130, 60, 500, 150, 214, 34, 64, 500, 500, 48, 138, 500, 82, 90, 156, 66, 308, 500, 132, 64, 232, 84, 500, 174, 46, 68, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37838831857219696, "mean_inference_ms": 1.2231770045554982, "mean_action_processing_ms": 0.14076459287085766, "mean_env_wait_ms": 0.08399291288894276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02892160415649414, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1218118667602539}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.531999999999847, "episode_len_mean": 255.38, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, 44.300000000000004, 33.90000000000004, 43.30000000000001, 43.7, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.10000000000002, 17.299999999999805, -50.00000000000044, 38.300000000000026, 47.3, -50.00000000000044, 35.900000000000034, 15.099999999999774, 40.90000000000002, 12.299999999999734, 32.700000000000024, 23.8999999999999, 42.500000000000014, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 36.900000000000034, 7.499999999999666, -50.00000000000044, 34.900000000000034, 22.699999999999882, 17.499999999999808, 31.900000000000013, 35.10000000000004, 28.499999999999964, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, 26.89999999999994, 40.90000000000002, 45.7, 37.300000000000026, 27.49999999999995, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 24.099999999999902, 37.10000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 28.699999999999967, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, 41.90000000000001, 41.100000000000016, 34.50000000000004, 43.50000000000001, 19.299999999999834, -50.00000000000044, 36.900000000000034, 43.7, 26.89999999999994, 41.70000000000002, -50.00000000000044, 32.700000000000024, 45.5, 43.30000000000001, -50.00000000000044, 47.1], "episode_lengths": [182, 58, 162, 68, 64, 152, 68, 500, 500, 500, 204, 326, 142, 500, 500, 122, 100, 328, 500, 118, 28, 500, 142, 350, 92, 378, 174, 262, 76, 36, 32, 500, 500, 500, 102, 132, 426, 500, 152, 274, 326, 182, 150, 216, 500, 500, 476, 500, 72, 232, 92, 44, 128, 226, 500, 66, 500, 500, 500, 190, 88, 50, 60, 500, 500, 376, 500, 500, 136, 500, 48, 260, 130, 60, 500, 150, 214, 34, 64, 500, 500, 48, 138, 500, 82, 90, 156, 66, 308, 500, 132, 64, 232, 84, 500, 174, 46, 68, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37838831857219696, "mean_inference_ms": 1.2231770045554982, "mean_action_processing_ms": 0.14076459287085766, "mean_env_wait_ms": 0.08399291288894276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02892160415649414, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1218118667602539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5402.451535703636, "num_env_steps_trained_throughput_per_sec": 5402.451535703636, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2128.276, "sample_time_ms": 1923.92, "load_time_ms": 12.237, "load_throughput": 980668.774, "learn_time_ms": 180.724, "learn_throughput": 66399.68, "synch_weights_time_ms": 9.824}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1701, "training_iteration": 38, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-01", "timestamp": 1698249781, "time_this_iter_s": 2.226219892501831, "time_total_s": 81.80165457725525, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.80165457725525, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 61.96666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 6.798753049638536, "policy_loss": -0.00011788143051995171, "vf_loss": 6.798926247490777, "vf_explained_var": -7.020102606879341e-07, "kl": 0.00010353361111330944, "entropy": 0.5538249214490255, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1819999999998245, "episode_len_mean": 268.82, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.499999999999964, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, 26.89999999999994, 40.90000000000002, 45.7, 37.300000000000026, 27.49999999999995, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 24.099999999999902, 37.10000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 28.699999999999967, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, 41.90000000000001, 41.100000000000016, 34.50000000000004, 43.50000000000001, 19.299999999999834, -50.00000000000044, 36.900000000000034, 43.7, 26.89999999999994, 41.70000000000002, -50.00000000000044, 32.700000000000024, 45.5, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, 45.7, 31.300000000000004, 40.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 41.100000000000016, 39.50000000000002, 47.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 35.70000000000003, 47.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.299999999999947, 37.90000000000003, 3.499999999999609, -50.00000000000044, 9.499999999999694], "episode_lengths": [216, 500, 500, 476, 500, 72, 232, 92, 44, 128, 226, 500, 66, 500, 500, 500, 190, 88, 50, 60, 500, 500, 376, 500, 500, 136, 500, 48, 260, 130, 60, 500, 150, 214, 34, 64, 500, 500, 48, 138, 500, 82, 90, 156, 66, 308, 500, 132, 64, 232, 84, 500, 174, 46, 68, 500, 30, 500, 68, 162, 500, 44, 188, 96, 122, 500, 500, 56, 98, 90, 106, 24, 500, 500, 62, 118, 500, 144, 30, 500, 148, 500, 500, 62, 66, 436, 68, 500, 500, 302, 500, 500, 500, 500, 40, 228, 122, 466, 500, 406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784027220154272, "mean_inference_ms": 1.2231886885798917, "mean_action_processing_ms": 0.14072057552900955, "mean_env_wait_ms": 0.08417769117640762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030013084411621094, "StateBufferConnector_ms": 0.007584810256958008, "ViewRequirementAgentConnector_ms": 0.12569141387939453}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1819999999998245, "episode_len_mean": 268.82, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.499999999999964, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 42.900000000000006, 26.89999999999994, 40.90000000000002, 45.7, 37.300000000000026, 27.49999999999995, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 45.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.3, 24.099999999999902, 37.10000000000003, 44.10000000000001, -50.00000000000044, 35.10000000000004, 28.699999999999967, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, 41.90000000000001, 41.100000000000016, 34.50000000000004, 43.50000000000001, 19.299999999999834, -50.00000000000044, 36.900000000000034, 43.7, 26.89999999999994, 41.70000000000002, -50.00000000000044, 32.700000000000024, 45.5, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, 45.7, 31.300000000000004, 40.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 41.100000000000016, 39.50000000000002, 47.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 35.70000000000003, 47.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.299999999999947, 37.90000000000003, 3.499999999999609, -50.00000000000044, 9.499999999999694], "episode_lengths": [216, 500, 500, 476, 500, 72, 232, 92, 44, 128, 226, 500, 66, 500, 500, 500, 190, 88, 50, 60, 500, 500, 376, 500, 500, 136, 500, 48, 260, 130, 60, 500, 150, 214, 34, 64, 500, 500, 48, 138, 500, 82, 90, 156, 66, 308, 500, 132, 64, 232, 84, 500, 174, 46, 68, 500, 30, 500, 68, 162, 500, 44, 188, 96, 122, 500, 500, 56, 98, 90, 106, 24, 500, 500, 62, 118, 500, 144, 30, 500, 148, 500, 500, 62, 66, 436, 68, 500, 500, 302, 500, 500, 500, 500, 40, 228, 122, 466, 500, 406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784027220154272, "mean_inference_ms": 1.2231886885798917, "mean_action_processing_ms": 0.14072057552900955, "mean_env_wait_ms": 0.08417769117640762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030013084411621094, "StateBufferConnector_ms": 0.007584810256958008, "ViewRequirementAgentConnector_ms": 0.12569141387939453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6028.657765035457, "num_env_steps_trained_throughput_per_sec": 6028.657765035457, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2125.664, "sample_time_ms": 1921.426, "load_time_ms": 12.239, "load_throughput": 980500.657, "learn_time_ms": 180.693, "learn_throughput": 66410.982, "synch_weights_time_ms": 9.736}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1744, "training_iteration": 39, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-03", "timestamp": 1698249783, "time_this_iter_s": 1.9945003986358643, "time_total_s": 83.79615497589111, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.79615497589111, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 57.43333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 6.430905765957302, "policy_loss": -0.0001544720596737332, "vf_loss": 6.431112607320149, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.00019146810222044527, "entropy": 0.5247449278831482, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.079999999999817, "episode_len_mean": 269.82, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 19.299999999999834, -50.00000000000044, 36.900000000000034, 43.7, 26.89999999999994, 41.70000000000002, -50.00000000000044, 32.700000000000024, 45.5, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, 45.7, 31.300000000000004, 40.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 41.100000000000016, 39.50000000000002, 47.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 35.70000000000003, 47.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.299999999999947, 37.90000000000003, 3.499999999999609, -50.00000000000044, 9.499999999999694, -50.00000000000044, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, 45.7, 9.299999999999692, 31.1, 43.900000000000006, 46.699999999999996, 43.900000000000006, 34.50000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 42.30000000000001, 45.9, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.50000000000002, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026], "episode_lengths": [66, 308, 500, 132, 64, 232, 84, 500, 174, 46, 68, 500, 30, 500, 68, 162, 500, 44, 188, 96, 122, 500, 500, 56, 98, 90, 106, 24, 500, 500, 62, 118, 500, 144, 30, 500, 148, 500, 500, 62, 66, 436, 68, 500, 500, 302, 500, 500, 500, 500, 40, 228, 122, 466, 500, 406, 500, 42, 40, 60, 500, 44, 408, 190, 62, 34, 62, 156, 500, 120, 500, 58, 500, 500, 134, 78, 42, 52, 58, 500, 500, 166, 96, 500, 204, 500, 58, 500, 106, 172, 500, 500, 500, 360, 500, 500, 500, 500, 106, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37863855008740727, "mean_inference_ms": 1.2230791396150762, "mean_action_processing_ms": 0.1404889296560921, "mean_env_wait_ms": 0.08421426985299049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03579425811767578, "StateBufferConnector_ms": 0.00855255126953125, "ViewRequirementAgentConnector_ms": 0.1126718521118164}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.079999999999817, "episode_len_mean": 269.82, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 19.299999999999834, -50.00000000000044, 36.900000000000034, 43.7, 26.89999999999994, 41.70000000000002, -50.00000000000044, 32.700000000000024, 45.5, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, 33.90000000000004, -50.00000000000044, 45.7, 31.300000000000004, 40.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 41.100000000000016, 39.50000000000002, 47.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, 35.70000000000003, 47.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.299999999999947, 37.90000000000003, 3.499999999999609, -50.00000000000044, 9.499999999999694, -50.00000000000044, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, 45.7, 9.299999999999692, 31.1, 43.900000000000006, 46.699999999999996, 43.900000000000006, 34.50000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 42.30000000000001, 45.9, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.50000000000002, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026], "episode_lengths": [66, 308, 500, 132, 64, 232, 84, 500, 174, 46, 68, 500, 30, 500, 68, 162, 500, 44, 188, 96, 122, 500, 500, 56, 98, 90, 106, 24, 500, 500, 62, 118, 500, 144, 30, 500, 148, 500, 500, 62, 66, 436, 68, 500, 500, 302, 500, 500, 500, 500, 40, 228, 122, 466, 500, 406, 500, 42, 40, 60, 500, 44, 408, 190, 62, 34, 62, 156, 500, 120, 500, 58, 500, 500, 134, 78, 42, 52, 58, 500, 500, 166, 96, 500, 204, 500, 58, 500, 106, 172, 500, 500, 500, 360, 500, 500, 500, 500, 106, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37863855008740727, "mean_inference_ms": 1.2230791396150762, "mean_action_processing_ms": 0.1404889296560921, "mean_env_wait_ms": 0.08421426985299049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03579425811767578, "StateBufferConnector_ms": 0.00855255126953125, "ViewRequirementAgentConnector_ms": 0.1126718521118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5195.694971386419, "num_env_steps_trained_throughput_per_sec": 5195.694971386419, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2141.14, "sample_time_ms": 1927.498, "load_time_ms": 12.882, "load_throughput": 931539.683, "learn_time_ms": 189.376, "learn_throughput": 63366.123, "synch_weights_time_ms": 10.007}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1788, "training_iteration": 40, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-06", "timestamp": 1698249786, "time_this_iter_s": 2.3154284954071045, "time_total_s": 86.11158347129822, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.11158347129822, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 63.73333333333333, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 6.627739429473877, "policy_loss": -0.0004156563017103407, "vf_loss": 6.628205511305067, "vf_explained_var": -9.271833631727431e-08, "kl": 0.00017800339396798235, "entropy": 0.502997616926829, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.467999999999824, "episode_len_mean": 255.96, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 27.299999999999947, 37.90000000000003, 3.499999999999609, -50.00000000000044, 9.499999999999694, -50.00000000000044, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, 45.7, 9.299999999999692, 31.1, 43.900000000000006, 46.699999999999996, 43.900000000000006, 34.50000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 42.30000000000001, 45.9, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.50000000000002, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.50000000000003, 45.7, -50.00000000000044, 44.300000000000004, 45.5, 45.7, 46.699999999999996, 45.5, 39.300000000000026, 42.30000000000001, -50.00000000000044, 44.7, 42.10000000000001, 43.900000000000006, -50.00000000000044, 39.300000000000026, 46.9, 19.69999999999984, 6.299999999999649, 44.10000000000001, 46.5, 45.5, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 36.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 40.10000000000002], "episode_lengths": [40, 228, 122, 466, 500, 406, 500, 42, 40, 60, 500, 44, 408, 190, 62, 34, 62, 156, 500, 120, 500, 58, 500, 500, 134, 78, 42, 52, 58, 500, 500, 166, 96, 500, 204, 500, 58, 500, 106, 172, 500, 500, 500, 360, 500, 500, 500, 500, 106, 118, 90, 500, 500, 500, 50, 500, 500, 46, 500, 500, 500, 90, 126, 44, 500, 58, 46, 44, 34, 46, 108, 78, 500, 54, 80, 62, 500, 108, 32, 304, 438, 60, 36, 46, 94, 46, 500, 500, 470, 120, 500, 500, 66, 134, 72, 500, 500, 82, 44, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788941301478968, "mean_inference_ms": 1.2229119785965858, "mean_action_processing_ms": 0.14061441418921278, "mean_env_wait_ms": 0.08417879108077805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028682470321655273, "StateBufferConnector_ms": 0.010040283203125, "ViewRequirementAgentConnector_ms": 0.12475395202636719}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.467999999999824, "episode_len_mean": 255.96, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 27.299999999999947, 37.90000000000003, 3.499999999999609, -50.00000000000044, 9.499999999999694, -50.00000000000044, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, 45.7, 9.299999999999692, 31.1, 43.900000000000006, 46.699999999999996, 43.900000000000006, 34.50000000000004, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 42.30000000000001, 45.9, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.50000000000002, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.50000000000003, 45.7, -50.00000000000044, 44.300000000000004, 45.5, 45.7, 46.699999999999996, 45.5, 39.300000000000026, 42.30000000000001, -50.00000000000044, 44.7, 42.10000000000001, 43.900000000000006, -50.00000000000044, 39.300000000000026, 46.9, 19.69999999999984, 6.299999999999649, 44.10000000000001, 46.5, 45.5, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 36.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 40.10000000000002], "episode_lengths": [40, 228, 122, 466, 500, 406, 500, 42, 40, 60, 500, 44, 408, 190, 62, 34, 62, 156, 500, 120, 500, 58, 500, 500, 134, 78, 42, 52, 58, 500, 500, 166, 96, 500, 204, 500, 58, 500, 106, 172, 500, 500, 500, 360, 500, 500, 500, 500, 106, 118, 90, 500, 500, 500, 50, 500, 500, 46, 500, 500, 500, 90, 126, 44, 500, 58, 46, 44, 34, 46, 108, 78, 500, 54, 80, 62, 500, 108, 32, 304, 438, 60, 36, 46, 94, 46, 500, 500, 470, 120, 500, 500, 66, 134, 72, 500, 500, 82, 44, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788941301478968, "mean_inference_ms": 1.2229119785965858, "mean_action_processing_ms": 0.14061441418921278, "mean_env_wait_ms": 0.08417879108077805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028682470321655273, "StateBufferConnector_ms": 0.010040283203125, "ViewRequirementAgentConnector_ms": 0.12475395202636719}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5992.482793755687, "num_env_steps_trained_throughput_per_sec": 5992.482793755687, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2126.597, "sample_time_ms": 1931.059, "load_time_ms": 11.997, "load_throughput": 1000259.308, "learn_time_ms": 171.961, "learn_throughput": 69783.324, "synch_weights_time_ms": 10.104}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1838, "training_iteration": 41, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-08", "timestamp": 1698249788, "time_this_iter_s": 2.007702589035034, "time_total_s": 88.11928606033325, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.11928606033325, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 57.93333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 6.672764831119114, "policy_loss": 0.0002820293108622233, "vf_loss": 6.672540505727132, "vf_explained_var": -2.2649765014648438e-06, "kl": 0.00037790296095055156, "entropy": 0.5771180126402113, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 374.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0599999999998095, "episode_len_mean": 270.02, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.50000000000003, 45.7, -50.00000000000044, 44.300000000000004, 45.5, 45.7, 46.699999999999996, 45.5, 39.300000000000026, 42.30000000000001, -50.00000000000044, 44.7, 42.10000000000001, 43.900000000000006, -50.00000000000044, 39.300000000000026, 46.9, 19.69999999999984, 6.299999999999649, 44.10000000000001, 46.5, 45.5, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 36.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 40.10000000000002, -50.00000000000044, 42.900000000000006, 40.500000000000014, 42.10000000000001, 27.49999999999995, 36.900000000000034, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.5, 15.699999999999783, 7.699999999999669, 22.099999999999874, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.70000000000004, 7.899999999999672, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 45.7, 23.099999999999888, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 43.30000000000001, 36.70000000000003, 44.300000000000004, 45.7, 47.1, -50.00000000000044], "episode_lengths": [500, 360, 500, 500, 500, 500, 106, 118, 90, 500, 500, 500, 50, 500, 500, 46, 500, 500, 500, 90, 126, 44, 500, 58, 46, 44, 34, 46, 108, 78, 500, 54, 80, 62, 500, 108, 32, 304, 438, 60, 36, 46, 94, 46, 500, 500, 470, 120, 500, 500, 66, 134, 72, 500, 500, 82, 44, 100, 500, 72, 96, 80, 226, 132, 352, 500, 500, 46, 344, 424, 280, 38, 500, 500, 500, 74, 164, 422, 62, 500, 500, 500, 500, 500, 52, 72, 44, 270, 124, 500, 500, 500, 500, 402, 68, 134, 58, 44, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37890597503044626, "mean_inference_ms": 1.2234819708755302, "mean_action_processing_ms": 0.1406700219480074, "mean_env_wait_ms": 0.08416636716451803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021615028381347656, "StateBufferConnector_ms": 0.005036354064941406, "ViewRequirementAgentConnector_ms": 0.12498664855957031}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0599999999998095, "episode_len_mean": 270.02, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.50000000000003, 45.7, -50.00000000000044, 44.300000000000004, 45.5, 45.7, 46.699999999999996, 45.5, 39.300000000000026, 42.30000000000001, -50.00000000000044, 44.7, 42.10000000000001, 43.900000000000006, -50.00000000000044, 39.300000000000026, 46.9, 19.69999999999984, 6.299999999999649, 44.10000000000001, 46.5, 45.5, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 36.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 40.10000000000002, -50.00000000000044, 42.900000000000006, 40.500000000000014, 42.10000000000001, 27.49999999999995, 36.900000000000034, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.5, 15.699999999999783, 7.699999999999669, 22.099999999999874, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.70000000000004, 7.899999999999672, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 45.7, 23.099999999999888, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 43.30000000000001, 36.70000000000003, 44.300000000000004, 45.7, 47.1, -50.00000000000044], "episode_lengths": [500, 360, 500, 500, 500, 500, 106, 118, 90, 500, 500, 500, 50, 500, 500, 46, 500, 500, 500, 90, 126, 44, 500, 58, 46, 44, 34, 46, 108, 78, 500, 54, 80, 62, 500, 108, 32, 304, 438, 60, 36, 46, 94, 46, 500, 500, 470, 120, 500, 500, 66, 134, 72, 500, 500, 82, 44, 100, 500, 72, 96, 80, 226, 132, 352, 500, 500, 46, 344, 424, 280, 38, 500, 500, 500, 74, 164, 422, 62, 500, 500, 500, 500, 500, 52, 72, 44, 270, 124, 500, 500, 500, 500, 402, 68, 134, 58, 44, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37890597503044626, "mean_inference_ms": 1.2234819708755302, "mean_action_processing_ms": 0.1406700219480074, "mean_env_wait_ms": 0.08416636716451803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021615028381347656, "StateBufferConnector_ms": 0.005036354064941406, "ViewRequirementAgentConnector_ms": 0.12498664855957031}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5474.4497966536355, "num_env_steps_trained_throughput_per_sec": 5474.4497966536355, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2138.865, "sample_time_ms": 1935.298, "load_time_ms": 12.894, "load_throughput": 930697.362, "learn_time_ms": 179.193, "learn_throughput": 66967.028, "synch_weights_time_ms": 9.904}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1880, "training_iteration": 42, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-10", "timestamp": 1698249790, "time_this_iter_s": 2.197251796722412, "time_total_s": 90.31653785705566, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.31653785705566, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 67.60000000000001, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 6.393608146243626, "policy_loss": -5.686738424830967e-05, "vf_loss": 6.393720944722493, "vf_explained_var": -4.238552517361111e-07, "kl": 4.560462087334195e-05, "entropy": 0.5579064687093099, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.11099999999983, "episode_len_mean": 254.56, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 36.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 40.10000000000002, -50.00000000000044, 42.900000000000006, 40.500000000000014, 42.10000000000001, 27.49999999999995, 36.900000000000034, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.5, 15.699999999999783, 7.699999999999669, 22.099999999999874, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.70000000000004, 7.899999999999672, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 45.7, 23.099999999999888, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 43.30000000000001, 36.70000000000003, 44.300000000000004, 45.7, 47.1, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, 40.70000000000002, 2.699999999999598, 36.900000000000034, 42.30000000000001, 46.9, 44.900000000000006, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.50000000000002, 44.5, 5.499999999999638, 24.499999999999908, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 15.699999999999783, 31.900000000000013, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, 47.3, 44.7, 44.300000000000004, 42.900000000000006, 21.699999999999868, 31.300000000000004, 43.50000000000001, 45.3, 45.1, 45.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, -50.00000000000044, 41.30000000000001], "episode_lengths": [500, 66, 134, 72, 500, 500, 82, 44, 100, 500, 72, 96, 80, 226, 132, 352, 500, 500, 46, 344, 424, 280, 38, 500, 500, 500, 74, 164, 422, 62, 500, 500, 500, 500, 500, 52, 72, 44, 270, 124, 500, 500, 500, 500, 402, 68, 134, 58, 44, 30, 500, 78, 50, 500, 94, 474, 132, 78, 32, 52, 500, 42, 136, 500, 92, 500, 500, 500, 500, 120, 500, 106, 56, 446, 256, 116, 116, 500, 500, 344, 182, 500, 70, 500, 54, 28, 54, 58, 72, 284, 188, 66, 48, 50, 48, 34, 204, 500, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37911998063027286, "mean_inference_ms": 1.2230021190340954, "mean_action_processing_ms": 0.14071526008990778, "mean_env_wait_ms": 0.08409138403392985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.0029973983764648438, "ViewRequirementAgentConnector_ms": 0.13909053802490234}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.11099999999983, "episode_len_mean": 254.56, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 36.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.7, 40.10000000000002, -50.00000000000044, 42.900000000000006, 40.500000000000014, 42.10000000000001, 27.49999999999995, 36.900000000000034, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.5, 15.699999999999783, 7.699999999999669, 22.099999999999874, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.70000000000004, 7.899999999999672, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 45.7, 23.099999999999888, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 43.30000000000001, 36.70000000000003, 44.300000000000004, 45.7, 47.1, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, 40.70000000000002, 2.699999999999598, 36.900000000000034, 42.30000000000001, 46.9, 44.900000000000006, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.50000000000002, 44.5, 5.499999999999638, 24.499999999999908, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 15.699999999999783, 31.900000000000013, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, 47.3, 44.7, 44.300000000000004, 42.900000000000006, 21.699999999999868, 31.300000000000004, 43.50000000000001, 45.3, 45.1, 45.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, -50.00000000000044, 41.30000000000001], "episode_lengths": [500, 66, 134, 72, 500, 500, 82, 44, 100, 500, 72, 96, 80, 226, 132, 352, 500, 500, 46, 344, 424, 280, 38, 500, 500, 500, 74, 164, 422, 62, 500, 500, 500, 500, 500, 52, 72, 44, 270, 124, 500, 500, 500, 500, 402, 68, 134, 58, 44, 30, 500, 78, 50, 500, 94, 474, 132, 78, 32, 52, 500, 42, 136, 500, 92, 500, 500, 500, 500, 120, 500, 106, 56, 446, 256, 116, 116, 500, 500, 344, 182, 500, 70, 500, 54, 28, 54, 58, 72, 284, 188, 66, 48, 50, 48, 34, 204, 500, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37911998063027286, "mean_inference_ms": 1.2230021190340954, "mean_action_processing_ms": 0.14071526008990778, "mean_env_wait_ms": 0.08409138403392985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.0029973983764648438, "ViewRequirementAgentConnector_ms": 0.13909053802490234}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5899.7716360270715, "num_env_steps_trained_throughput_per_sec": 5899.7716360270715, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2118.409, "sample_time_ms": 1929.28, "load_time_ms": 12.19, "load_throughput": 984445.527, "learn_time_ms": 165.36, "learn_throughput": 72568.764, "synch_weights_time_ms": 9.928}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1929, "training_iteration": 43, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-12", "timestamp": 1698249792, "time_this_iter_s": 2.0389742851257324, "time_total_s": 92.3555121421814, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.3555121421814, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 59.26666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 6.576733748118083, "policy_loss": -2.4272542860772875e-05, "vf_loss": 6.576811578538683, "vf_explained_var": -1.2715657552083333e-06, "kl": 3.368260023408867e-05, "entropy": 0.537428230047226, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 392.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.426999999999857, "episode_len_mean": 231.44, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 2.699999999999598, 36.900000000000034, 42.30000000000001, 46.9, 44.900000000000006, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.50000000000002, 44.5, 5.499999999999638, 24.499999999999908, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 15.699999999999783, 31.900000000000013, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, 47.3, 44.7, 44.300000000000004, 42.900000000000006, 21.699999999999868, 31.300000000000004, 43.50000000000001, 45.3, 45.1, 45.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, -50.00000000000044, 41.30000000000001, 16.8999999999998, -50.00000000000044, 44.5, 44.10000000000001, 45.1, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, 21.89999999999987, 38.50000000000003, 34.10000000000004, 47.1, -50.00000000000044, 20.49999999999985, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.3, 39.90000000000002, 44.900000000000006, 41.100000000000016, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.29999999999989, -50.00000000000044, 40.10000000000002, 44.5, 35.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 6.499999999999652, 43.7, 43.900000000000006, 34.10000000000004, 21.09999999999986, 43.900000000000006, -50.00000000000044, 46.5, 42.70000000000001, 32.30000000000002, 45.5, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [94, 474, 132, 78, 32, 52, 500, 42, 136, 500, 92, 500, 500, 500, 500, 120, 500, 106, 56, 446, 256, 116, 116, 500, 500, 344, 182, 500, 70, 500, 54, 28, 54, 58, 72, 284, 188, 66, 48, 50, 48, 34, 204, 500, 500, 88, 332, 500, 56, 60, 50, 500, 66, 50, 500, 282, 116, 160, 30, 500, 296, 92, 500, 56, 500, 48, 102, 52, 90, 56, 500, 52, 500, 268, 500, 100, 56, 144, 500, 64, 500, 68, 500, 436, 64, 62, 160, 290, 62, 500, 36, 74, 178, 46, 500, 52, 136, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794748502844981, "mean_inference_ms": 1.222122881948027, "mean_action_processing_ms": 0.14075767109985013, "mean_env_wait_ms": 0.08434312408001608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022185087203979492, "StateBufferConnector_ms": 0.0070269107818603516, "ViewRequirementAgentConnector_ms": 0.1465144157409668}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.426999999999857, "episode_len_mean": 231.44, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 2.699999999999598, 36.900000000000034, 42.30000000000001, 46.9, 44.900000000000006, -50.00000000000044, 45.9, 36.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.50000000000002, 44.5, 5.499999999999638, 24.499999999999908, 38.50000000000003, 38.50000000000003, -50.00000000000044, -50.00000000000044, 15.699999999999783, 31.900000000000013, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.7, 47.3, 44.7, 44.300000000000004, 42.900000000000006, 21.699999999999868, 31.300000000000004, 43.50000000000001, 45.3, 45.1, 45.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, -50.00000000000044, 41.30000000000001, 16.8999999999998, -50.00000000000044, 44.5, 44.10000000000001, 45.1, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, 21.89999999999987, 38.50000000000003, 34.10000000000004, 47.1, -50.00000000000044, 20.49999999999985, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.3, 39.90000000000002, 44.900000000000006, 41.100000000000016, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.29999999999989, -50.00000000000044, 40.10000000000002, 44.5, 35.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 6.499999999999652, 43.7, 43.900000000000006, 34.10000000000004, 21.09999999999986, 43.900000000000006, -50.00000000000044, 46.5, 42.70000000000001, 32.30000000000002, 45.5, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044], "episode_lengths": [94, 474, 132, 78, 32, 52, 500, 42, 136, 500, 92, 500, 500, 500, 500, 120, 500, 106, 56, 446, 256, 116, 116, 500, 500, 344, 182, 500, 70, 500, 54, 28, 54, 58, 72, 284, 188, 66, 48, 50, 48, 34, 204, 500, 500, 88, 332, 500, 56, 60, 50, 500, 66, 50, 500, 282, 116, 160, 30, 500, 296, 92, 500, 56, 500, 48, 102, 52, 90, 56, 500, 52, 500, 268, 500, 100, 56, 144, 500, 64, 500, 68, 500, 436, 64, 62, 160, 290, 62, 500, 36, 74, 178, 46, 500, 52, 136, 500, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794748502844981, "mean_inference_ms": 1.222122881948027, "mean_action_processing_ms": 0.14075767109985013, "mean_env_wait_ms": 0.08434312408001608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022185087203979492, "StateBufferConnector_ms": 0.0070269107818603516, "ViewRequirementAgentConnector_ms": 0.1465144157409668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5466.695630262323, "num_env_steps_trained_throughput_per_sec": 5466.695630262323, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2135.997, "sample_time_ms": 1925.869, "load_time_ms": 13.293, "load_throughput": 902759.631, "learn_time_ms": 185.039, "learn_throughput": 64851.036, "synch_weights_time_ms": 10.218}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1983, "training_iteration": 44, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-14", "timestamp": 1698249794, "time_this_iter_s": 2.199735641479492, "time_total_s": 94.55524778366089, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.55524778366089, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 6.983280181884766, "policy_loss": -0.000116482170091735, "vf_loss": 6.98345152537028, "vf_explained_var": -1.25832027859158e-07, "kl": 7.707296919789997e-05, "entropy": 0.550274391969045, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.250999999999856, "episode_len_mean": 233.2, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, 21.89999999999987, 38.50000000000003, 34.10000000000004, 47.1, -50.00000000000044, 20.49999999999985, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.3, 39.90000000000002, 44.900000000000006, 41.100000000000016, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.29999999999989, -50.00000000000044, 40.10000000000002, 44.5, 35.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 6.499999999999652, 43.7, 43.900000000000006, 34.10000000000004, 21.09999999999986, 43.900000000000006, -50.00000000000044, 46.5, 42.70000000000001, 32.30000000000002, 45.5, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 16.29999999999979, 47.3, 45.1, -50.00000000000044, 7.499999999999666, 40.90000000000002, 45.1, 10.499999999999709, 20.699999999999854, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 36.50000000000003, 44.7, 34.70000000000004, 46.5, 42.900000000000006, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 32.700000000000024, 43.50000000000001, 47.3, -50.00000000000044, 41.500000000000014, 44.7, 41.70000000000002, 12.299999999999734, 34.10000000000004, 38.700000000000024, 20.899999999999856, 44.5, 41.70000000000002, 44.5, -50.00000000000044, 42.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, 31.900000000000013, 46.3, -50.00000000000044], "episode_lengths": [50, 500, 66, 50, 500, 282, 116, 160, 30, 500, 296, 92, 500, 56, 500, 48, 102, 52, 90, 56, 500, 52, 500, 268, 500, 100, 56, 144, 500, 64, 500, 68, 500, 436, 64, 62, 160, 290, 62, 500, 36, 74, 178, 46, 500, 52, 136, 500, 82, 500, 500, 338, 28, 50, 500, 426, 92, 50, 396, 294, 90, 500, 500, 70, 500, 500, 82, 500, 88, 136, 54, 154, 36, 72, 500, 34, 164, 500, 174, 66, 28, 500, 86, 54, 84, 378, 160, 114, 292, 56, 84, 56, 500, 72, 266, 500, 500, 182, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37983033809673983, "mean_inference_ms": 1.2214468629730075, "mean_action_processing_ms": 0.1406159480437156, "mean_env_wait_ms": 0.0843792472389627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000333786010742, "StateBufferConnector_ms": 0.008271217346191406, "ViewRequirementAgentConnector_ms": 0.13933634757995605}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.250999999999856, "episode_len_mean": 233.2, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 43.50000000000001, 45.1, -50.00000000000044, 21.89999999999987, 38.50000000000003, 34.10000000000004, 47.1, -50.00000000000044, 20.49999999999985, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.3, 39.90000000000002, 44.900000000000006, 41.100000000000016, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.29999999999989, -50.00000000000044, 40.10000000000002, 44.5, 35.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 6.499999999999652, 43.7, 43.900000000000006, 34.10000000000004, 21.09999999999986, 43.900000000000006, -50.00000000000044, 46.5, 42.70000000000001, 32.30000000000002, 45.5, -50.00000000000044, 44.900000000000006, 36.50000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 16.29999999999979, 47.3, 45.1, -50.00000000000044, 7.499999999999666, 40.90000000000002, 45.1, 10.499999999999709, 20.699999999999854, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 36.50000000000003, 44.7, 34.70000000000004, 46.5, 42.900000000000006, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 32.700000000000024, 43.50000000000001, 47.3, -50.00000000000044, 41.500000000000014, 44.7, 41.70000000000002, 12.299999999999734, 34.10000000000004, 38.700000000000024, 20.899999999999856, 44.5, 41.70000000000002, 44.5, -50.00000000000044, 42.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, 31.900000000000013, 46.3, -50.00000000000044], "episode_lengths": [50, 500, 66, 50, 500, 282, 116, 160, 30, 500, 296, 92, 500, 56, 500, 48, 102, 52, 90, 56, 500, 52, 500, 268, 500, 100, 56, 144, 500, 64, 500, 68, 500, 436, 64, 62, 160, 290, 62, 500, 36, 74, 178, 46, 500, 52, 136, 500, 82, 500, 500, 338, 28, 50, 500, 426, 92, 50, 396, 294, 90, 500, 500, 70, 500, 500, 82, 500, 88, 136, 54, 154, 36, 72, 500, 34, 164, 500, 174, 66, 28, 500, 86, 54, 84, 378, 160, 114, 292, 56, 84, 56, 500, 72, 266, 500, 500, 182, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37983033809673983, "mean_inference_ms": 1.2214468629730075, "mean_action_processing_ms": 0.1406159480437156, "mean_env_wait_ms": 0.0843792472389627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000333786010742, "StateBufferConnector_ms": 0.008271217346191406, "ViewRequirementAgentConnector_ms": 0.13933634757995605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5319.27363485254, "num_env_steps_trained_throughput_per_sec": 5319.27363485254, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2143.297, "sample_time_ms": 1923.149, "load_time_ms": 13.28, "load_throughput": 903604.029, "learn_time_ms": 195.054, "learn_throughput": 61521.566, "synch_weights_time_ms": 10.156}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2033, "training_iteration": 45, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-17", "timestamp": 1698249797, "time_this_iter_s": 2.26094388961792, "time_total_s": 96.81619167327881, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.81619167327881, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 58.93333333333334, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 7.148337894015842, "policy_loss": -0.00028291758563783433, "vf_loss": 7.1486777729458275, "vf_explained_var": -4.834598965115017e-07, "kl": 0.00019617713043847593, "entropy": 0.5694651868608263, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 410.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.33299999999987, "episode_len_mean": 222.4, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.699999999999854, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 36.50000000000003, 44.7, 34.70000000000004, 46.5, 42.900000000000006, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 32.700000000000024, 43.50000000000001, 47.3, -50.00000000000044, 41.500000000000014, 44.7, 41.70000000000002, 12.299999999999734, 34.10000000000004, 38.700000000000024, 20.899999999999856, 44.5, 41.70000000000002, 44.5, -50.00000000000044, 42.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, 31.900000000000013, 46.3, -50.00000000000044, 12.69999999999974, -50.00000000000044, 46.3, 42.900000000000006, 42.500000000000014, 44.10000000000001, 34.900000000000034, 22.49999999999988, 43.10000000000001, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 40.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 19.09999999999983, -50.00000000000044, 28.29999999999996, 22.099999999999874, 27.899999999999956, 34.50000000000004, 42.30000000000001, 43.7, 43.50000000000001, 43.900000000000006, -50.00000000000044, 42.500000000000014, 33.10000000000003, 41.90000000000001, 42.500000000000014, 2.8999999999996007, 35.900000000000034, -50.00000000000044, 36.10000000000004, 42.900000000000006, 43.7, -50.00000000000044, 37.300000000000026, 38.300000000000026, 35.900000000000034, 45.3, 46.3, -50.00000000000044, 36.70000000000003], "episode_lengths": [294, 90, 500, 500, 70, 500, 500, 82, 500, 88, 136, 54, 154, 36, 72, 500, 34, 164, 500, 174, 66, 28, 500, 86, 54, 84, 378, 160, 114, 292, 56, 84, 56, 500, 72, 266, 500, 500, 182, 38, 500, 374, 500, 38, 72, 76, 60, 152, 276, 70, 30, 500, 40, 500, 74, 94, 500, 58, 500, 60, 500, 78, 54, 500, 500, 106, 58, 500, 98, 50, 500, 310, 500, 218, 280, 222, 156, 78, 64, 66, 62, 500, 76, 170, 82, 76, 472, 142, 500, 140, 72, 64, 500, 128, 118, 142, 48, 38, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37961815641914926, "mean_inference_ms": 1.2216712614665957, "mean_action_processing_ms": 0.1402623343260674, "mean_env_wait_ms": 0.08427587299012027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030116796493530273, "StateBufferConnector_ms": 0.0072672367095947266, "ViewRequirementAgentConnector_ms": 0.11564159393310547}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.33299999999987, "episode_len_mean": 222.4, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.699999999999854, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 36.50000000000003, 44.7, 34.70000000000004, 46.5, 42.900000000000006, -50.00000000000044, 46.699999999999996, 33.70000000000004, -50.00000000000044, 32.700000000000024, 43.50000000000001, 47.3, -50.00000000000044, 41.500000000000014, 44.7, 41.70000000000002, 12.299999999999734, 34.10000000000004, 38.700000000000024, 20.899999999999856, 44.5, 41.70000000000002, 44.5, -50.00000000000044, 42.900000000000006, 23.499999999999893, -50.00000000000044, -50.00000000000044, 31.900000000000013, 46.3, -50.00000000000044, 12.69999999999974, -50.00000000000044, 46.3, 42.900000000000006, 42.500000000000014, 44.10000000000001, 34.900000000000034, 22.49999999999988, 43.10000000000001, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 40.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 19.09999999999983, -50.00000000000044, 28.29999999999996, 22.099999999999874, 27.899999999999956, 34.50000000000004, 42.30000000000001, 43.7, 43.50000000000001, 43.900000000000006, -50.00000000000044, 42.500000000000014, 33.10000000000003, 41.90000000000001, 42.500000000000014, 2.8999999999996007, 35.900000000000034, -50.00000000000044, 36.10000000000004, 42.900000000000006, 43.7, -50.00000000000044, 37.300000000000026, 38.300000000000026, 35.900000000000034, 45.3, 46.3, -50.00000000000044, 36.70000000000003], "episode_lengths": [294, 90, 500, 500, 70, 500, 500, 82, 500, 88, 136, 54, 154, 36, 72, 500, 34, 164, 500, 174, 66, 28, 500, 86, 54, 84, 378, 160, 114, 292, 56, 84, 56, 500, 72, 266, 500, 500, 182, 38, 500, 374, 500, 38, 72, 76, 60, 152, 276, 70, 30, 500, 40, 500, 74, 94, 500, 58, 500, 60, 500, 78, 54, 500, 500, 106, 58, 500, 98, 50, 500, 310, 500, 218, 280, 222, 156, 78, 64, 66, 62, 500, 76, 170, 82, 76, 472, 142, 500, 140, 72, 64, 500, 128, 118, 142, 48, 38, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37961815641914926, "mean_inference_ms": 1.2216712614665957, "mean_action_processing_ms": 0.1402623343260674, "mean_env_wait_ms": 0.08427587299012027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030116796493530273, "StateBufferConnector_ms": 0.0072672367095947266, "ViewRequirementAgentConnector_ms": 0.11564159393310547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5858.970251886729, "num_env_steps_trained_throughput_per_sec": 5858.970251886729, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2135.495, "sample_time_ms": 1924.919, "load_time_ms": 12.4, "load_throughput": 967745.091, "learn_time_ms": 186.258, "learn_throughput": 64426.596, "synch_weights_time_ms": 10.256}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2092, "training_iteration": 46, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-19", "timestamp": 1698249799, "time_this_iter_s": 2.0529565811157227, "time_total_s": 98.86914825439453, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.86914825439453, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 56.76666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 6.540219148000081, "policy_loss": 0.00016376458936267428, "vf_loss": 6.540107409159343, "vf_explained_var": -2.8477774726019966e-06, "kl": 8.770955993339966e-05, "entropy": 0.5207061568895975, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.153999999999836, "episode_len_mean": 249.12, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, 46.3, -50.00000000000044, 12.69999999999974, -50.00000000000044, 46.3, 42.900000000000006, 42.500000000000014, 44.10000000000001, 34.900000000000034, 22.49999999999988, 43.10000000000001, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 40.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 19.09999999999983, -50.00000000000044, 28.29999999999996, 22.099999999999874, 27.899999999999956, 34.50000000000004, 42.30000000000001, 43.7, 43.50000000000001, 43.900000000000006, -50.00000000000044, 42.500000000000014, 33.10000000000003, 41.90000000000001, 42.500000000000014, 2.8999999999996007, 35.900000000000034, -50.00000000000044, 36.10000000000004, 42.900000000000006, 43.7, -50.00000000000044, 37.300000000000026, 38.300000000000026, 35.900000000000034, 45.3, 46.3, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.300000000000004, 12.899999999999743, 37.300000000000026, -50.00000000000044, -50.00000000000044, 36.70000000000003, 2.0999999999995893, 43.900000000000006, -50.00000000000044, 44.5, 45.5, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 41.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 22.899999999999885, 39.90000000000002], "episode_lengths": [182, 38, 500, 374, 500, 38, 72, 76, 60, 152, 276, 70, 30, 500, 40, 500, 74, 94, 500, 58, 500, 60, 500, 78, 54, 500, 500, 106, 58, 500, 98, 50, 500, 310, 500, 218, 280, 222, 156, 78, 64, 66, 62, 500, 76, 170, 82, 76, 472, 142, 500, 140, 72, 64, 500, 128, 118, 142, 48, 38, 500, 134, 500, 500, 500, 500, 500, 500, 32, 58, 372, 128, 500, 500, 134, 480, 62, 500, 56, 46, 56, 500, 500, 36, 86, 118, 500, 500, 80, 52, 500, 500, 74, 500, 56, 500, 116, 500, 272, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794863976098128, "mean_inference_ms": 1.221304810304483, "mean_action_processing_ms": 0.1402179790741692, "mean_env_wait_ms": 0.08432408695285985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02915477752685547, "StateBufferConnector_ms": 0.010061502456665039, "ViewRequirementAgentConnector_ms": 0.11574220657348633}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.153999999999836, "episode_len_mean": 249.12, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, 46.3, -50.00000000000044, 12.69999999999974, -50.00000000000044, 46.3, 42.900000000000006, 42.500000000000014, 44.10000000000001, 34.900000000000034, 22.49999999999988, 43.10000000000001, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.70000000000001, 40.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.300000000000004, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, 19.09999999999983, -50.00000000000044, 28.29999999999996, 22.099999999999874, 27.899999999999956, 34.50000000000004, 42.30000000000001, 43.7, 43.50000000000001, 43.900000000000006, -50.00000000000044, 42.500000000000014, 33.10000000000003, 41.90000000000001, 42.500000000000014, 2.8999999999996007, 35.900000000000034, -50.00000000000044, 36.10000000000004, 42.900000000000006, 43.7, -50.00000000000044, 37.300000000000026, 38.300000000000026, 35.900000000000034, 45.3, 46.3, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.300000000000004, 12.899999999999743, 37.300000000000026, -50.00000000000044, -50.00000000000044, 36.70000000000003, 2.0999999999995893, 43.900000000000006, -50.00000000000044, 44.5, 45.5, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 41.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 22.899999999999885, 39.90000000000002], "episode_lengths": [182, 38, 500, 374, 500, 38, 72, 76, 60, 152, 276, 70, 30, 500, 40, 500, 74, 94, 500, 58, 500, 60, 500, 78, 54, 500, 500, 106, 58, 500, 98, 50, 500, 310, 500, 218, 280, 222, 156, 78, 64, 66, 62, 500, 76, 170, 82, 76, 472, 142, 500, 140, 72, 64, 500, 128, 118, 142, 48, 38, 500, 134, 500, 500, 500, 500, 500, 500, 32, 58, 372, 128, 500, 500, 134, 480, 62, 500, 56, 46, 56, 500, 500, 36, 86, 118, 500, 500, 80, 52, 500, 500, 74, 500, 56, 500, 116, 500, 272, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794863976098128, "mean_inference_ms": 1.221304810304483, "mean_action_processing_ms": 0.1402179790741692, "mean_env_wait_ms": 0.08432408695285985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02915477752685547, "StateBufferConnector_ms": 0.010061502456665039, "ViewRequirementAgentConnector_ms": 0.11574220657348633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5246.7784657079055, "num_env_steps_trained_throughput_per_sec": 5246.7784657079055, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2153.511, "sample_time_ms": 1920.978, "load_time_ms": 13.474, "load_throughput": 890575.006, "learn_time_ms": 207.32, "learn_throughput": 57881.456, "synch_weights_time_ms": 10.276}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2130, "training_iteration": 47, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-21", "timestamp": 1698249801, "time_this_iter_s": 2.292121648788452, "time_total_s": 101.16126990318298, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.16126990318298, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 61.96666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 6.26467858420478, "policy_loss": -0.00016752216551038955, "vf_loss": 6.264897611406115, "vf_explained_var": -5.563100179036459e-07, "kl": 8.940711451859645e-05, "entropy": 0.5157719353834788, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.250999999999822, "episode_len_mean": 263.12, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 42.500000000000014, 2.8999999999996007, 35.900000000000034, -50.00000000000044, 36.10000000000004, 42.900000000000006, 43.7, -50.00000000000044, 37.300000000000026, 38.300000000000026, 35.900000000000034, 45.3, 46.3, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.300000000000004, 12.899999999999743, 37.300000000000026, -50.00000000000044, -50.00000000000044, 36.70000000000003, 2.0999999999995893, 43.900000000000006, -50.00000000000044, 44.5, 45.5, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 41.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 22.899999999999885, 39.90000000000002, 13.499999999999751, 41.100000000000016, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 42.900000000000006, 45.3, 46.9, 39.300000000000026, 44.300000000000004, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 46.3, 5.299999999999635, 43.10000000000001, 13.099999999999746, 38.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 45.3, 33.30000000000003, -50.00000000000044, 36.900000000000034, 42.500000000000014, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [82, 76, 472, 142, 500, 140, 72, 64, 500, 128, 118, 142, 48, 38, 500, 134, 500, 500, 500, 500, 500, 500, 32, 58, 372, 128, 500, 500, 134, 480, 62, 500, 56, 46, 56, 500, 500, 36, 86, 118, 500, 500, 80, 52, 500, 500, 74, 500, 56, 500, 116, 500, 272, 102, 366, 90, 258, 500, 500, 76, 86, 500, 72, 48, 32, 108, 58, 54, 500, 64, 500, 118, 98, 76, 500, 500, 202, 500, 38, 448, 70, 370, 120, 500, 134, 50, 500, 48, 168, 500, 132, 76, 48, 500, 174, 500, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37969866675746927, "mean_inference_ms": 1.2212776915608161, "mean_action_processing_ms": 0.14033733070693363, "mean_env_wait_ms": 0.08442572800330254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02419590950012207, "StateBufferConnector_ms": 0.010052680969238281, "ViewRequirementAgentConnector_ms": 0.12178349494934082}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.250999999999822, "episode_len_mean": 263.12, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 42.500000000000014, 2.8999999999996007, 35.900000000000034, -50.00000000000044, 36.10000000000004, 42.900000000000006, 43.7, -50.00000000000044, 37.300000000000026, 38.300000000000026, 35.900000000000034, 45.3, 46.3, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.300000000000004, 12.899999999999743, 37.300000000000026, -50.00000000000044, -50.00000000000044, 36.70000000000003, 2.0999999999995893, 43.900000000000006, -50.00000000000044, 44.5, 45.5, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 41.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 22.899999999999885, 39.90000000000002, 13.499999999999751, 41.100000000000016, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 42.900000000000006, 45.3, 46.9, 39.300000000000026, 44.300000000000004, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 46.3, 5.299999999999635, 43.10000000000001, 13.099999999999746, 38.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 45.3, 33.30000000000003, -50.00000000000044, 36.900000000000034, 42.500000000000014, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [82, 76, 472, 142, 500, 140, 72, 64, 500, 128, 118, 142, 48, 38, 500, 134, 500, 500, 500, 500, 500, 500, 32, 58, 372, 128, 500, 500, 134, 480, 62, 500, 56, 46, 56, 500, 500, 36, 86, 118, 500, 500, 80, 52, 500, 500, 74, 500, 56, 500, 116, 500, 272, 102, 366, 90, 258, 500, 500, 76, 86, 500, 72, 48, 32, 108, 58, 54, 500, 64, 500, 118, 98, 76, 500, 500, 202, 500, 38, 448, 70, 370, 120, 500, 134, 50, 500, 48, 168, 500, 132, 76, 48, 500, 174, 500, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37969866675746927, "mean_inference_ms": 1.2212776915608161, "mean_action_processing_ms": 0.14033733070693363, "mean_env_wait_ms": 0.08442572800330254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02419590950012207, "StateBufferConnector_ms": 0.010052680969238281, "ViewRequirementAgentConnector_ms": 0.12178349494934082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5736.499835307553, "num_env_steps_trained_throughput_per_sec": 5736.499835307553, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2140.577, "sample_time_ms": 1921.131, "load_time_ms": 13.067, "load_throughput": 918309.913, "learn_time_ms": 194.519, "learn_throughput": 61690.777, "synch_weights_time_ms": 10.397}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2176, "training_iteration": 48, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-23", "timestamp": 1698249803, "time_this_iter_s": 2.096863031387329, "time_total_s": 103.25813293457031, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 103.25813293457031, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 56.6, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 7.133334954579671, "policy_loss": -0.00028426945209503174, "vf_loss": 7.133669376373291, "vf_explained_var": 9.470515780978733e-07, "kl": 0.0003241319391615131, "entropy": 0.5032131969928741, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 437.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.193999999999818, "episode_len_mean": 268.7, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 22.899999999999885, 39.90000000000002, 13.499999999999751, 41.100000000000016, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 42.900000000000006, 45.3, 46.9, 39.300000000000026, 44.300000000000004, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 46.3, 5.299999999999635, 43.10000000000001, 13.099999999999746, 38.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 45.3, 33.30000000000003, -50.00000000000044, 36.900000000000034, 42.500000000000014, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.299999999999848, 37.70000000000003, 23.29999999999989, 36.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 17.499999999999808, 42.10000000000001, 2.299999999999592, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 43.10000000000001, 44.10000000000001, -50.00000000000044, 29.49999999999998, 42.900000000000006, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 24.099999999999902, 40.500000000000014, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 35.900000000000034, 17.69999999999981, 40.70000000000002, 28.499999999999964], "episode_lengths": [500, 74, 500, 56, 500, 116, 500, 272, 102, 366, 90, 258, 500, 500, 76, 86, 500, 72, 48, 32, 108, 58, 54, 500, 64, 500, 118, 98, 76, 500, 500, 202, 500, 38, 448, 70, 370, 120, 500, 134, 50, 500, 48, 168, 500, 132, 76, 48, 500, 174, 500, 500, 500, 58, 500, 500, 298, 124, 268, 136, 48, 500, 500, 500, 250, 326, 80, 478, 500, 500, 58, 500, 500, 52, 492, 500, 70, 60, 500, 206, 72, 40, 500, 34, 500, 500, 62, 70, 500, 260, 96, 500, 30, 58, 500, 66, 142, 324, 94, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37977285060174737, "mean_inference_ms": 1.2211299169255623, "mean_action_processing_ms": 0.14020872975981027, "mean_env_wait_ms": 0.0844099077517031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02015233039855957, "StateBufferConnector_ms": 0.005559206008911133, "ViewRequirementAgentConnector_ms": 0.13326787948608398}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.193999999999818, "episode_len_mean": 268.7, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 22.899999999999885, 39.90000000000002, 13.499999999999751, 41.100000000000016, 24.299999999999905, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 42.900000000000006, 45.3, 46.9, 39.300000000000026, 44.300000000000004, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.300000000000026, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 46.3, 5.299999999999635, 43.10000000000001, 13.099999999999746, 38.10000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 45.3, 33.30000000000003, -50.00000000000044, 36.900000000000034, 42.500000000000014, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.299999999999848, 37.70000000000003, 23.29999999999989, 36.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 17.499999999999808, 42.10000000000001, 2.299999999999592, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 43.10000000000001, 44.10000000000001, -50.00000000000044, 29.49999999999998, 42.900000000000006, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 24.099999999999902, 40.500000000000014, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 35.900000000000034, 17.69999999999981, 40.70000000000002, 28.499999999999964], "episode_lengths": [500, 74, 500, 56, 500, 116, 500, 272, 102, 366, 90, 258, 500, 500, 76, 86, 500, 72, 48, 32, 108, 58, 54, 500, 64, 500, 118, 98, 76, 500, 500, 202, 500, 38, 448, 70, 370, 120, 500, 134, 50, 500, 48, 168, 500, 132, 76, 48, 500, 174, 500, 500, 500, 58, 500, 500, 298, 124, 268, 136, 48, 500, 500, 500, 250, 326, 80, 478, 500, 500, 58, 500, 500, 52, 492, 500, 70, 60, 500, 206, 72, 40, 500, 34, 500, 500, 62, 70, 500, 260, 96, 500, 30, 58, 500, 66, 142, 324, 94, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37977285060174737, "mean_inference_ms": 1.2211299169255623, "mean_action_processing_ms": 0.14020872975981027, "mean_env_wait_ms": 0.0844099077517031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02015233039855957, "StateBufferConnector_ms": 0.005559206008911133, "ViewRequirementAgentConnector_ms": 0.13326787948608398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5281.286505710748, "num_env_steps_trained_throughput_per_sec": 5281.286505710748, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2168.845, "sample_time_ms": 1933.84, "load_time_ms": 14.051, "load_throughput": 854031.242, "learn_time_ms": 208.683, "learn_throughput": 57503.423, "synch_weights_time_ms": 10.808}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2221, "training_iteration": 49, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-25", "timestamp": 1698249805, "time_this_iter_s": 2.2771668434143066, "time_total_s": 105.53529977798462, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.53529977798462, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 56.724999999999994, "ram_util_percent": 27.299999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 6.7649215592278376, "policy_loss": 0.0001427212523089515, "vf_loss": 6.764830907185872, "vf_explained_var": -7.020102606879341e-07, "kl": 3.4481469280459955e-05, "entropy": 0.5187424454424117, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4359999999998148, "episode_len_mean": 276.26, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 42.500000000000014, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.299999999999848, 37.70000000000003, 23.29999999999989, 36.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 17.499999999999808, 42.10000000000001, 2.299999999999592, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 43.10000000000001, 44.10000000000001, -50.00000000000044, 29.49999999999998, 42.900000000000006, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 24.099999999999902, 40.500000000000014, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 35.900000000000034, 17.69999999999981, 40.70000000000002, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.5, 27.299999999999947, 36.50000000000003, 15.299999999999777, -50.00000000000044, 41.500000000000014, 46.099999999999994, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 26.09999999999993, 39.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 20.299999999999848, 26.09999999999993, 37.10000000000003, 33.30000000000003, 38.300000000000026, 44.900000000000006, 32.100000000000016], "episode_lengths": [500, 132, 76, 48, 500, 174, 500, 500, 500, 58, 500, 500, 298, 124, 268, 136, 48, 500, 500, 500, 250, 326, 80, 478, 500, 500, 58, 500, 500, 52, 492, 500, 70, 60, 500, 206, 72, 40, 500, 34, 500, 500, 62, 70, 500, 260, 96, 500, 30, 58, 500, 66, 142, 324, 94, 216, 500, 500, 500, 60, 98, 46, 500, 500, 154, 500, 56, 228, 136, 348, 500, 86, 40, 50, 38, 500, 500, 90, 240, 108, 84, 500, 500, 500, 76, 500, 60, 134, 500, 500, 52, 258, 500, 298, 240, 130, 168, 118, 52, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3798907833180738, "mean_inference_ms": 1.2222099884032545, "mean_action_processing_ms": 0.14051352506700066, "mean_env_wait_ms": 0.0844518715010156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01417994499206543, "StateBufferConnector_ms": 0.0060274600982666016, "ViewRequirementAgentConnector_ms": 0.12534141540527344}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4359999999998148, "episode_len_mean": 276.26, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, 42.500000000000014, 45.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 20.299999999999848, 37.70000000000003, 23.29999999999989, 36.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 17.499999999999808, 42.10000000000001, 2.299999999999592, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 43.10000000000001, 44.10000000000001, -50.00000000000044, 29.49999999999998, 42.900000000000006, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 24.099999999999902, 40.500000000000014, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 35.900000000000034, 17.69999999999981, 40.70000000000002, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.5, 27.299999999999947, 36.50000000000003, 15.299999999999777, -50.00000000000044, 41.500000000000014, 46.099999999999994, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 26.09999999999993, 39.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 20.299999999999848, 26.09999999999993, 37.10000000000003, 33.30000000000003, 38.300000000000026, 44.900000000000006, 32.100000000000016], "episode_lengths": [500, 132, 76, 48, 500, 174, 500, 500, 500, 58, 500, 500, 298, 124, 268, 136, 48, 500, 500, 500, 250, 326, 80, 478, 500, 500, 58, 500, 500, 52, 492, 500, 70, 60, 500, 206, 72, 40, 500, 34, 500, 500, 62, 70, 500, 260, 96, 500, 30, 58, 500, 66, 142, 324, 94, 216, 500, 500, 500, 60, 98, 46, 500, 500, 154, 500, 56, 228, 136, 348, 500, 86, 40, 50, 38, 500, 500, 90, 240, 108, 84, 500, 500, 500, 76, 500, 60, 134, 500, 500, 52, 258, 500, 298, 240, 130, 168, 118, 52, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3798907833180738, "mean_inference_ms": 1.2222099884032545, "mean_action_processing_ms": 0.14051352506700066, "mean_env_wait_ms": 0.0844518715010156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01417994499206543, "StateBufferConnector_ms": 0.0060274600982666016, "ViewRequirementAgentConnector_ms": 0.12534141540527344}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5882.328301943244, "num_env_steps_trained_throughput_per_sec": 5882.328301943244, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2141.885, "sample_time_ms": 1931.576, "load_time_ms": 12.772, "load_throughput": 939578.967, "learn_time_ms": 185.574, "learn_throughput": 64664.378, "synch_weights_time_ms": 10.502}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2265, "training_iteration": 50, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-27", "timestamp": 1698249807, "time_this_iter_s": 2.045271158218384, "time_total_s": 107.580570936203, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.580570936203, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 67.2, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 6.43217584821913, "policy_loss": -0.00019858720608883433, "vf_loss": 6.432427141401503, "vf_explained_var": -5.03328111436632e-07, "kl": 0.00012743488048805318, "entropy": 0.5284397833877139, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9959999999998255, "episode_len_mean": 270.68, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 24.099999999999902, 40.500000000000014, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 35.900000000000034, 17.69999999999981, 40.70000000000002, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.5, 27.299999999999947, 36.50000000000003, 15.299999999999777, -50.00000000000044, 41.500000000000014, 46.099999999999994, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 26.09999999999993, 39.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 20.299999999999848, 26.09999999999993, 37.10000000000003, 33.30000000000003, 38.300000000000026, 44.900000000000006, 32.100000000000016, -50.00000000000044, 25.099999999999916, 39.50000000000002, 47.1, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 7.699999999999669, 42.70000000000001, 35.10000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 36.900000000000034, 35.900000000000034, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.900000000000006, 41.90000000000001, 45.7, 31.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.300000000000026, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 34.70000000000004, 24.69999999999991], "episode_lengths": [34, 500, 500, 62, 70, 500, 260, 96, 500, 30, 58, 500, 66, 142, 324, 94, 216, 500, 500, 500, 60, 98, 46, 500, 500, 154, 500, 56, 228, 136, 348, 500, 86, 40, 50, 38, 500, 500, 90, 240, 108, 84, 500, 500, 500, 76, 500, 60, 134, 500, 500, 52, 258, 500, 298, 240, 130, 168, 118, 52, 180, 500, 250, 106, 30, 500, 162, 500, 500, 96, 424, 74, 150, 500, 124, 500, 500, 500, 44, 46, 132, 142, 500, 308, 500, 72, 82, 44, 190, 500, 470, 500, 500, 62, 128, 500, 500, 444, 154, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37975612557007404, "mean_inference_ms": 1.222360794905646, "mean_action_processing_ms": 0.14067844640534014, "mean_env_wait_ms": 0.08453929291154955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023973941802978516, "StateBufferConnector_ms": 0.004479646682739258, "ViewRequirementAgentConnector_ms": 0.11855769157409668}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9959999999998255, "episode_len_mean": 270.68, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 24.099999999999902, 40.500000000000014, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 35.900000000000034, 17.69999999999981, 40.70000000000002, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.5, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.5, 27.299999999999947, 36.50000000000003, 15.299999999999777, -50.00000000000044, 41.500000000000014, 46.099999999999994, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.100000000000016, 26.09999999999993, 39.300000000000026, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.10000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 20.299999999999848, 26.09999999999993, 37.10000000000003, 33.30000000000003, 38.300000000000026, 44.900000000000006, 32.100000000000016, -50.00000000000044, 25.099999999999916, 39.50000000000002, 47.1, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 7.699999999999669, 42.70000000000001, 35.10000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 36.900000000000034, 35.900000000000034, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.900000000000006, 41.90000000000001, 45.7, 31.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.300000000000026, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 34.70000000000004, 24.69999999999991], "episode_lengths": [34, 500, 500, 62, 70, 500, 260, 96, 500, 30, 58, 500, 66, 142, 324, 94, 216, 500, 500, 500, 60, 98, 46, 500, 500, 154, 500, 56, 228, 136, 348, 500, 86, 40, 50, 38, 500, 500, 90, 240, 108, 84, 500, 500, 500, 76, 500, 60, 134, 500, 500, 52, 258, 500, 298, 240, 130, 168, 118, 52, 180, 500, 250, 106, 30, 500, 162, 500, 500, 96, 424, 74, 150, 500, 124, 500, 500, 500, 44, 46, 132, 142, 500, 308, 500, 72, 82, 44, 190, 500, 470, 500, 500, 62, 128, 500, 500, 444, 154, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37975612557007404, "mean_inference_ms": 1.222360794905646, "mean_action_processing_ms": 0.14067844640534014, "mean_env_wait_ms": 0.08453929291154955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023973941802978516, "StateBufferConnector_ms": 0.004479646682739258, "ViewRequirementAgentConnector_ms": 0.11855769157409668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5239.698520554551, "num_env_steps_trained_throughput_per_sec": 5239.698520554551, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2170.655, "sample_time_ms": 1940.126, "load_time_ms": 13.953, "load_throughput": 860058.372, "learn_time_ms": 204.713, "learn_throughput": 58618.771, "synch_weights_time_ms": 10.503}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2304, "training_iteration": 51, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-30", "timestamp": 1698249810, "time_this_iter_s": 2.295213460922241, "time_total_s": 109.87578439712524, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.87578439712524, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 58.125, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 6.573841571807861, "policy_loss": 6.4232490128941e-05, "vf_loss": 6.573832035064697, "vf_explained_var": -3.483560350206163e-06, "kl": 8.694583750133865e-05, "entropy": 0.5445368356174893, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 464.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.680999999999838, "episode_len_mean": 258.88, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 20.299999999999848, 26.09999999999993, 37.10000000000003, 33.30000000000003, 38.300000000000026, 44.900000000000006, 32.100000000000016, -50.00000000000044, 25.099999999999916, 39.50000000000002, 47.1, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 7.699999999999669, 42.70000000000001, 35.10000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 36.900000000000034, 35.900000000000034, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.900000000000006, 41.90000000000001, 45.7, 31.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.300000000000026, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 34.70000000000004, 24.69999999999991, 30.499999999999993, 41.100000000000016, 44.300000000000004, 32.90000000000003, 43.7, 19.299999999999834, 38.10000000000002, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.70000000000003, 29.899999999999984, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.1, 41.500000000000014, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 0.49999999999956657, 41.30000000000001, 33.500000000000036, 0.2999999999995637, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 39.70000000000002, 40.500000000000014, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.099999999999994, 42.70000000000001, 23.8999999999999, 29.69999999999998, -50.00000000000044, 5.499999999999638, 33.10000000000003, -50.00000000000044, 44.10000000000001, 47.1], "episode_lengths": [500, 52, 258, 500, 298, 240, 130, 168, 118, 52, 180, 500, 250, 106, 30, 500, 162, 500, 500, 96, 424, 74, 150, 500, 124, 500, 500, 500, 44, 46, 132, 142, 500, 308, 500, 72, 82, 44, 190, 500, 470, 500, 500, 62, 128, 500, 500, 444, 154, 254, 196, 90, 58, 172, 64, 308, 120, 102, 500, 40, 500, 144, 202, 40, 500, 40, 50, 86, 500, 146, 500, 78, 48, 500, 496, 88, 166, 498, 50, 500, 500, 500, 500, 36, 104, 96, 42, 500, 58, 500, 40, 74, 262, 204, 500, 446, 170, 500, 60, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37948368069944105, "mean_inference_ms": 1.2225331664177066, "mean_action_processing_ms": 0.14023700716881726, "mean_env_wait_ms": 0.08453345670896178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025495052337646484, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.11165118217468262}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.680999999999838, "episode_len_mean": 258.88, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 24.299999999999905, -50.00000000000044, 20.299999999999848, 26.09999999999993, 37.10000000000003, 33.30000000000003, 38.300000000000026, 44.900000000000006, 32.100000000000016, -50.00000000000044, 25.099999999999916, 39.50000000000002, 47.1, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 7.699999999999669, 42.70000000000001, 35.10000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 36.900000000000034, 35.900000000000034, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.900000000000006, 41.90000000000001, 45.7, 31.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.300000000000026, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 34.70000000000004, 24.69999999999991, 30.499999999999993, 41.100000000000016, 44.300000000000004, 32.90000000000003, 43.7, 19.299999999999834, 38.10000000000002, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.70000000000003, 29.899999999999984, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.1, 41.500000000000014, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 0.49999999999956657, 41.30000000000001, 33.500000000000036, 0.2999999999995637, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 39.70000000000002, 40.500000000000014, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.099999999999994, 42.70000000000001, 23.8999999999999, 29.69999999999998, -50.00000000000044, 5.499999999999638, 33.10000000000003, -50.00000000000044, 44.10000000000001, 47.1], "episode_lengths": [500, 52, 258, 500, 298, 240, 130, 168, 118, 52, 180, 500, 250, 106, 30, 500, 162, 500, 500, 96, 424, 74, 150, 500, 124, 500, 500, 500, 44, 46, 132, 142, 500, 308, 500, 72, 82, 44, 190, 500, 470, 500, 500, 62, 128, 500, 500, 444, 154, 254, 196, 90, 58, 172, 64, 308, 120, 102, 500, 40, 500, 144, 202, 40, 500, 40, 50, 86, 500, 146, 500, 78, 48, 500, 496, 88, 166, 498, 50, 500, 500, 500, 500, 36, 104, 96, 42, 500, 58, 500, 40, 74, 262, 204, 500, 446, 170, 500, 60, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37948368069944105, "mean_inference_ms": 1.2225331664177066, "mean_action_processing_ms": 0.14023700716881726, "mean_env_wait_ms": 0.08453345670896178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025495052337646484, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.11165118217468262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5701.523626507943, "num_env_steps_trained_throughput_per_sec": 5701.523626507943, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2161.925, "sample_time_ms": 1938.532, "load_time_ms": 13.05, "load_throughput": 919561.519, "learn_time_ms": 198.302, "learn_throughput": 60513.738, "synch_weights_time_ms": 10.78}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2354, "training_iteration": 52, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-32", "timestamp": 1698249812, "time_this_iter_s": 2.109694719314575, "time_total_s": 111.98547911643982, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.98547911643982, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 27.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 7.158441543579102, "policy_loss": -7.029043303595649e-05, "vf_loss": 7.158566739824083, "vf_explained_var": -1.5232298109266492e-07, "kl": 7.856509658192105e-05, "entropy": 0.5510218342145284, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.865999999999849, "episode_len_mean": 242.06, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.300000000000004, 32.90000000000003, 43.7, 19.299999999999834, 38.10000000000002, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.70000000000003, 29.899999999999984, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.1, 41.500000000000014, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 0.49999999999956657, 41.30000000000001, 33.500000000000036, 0.2999999999995637, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 39.70000000000002, 40.500000000000014, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.099999999999994, 42.70000000000001, 23.8999999999999, 29.69999999999998, -50.00000000000044, 5.499999999999638, 33.10000000000003, -50.00000000000044, 44.10000000000001, 47.1, 43.7, 43.900000000000006, 36.30000000000003, -50.00000000000044, 8.49999999999968, 36.70000000000003, 46.5, 41.30000000000001, 41.70000000000002, 26.299999999999933, 39.50000000000002, -50.00000000000044, 22.699999999999882, 38.50000000000003, -50.00000000000044, 42.900000000000006, 15.099999999999774, 2.499999999999595, 33.500000000000036, -50.00000000000044, 43.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 10.099999999999703, -50.00000000000044, 21.299999999999862, 44.5, -50.00000000000044, 36.10000000000004, 36.10000000000004, 35.30000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.50000000000003, 45.1, -50.00000000000044, 13.099999999999746, 37.50000000000003, 42.70000000000001, 46.099999999999994, 45.7, 40.90000000000002, 40.30000000000002], "episode_lengths": [90, 58, 172, 64, 308, 120, 102, 500, 40, 500, 144, 202, 40, 500, 40, 50, 86, 500, 146, 500, 78, 48, 500, 496, 88, 166, 498, 50, 500, 500, 500, 500, 36, 104, 96, 42, 500, 58, 500, 40, 74, 262, 204, 500, 446, 170, 500, 60, 30, 64, 62, 138, 500, 416, 134, 36, 88, 84, 238, 106, 500, 274, 116, 500, 72, 350, 476, 166, 500, 64, 68, 500, 500, 38, 54, 500, 500, 500, 182, 400, 500, 288, 56, 500, 140, 140, 148, 500, 90, 500, 116, 50, 500, 370, 126, 74, 40, 44, 92, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795860714792657, "mean_inference_ms": 1.2222617347559612, "mean_action_processing_ms": 0.14063456094023014, "mean_env_wait_ms": 0.08453381961678169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021513938903808594, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.11946702003479004}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.865999999999849, "episode_len_mean": 242.06, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.300000000000004, 32.90000000000003, 43.7, 19.299999999999834, 38.10000000000002, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.70000000000003, 29.899999999999984, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.1, 41.500000000000014, -50.00000000000044, 35.500000000000036, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 0.49999999999956657, 41.30000000000001, 33.500000000000036, 0.2999999999995637, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 39.70000000000002, 40.500000000000014, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.099999999999994, 42.70000000000001, 23.8999999999999, 29.69999999999998, -50.00000000000044, 5.499999999999638, 33.10000000000003, -50.00000000000044, 44.10000000000001, 47.1, 43.7, 43.900000000000006, 36.30000000000003, -50.00000000000044, 8.49999999999968, 36.70000000000003, 46.5, 41.30000000000001, 41.70000000000002, 26.299999999999933, 39.50000000000002, -50.00000000000044, 22.699999999999882, 38.50000000000003, -50.00000000000044, 42.900000000000006, 15.099999999999774, 2.499999999999595, 33.500000000000036, -50.00000000000044, 43.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 10.099999999999703, -50.00000000000044, 21.299999999999862, 44.5, -50.00000000000044, 36.10000000000004, 36.10000000000004, 35.30000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.50000000000003, 45.1, -50.00000000000044, 13.099999999999746, 37.50000000000003, 42.70000000000001, 46.099999999999994, 45.7, 40.90000000000002, 40.30000000000002], "episode_lengths": [90, 58, 172, 64, 308, 120, 102, 500, 40, 500, 144, 202, 40, 500, 40, 50, 86, 500, 146, 500, 78, 48, 500, 496, 88, 166, 498, 50, 500, 500, 500, 500, 36, 104, 96, 42, 500, 58, 500, 40, 74, 262, 204, 500, 446, 170, 500, 60, 30, 64, 62, 138, 500, 416, 134, 36, 88, 84, 238, 106, 500, 274, 116, 500, 72, 350, 476, 166, 500, 64, 68, 500, 500, 38, 54, 500, 500, 500, 182, 400, 500, 288, 56, 500, 140, 140, 148, 500, 90, 500, 116, 50, 500, 370, 126, 74, 40, 44, 92, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795860714792657, "mean_inference_ms": 1.2222617347559612, "mean_action_processing_ms": 0.14063456094023014, "mean_env_wait_ms": 0.08453381961678169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021513938903808594, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.11946702003479004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5403.996206482371, "num_env_steps_trained_throughput_per_sec": 5403.996206482371, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2180.585, "sample_time_ms": 1937.512, "load_time_ms": 13.809, "load_throughput": 869011.142, "learn_time_ms": 217.347, "learn_throughput": 55211.245, "synch_weights_time_ms": 10.731}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2405, "training_iteration": 53, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-34", "timestamp": 1698249814, "time_this_iter_s": 2.2255754470825195, "time_total_s": 114.21105456352234, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.21105456352234, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 27.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 6.8118588129679365, "policy_loss": -4.187971353530884e-05, "vf_loss": 6.811955240037706, "vf_explained_var": -9.5367431640625e-07, "kl": 0.00011432348568184302, "entropy": 0.5466062823931376, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 482.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.109999999999831, "episode_len_mean": 259.56, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.499999999999638, 33.10000000000003, -50.00000000000044, 44.10000000000001, 47.1, 43.7, 43.900000000000006, 36.30000000000003, -50.00000000000044, 8.49999999999968, 36.70000000000003, 46.5, 41.30000000000001, 41.70000000000002, 26.299999999999933, 39.50000000000002, -50.00000000000044, 22.699999999999882, 38.50000000000003, -50.00000000000044, 42.900000000000006, 15.099999999999774, 2.499999999999595, 33.500000000000036, -50.00000000000044, 43.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 10.099999999999703, -50.00000000000044, 21.299999999999862, 44.5, -50.00000000000044, 36.10000000000004, 36.10000000000004, 35.30000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.50000000000003, 45.1, -50.00000000000044, 13.099999999999746, 37.50000000000003, 42.70000000000001, 46.099999999999994, 45.7, 40.90000000000002, 40.30000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 39.10000000000002, 43.50000000000001, 39.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 31.70000000000001, 37.70000000000003, 45.7, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 31.900000000000013, 45.7, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 8.899999999999686, 19.899999999999842, -50.00000000000044, -50.00000000000044], "episode_lengths": [446, 170, 500, 60, 30, 64, 62, 138, 500, 416, 134, 36, 88, 84, 238, 106, 500, 274, 116, 500, 72, 350, 476, 166, 500, 64, 68, 500, 500, 38, 54, 500, 500, 500, 182, 400, 500, 288, 56, 500, 140, 140, 148, 500, 90, 500, 116, 50, 500, 370, 126, 74, 40, 44, 92, 98, 500, 180, 500, 74, 500, 102, 500, 500, 90, 500, 500, 500, 76, 64, 110, 66, 102, 38, 500, 500, 122, 44, 500, 184, 124, 44, 62, 500, 72, 500, 500, 44, 74, 500, 182, 44, 60, 500, 80, 500, 412, 302, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796838367875916, "mean_inference_ms": 1.2219240211520408, "mean_action_processing_ms": 0.1410514415420835, "mean_env_wait_ms": 0.0844721223846448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270230770111084, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.1241147518157959}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.109999999999831, "episode_len_mean": 259.56, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.499999999999638, 33.10000000000003, -50.00000000000044, 44.10000000000001, 47.1, 43.7, 43.900000000000006, 36.30000000000003, -50.00000000000044, 8.49999999999968, 36.70000000000003, 46.5, 41.30000000000001, 41.70000000000002, 26.299999999999933, 39.50000000000002, -50.00000000000044, 22.699999999999882, 38.50000000000003, -50.00000000000044, 42.900000000000006, 15.099999999999774, 2.499999999999595, 33.500000000000036, -50.00000000000044, 43.7, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 10.099999999999703, -50.00000000000044, 21.299999999999862, 44.5, -50.00000000000044, 36.10000000000004, 36.10000000000004, 35.30000000000004, -50.00000000000044, 41.100000000000016, -50.00000000000044, 38.50000000000003, 45.1, -50.00000000000044, 13.099999999999746, 37.50000000000003, 42.70000000000001, 46.099999999999994, 45.7, 40.90000000000002, 40.30000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 39.10000000000002, 43.50000000000001, 39.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 31.70000000000001, 37.70000000000003, 45.7, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 31.900000000000013, 45.7, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 8.899999999999686, 19.899999999999842, -50.00000000000044, -50.00000000000044], "episode_lengths": [446, 170, 500, 60, 30, 64, 62, 138, 500, 416, 134, 36, 88, 84, 238, 106, 500, 274, 116, 500, 72, 350, 476, 166, 500, 64, 68, 500, 500, 38, 54, 500, 500, 500, 182, 400, 500, 288, 56, 500, 140, 140, 148, 500, 90, 500, 116, 50, 500, 370, 126, 74, 40, 44, 92, 98, 500, 180, 500, 74, 500, 102, 500, 500, 90, 500, 500, 500, 76, 64, 110, 66, 102, 38, 500, 500, 122, 44, 500, 184, 124, 44, 62, 500, 72, 500, 500, 44, 74, 500, 182, 44, 60, 500, 80, 500, 412, 302, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796838367875916, "mean_inference_ms": 1.2219240211520408, "mean_action_processing_ms": 0.1410514415420835, "mean_env_wait_ms": 0.0844721223846448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0270230770111084, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.1241147518157959}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5796.879968663551, "num_env_steps_trained_throughput_per_sec": 5796.879968663551, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2168.082, "sample_time_ms": 1940.097, "load_time_ms": 13.008, "load_throughput": 922473.828, "learn_time_ms": 203.369, "learn_throughput": 59006.023, "synch_weights_time_ms": 10.421}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2449, "training_iteration": 54, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-36", "timestamp": 1698249816, "time_this_iter_s": 2.075078010559082, "time_total_s": 116.28613257408142, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.28613257408142, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 61.29999999999999, "ram_util_percent": 27.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 6.839970694647895, "policy_loss": -5.1358300778600906e-06, "vf_loss": 6.840029981401232, "vf_explained_var": 1.1920928955078125e-07, "kl": 7.526719180046055e-05, "entropy": 0.5409960216946073, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.697999999999828, "episode_len_mean": 263.66, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 38.50000000000003, 45.1, -50.00000000000044, 13.099999999999746, 37.50000000000003, 42.70000000000001, 46.099999999999994, 45.7, 40.90000000000002, 40.30000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 39.10000000000002, 43.50000000000001, 39.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 31.70000000000001, 37.70000000000003, 45.7, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 31.900000000000013, 45.7, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 8.899999999999686, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 38.700000000000024, -50.00000000000044, 18.699999999999825, 40.500000000000014, 38.10000000000002, 36.50000000000003, 42.30000000000001, 40.500000000000014, 44.7, 29.899999999999984, 37.10000000000003, 35.900000000000034, 39.300000000000026, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, -50.00000000000044, 8.699999999999683, -50.00000000000044, 42.500000000000014, 35.70000000000003, 37.90000000000003, -50.00000000000044, 36.900000000000034, 13.299999999999748, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 16.499999999999794, -50.00000000000044, 36.30000000000003, 6.699999999999655, 44.7], "episode_lengths": [90, 500, 116, 50, 500, 370, 126, 74, 40, 44, 92, 98, 500, 180, 500, 74, 500, 102, 500, 500, 90, 500, 500, 500, 76, 64, 110, 66, 102, 38, 500, 500, 122, 44, 500, 184, 124, 44, 62, 500, 72, 500, 500, 44, 74, 500, 182, 44, 60, 500, 80, 500, 412, 302, 500, 500, 500, 500, 500, 500, 320, 500, 114, 500, 314, 96, 120, 136, 78, 96, 54, 202, 130, 142, 108, 66, 32, 500, 500, 500, 60, 84, 500, 414, 500, 76, 144, 122, 500, 132, 368, 500, 500, 72, 72, 336, 500, 138, 434, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37942372483476994, "mean_inference_ms": 1.2218612821031802, "mean_action_processing_ms": 0.1409283488993529, "mean_env_wait_ms": 0.08434401412929195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020072221755981445, "StateBufferConnector_ms": 0.004498720169067383, "ViewRequirementAgentConnector_ms": 0.11896038055419922}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.697999999999828, "episode_len_mean": 263.66, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 38.50000000000003, 45.1, -50.00000000000044, 13.099999999999746, 37.50000000000003, 42.70000000000001, 46.099999999999994, 45.7, 40.90000000000002, 40.30000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, 42.70000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 39.10000000000002, 43.50000000000001, 39.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 31.70000000000001, 37.70000000000003, 45.7, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 31.900000000000013, 45.7, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 8.899999999999686, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 38.700000000000024, -50.00000000000044, 18.699999999999825, 40.500000000000014, 38.10000000000002, 36.50000000000003, 42.30000000000001, 40.500000000000014, 44.7, 29.899999999999984, 37.10000000000003, 35.900000000000034, 39.300000000000026, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, -50.00000000000044, 8.699999999999683, -50.00000000000044, 42.500000000000014, 35.70000000000003, 37.90000000000003, -50.00000000000044, 36.900000000000034, 13.299999999999748, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 16.499999999999794, -50.00000000000044, 36.30000000000003, 6.699999999999655, 44.7], "episode_lengths": [90, 500, 116, 50, 500, 370, 126, 74, 40, 44, 92, 98, 500, 180, 500, 74, 500, 102, 500, 500, 90, 500, 500, 500, 76, 64, 110, 66, 102, 38, 500, 500, 122, 44, 500, 184, 124, 44, 62, 500, 72, 500, 500, 44, 74, 500, 182, 44, 60, 500, 80, 500, 412, 302, 500, 500, 500, 500, 500, 500, 320, 500, 114, 500, 314, 96, 120, 136, 78, 96, 54, 202, 130, 142, 108, 66, 32, 500, 500, 500, 60, 84, 500, 414, 500, 76, 144, 122, 500, 132, 368, 500, 500, 72, 72, 336, 500, 138, 434, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37942372483476994, "mean_inference_ms": 1.2218612821031802, "mean_action_processing_ms": 0.1409283488993529, "mean_env_wait_ms": 0.08434401412929195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020072221755981445, "StateBufferConnector_ms": 0.004498720169067383, "ViewRequirementAgentConnector_ms": 0.11896038055419922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.156472176353, "num_env_steps_trained_throughput_per_sec": 5300.156472176353, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2168.896, "sample_time_ms": 1940.057, "load_time_ms": 12.515, "load_throughput": 958875.221, "learn_time_ms": 204.654, "learn_throughput": 58635.536, "synch_weights_time_ms": 10.464}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2493, "training_iteration": 55, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-39", "timestamp": 1698249819, "time_this_iter_s": 2.2710862159729004, "time_total_s": 118.55721879005432, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.55721879005432, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 59.36666666666667, "ram_util_percent": 27.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 6.789378907945421, "policy_loss": -0.00026216916739940643, "vf_loss": 6.789699024624294, "vf_explained_var": 2.914004855685764e-07, "kl": 0.00015526666456051115, "entropy": 0.5777081317371793, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.98399999999984, "episode_len_mean": 260.86, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, 45.7, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 8.899999999999686, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 38.700000000000024, -50.00000000000044, 18.699999999999825, 40.500000000000014, 38.10000000000002, 36.50000000000003, 42.30000000000001, 40.500000000000014, 44.7, 29.899999999999984, 37.10000000000003, 35.900000000000034, 39.300000000000026, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, -50.00000000000044, 8.699999999999683, -50.00000000000044, 42.500000000000014, 35.70000000000003, 37.90000000000003, -50.00000000000044, 36.900000000000034, 13.299999999999748, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 16.499999999999794, -50.00000000000044, 36.30000000000003, 6.699999999999655, 44.7, 23.499999999999893, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 16.699999999999797, 40.10000000000002, 42.500000000000014, 10.099999999999703, 42.10000000000001, 28.499999999999964, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, 45.5, 19.299999999999834, -50.00000000000044, 21.699999999999868, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, 29.899999999999984, 31.300000000000004, 34.30000000000004, -50.00000000000044, 42.70000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 23.29999999999989, -50.00000000000044, 38.50000000000003, 42.500000000000014, 37.70000000000003, 30.9, 42.70000000000001, 43.30000000000001, 46.099999999999994, 43.10000000000001, 36.10000000000004, 22.49999999999988], "episode_lengths": [182, 44, 60, 500, 80, 500, 412, 302, 500, 500, 500, 500, 500, 500, 320, 500, 114, 500, 314, 96, 120, 136, 78, 96, 54, 202, 130, 142, 108, 66, 32, 500, 500, 500, 60, 84, 500, 414, 500, 76, 144, 122, 500, 132, 368, 500, 500, 72, 72, 336, 500, 138, 434, 54, 266, 58, 500, 88, 500, 334, 100, 76, 400, 80, 216, 472, 500, 500, 60, 122, 46, 308, 500, 284, 500, 290, 500, 66, 202, 188, 158, 500, 74, 72, 500, 500, 54, 34, 268, 500, 116, 76, 124, 192, 74, 68, 40, 70, 140, 276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379672128725806, "mean_inference_ms": 1.2226375353697623, "mean_action_processing_ms": 0.14072806435083451, "mean_env_wait_ms": 0.08441329665691737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02321481704711914, "StateBufferConnector_ms": 0.006505489349365234, "ViewRequirementAgentConnector_ms": 0.11472630500793457}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.98399999999984, "episode_len_mean": 260.86, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, 45.7, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 8.899999999999686, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 38.700000000000024, -50.00000000000044, 18.699999999999825, 40.500000000000014, 38.10000000000002, 36.50000000000003, 42.30000000000001, 40.500000000000014, 44.7, 29.899999999999984, 37.10000000000003, 35.900000000000034, 39.300000000000026, 43.50000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, -50.00000000000044, 8.699999999999683, -50.00000000000044, 42.500000000000014, 35.70000000000003, 37.90000000000003, -50.00000000000044, 36.900000000000034, 13.299999999999748, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 16.499999999999794, -50.00000000000044, 36.30000000000003, 6.699999999999655, 44.7, 23.499999999999893, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 16.699999999999797, 40.10000000000002, 42.500000000000014, 10.099999999999703, 42.10000000000001, 28.499999999999964, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, 45.5, 19.299999999999834, -50.00000000000044, 21.699999999999868, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, 29.899999999999984, 31.300000000000004, 34.30000000000004, -50.00000000000044, 42.70000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 23.29999999999989, -50.00000000000044, 38.50000000000003, 42.500000000000014, 37.70000000000003, 30.9, 42.70000000000001, 43.30000000000001, 46.099999999999994, 43.10000000000001, 36.10000000000004, 22.49999999999988], "episode_lengths": [182, 44, 60, 500, 80, 500, 412, 302, 500, 500, 500, 500, 500, 500, 320, 500, 114, 500, 314, 96, 120, 136, 78, 96, 54, 202, 130, 142, 108, 66, 32, 500, 500, 500, 60, 84, 500, 414, 500, 76, 144, 122, 500, 132, 368, 500, 500, 72, 72, 336, 500, 138, 434, 54, 266, 58, 500, 88, 500, 334, 100, 76, 400, 80, 216, 472, 500, 500, 60, 122, 46, 308, 500, 284, 500, 290, 500, 66, 202, 188, 158, 500, 74, 72, 500, 500, 54, 34, 268, 500, 116, 76, 124, 192, 74, 68, 40, 70, 140, 276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379672128725806, "mean_inference_ms": 1.2226375353697623, "mean_action_processing_ms": 0.14072806435083451, "mean_env_wait_ms": 0.08441329665691737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02321481704711914, "StateBufferConnector_ms": 0.006505489349365234, "ViewRequirementAgentConnector_ms": 0.11472630500793457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5797.135689076379, "num_env_steps_trained_throughput_per_sec": 5797.135689076379, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2171.081, "sample_time_ms": 1946.148, "load_time_ms": 12.515, "load_throughput": 958814.941, "learn_time_ms": 200.666, "learn_throughput": 59800.878, "synch_weights_time_ms": 10.449}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2539, "training_iteration": 56, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-41", "timestamp": 1698249821, "time_this_iter_s": 2.074986696243286, "time_total_s": 120.63220548629761, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.63220548629761, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 7.228458298577203, "policy_loss": -3.884898291693794e-05, "vf_loss": 7.228552924262153, "vf_explained_var": -9.139378865559896e-07, "kl": 0.00022226081517197195, "entropy": 0.5591888891326057, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.601999999999833, "episode_len_mean": 264.7, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 42.900000000000006, 16.499999999999794, -50.00000000000044, 36.30000000000003, 6.699999999999655, 44.7, 23.499999999999893, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 16.699999999999797, 40.10000000000002, 42.500000000000014, 10.099999999999703, 42.10000000000001, 28.499999999999964, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, 45.5, 19.299999999999834, -50.00000000000044, 21.699999999999868, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, 29.899999999999984, 31.300000000000004, 34.30000000000004, -50.00000000000044, 42.70000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 23.29999999999989, -50.00000000000044, 38.50000000000003, 42.500000000000014, 37.70000000000003, 30.9, 42.70000000000001, 43.30000000000001, 46.099999999999994, 43.10000000000001, 36.10000000000004, 22.49999999999988, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, 43.7, 42.30000000000001, 7.699999999999669, 39.90000000000002, 7.699999999999669, -50.00000000000044, 0.8999999999995723, 42.900000000000006, 45.7, -50.00000000000044, 26.69999999999994, 42.70000000000001, -50.00000000000044, 28.89999999999997, 5.6999999999996405, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, 43.7, 24.69999999999991, 31.900000000000013, 39.50000000000002, 26.89999999999994, 36.50000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 18.29999999999982, -50.00000000000044, 21.09999999999986, 18.899999999999828, -50.00000000000044, 45.7, 24.499999999999908, -50.00000000000044], "episode_lengths": [500, 72, 72, 336, 500, 138, 434, 54, 266, 58, 500, 88, 500, 334, 100, 76, 400, 80, 216, 472, 500, 500, 60, 122, 46, 308, 500, 284, 500, 290, 500, 66, 202, 188, 158, 500, 74, 72, 500, 500, 54, 34, 268, 500, 116, 76, 124, 192, 74, 68, 40, 70, 140, 276, 500, 500, 340, 500, 500, 56, 128, 64, 78, 424, 102, 424, 500, 492, 72, 44, 500, 234, 74, 500, 212, 444, 130, 500, 500, 102, 52, 64, 254, 182, 106, 232, 136, 500, 116, 500, 90, 500, 318, 500, 290, 312, 500, 44, 256, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37951789304423017, "mean_inference_ms": 1.2221110574270313, "mean_action_processing_ms": 0.14070356558822722, "mean_env_wait_ms": 0.08431954926050182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021261930465698242, "StateBufferConnector_ms": 0.01247549057006836, "ViewRequirementAgentConnector_ms": 0.12673211097717285}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.601999999999833, "episode_len_mean": 264.7, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 42.900000000000006, 16.499999999999794, -50.00000000000044, 36.30000000000003, 6.699999999999655, 44.7, 23.499999999999893, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 16.699999999999797, 40.10000000000002, 42.500000000000014, 10.099999999999703, 42.10000000000001, 28.499999999999964, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.90000000000003, 45.5, 19.299999999999834, -50.00000000000044, 21.699999999999868, -50.00000000000044, 21.09999999999986, -50.00000000000044, 43.50000000000001, 29.899999999999984, 31.300000000000004, 34.30000000000004, -50.00000000000044, 42.70000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 23.29999999999989, -50.00000000000044, 38.50000000000003, 42.500000000000014, 37.70000000000003, 30.9, 42.70000000000001, 43.30000000000001, 46.099999999999994, 43.10000000000001, 36.10000000000004, 22.49999999999988, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, 43.7, 42.30000000000001, 7.699999999999669, 39.90000000000002, 7.699999999999669, -50.00000000000044, 0.8999999999995723, 42.900000000000006, 45.7, -50.00000000000044, 26.69999999999994, 42.70000000000001, -50.00000000000044, 28.89999999999997, 5.6999999999996405, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, 43.7, 24.69999999999991, 31.900000000000013, 39.50000000000002, 26.89999999999994, 36.50000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 18.29999999999982, -50.00000000000044, 21.09999999999986, 18.899999999999828, -50.00000000000044, 45.7, 24.499999999999908, -50.00000000000044], "episode_lengths": [500, 72, 72, 336, 500, 138, 434, 54, 266, 58, 500, 88, 500, 334, 100, 76, 400, 80, 216, 472, 500, 500, 60, 122, 46, 308, 500, 284, 500, 290, 500, 66, 202, 188, 158, 500, 74, 72, 500, 500, 54, 34, 268, 500, 116, 76, 124, 192, 74, 68, 40, 70, 140, 276, 500, 500, 340, 500, 500, 56, 128, 64, 78, 424, 102, 424, 500, 492, 72, 44, 500, 234, 74, 500, 212, 444, 130, 500, 500, 102, 52, 64, 254, 182, 106, 232, 136, 500, 116, 500, 90, 500, 318, 500, 290, 312, 500, 44, 256, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37951789304423017, "mean_inference_ms": 1.2221110574270313, "mean_action_processing_ms": 0.14070356558822722, "mean_env_wait_ms": 0.08431954926050182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021261930465698242, "StateBufferConnector_ms": 0.01247549057006836, "ViewRequirementAgentConnector_ms": 0.12673211097717285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4990.649952122861, "num_env_steps_trained_throughput_per_sec": 4990.649952122861, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2182.819, "sample_time_ms": 1973.278, "load_time_ms": 11.637, "load_throughput": 1031208.726, "learn_time_ms": 186.089, "learn_throughput": 64485.111, "synch_weights_time_ms": 10.512}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2585, "training_iteration": 57, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-43", "timestamp": 1698249823, "time_this_iter_s": 2.4102749824523926, "time_total_s": 123.04248046875, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.04248046875, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 62.76666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 7.485235955980089, "policy_loss": -0.00018203755219777426, "vf_loss": 7.485480149586995, "vf_explained_var": 8.80824195014106e-07, "kl": 0.0002879472475885652, "entropy": 0.6212215423583984, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.49099999999983, "episode_len_mean": 280.78, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.29999999999989, -50.00000000000044, 38.50000000000003, 42.500000000000014, 37.70000000000003, 30.9, 42.70000000000001, 43.30000000000001, 46.099999999999994, 43.10000000000001, 36.10000000000004, 22.49999999999988, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, 43.7, 42.30000000000001, 7.699999999999669, 39.90000000000002, 7.699999999999669, -50.00000000000044, 0.8999999999995723, 42.900000000000006, 45.7, -50.00000000000044, 26.69999999999994, 42.70000000000001, -50.00000000000044, 28.89999999999997, 5.6999999999996405, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, 43.7, 24.69999999999991, 31.900000000000013, 39.50000000000002, 26.89999999999994, 36.50000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 18.29999999999982, -50.00000000000044, 21.09999999999986, 18.899999999999828, -50.00000000000044, 45.7, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, 34.50000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.299999999999947, 21.499999999999865, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.90000000000002, 40.10000000000002, 35.70000000000003, 29.299999999999976, 24.899999999999913, 38.90000000000002, 33.30000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.900000000000013, 41.70000000000002, 31.70000000000001, 16.699999999999797, 14.499999999999766, 37.300000000000026, 23.699999999999896, 7.699999999999669, 40.30000000000002, -50.00000000000044], "episode_lengths": [268, 500, 116, 76, 124, 192, 74, 68, 40, 70, 140, 276, 500, 500, 340, 500, 500, 56, 128, 64, 78, 424, 102, 424, 500, 492, 72, 44, 500, 234, 74, 500, 212, 444, 130, 500, 500, 102, 52, 64, 254, 182, 106, 232, 136, 500, 116, 500, 90, 500, 318, 500, 290, 312, 500, 44, 256, 500, 500, 500, 478, 156, 500, 500, 68, 500, 500, 128, 500, 228, 286, 114, 500, 500, 102, 100, 144, 208, 252, 112, 168, 500, 88, 500, 500, 176, 284, 500, 500, 116, 182, 84, 184, 334, 356, 128, 264, 424, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37958667835135335, "mean_inference_ms": 1.2215390501595105, "mean_action_processing_ms": 0.14077806496159778, "mean_env_wait_ms": 0.08443280541681428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022089004516601562, "StateBufferConnector_ms": 0.013471603393554688, "ViewRequirementAgentConnector_ms": 0.13891959190368652}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.49099999999983, "episode_len_mean": 280.78, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.29999999999989, -50.00000000000044, 38.50000000000003, 42.500000000000014, 37.70000000000003, 30.9, 42.70000000000001, 43.30000000000001, 46.099999999999994, 43.10000000000001, 36.10000000000004, 22.49999999999988, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, 44.5, 37.300000000000026, 43.7, 42.30000000000001, 7.699999999999669, 39.90000000000002, 7.699999999999669, -50.00000000000044, 0.8999999999995723, 42.900000000000006, 45.7, -50.00000000000044, 26.69999999999994, 42.70000000000001, -50.00000000000044, 28.89999999999997, 5.6999999999996405, 37.10000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, 43.7, 24.69999999999991, 31.900000000000013, 39.50000000000002, 26.89999999999994, 36.50000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 18.29999999999982, -50.00000000000044, 21.09999999999986, 18.899999999999828, -50.00000000000044, 45.7, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, 34.50000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.299999999999947, 21.499999999999865, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.90000000000002, 40.10000000000002, 35.70000000000003, 29.299999999999976, 24.899999999999913, 38.90000000000002, 33.30000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.900000000000013, 41.70000000000002, 31.70000000000001, 16.699999999999797, 14.499999999999766, 37.300000000000026, 23.699999999999896, 7.699999999999669, 40.30000000000002, -50.00000000000044], "episode_lengths": [268, 500, 116, 76, 124, 192, 74, 68, 40, 70, 140, 276, 500, 500, 340, 500, 500, 56, 128, 64, 78, 424, 102, 424, 500, 492, 72, 44, 500, 234, 74, 500, 212, 444, 130, 500, 500, 102, 52, 64, 254, 182, 106, 232, 136, 500, 116, 500, 90, 500, 318, 500, 290, 312, 500, 44, 256, 500, 500, 500, 478, 156, 500, 500, 68, 500, 500, 128, 500, 228, 286, 114, 500, 500, 102, 100, 144, 208, 252, 112, 168, 500, 88, 500, 500, 176, 284, 500, 500, 116, 182, 84, 184, 334, 356, 128, 264, 424, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37958667835135335, "mean_inference_ms": 1.2215390501595105, "mean_action_processing_ms": 0.14077806496159778, "mean_env_wait_ms": 0.08443280541681428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022089004516601562, "StateBufferConnector_ms": 0.013471603393554688, "ViewRequirementAgentConnector_ms": 0.13891959190368652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5357.415972858067, "num_env_steps_trained_throughput_per_sec": 5357.415972858067, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2197.62, "sample_time_ms": 1970.547, "load_time_ms": 12.412, "load_throughput": 966806.34, "learn_time_ms": 202.87, "learn_throughput": 59151.101, "synch_weights_time_ms": 10.39}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2627, "training_iteration": 58, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-45", "timestamp": 1698249825, "time_this_iter_s": 2.24410080909729, "time_total_s": 125.28658127784729, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.28658127784729, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 52.70000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 7.630220148298475, "policy_loss": -8.137037770615684e-05, "vf_loss": 7.6303636233011884, "vf_explained_var": -4.1060977511935766e-07, "kl": 4.695870018167625e-05, "entropy": 0.6214633716477288, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.254999999999834, "episode_len_mean": 283.14, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 18.29999999999982, -50.00000000000044, 21.09999999999986, 18.899999999999828, -50.00000000000044, 45.7, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, 34.50000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.299999999999947, 21.499999999999865, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.90000000000002, 40.10000000000002, 35.70000000000003, 29.299999999999976, 24.899999999999913, 38.90000000000002, 33.30000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.900000000000013, 41.70000000000002, 31.70000000000001, 16.699999999999797, 14.499999999999766, 37.300000000000026, 23.699999999999896, 7.699999999999669, 40.30000000000002, -50.00000000000044, 32.50000000000002, 19.499999999999837, 45.9, 24.69999999999991, 43.50000000000001, 42.70000000000001, 27.899999999999956, 35.30000000000004, -50.00000000000044, 35.70000000000003, 29.899999999999984, -50.00000000000044, 44.7, 34.900000000000034, 30.29999999999999, 32.700000000000024, 36.900000000000034, 35.10000000000004, 20.099999999999845, -50.00000000000044, 29.099999999999973, 38.300000000000026, 36.30000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.300000000000026, 26.69999999999994, 39.10000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 19.299999999999834, 25.499999999999922, 40.90000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.69999999999991, 42.30000000000001], "episode_lengths": [116, 500, 90, 500, 318, 500, 290, 312, 500, 44, 256, 500, 500, 500, 478, 156, 500, 500, 68, 500, 500, 128, 500, 228, 286, 114, 500, 500, 102, 100, 144, 208, 252, 112, 168, 500, 88, 500, 500, 176, 284, 500, 500, 116, 182, 84, 184, 334, 356, 128, 264, 424, 98, 500, 176, 306, 42, 254, 66, 74, 222, 148, 500, 144, 202, 500, 54, 152, 198, 174, 132, 150, 300, 500, 210, 118, 138, 500, 210, 500, 118, 234, 110, 68, 500, 500, 114, 118, 308, 246, 92, 500, 344, 500, 372, 500, 500, 200, 254, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37986027905941067, "mean_inference_ms": 1.2213333720602135, "mean_action_processing_ms": 0.140710567557338, "mean_env_wait_ms": 0.08450644110431135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022015094757080078, "StateBufferConnector_ms": 0.011504650115966797, "ViewRequirementAgentConnector_ms": 0.12178802490234375}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.254999999999834, "episode_len_mean": 283.14, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 18.29999999999982, -50.00000000000044, 21.09999999999986, 18.899999999999828, -50.00000000000044, 45.7, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, 34.50000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 27.299999999999947, 21.499999999999865, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.90000000000002, 40.10000000000002, 35.70000000000003, 29.299999999999976, 24.899999999999913, 38.90000000000002, 33.30000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 21.699999999999868, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.900000000000013, 41.70000000000002, 31.70000000000001, 16.699999999999797, 14.499999999999766, 37.300000000000026, 23.699999999999896, 7.699999999999669, 40.30000000000002, -50.00000000000044, 32.50000000000002, 19.499999999999837, 45.9, 24.69999999999991, 43.50000000000001, 42.70000000000001, 27.899999999999956, 35.30000000000004, -50.00000000000044, 35.70000000000003, 29.899999999999984, -50.00000000000044, 44.7, 34.900000000000034, 30.29999999999999, 32.700000000000024, 36.900000000000034, 35.10000000000004, 20.099999999999845, -50.00000000000044, 29.099999999999973, 38.300000000000026, 36.30000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.300000000000026, 26.69999999999994, 39.10000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 19.299999999999834, 25.499999999999922, 40.90000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.69999999999991, 42.30000000000001], "episode_lengths": [116, 500, 90, 500, 318, 500, 290, 312, 500, 44, 256, 500, 500, 500, 478, 156, 500, 500, 68, 500, 500, 128, 500, 228, 286, 114, 500, 500, 102, 100, 144, 208, 252, 112, 168, 500, 88, 500, 500, 176, 284, 500, 500, 116, 182, 84, 184, 334, 356, 128, 264, 424, 98, 500, 176, 306, 42, 254, 66, 74, 222, 148, 500, 144, 202, 500, 54, 152, 198, 174, 132, 150, 300, 500, 210, 118, 138, 500, 210, 500, 118, 234, 110, 68, 500, 500, 114, 118, 308, 246, 92, 500, 344, 500, 372, 500, 500, 200, 254, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37986027905941067, "mean_inference_ms": 1.2213333720602135, "mean_action_processing_ms": 0.140710567557338, "mean_env_wait_ms": 0.08450644110431135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022015094757080078, "StateBufferConnector_ms": 0.011504650115966797, "ViewRequirementAgentConnector_ms": 0.12178802490234375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5760.139310009863, "num_env_steps_trained_throughput_per_sec": 5760.139310009863, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2178.731, "sample_time_ms": 1960.79, "load_time_ms": 11.628, "load_throughput": 1032027.017, "learn_time_ms": 194.902, "learn_throughput": 61569.452, "synch_weights_time_ms": 9.911}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2673, "training_iteration": 59, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-48", "timestamp": 1698249828, "time_this_iter_s": 2.088280439376831, "time_total_s": 127.37486171722412, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.37486171722412, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 56.86666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 6.757339583502875, "policy_loss": -0.0006079369535048803, "vf_loss": 6.758006572723389, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.0009077191587891775, "entropy": 0.5909941461351182, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 536.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.397999999999868, "episode_len_mean": 246.78, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, 16.699999999999797, 14.499999999999766, 37.300000000000026, 23.699999999999896, 7.699999999999669, 40.30000000000002, -50.00000000000044, 32.50000000000002, 19.499999999999837, 45.9, 24.69999999999991, 43.50000000000001, 42.70000000000001, 27.899999999999956, 35.30000000000004, -50.00000000000044, 35.70000000000003, 29.899999999999984, -50.00000000000044, 44.7, 34.900000000000034, 30.29999999999999, 32.700000000000024, 36.900000000000034, 35.10000000000004, 20.099999999999845, -50.00000000000044, 29.099999999999973, 38.300000000000026, 36.30000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.300000000000026, 26.69999999999994, 39.10000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 19.299999999999834, 25.499999999999922, 40.90000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.69999999999991, 42.30000000000001, 39.70000000000002, 43.10000000000001, 41.70000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 15.299999999999777, -50.00000000000044, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.30000000000004, -50.00000000000044, 44.300000000000004, 38.700000000000024, 44.10000000000001, 10.499999999999709, 8.699999999999683, 43.50000000000001, 36.900000000000034, 42.500000000000014, 45.3, 39.70000000000002, 40.90000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, 45.7, -50.00000000000044, -50.00000000000044, 33.500000000000036, 37.90000000000003, 44.10000000000001, 28.499999999999964, 38.50000000000003, 18.29999999999982, 43.7, -50.00000000000044, 3.899999999999615, 44.7], "episode_lengths": [184, 334, 356, 128, 264, 424, 98, 500, 176, 306, 42, 254, 66, 74, 222, 148, 500, 144, 202, 500, 54, 152, 198, 174, 132, 150, 300, 500, 210, 118, 138, 500, 210, 500, 118, 234, 110, 68, 500, 500, 114, 118, 308, 246, 92, 500, 344, 500, 372, 500, 500, 200, 254, 78, 104, 70, 84, 150, 500, 500, 54, 348, 500, 180, 58, 500, 500, 58, 148, 500, 58, 114, 60, 396, 414, 66, 132, 76, 48, 104, 92, 500, 72, 54, 500, 500, 202, 44, 500, 500, 166, 122, 60, 216, 116, 318, 64, 500, 462, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37967589713671257, "mean_inference_ms": 1.2206760448600347, "mean_action_processing_ms": 0.14061428112284893, "mean_env_wait_ms": 0.08440819471536148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.11400485038757324}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.397999999999868, "episode_len_mean": 246.78, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, 16.699999999999797, 14.499999999999766, 37.300000000000026, 23.699999999999896, 7.699999999999669, 40.30000000000002, -50.00000000000044, 32.50000000000002, 19.499999999999837, 45.9, 24.69999999999991, 43.50000000000001, 42.70000000000001, 27.899999999999956, 35.30000000000004, -50.00000000000044, 35.70000000000003, 29.899999999999984, -50.00000000000044, 44.7, 34.900000000000034, 30.29999999999999, 32.700000000000024, 36.900000000000034, 35.10000000000004, 20.099999999999845, -50.00000000000044, 29.099999999999973, 38.300000000000026, 36.30000000000003, -50.00000000000044, 29.099999999999973, -50.00000000000044, 38.300000000000026, 26.69999999999994, 39.10000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 19.299999999999834, 25.499999999999922, 40.90000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.69999999999991, 42.30000000000001, 39.70000000000002, 43.10000000000001, 41.70000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 15.299999999999777, -50.00000000000044, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.30000000000004, -50.00000000000044, 44.300000000000004, 38.700000000000024, 44.10000000000001, 10.499999999999709, 8.699999999999683, 43.50000000000001, 36.900000000000034, 42.500000000000014, 45.3, 39.70000000000002, 40.90000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, 45.7, -50.00000000000044, -50.00000000000044, 33.500000000000036, 37.90000000000003, 44.10000000000001, 28.499999999999964, 38.50000000000003, 18.29999999999982, 43.7, -50.00000000000044, 3.899999999999615, 44.7], "episode_lengths": [184, 334, 356, 128, 264, 424, 98, 500, 176, 306, 42, 254, 66, 74, 222, 148, 500, 144, 202, 500, 54, 152, 198, 174, 132, 150, 300, 500, 210, 118, 138, 500, 210, 500, 118, 234, 110, 68, 500, 500, 114, 118, 308, 246, 92, 500, 344, 500, 372, 500, 500, 200, 254, 78, 104, 70, 84, 150, 500, 500, 54, 348, 500, 180, 58, 500, 500, 58, 148, 500, 58, 114, 60, 396, 414, 66, 132, 76, 48, 104, 92, 500, 72, 54, 500, 500, 202, 44, 500, 500, 166, 122, 60, 216, 116, 318, 64, 500, 462, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37967589713671257, "mean_inference_ms": 1.2206760448600347, "mean_action_processing_ms": 0.14061428112284893, "mean_env_wait_ms": 0.08440819471536148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.11400485038757324}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5345.127273688849, "num_env_steps_trained_throughput_per_sec": 5345.127273688849, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2199.234, "sample_time_ms": 1957.372, "load_time_ms": 12.768, "load_throughput": 939856.179, "learn_time_ms": 217.048, "learn_throughput": 55287.4, "synch_weights_time_ms": 10.545}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2719, "training_iteration": 60, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-50", "timestamp": 1698249830, "time_this_iter_s": 2.2500269412994385, "time_total_s": 129.62488865852356, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.62488865852356, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 54.974999999999994, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 6.3343454996744795, "policy_loss": 0.0002831502093209161, "vf_loss": 6.334119372897678, "vf_explained_var": 2.6490953233506946e-07, "kl": 0.00018413379070302148, "entropy": 0.5715346336364746, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.658999999999822, "episode_len_mean": 269.06, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 19.299999999999834, 25.499999999999922, 40.90000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.69999999999991, 42.30000000000001, 39.70000000000002, 43.10000000000001, 41.70000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 15.299999999999777, -50.00000000000044, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.30000000000004, -50.00000000000044, 44.300000000000004, 38.700000000000024, 44.10000000000001, 10.499999999999709, 8.699999999999683, 43.50000000000001, 36.900000000000034, 42.500000000000014, 45.3, 39.70000000000002, 40.90000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, 45.7, -50.00000000000044, -50.00000000000044, 33.500000000000036, 37.90000000000003, 44.10000000000001, 28.499999999999964, 38.50000000000003, 18.29999999999982, 43.7, -50.00000000000044, 3.899999999999615, 44.7, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, 37.70000000000003, 45.3, 43.900000000000006, 39.10000000000002, 2.8999999999996007, 45.9, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 47.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 46.699999999999996, 44.300000000000004, -50.00000000000044, 43.30000000000001, 37.70000000000003, 29.099999999999973, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [118, 308, 246, 92, 500, 344, 500, 372, 500, 500, 200, 254, 78, 104, 70, 84, 150, 500, 500, 54, 348, 500, 180, 58, 500, 500, 58, 148, 500, 58, 114, 60, 396, 414, 66, 132, 76, 48, 104, 92, 500, 72, 54, 500, 500, 202, 44, 500, 500, 166, 122, 60, 216, 116, 318, 64, 500, 462, 54, 500, 382, 500, 500, 98, 500, 158, 500, 124, 48, 62, 110, 472, 42, 500, 500, 162, 500, 500, 500, 500, 500, 100, 26, 500, 94, 500, 36, 34, 58, 500, 68, 124, 210, 96, 64, 500, 500, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794339059436406, "mean_inference_ms": 1.2217477476827374, "mean_action_processing_ms": 0.1408569460037685, "mean_env_wait_ms": 0.08448245157143786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099609375, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.11973357200622559}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.658999999999822, "episode_len_mean": 269.06, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 19.299999999999834, 25.499999999999922, 40.90000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, 30.099999999999987, 24.69999999999991, 42.30000000000001, 39.70000000000002, 43.10000000000001, 41.70000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 15.299999999999777, -50.00000000000044, 32.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 35.30000000000004, -50.00000000000044, 44.300000000000004, 38.700000000000024, 44.10000000000001, 10.499999999999709, 8.699999999999683, 43.50000000000001, 36.900000000000034, 42.500000000000014, 45.3, 39.70000000000002, 40.90000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, 29.899999999999984, 45.7, -50.00000000000044, -50.00000000000044, 33.500000000000036, 37.90000000000003, 44.10000000000001, 28.499999999999964, 38.50000000000003, 18.29999999999982, 43.7, -50.00000000000044, 3.899999999999615, 44.7, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, 37.70000000000003, 45.3, 43.900000000000006, 39.10000000000002, 2.8999999999996007, 45.9, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 47.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 46.699999999999996, 44.300000000000004, -50.00000000000044, 43.30000000000001, 37.70000000000003, 29.099999999999973, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [118, 308, 246, 92, 500, 344, 500, 372, 500, 500, 200, 254, 78, 104, 70, 84, 150, 500, 500, 54, 348, 500, 180, 58, 500, 500, 58, 148, 500, 58, 114, 60, 396, 414, 66, 132, 76, 48, 104, 92, 500, 72, 54, 500, 500, 202, 44, 500, 500, 166, 122, 60, 216, 116, 318, 64, 500, 462, 54, 500, 382, 500, 500, 98, 500, 158, 500, 124, 48, 62, 110, 472, 42, 500, 500, 162, 500, 500, 500, 500, 500, 100, 26, 500, 94, 500, 36, 34, 58, 500, 68, 124, 210, 96, 64, 500, 500, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794339059436406, "mean_inference_ms": 1.2217477476827374, "mean_action_processing_ms": 0.1408569460037685, "mean_env_wait_ms": 0.08448245157143786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099609375, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.11973357200622559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5865.726689394593, "num_env_steps_trained_throughput_per_sec": 5865.726689394593, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2174.791, "sample_time_ms": 1948.729, "load_time_ms": 11.786, "load_throughput": 1018183.231, "learn_time_ms": 202.155, "learn_throughput": 59360.31, "synch_weights_time_ms": 10.52}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2760, "training_iteration": 61, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-52", "timestamp": 1698249832, "time_this_iter_s": 2.0517940521240234, "time_total_s": 131.67668271064758, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.67668271064758, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 67.9, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 7.698520501454671, "policy_loss": -2.1637313895755345e-05, "vf_loss": 7.698599603441027, "vf_explained_var": -1.3113021850585938e-06, "kl": 1.6429105711621458e-05, "entropy": 0.5742042263348898, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.313999999999856, "episode_len_mean": 237.54, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, 37.70000000000003, 45.3, 43.900000000000006, 39.10000000000002, 2.8999999999996007, 45.9, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 47.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 46.699999999999996, 44.300000000000004, -50.00000000000044, 43.30000000000001, 37.70000000000003, 29.099999999999973, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.10000000000001, 41.90000000000001, 41.70000000000002, 35.10000000000004, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.499999999999993, 18.899999999999828, 41.500000000000014, 44.900000000000006, 40.10000000000002, 45.1, -50.00000000000044, 47.1, 34.70000000000004, 35.10000000000004, 43.10000000000001, 39.50000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, 39.90000000000002, 31.900000000000013, 44.10000000000001, -50.00000000000044, 39.50000000000002, 44.7, 43.10000000000001, 46.699999999999996, 30.499999999999993, 46.699999999999996, 24.899999999999913, 42.500000000000014, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 19.69999999999984, 44.10000000000001, 42.500000000000014, -50.00000000000044, 36.900000000000034, 20.49999999999985, 45.1, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.3, 26.69999999999994, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 98, 500, 158, 500, 124, 48, 62, 110, 472, 42, 500, 500, 162, 500, 500, 500, 500, 500, 100, 26, 500, 94, 500, 36, 34, 58, 500, 68, 124, 210, 96, 64, 500, 500, 500, 62, 500, 500, 158, 70, 82, 84, 150, 120, 130, 500, 500, 72, 500, 196, 312, 86, 52, 100, 50, 500, 30, 154, 150, 70, 106, 500, 40, 360, 102, 182, 60, 500, 106, 54, 70, 34, 196, 34, 252, 76, 500, 80, 36, 500, 58, 500, 304, 60, 76, 500, 132, 296, 50, 114, 88, 500, 500, 500, 128, 38, 234, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37922247565044886, "mean_inference_ms": 1.219789617038536, "mean_action_processing_ms": 0.14100648876844812, "mean_env_wait_ms": 0.08464997489617657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027987003326416016, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.12082719802856445}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.313999999999856, "episode_len_mean": 237.54, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, 34.30000000000004, -50.00000000000044, 37.70000000000003, 45.3, 43.900000000000006, 39.10000000000002, 2.8999999999996007, 45.9, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 47.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.5, 46.699999999999996, 44.300000000000004, -50.00000000000044, 43.30000000000001, 37.70000000000003, 29.099999999999973, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.10000000000001, 41.90000000000001, 41.70000000000002, 35.10000000000004, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.499999999999993, 18.899999999999828, 41.500000000000014, 44.900000000000006, 40.10000000000002, 45.1, -50.00000000000044, 47.1, 34.70000000000004, 35.10000000000004, 43.10000000000001, 39.50000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, 39.90000000000002, 31.900000000000013, 44.10000000000001, -50.00000000000044, 39.50000000000002, 44.7, 43.10000000000001, 46.699999999999996, 30.499999999999993, 46.699999999999996, 24.899999999999913, 42.500000000000014, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 19.69999999999984, 44.10000000000001, 42.500000000000014, -50.00000000000044, 36.900000000000034, 20.49999999999985, 45.1, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.3, 26.69999999999994, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 98, 500, 158, 500, 124, 48, 62, 110, 472, 42, 500, 500, 162, 500, 500, 500, 500, 500, 100, 26, 500, 94, 500, 36, 34, 58, 500, 68, 124, 210, 96, 64, 500, 500, 500, 62, 500, 500, 158, 70, 82, 84, 150, 120, 130, 500, 500, 72, 500, 196, 312, 86, 52, 100, 50, 500, 30, 154, 150, 70, 106, 500, 40, 360, 102, 182, 60, 500, 106, 54, 70, 34, 196, 34, 252, 76, 500, 80, 36, 500, 58, 500, 304, 60, 76, 500, 132, 296, 50, 114, 88, 500, 500, 500, 128, 38, 234, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37922247565044886, "mean_inference_ms": 1.219789617038536, "mean_action_processing_ms": 0.14100648876844812, "mean_env_wait_ms": 0.08464997489617657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027987003326416016, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.12082719802856445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5610.705584715481, "num_env_steps_trained_throughput_per_sec": 5610.705584715481, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2178.198, "sample_time_ms": 1944.017, "load_time_ms": 12.287, "load_throughput": 976625.175, "learn_time_ms": 209.864, "learn_throughput": 57179.843, "synch_weights_time_ms": 10.328}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2822, "training_iteration": 62, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-54", "timestamp": 1698249834, "time_this_iter_s": 2.1446022987365723, "time_total_s": 133.82128500938416, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.82128500938416, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 7.024543868170844, "policy_loss": -4.263568876518143e-05, "vf_loss": 7.024642838372125, "vf_explained_var": -9.934107462565105e-07, "kl": 4.544423896075184e-05, "entropy": 0.5625640021430122, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.239999999999878, "episode_len_mean": 218.36, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 30.499999999999993, 18.899999999999828, 41.500000000000014, 44.900000000000006, 40.10000000000002, 45.1, -50.00000000000044, 47.1, 34.70000000000004, 35.10000000000004, 43.10000000000001, 39.50000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, 39.90000000000002, 31.900000000000013, 44.10000000000001, -50.00000000000044, 39.50000000000002, 44.7, 43.10000000000001, 46.699999999999996, 30.499999999999993, 46.699999999999996, 24.899999999999913, 42.500000000000014, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 19.69999999999984, 44.10000000000001, 42.500000000000014, -50.00000000000044, 36.900000000000034, 20.49999999999985, 45.1, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.3, 26.69999999999994, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.90000000000002, 41.500000000000014, 43.900000000000006, 43.10000000000001, -50.00000000000044, 41.30000000000001, 41.500000000000014, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 29.899999999999984, -50.00000000000044, 45.3, 43.7, 42.900000000000006, -50.00000000000044, 44.7, 10.099999999999703, 43.10000000000001, -50.00000000000044, 36.10000000000004, 44.300000000000004, -50.00000000000044, 46.699999999999996, 42.900000000000006, 41.70000000000002, 22.299999999999876, 30.699999999999996, 41.500000000000014, 36.30000000000003, -50.00000000000044, 46.3, 23.8999999999999, 41.70000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 1.099999999999575, 17.499999999999808, 40.90000000000002, 44.900000000000006, 4.299999999999621, 17.899999999999814, 43.900000000000006], "episode_lengths": [72, 500, 196, 312, 86, 52, 100, 50, 500, 30, 154, 150, 70, 106, 500, 40, 360, 102, 182, 60, 500, 106, 54, 70, 34, 196, 34, 252, 76, 500, 80, 36, 500, 58, 500, 304, 60, 76, 500, 132, 296, 50, 114, 88, 500, 500, 500, 128, 38, 234, 74, 500, 500, 122, 92, 86, 62, 70, 500, 88, 86, 190, 500, 500, 500, 60, 202, 500, 48, 64, 72, 500, 54, 400, 70, 500, 140, 58, 500, 34, 72, 84, 278, 194, 86, 138, 500, 38, 262, 84, 500, 88, 500, 490, 326, 92, 52, 458, 322, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792708480190956, "mean_inference_ms": 1.2190526411456752, "mean_action_processing_ms": 0.14074667989398523, "mean_env_wait_ms": 0.08456795153815447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02879643440246582, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11500859260559082}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.239999999999878, "episode_len_mean": 218.36, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 30.499999999999993, 18.899999999999828, 41.500000000000014, 44.900000000000006, 40.10000000000002, 45.1, -50.00000000000044, 47.1, 34.70000000000004, 35.10000000000004, 43.10000000000001, 39.50000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, 39.90000000000002, 31.900000000000013, 44.10000000000001, -50.00000000000044, 39.50000000000002, 44.7, 43.10000000000001, 46.699999999999996, 30.499999999999993, 46.699999999999996, 24.899999999999913, 42.500000000000014, -50.00000000000044, 42.10000000000001, 46.5, -50.00000000000044, 44.300000000000004, -50.00000000000044, 19.69999999999984, 44.10000000000001, 42.500000000000014, -50.00000000000044, 36.900000000000034, 20.49999999999985, 45.1, 38.700000000000024, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.3, 26.69999999999994, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.90000000000002, 41.500000000000014, 43.900000000000006, 43.10000000000001, -50.00000000000044, 41.30000000000001, 41.500000000000014, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 29.899999999999984, -50.00000000000044, 45.3, 43.7, 42.900000000000006, -50.00000000000044, 44.7, 10.099999999999703, 43.10000000000001, -50.00000000000044, 36.10000000000004, 44.300000000000004, -50.00000000000044, 46.699999999999996, 42.900000000000006, 41.70000000000002, 22.299999999999876, 30.699999999999996, 41.500000000000014, 36.30000000000003, -50.00000000000044, 46.3, 23.8999999999999, 41.70000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 1.099999999999575, 17.499999999999808, 40.90000000000002, 44.900000000000006, 4.299999999999621, 17.899999999999814, 43.900000000000006], "episode_lengths": [72, 500, 196, 312, 86, 52, 100, 50, 500, 30, 154, 150, 70, 106, 500, 40, 360, 102, 182, 60, 500, 106, 54, 70, 34, 196, 34, 252, 76, 500, 80, 36, 500, 58, 500, 304, 60, 76, 500, 132, 296, 50, 114, 88, 500, 500, 500, 128, 38, 234, 74, 500, 500, 122, 92, 86, 62, 70, 500, 88, 86, 190, 500, 500, 500, 60, 202, 500, 48, 64, 72, 500, 54, 400, 70, 500, 140, 58, 500, 34, 72, 84, 278, 194, 86, 138, 500, 38, 262, 84, 500, 88, 500, 490, 326, 92, 52, 458, 322, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792708480190956, "mean_inference_ms": 1.2190526411456752, "mean_action_processing_ms": 0.14074667989398523, "mean_env_wait_ms": 0.08456795153815447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02879643440246582, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11500859260559082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5840.853161372858, "num_env_steps_trained_throughput_per_sec": 5840.853161372858, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2161.59, "sample_time_ms": 1946.359, "load_time_ms": 11.528, "load_throughput": 1040948.881, "learn_time_ms": 191.776, "learn_throughput": 62573.091, "synch_weights_time_ms": 10.226}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2870, "training_iteration": 63, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-56", "timestamp": 1698249836, "time_this_iter_s": 2.0604937076568604, "time_total_s": 135.88177871704102, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.88177871704102, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 58.23333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 6.495430151621501, "policy_loss": -0.00017615159352620444, "vf_loss": 6.495658132765028, "vf_explained_var": -1.7881393432617188e-06, "kl": 0.00014239802588712614, "entropy": 0.5188680622312758, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 572.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.785999999999866, "episode_len_mean": 222.88, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 41.500000000000014, 43.900000000000006, 43.10000000000001, -50.00000000000044, 41.30000000000001, 41.500000000000014, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 29.899999999999984, -50.00000000000044, 45.3, 43.7, 42.900000000000006, -50.00000000000044, 44.7, 10.099999999999703, 43.10000000000001, -50.00000000000044, 36.10000000000004, 44.300000000000004, -50.00000000000044, 46.699999999999996, 42.900000000000006, 41.70000000000002, 22.299999999999876, 30.699999999999996, 41.500000000000014, 36.30000000000003, -50.00000000000044, 46.3, 23.8999999999999, 41.70000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 1.099999999999575, 17.499999999999808, 40.90000000000002, 44.900000000000006, 4.299999999999621, 17.899999999999814, 43.900000000000006, -50.00000000000044, 41.100000000000016, 30.699999999999996, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 32.700000000000024, 35.500000000000036, 40.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 19.499999999999837, 21.299999999999862, 42.10000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.30000000000001, 45.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.3, 33.30000000000003, 20.299999999999848, 44.300000000000004, 42.900000000000006, 45.5, 43.900000000000006, 38.300000000000026, 42.10000000000001, 38.700000000000024, 44.900000000000006, 42.900000000000006, -50.00000000000044, 33.30000000000003, 40.30000000000002, 43.10000000000001, 39.50000000000002, 18.099999999999817], "episode_lengths": [92, 86, 62, 70, 500, 88, 86, 190, 500, 500, 500, 60, 202, 500, 48, 64, 72, 500, 54, 400, 70, 500, 140, 58, 500, 34, 72, 84, 278, 194, 86, 138, 500, 38, 262, 84, 500, 88, 500, 490, 326, 92, 52, 458, 322, 62, 500, 90, 194, 66, 500, 34, 500, 500, 74, 74, 500, 500, 44, 500, 58, 174, 146, 94, 92, 500, 500, 500, 94, 306, 288, 80, 84, 52, 500, 500, 40, 88, 46, 500, 118, 500, 48, 168, 298, 58, 72, 46, 62, 118, 80, 114, 52, 72, 500, 168, 98, 70, 106, 320]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37954092685643964, "mean_inference_ms": 1.2192550714157442, "mean_action_processing_ms": 0.1406891167506738, "mean_env_wait_ms": 0.08456507443118574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026810407638549805, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.11620259284973145}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.785999999999866, "episode_len_mean": 222.88, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 41.500000000000014, 43.900000000000006, 43.10000000000001, -50.00000000000044, 41.30000000000001, 41.500000000000014, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 29.899999999999984, -50.00000000000044, 45.3, 43.7, 42.900000000000006, -50.00000000000044, 44.7, 10.099999999999703, 43.10000000000001, -50.00000000000044, 36.10000000000004, 44.300000000000004, -50.00000000000044, 46.699999999999996, 42.900000000000006, 41.70000000000002, 22.299999999999876, 30.699999999999996, 41.500000000000014, 36.30000000000003, -50.00000000000044, 46.3, 23.8999999999999, 41.70000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 1.099999999999575, 17.499999999999808, 40.90000000000002, 44.900000000000006, 4.299999999999621, 17.899999999999814, 43.900000000000006, -50.00000000000044, 41.100000000000016, 30.699999999999996, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 32.700000000000024, 35.500000000000036, 40.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 19.499999999999837, 21.299999999999862, 42.10000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.30000000000001, 45.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.3, 33.30000000000003, 20.299999999999848, 44.300000000000004, 42.900000000000006, 45.5, 43.900000000000006, 38.300000000000026, 42.10000000000001, 38.700000000000024, 44.900000000000006, 42.900000000000006, -50.00000000000044, 33.30000000000003, 40.30000000000002, 43.10000000000001, 39.50000000000002, 18.099999999999817], "episode_lengths": [92, 86, 62, 70, 500, 88, 86, 190, 500, 500, 500, 60, 202, 500, 48, 64, 72, 500, 54, 400, 70, 500, 140, 58, 500, 34, 72, 84, 278, 194, 86, 138, 500, 38, 262, 84, 500, 88, 500, 490, 326, 92, 52, 458, 322, 62, 500, 90, 194, 66, 500, 34, 500, 500, 74, 74, 500, 500, 44, 500, 58, 174, 146, 94, 92, 500, 500, 500, 94, 306, 288, 80, 84, 52, 500, 500, 40, 88, 46, 500, 118, 500, 48, 168, 298, 58, 72, 46, 62, 118, 80, 114, 52, 72, 500, 168, 98, 70, 106, 320]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37954092685643964, "mean_inference_ms": 1.2192550714157442, "mean_action_processing_ms": 0.1406891167506738, "mean_env_wait_ms": 0.08456507443118574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026810407638549805, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.11620259284973145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5330.549775304508, "num_env_steps_trained_throughput_per_sec": 5330.549775304508, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2179.699, "sample_time_ms": 1947.829, "load_time_ms": 12.295, "load_throughput": 976041.856, "learn_time_ms": 207.742, "learn_throughput": 57764.044, "synch_weights_time_ms": 10.133}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2924, "training_iteration": 64, "trial_id": "9f288_00018", "date": "2023-10-25_17-03-58", "timestamp": 1698249838, "time_this_iter_s": 2.2561731338500977, "time_total_s": 138.1379518508911, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.1379518508911, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 57.575, "ram_util_percent": 27.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 6.365454143948025, "policy_loss": -0.00018192289604081048, "vf_loss": 6.365690390268962, "vf_explained_var": -7.285012139214409e-07, "kl": 0.00021906916922868427, "entropy": 0.5442000759972466, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.170999999999834, "episode_len_mean": 253.94, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.499999999999808, 40.90000000000002, 44.900000000000006, 4.299999999999621, 17.899999999999814, 43.900000000000006, -50.00000000000044, 41.100000000000016, 30.699999999999996, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 32.700000000000024, 35.500000000000036, 40.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 19.499999999999837, 21.299999999999862, 42.10000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.30000000000001, 45.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.3, 33.30000000000003, 20.299999999999848, 44.300000000000004, 42.900000000000006, 45.5, 43.900000000000006, 38.300000000000026, 42.10000000000001, 38.700000000000024, 44.900000000000006, 42.900000000000006, -50.00000000000044, 33.30000000000003, 40.30000000000002, 43.10000000000001, 39.50000000000002, 18.099999999999817, 39.10000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.700000000000024, -50.00000000000044, 8.899999999999686, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 33.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 40.90000000000002], "episode_lengths": [326, 92, 52, 458, 322, 62, 500, 90, 194, 66, 500, 34, 500, 500, 74, 74, 500, 500, 44, 500, 58, 174, 146, 94, 92, 500, 500, 500, 94, 306, 288, 80, 84, 52, 500, 500, 40, 88, 46, 500, 118, 500, 48, 168, 298, 58, 72, 46, 62, 118, 80, 114, 52, 72, 500, 168, 98, 70, 106, 320, 110, 126, 500, 500, 126, 500, 500, 84, 500, 500, 82, 114, 500, 412, 80, 122, 500, 66, 126, 54, 500, 500, 500, 50, 152, 500, 500, 500, 500, 62, 500, 500, 78, 500, 166, 500, 48, 500, 146, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37949512623791243, "mean_inference_ms": 1.219865565965578, "mean_action_processing_ms": 0.14067664731609214, "mean_env_wait_ms": 0.08453437825035919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029011249542236328, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12701940536499023}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.170999999999834, "episode_len_mean": 253.94, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.499999999999808, 40.90000000000002, 44.900000000000006, 4.299999999999621, 17.899999999999814, 43.900000000000006, -50.00000000000044, 41.100000000000016, 30.699999999999996, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 32.700000000000024, 35.500000000000036, 40.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 19.499999999999837, 21.299999999999862, 42.10000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.30000000000001, 45.5, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.3, 33.30000000000003, 20.299999999999848, 44.300000000000004, 42.900000000000006, 45.5, 43.900000000000006, 38.300000000000026, 42.10000000000001, 38.700000000000024, 44.900000000000006, 42.900000000000006, -50.00000000000044, 33.30000000000003, 40.30000000000002, 43.10000000000001, 39.50000000000002, 18.099999999999817, 39.10000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.700000000000024, -50.00000000000044, 8.899999999999686, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 33.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 40.90000000000002], "episode_lengths": [326, 92, 52, 458, 322, 62, 500, 90, 194, 66, 500, 34, 500, 500, 74, 74, 500, 500, 44, 500, 58, 174, 146, 94, 92, 500, 500, 500, 94, 306, 288, 80, 84, 52, 500, 500, 40, 88, 46, 500, 118, 500, 48, 168, 298, 58, 72, 46, 62, 118, 80, 114, 52, 72, 500, 168, 98, 70, 106, 320, 110, 126, 500, 500, 126, 500, 500, 84, 500, 500, 82, 114, 500, 412, 80, 122, 500, 66, 126, 54, 500, 500, 500, 50, 152, 500, 500, 500, 500, 62, 500, 500, 78, 500, 166, 500, 48, 500, 146, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37949512623791243, "mean_inference_ms": 1.219865565965578, "mean_action_processing_ms": 0.14067664731609214, "mean_env_wait_ms": 0.08453437825035919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029011249542236328, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12701940536499023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5943.602924114379, "num_env_steps_trained_throughput_per_sec": 5943.602924114379, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2155.189, "sample_time_ms": 1949.717, "load_time_ms": 11.787, "load_throughput": 1018051.425, "learn_time_ms": 181.846, "learn_throughput": 65989.835, "synch_weights_time_ms": 10.152}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2964, "training_iteration": 65, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-00", "timestamp": 1698249840, "time_this_iter_s": 2.0239710807800293, "time_total_s": 140.16192293167114, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.16192293167114, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 66.85, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 6.6540787484910755, "policy_loss": -8.755922317504883e-05, "vf_loss": 6.654223865932888, "vf_explained_var": -3.841188218858507e-07, "kl": 0.00016912189876923853, "entropy": 0.5758110019895766, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 590.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9439999999998285, "episode_len_mean": 261.18, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 42.10000000000001, 38.700000000000024, 44.900000000000006, 42.900000000000006, -50.00000000000044, 33.30000000000003, 40.30000000000002, 43.10000000000001, 39.50000000000002, 18.099999999999817, 39.10000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.700000000000024, -50.00000000000044, 8.899999999999686, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 33.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 43.50000000000001, 44.5, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.900000000000006, 44.10000000000001, 32.100000000000016, 41.30000000000001, -50.00000000000044, 21.89999999999987, 43.30000000000001, -50.00000000000044, 4.899999999999629, 26.299999999999933, 22.299999999999876, 47.1, 43.30000000000001, 41.100000000000016, 46.099999999999994, 35.900000000000034, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.70000000000001], "episode_lengths": [118, 80, 114, 52, 72, 500, 168, 98, 70, 106, 320, 110, 126, 500, 500, 126, 500, 500, 84, 500, 500, 82, 114, 500, 412, 80, 122, 500, 66, 126, 54, 500, 500, 500, 50, 152, 500, 500, 500, 500, 62, 500, 500, 78, 500, 166, 500, 48, 500, 146, 92, 500, 500, 40, 86, 500, 40, 500, 192, 66, 56, 110, 60, 500, 72, 60, 180, 88, 500, 282, 68, 500, 452, 238, 278, 30, 68, 90, 40, 142, 500, 134, 102, 500, 500, 110, 92, 500, 500, 62, 500, 500, 68, 66, 40, 500, 500, 500, 28, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793380247172868, "mean_inference_ms": 1.2196341680130895, "mean_action_processing_ms": 0.14077762882195285, "mean_env_wait_ms": 0.08459956402110201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030009984970092773, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.13925933837890625}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9439999999998285, "episode_len_mean": 261.18, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 42.10000000000001, 38.700000000000024, 44.900000000000006, 42.900000000000006, -50.00000000000044, 33.30000000000003, 40.30000000000002, 43.10000000000001, 39.50000000000002, 18.099999999999817, 39.10000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.700000000000024, -50.00000000000044, 8.899999999999686, 42.10000000000001, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 33.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 43.50000000000001, 44.5, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.900000000000006, 44.10000000000001, 32.100000000000016, 41.30000000000001, -50.00000000000044, 21.89999999999987, 43.30000000000001, -50.00000000000044, 4.899999999999629, 26.299999999999933, 22.299999999999876, 47.1, 43.30000000000001, 41.100000000000016, 46.099999999999994, 35.900000000000034, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.70000000000001], "episode_lengths": [118, 80, 114, 52, 72, 500, 168, 98, 70, 106, 320, 110, 126, 500, 500, 126, 500, 500, 84, 500, 500, 82, 114, 500, 412, 80, 122, 500, 66, 126, 54, 500, 500, 500, 50, 152, 500, 500, 500, 500, 62, 500, 500, 78, 500, 166, 500, 48, 500, 146, 92, 500, 500, 40, 86, 500, 40, 500, 192, 66, 56, 110, 60, 500, 72, 60, 180, 88, 500, 282, 68, 500, 452, 238, 278, 30, 68, 90, 40, 142, 500, 134, 102, 500, 500, 110, 92, 500, 500, 62, 500, 500, 68, 66, 40, 500, 500, 500, 28, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793380247172868, "mean_inference_ms": 1.2196341680130895, "mean_action_processing_ms": 0.14077762882195285, "mean_env_wait_ms": 0.08459956402110201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030009984970092773, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.13925933837890625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5691.960247827955, "num_env_steps_trained_throughput_per_sec": 5691.960247827955, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2159.013, "sample_time_ms": 1944.132, "load_time_ms": 11.886, "load_throughput": 1009560.686, "learn_time_ms": 191.149, "learn_throughput": 62778.221, "synch_weights_time_ms": 10.16}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3013, "training_iteration": 66, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-03", "timestamp": 1698249843, "time_this_iter_s": 2.113236427307129, "time_total_s": 142.27515935897827, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.27515935897827, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 63.866666666666674, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0003, "total_loss": 6.213403277926975, "policy_loss": 6.178683704800076e-05, "vf_loss": 6.21339570151435, "vf_explained_var": -5.563100179036459e-07, "kl": 2.9206154877670087e-05, "entropy": 0.5417372716797723, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5979999999998074, "episode_len_mean": 274.6, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 33.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 43.50000000000001, 44.5, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.900000000000006, 44.10000000000001, 32.100000000000016, 41.30000000000001, -50.00000000000044, 21.89999999999987, 43.30000000000001, -50.00000000000044, 4.899999999999629, 26.299999999999933, 22.299999999999876, 47.1, 43.30000000000001, 41.100000000000016, 46.099999999999994, 35.900000000000034, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 35.10000000000004, 40.500000000000014, -50.00000000000044, 44.7, 39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 43.50000000000001, 15.699999999999783, 44.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 62, 500, 500, 78, 500, 166, 500, 48, 500, 146, 92, 500, 500, 40, 86, 500, 40, 500, 192, 66, 56, 110, 60, 500, 72, 60, 180, 88, 500, 282, 68, 500, 452, 238, 278, 30, 68, 90, 40, 142, 500, 134, 102, 500, 500, 110, 92, 500, 500, 62, 500, 500, 68, 66, 40, 500, 500, 500, 28, 184, 500, 98, 500, 500, 470, 150, 96, 500, 54, 106, 38, 80, 500, 500, 52, 92, 500, 500, 500, 80, 500, 500, 76, 500, 500, 500, 84, 500, 34, 102, 500, 66, 344, 52, 108, 500, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792699028876023, "mean_inference_ms": 1.2193901321221587, "mean_action_processing_ms": 0.14072465546620155, "mean_env_wait_ms": 0.0844867642996343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034004926681518555, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.13622403144836426}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5979999999998074, "episode_len_mean": 274.6, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 33.500000000000036, -50.00000000000044, 45.3, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 30.9, 43.50000000000001, 44.5, 39.10000000000002, 44.10000000000001, -50.00000000000044, 42.900000000000006, 44.10000000000001, 32.100000000000016, 41.30000000000001, -50.00000000000044, 21.89999999999987, 43.30000000000001, -50.00000000000044, 4.899999999999629, 26.299999999999933, 22.299999999999876, 47.1, 43.30000000000001, 41.100000000000016, 46.099999999999994, 35.900000000000034, -50.00000000000044, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 35.10000000000004, 40.500000000000014, -50.00000000000044, 44.7, 39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 43.50000000000001, 15.699999999999783, 44.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [500, 62, 500, 500, 78, 500, 166, 500, 48, 500, 146, 92, 500, 500, 40, 86, 500, 40, 500, 192, 66, 56, 110, 60, 500, 72, 60, 180, 88, 500, 282, 68, 500, 452, 238, 278, 30, 68, 90, 40, 142, 500, 134, 102, 500, 500, 110, 92, 500, 500, 62, 500, 500, 68, 66, 40, 500, 500, 500, 28, 184, 500, 98, 500, 500, 470, 150, 96, 500, 54, 106, 38, 80, 500, 500, 52, 92, 500, 500, 500, 80, 500, 500, 76, 500, 500, 500, 84, 500, 34, 102, 500, 66, 344, 52, 108, 500, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792699028876023, "mean_inference_ms": 1.2193901321221587, "mean_action_processing_ms": 0.14072465546620155, "mean_env_wait_ms": 0.0844867642996343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034004926681518555, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.13622403144836426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5455.385447810373, "num_env_steps_trained_throughput_per_sec": 5455.385447810373, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2138.53, "sample_time_ms": 1915.851, "load_time_ms": 12.486, "load_throughput": 961052.177, "learn_time_ms": 198.029, "learn_throughput": 60597.326, "synch_weights_time_ms": 10.478}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3052, "training_iteration": 67, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-05", "timestamp": 1698249845, "time_this_iter_s": 2.2044293880462646, "time_total_s": 144.47958874702454, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.47958874702454, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 55.775000000000006, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0003, "total_loss": 6.328413804372151, "policy_loss": -0.0002070843345589108, "vf_loss": 6.328671826256646, "vf_explained_var": -7.417466905381945e-07, "kl": 0.00014225910675394162, "entropy": 0.5092802180184258, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1870000000002119, "episode_len_mean": 287.42, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.10000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 35.10000000000004, 40.500000000000014, -50.00000000000044, 44.7, 39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 43.50000000000001, 15.699999999999783, 44.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.700000000000024, 2.299999999999592, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 13.299999999999748, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 34.10000000000004, 21.699999999999868, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.900000000000006, 44.300000000000004, 23.699999999999896, 41.100000000000016, 44.5, -50.00000000000044, 42.70000000000001, 45.7, 44.5, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001], "episode_lengths": [500, 500, 110, 92, 500, 500, 62, 500, 500, 68, 66, 40, 500, 500, 500, 28, 184, 500, 98, 500, 500, 470, 150, 96, 500, 54, 106, 38, 80, 500, 500, 52, 92, 500, 500, 500, 80, 500, 500, 76, 500, 500, 500, 84, 500, 34, 102, 500, 66, 344, 52, 108, 500, 500, 62, 500, 174, 478, 64, 106, 500, 500, 500, 100, 368, 500, 62, 500, 500, 44, 500, 500, 160, 284, 500, 54, 40, 500, 52, 58, 264, 90, 56, 500, 74, 44, 56, 48, 42, 500, 500, 74, 500, 100, 326, 500, 500, 42, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37957350174500404, "mean_inference_ms": 1.219485601070333, "mean_action_processing_ms": 0.14040874447217588, "mean_env_wait_ms": 0.08452790085323075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700352668762207, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.11597585678100586}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1870000000002119, "episode_len_mean": 287.42, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.10000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 31.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 35.10000000000004, 40.500000000000014, -50.00000000000044, 44.7, 39.50000000000002, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996, 39.90000000000002, -50.00000000000044, 43.50000000000001, 15.699999999999783, 44.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.700000000000024, 2.299999999999592, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 13.299999999999748, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 34.10000000000004, 21.699999999999868, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.900000000000006, 44.300000000000004, 23.699999999999896, 41.100000000000016, 44.5, -50.00000000000044, 42.70000000000001, 45.7, 44.5, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001], "episode_lengths": [500, 500, 110, 92, 500, 500, 62, 500, 500, 68, 66, 40, 500, 500, 500, 28, 184, 500, 98, 500, 500, 470, 150, 96, 500, 54, 106, 38, 80, 500, 500, 52, 92, 500, 500, 500, 80, 500, 500, 76, 500, 500, 500, 84, 500, 34, 102, 500, 66, 344, 52, 108, 500, 500, 62, 500, 174, 478, 64, 106, 500, 500, 500, 100, 368, 500, 62, 500, 500, 44, 500, 500, 160, 284, 500, 54, 40, 500, 52, 58, 264, 90, 56, 500, 74, 44, 56, 48, 42, 500, 500, 74, 500, 100, 326, 500, 500, 42, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37957350174500404, "mean_inference_ms": 1.219485601070333, "mean_action_processing_ms": 0.14040874447217588, "mean_env_wait_ms": 0.08452790085323075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700352668762207, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.11597585678100586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5811.025809323083, "num_env_steps_trained_throughput_per_sec": 5811.025809323083, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2121.045, "sample_time_ms": 1915.452, "load_time_ms": 11.665, "load_throughput": 1028730.082, "learn_time_ms": 181.559, "learn_throughput": 66094.212, "synch_weights_time_ms": 10.603}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3096, "training_iteration": 68, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-07", "timestamp": 1698249847, "time_this_iter_s": 2.070037841796875, "time_total_s": 146.5496265888214, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.5496265888214, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 66.44999999999999, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0003, "total_loss": 6.903675344255236, "policy_loss": -0.0002269431327780088, "vf_loss": 6.903958267635769, "vf_explained_var": -4.5034620496961804e-07, "kl": 0.00023699739639937434, "entropy": 0.5584138234456381, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 617.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9379999999998123, "episode_len_mean": 271.22, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 15.699999999999783, 44.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.700000000000024, 2.299999999999592, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 13.299999999999748, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 34.10000000000004, 21.699999999999868, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.900000000000006, 44.300000000000004, 23.699999999999896, 41.100000000000016, 44.5, -50.00000000000044, 42.70000000000001, 45.7, 44.5, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 40.30000000000002, 28.699999999999967, 33.70000000000004, -50.00000000000044, 45.9, 44.7, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 36.900000000000034, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 36.30000000000003, 42.10000000000001, 40.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.70000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.499999999999638], "episode_lengths": [66, 344, 52, 108, 500, 500, 62, 500, 174, 478, 64, 106, 500, 500, 500, 100, 368, 500, 62, 500, 500, 44, 500, 500, 160, 284, 500, 54, 40, 500, 52, 58, 264, 90, 56, 500, 74, 44, 56, 48, 42, 500, 500, 74, 500, 100, 326, 500, 500, 42, 500, 88, 500, 58, 84, 500, 500, 134, 136, 98, 214, 164, 500, 42, 54, 68, 58, 500, 44, 72, 500, 500, 500, 142, 500, 132, 166, 500, 500, 46, 58, 500, 138, 80, 94, 500, 130, 500, 78, 30, 500, 500, 500, 176, 124, 500, 76, 500, 500, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793510539020329, "mean_inference_ms": 1.2187453045199474, "mean_action_processing_ms": 0.1404894843689389, "mean_env_wait_ms": 0.08449426394198674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.11304116249084473}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9379999999998123, "episode_len_mean": 271.22, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 15.699999999999783, 44.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.700000000000024, 2.299999999999592, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 13.299999999999748, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 34.10000000000004, 21.699999999999868, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.900000000000006, 44.300000000000004, 23.699999999999896, 41.100000000000016, 44.5, -50.00000000000044, 42.70000000000001, 45.7, 44.5, 45.3, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 40.30000000000002, 28.699999999999967, 33.70000000000004, -50.00000000000044, 45.9, 44.7, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 36.900000000000034, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 36.30000000000003, 42.10000000000001, 40.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.70000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.499999999999638], "episode_lengths": [66, 344, 52, 108, 500, 500, 62, 500, 174, 478, 64, 106, 500, 500, 500, 100, 368, 500, 62, 500, 500, 44, 500, 500, 160, 284, 500, 54, 40, 500, 52, 58, 264, 90, 56, 500, 74, 44, 56, 48, 42, 500, 500, 74, 500, 100, 326, 500, 500, 42, 500, 88, 500, 58, 84, 500, 500, 134, 136, 98, 214, 164, 500, 42, 54, 68, 58, 500, 44, 72, 500, 500, 500, 142, 500, 132, 166, 500, 500, 46, 58, 500, 138, 80, 94, 500, 130, 500, 78, 30, 500, 500, 500, 176, 124, 500, 76, 500, 500, 446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793510539020329, "mean_inference_ms": 1.2187453045199474, "mean_action_processing_ms": 0.1404894843689389, "mean_env_wait_ms": 0.08449426394198674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.11304116249084473}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5292.142681925511, "num_env_steps_trained_throughput_per_sec": 5292.142681925511, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2139.368, "sample_time_ms": 1916.254, "load_time_ms": 12.342, "load_throughput": 972263.447, "learn_time_ms": 198.267, "learn_throughput": 60524.566, "synch_weights_time_ms": 10.839}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3144, "training_iteration": 69, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-09", "timestamp": 1698249849, "time_this_iter_s": 2.2730064392089844, "time_total_s": 148.8226330280304, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.8226330280304, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 56.300000000000004, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0003, "total_loss": 6.382813347710504, "policy_loss": 0.00011583490090237724, "vf_loss": 6.382752842373318, "vf_explained_var": -1.8543667263454861e-07, "kl": 3.373447966876281e-05, "entropy": 0.550047430727217, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7530000000002012, "episode_len_mean": 283.08, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 40.30000000000002, 28.699999999999967, 33.70000000000004, -50.00000000000044, 45.9, 44.7, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 36.900000000000034, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 36.30000000000003, 42.10000000000001, 40.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.70000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 22.099999999999874, 43.50000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 38.90000000000002, 44.5, 38.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 28.09999999999996, 45.3, 44.300000000000004, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 42, 500, 500, 74, 500, 100, 326, 500, 500, 42, 500, 88, 500, 58, 84, 500, 500, 134, 136, 98, 214, 164, 500, 42, 54, 68, 58, 500, 44, 72, 500, 500, 500, 142, 500, 132, 166, 500, 500, 46, 58, 500, 138, 80, 94, 500, 130, 500, 78, 30, 500, 500, 500, 176, 124, 500, 76, 500, 500, 446, 500, 500, 46, 40, 500, 280, 66, 286, 500, 500, 90, 500, 500, 500, 500, 500, 76, 44, 500, 34, 46, 500, 112, 56, 118, 102, 500, 500, 500, 500, 108, 220, 48, 58, 74, 42, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792640349868248, "mean_inference_ms": 1.2194217892082664, "mean_action_processing_ms": 0.1405760727862984, "mean_env_wait_ms": 0.08447513046380259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017001867294311523, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12469005584716797}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7530000000002012, "episode_len_mean": 283.08, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 17.499999999999808, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 40.30000000000002, 28.699999999999967, 33.70000000000004, -50.00000000000044, 45.9, 44.7, 43.30000000000001, 44.300000000000004, -50.00000000000044, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 36.900000000000034, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, 36.30000000000003, 42.10000000000001, 40.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.70000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 22.099999999999874, 43.50000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 38.90000000000002, 44.5, 38.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 28.09999999999996, 45.3, 44.300000000000004, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 42, 500, 500, 74, 500, 100, 326, 500, 500, 42, 500, 88, 500, 58, 84, 500, 500, 134, 136, 98, 214, 164, 500, 42, 54, 68, 58, 500, 44, 72, 500, 500, 500, 142, 500, 132, 166, 500, 500, 46, 58, 500, 138, 80, 94, 500, 130, 500, 78, 30, 500, 500, 500, 176, 124, 500, 76, 500, 500, 446, 500, 500, 46, 40, 500, 280, 66, 286, 500, 500, 90, 500, 500, 500, 500, 500, 76, 44, 500, 34, 46, 500, 112, 56, 118, 102, 500, 500, 500, 500, 108, 220, 48, 58, 74, 42, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792640349868248, "mean_inference_ms": 1.2194217892082664, "mean_action_processing_ms": 0.1405760727862984, "mean_env_wait_ms": 0.08447513046380259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017001867294311523, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12469005584716797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5935.311351898901, "num_env_steps_trained_throughput_per_sec": 5935.311351898901, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2117.045, "sample_time_ms": 1917.905, "load_time_ms": 11.202, "load_throughput": 1071228.009, "learn_time_ms": 175.974, "learn_throughput": 68191.721, "synch_weights_time_ms": 10.216}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3183, "training_iteration": 70, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-11", "timestamp": 1698249851, "time_this_iter_s": 2.03061842918396, "time_total_s": 150.85325145721436, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 150.85325145721436, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 60.76666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0003, "total_loss": 6.672347121768528, "policy_loss": -0.00045572717984517414, "vf_loss": 6.6728554301791725, "vf_explained_var": -1.5894571940104167e-06, "kl": 0.00034871634155603855, "entropy": 0.5255852573447757, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1540000000002058, "episode_len_mean": 292.1, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 36.30000000000003, 42.10000000000001, 40.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.70000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 22.099999999999874, 43.50000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 38.90000000000002, 44.5, 38.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 28.09999999999996, 45.3, 44.300000000000004, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 30.29999999999999, 34.50000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 12.299999999999734, 30.699999999999996, 47.5, -50.00000000000044, 44.7, 35.900000000000034, 40.500000000000014, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 38.700000000000024, 25.499999999999922, 45.1, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.7, 15.699999999999783, -50.00000000000044, 38.700000000000024, 21.89999999999987, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001], "episode_lengths": [58, 500, 138, 80, 94, 500, 130, 500, 78, 30, 500, 500, 500, 176, 124, 500, 76, 500, 500, 446, 500, 500, 46, 40, 500, 280, 66, 286, 500, 500, 90, 500, 500, 500, 500, 500, 76, 44, 500, 34, 46, 500, 112, 56, 118, 102, 500, 500, 500, 500, 108, 220, 48, 58, 74, 42, 500, 500, 500, 500, 154, 56, 198, 156, 500, 84, 500, 378, 194, 26, 500, 54, 142, 96, 356, 500, 500, 500, 500, 82, 500, 114, 246, 50, 36, 500, 74, 500, 64, 344, 500, 114, 282, 500, 500, 286, 500, 178, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37935198832652317, "mean_inference_ms": 1.2195638565092544, "mean_action_processing_ms": 0.14045113140364449, "mean_env_wait_ms": 0.08449615587802399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700115203857422, "StateBufferConnector_ms": 0.010997772216796875, "ViewRequirementAgentConnector_ms": 0.12567710876464844}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1540000000002058, "episode_len_mean": 292.1, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, 36.30000000000003, 42.10000000000001, 40.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.30000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 37.70000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 22.099999999999874, 43.50000000000001, 21.499999999999865, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.7, -50.00000000000044, 46.699999999999996, 45.5, -50.00000000000044, 38.90000000000002, 44.5, 38.300000000000026, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 28.09999999999996, 45.3, 44.300000000000004, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 30.29999999999999, 34.50000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 12.299999999999734, 30.699999999999996, 47.5, -50.00000000000044, 44.7, 35.900000000000034, 40.500000000000014, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 38.700000000000024, 25.499999999999922, 45.1, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.7, 15.699999999999783, -50.00000000000044, 38.700000000000024, 21.89999999999987, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001], "episode_lengths": [58, 500, 138, 80, 94, 500, 130, 500, 78, 30, 500, 500, 500, 176, 124, 500, 76, 500, 500, 446, 500, 500, 46, 40, 500, 280, 66, 286, 500, 500, 90, 500, 500, 500, 500, 500, 76, 44, 500, 34, 46, 500, 112, 56, 118, 102, 500, 500, 500, 500, 108, 220, 48, 58, 74, 42, 500, 500, 500, 500, 154, 56, 198, 156, 500, 84, 500, 378, 194, 26, 500, 54, 142, 96, 356, 500, 500, 500, 500, 82, 500, 114, 246, 50, 36, 500, 74, 500, 64, 344, 500, 114, 282, 500, 500, 286, 500, 178, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37935198832652317, "mean_inference_ms": 1.2195638565092544, "mean_action_processing_ms": 0.14045113140364449, "mean_env_wait_ms": 0.08449615587802399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700115203857422, "StateBufferConnector_ms": 0.010997772216796875, "ViewRequirementAgentConnector_ms": 0.12567710876464844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5731.51558493024, "num_env_steps_trained_throughput_per_sec": 5731.51558493024, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2121.835, "sample_time_ms": 1918.448, "load_time_ms": 11.503, "load_throughput": 1043214.313, "learn_time_ms": 180.012, "learn_throughput": 66662.271, "synch_weights_time_ms": 10.125}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3224, "training_iteration": 71, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-13", "timestamp": 1698249853, "time_this_iter_s": 2.0981862545013428, "time_total_s": 152.9514377117157, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.9514377117157, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 66.55000000000001, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0003, "total_loss": 6.815357208251953, "policy_loss": -0.0015217521124415928, "vf_loss": 6.816932837168376, "vf_explained_var": -1.7881393432617188e-06, "kl": 0.0013419058859306511, "entropy": 0.5393631392055087, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 644.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.768999999999838, "episode_len_mean": 257.96, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 30.29999999999999, 34.50000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 12.299999999999734, 30.699999999999996, 47.5, -50.00000000000044, 44.7, 35.900000000000034, 40.500000000000014, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 38.700000000000024, 25.499999999999922, 45.1, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.7, 15.699999999999783, -50.00000000000044, 38.700000000000024, 21.89999999999987, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.09999999999993, 45.5, 30.699999999999996, 41.90000000000001, 39.70000000000002, 45.9, 37.10000000000003, 40.90000000000002, -50.00000000000044, 44.7, 40.70000000000002, 42.30000000000001, 43.7, 46.5, 43.7, -50.00000000000044, 31.1, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 29.099999999999973, -50.00000000000044, 42.900000000000006, 32.90000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 44.900000000000006, 15.299999999999777, 42.70000000000001, 42.30000000000001, 25.29999999999992, 45.3, -50.00000000000044, -50.00000000000044, 25.699999999999925, 34.10000000000004, 36.50000000000003, 28.699999999999967, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [58, 74, 42, 500, 500, 500, 500, 154, 56, 198, 156, 500, 84, 500, 378, 194, 26, 500, 54, 142, 96, 356, 500, 500, 500, 500, 82, 500, 114, 246, 50, 36, 500, 74, 500, 64, 344, 500, 114, 282, 500, 500, 286, 500, 178, 500, 70, 110, 240, 46, 194, 82, 104, 42, 130, 92, 500, 54, 94, 78, 64, 36, 64, 500, 190, 48, 500, 500, 36, 210, 500, 72, 172, 128, 500, 500, 500, 120, 68, 500, 52, 348, 74, 78, 248, 48, 500, 500, 244, 160, 136, 214, 500, 46, 500, 102, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791713240084602, "mean_inference_ms": 1.2185730421406233, "mean_action_processing_ms": 0.1405077542421599, "mean_env_wait_ms": 0.08437595726287743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018885135650634766, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.12296891212463379}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.768999999999838, "episode_len_mean": 257.96, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 44.5, 30.29999999999999, 34.50000000000004, -50.00000000000044, 41.70000000000002, -50.00000000000044, 12.299999999999734, 30.699999999999996, 47.5, -50.00000000000044, 44.7, 35.900000000000034, 40.500000000000014, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 38.700000000000024, 25.499999999999922, 45.1, 46.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.7, 15.699999999999783, -50.00000000000044, 38.700000000000024, 21.89999999999987, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.09999999999993, 45.5, 30.699999999999996, 41.90000000000001, 39.70000000000002, 45.9, 37.10000000000003, 40.90000000000002, -50.00000000000044, 44.7, 40.70000000000002, 42.30000000000001, 43.7, 46.5, 43.7, -50.00000000000044, 31.1, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 29.099999999999973, -50.00000000000044, 42.900000000000006, 32.90000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 44.900000000000006, 15.299999999999777, 42.70000000000001, 42.30000000000001, 25.29999999999992, 45.3, -50.00000000000044, -50.00000000000044, 25.699999999999925, 34.10000000000004, 36.50000000000003, 28.699999999999967, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [58, 74, 42, 500, 500, 500, 500, 154, 56, 198, 156, 500, 84, 500, 378, 194, 26, 500, 54, 142, 96, 356, 500, 500, 500, 500, 82, 500, 114, 246, 50, 36, 500, 74, 500, 64, 344, 500, 114, 282, 500, 500, 286, 500, 178, 500, 70, 110, 240, 46, 194, 82, 104, 42, 130, 92, 500, 54, 94, 78, 64, 36, 64, 500, 190, 48, 500, 500, 36, 210, 500, 72, 172, 128, 500, 500, 500, 120, 68, 500, 52, 348, 74, 78, 248, 48, 500, 500, 244, 160, 136, 214, 500, 46, 500, 102, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791713240084602, "mean_inference_ms": 1.2185730421406233, "mean_action_processing_ms": 0.1405077542421599, "mean_env_wait_ms": 0.08437595726287743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018885135650634766, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.12296891212463379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5431.481988476743, "num_env_steps_trained_throughput_per_sec": 5431.481988476743, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2128.892, "sample_time_ms": 1920.214, "load_time_ms": 11.476, "load_throughput": 1045635.151, "learn_time_ms": 185.21, "learn_throughput": 64791.438, "synch_weights_time_ms": 10.243}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3277, "training_iteration": 72, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-16", "timestamp": 1698249856, "time_this_iter_s": 2.215312957763672, "time_total_s": 155.16675066947937, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.16675066947937, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 55.5, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0003, "total_loss": 6.075900713602702, "policy_loss": 7.941408289803399e-05, "vf_loss": 6.075876288943821, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.00028854575733324356, "entropy": 0.5502779020203484, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.403999999999844, "episode_len_mean": 246.62, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.09999999999993, 45.5, 30.699999999999996, 41.90000000000001, 39.70000000000002, 45.9, 37.10000000000003, 40.90000000000002, -50.00000000000044, 44.7, 40.70000000000002, 42.30000000000001, 43.7, 46.5, 43.7, -50.00000000000044, 31.1, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 29.099999999999973, -50.00000000000044, 42.900000000000006, 32.90000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 44.900000000000006, 15.299999999999777, 42.70000000000001, 42.30000000000001, 25.29999999999992, 45.3, -50.00000000000044, -50.00000000000044, 25.699999999999925, 34.10000000000004, 36.50000000000003, 28.699999999999967, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, 39.70000000000002, 40.10000000000002, -50.00000000000044, 29.69999999999998, 46.099999999999994, 45.5, 26.09999999999993, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.70000000000002, 35.900000000000034, 29.099999999999973, 44.7, 41.70000000000002, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 27.899999999999956, 34.30000000000004, 36.50000000000003, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 178, 500, 70, 110, 240, 46, 194, 82, 104, 42, 130, 92, 500, 54, 94, 78, 64, 36, 64, 500, 190, 48, 500, 500, 36, 210, 500, 72, 172, 128, 500, 500, 500, 120, 68, 500, 52, 348, 74, 78, 248, 48, 500, 500, 244, 160, 136, 214, 500, 46, 500, 102, 500, 64, 500, 500, 92, 74, 104, 100, 500, 204, 40, 46, 240, 500, 68, 500, 84, 142, 210, 54, 84, 58, 500, 70, 34, 500, 500, 500, 500, 118, 60, 52, 500, 500, 500, 500, 500, 38, 80, 500, 500, 486, 222, 158, 136, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792255690698031, "mean_inference_ms": 1.218090686917979, "mean_action_processing_ms": 0.14061180467853107, "mean_env_wait_ms": 0.08439426338731894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029886245727539062, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.13997983932495117}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.403999999999844, "episode_len_mean": 246.62, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.30000000000002, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.09999999999993, 45.5, 30.699999999999996, 41.90000000000001, 39.70000000000002, 45.9, 37.10000000000003, 40.90000000000002, -50.00000000000044, 44.7, 40.70000000000002, 42.30000000000001, 43.7, 46.5, 43.7, -50.00000000000044, 31.1, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 29.099999999999973, -50.00000000000044, 42.900000000000006, 32.90000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 44.900000000000006, 15.299999999999777, 42.70000000000001, 42.30000000000001, 25.29999999999992, 45.3, -50.00000000000044, -50.00000000000044, 25.699999999999925, 34.10000000000004, 36.50000000000003, 28.699999999999967, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, 39.70000000000002, 40.10000000000002, -50.00000000000044, 29.69999999999998, 46.099999999999994, 45.5, 26.09999999999993, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.70000000000002, 35.900000000000034, 29.099999999999973, 44.7, 41.70000000000002, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 27.899999999999956, 34.30000000000004, 36.50000000000003, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 178, 500, 70, 110, 240, 46, 194, 82, 104, 42, 130, 92, 500, 54, 94, 78, 64, 36, 64, 500, 190, 48, 500, 500, 36, 210, 500, 72, 172, 128, 500, 500, 500, 120, 68, 500, 52, 348, 74, 78, 248, 48, 500, 500, 244, 160, 136, 214, 500, 46, 500, 102, 500, 64, 500, 500, 92, 74, 104, 100, 500, 204, 40, 46, 240, 500, 68, 500, 84, 142, 210, 54, 84, 58, 500, 70, 34, 500, 500, 500, 500, 118, 60, 52, 500, 500, 500, 500, 500, 38, 80, 500, 500, 486, 222, 158, 136, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792255690698031, "mean_inference_ms": 1.218090686917979, "mean_action_processing_ms": 0.14061180467853107, "mean_env_wait_ms": 0.08439426338731894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029886245727539062, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.13997983932495117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5935.04819518771, "num_env_steps_trained_throughput_per_sec": 5935.04819518771, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2125.632, "sample_time_ms": 1917.251, "load_time_ms": 11.677, "load_throughput": 1027652.566, "learn_time_ms": 184.508, "learn_throughput": 65037.691, "synch_weights_time_ms": 10.346}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3320, "training_iteration": 73, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-18", "timestamp": 1698249858, "time_this_iter_s": 2.0266337394714355, "time_total_s": 157.1933844089508, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.1933844089508, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 64.15, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0003, "total_loss": 6.508133199479845, "policy_loss": -0.00020579186578591666, "vf_loss": 6.50839016172621, "vf_explained_var": -1.2384520636664497e-06, "kl": 0.00010944427447788662, "entropy": 0.5119464430544112, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7809999999998105, "episode_len_mean": 277.8, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.29999999999992, 45.3, -50.00000000000044, -50.00000000000044, 25.699999999999925, 34.10000000000004, 36.50000000000003, 28.699999999999967, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, 39.70000000000002, 40.10000000000002, -50.00000000000044, 29.69999999999998, 46.099999999999994, 45.5, 26.09999999999993, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.70000000000002, 35.900000000000034, 29.099999999999973, 44.7, 41.70000000000002, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 27.899999999999956, 34.30000000000004, 36.50000000000003, 42.900000000000006, -50.00000000000044, 21.299999999999862, 46.3, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.7, 36.70000000000003, 44.7, 38.10000000000002, 43.30000000000001, 44.10000000000001, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 40.500000000000014, 11.899999999999729, 43.30000000000001, 6.099999999999646, 44.10000000000001], "episode_lengths": [248, 48, 500, 500, 244, 160, 136, 214, 500, 46, 500, 102, 500, 64, 500, 500, 92, 74, 104, 100, 500, 204, 40, 46, 240, 500, 68, 500, 84, 142, 210, 54, 84, 58, 500, 70, 34, 500, 500, 500, 500, 118, 60, 52, 500, 500, 500, 500, 500, 38, 80, 500, 500, 486, 222, 158, 136, 72, 500, 288, 38, 110, 146, 54, 500, 134, 68, 500, 500, 52, 500, 454, 500, 500, 500, 230, 500, 500, 80, 500, 64, 134, 54, 120, 68, 60, 462, 500, 500, 58, 500, 500, 500, 172, 500, 96, 382, 68, 440, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791329852878997, "mean_inference_ms": 1.218728160161687, "mean_action_processing_ms": 0.14064346421251336, "mean_env_wait_ms": 0.08441131499394505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030003070831298828, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.13098478317260742}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7809999999998105, "episode_len_mean": 277.8, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.29999999999992, 45.3, -50.00000000000044, -50.00000000000044, 25.699999999999925, 34.10000000000004, 36.50000000000003, 28.699999999999967, -50.00000000000044, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, 39.70000000000002, 40.10000000000002, -50.00000000000044, 29.69999999999998, 46.099999999999994, 45.5, 26.09999999999993, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.70000000000002, 35.900000000000034, 29.099999999999973, 44.7, 41.70000000000002, 44.300000000000004, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 27.899999999999956, 34.30000000000004, 36.50000000000003, 42.900000000000006, -50.00000000000044, 21.299999999999862, 46.3, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.7, 36.70000000000003, 44.7, 38.10000000000002, 43.30000000000001, 44.10000000000001, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 40.500000000000014, 11.899999999999729, 43.30000000000001, 6.099999999999646, 44.10000000000001], "episode_lengths": [248, 48, 500, 500, 244, 160, 136, 214, 500, 46, 500, 102, 500, 64, 500, 500, 92, 74, 104, 100, 500, 204, 40, 46, 240, 500, 68, 500, 84, 142, 210, 54, 84, 58, 500, 70, 34, 500, 500, 500, 500, 118, 60, 52, 500, 500, 500, 500, 500, 38, 80, 500, 500, 486, 222, 158, 136, 72, 500, 288, 38, 110, 146, 54, 500, 134, 68, 500, 500, 52, 500, 454, 500, 500, 500, 230, 500, 500, 80, 500, 64, 134, 54, 120, 68, 60, 462, 500, 500, 58, 500, 500, 500, 172, 500, 96, 382, 68, 440, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791329852878997, "mean_inference_ms": 1.218728160161687, "mean_action_processing_ms": 0.14064346421251336, "mean_env_wait_ms": 0.08441131499394505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030003070831298828, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.13098478317260742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5675.648813221562, "num_env_steps_trained_throughput_per_sec": 5675.648813221562, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2111.944, "sample_time_ms": 1911.846, "load_time_ms": 11.472, "load_throughput": 1046054.573, "learn_time_ms": 176.428, "learn_throughput": 68016.338, "synch_weights_time_ms": 10.435}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3361, "training_iteration": 74, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-20", "timestamp": 1698249860, "time_this_iter_s": 2.1192715167999268, "time_total_s": 159.31265592575073, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 159.31265592575073, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 61.73333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0003, "total_loss": 6.923391024271647, "policy_loss": -0.0001942614714304606, "vf_loss": 6.9236405160692005, "vf_explained_var": -6.490283542209202e-07, "kl": 0.0004759583157149589, "entropy": 0.5518709619839987, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.282999999999813, "episode_len_mean": 272.8, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 27.899999999999956, 34.30000000000004, 36.50000000000003, 42.900000000000006, -50.00000000000044, 21.299999999999862, 46.3, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.7, 36.70000000000003, 44.7, 38.10000000000002, 43.30000000000001, 44.10000000000001, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 40.500000000000014, 11.899999999999729, 43.30000000000001, 6.099999999999646, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 41.30000000000001, 43.900000000000006, 26.89999999999994, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 43.900000000000006, 44.900000000000006, 14.299999999999763, -50.00000000000044, 42.500000000000014, -50.00000000000044, 21.299999999999862, 43.10000000000001, 45.9, -50.00000000000044, 31.300000000000004, 30.499999999999993, 42.500000000000014, -50.00000000000044, 42.30000000000001, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.90000000000002, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 45.1, 38.300000000000026, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 40.30000000000002, 46.699999999999996], "episode_lengths": [80, 500, 500, 486, 222, 158, 136, 72, 500, 288, 38, 110, 146, 54, 500, 134, 68, 500, 500, 52, 500, 454, 500, 500, 500, 230, 500, 500, 80, 500, 64, 134, 54, 120, 68, 60, 462, 500, 500, 58, 500, 500, 500, 172, 500, 96, 382, 68, 440, 60, 500, 500, 500, 500, 408, 500, 88, 62, 232, 500, 44, 98, 500, 500, 242, 62, 52, 358, 500, 76, 500, 288, 70, 42, 500, 188, 196, 76, 500, 78, 68, 46, 500, 500, 78, 112, 64, 62, 500, 500, 40, 64, 50, 118, 500, 130, 110, 500, 98, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37922598678208147, "mean_inference_ms": 1.2179700394234452, "mean_action_processing_ms": 0.14056930390761405, "mean_env_wait_ms": 0.08443350838781034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398848533630371, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.10352253913879395}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.282999999999813, "episode_len_mean": 272.8, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 27.899999999999956, 34.30000000000004, 36.50000000000003, 42.900000000000006, -50.00000000000044, 21.299999999999862, 46.3, 39.10000000000002, 35.500000000000036, 44.7, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.7, 36.70000000000003, 44.7, 38.10000000000002, 43.30000000000001, 44.10000000000001, 3.899999999999615, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 40.500000000000014, 11.899999999999729, 43.30000000000001, 6.099999999999646, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 41.30000000000001, 43.900000000000006, 26.89999999999994, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 43.900000000000006, 44.900000000000006, 14.299999999999763, -50.00000000000044, 42.500000000000014, -50.00000000000044, 21.299999999999862, 43.10000000000001, 45.9, -50.00000000000044, 31.300000000000004, 30.499999999999993, 42.500000000000014, -50.00000000000044, 42.30000000000001, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.90000000000002, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 45.1, 38.300000000000026, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 40.30000000000002, 46.699999999999996], "episode_lengths": [80, 500, 500, 486, 222, 158, 136, 72, 500, 288, 38, 110, 146, 54, 500, 134, 68, 500, 500, 52, 500, 454, 500, 500, 500, 230, 500, 500, 80, 500, 64, 134, 54, 120, 68, 60, 462, 500, 500, 58, 500, 500, 500, 172, 500, 96, 382, 68, 440, 60, 500, 500, 500, 500, 408, 500, 88, 62, 232, 500, 44, 98, 500, 500, 242, 62, 52, 358, 500, 76, 500, 288, 70, 42, 500, 188, 196, 76, 500, 78, 68, 46, 500, 500, 78, 112, 64, 62, 500, 500, 40, 64, 50, 118, 500, 130, 110, 500, 98, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37922598678208147, "mean_inference_ms": 1.2179700394234452, "mean_action_processing_ms": 0.14056930390761405, "mean_env_wait_ms": 0.08443350838781034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398848533630371, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.10352253913879395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5937.056755366119, "num_env_steps_trained_throughput_per_sec": 5937.056755366119, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2112.166, "sample_time_ms": 1906.638, "load_time_ms": 11.685, "load_throughput": 1026939.665, "learn_time_ms": 181.626, "learn_throughput": 66069.841, "synch_weights_time_ms": 10.539}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3411, "training_iteration": 75, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-22", "timestamp": 1698249862, "time_this_iter_s": 2.0262014865875244, "time_total_s": 161.33885741233826, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.33885741233826, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 60.26666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0003, "total_loss": 6.370236078898112, "policy_loss": -5.098897963762283e-05, "vf_loss": 6.370339817470974, "vf_explained_var": -1.0662608676486545e-06, "kl": 0.00016174587581948194, "entropy": 0.5279219349225363, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 680.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.573999999999824, "episode_len_mean": 264.9, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.90000000000003, -50.00000000000044, 40.500000000000014, 11.899999999999729, 43.30000000000001, 6.099999999999646, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 41.30000000000001, 43.900000000000006, 26.89999999999994, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 43.900000000000006, 44.900000000000006, 14.299999999999763, -50.00000000000044, 42.500000000000014, -50.00000000000044, 21.299999999999862, 43.10000000000001, 45.9, -50.00000000000044, 31.300000000000004, 30.499999999999993, 42.500000000000014, -50.00000000000044, 42.30000000000001, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.90000000000002, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 45.1, 38.300000000000026, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.10000000000001, 35.10000000000004, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, 41.30000000000001, -50.00000000000044, 32.700000000000024, 41.90000000000001, 37.300000000000026, 22.899999999999885, -50.00000000000044, 37.90000000000003, 39.50000000000002, 39.300000000000026, 10.099999999999703, 47.1, 43.50000000000001, -50.00000000000044, 45.3, 40.500000000000014, 28.89999999999997, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 34.900000000000034, -50.00000000000044], "episode_lengths": [500, 172, 500, 96, 382, 68, 440, 60, 500, 500, 500, 500, 408, 500, 88, 62, 232, 500, 44, 98, 500, 500, 242, 62, 52, 358, 500, 76, 500, 288, 70, 42, 500, 188, 196, 76, 500, 78, 68, 46, 500, 500, 78, 112, 64, 62, 500, 500, 40, 64, 50, 118, 500, 130, 110, 500, 98, 34, 500, 500, 160, 72, 500, 500, 500, 500, 354, 500, 70, 150, 290, 500, 500, 102, 48, 88, 500, 174, 82, 128, 272, 500, 122, 106, 108, 400, 30, 66, 500, 48, 96, 212, 64, 500, 500, 500, 82, 62, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37909733736985324, "mean_inference_ms": 1.2176597592670833, "mean_action_processing_ms": 0.14074940120940943, "mean_env_wait_ms": 0.08448024580505958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.09558701515197754}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.573999999999824, "episode_len_mean": 264.9, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.90000000000003, -50.00000000000044, 40.500000000000014, 11.899999999999729, 43.30000000000001, 6.099999999999646, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 41.30000000000001, 43.900000000000006, 26.89999999999994, -50.00000000000044, 45.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 25.899999999999928, 43.900000000000006, 44.900000000000006, 14.299999999999763, -50.00000000000044, 42.500000000000014, -50.00000000000044, 21.299999999999862, 43.10000000000001, 45.9, -50.00000000000044, 31.300000000000004, 30.499999999999993, 42.500000000000014, -50.00000000000044, 42.30000000000001, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 38.90000000000002, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.7, 45.1, 38.300000000000026, -50.00000000000044, 37.10000000000003, 39.10000000000002, -50.00000000000044, 40.30000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.10000000000001, 35.10000000000004, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, 41.30000000000001, -50.00000000000044, 32.700000000000024, 41.90000000000001, 37.300000000000026, 22.899999999999885, -50.00000000000044, 37.90000000000003, 39.50000000000002, 39.300000000000026, 10.099999999999703, 47.1, 43.50000000000001, -50.00000000000044, 45.3, 40.500000000000014, 28.89999999999997, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 34.900000000000034, -50.00000000000044], "episode_lengths": [500, 172, 500, 96, 382, 68, 440, 60, 500, 500, 500, 500, 408, 500, 88, 62, 232, 500, 44, 98, 500, 500, 242, 62, 52, 358, 500, 76, 500, 288, 70, 42, 500, 188, 196, 76, 500, 78, 68, 46, 500, 500, 78, 112, 64, 62, 500, 500, 40, 64, 50, 118, 500, 130, 110, 500, 98, 34, 500, 500, 160, 72, 500, 500, 500, 500, 354, 500, 70, 150, 290, 500, 500, 102, 48, 88, 500, 174, 82, 128, 272, 500, 122, 106, 108, 400, 30, 66, 500, 48, 96, 212, 64, 500, 500, 500, 82, 62, 152, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37909733736985324, "mean_inference_ms": 1.2176597592670833, "mean_action_processing_ms": 0.14074940120940943, "mean_env_wait_ms": 0.08448024580505958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021996021270751953, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.09558701515197754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5692.21967018778, "num_env_steps_trained_throughput_per_sec": 5692.21967018778, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2112.157, "sample_time_ms": 1904.719, "load_time_ms": 12.391, "load_throughput": 968426.594, "learn_time_ms": 182.972, "learn_throughput": 65583.839, "synch_weights_time_ms": 10.496}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3453, "training_iteration": 76, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-24", "timestamp": 1698249864, "time_this_iter_s": 2.1141364574432373, "time_total_s": 163.4529938697815, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 163.4529938697815, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 63.46666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0003, "total_loss": 7.661320792304145, "policy_loss": -1.8593337800767687e-05, "vf_loss": 7.661398516760932, "vf_explained_var": -1.0861290825737847e-06, "kl": 6.605631428528251e-05, "entropy": 0.5918403731452094, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.98899999999985, "episode_len_mean": 245.8, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.10000000000001, 35.10000000000004, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, 41.30000000000001, -50.00000000000044, 32.700000000000024, 41.90000000000001, 37.300000000000026, 22.899999999999885, -50.00000000000044, 37.90000000000003, 39.50000000000002, 39.300000000000026, 10.099999999999703, 47.1, 43.50000000000001, -50.00000000000044, 45.3, 40.500000000000014, 28.89999999999997, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.300000000000026, 45.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.50000000000003, 40.90000000000002, 34.10000000000004, -50.00000000000044, -50.00000000000044, 20.899999999999856, 40.500000000000014, 41.90000000000001, -50.00000000000044, 41.100000000000016, 45.9, 44.7, 41.30000000000001, 34.10000000000004, 42.30000000000001, 43.900000000000006, 24.499999999999908, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, 19.499999999999837, 44.5, 33.70000000000004, 43.50000000000001, 43.30000000000001, 37.10000000000003, 39.70000000000002, 19.69999999999984, -50.00000000000044, 8.299999999999677, 44.7, -50.00000000000044, 43.30000000000001, 11.099999999999717, 41.90000000000001, 37.50000000000003, -50.00000000000044, 46.5, 38.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 18.29999999999982, 36.50000000000003], "episode_lengths": [34, 500, 500, 160, 72, 500, 500, 500, 500, 354, 500, 70, 150, 290, 500, 500, 102, 48, 88, 500, 174, 82, 128, 272, 500, 122, 106, 108, 400, 30, 66, 500, 48, 96, 212, 64, 500, 500, 500, 82, 62, 152, 500, 500, 74, 128, 46, 500, 68, 500, 126, 92, 160, 500, 500, 292, 96, 82, 500, 90, 42, 54, 88, 160, 78, 62, 256, 500, 88, 38, 60, 306, 56, 164, 66, 68, 130, 104, 304, 500, 418, 54, 500, 68, 390, 82, 126, 500, 36, 112, 88, 500, 500, 248, 500, 500, 500, 54, 318, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37879456828104907, "mean_inference_ms": 1.2173537178926275, "mean_action_processing_ms": 0.14073485586451828, "mean_env_wait_ms": 0.08447481750037719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002582550048828, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.10706686973571777}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.98899999999985, "episode_len_mean": 245.8, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, -50.00000000000044, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.10000000000001, 35.10000000000004, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.3, 41.30000000000001, -50.00000000000044, 32.700000000000024, 41.90000000000001, 37.300000000000026, 22.899999999999885, -50.00000000000044, 37.90000000000003, 39.50000000000002, 39.300000000000026, 10.099999999999703, 47.1, 43.50000000000001, -50.00000000000044, 45.3, 40.500000000000014, 28.89999999999997, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.300000000000026, 45.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 37.50000000000003, 40.90000000000002, 34.10000000000004, -50.00000000000044, -50.00000000000044, 20.899999999999856, 40.500000000000014, 41.90000000000001, -50.00000000000044, 41.100000000000016, 45.9, 44.7, 41.30000000000001, 34.10000000000004, 42.30000000000001, 43.900000000000006, 24.499999999999908, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, 19.499999999999837, 44.5, 33.70000000000004, 43.50000000000001, 43.30000000000001, 37.10000000000003, 39.70000000000002, 19.69999999999984, -50.00000000000044, 8.299999999999677, 44.7, -50.00000000000044, 43.30000000000001, 11.099999999999717, 41.90000000000001, 37.50000000000003, -50.00000000000044, 46.5, 38.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 18.29999999999982, 36.50000000000003], "episode_lengths": [34, 500, 500, 160, 72, 500, 500, 500, 500, 354, 500, 70, 150, 290, 500, 500, 102, 48, 88, 500, 174, 82, 128, 272, 500, 122, 106, 108, 400, 30, 66, 500, 48, 96, 212, 64, 500, 500, 500, 82, 62, 152, 500, 500, 74, 128, 46, 500, 68, 500, 126, 92, 160, 500, 500, 292, 96, 82, 500, 90, 42, 54, 88, 160, 78, 62, 256, 500, 88, 38, 60, 306, 56, 164, 66, 68, 130, 104, 304, 500, 418, 54, 500, 68, 390, 82, 126, 500, 36, 112, 88, 500, 500, 248, 500, 500, 500, 54, 318, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37879456828104907, "mean_inference_ms": 1.2173537178926275, "mean_action_processing_ms": 0.14073485586451828, "mean_env_wait_ms": 0.08447481750037719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002582550048828, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.10706686973571777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5784.431092304568, "num_env_steps_trained_throughput_per_sec": 5784.431092304568, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2099.644, "sample_time_ms": 1905.618, "load_time_ms": 11.691, "load_throughput": 1026445.409, "learn_time_ms": 170.664, "learn_throughput": 70313.638, "synch_weights_time_ms": 10.093}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3510, "training_iteration": 77, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-26", "timestamp": 1698249866, "time_this_iter_s": 2.080561637878418, "time_total_s": 165.5335555076599, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.5335555076599, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 60.26666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0003, "total_loss": 7.409742567274305, "policy_loss": -0.00012794964843326144, "vf_loss": 7.4099315537346735, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.00019686789165420906, "entropy": 0.6088763806555006, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.214999999999863, "episode_len_mean": 233.58, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.10000000000004, -50.00000000000044, -50.00000000000044, 20.899999999999856, 40.500000000000014, 41.90000000000001, -50.00000000000044, 41.100000000000016, 45.9, 44.7, 41.30000000000001, 34.10000000000004, 42.30000000000001, 43.900000000000006, 24.499999999999908, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, 19.499999999999837, 44.5, 33.70000000000004, 43.50000000000001, 43.30000000000001, 37.10000000000003, 39.70000000000002, 19.69999999999984, -50.00000000000044, 8.299999999999677, 44.7, -50.00000000000044, 43.30000000000001, 11.099999999999717, 41.90000000000001, 37.50000000000003, -50.00000000000044, 46.5, 38.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 18.29999999999982, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 22.299999999999876, 43.50000000000001, 31.500000000000007, 45.1, -50.00000000000044, 21.89999999999987, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 19.09999999999983, 40.70000000000002, 23.699999999999896, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.700000000000024, 17.499999999999808, 35.70000000000003, 36.10000000000004, 22.49999999999988, -50.00000000000044, 23.499999999999893, 34.900000000000034, 44.300000000000004, 33.70000000000004, 34.70000000000004, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 47.7, 45.3, 42.70000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 44.10000000000001, 44.900000000000006], "episode_lengths": [160, 500, 500, 292, 96, 82, 500, 90, 42, 54, 88, 160, 78, 62, 256, 500, 88, 38, 60, 306, 56, 164, 66, 68, 130, 104, 304, 500, 418, 54, 500, 68, 390, 82, 126, 500, 36, 112, 88, 500, 500, 248, 500, 500, 500, 54, 318, 136, 500, 500, 500, 50, 500, 52, 236, 500, 278, 66, 186, 50, 500, 282, 66, 62, 500, 500, 46, 46, 310, 94, 264, 500, 68, 500, 114, 326, 144, 140, 276, 500, 266, 152, 58, 164, 154, 118, 500, 64, 500, 68, 80, 500, 24, 48, 74, 136, 500, 210, 60, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37876931093152355, "mean_inference_ms": 1.2177623827569, "mean_action_processing_ms": 0.14094538288874076, "mean_env_wait_ms": 0.0846554751190305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100825309753418, "StateBufferConnector_ms": 0.005008697509765625, "ViewRequirementAgentConnector_ms": 0.11897659301757812}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.214999999999863, "episode_len_mean": 233.58, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.10000000000004, -50.00000000000044, -50.00000000000044, 20.899999999999856, 40.500000000000014, 41.90000000000001, -50.00000000000044, 41.100000000000016, 45.9, 44.7, 41.30000000000001, 34.10000000000004, 42.30000000000001, 43.900000000000006, 24.499999999999908, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, 19.499999999999837, 44.5, 33.70000000000004, 43.50000000000001, 43.30000000000001, 37.10000000000003, 39.70000000000002, 19.69999999999984, -50.00000000000044, 8.299999999999677, 44.7, -50.00000000000044, 43.30000000000001, 11.099999999999717, 41.90000000000001, 37.50000000000003, -50.00000000000044, 46.5, 38.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 18.29999999999982, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 22.299999999999876, 43.50000000000001, 31.500000000000007, 45.1, -50.00000000000044, 21.89999999999987, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 19.09999999999983, 40.70000000000002, 23.699999999999896, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.700000000000024, 17.499999999999808, 35.70000000000003, 36.10000000000004, 22.49999999999988, -50.00000000000044, 23.499999999999893, 34.900000000000034, 44.300000000000004, 33.70000000000004, 34.70000000000004, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 47.7, 45.3, 42.70000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 44.10000000000001, 44.900000000000006], "episode_lengths": [160, 500, 500, 292, 96, 82, 500, 90, 42, 54, 88, 160, 78, 62, 256, 500, 88, 38, 60, 306, 56, 164, 66, 68, 130, 104, 304, 500, 418, 54, 500, 68, 390, 82, 126, 500, 36, 112, 88, 500, 500, 248, 500, 500, 500, 54, 318, 136, 500, 500, 500, 50, 500, 52, 236, 500, 278, 66, 186, 50, 500, 282, 66, 62, 500, 500, 46, 46, 310, 94, 264, 500, 68, 500, 114, 326, 144, 140, 276, 500, 266, 152, 58, 164, 154, 118, 500, 64, 500, 68, 80, 500, 24, 48, 74, 136, 500, 210, 60, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37876931093152355, "mean_inference_ms": 1.2177623827569, "mean_action_processing_ms": 0.14094538288874076, "mean_env_wait_ms": 0.0846554751190305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100825309753418, "StateBufferConnector_ms": 0.005008697509765625, "ViewRequirementAgentConnector_ms": 0.11897659301757812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5347.054547200686, "num_env_steps_trained_throughput_per_sec": 5347.054547200686, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2117.563, "sample_time_ms": 1904.001, "load_time_ms": 12.24, "load_throughput": 980410.89, "learn_time_ms": 189.845, "learn_throughput": 63209.575, "synch_weights_time_ms": 9.981}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3562, "training_iteration": 78, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-28", "timestamp": 1698249868, "time_this_iter_s": 2.2492241859436035, "time_total_s": 167.78277969360352, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.78277969360352, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 62.46666666666666, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0003, "total_loss": 7.499003887176514, "policy_loss": -5.216482612821791e-05, "vf_loss": 7.499119016859266, "vf_explained_var": -9.073151482476128e-07, "kl": 0.00020816003325939568, "entropy": 0.629966570271386, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 707.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.321999999999862, "episode_len_mean": 247.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.29999999999982, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 22.299999999999876, 43.50000000000001, 31.500000000000007, 45.1, -50.00000000000044, 21.89999999999987, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 19.09999999999983, 40.70000000000002, 23.699999999999896, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.700000000000024, 17.499999999999808, 35.70000000000003, 36.10000000000004, 22.49999999999988, -50.00000000000044, 23.499999999999893, 34.900000000000034, 44.300000000000004, 33.70000000000004, 34.70000000000004, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 47.7, 45.3, 42.70000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 44.10000000000001, 44.900000000000006, -50.00000000000044, 25.499999999999922, 28.09999999999996, 45.9, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 25.499999999999922, 34.30000000000004, 41.90000000000001, 4.699999999999626, 37.300000000000026, 35.900000000000034, 29.69999999999998, 42.500000000000014, 35.10000000000004, -50.00000000000044, 28.89999999999997, -50.00000000000044, 26.299999999999933, 27.899999999999956, 38.300000000000026, -50.00000000000044, 24.69999999999991, 29.899999999999984, 42.900000000000006, 8.099999999999675, 35.900000000000034, -50.00000000000044, 24.499999999999908, 31.500000000000007, -50.00000000000044, 44.300000000000004, 16.699999999999797, 44.900000000000006, 43.7, -50.00000000000044, 43.7, 28.89999999999997, 27.899999999999956, -50.00000000000044, 33.90000000000004, 7.899999999999672, 41.30000000000001, 44.10000000000001], "episode_lengths": [318, 136, 500, 500, 500, 50, 500, 52, 236, 500, 278, 66, 186, 50, 500, 282, 66, 62, 500, 500, 46, 46, 310, 94, 264, 500, 68, 500, 114, 326, 144, 140, 276, 500, 266, 152, 58, 164, 154, 118, 500, 64, 500, 68, 80, 500, 24, 48, 74, 136, 500, 210, 60, 52, 500, 246, 220, 42, 500, 500, 206, 500, 246, 158, 82, 454, 128, 142, 204, 76, 150, 500, 212, 500, 238, 222, 118, 500, 254, 202, 72, 420, 142, 500, 256, 186, 500, 58, 334, 52, 64, 500, 64, 212, 222, 500, 162, 422, 88, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791825140378421, "mean_inference_ms": 1.217453610272683, "mean_action_processing_ms": 0.1407765404350814, "mean_env_wait_ms": 0.08464816325419797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027007579803466797, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12396693229675293}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.321999999999862, "episode_len_mean": 247.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.29999999999982, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 22.299999999999876, 43.50000000000001, 31.500000000000007, 45.1, -50.00000000000044, 21.89999999999987, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 19.09999999999983, 40.70000000000002, 23.699999999999896, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.700000000000024, 17.499999999999808, 35.70000000000003, 36.10000000000004, 22.49999999999988, -50.00000000000044, 23.499999999999893, 34.900000000000034, 44.300000000000004, 33.70000000000004, 34.70000000000004, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 47.7, 45.3, 42.70000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 44.10000000000001, 44.900000000000006, -50.00000000000044, 25.499999999999922, 28.09999999999996, 45.9, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 25.499999999999922, 34.30000000000004, 41.90000000000001, 4.699999999999626, 37.300000000000026, 35.900000000000034, 29.69999999999998, 42.500000000000014, 35.10000000000004, -50.00000000000044, 28.89999999999997, -50.00000000000044, 26.299999999999933, 27.899999999999956, 38.300000000000026, -50.00000000000044, 24.69999999999991, 29.899999999999984, 42.900000000000006, 8.099999999999675, 35.900000000000034, -50.00000000000044, 24.499999999999908, 31.500000000000007, -50.00000000000044, 44.300000000000004, 16.699999999999797, 44.900000000000006, 43.7, -50.00000000000044, 43.7, 28.89999999999997, 27.899999999999956, -50.00000000000044, 33.90000000000004, 7.899999999999672, 41.30000000000001, 44.10000000000001], "episode_lengths": [318, 136, 500, 500, 500, 50, 500, 52, 236, 500, 278, 66, 186, 50, 500, 282, 66, 62, 500, 500, 46, 46, 310, 94, 264, 500, 68, 500, 114, 326, 144, 140, 276, 500, 266, 152, 58, 164, 154, 118, 500, 64, 500, 68, 80, 500, 24, 48, 74, 136, 500, 210, 60, 52, 500, 246, 220, 42, 500, 500, 206, 500, 246, 158, 82, 454, 128, 142, 204, 76, 150, 500, 212, 500, 238, 222, 118, 500, 254, 202, 72, 420, 142, 500, 256, 186, 500, 58, 334, 52, 64, 500, 64, 212, 222, 500, 162, 422, 88, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791825140378421, "mean_inference_ms": 1.217453610272683, "mean_action_processing_ms": 0.1407765404350814, "mean_env_wait_ms": 0.08464816325419797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027007579803466797, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.12396693229675293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5959.924049868473, "num_env_steps_trained_throughput_per_sec": 5959.924049868473, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2092.256, "sample_time_ms": 1902.665, "load_time_ms": 11.161, "load_throughput": 1075159.314, "learn_time_ms": 167.202, "learn_throughput": 71769.274, "synch_weights_time_ms": 9.631}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3608, "training_iteration": 79, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-30", "timestamp": 1698249870, "time_this_iter_s": 2.0194427967071533, "time_total_s": 169.80222249031067, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.80222249031067, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.333333333333336, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0003, "total_loss": 6.44443252351549, "policy_loss": -0.00010334700345993042, "vf_loss": 6.444595177968343, "vf_explained_var": -1.0530153910319011e-06, "kl": 4.841173371674914e-05, "entropy": 0.5927606887287564, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.601999999999842, "episode_len_mean": 264.66, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 33.70000000000004, 34.70000000000004, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 47.7, 45.3, 42.70000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 44.10000000000001, 44.900000000000006, -50.00000000000044, 25.499999999999922, 28.09999999999996, 45.9, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 25.499999999999922, 34.30000000000004, 41.90000000000001, 4.699999999999626, 37.300000000000026, 35.900000000000034, 29.69999999999998, 42.500000000000014, 35.10000000000004, -50.00000000000044, 28.89999999999997, -50.00000000000044, 26.299999999999933, 27.899999999999956, 38.300000000000026, -50.00000000000044, 24.69999999999991, 29.899999999999984, 42.900000000000006, 8.099999999999675, 35.900000000000034, -50.00000000000044, 24.499999999999908, 31.500000000000007, -50.00000000000044, 44.300000000000004, 16.699999999999797, 44.900000000000006, 43.7, -50.00000000000044, 43.7, 28.89999999999997, 27.899999999999956, -50.00000000000044, 33.90000000000004, 7.899999999999672, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 22.699999999999882, 41.100000000000016, 31.70000000000001, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 21.89999999999987, 34.30000000000004, 41.500000000000014, 35.30000000000004, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, 33.500000000000036, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [58, 164, 154, 118, 500, 64, 500, 68, 80, 500, 24, 48, 74, 136, 500, 210, 60, 52, 500, 246, 220, 42, 500, 500, 206, 500, 246, 158, 82, 454, 128, 142, 204, 76, 150, 500, 212, 500, 238, 222, 118, 500, 254, 202, 72, 420, 142, 500, 256, 186, 500, 58, 334, 52, 64, 500, 64, 212, 222, 500, 162, 422, 88, 60, 500, 500, 186, 500, 500, 96, 500, 500, 500, 160, 274, 90, 184, 500, 128, 90, 500, 500, 290, 500, 282, 158, 86, 148, 54, 180, 500, 500, 166, 30, 500, 500, 64, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792281035950759, "mean_inference_ms": 1.2177885887150053, "mean_action_processing_ms": 0.14046446281081856, "mean_env_wait_ms": 0.08456824807485534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.00399470329284668, "ViewRequirementAgentConnector_ms": 0.12697839736938477}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.601999999999842, "episode_len_mean": 264.66, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 33.70000000000004, 34.70000000000004, 38.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, 42.10000000000001, -50.00000000000044, 47.7, 45.3, 42.70000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 44.10000000000001, 44.900000000000006, -50.00000000000044, 25.499999999999922, 28.09999999999996, 45.9, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 25.499999999999922, 34.30000000000004, 41.90000000000001, 4.699999999999626, 37.300000000000026, 35.900000000000034, 29.69999999999998, 42.500000000000014, 35.10000000000004, -50.00000000000044, 28.89999999999997, -50.00000000000044, 26.299999999999933, 27.899999999999956, 38.300000000000026, -50.00000000000044, 24.69999999999991, 29.899999999999984, 42.900000000000006, 8.099999999999675, 35.900000000000034, -50.00000000000044, 24.499999999999908, 31.500000000000007, -50.00000000000044, 44.300000000000004, 16.699999999999797, 44.900000000000006, 43.7, -50.00000000000044, 43.7, 28.89999999999997, 27.899999999999956, -50.00000000000044, 33.90000000000004, 7.899999999999672, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 22.699999999999882, 41.100000000000016, 31.70000000000001, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 21.89999999999987, 34.30000000000004, 41.500000000000014, 35.30000000000004, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, 33.500000000000036, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [58, 164, 154, 118, 500, 64, 500, 68, 80, 500, 24, 48, 74, 136, 500, 210, 60, 52, 500, 246, 220, 42, 500, 500, 206, 500, 246, 158, 82, 454, 128, 142, 204, 76, 150, 500, 212, 500, 238, 222, 118, 500, 254, 202, 72, 420, 142, 500, 256, 186, 500, 58, 334, 52, 64, 500, 64, 212, 222, 500, 162, 422, 88, 60, 500, 500, 186, 500, 500, 96, 500, 500, 500, 160, 274, 90, 184, 500, 128, 90, 500, 500, 290, 500, 282, 158, 86, 148, 54, 180, 500, 500, 166, 30, 500, 500, 64, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792281035950759, "mean_inference_ms": 1.2177885887150053, "mean_action_processing_ms": 0.14046446281081856, "mean_env_wait_ms": 0.08456824807485534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.00399470329284668, "ViewRequirementAgentConnector_ms": 0.12697839736938477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5640.702279741879, "num_env_steps_trained_throughput_per_sec": 5640.702279741879, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2102.816, "sample_time_ms": 1903.058, "load_time_ms": 11.361, "load_throughput": 1056235.911, "learn_time_ms": 177.03, "learn_throughput": 67784.951, "synch_weights_time_ms": 9.649}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3644, "training_iteration": 80, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-33", "timestamp": 1698249873, "time_this_iter_s": 2.1323893070220947, "time_total_s": 171.93461179733276, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.93461179733276, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 62.73333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0003, "total_loss": 6.246736579471165, "policy_loss": -2.9714157183965046e-05, "vf_loss": 6.246821403503418, "vf_explained_var": -6.357828776041666e-07, "kl": 0.0001842437791815933, "entropy": 0.5511464542812772, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.406999999999829, "episode_len_mean": 271.58, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.899999999999984, 42.900000000000006, 8.099999999999675, 35.900000000000034, -50.00000000000044, 24.499999999999908, 31.500000000000007, -50.00000000000044, 44.300000000000004, 16.699999999999797, 44.900000000000006, 43.7, -50.00000000000044, 43.7, 28.89999999999997, 27.899999999999956, -50.00000000000044, 33.90000000000004, 7.899999999999672, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 22.699999999999882, 41.100000000000016, 31.70000000000001, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 21.89999999999987, 34.30000000000004, 41.500000000000014, 35.30000000000004, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, 33.500000000000036, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.300000000000026, 39.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 38.90000000000002, 44.10000000000001, 38.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.900000000000006, 40.70000000000002, 42.500000000000014, -50.00000000000044, 29.69999999999998, 9.8999999999997, 34.50000000000004, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.30000000000002, 44.300000000000004, -50.00000000000044, 17.499999999999808, -50.00000000000044, 42.10000000000001, 39.10000000000002, -50.00000000000044, 45.9, 26.09999999999993, -50.00000000000044, 43.10000000000001, -50.00000000000044, 4.699999999999626, 26.69999999999994, 42.900000000000006], "episode_lengths": [202, 72, 420, 142, 500, 256, 186, 500, 58, 334, 52, 64, 500, 64, 212, 222, 500, 162, 422, 88, 60, 500, 500, 186, 500, 500, 96, 500, 500, 500, 160, 274, 90, 184, 500, 128, 90, 500, 500, 290, 500, 282, 158, 86, 148, 54, 180, 500, 500, 166, 30, 500, 500, 64, 500, 500, 76, 128, 102, 60, 500, 500, 120, 112, 60, 112, 128, 500, 500, 100, 52, 94, 76, 500, 204, 402, 156, 76, 80, 500, 500, 500, 500, 54, 98, 58, 500, 326, 500, 80, 110, 500, 42, 240, 500, 70, 500, 454, 234, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792338598681835, "mean_inference_ms": 1.217937977425224, "mean_action_processing_ms": 0.14036663180657627, "mean_env_wait_ms": 0.08462309068330154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030998706817626953, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13198184967041016}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.406999999999829, "episode_len_mean": 271.58, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.899999999999984, 42.900000000000006, 8.099999999999675, 35.900000000000034, -50.00000000000044, 24.499999999999908, 31.500000000000007, -50.00000000000044, 44.300000000000004, 16.699999999999797, 44.900000000000006, 43.7, -50.00000000000044, 43.7, 28.89999999999997, 27.899999999999956, -50.00000000000044, 33.90000000000004, 7.899999999999672, 41.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 22.699999999999882, 41.100000000000016, 31.70000000000001, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 21.89999999999987, 34.30000000000004, 41.500000000000014, 35.30000000000004, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, 33.500000000000036, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.300000000000026, 39.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 38.90000000000002, 44.10000000000001, 38.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.900000000000006, 40.70000000000002, 42.500000000000014, -50.00000000000044, 29.69999999999998, 9.8999999999997, 34.50000000000004, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.30000000000002, 44.300000000000004, -50.00000000000044, 17.499999999999808, -50.00000000000044, 42.10000000000001, 39.10000000000002, -50.00000000000044, 45.9, 26.09999999999993, -50.00000000000044, 43.10000000000001, -50.00000000000044, 4.699999999999626, 26.69999999999994, 42.900000000000006], "episode_lengths": [202, 72, 420, 142, 500, 256, 186, 500, 58, 334, 52, 64, 500, 64, 212, 222, 500, 162, 422, 88, 60, 500, 500, 186, 500, 500, 96, 500, 500, 500, 160, 274, 90, 184, 500, 128, 90, 500, 500, 290, 500, 282, 158, 86, 148, 54, 180, 500, 500, 166, 30, 500, 500, 64, 500, 500, 76, 128, 102, 60, 500, 500, 120, 112, 60, 112, 128, 500, 500, 100, 52, 94, 76, 500, 204, 402, 156, 76, 80, 500, 500, 500, 500, 54, 98, 58, 500, 326, 500, 80, 110, 500, 42, 240, 500, 70, 500, 454, 234, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792338598681835, "mean_inference_ms": 1.217937977425224, "mean_action_processing_ms": 0.14036663180657627, "mean_env_wait_ms": 0.08462309068330154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030998706817626953, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13198184967041016}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5498.70015115741, "num_env_steps_trained_throughput_per_sec": 5498.70015115741, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2111.681, "sample_time_ms": 1903.751, "load_time_ms": 12.06, "load_throughput": 994997.46, "learn_time_ms": 184.608, "learn_throughput": 65002.48, "synch_weights_time_ms": 9.644}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3687, "training_iteration": 81, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-35", "timestamp": 1698249875, "time_this_iter_s": 2.1890511512756348, "time_total_s": 174.1236629486084, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.1236629486084, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 60.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0003, "total_loss": 7.500595622592503, "policy_loss": -7.212658723195393e-05, "vf_loss": 7.5007285541958275, "vf_explained_var": -1.3113021850585938e-06, "kl": 0.0001581754903049336, "entropy": 0.6071492698457506, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 734.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.624999999999853, "episode_len_mean": 249.44, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 39.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 38.90000000000002, 44.10000000000001, 38.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.900000000000006, 40.70000000000002, 42.500000000000014, -50.00000000000044, 29.69999999999998, 9.8999999999997, 34.50000000000004, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.30000000000002, 44.300000000000004, -50.00000000000044, 17.499999999999808, -50.00000000000044, 42.10000000000001, 39.10000000000002, -50.00000000000044, 45.9, 26.09999999999993, -50.00000000000044, 43.10000000000001, -50.00000000000044, 4.699999999999626, 26.69999999999994, 42.900000000000006, 11.099999999999717, 43.50000000000001, 43.7, 28.29999999999996, 37.10000000000003, 41.100000000000016, 44.300000000000004, 39.90000000000002, -50.00000000000044, 17.899999999999814, 39.90000000000002, 20.49999999999985, 34.50000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.70000000000001, -50.00000000000044, 37.90000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.50000000000001, 45.7, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.10000000000004, -50.00000000000044, 11.899999999999729, 41.100000000000016, 43.7, 44.7, 30.29999999999999, 31.900000000000013, 43.30000000000001, 40.70000000000002, -50.00000000000044, 38.50000000000003, 28.09999999999996, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.300000000000026, 44.5], "episode_lengths": [128, 102, 60, 500, 500, 120, 112, 60, 112, 128, 500, 500, 100, 52, 94, 76, 500, 204, 402, 156, 76, 80, 500, 500, 500, 500, 54, 98, 58, 500, 326, 500, 80, 110, 500, 42, 240, 500, 70, 500, 454, 234, 72, 390, 66, 64, 218, 130, 90, 58, 102, 500, 322, 102, 296, 156, 500, 76, 500, 500, 112, 500, 184, 500, 122, 66, 500, 500, 80, 66, 44, 80, 74, 500, 500, 110, 150, 500, 382, 90, 64, 54, 198, 182, 68, 94, 500, 116, 220, 500, 128, 180, 500, 308, 500, 500, 138, 500, 108, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792078394016154, "mean_inference_ms": 1.216718850313757, "mean_action_processing_ms": 0.14048736131205253, "mean_env_wait_ms": 0.08460224554526517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000219345092773, "StateBufferConnector_ms": 0.007005929946899414, "ViewRequirementAgentConnector_ms": 0.140791654586792}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.624999999999853, "episode_len_mean": 249.44, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 39.90000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 38.90000000000002, 44.10000000000001, 38.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.900000000000006, 40.70000000000002, 42.500000000000014, -50.00000000000044, 29.69999999999998, 9.8999999999997, 34.50000000000004, 42.500000000000014, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.30000000000002, 44.300000000000004, -50.00000000000044, 17.499999999999808, -50.00000000000044, 42.10000000000001, 39.10000000000002, -50.00000000000044, 45.9, 26.09999999999993, -50.00000000000044, 43.10000000000001, -50.00000000000044, 4.699999999999626, 26.69999999999994, 42.900000000000006, 11.099999999999717, 43.50000000000001, 43.7, 28.29999999999996, 37.10000000000003, 41.100000000000016, 44.300000000000004, 39.90000000000002, -50.00000000000044, 17.899999999999814, 39.90000000000002, 20.49999999999985, 34.50000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.70000000000001, -50.00000000000044, 37.90000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.50000000000001, 45.7, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.10000000000004, -50.00000000000044, 11.899999999999729, 41.100000000000016, 43.7, 44.7, 30.29999999999999, 31.900000000000013, 43.30000000000001, 40.70000000000002, -50.00000000000044, 38.50000000000003, 28.09999999999996, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.300000000000026, 44.5], "episode_lengths": [128, 102, 60, 500, 500, 120, 112, 60, 112, 128, 500, 500, 100, 52, 94, 76, 500, 204, 402, 156, 76, 80, 500, 500, 500, 500, 54, 98, 58, 500, 326, 500, 80, 110, 500, 42, 240, 500, 70, 500, 454, 234, 72, 390, 66, 64, 218, 130, 90, 58, 102, 500, 322, 102, 296, 156, 500, 76, 500, 500, 112, 500, 184, 500, 122, 66, 500, 500, 80, 66, 44, 80, 74, 500, 500, 110, 150, 500, 382, 90, 64, 54, 198, 182, 68, 94, 500, 116, 220, 500, 128, 180, 500, 308, 500, 500, 138, 500, 108, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792078394016154, "mean_inference_ms": 1.216718850313757, "mean_action_processing_ms": 0.14048736131205253, "mean_env_wait_ms": 0.08460224554526517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000219345092773, "StateBufferConnector_ms": 0.007005929946899414, "ViewRequirementAgentConnector_ms": 0.140791654586792}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5801.4743538391585, "num_env_steps_trained_throughput_per_sec": 5801.4743538391585, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2097.59, "sample_time_ms": 1903.384, "load_time_ms": 11.762, "load_throughput": 1020245.07, "learn_time_ms": 171.311, "learn_throughput": 70047.877, "synch_weights_time_ms": 9.519}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3744, "training_iteration": 82, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-37", "timestamp": 1698249877, "time_this_iter_s": 2.073439836502075, "time_total_s": 176.19710278511047, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.19710278511047, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0003, "total_loss": 6.686685138278538, "policy_loss": -0.00012754317786958482, "vf_loss": 6.686874230702718, "vf_explained_var": -8.477105034722222e-07, "kl": 0.00025779008556823, "entropy": 0.6161902017063565, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.193999999999871, "episode_len_mean": 238.8, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 37.10000000000003, 41.100000000000016, 44.300000000000004, 39.90000000000002, -50.00000000000044, 17.899999999999814, 39.90000000000002, 20.49999999999985, 34.50000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.70000000000001, -50.00000000000044, 37.90000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.50000000000001, 45.7, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.10000000000004, -50.00000000000044, 11.899999999999729, 41.100000000000016, 43.7, 44.7, 30.29999999999999, 31.900000000000013, 43.30000000000001, 40.70000000000002, -50.00000000000044, 38.50000000000003, 28.09999999999996, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.300000000000026, 44.5, 22.899999999999885, 11.899999999999729, 41.500000000000014, 33.10000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.89999999999997, 39.300000000000026, 39.70000000000002, 44.10000000000001, 40.70000000000002, 18.899999999999828, -50.00000000000044, 42.10000000000001, 42.70000000000001, 27.899999999999956, 43.30000000000001, 33.70000000000004, 7.299999999999663, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.10000000000002, 36.50000000000003, 41.500000000000014, 29.899999999999984, 44.5, 38.90000000000002, 40.10000000000002, 35.500000000000036, 39.90000000000002, 11.499999999999723, -50.00000000000044, 32.100000000000016, 20.299999999999848, -50.00000000000044, 27.299999999999947, 28.699999999999967, -50.00000000000044, 45.7, 42.500000000000014, 31.900000000000013, 44.7, -50.00000000000044], "episode_lengths": [218, 130, 90, 58, 102, 500, 322, 102, 296, 156, 500, 76, 500, 500, 112, 500, 184, 500, 122, 66, 500, 500, 80, 66, 44, 80, 74, 500, 500, 110, 150, 500, 382, 90, 64, 54, 198, 182, 68, 94, 500, 116, 220, 500, 128, 180, 500, 308, 500, 500, 138, 500, 108, 56, 272, 382, 86, 170, 500, 104, 500, 212, 108, 104, 60, 94, 312, 500, 80, 74, 222, 68, 164, 428, 78, 500, 500, 136, 100, 136, 86, 202, 56, 112, 100, 146, 102, 386, 500, 180, 298, 500, 228, 214, 500, 44, 76, 182, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37914028488396556, "mean_inference_ms": 1.2155394654418847, "mean_action_processing_ms": 0.1405933447797571, "mean_env_wait_ms": 0.08465817618743801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024985551834106445, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.13680529594421387}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.193999999999871, "episode_len_mean": 238.8, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 37.10000000000003, 41.100000000000016, 44.300000000000004, 39.90000000000002, -50.00000000000044, 17.899999999999814, 39.90000000000002, 20.49999999999985, 34.50000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 31.70000000000001, -50.00000000000044, 37.90000000000003, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.50000000000001, 45.7, 42.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 35.10000000000004, -50.00000000000044, 11.899999999999729, 41.100000000000016, 43.7, 44.7, 30.29999999999999, 31.900000000000013, 43.30000000000001, 40.70000000000002, -50.00000000000044, 38.50000000000003, 28.09999999999996, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.300000000000026, 44.5, 22.899999999999885, 11.899999999999729, 41.500000000000014, 33.10000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.89999999999997, 39.300000000000026, 39.70000000000002, 44.10000000000001, 40.70000000000002, 18.899999999999828, -50.00000000000044, 42.10000000000001, 42.70000000000001, 27.899999999999956, 43.30000000000001, 33.70000000000004, 7.299999999999663, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.10000000000002, 36.50000000000003, 41.500000000000014, 29.899999999999984, 44.5, 38.90000000000002, 40.10000000000002, 35.500000000000036, 39.90000000000002, 11.499999999999723, -50.00000000000044, 32.100000000000016, 20.299999999999848, -50.00000000000044, 27.299999999999947, 28.699999999999967, -50.00000000000044, 45.7, 42.500000000000014, 31.900000000000013, 44.7, -50.00000000000044], "episode_lengths": [218, 130, 90, 58, 102, 500, 322, 102, 296, 156, 500, 76, 500, 500, 112, 500, 184, 500, 122, 66, 500, 500, 80, 66, 44, 80, 74, 500, 500, 110, 150, 500, 382, 90, 64, 54, 198, 182, 68, 94, 500, 116, 220, 500, 128, 180, 500, 308, 500, 500, 138, 500, 108, 56, 272, 382, 86, 170, 500, 104, 500, 212, 108, 104, 60, 94, 312, 500, 80, 74, 222, 68, 164, 428, 78, 500, 500, 136, 100, 136, 86, 202, 56, 112, 100, 146, 102, 386, 500, 180, 298, 500, 228, 214, 500, 44, 76, 182, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37914028488396556, "mean_inference_ms": 1.2155394654418847, "mean_action_processing_ms": 0.1405933447797571, "mean_env_wait_ms": 0.08465817618743801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024985551834106445, "StateBufferConnector_ms": 0.009004831314086914, "ViewRequirementAgentConnector_ms": 0.13680529594421387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5352.574889195331, "num_env_steps_trained_throughput_per_sec": 5352.574889195331, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2119.593, "sample_time_ms": 1906.941, "load_time_ms": 12.062, "load_throughput": 994869.622, "learn_time_ms": 189.192, "learn_throughput": 63427.498, "synch_weights_time_ms": 9.783}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3790, "training_iteration": 83, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-39", "timestamp": 1698249879, "time_this_iter_s": 2.2469074726104736, "time_total_s": 178.44401025772095, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.44401025772095, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 60.96666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0003, "total_loss": 7.186927689446343, "policy_loss": 0.00011929869651794434, "vf_loss": 7.186873277028401, "vf_explained_var": -1.1258655124240452e-06, "kl": 0.0001777287176183664, "entropy": 0.6505318482716879, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 752.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.54699999999989, "episode_len_mean": 220.3, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, 28.89999999999997, 39.300000000000026, 39.70000000000002, 44.10000000000001, 40.70000000000002, 18.899999999999828, -50.00000000000044, 42.10000000000001, 42.70000000000001, 27.899999999999956, 43.30000000000001, 33.70000000000004, 7.299999999999663, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.10000000000002, 36.50000000000003, 41.500000000000014, 29.899999999999984, 44.5, 38.90000000000002, 40.10000000000002, 35.500000000000036, 39.90000000000002, 11.499999999999723, -50.00000000000044, 32.100000000000016, 20.299999999999848, -50.00000000000044, 27.299999999999947, 28.699999999999967, -50.00000000000044, 45.7, 42.500000000000014, 31.900000000000013, 44.7, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.50000000000001, 41.90000000000001, 42.70000000000001, 34.30000000000004, 39.50000000000002, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 32.100000000000016, 44.300000000000004, 23.099999999999888, -50.00000000000044, 41.70000000000002, -50.00000000000044, 19.499999999999837, 25.099999999999916, 44.300000000000004, 40.30000000000002, 44.900000000000006, -50.00000000000044, 27.49999999999995, 39.10000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 39.10000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.10000000000001, 35.10000000000004, 29.299999999999976, 40.70000000000002, 44.5, 41.70000000000002, 39.300000000000026, 36.30000000000003, -50.00000000000044, 42.10000000000001, 34.10000000000004, 41.500000000000014, 22.899999999999885, 42.70000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, 2.8999999999996007, 40.70000000000002, 41.90000000000001], "episode_lengths": [500, 104, 500, 212, 108, 104, 60, 94, 312, 500, 80, 74, 222, 68, 164, 428, 78, 500, 500, 136, 100, 136, 86, 202, 56, 112, 100, 146, 102, 386, 500, 180, 298, 500, 228, 214, 500, 44, 76, 182, 54, 500, 500, 114, 66, 82, 74, 158, 106, 172, 500, 50, 500, 180, 58, 270, 500, 84, 500, 306, 250, 58, 98, 52, 500, 226, 110, 88, 500, 500, 28, 56, 110, 134, 500, 500, 118, 500, 80, 150, 208, 94, 56, 84, 108, 138, 500, 80, 160, 86, 272, 74, 114, 500, 500, 110, 74, 472, 94, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37913912549668216, "mean_inference_ms": 1.2161839111673232, "mean_action_processing_ms": 0.14041286863904592, "mean_env_wait_ms": 0.08452008595179639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030983686447143555, "StateBufferConnector_ms": 0.009996175765991211, "ViewRequirementAgentConnector_ms": 0.1450049877166748}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.54699999999989, "episode_len_mean": 220.3, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, -50.00000000000044, 28.89999999999997, 39.300000000000026, 39.70000000000002, 44.10000000000001, 40.70000000000002, 18.899999999999828, -50.00000000000044, 42.10000000000001, 42.70000000000001, 27.899999999999956, 43.30000000000001, 33.70000000000004, 7.299999999999663, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.10000000000002, 36.50000000000003, 41.500000000000014, 29.899999999999984, 44.5, 38.90000000000002, 40.10000000000002, 35.500000000000036, 39.90000000000002, 11.499999999999723, -50.00000000000044, 32.100000000000016, 20.299999999999848, -50.00000000000044, 27.299999999999947, 28.699999999999967, -50.00000000000044, 45.7, 42.500000000000014, 31.900000000000013, 44.7, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.50000000000001, 41.90000000000001, 42.70000000000001, 34.30000000000004, 39.50000000000002, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 32.100000000000016, 44.300000000000004, 23.099999999999888, -50.00000000000044, 41.70000000000002, -50.00000000000044, 19.499999999999837, 25.099999999999916, 44.300000000000004, 40.30000000000002, 44.900000000000006, -50.00000000000044, 27.49999999999995, 39.10000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 39.10000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.10000000000001, 35.10000000000004, 29.299999999999976, 40.70000000000002, 44.5, 41.70000000000002, 39.300000000000026, 36.30000000000003, -50.00000000000044, 42.10000000000001, 34.10000000000004, 41.500000000000014, 22.899999999999885, 42.70000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, 2.8999999999996007, 40.70000000000002, 41.90000000000001], "episode_lengths": [500, 104, 500, 212, 108, 104, 60, 94, 312, 500, 80, 74, 222, 68, 164, 428, 78, 500, 500, 136, 100, 136, 86, 202, 56, 112, 100, 146, 102, 386, 500, 180, 298, 500, 228, 214, 500, 44, 76, 182, 54, 500, 500, 114, 66, 82, 74, 158, 106, 172, 500, 50, 500, 180, 58, 270, 500, 84, 500, 306, 250, 58, 98, 52, 500, 226, 110, 88, 500, 500, 28, 56, 110, 134, 500, 500, 118, 500, 80, 150, 208, 94, 56, 84, 108, 138, 500, 80, 160, 86, 272, 74, 114, 500, 500, 110, 74, 472, 94, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37913912549668216, "mean_inference_ms": 1.2161839111673232, "mean_action_processing_ms": 0.14041286863904592, "mean_env_wait_ms": 0.08452008595179639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030983686447143555, "StateBufferConnector_ms": 0.009996175765991211, "ViewRequirementAgentConnector_ms": 0.1450049877166748}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5177.673672190846, "num_env_steps_trained_throughput_per_sec": 5177.673672190846, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2139.928, "sample_time_ms": 1941.461, "load_time_ms": 11.298, "load_throughput": 1062097.833, "learn_time_ms": 175.755, "learn_throughput": 68276.974, "synch_weights_time_ms": 9.712}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3848, "training_iteration": 84, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-42", "timestamp": 1698249882, "time_this_iter_s": 2.3227415084838867, "time_total_s": 180.76675176620483, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.76675176620483, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 54.3, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0003, "total_loss": 7.485138045416938, "policy_loss": -0.0002633169642649591, "vf_loss": 7.485465844472249, "vf_explained_var": -1.629193623860677e-06, "kl": 0.00016941601073641423, "entropy": 0.6449645823902554, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 761.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.69799999999987, "episode_len_mean": 233.76, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 32.100000000000016, 44.300000000000004, 23.099999999999888, -50.00000000000044, 41.70000000000002, -50.00000000000044, 19.499999999999837, 25.099999999999916, 44.300000000000004, 40.30000000000002, 44.900000000000006, -50.00000000000044, 27.49999999999995, 39.10000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 39.10000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.10000000000001, 35.10000000000004, 29.299999999999976, 40.70000000000002, 44.5, 41.70000000000002, 39.300000000000026, 36.30000000000003, -50.00000000000044, 42.10000000000001, 34.10000000000004, 41.500000000000014, 22.899999999999885, 42.70000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, 2.8999999999996007, 40.70000000000002, 41.90000000000001, -50.00000000000044, 40.10000000000002, 32.30000000000002, 26.299999999999933, 42.70000000000001, 42.900000000000006, 39.70000000000002, 36.30000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.70000000000003, 23.699999999999896, 24.69999999999991, 45.1, -50.00000000000044, 40.90000000000002, 28.499999999999964, 31.500000000000007, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, 25.099999999999916, -50.00000000000044, 42.70000000000001, 35.70000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.10000000000001, 38.90000000000002, -50.00000000000044, 44.300000000000004, 43.50000000000001, 44.10000000000001, 20.699999999999854, 24.899999999999913, 31.1, 2.299999999999592, 29.899999999999984, 44.300000000000004], "episode_lengths": [50, 500, 180, 58, 270, 500, 84, 500, 306, 250, 58, 98, 52, 500, 226, 110, 88, 500, 500, 28, 56, 110, 134, 500, 500, 118, 500, 80, 150, 208, 94, 56, 84, 108, 138, 500, 80, 160, 86, 272, 74, 114, 500, 500, 110, 74, 472, 94, 82, 500, 100, 178, 238, 74, 72, 104, 138, 92, 500, 500, 90, 124, 264, 254, 50, 500, 92, 216, 186, 136, 500, 500, 500, 142, 88, 36, 500, 500, 106, 250, 500, 74, 144, 202, 500, 500, 284, 500, 60, 112, 500, 58, 66, 60, 294, 252, 190, 478, 202, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793381284029559, "mean_inference_ms": 1.2164431069878494, "mean_action_processing_ms": 0.14062891612715692, "mean_env_wait_ms": 0.08467543091830391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.008993148803710938, "ViewRequirementAgentConnector_ms": 0.12704014778137207}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.69799999999987, "episode_len_mean": 233.76, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 32.100000000000016, 44.300000000000004, 23.099999999999888, -50.00000000000044, 41.70000000000002, -50.00000000000044, 19.499999999999837, 25.099999999999916, 44.300000000000004, 40.30000000000002, 44.900000000000006, -50.00000000000044, 27.49999999999995, 39.10000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.5, 39.10000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.10000000000001, 35.10000000000004, 29.299999999999976, 40.70000000000002, 44.5, 41.70000000000002, 39.300000000000026, 36.30000000000003, -50.00000000000044, 42.10000000000001, 34.10000000000004, 41.500000000000014, 22.899999999999885, 42.70000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, 2.8999999999996007, 40.70000000000002, 41.90000000000001, -50.00000000000044, 40.10000000000002, 32.30000000000002, 26.299999999999933, 42.70000000000001, 42.900000000000006, 39.70000000000002, 36.30000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.70000000000003, 23.699999999999896, 24.69999999999991, 45.1, -50.00000000000044, 40.90000000000002, 28.499999999999964, 31.500000000000007, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, 25.099999999999916, -50.00000000000044, 42.70000000000001, 35.70000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.10000000000001, 38.90000000000002, -50.00000000000044, 44.300000000000004, 43.50000000000001, 44.10000000000001, 20.699999999999854, 24.899999999999913, 31.1, 2.299999999999592, 29.899999999999984, 44.300000000000004], "episode_lengths": [50, 500, 180, 58, 270, 500, 84, 500, 306, 250, 58, 98, 52, 500, 226, 110, 88, 500, 500, 28, 56, 110, 134, 500, 500, 118, 500, 80, 150, 208, 94, 56, 84, 108, 138, 500, 80, 160, 86, 272, 74, 114, 500, 500, 110, 74, 472, 94, 82, 500, 100, 178, 238, 74, 72, 104, 138, 92, 500, 500, 90, 124, 264, 254, 50, 500, 92, 216, 186, 136, 500, 500, 500, 142, 88, 36, 500, 500, 106, 250, 500, 74, 144, 202, 500, 500, 284, 500, 60, 112, 500, 58, 66, 60, 294, 252, 190, 478, 202, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793381284029559, "mean_inference_ms": 1.2164431069878494, "mean_action_processing_ms": 0.14062891612715692, "mean_env_wait_ms": 0.08467543091830391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.008993148803710938, "ViewRequirementAgentConnector_ms": 0.12704014778137207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5725.478169272036, "num_env_steps_trained_throughput_per_sec": 5725.478169272036, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2147.397, "sample_time_ms": 1944.316, "load_time_ms": 11.084, "load_throughput": 1082659.474, "learn_time_ms": 180.727, "learn_throughput": 66398.454, "synch_weights_time_ms": 9.468}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3899, "training_iteration": 85, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-44", "timestamp": 1698249884, "time_this_iter_s": 2.1016364097595215, "time_total_s": 182.86838817596436, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.86838817596436, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0003, "total_loss": 7.434199810028076, "policy_loss": -0.00036306016974978976, "vf_loss": 7.434622923533122, "vf_explained_var": -3.973642985026042e-07, "kl": 0.0004931957582180581, "entropy": 0.6000102162361145, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.98299999999986, "episode_len_mean": 245.92, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.8999999999996007, 40.70000000000002, 41.90000000000001, -50.00000000000044, 40.10000000000002, 32.30000000000002, 26.299999999999933, 42.70000000000001, 42.900000000000006, 39.70000000000002, 36.30000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.70000000000003, 23.699999999999896, 24.69999999999991, 45.1, -50.00000000000044, 40.90000000000002, 28.499999999999964, 31.500000000000007, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, 25.099999999999916, -50.00000000000044, 42.70000000000001, 35.70000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.10000000000001, 38.90000000000002, -50.00000000000044, 44.300000000000004, 43.50000000000001, 44.10000000000001, 20.699999999999854, 24.899999999999913, 31.1, 2.299999999999592, 29.899999999999984, 44.300000000000004, -50.00000000000044, 4.899999999999629, -50.00000000000044, 37.70000000000003, 44.300000000000004, 41.90000000000001, 23.29999999999989, -50.00000000000044, 22.299999999999876, -50.00000000000044, 37.50000000000003, 39.10000000000002, 38.10000000000002, 32.90000000000003, 45.3, 40.90000000000002, 36.50000000000003, 33.90000000000004, 44.300000000000004, -50.00000000000044, 17.69999999999981, 35.70000000000003, 45.7, 18.099999999999817, 34.10000000000004, 43.7, 24.499999999999908, 45.5, 43.30000000000001, 1.299999999999578, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 41.30000000000001, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, 41.100000000000016, 28.29999999999996, -50.00000000000044, 15.699999999999783, 30.499999999999993], "episode_lengths": [472, 94, 82, 500, 100, 178, 238, 74, 72, 104, 138, 92, 500, 500, 90, 124, 264, 254, 50, 500, 92, 216, 186, 136, 500, 500, 500, 142, 88, 36, 500, 500, 106, 250, 500, 74, 144, 202, 500, 500, 284, 500, 60, 112, 500, 58, 66, 60, 294, 252, 190, 478, 202, 58, 500, 452, 500, 124, 58, 82, 268, 500, 278, 500, 126, 110, 120, 172, 48, 92, 136, 162, 58, 500, 324, 144, 44, 320, 160, 64, 256, 46, 68, 488, 52, 500, 500, 500, 206, 88, 38, 500, 70, 500, 378, 90, 218, 500, 344, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37948148681724575, "mean_inference_ms": 1.2155061167384837, "mean_action_processing_ms": 0.140681760559058, "mean_env_wait_ms": 0.08465189798353076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024001359939575195, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.10508203506469727}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.98299999999986, "episode_len_mean": 245.92, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.8999999999996007, 40.70000000000002, 41.90000000000001, -50.00000000000044, 40.10000000000002, 32.30000000000002, 26.299999999999933, 42.70000000000001, 42.900000000000006, 39.70000000000002, 36.30000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 37.70000000000003, 23.699999999999896, 24.69999999999991, 45.1, -50.00000000000044, 40.90000000000002, 28.499999999999964, 31.500000000000007, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 41.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 39.50000000000002, 25.099999999999916, -50.00000000000044, 42.70000000000001, 35.70000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.10000000000001, 38.90000000000002, -50.00000000000044, 44.300000000000004, 43.50000000000001, 44.10000000000001, 20.699999999999854, 24.899999999999913, 31.1, 2.299999999999592, 29.899999999999984, 44.300000000000004, -50.00000000000044, 4.899999999999629, -50.00000000000044, 37.70000000000003, 44.300000000000004, 41.90000000000001, 23.29999999999989, -50.00000000000044, 22.299999999999876, -50.00000000000044, 37.50000000000003, 39.10000000000002, 38.10000000000002, 32.90000000000003, 45.3, 40.90000000000002, 36.50000000000003, 33.90000000000004, 44.300000000000004, -50.00000000000044, 17.69999999999981, 35.70000000000003, 45.7, 18.099999999999817, 34.10000000000004, 43.7, 24.499999999999908, 45.5, 43.30000000000001, 1.299999999999578, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 41.30000000000001, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, 41.100000000000016, 28.29999999999996, -50.00000000000044, 15.699999999999783, 30.499999999999993], "episode_lengths": [472, 94, 82, 500, 100, 178, 238, 74, 72, 104, 138, 92, 500, 500, 90, 124, 264, 254, 50, 500, 92, 216, 186, 136, 500, 500, 500, 142, 88, 36, 500, 500, 106, 250, 500, 74, 144, 202, 500, 500, 284, 500, 60, 112, 500, 58, 66, 60, 294, 252, 190, 478, 202, 58, 500, 452, 500, 124, 58, 82, 268, 500, 278, 500, 126, 110, 120, 172, 48, 92, 136, 162, 58, 500, 324, 144, 44, 320, 160, 64, 256, 46, 68, 488, 52, 500, 500, 500, 206, 88, 38, 500, 70, 500, 378, 90, 218, 500, 344, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37948148681724575, "mean_inference_ms": 1.2155061167384837, "mean_action_processing_ms": 0.140681760559058, "mean_env_wait_ms": 0.08465189798353076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024001359939575195, "StateBufferConnector_ms": 0.006994009017944336, "ViewRequirementAgentConnector_ms": 0.10508203506469727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5233.360190728054, "num_env_steps_trained_throughput_per_sec": 5233.360190728054, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2165.881, "sample_time_ms": 1949.298, "load_time_ms": 11.252, "load_throughput": 1066475.006, "learn_time_ms": 193.944, "learn_throughput": 61873.629, "synch_weights_time_ms": 9.486}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3945, "training_iteration": 86, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-46", "timestamp": 1698249886, "time_this_iter_s": 2.298326253890991, "time_total_s": 185.16671442985535, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.16671442985535, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0003, "total_loss": 7.34676996866862, "policy_loss": -4.0902652674251134e-05, "vf_loss": 7.3468666606479225, "vf_explained_var": -1.2450748019748264e-06, "kl": 0.00021941930190728777, "entropy": 0.5576086839040121, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 779.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.585999999999878, "episode_len_mean": 224.92, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 44.300000000000004, 41.90000000000001, 23.29999999999989, -50.00000000000044, 22.299999999999876, -50.00000000000044, 37.50000000000003, 39.10000000000002, 38.10000000000002, 32.90000000000003, 45.3, 40.90000000000002, 36.50000000000003, 33.90000000000004, 44.300000000000004, -50.00000000000044, 17.69999999999981, 35.70000000000003, 45.7, 18.099999999999817, 34.10000000000004, 43.7, 24.499999999999908, 45.5, 43.30000000000001, 1.299999999999578, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 41.30000000000001, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, 41.100000000000016, 28.29999999999996, -50.00000000000044, 15.699999999999783, 30.499999999999993, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, 1.6999999999995836, 38.700000000000024, -50.00000000000044, 1.8999999999995865, 43.50000000000001, 36.30000000000003, 43.7, 42.500000000000014, 32.700000000000024, 32.50000000000002, 37.300000000000026, 38.10000000000002, 42.900000000000006, 43.10000000000001, 13.099999999999746, -50.00000000000044, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 38.300000000000026, 41.30000000000001, 39.70000000000002, 35.900000000000034, 43.7, -50.00000000000044, 40.10000000000002, 14.499999999999766, 44.5, 35.900000000000034, 21.09999999999986, 45.5, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.90000000000001, 40.10000000000002, -50.00000000000044, 37.70000000000003, 37.300000000000026, 42.30000000000001, 46.099999999999994, 43.7, 46.3, 38.50000000000003, -50.00000000000044, 9.499999999999694, 40.90000000000002], "episode_lengths": [500, 124, 58, 82, 268, 500, 278, 500, 126, 110, 120, 172, 48, 92, 136, 162, 58, 500, 324, 144, 44, 320, 160, 64, 256, 46, 68, 488, 52, 500, 500, 500, 206, 88, 38, 500, 70, 500, 378, 90, 218, 500, 344, 196, 500, 60, 500, 50, 484, 114, 500, 482, 66, 138, 64, 76, 174, 176, 128, 120, 72, 70, 370, 500, 36, 50, 500, 48, 500, 66, 118, 88, 104, 142, 64, 500, 100, 356, 56, 142, 290, 46, 500, 306, 500, 500, 140, 82, 100, 500, 124, 128, 78, 40, 64, 38, 116, 500, 406, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793879144946492, "mean_inference_ms": 1.2156712692641498, "mean_action_processing_ms": 0.1406542253293158, "mean_env_wait_ms": 0.0846776855223316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006107330322266, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.11565613746643066}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.585999999999878, "episode_len_mean": 224.92, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 44.300000000000004, 41.90000000000001, 23.29999999999989, -50.00000000000044, 22.299999999999876, -50.00000000000044, 37.50000000000003, 39.10000000000002, 38.10000000000002, 32.90000000000003, 45.3, 40.90000000000002, 36.50000000000003, 33.90000000000004, 44.300000000000004, -50.00000000000044, 17.69999999999981, 35.70000000000003, 45.7, 18.099999999999817, 34.10000000000004, 43.7, 24.499999999999908, 45.5, 43.30000000000001, 1.299999999999578, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 41.30000000000001, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 12.299999999999734, 41.100000000000016, 28.29999999999996, -50.00000000000044, 15.699999999999783, 30.499999999999993, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, 1.6999999999995836, 38.700000000000024, -50.00000000000044, 1.8999999999995865, 43.50000000000001, 36.30000000000003, 43.7, 42.500000000000014, 32.700000000000024, 32.50000000000002, 37.300000000000026, 38.10000000000002, 42.900000000000006, 43.10000000000001, 13.099999999999746, -50.00000000000044, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 38.300000000000026, 41.30000000000001, 39.70000000000002, 35.900000000000034, 43.7, -50.00000000000044, 40.10000000000002, 14.499999999999766, 44.5, 35.900000000000034, 21.09999999999986, 45.5, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.90000000000001, 40.10000000000002, -50.00000000000044, 37.70000000000003, 37.300000000000026, 42.30000000000001, 46.099999999999994, 43.7, 46.3, 38.50000000000003, -50.00000000000044, 9.499999999999694, 40.90000000000002], "episode_lengths": [500, 124, 58, 82, 268, 500, 278, 500, 126, 110, 120, 172, 48, 92, 136, 162, 58, 500, 324, 144, 44, 320, 160, 64, 256, 46, 68, 488, 52, 500, 500, 500, 206, 88, 38, 500, 70, 500, 378, 90, 218, 500, 344, 196, 500, 60, 500, 50, 484, 114, 500, 482, 66, 138, 64, 76, 174, 176, 128, 120, 72, 70, 370, 500, 36, 50, 500, 48, 500, 66, 118, 88, 104, 142, 64, 500, 100, 356, 56, 142, 290, 46, 500, 306, 500, 500, 140, 82, 100, 500, 124, 128, 78, 40, 64, 38, 116, 500, 406, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793879144946492, "mean_inference_ms": 1.2156712692641498, "mean_action_processing_ms": 0.1406542253293158, "mean_env_wait_ms": 0.0846776855223316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006107330322266, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.11565613746643066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5204.471003990549, "num_env_steps_trained_throughput_per_sec": 5204.471003990549, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2188.998, "sample_time_ms": 1971.084, "load_time_ms": 11.252, "load_throughput": 1066486.304, "learn_time_ms": 195.363, "learn_throughput": 61424.089, "synch_weights_time_ms": 9.305}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4001, "training_iteration": 87, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-48", "timestamp": 1698249888, "time_this_iter_s": 2.3107008934020996, "time_total_s": 187.47741532325745, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.47741532325745, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 59.93333333333334, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0003, "total_loss": 7.070654021369086, "policy_loss": -0.0002596602490585711, "vf_loss": 7.07096725040012, "vf_explained_var": -4.1060977511935766e-07, "kl": 0.00017497410891564869, "entropy": 0.5379356212086148, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.033999999999853, "episode_len_mean": 240.36, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 1.6999999999995836, 38.700000000000024, -50.00000000000044, 1.8999999999995865, 43.50000000000001, 36.30000000000003, 43.7, 42.500000000000014, 32.700000000000024, 32.50000000000002, 37.300000000000026, 38.10000000000002, 42.900000000000006, 43.10000000000001, 13.099999999999746, -50.00000000000044, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 38.300000000000026, 41.30000000000001, 39.70000000000002, 35.900000000000034, 43.7, -50.00000000000044, 40.10000000000002, 14.499999999999766, 44.5, 35.900000000000034, 21.09999999999986, 45.5, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.90000000000001, 40.10000000000002, -50.00000000000044, 37.70000000000003, 37.300000000000026, 42.30000000000001, 46.099999999999994, 43.7, 46.3, 38.50000000000003, -50.00000000000044, 9.499999999999694, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, 23.29999999999989, 21.89999999999987, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, 21.499999999999865, -50.00000000000044, 38.50000000000003, 37.10000000000003, -50.00000000000044, 34.900000000000034, 45.5, 45.9, 29.299999999999976, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 37.70000000000003, 39.300000000000026, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, 39.70000000000002, -50.00000000000044], "episode_lengths": [500, 50, 484, 114, 500, 482, 66, 138, 64, 76, 174, 176, 128, 120, 72, 70, 370, 500, 36, 50, 500, 48, 500, 66, 118, 88, 104, 142, 64, 500, 100, 356, 56, 142, 290, 46, 500, 306, 500, 500, 140, 82, 100, 500, 124, 128, 78, 40, 64, 38, 116, 500, 406, 92, 500, 500, 44, 500, 500, 42, 500, 166, 268, 282, 500, 72, 500, 70, 56, 500, 500, 500, 52, 50, 286, 500, 116, 130, 500, 152, 46, 42, 208, 40, 500, 500, 500, 500, 80, 176, 124, 108, 66, 48, 500, 500, 136, 68, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37926111984579747, "mean_inference_ms": 1.2161115191280871, "mean_action_processing_ms": 0.14041981662597125, "mean_env_wait_ms": 0.08464065098049568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019005537033081055, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.11362099647521973}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.033999999999853, "episode_len_mean": 240.36, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 1.6999999999995836, 38.700000000000024, -50.00000000000044, 1.8999999999995865, 43.50000000000001, 36.30000000000003, 43.7, 42.500000000000014, 32.700000000000024, 32.50000000000002, 37.300000000000026, 38.10000000000002, 42.900000000000006, 43.10000000000001, 13.099999999999746, -50.00000000000044, 46.5, 45.1, -50.00000000000044, 45.3, -50.00000000000044, 43.50000000000001, 38.300000000000026, 41.30000000000001, 39.70000000000002, 35.900000000000034, 43.7, -50.00000000000044, 40.10000000000002, 14.499999999999766, 44.5, 35.900000000000034, 21.09999999999986, 45.5, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.90000000000001, 40.10000000000002, -50.00000000000044, 37.70000000000003, 37.300000000000026, 42.30000000000001, 46.099999999999994, 43.7, 46.3, 38.50000000000003, -50.00000000000044, 9.499999999999694, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, 23.29999999999989, 21.89999999999987, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, 21.499999999999865, -50.00000000000044, 38.50000000000003, 37.10000000000003, -50.00000000000044, 34.900000000000034, 45.5, 45.9, 29.299999999999976, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 37.70000000000003, 39.300000000000026, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, 39.70000000000002, -50.00000000000044], "episode_lengths": [500, 50, 484, 114, 500, 482, 66, 138, 64, 76, 174, 176, 128, 120, 72, 70, 370, 500, 36, 50, 500, 48, 500, 66, 118, 88, 104, 142, 64, 500, 100, 356, 56, 142, 290, 46, 500, 306, 500, 500, 140, 82, 100, 500, 124, 128, 78, 40, 64, 38, 116, 500, 406, 92, 500, 500, 44, 500, 500, 42, 500, 166, 268, 282, 500, 72, 500, 70, 56, 500, 500, 500, 52, 50, 286, 500, 116, 130, 500, 152, 46, 42, 208, 40, 500, 500, 500, 500, 80, 176, 124, 108, 66, 48, 500, 500, 136, 68, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37926111984579747, "mean_inference_ms": 1.2161115191280871, "mean_action_processing_ms": 0.14041981662597125, "mean_env_wait_ms": 0.08464065098049568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019005537033081055, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.11362099647521973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5356.519110908668, "num_env_steps_trained_throughput_per_sec": 5356.519110908668, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2188.602, "sample_time_ms": 1968.745, "load_time_ms": 11.451, "load_throughput": 1047929.777, "learn_time_ms": 197.052, "learn_throughput": 60897.77, "synch_weights_time_ms": 9.361}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 4047, "training_iteration": 88, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-51", "timestamp": 1698249891, "time_this_iter_s": 2.245256185531616, "time_total_s": 189.72267150878906, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.72267150878906, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 55.133333333333326, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0003, "total_loss": 7.17496124903361, "policy_loss": -0.0003198846760723326, "vf_loss": 7.175338427225749, "vf_explained_var": -1.6027026706271702e-06, "kl": 0.0003810458778667049, "entropy": 0.5750485062599182, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.286999999999828, "episode_len_mean": 262.78, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 37.300000000000026, 42.30000000000001, 46.099999999999994, 43.7, 46.3, 38.50000000000003, -50.00000000000044, 9.499999999999694, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, 23.29999999999989, 21.89999999999987, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, 21.499999999999865, -50.00000000000044, 38.50000000000003, 37.10000000000003, -50.00000000000044, 34.900000000000034, 45.5, 45.9, 29.299999999999976, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 37.70000000000003, 39.300000000000026, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, 21.89999999999987, 14.09999999999976, 42.70000000000001, 40.10000000000002, -50.00000000000044, 44.7, 47.1, 45.3, 40.90000000000002, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.30000000000002, 0.49999999999956657, 14.699999999999768, 30.699999999999996, 13.899999999999757, -50.00000000000044, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 1.4999999999995808, 44.10000000000001, 36.70000000000003, 38.10000000000002, 41.30000000000001, -50.00000000000044, 44.7], "episode_lengths": [500, 124, 128, 78, 40, 64, 38, 116, 500, 406, 92, 500, 500, 44, 500, 500, 42, 500, 166, 268, 282, 500, 72, 500, 70, 56, 500, 500, 500, 52, 50, 286, 500, 116, 130, 500, 152, 46, 42, 208, 40, 500, 500, 500, 500, 80, 176, 124, 108, 66, 48, 500, 500, 136, 68, 104, 500, 500, 134, 86, 500, 500, 282, 360, 74, 100, 500, 54, 30, 48, 92, 52, 92, 500, 500, 80, 500, 246, 500, 500, 236, 98, 496, 354, 194, 362, 500, 48, 500, 56, 500, 144, 500, 486, 60, 134, 120, 88, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37925842322969777, "mean_inference_ms": 1.2167506385410396, "mean_action_processing_ms": 0.1403092875275294, "mean_env_wait_ms": 0.08445881206014309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200042724609375, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12000846862792969}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.286999999999828, "episode_len_mean": 262.78, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 37.300000000000026, 42.30000000000001, 46.099999999999994, 43.7, 46.3, 38.50000000000003, -50.00000000000044, 9.499999999999694, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, 23.29999999999989, 21.89999999999987, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.1, 21.499999999999865, -50.00000000000044, 38.50000000000003, 37.10000000000003, -50.00000000000044, 34.900000000000034, 45.5, 45.9, 29.299999999999976, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 32.50000000000002, 37.70000000000003, 39.300000000000026, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, 21.89999999999987, 14.09999999999976, 42.70000000000001, 40.10000000000002, -50.00000000000044, 44.7, 47.1, 45.3, 40.90000000000002, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.30000000000002, 0.49999999999956657, 14.699999999999768, 30.699999999999996, 13.899999999999757, -50.00000000000044, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 1.4999999999995808, 44.10000000000001, 36.70000000000003, 38.10000000000002, 41.30000000000001, -50.00000000000044, 44.7], "episode_lengths": [500, 124, 128, 78, 40, 64, 38, 116, 500, 406, 92, 500, 500, 44, 500, 500, 42, 500, 166, 268, 282, 500, 72, 500, 70, 56, 500, 500, 500, 52, 50, 286, 500, 116, 130, 500, 152, 46, 42, 208, 40, 500, 500, 500, 500, 80, 176, 124, 108, 66, 48, 500, 500, 136, 68, 104, 500, 500, 134, 86, 500, 500, 282, 360, 74, 100, 500, 54, 30, 48, 92, 52, 92, 500, 500, 80, 500, 246, 500, 500, 236, 98, 496, 354, 194, 362, 500, 48, 500, 56, 500, 144, 500, 486, 60, 134, 120, 88, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37925842322969777, "mean_inference_ms": 1.2167506385410396, "mean_action_processing_ms": 0.1403092875275294, "mean_env_wait_ms": 0.08445881206014309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200042724609375, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12000846862792969}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6113.140282805768, "num_env_steps_trained_throughput_per_sec": 6113.140282805768, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2183.556, "sample_time_ms": 1963.195, "load_time_ms": 11.751, "load_throughput": 1021180.7, "learn_time_ms": 197.039, "learn_throughput": 60901.779, "synch_weights_time_ms": 9.577}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4090, "training_iteration": 89, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-53", "timestamp": 1698249893, "time_this_iter_s": 1.9679787158966064, "time_total_s": 191.69065022468567, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.69065022468567, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 55.76666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0003, "total_loss": 6.854785018497044, "policy_loss": 3.7163496017456055e-05, "vf_loss": 6.854805681440565, "vf_explained_var": -1.006656222873264e-06, "kl": 0.00022900652687162114, "entropy": 0.5784273147583008, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.264999999999851, "episode_len_mean": 243.06, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 43.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, 21.89999999999987, 14.09999999999976, 42.70000000000001, 40.10000000000002, -50.00000000000044, 44.7, 47.1, 45.3, 40.90000000000002, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.30000000000002, 0.49999999999956657, 14.699999999999768, 30.699999999999996, 13.899999999999757, -50.00000000000044, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 1.4999999999995808, 44.10000000000001, 36.70000000000003, 38.10000000000002, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 29.099999999999973, 43.30000000000001, 36.10000000000004, 43.30000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, 32.90000000000003, 39.300000000000026, 31.70000000000001, 43.10000000000001, 44.900000000000006, 37.90000000000003, 38.90000000000002, 41.100000000000016, 41.500000000000014, 39.90000000000002, -50.00000000000044, 38.50000000000003, 45.3, 37.300000000000026, 27.699999999999953, 36.10000000000004, 42.30000000000001, 44.300000000000004, 43.7, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.1, 15.49999999999978, 38.50000000000003, 41.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.900000000000034, 16.8999999999998, 44.5, -50.00000000000044, 27.49999999999995, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 136, 68, 104, 500, 500, 134, 86, 500, 500, 282, 360, 74, 100, 500, 54, 30, 48, 92, 52, 92, 500, 500, 80, 500, 246, 500, 500, 236, 98, 496, 354, 194, 362, 500, 48, 500, 56, 500, 144, 500, 486, 60, 134, 120, 88, 500, 54, 500, 210, 68, 140, 68, 118, 500, 500, 358, 172, 108, 184, 70, 52, 122, 112, 90, 86, 102, 500, 116, 48, 128, 224, 140, 78, 58, 64, 72, 500, 52, 500, 500, 82, 500, 68, 50, 346, 116, 86, 500, 108, 500, 132, 332, 56, 500, 226, 68, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788718490323985, "mean_inference_ms": 1.2162072700953497, "mean_action_processing_ms": 0.1401171226652923, "mean_env_wait_ms": 0.0843680762391905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022595882415771484, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.10601592063903809}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.264999999999851, "episode_len_mean": 243.06, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 43.30000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 36.70000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, 21.89999999999987, 14.09999999999976, 42.70000000000001, 40.10000000000002, -50.00000000000044, 44.7, 47.1, 45.3, 40.90000000000002, 44.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 26.499999999999936, 40.30000000000002, 0.49999999999956657, 14.699999999999768, 30.699999999999996, 13.899999999999757, -50.00000000000044, 45.3, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 1.4999999999995808, 44.10000000000001, 36.70000000000003, 38.10000000000002, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 29.099999999999973, 43.30000000000001, 36.10000000000004, 43.30000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, 32.90000000000003, 39.300000000000026, 31.70000000000001, 43.10000000000001, 44.900000000000006, 37.90000000000003, 38.90000000000002, 41.100000000000016, 41.500000000000014, 39.90000000000002, -50.00000000000044, 38.50000000000003, 45.3, 37.300000000000026, 27.699999999999953, 36.10000000000004, 42.30000000000001, 44.300000000000004, 43.7, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.1, 15.49999999999978, 38.50000000000003, 41.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.900000000000034, 16.8999999999998, 44.5, -50.00000000000044, 27.49999999999995, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 136, 68, 104, 500, 500, 134, 86, 500, 500, 282, 360, 74, 100, 500, 54, 30, 48, 92, 52, 92, 500, 500, 80, 500, 246, 500, 500, 236, 98, 496, 354, 194, 362, 500, 48, 500, 56, 500, 144, 500, 486, 60, 134, 120, 88, 500, 54, 500, 210, 68, 140, 68, 118, 500, 500, 358, 172, 108, 184, 70, 52, 122, 112, 90, 86, 102, 500, 116, 48, 128, 224, 140, 78, 58, 64, 72, 500, 52, 500, 500, 82, 500, 68, 50, 346, 116, 86, 500, 108, 500, 132, 332, 56, 500, 226, 68, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788718490323985, "mean_inference_ms": 1.2162072700953497, "mean_action_processing_ms": 0.1401171226652923, "mean_env_wait_ms": 0.0843680762391905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022595882415771484, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.10601592063903809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5747.235867606657, "num_env_steps_trained_throughput_per_sec": 5747.235867606657, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2179.612, "sample_time_ms": 1960.489, "load_time_ms": 11.652, "load_throughput": 1029873.076, "learn_time_ms": 195.947, "learn_throughput": 61240.959, "synch_weights_time_ms": 9.731}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4142, "training_iteration": 90, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-55", "timestamp": 1698249895, "time_this_iter_s": 2.0929553508758545, "time_total_s": 193.78360557556152, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.78360557556152, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 64.36666666666666, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0003, "total_loss": 7.102218786875407, "policy_loss": -0.00017856496075789133, "vf_loss": 7.1024537616305885, "vf_explained_var": -1.5894571940104166e-07, "kl": 9.716782966191001e-05, "entropy": 0.5642106201913621, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 815.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.209999999999848, "episode_len_mean": 248.58, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 29.099999999999973, 43.30000000000001, 36.10000000000004, 43.30000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, 32.90000000000003, 39.300000000000026, 31.70000000000001, 43.10000000000001, 44.900000000000006, 37.90000000000003, 38.90000000000002, 41.100000000000016, 41.500000000000014, 39.90000000000002, -50.00000000000044, 38.50000000000003, 45.3, 37.300000000000026, 27.699999999999953, 36.10000000000004, 42.30000000000001, 44.300000000000004, 43.7, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.1, 15.49999999999978, 38.50000000000003, 41.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.900000000000034, 16.8999999999998, 44.5, -50.00000000000044, 27.49999999999995, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 15.699999999999783, 40.10000000000002, -50.00000000000044, 44.7, 17.299999999999805, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 12.499999999999737, 43.50000000000001, 46.3, 43.30000000000001, 37.50000000000003, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 32.700000000000024, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 37.300000000000026, -50.00000000000044, 43.900000000000006, 31.1, 41.30000000000001, 41.100000000000016, -50.00000000000044, 17.099999999999802, 42.70000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 54, 500, 210, 68, 140, 68, 118, 500, 500, 358, 172, 108, 184, 70, 52, 122, 112, 90, 86, 102, 500, 116, 48, 128, 224, 140, 78, 58, 64, 72, 500, 52, 500, 500, 82, 500, 68, 50, 346, 116, 86, 500, 108, 500, 132, 332, 56, 500, 226, 68, 128, 500, 500, 500, 112, 150, 500, 500, 344, 100, 500, 54, 328, 84, 500, 340, 500, 66, 376, 66, 38, 68, 126, 184, 500, 500, 84, 54, 174, 104, 500, 82, 500, 500, 500, 500, 500, 70, 128, 500, 62, 190, 88, 90, 500, 330, 74, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788035987219778, "mean_inference_ms": 1.2152581143363423, "mean_action_processing_ms": 0.14020996752487125, "mean_env_wait_ms": 0.08439570244434322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020593881607055664, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.09801888465881348}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.209999999999848, "episode_len_mean": 248.58, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 29.099999999999973, 43.30000000000001, 36.10000000000004, 43.30000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, 32.90000000000003, 39.300000000000026, 31.70000000000001, 43.10000000000001, 44.900000000000006, 37.90000000000003, 38.90000000000002, 41.100000000000016, 41.500000000000014, 39.90000000000002, -50.00000000000044, 38.50000000000003, 45.3, 37.300000000000026, 27.699999999999953, 36.10000000000004, 42.30000000000001, 44.300000000000004, 43.7, 42.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.30000000000001, 45.1, 15.49999999999978, 38.50000000000003, 41.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.900000000000034, 16.8999999999998, 44.5, -50.00000000000044, 27.49999999999995, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.10000000000004, -50.00000000000044, -50.00000000000044, 15.699999999999783, 40.10000000000002, -50.00000000000044, 44.7, 17.299999999999805, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 12.499999999999737, 43.50000000000001, 46.3, 43.30000000000001, 37.50000000000003, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 32.700000000000024, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 37.300000000000026, -50.00000000000044, 43.900000000000006, 31.1, 41.30000000000001, 41.100000000000016, -50.00000000000044, 17.099999999999802, 42.70000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 54, 500, 210, 68, 140, 68, 118, 500, 500, 358, 172, 108, 184, 70, 52, 122, 112, 90, 86, 102, 500, 116, 48, 128, 224, 140, 78, 58, 64, 72, 500, 52, 500, 500, 82, 500, 68, 50, 346, 116, 86, 500, 108, 500, 132, 332, 56, 500, 226, 68, 128, 500, 500, 500, 112, 150, 500, 500, 344, 100, 500, 54, 328, 84, 500, 340, 500, 66, 376, 66, 38, 68, 126, 184, 500, 500, 84, 54, 174, 104, 500, 82, 500, 500, 500, 500, 500, 70, 128, 500, 62, 190, 88, 90, 500, 330, 74, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788035987219778, "mean_inference_ms": 1.2152581143363423, "mean_action_processing_ms": 0.14020996752487125, "mean_env_wait_ms": 0.08439570244434322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020593881607055664, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.09801888465881348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5258.8037673659965, "num_env_steps_trained_throughput_per_sec": 5258.8037673659965, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2189.567, "sample_time_ms": 1965.134, "load_time_ms": 11.552, "load_throughput": 1038751.145, "learn_time_ms": 201.133, "learn_throughput": 59662.06, "synch_weights_time_ms": 9.755}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4188, "training_iteration": 91, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-57", "timestamp": 1698249897, "time_this_iter_s": 2.2878847122192383, "time_total_s": 196.07149028778076, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.07149028778076, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0003, "total_loss": 7.411801232231988, "policy_loss": -5.08427619934082e-05, "vf_loss": 7.411910004085964, "vf_explained_var": -3.973642985026042e-07, "kl": 0.0001694380786811204, "entropy": 0.579941901895735, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 824.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.216999999999851, "episode_len_mean": 243.52, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 15.699999999999783, 40.10000000000002, -50.00000000000044, 44.7, 17.299999999999805, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 12.499999999999737, 43.50000000000001, 46.3, 43.30000000000001, 37.50000000000003, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 32.700000000000024, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 37.300000000000026, -50.00000000000044, 43.900000000000006, 31.1, 41.30000000000001, 41.100000000000016, -50.00000000000044, 17.099999999999802, 42.70000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.10000000000001, 44.900000000000006, 43.10000000000001, 42.900000000000006, 29.69999999999998, 14.09999999999976, 43.50000000000001, -50.00000000000044, 39.10000000000002, 1.6999999999995836, 35.10000000000004, 34.50000000000004, 36.900000000000034, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.30000000000002, 40.70000000000002, 45.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 43.900000000000006, 28.89999999999997, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 47.7, 37.70000000000003, 39.90000000000002, 41.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 43.7, 36.50000000000003, 29.69999999999998, 31.70000000000001, -50.00000000000044, 40.500000000000014, 44.300000000000004, 42.70000000000001, 27.899999999999956, 43.900000000000006, 41.30000000000001, 45.9], "episode_lengths": [500, 500, 344, 100, 500, 54, 328, 84, 500, 340, 500, 66, 376, 66, 38, 68, 126, 184, 500, 500, 84, 54, 174, 104, 500, 82, 500, 500, 500, 500, 500, 70, 128, 500, 62, 190, 88, 90, 500, 330, 74, 500, 500, 140, 70, 52, 70, 72, 204, 360, 66, 500, 110, 484, 150, 156, 132, 500, 500, 64, 500, 74, 104, 500, 500, 40, 178, 94, 50, 136, 500, 500, 42, 42, 62, 212, 84, 500, 500, 500, 64, 24, 124, 102, 86, 270, 500, 500, 64, 136, 204, 184, 500, 96, 58, 74, 222, 62, 88, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37908304612414134, "mean_inference_ms": 1.2152100475876435, "mean_action_processing_ms": 0.1404394604342471, "mean_env_wait_ms": 0.08435947647462182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020999908447265625, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.11202239990234375}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.216999999999851, "episode_len_mean": 243.52, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 15.699999999999783, 40.10000000000002, -50.00000000000044, 44.7, 17.299999999999805, 41.70000000000002, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 12.499999999999737, 43.50000000000001, 46.3, 43.30000000000001, 37.50000000000003, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 32.700000000000024, 39.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 37.300000000000026, -50.00000000000044, 43.900000000000006, 31.1, 41.30000000000001, 41.100000000000016, -50.00000000000044, 17.099999999999802, 42.70000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.10000000000001, 44.900000000000006, 43.10000000000001, 42.900000000000006, 29.69999999999998, 14.09999999999976, 43.50000000000001, -50.00000000000044, 39.10000000000002, 1.6999999999995836, 35.10000000000004, 34.50000000000004, 36.900000000000034, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.30000000000002, 40.70000000000002, 45.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 43.900000000000006, 28.89999999999997, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 47.7, 37.70000000000003, 39.90000000000002, 41.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 43.7, 36.50000000000003, 29.69999999999998, 31.70000000000001, -50.00000000000044, 40.500000000000014, 44.300000000000004, 42.70000000000001, 27.899999999999956, 43.900000000000006, 41.30000000000001, 45.9], "episode_lengths": [500, 500, 344, 100, 500, 54, 328, 84, 500, 340, 500, 66, 376, 66, 38, 68, 126, 184, 500, 500, 84, 54, 174, 104, 500, 82, 500, 500, 500, 500, 500, 70, 128, 500, 62, 190, 88, 90, 500, 330, 74, 500, 500, 140, 70, 52, 70, 72, 204, 360, 66, 500, 110, 484, 150, 156, 132, 500, 500, 64, 500, 74, 104, 500, 500, 40, 178, 94, 50, 136, 500, 500, 42, 42, 62, 212, 84, 500, 500, 500, 64, 24, 124, 102, 86, 270, 500, 500, 64, 136, 204, 184, 500, 96, 58, 74, 222, 62, 88, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37908304612414134, "mean_inference_ms": 1.2152100475876435, "mean_action_processing_ms": 0.1404394604342471, "mean_env_wait_ms": 0.08435947647462182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020999908447265625, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.11202239990234375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5863.350772532039, "num_env_steps_trained_throughput_per_sec": 5863.350772532039, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2187.385, "sample_time_ms": 1962.855, "load_time_ms": 11.454, "load_throughput": 1047646.214, "learn_time_ms": 201.204, "learn_throughput": 59640.929, "synch_weights_time_ms": 9.877}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4245, "training_iteration": 92, "trial_id": "9f288_00018", "date": "2023-10-25_17-04-59", "timestamp": 1698249899, "time_this_iter_s": 2.050962448120117, "time_total_s": 198.12245273590088, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.12245273590088, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 56.03333333333334, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 0.0003, "total_loss": 6.674407164255778, "policy_loss": -3.659435444407993e-05, "vf_loss": 6.67450115415785, "vf_explained_var": -1.099374559190538e-06, "kl": 9.51553800897879e-05, "entropy": 0.57406571176317, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.98499999999989, "episode_len_mean": 195.9, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.30000000000002, 40.70000000000002, 45.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 43.900000000000006, 28.89999999999997, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 47.7, 37.70000000000003, 39.90000000000002, 41.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 43.7, 36.50000000000003, 29.69999999999998, 31.70000000000001, -50.00000000000044, 40.500000000000014, 44.300000000000004, 42.70000000000001, 27.899999999999956, 43.900000000000006, 41.30000000000001, 45.9, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 23.8999999999999, 44.5, 44.5, 41.70000000000002, 43.10000000000001, 36.900000000000034, 38.700000000000024, -50.00000000000044, 23.699999999999896, 37.70000000000003, 41.90000000000001, -50.00000000000044, 40.70000000000002, 38.90000000000002, 43.50000000000001, 46.3, -50.00000000000044, 32.100000000000016, 45.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 43.50000000000001, 32.90000000000003, 40.500000000000014, 36.900000000000034, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.90000000000003, 41.70000000000002, 45.7, 47.3, 42.500000000000014, 40.30000000000002, 40.500000000000014, -50.00000000000044, 43.30000000000001, 44.10000000000001, 45.5, 43.900000000000006, 42.10000000000001, 45.1, 42.30000000000001, 44.10000000000001, 42.500000000000014, -50.00000000000044], "episode_lengths": [500, 74, 104, 500, 500, 40, 178, 94, 50, 136, 500, 500, 42, 42, 62, 212, 84, 500, 500, 500, 64, 24, 124, 102, 86, 270, 500, 500, 64, 136, 204, 184, 500, 96, 58, 74, 222, 62, 88, 42, 50, 50, 500, 500, 54, 500, 500, 262, 56, 56, 84, 70, 132, 114, 500, 264, 124, 82, 500, 94, 112, 66, 38, 500, 180, 44, 500, 46, 54, 500, 40, 66, 500, 66, 172, 96, 132, 54, 182, 500, 500, 104, 122, 84, 44, 28, 76, 98, 96, 500, 68, 60, 46, 62, 80, 50, 78, 60, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794453542037117, "mean_inference_ms": 1.215693632972261, "mean_action_processing_ms": 0.14042283044833254, "mean_env_wait_ms": 0.084575285985715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015999794006347656, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.13399887084960938}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.98499999999989, "episode_len_mean": 195.9, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.30000000000002, 40.70000000000002, 45.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 43.900000000000006, 28.89999999999997, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 47.7, 37.70000000000003, 39.90000000000002, 41.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 43.7, 36.50000000000003, 29.69999999999998, 31.70000000000001, -50.00000000000044, 40.500000000000014, 44.300000000000004, 42.70000000000001, 27.899999999999956, 43.900000000000006, 41.30000000000001, 45.9, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 23.8999999999999, 44.5, 44.5, 41.70000000000002, 43.10000000000001, 36.900000000000034, 38.700000000000024, -50.00000000000044, 23.699999999999896, 37.70000000000003, 41.90000000000001, -50.00000000000044, 40.70000000000002, 38.90000000000002, 43.50000000000001, 46.3, -50.00000000000044, 32.100000000000016, 45.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 43.50000000000001, 32.90000000000003, 40.500000000000014, 36.900000000000034, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.90000000000003, 41.70000000000002, 45.7, 47.3, 42.500000000000014, 40.30000000000002, 40.500000000000014, -50.00000000000044, 43.30000000000001, 44.10000000000001, 45.5, 43.900000000000006, 42.10000000000001, 45.1, 42.30000000000001, 44.10000000000001, 42.500000000000014, -50.00000000000044], "episode_lengths": [500, 74, 104, 500, 500, 40, 178, 94, 50, 136, 500, 500, 42, 42, 62, 212, 84, 500, 500, 500, 64, 24, 124, 102, 86, 270, 500, 500, 64, 136, 204, 184, 500, 96, 58, 74, 222, 62, 88, 42, 50, 50, 500, 500, 54, 500, 500, 262, 56, 56, 84, 70, 132, 114, 500, 264, 124, 82, 500, 94, 112, 66, 38, 500, 180, 44, 500, 46, 54, 500, 40, 66, 500, 66, 172, 96, 132, 54, 182, 500, 500, 104, 122, 84, 44, 28, 76, 98, 96, 500, 68, 60, 46, 62, 80, 50, 78, 60, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794453542037117, "mean_inference_ms": 1.215693632972261, "mean_action_processing_ms": 0.14042283044833254, "mean_env_wait_ms": 0.084575285985715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015999794006347656, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.13399887084960938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5553.656239603787, "num_env_steps_trained_throughput_per_sec": 5553.656239603787, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2179.267, "sample_time_ms": 1962.916, "load_time_ms": 12.253, "load_throughput": 979312.111, "learn_time_ms": 192.591, "learn_throughput": 62308.362, "synch_weights_time_ms": 9.613}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4305, "training_iteration": 93, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-01", "timestamp": 1698249901, "time_this_iter_s": 2.1667380332946777, "time_total_s": 200.28919076919556, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.28919076919556, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 62.666666666666664, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 0.0003, "total_loss": 7.347389856974284, "policy_loss": 1.9114050600263807e-05, "vf_loss": 7.347427633073595, "vf_explained_var": -1.3642840915256077e-06, "kl": 4.416366173624434e-05, "entropy": 0.5697372953097025, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 842.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.441999999999876, "episode_len_mean": 216.32, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 41.70000000000002, 43.10000000000001, 36.900000000000034, 38.700000000000024, -50.00000000000044, 23.699999999999896, 37.70000000000003, 41.90000000000001, -50.00000000000044, 40.70000000000002, 38.90000000000002, 43.50000000000001, 46.3, -50.00000000000044, 32.100000000000016, 45.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 43.50000000000001, 32.90000000000003, 40.500000000000014, 36.900000000000034, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.90000000000003, 41.70000000000002, 45.7, 47.3, 42.500000000000014, 40.30000000000002, 40.500000000000014, -50.00000000000044, 43.30000000000001, 44.10000000000001, 45.5, 43.900000000000006, 42.10000000000001, 45.1, 42.30000000000001, 44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.099999999999994, 39.70000000000002, 31.1, 43.50000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 30.699999999999996, 43.900000000000006, 20.699999999999854, 23.8999999999999, 22.099999999999874, 37.70000000000003, 9.299999999999692, 32.700000000000024, -50.00000000000044, 47.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 44.7, 9.499999999999694, 22.299999999999876, 41.30000000000001, 45.7, -50.00000000000044, 44.10000000000001, 0.8999999999995723, 45.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, 35.30000000000004], "episode_lengths": [56, 84, 70, 132, 114, 500, 264, 124, 82, 500, 94, 112, 66, 38, 500, 180, 44, 500, 46, 54, 500, 40, 66, 500, 66, 172, 96, 132, 54, 182, 500, 500, 104, 122, 84, 44, 28, 76, 98, 96, 500, 68, 60, 46, 62, 80, 50, 78, 60, 76, 500, 500, 500, 188, 500, 500, 96, 500, 500, 134, 40, 104, 190, 66, 500, 116, 500, 500, 70, 194, 62, 294, 262, 280, 124, 408, 174, 500, 30, 182, 500, 500, 82, 86, 500, 54, 406, 278, 88, 44, 500, 60, 492, 44, 92, 500, 500, 60, 84, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795543706478552, "mean_inference_ms": 1.2156475966733171, "mean_action_processing_ms": 0.14039692949331287, "mean_env_wait_ms": 0.08463891672813663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000696182250977, "StateBufferConnector_ms": 0.005995273590087891, "ViewRequirementAgentConnector_ms": 0.14299559593200684}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.441999999999876, "episode_len_mean": 216.32, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 41.70000000000002, 43.10000000000001, 36.900000000000034, 38.700000000000024, -50.00000000000044, 23.699999999999896, 37.70000000000003, 41.90000000000001, -50.00000000000044, 40.70000000000002, 38.90000000000002, 43.50000000000001, 46.3, -50.00000000000044, 32.100000000000016, 45.7, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 43.50000000000001, 32.90000000000003, 40.500000000000014, 36.900000000000034, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 39.70000000000002, 37.90000000000003, 41.70000000000002, 45.7, 47.3, 42.500000000000014, 40.30000000000002, 40.500000000000014, -50.00000000000044, 43.30000000000001, 44.10000000000001, 45.5, 43.900000000000006, 42.10000000000001, 45.1, 42.30000000000001, 44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.099999999999994, 39.70000000000002, 31.1, 43.50000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 30.699999999999996, 43.900000000000006, 20.699999999999854, 23.8999999999999, 22.099999999999874, 37.70000000000003, 9.299999999999692, 32.700000000000024, -50.00000000000044, 47.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 44.7, 9.499999999999694, 22.299999999999876, 41.30000000000001, 45.7, -50.00000000000044, 44.10000000000001, 0.8999999999995723, 45.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, 35.30000000000004], "episode_lengths": [56, 84, 70, 132, 114, 500, 264, 124, 82, 500, 94, 112, 66, 38, 500, 180, 44, 500, 46, 54, 500, 40, 66, 500, 66, 172, 96, 132, 54, 182, 500, 500, 104, 122, 84, 44, 28, 76, 98, 96, 500, 68, 60, 46, 62, 80, 50, 78, 60, 76, 500, 500, 500, 188, 500, 500, 96, 500, 500, 134, 40, 104, 190, 66, 500, 116, 500, 500, 70, 194, 62, 294, 262, 280, 124, 408, 174, 500, 30, 182, 500, 500, 82, 86, 500, 54, 406, 278, 88, 44, 500, 60, 492, 44, 92, 500, 500, 60, 84, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795543706478552, "mean_inference_ms": 1.2156475966733171, "mean_action_processing_ms": 0.14039692949331287, "mean_env_wait_ms": 0.08463891672813663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000696182250977, "StateBufferConnector_ms": 0.005995273590087891, "ViewRequirementAgentConnector_ms": 0.14299559593200684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5204.663672678427, "num_env_steps_trained_throughput_per_sec": 5204.663672678427, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2178.065, "sample_time_ms": 1937.061, "load_time_ms": 13.149, "load_throughput": 912608.71, "learn_time_ms": 216.449, "learn_throughput": 55440.434, "synch_weights_time_ms": 9.612}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4354, "training_iteration": 94, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-04", "timestamp": 1698249904, "time_this_iter_s": 2.3116238117218018, "time_total_s": 202.60081458091736, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.60081458091736, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 53.349999999999994, "ram_util_percent": 27.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 0.0003, "total_loss": 7.06392420662774, "policy_loss": -5.177118712001377e-05, "vf_loss": 7.064030435350206, "vf_explained_var": -1.4702479044596355e-06, "kl": 3.82188500138467e-05, "entropy": 0.5437752935621474, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.038999999999838, "episode_len_mean": 255.3, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.099999999999994, 39.70000000000002, 31.1, 43.50000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 30.699999999999996, 43.900000000000006, 20.699999999999854, 23.8999999999999, 22.099999999999874, 37.70000000000003, 9.299999999999692, 32.700000000000024, -50.00000000000044, 47.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 44.7, 9.499999999999694, 22.299999999999876, 41.30000000000001, 45.7, -50.00000000000044, 44.10000000000001, 0.8999999999995723, 45.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, 35.30000000000004, -50.00000000000044, 36.10000000000004, 10.299999999999706, 35.900000000000034, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.7, 16.699999999999797, 42.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 44.5, 37.90000000000003, 24.499999999999908, 39.70000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 1.299999999999578, 41.30000000000001, -50.00000000000044, -50.00000000000044, 11.29999999999972, 46.099999999999994, -50.00000000000044, 38.90000000000002, 44.300000000000004, 42.500000000000014, 45.3, 40.30000000000002, -50.00000000000044, 41.90000000000001, 34.10000000000004, 46.5, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 37.50000000000003], "episode_lengths": [60, 76, 500, 500, 500, 188, 500, 500, 96, 500, 500, 134, 40, 104, 190, 66, 500, 116, 500, 500, 70, 194, 62, 294, 262, 280, 124, 408, 174, 500, 30, 182, 500, 500, 82, 86, 500, 54, 406, 278, 88, 44, 500, 60, 492, 44, 92, 500, 500, 60, 84, 148, 500, 140, 398, 142, 54, 52, 500, 92, 54, 334, 72, 500, 78, 120, 500, 172, 500, 56, 122, 256, 104, 500, 344, 500, 488, 88, 500, 500, 388, 40, 500, 112, 58, 76, 48, 98, 500, 82, 160, 36, 500, 46, 80, 500, 32, 314, 500, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379191055341377, "mean_inference_ms": 1.2153921031980177, "mean_action_processing_ms": 0.1404972818829994, "mean_env_wait_ms": 0.08433887352698555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599501609802246, "StateBufferConnector_ms": 0.003996372222900391, "ViewRequirementAgentConnector_ms": 0.12554001808166504}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.038999999999838, "episode_len_mean": 255.3, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.099999999999994, 39.70000000000002, 31.1, 43.50000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 30.699999999999996, 43.900000000000006, 20.699999999999854, 23.8999999999999, 22.099999999999874, 37.70000000000003, 9.299999999999692, 32.700000000000024, -50.00000000000044, 47.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, -50.00000000000044, 44.7, 9.499999999999694, 22.299999999999876, 41.30000000000001, 45.7, -50.00000000000044, 44.10000000000001, 0.8999999999995723, 45.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, 35.30000000000004, -50.00000000000044, 36.10000000000004, 10.299999999999706, 35.900000000000034, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.7, 16.699999999999797, 42.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 44.5, 37.90000000000003, 24.499999999999908, 39.70000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 1.299999999999578, 41.30000000000001, -50.00000000000044, -50.00000000000044, 11.29999999999972, 46.099999999999994, -50.00000000000044, 38.90000000000002, 44.300000000000004, 42.500000000000014, 45.3, 40.30000000000002, -50.00000000000044, 41.90000000000001, 34.10000000000004, 46.5, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 37.50000000000003], "episode_lengths": [60, 76, 500, 500, 500, 188, 500, 500, 96, 500, 500, 134, 40, 104, 190, 66, 500, 116, 500, 500, 70, 194, 62, 294, 262, 280, 124, 408, 174, 500, 30, 182, 500, 500, 82, 86, 500, 54, 406, 278, 88, 44, 500, 60, 492, 44, 92, 500, 500, 60, 84, 148, 500, 140, 398, 142, 54, 52, 500, 92, 54, 334, 72, 500, 78, 120, 500, 172, 500, 56, 122, 256, 104, 500, 344, 500, 488, 88, 500, 500, 388, 40, 500, 112, 58, 76, 48, 98, 500, 82, 160, 36, 500, 46, 80, 500, 32, 314, 500, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379191055341377, "mean_inference_ms": 1.2153921031980177, "mean_action_processing_ms": 0.1404972818829994, "mean_env_wait_ms": 0.08433887352698555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599501609802246, "StateBufferConnector_ms": 0.003996372222900391, "ViewRequirementAgentConnector_ms": 0.12554001808166504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5847.809722475733, "num_env_steps_trained_throughput_per_sec": 5847.809722475733, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2173.681, "sample_time_ms": 1936.906, "load_time_ms": 13.149, "load_throughput": 912603.746, "learn_time_ms": 212.175, "learn_throughput": 56557.002, "synch_weights_time_ms": 9.756}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4402, "training_iteration": 95, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-06", "timestamp": 1698249906, "time_this_iter_s": 2.0570473670959473, "time_total_s": 204.6578619480133, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 204.6578619480133, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 64.7, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414476e-30, "cur_lr": 0.0003, "total_loss": 6.513618469238281, "policy_loss": -5.279978116353353e-05, "vf_loss": 6.513725227779812, "vf_explained_var": -1.0596381293402778e-06, "kl": 5.851356630002e-05, "entropy": 0.5372717446751065, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 860.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.450999999999834, "episode_len_mean": 251.16, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, 35.30000000000004, -50.00000000000044, 36.10000000000004, 10.299999999999706, 35.900000000000034, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.7, 16.699999999999797, 42.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 44.5, 37.90000000000003, 24.499999999999908, 39.70000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 1.299999999999578, 41.30000000000001, -50.00000000000044, -50.00000000000044, 11.29999999999972, 46.099999999999994, -50.00000000000044, 38.90000000000002, 44.300000000000004, 42.500000000000014, 45.3, 40.30000000000002, -50.00000000000044, 41.90000000000001, 34.10000000000004, 46.5, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 29.099999999999973, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 19.09999999999983, 31.70000000000001, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 0.49999999999956657, 20.299999999999848, 42.500000000000014, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 43.900000000000006, 42.10000000000001, 28.89999999999997, 33.500000000000036, 44.300000000000004], "episode_lengths": [44, 92, 500, 500, 60, 84, 148, 500, 140, 398, 142, 54, 52, 500, 92, 54, 334, 72, 500, 78, 120, 500, 172, 500, 56, 122, 256, 104, 500, 344, 500, 488, 88, 500, 500, 388, 40, 500, 112, 58, 76, 48, 98, 500, 82, 160, 36, 500, 46, 80, 500, 32, 314, 500, 126, 500, 78, 24, 500, 84, 500, 78, 210, 92, 500, 500, 500, 40, 44, 76, 500, 44, 500, 500, 66, 208, 500, 500, 310, 184, 34, 500, 74, 500, 52, 500, 500, 66, 496, 298, 76, 500, 72, 42, 500, 62, 80, 212, 166, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37901941331650646, "mean_inference_ms": 1.215430846609076, "mean_action_processing_ms": 0.14049048289485472, "mean_env_wait_ms": 0.08424205636694147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029994726181030273, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.11726689338684082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.450999999999834, "episode_len_mean": 251.16, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.70000000000002, 35.30000000000004, -50.00000000000044, 36.10000000000004, 10.299999999999706, 35.900000000000034, 44.7, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.7, 16.699999999999797, 42.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 44.5, 37.90000000000003, 24.499999999999908, 39.70000000000002, -50.00000000000044, 15.699999999999783, -50.00000000000044, 1.299999999999578, 41.30000000000001, -50.00000000000044, -50.00000000000044, 11.29999999999972, 46.099999999999994, -50.00000000000044, 38.90000000000002, 44.300000000000004, 42.500000000000014, 45.3, 40.30000000000002, -50.00000000000044, 41.90000000000001, 34.10000000000004, 46.5, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 29.099999999999973, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 19.09999999999983, 31.70000000000001, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 0.49999999999956657, 20.299999999999848, 42.500000000000014, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 43.900000000000006, 42.10000000000001, 28.89999999999997, 33.500000000000036, 44.300000000000004], "episode_lengths": [44, 92, 500, 500, 60, 84, 148, 500, 140, 398, 142, 54, 52, 500, 92, 54, 334, 72, 500, 78, 120, 500, 172, 500, 56, 122, 256, 104, 500, 344, 500, 488, 88, 500, 500, 388, 40, 500, 112, 58, 76, 48, 98, 500, 82, 160, 36, 500, 46, 80, 500, 32, 314, 500, 126, 500, 78, 24, 500, 84, 500, 78, 210, 92, 500, 500, 500, 40, 44, 76, 500, 44, 500, 500, 66, 208, 500, 500, 310, 184, 34, 500, 74, 500, 52, 500, 500, 66, 496, 298, 76, 500, 72, 42, 500, 62, 80, 212, 166, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37901941331650646, "mean_inference_ms": 1.215430846609076, "mean_action_processing_ms": 0.14049048289485472, "mean_env_wait_ms": 0.08424205636694147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029994726181030273, "StateBufferConnector_ms": 0.0020008087158203125, "ViewRequirementAgentConnector_ms": 0.11726689338684082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5315.429522384216, "num_env_steps_trained_throughput_per_sec": 5315.429522384216, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2170.141, "sample_time_ms": 1935.861, "load_time_ms": 12.975, "load_throughput": 924845.2, "learn_time_ms": 209.806, "learn_throughput": 57195.601, "synch_weights_time_ms": 9.804}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4447, "training_iteration": 96, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-08", "timestamp": 1698249908, "time_this_iter_s": 2.2625765800476074, "time_total_s": 206.9204385280609, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.9204385280609, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 56.725, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.524354896707238e-30, "cur_lr": 0.0003, "total_loss": 6.739440229203966, "policy_loss": -0.0001967793537510766, "vf_loss": 6.739692846934001, "vf_explained_var": 1.7219119601779514e-07, "kl": 0.00023752213000231373, "entropy": 0.5600041879547967, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 869.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.11399999999984, "episode_len_mean": 249.52, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 29.099999999999973, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 19.09999999999983, 31.70000000000001, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 0.49999999999956657, 20.299999999999848, 42.500000000000014, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 43.900000000000006, 42.10000000000001, 28.89999999999997, 33.500000000000036, 44.300000000000004, -50.00000000000044, 40.70000000000002, 43.50000000000001, 39.50000000000002, 25.29999999999992, 20.899999999999856, -50.00000000000044, 33.500000000000036, 43.50000000000001, 46.699999999999996, 42.70000000000001, -50.00000000000044, 10.099999999999703, 43.30000000000001, 42.500000000000014, 37.50000000000003, 41.30000000000001, 44.5, -50.00000000000044, 39.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 24.099999999999902, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 37.50000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 40.10000000000002, 38.700000000000024, 40.70000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.900000000000006, 38.10000000000002], "episode_lengths": [500, 32, 314, 500, 126, 500, 78, 24, 500, 84, 500, 78, 210, 92, 500, 500, 500, 40, 44, 76, 500, 44, 500, 500, 66, 208, 500, 500, 310, 184, 34, 500, 74, 500, 52, 500, 500, 66, 496, 298, 76, 500, 72, 42, 500, 62, 80, 212, 166, 58, 500, 94, 66, 106, 248, 292, 500, 166, 66, 34, 74, 500, 400, 68, 76, 126, 88, 56, 500, 108, 54, 500, 500, 294, 84, 500, 500, 124, 56, 260, 80, 500, 500, 500, 120, 500, 90, 126, 72, 58, 500, 100, 114, 94, 84, 500, 84, 500, 72, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37920811003510096, "mean_inference_ms": 1.2154508083442308, "mean_action_processing_ms": 0.1404024083909903, "mean_env_wait_ms": 0.08432829620940874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035004615783691406, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12982583045959473}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.11399999999984, "episode_len_mean": 249.52, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 29.099999999999973, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 19.09999999999983, 31.70000000000001, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 0.49999999999956657, 20.299999999999848, 42.500000000000014, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 43.900000000000006, 42.10000000000001, 28.89999999999997, 33.500000000000036, 44.300000000000004, -50.00000000000044, 40.70000000000002, 43.50000000000001, 39.50000000000002, 25.29999999999992, 20.899999999999856, -50.00000000000044, 33.500000000000036, 43.50000000000001, 46.699999999999996, 42.70000000000001, -50.00000000000044, 10.099999999999703, 43.30000000000001, 42.500000000000014, 37.50000000000003, 41.30000000000001, 44.5, -50.00000000000044, 39.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 24.099999999999902, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 37.50000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 40.10000000000002, 38.700000000000024, 40.70000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.900000000000006, 38.10000000000002], "episode_lengths": [500, 32, 314, 500, 126, 500, 78, 24, 500, 84, 500, 78, 210, 92, 500, 500, 500, 40, 44, 76, 500, 44, 500, 500, 66, 208, 500, 500, 310, 184, 34, 500, 74, 500, 52, 500, 500, 66, 496, 298, 76, 500, 72, 42, 500, 62, 80, 212, 166, 58, 500, 94, 66, 106, 248, 292, 500, 166, 66, 34, 74, 500, 400, 68, 76, 126, 88, 56, 500, 108, 54, 500, 500, 294, 84, 500, 500, 124, 56, 260, 80, 500, 500, 500, 120, 500, 90, 126, 72, 58, 500, 100, 114, 94, 84, 500, 84, 500, 72, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37920811003510096, "mean_inference_ms": 1.2154508083442308, "mean_action_processing_ms": 0.1404024083909903, "mean_env_wait_ms": 0.08432829620940874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035004615783691406, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12982583045959473}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5454.463171820909, "num_env_steps_trained_throughput_per_sec": 5454.463171820909, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2159.573, "sample_time_ms": 1931.456, "load_time_ms": 12.676, "load_throughput": 946697.539, "learn_time_ms": 203.633, "learn_throughput": 58929.642, "synch_weights_time_ms": 10.007}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4497, "training_iteration": 97, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-10", "timestamp": 1698249910, "time_this_iter_s": 2.2050302028656006, "time_total_s": 209.1254687309265, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.1254687309265, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 60.03333333333334, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.262177448353619e-30, "cur_lr": 0.0003, "total_loss": 6.80923408932156, "policy_loss": 1.9431114196777344e-05, "vf_loss": 6.809273136986627, "vf_explained_var": -7.682376437717014e-07, "kl": 0.00011335712267484471, "entropy": 0.5844572981198629, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.839999999999863, "episode_len_mean": 232.3, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 25.29999999999992, 20.899999999999856, -50.00000000000044, 33.500000000000036, 43.50000000000001, 46.699999999999996, 42.70000000000001, -50.00000000000044, 10.099999999999703, 43.30000000000001, 42.500000000000014, 37.50000000000003, 41.30000000000001, 44.5, -50.00000000000044, 39.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 24.099999999999902, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 37.50000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 40.10000000000002, 38.700000000000024, 40.70000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 42.500000000000014, 26.299999999999933, 42.70000000000001, 44.5, -50.00000000000044, 44.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 23.8999999999999, 29.899999999999984, 30.9, 34.50000000000004, 40.500000000000014, 35.900000000000034, 44.5, 31.70000000000001, 41.70000000000002, 37.10000000000003, -50.00000000000044, 32.100000000000016, 39.50000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.3, 37.50000000000003, 44.900000000000006, 40.30000000000002, 44.300000000000004, 45.5, 43.30000000000001, 45.5, 44.300000000000004, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 45.1], "episode_lengths": [106, 248, 292, 500, 166, 66, 34, 74, 500, 400, 68, 76, 126, 88, 56, 500, 108, 54, 500, 500, 294, 84, 500, 500, 124, 56, 260, 80, 500, 500, 500, 120, 500, 90, 126, 72, 58, 500, 100, 114, 94, 84, 500, 84, 500, 72, 120, 500, 48, 500, 56, 76, 238, 74, 56, 500, 54, 240, 500, 500, 500, 500, 86, 262, 202, 192, 156, 96, 142, 56, 184, 84, 130, 500, 180, 106, 98, 500, 500, 104, 38, 126, 52, 98, 58, 46, 68, 46, 58, 500, 306, 500, 500, 208, 500, 118, 500, 44, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37937807613494084, "mean_inference_ms": 1.2147880339225559, "mean_action_processing_ms": 0.14054394187057898, "mean_env_wait_ms": 0.08455809535897096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.14809226989746094}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.839999999999863, "episode_len_mean": 232.3, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 25.29999999999992, 20.899999999999856, -50.00000000000044, 33.500000000000036, 43.50000000000001, 46.699999999999996, 42.70000000000001, -50.00000000000044, 10.099999999999703, 43.30000000000001, 42.500000000000014, 37.50000000000003, 41.30000000000001, 44.5, -50.00000000000044, 39.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 24.099999999999902, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 37.50000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 40.10000000000002, 38.700000000000024, 40.70000000000002, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 42.500000000000014, 26.299999999999933, 42.70000000000001, 44.5, -50.00000000000044, 44.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 23.8999999999999, 29.899999999999984, 30.9, 34.50000000000004, 40.500000000000014, 35.900000000000034, 44.5, 31.70000000000001, 41.70000000000002, 37.10000000000003, -50.00000000000044, 32.100000000000016, 39.50000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.3, 37.50000000000003, 44.900000000000006, 40.30000000000002, 44.300000000000004, 45.5, 43.30000000000001, 45.5, 44.300000000000004, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 45.1], "episode_lengths": [106, 248, 292, 500, 166, 66, 34, 74, 500, 400, 68, 76, 126, 88, 56, 500, 108, 54, 500, 500, 294, 84, 500, 500, 124, 56, 260, 80, 500, 500, 500, 120, 500, 90, 126, 72, 58, 500, 100, 114, 94, 84, 500, 84, 500, 72, 120, 500, 48, 500, 56, 76, 238, 74, 56, 500, 54, 240, 500, 500, 500, 500, 86, 262, 202, 192, 156, 96, 142, 56, 184, 84, 130, 500, 180, 106, 98, 500, 500, 104, 38, 126, 52, 98, 58, 46, 68, 46, 58, 500, 306, 500, 500, 208, 500, 118, 500, 44, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37937807613494084, "mean_inference_ms": 1.2147880339225559, "mean_action_processing_ms": 0.14054394187057898, "mean_env_wait_ms": 0.08455809535897096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.14809226989746094}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5674.783005567938, "num_env_steps_trained_throughput_per_sec": 5674.783005567938, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2147.009, "sample_time_ms": 1934.193, "load_time_ms": 12.67, "load_throughput": 947096.575, "learn_time_ms": 188.479, "learn_throughput": 63667.54, "synch_weights_time_ms": 9.864}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4550, "training_iteration": 98, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-12", "timestamp": 1698249912, "time_this_iter_s": 2.119612693786621, "time_total_s": 211.24508142471313, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.24508142471313, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 60.20000000000001, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.310887241768095e-31, "cur_lr": 0.0003, "total_loss": 6.7041269938151045, "policy_loss": -0.0004695302082432641, "vf_loss": 6.704653845893012, "vf_explained_var": -1.1258655124240452e-06, "kl": 0.000318997965393919, "entropy": 0.5715497798389859, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 887.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9049999999998395, "episode_len_mean": 256.6, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 42.500000000000014, 26.299999999999933, 42.70000000000001, 44.5, -50.00000000000044, 44.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 23.8999999999999, 29.899999999999984, 30.9, 34.50000000000004, 40.500000000000014, 35.900000000000034, 44.5, 31.70000000000001, 41.70000000000002, 37.10000000000003, -50.00000000000044, 32.100000000000016, 39.50000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.3, 37.50000000000003, 44.900000000000006, 40.30000000000002, 44.300000000000004, 45.5, 43.30000000000001, 45.5, 44.300000000000004, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.5, 21.299999999999862, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 43.7, 38.90000000000002, 43.900000000000006, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.29999999999999, 28.499999999999964, 32.90000000000003, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 43.7, 23.499999999999893], "episode_lengths": [84, 500, 84, 500, 72, 120, 500, 48, 500, 56, 76, 238, 74, 56, 500, 54, 240, 500, 500, 500, 500, 86, 262, 202, 192, 156, 96, 142, 56, 184, 84, 130, 500, 180, 106, 98, 500, 500, 104, 38, 126, 52, 98, 58, 46, 68, 46, 58, 500, 306, 500, 500, 208, 500, 118, 500, 44, 500, 50, 500, 150, 86, 500, 500, 222, 500, 82, 72, 500, 500, 94, 500, 500, 264, 56, 288, 500, 148, 500, 182, 64, 112, 62, 500, 460, 500, 500, 148, 500, 500, 98, 198, 216, 172, 500, 32, 28, 500, 64, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37919364076127754, "mean_inference_ms": 1.2144912837580661, "mean_action_processing_ms": 0.14043895929377137, "mean_env_wait_ms": 0.08441922876858092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013757705688477, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.12900590896606445}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9049999999998395, "episode_len_mean": 256.6, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.900000000000006, 38.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, 44.5, 42.500000000000014, 26.299999999999933, 42.70000000000001, 44.5, -50.00000000000044, 44.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 23.8999999999999, 29.899999999999984, 30.9, 34.50000000000004, 40.500000000000014, 35.900000000000034, 44.5, 31.70000000000001, 41.70000000000002, 37.10000000000003, -50.00000000000044, 32.100000000000016, 39.50000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.3, 37.50000000000003, 44.900000000000006, 40.30000000000002, 44.300000000000004, 45.5, 43.30000000000001, 45.5, 44.300000000000004, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.5, 21.299999999999862, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 43.7, 38.90000000000002, 43.900000000000006, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.29999999999999, 28.499999999999964, 32.90000000000003, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 43.7, 23.499999999999893], "episode_lengths": [84, 500, 84, 500, 72, 120, 500, 48, 500, 56, 76, 238, 74, 56, 500, 54, 240, 500, 500, 500, 500, 86, 262, 202, 192, 156, 96, 142, 56, 184, 84, 130, 500, 180, 106, 98, 500, 500, 104, 38, 126, 52, 98, 58, 46, 68, 46, 58, 500, 306, 500, 500, 208, 500, 118, 500, 44, 500, 50, 500, 150, 86, 500, 500, 222, 500, 82, 72, 500, 500, 94, 500, 500, 264, 56, 288, 500, 148, 500, 182, 64, 112, 62, 500, 460, 500, 500, 148, 500, 500, 98, 198, 216, 172, 500, 32, 28, 500, 64, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37919364076127754, "mean_inference_ms": 1.2144912837580661, "mean_action_processing_ms": 0.14043895929377137, "mean_env_wait_ms": 0.08441922876858092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013757705688477, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.12900590896606445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5390.079708026383, "num_env_steps_trained_throughput_per_sec": 5390.079708026383, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2173.342, "sample_time_ms": 1941.249, "load_time_ms": 13.573, "load_throughput": 884093.996, "learn_time_ms": 206.971, "learn_throughput": 57979.264, "synch_weights_time_ms": 9.846}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4591, "training_iteration": 99, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-15", "timestamp": 1698249915, "time_this_iter_s": 2.2313084602355957, "time_total_s": 213.47638988494873, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 213.47638988494873, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840474e-31, "cur_lr": 0.0003, "total_loss": 6.823887877994114, "policy_loss": -0.0002756488199035327, "vf_loss": 6.824219968583849, "vf_explained_var": -1.708666483561198e-06, "kl": 0.000544128669035773, "entropy": 0.5627357827292548, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 896.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6429999999998017, "episode_len_mean": 289.16, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 46.3, 37.50000000000003, 44.900000000000006, 40.30000000000002, 44.300000000000004, 45.5, 43.30000000000001, 45.5, 44.300000000000004, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.5, 21.299999999999862, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 43.7, 38.90000000000002, 43.900000000000006, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.29999999999999, 28.499999999999964, 32.90000000000003, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 43.7, 23.499999999999893, -50.00000000000044, 15.899999999999785, 36.30000000000003, 46.3, 36.50000000000003, 44.5, -50.00000000000044, 37.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 42.70000000000001, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, 39.70000000000002, 34.900000000000034, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 17.499999999999808, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.699999999999967], "episode_lengths": [500, 104, 38, 126, 52, 98, 58, 46, 68, 46, 58, 500, 306, 500, 500, 208, 500, 118, 500, 44, 500, 50, 500, 150, 86, 500, 500, 222, 500, 82, 72, 500, 500, 94, 500, 500, 264, 56, 288, 500, 148, 500, 182, 64, 112, 62, 500, 460, 500, 500, 148, 500, 500, 98, 198, 216, 172, 500, 32, 28, 500, 64, 266, 500, 342, 138, 38, 136, 56, 500, 128, 122, 500, 500, 500, 500, 500, 458, 500, 74, 38, 60, 500, 500, 500, 138, 500, 420, 500, 104, 152, 132, 500, 500, 294, 326, 500, 500, 62, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37948840907390946, "mean_inference_ms": 1.2147840327368447, "mean_action_processing_ms": 0.14062046815341062, "mean_env_wait_ms": 0.08448700585787293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.11502599716186523}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6429999999998017, "episode_len_mean": 289.16, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 46.3, 37.50000000000003, 44.900000000000006, 40.30000000000002, 44.300000000000004, 45.5, 43.30000000000001, 45.5, 44.300000000000004, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 29.299999999999976, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, -50.00000000000044, 45.1, -50.00000000000044, 35.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.5, 21.299999999999862, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 43.7, 38.90000000000002, 43.900000000000006, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.29999999999999, 28.499999999999964, 32.90000000000003, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 43.7, 23.499999999999893, -50.00000000000044, 15.899999999999785, 36.30000000000003, 46.3, 36.50000000000003, 44.5, -50.00000000000044, 37.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 42.70000000000001, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, 39.70000000000002, 34.900000000000034, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 17.499999999999808, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.699999999999967], "episode_lengths": [500, 104, 38, 126, 52, 98, 58, 46, 68, 46, 58, 500, 306, 500, 500, 208, 500, 118, 500, 44, 500, 50, 500, 150, 86, 500, 500, 222, 500, 82, 72, 500, 500, 94, 500, 500, 264, 56, 288, 500, 148, 500, 182, 64, 112, 62, 500, 460, 500, 500, 148, 500, 500, 98, 198, 216, 172, 500, 32, 28, 500, 64, 266, 500, 342, 138, 38, 136, 56, 500, 128, 122, 500, 500, 500, 500, 500, 458, 500, 74, 38, 60, 500, 500, 500, 138, 500, 420, 500, 104, 152, 132, 500, 500, 294, 326, 500, 500, 62, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37948840907390946, "mean_inference_ms": 1.2147840327368447, "mean_action_processing_ms": 0.14062046815341062, "mean_env_wait_ms": 0.08448700585787293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.11502599716186523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5993.372616244759, "num_env_steps_trained_throughput_per_sec": 5993.372616244759, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2164.767, "sample_time_ms": 1941.592, "load_time_ms": 13.372, "load_throughput": 897383.676, "learn_time_ms": 198.41, "learn_throughput": 60480.718, "synch_weights_time_ms": 9.59}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4628, "training_iteration": 100, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-17", "timestamp": 1698249917, "time_this_iter_s": 2.0072083473205566, "time_total_s": 215.4835982322693, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.4835982322693, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420237e-31, "cur_lr": 0.0003, "total_loss": 6.776696946885851, "policy_loss": -1.785676512453291e-05, "vf_loss": 6.776766830020481, "vf_explained_var": -4.569689432779948e-07, "kl": 0.0001980207517059777, "entropy": 0.5183609359794192, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6699999999998085, "episode_len_mean": 283.92, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.099999999999618, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.29999999999999, 28.499999999999964, 32.90000000000003, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 43.7, 23.499999999999893, -50.00000000000044, 15.899999999999785, 36.30000000000003, 46.3, 36.50000000000003, 44.5, -50.00000000000044, 37.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 42.70000000000001, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, 39.70000000000002, 34.900000000000034, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 17.499999999999808, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.699999999999967, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, 1.099999999999575, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 40.10000000000002, 38.50000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 26.69999999999994, 35.900000000000034, 46.099999999999994, 46.5, 6.099999999999646, -50.00000000000044, 35.500000000000036, 24.69999999999991, 44.5, 42.70000000000001, 35.900000000000034, 9.8999999999997, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.29999999999996, 43.7, 40.70000000000002, -50.00000000000044, 43.7, 42.900000000000006, 37.300000000000026, 45.9, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044], "episode_lengths": [460, 500, 500, 148, 500, 500, 98, 198, 216, 172, 500, 32, 28, 500, 64, 266, 500, 342, 138, 38, 136, 56, 500, 128, 122, 500, 500, 500, 500, 500, 458, 500, 74, 38, 60, 500, 500, 500, 138, 500, 420, 500, 104, 152, 132, 500, 500, 294, 326, 500, 500, 62, 214, 500, 500, 126, 52, 490, 500, 44, 44, 500, 500, 88, 100, 116, 122, 500, 500, 76, 500, 234, 142, 40, 36, 440, 500, 146, 254, 56, 74, 142, 402, 500, 86, 500, 218, 64, 94, 500, 64, 72, 128, 42, 500, 128, 500, 84, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795618051096903, "mean_inference_ms": 1.2151379636748312, "mean_action_processing_ms": 0.1406763499027494, "mean_env_wait_ms": 0.08447967757490407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099442481994629, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.1259748935699463}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6699999999998085, "episode_len_mean": 283.92, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.099999999999618, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 30.29999999999999, 28.499999999999964, 32.90000000000003, -50.00000000000044, 46.9, 47.3, -50.00000000000044, 43.7, 23.499999999999893, -50.00000000000044, 15.899999999999785, 36.30000000000003, 46.3, 36.50000000000003, 44.5, -50.00000000000044, 37.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, 42.70000000000001, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, 39.70000000000002, 34.900000000000034, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 17.499999999999808, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.699999999999967, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, 1.099999999999575, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 40.10000000000002, 38.50000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 26.69999999999994, 35.900000000000034, 46.099999999999994, 46.5, 6.099999999999646, -50.00000000000044, 35.500000000000036, 24.69999999999991, 44.5, 42.70000000000001, 35.900000000000034, 9.8999999999997, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.29999999999996, 43.7, 40.70000000000002, -50.00000000000044, 43.7, 42.900000000000006, 37.300000000000026, 45.9, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044], "episode_lengths": [460, 500, 500, 148, 500, 500, 98, 198, 216, 172, 500, 32, 28, 500, 64, 266, 500, 342, 138, 38, 136, 56, 500, 128, 122, 500, 500, 500, 500, 500, 458, 500, 74, 38, 60, 500, 500, 500, 138, 500, 420, 500, 104, 152, 132, 500, 500, 294, 326, 500, 500, 62, 214, 500, 500, 126, 52, 490, 500, 44, 44, 500, 500, 88, 100, 116, 122, 500, 500, 76, 500, 234, 142, 40, 36, 440, 500, 146, 254, 56, 74, 142, 402, 500, 86, 500, 218, 64, 94, 500, 64, 72, 128, 42, 500, 128, 500, 84, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795618051096903, "mean_inference_ms": 1.2151379636748312, "mean_action_processing_ms": 0.1406763499027494, "mean_env_wait_ms": 0.08447967757490407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099442481994629, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.1259748935699463}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5684.928170974631, "num_env_steps_trained_throughput_per_sec": 5684.928170974631, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2147.662, "sample_time_ms": 1937.127, "load_time_ms": 12.675, "load_throughput": 946756.304, "learn_time_ms": 186.487, "learn_throughput": 64347.778, "synch_weights_time_ms": 9.671}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4675, "training_iteration": 101, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-19", "timestamp": 1698249919, "time_this_iter_s": 2.1158671379089355, "time_total_s": 217.59946537017822, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.59946537017822, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210118e-32, "cur_lr": 0.0003, "total_loss": 6.17628977033827, "policy_loss": -5.500970615280999e-05, "vf_loss": 6.1763978534274635, "vf_explained_var": -2.159012688530816e-06, "kl": 2.1263958400494528e-05, "entropy": 0.5321952833069695, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 914.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.879999999999808, "episode_len_mean": 281.82, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, 39.70000000000002, 34.900000000000034, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 17.499999999999808, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.699999999999967, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, 1.099999999999575, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 40.10000000000002, 38.50000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 26.69999999999994, 35.900000000000034, 46.099999999999994, 46.5, 6.099999999999646, -50.00000000000044, 35.500000000000036, 24.69999999999991, 44.5, 42.70000000000001, 35.900000000000034, 9.8999999999997, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.29999999999996, 43.7, 40.70000000000002, -50.00000000000044, 43.7, 42.900000000000006, 37.300000000000026, 45.9, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 37.90000000000003, 14.699999999999768, -50.00000000000044, 42.900000000000006, 35.900000000000034, 24.899999999999913, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, 44.900000000000006, 18.699999999999825, 41.100000000000016, 43.900000000000006, 39.70000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001], "episode_lengths": [138, 500, 420, 500, 104, 152, 132, 500, 500, 294, 326, 500, 500, 62, 214, 500, 500, 126, 52, 490, 500, 44, 44, 500, 500, 88, 100, 116, 122, 500, 500, 76, 500, 234, 142, 40, 36, 440, 500, 146, 254, 56, 74, 142, 402, 500, 86, 500, 218, 64, 94, 500, 64, 72, 128, 42, 500, 128, 500, 84, 74, 500, 500, 500, 50, 44, 122, 354, 500, 72, 142, 252, 126, 500, 500, 500, 500, 454, 500, 52, 314, 90, 62, 104, 500, 134, 50, 500, 30, 60, 500, 500, 52, 430, 500, 500, 500, 500, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793055349300309, "mean_inference_ms": 1.2151669070061974, "mean_action_processing_ms": 0.14046980877076234, "mean_env_wait_ms": 0.08447137222093133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026982545852661133, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12296485900878906}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.879999999999808, "episode_len_mean": 281.82, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 8.099999999999675, -50.00000000000044, 39.70000000000002, 34.900000000000034, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 17.499999999999808, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.699999999999967, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, 1.099999999999575, -50.00000000000044, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 40.10000000000002, 38.50000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 26.69999999999994, 35.900000000000034, 46.099999999999994, 46.5, 6.099999999999646, -50.00000000000044, 35.500000000000036, 24.69999999999991, 44.5, 42.70000000000001, 35.900000000000034, 9.8999999999997, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.29999999999996, 43.7, 40.70000000000002, -50.00000000000044, 43.7, 42.900000000000006, 37.300000000000026, 45.9, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 37.90000000000003, 14.699999999999768, -50.00000000000044, 42.900000000000006, 35.900000000000034, 24.899999999999913, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, 44.900000000000006, 18.699999999999825, 41.100000000000016, 43.900000000000006, 39.70000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001], "episode_lengths": [138, 500, 420, 500, 104, 152, 132, 500, 500, 294, 326, 500, 500, 62, 214, 500, 500, 126, 52, 490, 500, 44, 44, 500, 500, 88, 100, 116, 122, 500, 500, 76, 500, 234, 142, 40, 36, 440, 500, 146, 254, 56, 74, 142, 402, 500, 86, 500, 218, 64, 94, 500, 64, 72, 128, 42, 500, 128, 500, 84, 74, 500, 500, 500, 50, 44, 122, 354, 500, 72, 142, 252, 126, 500, 500, 500, 500, 454, 500, 52, 314, 90, 62, 104, 500, 134, 50, 500, 30, 60, 500, 500, 52, 430, 500, 500, 500, 500, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793055349300309, "mean_inference_ms": 1.2151669070061974, "mean_action_processing_ms": 0.14046980877076234, "mean_env_wait_ms": 0.08447137222093133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026982545852661133, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12296485900878906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5462.594068748289, "num_env_steps_trained_throughput_per_sec": 5462.594068748289, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2162.677, "sample_time_ms": 1938.792, "load_time_ms": 13.502, "load_throughput": 888728.857, "learn_time_ms": 199.207, "learn_throughput": 60238.747, "synch_weights_time_ms": 9.574}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4713, "training_iteration": 102, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-21", "timestamp": 1698249921, "time_this_iter_s": 2.2026207447052, "time_total_s": 219.80208611488342, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.80208611488342, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 60.26666666666667, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.944304526105059e-32, "cur_lr": 0.0003, "total_loss": 6.129530641767714, "policy_loss": 4.832032654020521e-05, "vf_loss": 6.129534986284044, "vf_explained_var": -9.801652696397569e-07, "kl": 8.89891590942524e-05, "entropy": 0.5252877142694261, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2009999999998104, "episode_len_mean": 273.6, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.8999999999997, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.29999999999996, 43.7, 40.70000000000002, -50.00000000000044, 43.7, 42.900000000000006, 37.300000000000026, 45.9, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 37.90000000000003, 14.699999999999768, -50.00000000000044, 42.900000000000006, 35.900000000000034, 24.899999999999913, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, 44.900000000000006, 18.699999999999825, 41.100000000000016, 43.900000000000006, 39.70000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.70000000000002, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 15.099999999999774, 43.7, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 41.90000000000001, 8.099999999999675, -50.00000000000044, -50.00000000000044, 29.299999999999976, 31.300000000000004, 43.30000000000001, 41.90000000000001, 32.100000000000016, -50.00000000000044, 43.10000000000001, 44.300000000000004, 44.900000000000006, 40.500000000000014, 43.30000000000001], "episode_lengths": [402, 500, 86, 500, 218, 64, 94, 500, 64, 72, 128, 42, 500, 128, 500, 84, 74, 500, 500, 500, 50, 44, 122, 354, 500, 72, 142, 252, 126, 500, 500, 500, 500, 454, 500, 52, 314, 90, 62, 104, 500, 134, 50, 500, 30, 60, 500, 500, 52, 430, 500, 500, 500, 500, 500, 68, 500, 38, 98, 500, 500, 124, 500, 104, 146, 500, 40, 500, 50, 78, 62, 52, 500, 500, 258, 500, 50, 500, 36, 350, 64, 500, 500, 220, 500, 82, 420, 500, 500, 208, 188, 68, 82, 180, 500, 70, 58, 52, 96, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793570922149598, "mean_inference_ms": 1.214964791500557, "mean_action_processing_ms": 0.1403875629698611, "mean_env_wait_ms": 0.08435540496826154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025985002517700195, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.11297965049743652}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2009999999998104, "episode_len_mean": 273.6, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.8999999999997, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.29999999999996, 43.7, 40.70000000000002, -50.00000000000044, 43.7, 42.900000000000006, 37.300000000000026, 45.9, -50.00000000000044, 37.300000000000026, -50.00000000000044, 41.70000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.7, 37.90000000000003, 14.699999999999768, -50.00000000000044, 42.900000000000006, 35.900000000000034, 24.899999999999913, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.699999999999626, -50.00000000000044, 44.900000000000006, 18.699999999999825, 41.100000000000016, 43.900000000000006, 39.70000000000002, -50.00000000000044, 36.70000000000003, 45.1, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.70000000000002, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 15.099999999999774, 43.7, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 41.90000000000001, 8.099999999999675, -50.00000000000044, -50.00000000000044, 29.299999999999976, 31.300000000000004, 43.30000000000001, 41.90000000000001, 32.100000000000016, -50.00000000000044, 43.10000000000001, 44.300000000000004, 44.900000000000006, 40.500000000000014, 43.30000000000001], "episode_lengths": [402, 500, 86, 500, 218, 64, 94, 500, 64, 72, 128, 42, 500, 128, 500, 84, 74, 500, 500, 500, 50, 44, 122, 354, 500, 72, 142, 252, 126, 500, 500, 500, 500, 454, 500, 52, 314, 90, 62, 104, 500, 134, 50, 500, 30, 60, 500, 500, 52, 430, 500, 500, 500, 500, 500, 68, 500, 38, 98, 500, 500, 124, 500, 104, 146, 500, 40, 500, 50, 78, 62, 52, 500, 500, 258, 500, 50, 500, 36, 350, 64, 500, 500, 220, 500, 82, 420, 500, 500, 208, 188, 68, 82, 180, 500, 70, 58, 52, 96, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793570922149598, "mean_inference_ms": 1.214964791500557, "mean_action_processing_ms": 0.1403875629698611, "mean_env_wait_ms": 0.08435540496826154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025985002517700195, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.11297965049743652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5933.747452038193, "num_env_steps_trained_throughput_per_sec": 5933.747452038193, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2148.836, "sample_time_ms": 1935.317, "load_time_ms": 12.202, "load_throughput": 983462.582, "learn_time_ms": 189.957, "learn_throughput": 63172.152, "synch_weights_time_ms": 9.759}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4757, "training_iteration": 103, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-23", "timestamp": 1698249923, "time_this_iter_s": 2.027329206466675, "time_total_s": 221.8294153213501, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.8294153213501, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 58.23333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525296e-32, "cur_lr": 0.0003, "total_loss": 6.890403376685248, "policy_loss": -0.00010983438955412971, "vf_loss": 6.890566137101915, "vf_explained_var": -6.622738308376736e-07, "kl": 8.007144464272642e-05, "entropy": 0.5305928190549215, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4159999999997985, "episode_len_mean": 286.44, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.70000000000002, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 15.099999999999774, 43.7, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 41.90000000000001, 8.099999999999675, -50.00000000000044, -50.00000000000044, 29.299999999999976, 31.300000000000004, 43.30000000000001, 41.90000000000001, 32.100000000000016, -50.00000000000044, 43.10000000000001, 44.300000000000004, 44.900000000000006, 40.500000000000014, 43.30000000000001, 41.90000000000001, -50.00000000000044, 45.3, 15.699999999999783, 5.099999999999632, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.90000000000002, 44.900000000000006, 46.5, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, 22.49999999999988, 31.70000000000001, 46.3, -50.00000000000044, 29.49999999999998, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 47.7, 2.699999999999598, 45.1, 35.10000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.099999999999973, 40.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 500, 500, 52, 430, 500, 500, 500, 500, 500, 68, 500, 38, 98, 500, 500, 124, 500, 104, 146, 500, 40, 500, 50, 78, 62, 52, 500, 500, 258, 500, 50, 500, 36, 350, 64, 500, 500, 220, 500, 82, 420, 500, 500, 208, 188, 68, 82, 180, 500, 70, 58, 52, 96, 68, 82, 500, 48, 344, 450, 476, 500, 62, 500, 92, 52, 36, 500, 110, 500, 500, 450, 276, 184, 38, 500, 206, 146, 500, 500, 118, 24, 474, 50, 150, 50, 500, 500, 500, 500, 96, 178, 500, 500, 86, 210, 96, 108, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37926845269312437, "mean_inference_ms": 1.2145379488140562, "mean_action_processing_ms": 0.14038395362224615, "mean_env_wait_ms": 0.08438676092032256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899765968322754, "StateBufferConnector_ms": 0.008011341094970703, "ViewRequirementAgentConnector_ms": 0.11516761779785156}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4159999999997985, "episode_len_mean": 286.44, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.70000000000002, 35.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 42.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 45.1, -50.00000000000044, 46.5, 15.099999999999774, 43.7, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, 41.90000000000001, 8.099999999999675, -50.00000000000044, -50.00000000000044, 29.299999999999976, 31.300000000000004, 43.30000000000001, 41.90000000000001, 32.100000000000016, -50.00000000000044, 43.10000000000001, 44.300000000000004, 44.900000000000006, 40.500000000000014, 43.30000000000001, 41.90000000000001, -50.00000000000044, 45.3, 15.699999999999783, 5.099999999999632, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.90000000000002, 44.900000000000006, 46.5, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, 22.49999999999988, 31.70000000000001, 46.3, -50.00000000000044, 29.49999999999998, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 47.7, 2.699999999999598, 45.1, 35.10000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.099999999999973, 40.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 500, 500, 52, 430, 500, 500, 500, 500, 500, 68, 500, 38, 98, 500, 500, 124, 500, 104, 146, 500, 40, 500, 50, 78, 62, 52, 500, 500, 258, 500, 50, 500, 36, 350, 64, 500, 500, 220, 500, 82, 420, 500, 500, 208, 188, 68, 82, 180, 500, 70, 58, 52, 96, 68, 82, 500, 48, 344, 450, 476, 500, 62, 500, 92, 52, 36, 500, 110, 500, 500, 450, 276, 184, 38, 500, 206, 146, 500, 500, 118, 24, 474, 50, 150, 50, 500, 500, 500, 500, 96, 178, 500, 500, 86, 210, 96, 108, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37926845269312437, "mean_inference_ms": 1.2145379488140562, "mean_action_processing_ms": 0.14038395362224615, "mean_env_wait_ms": 0.08438676092032256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899765968322754, "StateBufferConnector_ms": 0.008011341094970703, "ViewRequirementAgentConnector_ms": 0.11516761779785156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5644.169263912511, "num_env_steps_trained_throughput_per_sec": 5644.169263912511, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2130.883, "sample_time_ms": 1928.068, "load_time_ms": 12.09, "load_throughput": 992556.523, "learn_time_ms": 179.42, "learn_throughput": 66882.187, "synch_weights_time_ms": 9.704}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4802, "training_iteration": 104, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-25", "timestamp": 1698249925, "time_this_iter_s": 2.1328790187835693, "time_total_s": 223.96229434013367, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.96229434013367, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 59.03333333333333, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262648e-33, "cur_lr": 0.0003, "total_loss": 6.426674418979221, "policy_loss": -5.857046279642317e-05, "vf_loss": 6.426786634657118, "vf_explained_var": -1.0596381293402778e-06, "kl": 0.00018527406222624955, "entropy": 0.5358110533820258, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 941.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.536999999999816, "episode_len_mean": 270.26, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.299999999999976, 31.300000000000004, 43.30000000000001, 41.90000000000001, 32.100000000000016, -50.00000000000044, 43.10000000000001, 44.300000000000004, 44.900000000000006, 40.500000000000014, 43.30000000000001, 41.90000000000001, -50.00000000000044, 45.3, 15.699999999999783, 5.099999999999632, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.90000000000002, 44.900000000000006, 46.5, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, 22.49999999999988, 31.70000000000001, 46.3, -50.00000000000044, 29.49999999999998, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 47.7, 2.699999999999598, 45.1, 35.10000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.099999999999973, 40.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 37.10000000000003, -50.00000000000044, 37.90000000000003, 45.5, 24.899999999999913, 45.3, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 44.5, 43.7, 39.50000000000002, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 42.30000000000001, 46.3, 34.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.30000000000002, 42.70000000000001], "episode_lengths": [500, 500, 208, 188, 68, 82, 180, 500, 70, 58, 52, 96, 68, 82, 500, 48, 344, 450, 476, 500, 62, 500, 92, 52, 36, 500, 110, 500, 500, 450, 276, 184, 38, 500, 206, 146, 500, 500, 118, 24, 474, 50, 150, 50, 500, 500, 500, 500, 96, 178, 500, 500, 86, 210, 96, 108, 500, 500, 500, 28, 500, 500, 500, 500, 44, 118, 130, 500, 122, 46, 252, 48, 500, 36, 54, 500, 56, 64, 106, 468, 500, 500, 38, 110, 78, 38, 152, 60, 500, 500, 220, 500, 500, 66, 500, 500, 258, 500, 98, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789626503517792, "mean_inference_ms": 1.2146318120827801, "mean_action_processing_ms": 0.14018542847903212, "mean_env_wait_ms": 0.08434430135553182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499627113342285, "StateBufferConnector_ms": 0.009015083312988281, "ViewRequirementAgentConnector_ms": 0.1231544017791748}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.536999999999816, "episode_len_mean": 270.26, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 29.299999999999976, 31.300000000000004, 43.30000000000001, 41.90000000000001, 32.100000000000016, -50.00000000000044, 43.10000000000001, 44.300000000000004, 44.900000000000006, 40.500000000000014, 43.30000000000001, 41.90000000000001, -50.00000000000044, 45.3, 15.699999999999783, 5.099999999999632, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.90000000000002, 44.900000000000006, 46.5, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, 22.49999999999988, 31.70000000000001, 46.3, -50.00000000000044, 29.49999999999998, 35.500000000000036, -50.00000000000044, -50.00000000000044, 38.300000000000026, 47.7, 2.699999999999598, 45.1, 35.10000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 32.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.099999999999973, 40.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 37.10000000000003, -50.00000000000044, 37.90000000000003, 45.5, 24.899999999999913, 45.3, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 44.5, 43.7, 39.50000000000002, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 42.30000000000001, 46.3, 34.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.30000000000002, 42.70000000000001], "episode_lengths": [500, 500, 208, 188, 68, 82, 180, 500, 70, 58, 52, 96, 68, 82, 500, 48, 344, 450, 476, 500, 62, 500, 92, 52, 36, 500, 110, 500, 500, 450, 276, 184, 38, 500, 206, 146, 500, 500, 118, 24, 474, 50, 150, 50, 500, 500, 500, 500, 96, 178, 500, 500, 86, 210, 96, 108, 500, 500, 500, 28, 500, 500, 500, 500, 44, 118, 130, 500, 122, 46, 252, 48, 500, 36, 54, 500, 56, 64, 106, 468, 500, 500, 38, 110, 78, 38, 152, 60, 500, 500, 220, 500, 500, 66, 500, 500, 258, 500, 98, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789626503517792, "mean_inference_ms": 1.2146318120827801, "mean_action_processing_ms": 0.14018542847903212, "mean_env_wait_ms": 0.08434430135553182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499627113342285, "StateBufferConnector_ms": 0.009015083312988281, "ViewRequirementAgentConnector_ms": 0.1231544017791748}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5808.088037253632, "num_env_steps_trained_throughput_per_sec": 5808.088037253632, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2132.286, "sample_time_ms": 1929.647, "load_time_ms": 12.191, "load_throughput": 984301.136, "learn_time_ms": 179.142, "learn_throughput": 66985.824, "synch_weights_time_ms": 9.704}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4844, "training_iteration": 105, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-27", "timestamp": 1698249927, "time_this_iter_s": 2.0720741748809814, "time_total_s": 226.03436851501465, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 226.03436851501465, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 60.76666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.930380657631324e-33, "cur_lr": 0.0003, "total_loss": 6.657166586981879, "policy_loss": -0.0001920968708064821, "vf_loss": 6.657415178087023, "vf_explained_var": -6.755193074544271e-07, "kl": 0.00020266228568743827, "entropy": 0.5643541084395515, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 950.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.5919999999998256, "episode_len_mean": 264.7, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.099999999999973, 40.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 37.10000000000003, -50.00000000000044, 37.90000000000003, 45.5, 24.899999999999913, 45.3, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 44.5, 43.7, 39.50000000000002, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 42.30000000000001, 46.3, 34.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.30000000000002, 42.70000000000001, 33.30000000000003, 42.10000000000001, -50.00000000000044, 38.700000000000024, 33.500000000000036, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.300000000000026, 45.7, -50.00000000000044, 35.70000000000003, 46.3, 45.7, 40.70000000000002, 44.10000000000001, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, 28.09999999999996, 40.90000000000002, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, 41.70000000000002, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.500000000000007, -50.00000000000044, 42.900000000000006, 43.7, 33.30000000000003, 10.299999999999706, 27.699999999999953, -50.00000000000044, -50.00000000000044], "episode_lengths": [178, 500, 500, 86, 210, 96, 108, 500, 500, 500, 28, 500, 500, 500, 500, 44, 118, 130, 500, 122, 46, 252, 48, 500, 36, 54, 500, 56, 64, 106, 468, 500, 500, 38, 110, 78, 38, 152, 60, 500, 500, 220, 500, 500, 66, 500, 500, 258, 500, 98, 74, 168, 80, 500, 114, 166, 350, 500, 500, 40, 500, 118, 500, 108, 44, 500, 144, 38, 44, 94, 60, 500, 146, 92, 500, 220, 92, 42, 176, 500, 500, 92, 66, 84, 168, 54, 500, 500, 500, 500, 116, 186, 500, 72, 64, 168, 398, 224, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900454205310163, "mean_inference_ms": 1.2145992561598353, "mean_action_processing_ms": 0.14013880504846196, "mean_env_wait_ms": 0.08443628945171648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.1421527862548828}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.5919999999998256, "episode_len_mean": 264.7, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 29.099999999999973, 40.500000000000014, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 38.300000000000026, 37.10000000000003, -50.00000000000044, 37.90000000000003, 45.5, 24.899999999999913, 45.3, -50.00000000000044, 46.5, 44.7, -50.00000000000044, 44.5, 43.7, 39.50000000000002, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 42.30000000000001, 46.3, 34.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.30000000000002, 42.70000000000001, 33.30000000000003, 42.10000000000001, -50.00000000000044, 38.700000000000024, 33.500000000000036, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.300000000000026, 45.7, -50.00000000000044, 35.70000000000003, 46.3, 45.7, 40.70000000000002, 44.10000000000001, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, 28.09999999999996, 40.90000000000002, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, 41.70000000000002, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.500000000000007, -50.00000000000044, 42.900000000000006, 43.7, 33.30000000000003, 10.299999999999706, 27.699999999999953, -50.00000000000044, -50.00000000000044], "episode_lengths": [178, 500, 500, 86, 210, 96, 108, 500, 500, 500, 28, 500, 500, 500, 500, 44, 118, 130, 500, 122, 46, 252, 48, 500, 36, 54, 500, 56, 64, 106, 468, 500, 500, 38, 110, 78, 38, 152, 60, 500, 500, 220, 500, 500, 66, 500, 500, 258, 500, 98, 74, 168, 80, 500, 114, 166, 350, 500, 500, 40, 500, 118, 500, 108, 44, 500, 144, 38, 44, 94, 60, 500, 146, 92, 500, 220, 92, 42, 176, 500, 500, 92, 66, 84, 168, 54, 500, 500, 500, 500, 116, 186, 500, 72, 64, 168, 398, 224, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900454205310163, "mean_inference_ms": 1.2145992561598353, "mean_action_processing_ms": 0.14013880504846196, "mean_env_wait_ms": 0.08443628945171648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.1421527862548828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5324.733917486782, "num_env_steps_trained_throughput_per_sec": 5324.733917486782, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2131.892, "sample_time_ms": 1924.805, "load_time_ms": 12.167, "load_throughput": 986268.488, "learn_time_ms": 183.668, "learn_throughput": 65335.137, "synch_weights_time_ms": 9.749}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4893, "training_iteration": 106, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-30", "timestamp": 1698249930, "time_this_iter_s": 2.2586281299591064, "time_total_s": 228.29299664497375, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.29299664497375, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.465190328815662e-33, "cur_lr": 0.0003, "total_loss": 6.84245671166314, "policy_loss": 2.7199172311358983e-05, "vf_loss": 6.842487176259358, "vf_explained_var": -9.801652696397569e-07, "kl": 8.607037024274986e-05, "entropy": 0.5757123695479499, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.61999999999982, "episode_len_mean": 274.42, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.30000000000002, 42.70000000000001, 33.30000000000003, 42.10000000000001, -50.00000000000044, 38.700000000000024, 33.500000000000036, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.300000000000026, 45.7, -50.00000000000044, 35.70000000000003, 46.3, 45.7, 40.70000000000002, 44.10000000000001, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, 28.09999999999996, 40.90000000000002, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, 41.70000000000002, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.500000000000007, -50.00000000000044, 42.900000000000006, 43.7, 33.30000000000003, 10.299999999999706, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 40.90000000000002, 38.300000000000026, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 19.899999999999842, 16.699999999999797, 26.89999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.70000000000003, 45.1, 39.10000000000002, 24.499999999999908, -50.00000000000044, 46.5, -50.00000000000044, 24.499999999999908, -50.00000000000044, 3.499999999999609, 45.7, 44.7, 41.90000000000001, 17.69999999999981], "episode_lengths": [500, 500, 66, 500, 500, 258, 500, 98, 74, 168, 80, 500, 114, 166, 350, 500, 500, 40, 500, 118, 500, 108, 44, 500, 144, 38, 44, 94, 60, 500, 146, 92, 500, 220, 92, 42, 176, 500, 500, 92, 66, 84, 168, 54, 500, 500, 500, 500, 116, 186, 500, 72, 64, 168, 398, 224, 500, 500, 500, 290, 134, 500, 500, 500, 44, 76, 140, 500, 500, 500, 500, 130, 500, 92, 118, 72, 64, 500, 500, 302, 334, 232, 38, 500, 500, 40, 134, 50, 110, 256, 500, 36, 500, 256, 500, 466, 44, 54, 82, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788631668100553, "mean_inference_ms": 1.2145295061614179, "mean_action_processing_ms": 0.14029020871395714, "mean_env_wait_ms": 0.08440250923728651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024000167846679688, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.13399076461791992}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.61999999999982, "episode_len_mean": 274.42, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.30000000000002, 42.70000000000001, 33.30000000000003, 42.10000000000001, -50.00000000000044, 38.700000000000024, 33.500000000000036, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.300000000000026, 45.7, -50.00000000000044, 35.70000000000003, 46.3, 45.7, 40.70000000000002, 44.10000000000001, -50.00000000000044, 35.500000000000036, 40.90000000000002, -50.00000000000044, 28.09999999999996, 40.90000000000002, 45.9, 32.50000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, 41.70000000000002, 33.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 31.500000000000007, -50.00000000000044, 42.900000000000006, 43.7, 33.30000000000003, 10.299999999999706, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 40.90000000000002, 38.300000000000026, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 19.899999999999842, 16.699999999999797, 26.89999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.70000000000003, 45.1, 39.10000000000002, 24.499999999999908, -50.00000000000044, 46.5, -50.00000000000044, 24.499999999999908, -50.00000000000044, 3.499999999999609, 45.7, 44.7, 41.90000000000001, 17.69999999999981], "episode_lengths": [500, 500, 66, 500, 500, 258, 500, 98, 74, 168, 80, 500, 114, 166, 350, 500, 500, 40, 500, 118, 500, 108, 44, 500, 144, 38, 44, 94, 60, 500, 146, 92, 500, 220, 92, 42, 176, 500, 500, 92, 66, 84, 168, 54, 500, 500, 500, 500, 116, 186, 500, 72, 64, 168, 398, 224, 500, 500, 500, 290, 134, 500, 500, 500, 44, 76, 140, 500, 500, 500, 500, 130, 500, 92, 118, 72, 64, 500, 500, 302, 334, 232, 38, 500, 500, 40, 134, 50, 110, 256, 500, 36, 500, 256, 500, 466, 44, 54, 82, 324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788631668100553, "mean_inference_ms": 1.2145295061614179, "mean_action_processing_ms": 0.14029020871395714, "mean_env_wait_ms": 0.08440250923728651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024000167846679688, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.13399076461791992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5974.643082259346, "num_env_steps_trained_throughput_per_sec": 5974.643082259346, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2112.737, "sample_time_ms": 1905.904, "load_time_ms": 12.462, "load_throughput": 962962.606, "learn_time_ms": 183.221, "learn_throughput": 65494.52, "synch_weights_time_ms": 9.848}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4935, "training_iteration": 107, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-32", "timestamp": 1698249932, "time_this_iter_s": 2.0134847164154053, "time_total_s": 230.30648136138916, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.30648136138916, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 59.666666666666664, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.232595164407831e-33, "cur_lr": 0.0003, "total_loss": 6.915054692162408, "policy_loss": -6.561040774815613e-05, "vf_loss": 6.915179252624512, "vf_explained_var": -1.5629662407769097e-06, "kl": 5.6822374362910625e-05, "entropy": 0.5894282791349623, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.005999999999837, "episode_len_mean": 260.62, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 43.7, 33.30000000000003, 10.299999999999706, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 40.90000000000002, 38.300000000000026, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 19.899999999999842, 16.699999999999797, 26.89999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.70000000000003, 45.1, 39.10000000000002, 24.499999999999908, -50.00000000000044, 46.5, -50.00000000000044, 24.499999999999908, -50.00000000000044, 3.499999999999609, 45.7, 44.7, 41.90000000000001, 17.69999999999981, -50.00000000000044, -50.00000000000044, 46.9, 36.30000000000003, 44.5, -50.00000000000044, 20.299999999999848, 43.10000000000001, 38.300000000000026, 42.30000000000001, 19.499999999999837, 39.70000000000002, 30.29999999999999, 42.10000000000001, 43.30000000000001, 36.50000000000003, 41.30000000000001, 43.900000000000006, 29.899999999999984, 47.1, 32.100000000000016, 36.70000000000003, 44.7, 36.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 6.699999999999655, 40.10000000000002, 16.699999999999797, 39.10000000000002, 35.900000000000034, 40.90000000000002, 41.70000000000002, -50.00000000000044, 37.300000000000026, 18.699999999999825, 34.50000000000004], "episode_lengths": [500, 72, 64, 168, 398, 224, 500, 500, 500, 290, 134, 500, 500, 500, 44, 76, 140, 500, 500, 500, 500, 130, 500, 92, 118, 72, 64, 500, 500, 302, 334, 232, 38, 500, 500, 40, 134, 50, 110, 256, 500, 36, 500, 256, 500, 466, 44, 54, 82, 324, 500, 500, 32, 138, 56, 500, 298, 70, 118, 78, 306, 104, 198, 80, 68, 136, 88, 62, 202, 30, 180, 134, 54, 138, 54, 500, 500, 500, 348, 78, 500, 500, 500, 108, 118, 500, 500, 48, 500, 434, 100, 334, 110, 142, 92, 84, 500, 128, 314, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789744612409088, "mean_inference_ms": 1.2148285533811207, "mean_action_processing_ms": 0.1403446302197933, "mean_env_wait_ms": 0.08438768128285744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999048233032227, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.1049952507019043}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.005999999999837, "episode_len_mean": 260.62, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 43.7, 33.30000000000003, 10.299999999999706, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 40.90000000000002, 38.300000000000026, 42.900000000000006, 43.7, -50.00000000000044, -50.00000000000044, 19.899999999999842, 16.699999999999797, 26.89999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.70000000000003, 45.1, 39.10000000000002, 24.499999999999908, -50.00000000000044, 46.5, -50.00000000000044, 24.499999999999908, -50.00000000000044, 3.499999999999609, 45.7, 44.7, 41.90000000000001, 17.69999999999981, -50.00000000000044, -50.00000000000044, 46.9, 36.30000000000003, 44.5, -50.00000000000044, 20.299999999999848, 43.10000000000001, 38.300000000000026, 42.30000000000001, 19.499999999999837, 39.70000000000002, 30.29999999999999, 42.10000000000001, 43.30000000000001, 36.50000000000003, 41.30000000000001, 43.900000000000006, 29.899999999999984, 47.1, 32.100000000000016, 36.70000000000003, 44.7, 36.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 6.699999999999655, 40.10000000000002, 16.699999999999797, 39.10000000000002, 35.900000000000034, 40.90000000000002, 41.70000000000002, -50.00000000000044, 37.300000000000026, 18.699999999999825, 34.50000000000004], "episode_lengths": [500, 72, 64, 168, 398, 224, 500, 500, 500, 290, 134, 500, 500, 500, 44, 76, 140, 500, 500, 500, 500, 130, 500, 92, 118, 72, 64, 500, 500, 302, 334, 232, 38, 500, 500, 40, 134, 50, 110, 256, 500, 36, 500, 256, 500, 466, 44, 54, 82, 324, 500, 500, 32, 138, 56, 500, 298, 70, 118, 78, 306, 104, 198, 80, 68, 136, 88, 62, 202, 30, 180, 134, 54, 138, 54, 500, 500, 500, 348, 78, 500, 500, 500, 108, 118, 500, 500, 48, 500, 434, 100, 334, 110, 142, 92, 84, 500, 128, 314, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789744612409088, "mean_inference_ms": 1.2148285533811207, "mean_action_processing_ms": 0.1403446302197933, "mean_env_wait_ms": 0.08438768128285744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999048233032227, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.1049952507019043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5706.504351619816, "num_env_steps_trained_throughput_per_sec": 5706.504351619816, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2111.562, "sample_time_ms": 1905.783, "load_time_ms": 12.168, "load_throughput": 986198.918, "learn_time_ms": 182.364, "learn_throughput": 65802.354, "synch_weights_time_ms": 9.945}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4985, "training_iteration": 108, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-34", "timestamp": 1698249934, "time_this_iter_s": 2.10760760307312, "time_total_s": 232.41408896446228, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.41408896446228, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039155e-34, "cur_lr": 0.0003, "total_loss": 6.72381575902303, "policy_loss": 5.139907201131185e-05, "vf_loss": 6.723821534050836, "vf_explained_var": -1.430511474609375e-06, "kl": 4.697685507279756e-05, "entropy": 0.571735229757097, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 977.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.10299999999983, "episode_len_mean": 264.64, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.499999999999908, -50.00000000000044, 3.499999999999609, 45.7, 44.7, 41.90000000000001, 17.69999999999981, -50.00000000000044, -50.00000000000044, 46.9, 36.30000000000003, 44.5, -50.00000000000044, 20.299999999999848, 43.10000000000001, 38.300000000000026, 42.30000000000001, 19.499999999999837, 39.70000000000002, 30.29999999999999, 42.10000000000001, 43.30000000000001, 36.50000000000003, 41.30000000000001, 43.900000000000006, 29.899999999999984, 47.1, 32.100000000000016, 36.70000000000003, 44.7, 36.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 6.699999999999655, 40.10000000000002, 16.699999999999797, 39.10000000000002, 35.900000000000034, 40.90000000000002, 41.70000000000002, -50.00000000000044, 37.300000000000026, 18.699999999999825, 34.50000000000004, 42.900000000000006, 27.299999999999947, 37.10000000000003, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.099999999999888, 45.3, 40.500000000000014, 31.1, 40.90000000000002, -50.00000000000044, 21.499999999999865, 40.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 4.699999999999626, 36.70000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5], "episode_lengths": [500, 256, 500, 466, 44, 54, 82, 324, 500, 500, 32, 138, 56, 500, 298, 70, 118, 78, 306, 104, 198, 80, 68, 136, 88, 62, 202, 30, 180, 134, 54, 138, 54, 500, 500, 500, 348, 78, 500, 500, 500, 108, 118, 500, 500, 48, 500, 434, 100, 334, 110, 142, 92, 84, 500, 128, 314, 156, 72, 228, 130, 500, 354, 500, 500, 70, 500, 270, 48, 96, 190, 92, 500, 286, 96, 40, 500, 500, 500, 500, 500, 62, 500, 500, 30, 500, 454, 134, 72, 58, 500, 320, 500, 124, 500, 500, 500, 126, 122, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788462184274715, "mean_inference_ms": 1.214813870152207, "mean_action_processing_ms": 0.1402602891097305, "mean_env_wait_ms": 0.0842455064017053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027003765106201172, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.09237360954284668}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.10299999999983, "episode_len_mean": 264.64, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.499999999999908, -50.00000000000044, 3.499999999999609, 45.7, 44.7, 41.90000000000001, 17.69999999999981, -50.00000000000044, -50.00000000000044, 46.9, 36.30000000000003, 44.5, -50.00000000000044, 20.299999999999848, 43.10000000000001, 38.300000000000026, 42.30000000000001, 19.499999999999837, 39.70000000000002, 30.29999999999999, 42.10000000000001, 43.30000000000001, 36.50000000000003, 41.30000000000001, 43.900000000000006, 29.899999999999984, 47.1, 32.100000000000016, 36.70000000000003, 44.7, 36.30000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 6.699999999999655, 40.10000000000002, 16.699999999999797, 39.10000000000002, 35.900000000000034, 40.90000000000002, 41.70000000000002, -50.00000000000044, 37.300000000000026, 18.699999999999825, 34.50000000000004, 42.900000000000006, 27.299999999999947, 37.10000000000003, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.099999999999888, 45.3, 40.500000000000014, 31.1, 40.90000000000002, -50.00000000000044, 21.499999999999865, 40.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 4.699999999999626, 36.70000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5], "episode_lengths": [500, 256, 500, 466, 44, 54, 82, 324, 500, 500, 32, 138, 56, 500, 298, 70, 118, 78, 306, 104, 198, 80, 68, 136, 88, 62, 202, 30, 180, 134, 54, 138, 54, 500, 500, 500, 348, 78, 500, 500, 500, 108, 118, 500, 500, 48, 500, 434, 100, 334, 110, 142, 92, 84, 500, 128, 314, 156, 72, 228, 130, 500, 354, 500, 500, 70, 500, 270, 48, 96, 190, 92, 500, 286, 96, 40, 500, 500, 500, 500, 500, 62, 500, 500, 30, 500, 454, 134, 72, 58, 500, 320, 500, 124, 500, 500, 500, 126, 122, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788462184274715, "mean_inference_ms": 1.214813870152207, "mean_action_processing_ms": 0.1402602891097305, "mean_env_wait_ms": 0.0842455064017053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027003765106201172, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.09237360954284668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5373.696483531008, "num_env_steps_trained_throughput_per_sec": 5373.696483531008, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2112.24, "sample_time_ms": 1903.992, "load_time_ms": 11.665, "load_throughput": 1028730.082, "learn_time_ms": 185.328, "learn_throughput": 64750.112, "synch_weights_time_ms": 9.854}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 5027, "training_iteration": 109, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-36", "timestamp": 1698249936, "time_this_iter_s": 2.238473653793335, "time_total_s": 234.65256261825562, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.65256261825562, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 59.800000000000004, "ram_util_percent": 27.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195775e-34, "cur_lr": 0.0003, "total_loss": 7.398371749454075, "policy_loss": -0.00023093074560165405, "vf_loss": 7.39866468641493, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.00016327381461936043, "entropy": 0.6190969149271647, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.915999999999825, "episode_len_mean": 271.48, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 16.699999999999797, 39.10000000000002, 35.900000000000034, 40.90000000000002, 41.70000000000002, -50.00000000000044, 37.300000000000026, 18.699999999999825, 34.50000000000004, 42.900000000000006, 27.299999999999947, 37.10000000000003, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.099999999999888, 45.3, 40.500000000000014, 31.1, 40.90000000000002, -50.00000000000044, 21.499999999999865, 40.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 4.699999999999626, 36.70000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 11.499999999999723, 37.90000000000003, 34.10000000000004, 45.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 25.499999999999922, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.500000000000014, 43.900000000000006, 29.299999999999976, 44.300000000000004, -50.00000000000044, 44.5, 34.70000000000004, 37.50000000000003, 39.90000000000002, 45.7, 45.7, 13.699999999999754, -50.00000000000044, 31.500000000000007, -50.00000000000044, 42.500000000000014, 19.69999999999984, 43.50000000000001, 44.5, 43.30000000000001, 36.900000000000034, -50.00000000000044, 38.10000000000002, 33.70000000000004, 39.70000000000002], "episode_lengths": [100, 334, 110, 142, 92, 84, 500, 128, 314, 156, 72, 228, 130, 500, 354, 500, 500, 70, 500, 270, 48, 96, 190, 92, 500, 286, 96, 40, 500, 500, 500, 500, 500, 62, 500, 500, 30, 500, 454, 134, 72, 58, 500, 320, 500, 124, 500, 500, 500, 126, 122, 46, 500, 500, 500, 500, 500, 500, 500, 148, 386, 122, 160, 42, 500, 226, 500, 120, 500, 500, 246, 82, 500, 46, 500, 96, 62, 208, 58, 500, 56, 154, 126, 102, 44, 44, 364, 500, 186, 500, 76, 304, 66, 56, 68, 132, 500, 120, 164, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37887804976871164, "mean_inference_ms": 1.2146215493340349, "mean_action_processing_ms": 0.14030925825422436, "mean_env_wait_ms": 0.08426189113604093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028012752532958984, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.09542155265808105}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.915999999999825, "episode_len_mean": 271.48, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 16.699999999999797, 39.10000000000002, 35.900000000000034, 40.90000000000002, 41.70000000000002, -50.00000000000044, 37.300000000000026, 18.699999999999825, 34.50000000000004, 42.900000000000006, 27.299999999999947, 37.10000000000003, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.099999999999888, 45.3, 40.500000000000014, 31.1, 40.90000000000002, -50.00000000000044, 21.499999999999865, 40.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 4.699999999999626, 36.70000000000003, 42.900000000000006, 44.300000000000004, -50.00000000000044, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 11.499999999999723, 37.90000000000003, 34.10000000000004, 45.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 25.499999999999922, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.500000000000014, 43.900000000000006, 29.299999999999976, 44.300000000000004, -50.00000000000044, 44.5, 34.70000000000004, 37.50000000000003, 39.90000000000002, 45.7, 45.7, 13.699999999999754, -50.00000000000044, 31.500000000000007, -50.00000000000044, 42.500000000000014, 19.69999999999984, 43.50000000000001, 44.5, 43.30000000000001, 36.900000000000034, -50.00000000000044, 38.10000000000002, 33.70000000000004, 39.70000000000002], "episode_lengths": [100, 334, 110, 142, 92, 84, 500, 128, 314, 156, 72, 228, 130, 500, 354, 500, 500, 70, 500, 270, 48, 96, 190, 92, 500, 286, 96, 40, 500, 500, 500, 500, 500, 62, 500, 500, 30, 500, 454, 134, 72, 58, 500, 320, 500, 124, 500, 500, 500, 126, 122, 46, 500, 500, 500, 500, 500, 500, 500, 148, 386, 122, 160, 42, 500, 226, 500, 120, 500, 500, 246, 82, 500, 46, 500, 96, 62, 208, 58, 500, 56, 154, 126, 102, 44, 44, 364, 500, 186, 500, 76, 304, 66, 56, 68, 132, 500, 120, 164, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37887804976871164, "mean_inference_ms": 1.2146215493340349, "mean_action_processing_ms": 0.14030925825422436, "mean_env_wait_ms": 0.08426189113604093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028012752532958984, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.09542155265808105}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4748.445626039838, "num_env_steps_trained_throughput_per_sec": 4748.445626039838, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2164.733, "sample_time_ms": 1947.937, "load_time_ms": 11.845, "load_throughput": 1013070.007, "learn_time_ms": 193.593, "learn_throughput": 61985.574, "synch_weights_time_ms": 9.957}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5075, "training_iteration": 110, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-39", "timestamp": 1698249939, "time_this_iter_s": 2.5321433544158936, "time_total_s": 237.1847059726715, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 237.1847059726715, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097888e-34, "cur_lr": 0.0003, "total_loss": 6.448862552642822, "policy_loss": -0.00043285638093948364, "vf_loss": 6.449352317386204, "vf_explained_var": -1.3510386149088542e-06, "kl": 0.00041109230723021837, "entropy": 0.5667472547954984, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 995.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.698999999999837, "episode_len_mean": 258.66, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 11.499999999999723, 37.90000000000003, 34.10000000000004, 45.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 25.499999999999922, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.500000000000014, 43.900000000000006, 29.299999999999976, 44.300000000000004, -50.00000000000044, 44.5, 34.70000000000004, 37.50000000000003, 39.90000000000002, 45.7, 45.7, 13.699999999999754, -50.00000000000044, 31.500000000000007, -50.00000000000044, 42.500000000000014, 19.69999999999984, 43.50000000000001, 44.5, 43.30000000000001, 36.900000000000034, -50.00000000000044, 38.10000000000002, 33.70000000000004, 39.70000000000002, 34.30000000000004, 11.899999999999729, 30.499999999999993, 42.10000000000001, 44.900000000000006, 38.50000000000003, 43.900000000000006, 22.49999999999988, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 30.9, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, 6.699999999999655, 43.50000000000001, -50.00000000000044, 44.900000000000006, 41.100000000000016, 28.89999999999997, 32.100000000000016, 43.7, 45.3, 44.7, -50.00000000000044, 41.90000000000001, 46.699999999999996, 42.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 500, 500, 500, 126, 122, 46, 500, 500, 500, 500, 500, 500, 500, 148, 386, 122, 160, 42, 500, 226, 500, 120, 500, 500, 246, 82, 500, 46, 500, 96, 62, 208, 58, 500, 56, 154, 126, 102, 44, 44, 364, 500, 186, 500, 76, 304, 66, 56, 68, 132, 500, 120, 164, 104, 158, 382, 196, 80, 52, 116, 62, 276, 164, 500, 54, 500, 500, 500, 120, 500, 82, 500, 64, 500, 134, 500, 192, 500, 160, 70, 500, 434, 66, 500, 52, 90, 212, 180, 64, 48, 54, 500, 82, 34, 76, 500, 26, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790808381399063, "mean_inference_ms": 1.21445246395779, "mean_action_processing_ms": 0.14021898095937288, "mean_env_wait_ms": 0.08435402731067032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032019853591918945, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.11499238014221191}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.698999999999837, "episode_len_mean": 258.66, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 11.499999999999723, 37.90000000000003, 34.10000000000004, 45.9, -50.00000000000044, 27.49999999999995, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 25.499999999999922, 41.90000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.500000000000014, 43.900000000000006, 29.299999999999976, 44.300000000000004, -50.00000000000044, 44.5, 34.70000000000004, 37.50000000000003, 39.90000000000002, 45.7, 45.7, 13.699999999999754, -50.00000000000044, 31.500000000000007, -50.00000000000044, 42.500000000000014, 19.69999999999984, 43.50000000000001, 44.5, 43.30000000000001, 36.900000000000034, -50.00000000000044, 38.10000000000002, 33.70000000000004, 39.70000000000002, 34.30000000000004, 11.899999999999729, 30.499999999999993, 42.10000000000001, 44.900000000000006, 38.50000000000003, 43.900000000000006, 22.49999999999988, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 30.9, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, 6.699999999999655, 43.50000000000001, -50.00000000000044, 44.900000000000006, 41.100000000000016, 28.89999999999997, 32.100000000000016, 43.7, 45.3, 44.7, -50.00000000000044, 41.90000000000001, 46.699999999999996, 42.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 500, 500, 500, 126, 122, 46, 500, 500, 500, 500, 500, 500, 500, 148, 386, 122, 160, 42, 500, 226, 500, 120, 500, 500, 246, 82, 500, 46, 500, 96, 62, 208, 58, 500, 56, 154, 126, 102, 44, 44, 364, 500, 186, 500, 76, 304, 66, 56, 68, 132, 500, 120, 164, 104, 158, 382, 196, 80, 52, 116, 62, 276, 164, 500, 54, 500, 500, 500, 120, 500, 82, 500, 64, 500, 134, 500, 192, 500, 160, 70, 500, 434, 66, 500, 52, 90, 212, 180, 64, 48, 54, 500, 82, 34, 76, 500, 26, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790808381399063, "mean_inference_ms": 1.21445246395779, "mean_action_processing_ms": 0.14021898095937288, "mean_env_wait_ms": 0.08435402731067032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032019853591918945, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.11499238014221191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5469.382512480118, "num_env_steps_trained_throughput_per_sec": 5469.382512480118, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2173.052, "sample_time_ms": 1944.842, "load_time_ms": 12.449, "load_throughput": 963971.44, "learn_time_ms": 204.585, "learn_throughput": 58655.38, "synch_weights_time_ms": 9.876}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5120, "training_iteration": 111, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-41", "timestamp": 1698249941, "time_this_iter_s": 2.200031042098999, "time_total_s": 239.3847370147705, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.3847370147705, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 49.23333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548944e-35, "cur_lr": 0.0003, "total_loss": 6.438742372724745, "policy_loss": 6.255921390321519e-05, "vf_loss": 6.438733471764459, "vf_explained_var": -3.4438239203559027e-07, "kl": 0.00024481553997348883, "entropy": 0.5368833078278435, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1004.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.303999999999846, "episode_len_mean": 247.64, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 19.69999999999984, 43.50000000000001, 44.5, 43.30000000000001, 36.900000000000034, -50.00000000000044, 38.10000000000002, 33.70000000000004, 39.70000000000002, 34.30000000000004, 11.899999999999729, 30.499999999999993, 42.10000000000001, 44.900000000000006, 38.50000000000003, 43.900000000000006, 22.49999999999988, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 30.9, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, 6.699999999999655, 43.50000000000001, -50.00000000000044, 44.900000000000006, 41.100000000000016, 28.89999999999997, 32.100000000000016, 43.7, 45.3, 44.7, -50.00000000000044, 41.90000000000001, 46.699999999999996, 42.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 42.500000000000014, 20.899999999999856, 38.50000000000003, 40.500000000000014, 40.70000000000002, 42.900000000000006, -50.00000000000044, 43.7, 35.70000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 34.10000000000004, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, 42.500000000000014, 27.299999999999947, 44.7, -50.00000000000044, 25.29999999999992, -50.00000000000044, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, 40.500000000000014, 36.70000000000003, 43.900000000000006, 40.90000000000002], "episode_lengths": [76, 304, 66, 56, 68, 132, 500, 120, 164, 104, 158, 382, 196, 80, 52, 116, 62, 276, 164, 500, 54, 500, 500, 500, 120, 500, 82, 500, 64, 500, 134, 500, 192, 500, 160, 70, 500, 434, 66, 500, 52, 90, 212, 180, 64, 48, 54, 500, 82, 34, 76, 500, 26, 500, 500, 146, 500, 70, 76, 292, 116, 96, 94, 72, 500, 64, 144, 500, 72, 500, 500, 500, 74, 500, 500, 500, 496, 500, 160, 392, 500, 500, 140, 36, 76, 228, 54, 500, 248, 500, 166, 86, 500, 74, 38, 500, 96, 134, 62, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37902225206676726, "mean_inference_ms": 1.2142552120662813, "mean_action_processing_ms": 0.14034560011876318, "mean_env_wait_ms": 0.08428511320318716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901148796081543, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.11894893646240234}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.303999999999846, "episode_len_mean": 247.64, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 19.69999999999984, 43.50000000000001, 44.5, 43.30000000000001, 36.900000000000034, -50.00000000000044, 38.10000000000002, 33.70000000000004, 39.70000000000002, 34.30000000000004, 11.899999999999729, 30.499999999999993, 42.10000000000001, 44.900000000000006, 38.50000000000003, 43.900000000000006, 22.49999999999988, 33.70000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.7, -50.00000000000044, 36.70000000000003, -50.00000000000044, 30.9, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, 6.699999999999655, 43.50000000000001, -50.00000000000044, 44.900000000000006, 41.100000000000016, 28.89999999999997, 32.100000000000016, 43.7, 45.3, 44.7, -50.00000000000044, 41.90000000000001, 46.699999999999996, 42.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 42.500000000000014, 20.899999999999856, 38.50000000000003, 40.500000000000014, 40.70000000000002, 42.900000000000006, -50.00000000000044, 43.7, 35.70000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 34.10000000000004, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, 42.500000000000014, 27.299999999999947, 44.7, -50.00000000000044, 25.29999999999992, -50.00000000000044, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, 40.500000000000014, 36.70000000000003, 43.900000000000006, 40.90000000000002], "episode_lengths": [76, 304, 66, 56, 68, 132, 500, 120, 164, 104, 158, 382, 196, 80, 52, 116, 62, 276, 164, 500, 54, 500, 500, 500, 120, 500, 82, 500, 64, 500, 134, 500, 192, 500, 160, 70, 500, 434, 66, 500, 52, 90, 212, 180, 64, 48, 54, 500, 82, 34, 76, 500, 26, 500, 500, 146, 500, 70, 76, 292, 116, 96, 94, 72, 500, 64, 144, 500, 72, 500, 500, 500, 74, 500, 500, 500, 496, 500, 160, 392, 500, 500, 140, 36, 76, 228, 54, 500, 248, 500, 166, 86, 500, 74, 38, 500, 96, 134, 62, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37902225206676726, "mean_inference_ms": 1.2142552120662813, "mean_action_processing_ms": 0.14034560011876318, "mean_env_wait_ms": 0.08428511320318716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901148796081543, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.11894893646240234}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5846.936784055404, "num_env_steps_trained_throughput_per_sec": 5846.936784055404, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2158.612, "sample_time_ms": 1944.615, "load_time_ms": 11.602, "load_throughput": 1034272.868, "learn_time_ms": 191.159, "learn_throughput": 62774.878, "synch_weights_time_ms": 9.934}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5165, "training_iteration": 112, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-43", "timestamp": 1698249943, "time_this_iter_s": 2.0573551654815674, "time_total_s": 241.44209218025208, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.44209218025208, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 59.0, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774472e-35, "cur_lr": 0.0003, "total_loss": 6.213753488328722, "policy_loss": -5.318327910370297e-05, "vf_loss": 6.213862154218885, "vf_explained_var": -6.490283542209202e-07, "kl": 6.316498442831491e-05, "entropy": 0.5557301110691495, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6429999999998177, "episode_len_mean": 269.18, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 41.100000000000016, 28.89999999999997, 32.100000000000016, 43.7, 45.3, 44.7, -50.00000000000044, 41.90000000000001, 46.699999999999996, 42.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 42.500000000000014, 20.899999999999856, 38.50000000000003, 40.500000000000014, 40.70000000000002, 42.900000000000006, -50.00000000000044, 43.7, 35.70000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 34.10000000000004, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, 42.500000000000014, 27.299999999999947, 44.7, -50.00000000000044, 25.29999999999992, -50.00000000000044, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, 40.500000000000014, 36.70000000000003, 43.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.300000000000004, 44.10000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, 38.10000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 47.1, 44.5, 25.899999999999928, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 20.49999999999985, 42.30000000000001, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [500, 52, 90, 212, 180, 64, 48, 54, 500, 82, 34, 76, 500, 26, 500, 500, 146, 500, 70, 76, 292, 116, 96, 94, 72, 500, 64, 144, 500, 72, 500, 500, 500, 74, 500, 500, 500, 496, 500, 160, 392, 500, 500, 140, 36, 76, 228, 54, 500, 248, 500, 166, 86, 500, 74, 38, 500, 96, 134, 62, 92, 500, 500, 184, 58, 60, 274, 500, 500, 500, 74, 500, 70, 500, 234, 120, 500, 72, 500, 500, 500, 500, 54, 118, 30, 56, 242, 78, 500, 500, 500, 284, 296, 78, 92, 500, 70, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791642939545959, "mean_inference_ms": 1.2139257538873374, "mean_action_processing_ms": 0.14030352344832142, "mean_env_wait_ms": 0.08442949267274466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199887275695801, "StateBufferConnector_ms": 0.0029947757720947266, "ViewRequirementAgentConnector_ms": 0.11300826072692871}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6429999999998177, "episode_len_mean": 269.18, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 41.100000000000016, 28.89999999999997, 32.100000000000016, 43.7, 45.3, 44.7, -50.00000000000044, 41.90000000000001, 46.699999999999996, 42.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 43.10000000000001, 42.500000000000014, 20.899999999999856, 38.50000000000003, 40.500000000000014, 40.70000000000002, 42.900000000000006, -50.00000000000044, 43.7, 35.70000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, -50.00000000000044, 34.10000000000004, 10.899999999999714, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, 42.500000000000014, 27.299999999999947, 44.7, -50.00000000000044, 25.29999999999992, -50.00000000000044, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.70000000000001, 46.3, -50.00000000000044, 40.500000000000014, 36.70000000000003, 43.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 31.70000000000001, 44.300000000000004, 44.10000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, 38.10000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 47.1, 44.5, 25.899999999999928, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 20.49999999999985, 42.30000000000001, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [500, 52, 90, 212, 180, 64, 48, 54, 500, 82, 34, 76, 500, 26, 500, 500, 146, 500, 70, 76, 292, 116, 96, 94, 72, 500, 64, 144, 500, 72, 500, 500, 500, 74, 500, 500, 500, 496, 500, 160, 392, 500, 500, 140, 36, 76, 228, 54, 500, 248, 500, 166, 86, 500, 74, 38, 500, 96, 134, 62, 92, 500, 500, 184, 58, 60, 274, 500, 500, 500, 74, 500, 70, 500, 234, 120, 500, 72, 500, 500, 500, 500, 54, 118, 30, 56, 242, 78, 500, 500, 500, 284, 296, 78, 92, 500, 70, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791642939545959, "mean_inference_ms": 1.2139257538873374, "mean_action_processing_ms": 0.14030352344832142, "mean_env_wait_ms": 0.08442949267274466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199887275695801, "StateBufferConnector_ms": 0.0029947757720947266, "ViewRequirementAgentConnector_ms": 0.11300826072692871}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5248.944718209832, "num_env_steps_trained_throughput_per_sec": 5248.944718209832, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2184.996, "sample_time_ms": 1948.877, "load_time_ms": 12.587, "load_throughput": 953382.721, "learn_time_ms": 212.467, "learn_throughput": 56479.352, "synch_weights_time_ms": 9.765}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5204, "training_iteration": 113, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-45", "timestamp": 1698249945, "time_this_iter_s": 2.291642427444458, "time_total_s": 243.73373460769653, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.73373460769653, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 55.15, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.925929944387236e-35, "cur_lr": 0.0003, "total_loss": 6.780551062689887, "policy_loss": 4.73550624317593e-05, "vf_loss": 6.780560122595893, "vf_explained_var": -6.357828776041666e-07, "kl": 5.2633453003004936e-05, "entropy": 0.5641124049822489, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1022.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.204999999999862, "episode_len_mean": 223.64, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, 38.10000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 47.1, 44.5, 25.899999999999928, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 20.49999999999985, 42.30000000000001, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 40.90000000000002, 42.900000000000006, 44.7, 40.90000000000002, 42.30000000000001, 45.9, 35.70000000000003, 45.1, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.700000000000024, 38.90000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, 41.100000000000016, 34.10000000000004, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.3, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.7, 41.70000000000002, 38.300000000000026, 46.5, 40.70000000000002, 46.3, 44.300000000000004, 42.30000000000001, 42.500000000000014, 46.099999999999994, 38.90000000000002, 44.900000000000006, -50.00000000000044, 41.90000000000001, 39.90000000000002, 45.3, 46.099999999999994, 31.300000000000004, 43.7, 45.7, 44.5, 35.500000000000036, 43.7, 25.899999999999928, 36.30000000000003, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 74, 500, 70, 500, 234, 120, 500, 72, 500, 500, 500, 500, 54, 118, 30, 56, 242, 78, 500, 500, 500, 284, 296, 78, 92, 500, 70, 500, 500, 62, 500, 500, 58, 172, 500, 50, 500, 48, 92, 72, 54, 92, 78, 42, 144, 50, 500, 62, 500, 174, 112, 142, 500, 500, 90, 160, 296, 500, 500, 64, 228, 34, 500, 160, 500, 48, 70, 52, 62, 500, 54, 84, 118, 36, 94, 38, 58, 78, 76, 40, 112, 52, 500, 82, 102, 48, 40, 188, 64, 44, 56, 146, 64, 242, 138, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37881449296314373, "mean_inference_ms": 1.2134516769675046, "mean_action_processing_ms": 0.14026916064279163, "mean_env_wait_ms": 0.0844951676792694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031011581420898438, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.09902524948120117}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.204999999999862, "episode_len_mean": 223.64, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 26.69999999999994, 38.10000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 38.300000000000026, 47.1, 44.5, 25.899999999999928, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 20.49999999999985, 42.30000000000001, 40.90000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 32.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 40.90000000000002, 42.900000000000006, 44.7, 40.90000000000002, 42.30000000000001, 45.9, 35.70000000000003, 45.1, -50.00000000000044, 43.900000000000006, -50.00000000000044, 32.700000000000024, 38.90000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, 41.100000000000016, 34.10000000000004, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.3, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.7, 41.70000000000002, 38.300000000000026, 46.5, 40.70000000000002, 46.3, 44.300000000000004, 42.30000000000001, 42.500000000000014, 46.099999999999994, 38.90000000000002, 44.900000000000006, -50.00000000000044, 41.90000000000001, 39.90000000000002, 45.3, 46.099999999999994, 31.300000000000004, 43.7, 45.7, 44.5, 35.500000000000036, 43.7, 25.899999999999928, 36.30000000000003, 42.70000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 74, 500, 70, 500, 234, 120, 500, 72, 500, 500, 500, 500, 54, 118, 30, 56, 242, 78, 500, 500, 500, 284, 296, 78, 92, 500, 70, 500, 500, 62, 500, 500, 58, 172, 500, 50, 500, 48, 92, 72, 54, 92, 78, 42, 144, 50, 500, 62, 500, 174, 112, 142, 500, 500, 90, 160, 296, 500, 500, 64, 228, 34, 500, 160, 500, 48, 70, 52, 62, 500, 54, 84, 118, 36, 94, 38, 58, 78, 76, 40, 112, 52, 500, 82, 102, 48, 40, 188, 64, 44, 56, 146, 64, 242, 138, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37881449296314373, "mean_inference_ms": 1.2134516769675046, "mean_action_processing_ms": 0.14026916064279163, "mean_env_wait_ms": 0.0844951676792694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031011581420898438, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.09902524948120117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5989.926114365879, "num_env_steps_trained_throughput_per_sec": 5989.926114365879, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2172.724, "sample_time_ms": 1950.735, "load_time_ms": 11.599, "load_throughput": 1034613.035, "learn_time_ms": 199.187, "learn_throughput": 60244.854, "synch_weights_time_ms": 9.903}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5271, "training_iteration": 114, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-47", "timestamp": 1698249947, "time_this_iter_s": 2.010552406311035, "time_total_s": 245.74428701400757, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.74428701400757, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 63.15, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.62964972193618e-36, "cur_lr": 0.0003, "total_loss": 6.729418489668104, "policy_loss": -8.51766930686103e-06, "vf_loss": 6.729480054643419, "vf_explained_var": -1.5497207641601562e-06, "kl": 6.3077334257539205e-06, "entropy": 0.5303812556796603, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1031.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.701999999999888, "episode_len_mean": 203.76, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 32.700000000000024, 38.90000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, 41.100000000000016, 34.10000000000004, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.3, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.7, 41.70000000000002, 38.300000000000026, 46.5, 40.70000000000002, 46.3, 44.300000000000004, 42.30000000000001, 42.500000000000014, 46.099999999999994, 38.90000000000002, 44.900000000000006, -50.00000000000044, 41.90000000000001, 39.90000000000002, 45.3, 46.099999999999994, 31.300000000000004, 43.7, 45.7, 44.5, 35.500000000000036, 43.7, 25.899999999999928, 36.30000000000003, 42.70000000000001, -50.00000000000044, 44.10000000000001, 27.299999999999947, 17.899999999999814, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.9, 7.899999999999672, 33.10000000000003, 34.30000000000004, 44.7, 43.30000000000001, 44.7, 45.1, 44.5, 40.70000000000002, 24.69999999999991, 41.30000000000001, 3.0999999999996035, 39.300000000000026, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 23.8999999999999, 32.30000000000002, -50.00000000000044, 44.7, 41.30000000000001, 36.10000000000004, -50.00000000000044, 38.90000000000002, 22.299999999999876, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, 39.70000000000002, 23.099999999999888, 45.9, 35.900000000000034, -50.00000000000044], "episode_lengths": [62, 500, 174, 112, 142, 500, 500, 90, 160, 296, 500, 500, 64, 228, 34, 500, 160, 500, 48, 70, 52, 62, 500, 54, 84, 118, 36, 94, 38, 58, 78, 76, 40, 112, 52, 500, 82, 102, 48, 40, 188, 64, 44, 56, 146, 64, 242, 138, 74, 500, 60, 228, 322, 66, 500, 52, 500, 500, 56, 424, 500, 500, 500, 258, 42, 422, 170, 158, 54, 68, 54, 50, 56, 94, 254, 88, 470, 108, 66, 500, 34, 500, 262, 178, 500, 54, 88, 140, 500, 112, 278, 58, 66, 46, 500, 104, 270, 42, 142, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379348423626447, "mean_inference_ms": 1.2135837263210592, "mean_action_processing_ms": 0.14025203055405833, "mean_env_wait_ms": 0.08456200878419853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013757705688477, "StateBufferConnector_ms": 0.0060117244720458984, "ViewRequirementAgentConnector_ms": 0.10401129722595215}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.701999999999888, "episode_len_mean": 203.76, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 32.700000000000024, 38.90000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, 41.100000000000016, 34.10000000000004, 20.49999999999985, -50.00000000000044, -50.00000000000044, 43.7, 27.299999999999947, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 45.3, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.7, 41.70000000000002, 38.300000000000026, 46.5, 40.70000000000002, 46.3, 44.300000000000004, 42.30000000000001, 42.500000000000014, 46.099999999999994, 38.90000000000002, 44.900000000000006, -50.00000000000044, 41.90000000000001, 39.90000000000002, 45.3, 46.099999999999994, 31.300000000000004, 43.7, 45.7, 44.5, 35.500000000000036, 43.7, 25.899999999999928, 36.30000000000003, 42.70000000000001, -50.00000000000044, 44.10000000000001, 27.299999999999947, 17.899999999999814, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.9, 7.899999999999672, 33.10000000000003, 34.30000000000004, 44.7, 43.30000000000001, 44.7, 45.1, 44.5, 40.70000000000002, 24.69999999999991, 41.30000000000001, 3.0999999999996035, 39.300000000000026, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 23.8999999999999, 32.30000000000002, -50.00000000000044, 44.7, 41.30000000000001, 36.10000000000004, -50.00000000000044, 38.90000000000002, 22.299999999999876, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, 39.70000000000002, 23.099999999999888, 45.9, 35.900000000000034, -50.00000000000044], "episode_lengths": [62, 500, 174, 112, 142, 500, 500, 90, 160, 296, 500, 500, 64, 228, 34, 500, 160, 500, 48, 70, 52, 62, 500, 54, 84, 118, 36, 94, 38, 58, 78, 76, 40, 112, 52, 500, 82, 102, 48, 40, 188, 64, 44, 56, 146, 64, 242, 138, 74, 500, 60, 228, 322, 66, 500, 52, 500, 500, 56, 424, 500, 500, 500, 258, 42, 422, 170, 158, 54, 68, 54, 50, 56, 94, 254, 88, 470, 108, 66, 500, 34, 500, 262, 178, 500, 54, 88, 140, 500, 112, 278, 58, 66, 46, 500, 104, 270, 42, 142, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379348423626447, "mean_inference_ms": 1.2135837263210592, "mean_action_processing_ms": 0.14025203055405833, "mean_env_wait_ms": 0.08456200878419853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013757705688477, "StateBufferConnector_ms": 0.0060117244720458984, "ViewRequirementAgentConnector_ms": 0.10401129722595215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5511.617875717032, "num_env_steps_trained_throughput_per_sec": 5511.617875717032, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2183.837, "sample_time_ms": 1958.523, "load_time_ms": 11.897, "load_throughput": 1008656.325, "learn_time_ms": 202.056, "learn_throughput": 59389.454, "synch_weights_time_ms": 10.062}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5321, "training_iteration": 115, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-49", "timestamp": 1698249949, "time_this_iter_s": 2.1822171211242676, "time_total_s": 247.92650413513184, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.92650413513184, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 59.825, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.81482486096809e-36, "cur_lr": 0.0003, "total_loss": 6.606285678015815, "policy_loss": -0.0002462139560116662, "vf_loss": 6.606584548950195, "vf_explained_var": -1.1391109890407986e-06, "kl": 0.00017647521152418399, "entropy": 0.5282225840621524, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.075999999999842, "episode_len_mean": 249.96, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 45.7, 44.5, 35.500000000000036, 43.7, 25.899999999999928, 36.30000000000003, 42.70000000000001, -50.00000000000044, 44.10000000000001, 27.299999999999947, 17.899999999999814, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.9, 7.899999999999672, 33.10000000000003, 34.30000000000004, 44.7, 43.30000000000001, 44.7, 45.1, 44.5, 40.70000000000002, 24.69999999999991, 41.30000000000001, 3.0999999999996035, 39.300000000000026, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 23.8999999999999, 32.30000000000002, -50.00000000000044, 44.7, 41.30000000000001, 36.10000000000004, -50.00000000000044, 38.90000000000002, 22.299999999999876, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, 39.70000000000002, 23.099999999999888, 45.9, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.1, 45.1, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, 10.699999999999712, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 41.70000000000002, 30.499999999999993, -50.00000000000044, 14.899999999999771, 42.500000000000014, 33.500000000000036, 10.899999999999714, 16.09999999999979, 41.30000000000001, 45.9, 23.099999999999888, -50.00000000000044, 42.10000000000001, 20.099999999999845, 43.30000000000001, 46.699999999999996, -50.00000000000044, 43.30000000000001, 8.899999999999686, -50.00000000000044], "episode_lengths": [64, 44, 56, 146, 64, 242, 138, 74, 500, 60, 228, 322, 66, 500, 52, 500, 500, 56, 424, 500, 500, 500, 258, 42, 422, 170, 158, 54, 68, 54, 50, 56, 94, 254, 88, 470, 108, 66, 500, 34, 500, 262, 178, 500, 54, 88, 140, 500, 112, 278, 58, 66, 46, 500, 104, 270, 42, 142, 500, 500, 126, 500, 190, 50, 500, 214, 32, 500, 500, 500, 300, 500, 42, 500, 82, 394, 500, 276, 500, 500, 84, 196, 500, 352, 76, 166, 392, 340, 88, 42, 270, 500, 80, 300, 68, 34, 500, 68, 412, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791348240218423, "mean_inference_ms": 1.213702153348725, "mean_action_processing_ms": 0.14034081561643064, "mean_env_wait_ms": 0.08444349832137898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001577377319336, "StateBufferConnector_ms": 0.007012605667114258, "ViewRequirementAgentConnector_ms": 0.11902022361755371}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.075999999999842, "episode_len_mean": 249.96, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 45.7, 44.5, 35.500000000000036, 43.7, 25.899999999999928, 36.30000000000003, 42.70000000000001, -50.00000000000044, 44.10000000000001, 27.299999999999947, 17.899999999999814, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 45.9, 7.899999999999672, 33.10000000000003, 34.30000000000004, 44.7, 43.30000000000001, 44.7, 45.1, 44.5, 40.70000000000002, 24.69999999999991, 41.30000000000001, 3.0999999999996035, 39.300000000000026, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 23.8999999999999, 32.30000000000002, -50.00000000000044, 44.7, 41.30000000000001, 36.10000000000004, -50.00000000000044, 38.90000000000002, 22.299999999999876, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, 39.70000000000002, 23.099999999999888, 45.9, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.1, 45.1, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, 10.699999999999712, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 41.70000000000002, 30.499999999999993, -50.00000000000044, 14.899999999999771, 42.500000000000014, 33.500000000000036, 10.899999999999714, 16.09999999999979, 41.30000000000001, 45.9, 23.099999999999888, -50.00000000000044, 42.10000000000001, 20.099999999999845, 43.30000000000001, 46.699999999999996, -50.00000000000044, 43.30000000000001, 8.899999999999686, -50.00000000000044], "episode_lengths": [64, 44, 56, 146, 64, 242, 138, 74, 500, 60, 228, 322, 66, 500, 52, 500, 500, 56, 424, 500, 500, 500, 258, 42, 422, 170, 158, 54, 68, 54, 50, 56, 94, 254, 88, 470, 108, 66, 500, 34, 500, 262, 178, 500, 54, 88, 140, 500, 112, 278, 58, 66, 46, 500, 104, 270, 42, 142, 500, 500, 126, 500, 190, 50, 500, 214, 32, 500, 500, 500, 300, 500, 42, 500, 82, 394, 500, 276, 500, 500, 84, 196, 500, 352, 76, 166, 392, 340, 88, 42, 270, 500, 80, 300, 68, 34, 500, 68, 412, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791348240218423, "mean_inference_ms": 1.213702153348725, "mean_action_processing_ms": 0.14034081561643064, "mean_env_wait_ms": 0.08444349832137898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001577377319336, "StateBufferConnector_ms": 0.007012605667114258, "ViewRequirementAgentConnector_ms": 0.11902022361755371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5596.811267536722, "num_env_steps_trained_throughput_per_sec": 5596.811267536722, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2172.882, "sample_time_ms": 1961.122, "load_time_ms": 11.621, "load_throughput": 1032583.858, "learn_time_ms": 188.83, "learn_throughput": 63549.218, "synch_weights_time_ms": 9.899}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5362, "training_iteration": 116, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-52", "timestamp": 1698249952, "time_this_iter_s": 2.1489803791046143, "time_total_s": 250.07548451423645, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.07548451423645, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 62.1, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.407412430484045e-36, "cur_lr": 0.0003, "total_loss": 6.620684093899197, "policy_loss": 5.333787865108914e-05, "vf_loss": 6.620682557423909, "vf_explained_var": -1.4570024278428819e-06, "kl": 0.00012833831724555643, "entropy": 0.5174754990471734, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1049.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.16299999999983, "episode_len_mean": 264.02, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.299999999999876, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, 39.70000000000002, 23.099999999999888, 45.9, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.1, 45.1, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, 10.699999999999712, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 41.70000000000002, 30.499999999999993, -50.00000000000044, 14.899999999999771, 42.500000000000014, 33.500000000000036, 10.899999999999714, 16.09999999999979, 41.30000000000001, 45.9, 23.099999999999888, -50.00000000000044, 42.10000000000001, 20.099999999999845, 43.30000000000001, 46.699999999999996, -50.00000000000044, 43.30000000000001, 8.899999999999686, -50.00000000000044, 45.5, 41.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.70000000000003, 43.50000000000001, 30.699999999999996, 43.10000000000001, 32.90000000000003, -50.00000000000044, 35.500000000000036, 39.70000000000002, 33.30000000000003, 44.10000000000001, 34.50000000000004, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, 37.70000000000003, 33.70000000000004, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 37.70000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 30.29999999999999, 44.300000000000004, 30.699999999999996, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044], "episode_lengths": [278, 58, 66, 46, 500, 104, 270, 42, 142, 500, 500, 126, 500, 190, 50, 500, 214, 32, 500, 500, 500, 300, 500, 42, 500, 82, 394, 500, 276, 500, 500, 84, 196, 500, 352, 76, 166, 392, 340, 88, 42, 270, 500, 80, 300, 68, 34, 500, 68, 412, 500, 46, 90, 118, 500, 500, 500, 70, 500, 124, 66, 194, 70, 172, 500, 146, 104, 168, 60, 156, 64, 36, 500, 500, 500, 500, 46, 500, 58, 124, 164, 64, 500, 68, 500, 62, 124, 500, 54, 500, 44, 500, 46, 198, 58, 194, 500, 500, 234, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790124980821761, "mean_inference_ms": 1.2139935524601486, "mean_action_processing_ms": 0.14034441372173703, "mean_env_wait_ms": 0.08448161859931674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499985694885254, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.10901618003845215}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.16299999999983, "episode_len_mean": 264.02, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.299999999999876, 44.300000000000004, 43.50000000000001, 45.5, -50.00000000000044, 39.70000000000002, 23.099999999999888, 45.9, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 31.1, 45.1, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, 10.699999999999712, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 41.70000000000002, 30.499999999999993, -50.00000000000044, 14.899999999999771, 42.500000000000014, 33.500000000000036, 10.899999999999714, 16.09999999999979, 41.30000000000001, 45.9, 23.099999999999888, -50.00000000000044, 42.10000000000001, 20.099999999999845, 43.30000000000001, 46.699999999999996, -50.00000000000044, 43.30000000000001, 8.899999999999686, -50.00000000000044, 45.5, 41.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.70000000000003, 43.50000000000001, 30.699999999999996, 43.10000000000001, 32.90000000000003, -50.00000000000044, 35.500000000000036, 39.70000000000002, 33.30000000000003, 44.10000000000001, 34.50000000000004, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, 37.70000000000003, 33.70000000000004, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 37.70000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 30.29999999999999, 44.300000000000004, 30.699999999999996, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044], "episode_lengths": [278, 58, 66, 46, 500, 104, 270, 42, 142, 500, 500, 126, 500, 190, 50, 500, 214, 32, 500, 500, 500, 300, 500, 42, 500, 82, 394, 500, 276, 500, 500, 84, 196, 500, 352, 76, 166, 392, 340, 88, 42, 270, 500, 80, 300, 68, 34, 500, 68, 412, 500, 46, 90, 118, 500, 500, 500, 70, 500, 124, 66, 194, 70, 172, 500, 146, 104, 168, 60, 156, 64, 36, 500, 500, 500, 500, 46, 500, 58, 124, 164, 64, 500, 68, 500, 62, 124, 500, 54, 500, 44, 500, 46, 198, 58, 194, 500, 500, 234, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790124980821761, "mean_inference_ms": 1.2139935524601486, "mean_action_processing_ms": 0.14034441372173703, "mean_env_wait_ms": 0.08448161859931674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499985694885254, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.10901618003845215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5847.390543639646, "num_env_steps_trained_throughput_per_sec": 5847.390543639646, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2177.253, "sample_time_ms": 1961.115, "load_time_ms": 11.727, "load_throughput": 1023285.915, "learn_time_ms": 193.118, "learn_throughput": 62138.067, "synch_weights_time_ms": 9.883}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5411, "training_iteration": 117, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-54", "timestamp": 1698249954, "time_this_iter_s": 2.058196783065796, "time_total_s": 252.13368129730225, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.13368129730225, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 64.55, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420225e-36, "cur_lr": 0.0003, "total_loss": 6.602177143096924, "policy_loss": -0.00019886427455478243, "vf_loss": 6.602430078718397, "vf_explained_var": -1.2450748019748264e-06, "kl": 7.040598886318448e-05, "entropy": 0.5412776437070634, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.486999999999827, "episode_len_mean": 260.76, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 20.099999999999845, 43.30000000000001, 46.699999999999996, -50.00000000000044, 43.30000000000001, 8.899999999999686, -50.00000000000044, 45.5, 41.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.70000000000003, 43.50000000000001, 30.699999999999996, 43.10000000000001, 32.90000000000003, -50.00000000000044, 35.500000000000036, 39.70000000000002, 33.30000000000003, 44.10000000000001, 34.50000000000004, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, 37.70000000000003, 33.70000000000004, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 37.70000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 30.29999999999999, 44.300000000000004, 30.699999999999996, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 28.29999999999996, 15.49999999999978, 39.300000000000026, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 16.499999999999794, 47.1, 46.3, 31.1, 41.90000000000001, 37.300000000000026, -50.00000000000044, 45.7, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, 30.099999999999987, 20.299999999999848, 40.30000000000002, 9.8999999999997], "episode_lengths": [80, 300, 68, 34, 500, 68, 412, 500, 46, 90, 118, 500, 500, 500, 70, 500, 124, 66, 194, 70, 172, 500, 146, 104, 168, 60, 156, 64, 36, 500, 500, 500, 500, 46, 500, 58, 124, 164, 64, 500, 68, 500, 62, 124, 500, 54, 500, 44, 500, 46, 198, 58, 194, 500, 500, 234, 500, 500, 26, 500, 500, 218, 346, 108, 500, 500, 294, 500, 72, 42, 500, 336, 30, 38, 190, 82, 128, 500, 44, 46, 78, 500, 500, 500, 52, 36, 66, 44, 500, 500, 500, 500, 500, 500, 60, 58, 200, 298, 98, 402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900792202478184, "mean_inference_ms": 1.2135460553414397, "mean_action_processing_ms": 0.14037037309125194, "mean_env_wait_ms": 0.08460960074272406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992538452148438, "StateBufferConnector_ms": 0.009006261825561523, "ViewRequirementAgentConnector_ms": 0.10400962829589844}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.486999999999827, "episode_len_mean": 260.76, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 20.099999999999845, 43.30000000000001, 46.699999999999996, -50.00000000000044, 43.30000000000001, 8.899999999999686, -50.00000000000044, 45.5, 41.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 37.70000000000003, 43.50000000000001, 30.699999999999996, 43.10000000000001, 32.90000000000003, -50.00000000000044, 35.500000000000036, 39.70000000000002, 33.30000000000003, 44.10000000000001, 34.50000000000004, 43.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.300000000000004, 37.70000000000003, 33.70000000000004, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 37.70000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 30.29999999999999, 44.300000000000004, 30.699999999999996, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 28.29999999999996, 15.49999999999978, 39.300000000000026, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 16.499999999999794, 47.1, 46.3, 31.1, 41.90000000000001, 37.300000000000026, -50.00000000000044, 45.7, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, 30.099999999999987, 20.299999999999848, 40.30000000000002, 9.8999999999997], "episode_lengths": [80, 300, 68, 34, 500, 68, 412, 500, 46, 90, 118, 500, 500, 500, 70, 500, 124, 66, 194, 70, 172, 500, 146, 104, 168, 60, 156, 64, 36, 500, 500, 500, 500, 46, 500, 58, 124, 164, 64, 500, 68, 500, 62, 124, 500, 54, 500, 44, 500, 46, 198, 58, 194, 500, 500, 234, 500, 500, 26, 500, 500, 218, 346, 108, 500, 500, 294, 500, 72, 42, 500, 336, 30, 38, 190, 82, 128, 500, 44, 46, 78, 500, 500, 500, 52, 36, 66, 44, 500, 500, 500, 500, 500, 500, 60, 58, 200, 298, 98, 402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37900792202478184, "mean_inference_ms": 1.2135460553414397, "mean_action_processing_ms": 0.14037037309125194, "mean_env_wait_ms": 0.08460960074272406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992538452148438, "StateBufferConnector_ms": 0.009006261825561523, "ViewRequirementAgentConnector_ms": 0.10400962829589844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.564990219285, "num_env_steps_trained_throughput_per_sec": 5328.564990219285, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2192.168, "sample_time_ms": 1960.299, "load_time_ms": 12.227, "load_throughput": 981441.324, "learn_time_ms": 208.447, "learn_throughput": 57568.59, "synch_weights_time_ms": 9.786}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5454, "training_iteration": 118, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-56", "timestamp": 1698249956, "time_this_iter_s": 2.2570133209228516, "time_total_s": 254.3906946182251, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.3906946182251, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 57.825, "ram_util_percent": 27.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210112e-37, "cur_lr": 0.0003, "total_loss": 6.5519800715976295, "policy_loss": -6.287462181515164e-06, "vf_loss": 6.552040629916721, "vf_explained_var": -1.5099843343098958e-06, "kl": 0.0001604561723098641, "entropy": 0.5436572896109687, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7439999999997986, "episode_len_mean": 283.14, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 30.29999999999999, 44.300000000000004, 30.699999999999996, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 28.29999999999996, 15.49999999999978, 39.300000000000026, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 16.499999999999794, 47.1, 46.3, 31.1, 41.90000000000001, 37.300000000000026, -50.00000000000044, 45.7, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, 30.099999999999987, 20.299999999999848, 40.30000000000002, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.3, 43.7, 31.900000000000013, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 22.099999999999874, 37.50000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 44.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.699999999999896, 13.899999999999757, 42.900000000000006, 43.30000000000001], "episode_lengths": [124, 500, 54, 500, 44, 500, 46, 198, 58, 194, 500, 500, 234, 500, 500, 26, 500, 500, 218, 346, 108, 500, 500, 294, 500, 72, 42, 500, 336, 30, 38, 190, 82, 128, 500, 44, 46, 78, 500, 500, 500, 52, 36, 66, 44, 500, 500, 500, 500, 500, 500, 60, 58, 200, 298, 98, 402, 500, 500, 500, 130, 500, 134, 34, 48, 64, 182, 56, 44, 500, 500, 46, 352, 500, 500, 500, 500, 500, 114, 26, 280, 126, 500, 150, 500, 500, 76, 64, 54, 500, 164, 500, 500, 500, 500, 60, 264, 362, 72, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37873888805168326, "mean_inference_ms": 1.2132212710151125, "mean_action_processing_ms": 0.14040319487188108, "mean_env_wait_ms": 0.0844278399478803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030989408493041992, "StateBufferConnector_ms": 0.009006500244140625, "ViewRequirementAgentConnector_ms": 0.11597633361816406}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7439999999997986, "episode_len_mean": 283.14, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 30.29999999999999, 44.300000000000004, 30.699999999999996, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 28.29999999999996, 15.49999999999978, 39.300000000000026, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 16.499999999999794, 47.1, 46.3, 31.1, 41.90000000000001, 37.300000000000026, -50.00000000000044, 45.7, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, 43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, 30.099999999999987, 20.299999999999848, 40.30000000000002, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.3, 43.7, 31.900000000000013, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 22.099999999999874, 37.50000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 44.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.699999999999896, 13.899999999999757, 42.900000000000006, 43.30000000000001], "episode_lengths": [124, 500, 54, 500, 44, 500, 46, 198, 58, 194, 500, 500, 234, 500, 500, 26, 500, 500, 218, 346, 108, 500, 500, 294, 500, 72, 42, 500, 336, 30, 38, 190, 82, 128, 500, 44, 46, 78, 500, 500, 500, 52, 36, 66, 44, 500, 500, 500, 500, 500, 500, 60, 58, 200, 298, 98, 402, 500, 500, 500, 130, 500, 134, 34, 48, 64, 182, 56, 44, 500, 500, 46, 352, 500, 500, 500, 500, 500, 114, 26, 280, 126, 500, 150, 500, 500, 76, 64, 54, 500, 164, 500, 500, 500, 500, 60, 264, 362, 72, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37873888805168326, "mean_inference_ms": 1.2132212710151125, "mean_action_processing_ms": 0.14040319487188108, "mean_env_wait_ms": 0.0844278399478803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030989408493041992, "StateBufferConnector_ms": 0.009006500244140625, "ViewRequirementAgentConnector_ms": 0.11597633361816406}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5971.128114764338, "num_env_steps_trained_throughput_per_sec": 5971.128114764338, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2169.825, "sample_time_ms": 1959.57, "load_time_ms": 11.727, "load_throughput": 1023267.191, "learn_time_ms": 187.369, "learn_throughput": 64044.815, "synch_weights_time_ms": 9.849}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5497, "training_iteration": 119, "trial_id": "9f288_00018", "date": "2023-10-25_17-05-58", "timestamp": 1698249958, "time_this_iter_s": 2.0206634998321533, "time_total_s": 256.41135811805725, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.41135811805725, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 27.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105056e-37, "cur_lr": 0.0003, "total_loss": 6.583138995700413, "policy_loss": -0.0003711432218551636, "vf_loss": 6.583561420440674, "vf_explained_var": -5.430645412868923e-07, "kl": 0.0001653089095504533, "entropy": 0.5127637286980947, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1076.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.2619999999997931, "episode_len_mean": 287.96, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, 30.099999999999987, 20.299999999999848, 40.30000000000002, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.3, 43.7, 31.900000000000013, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 22.099999999999874, 37.50000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 44.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.699999999999896, 13.899999999999757, 42.900000000000006, 43.30000000000001, 0.09999999999956088, 39.90000000000002, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.9, 39.10000000000002, 44.300000000000004, 46.099999999999994, -50.00000000000044, 23.099999999999888, 30.29999999999999, -50.00000000000044, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, -50.00000000000044, 47.1, 27.49999999999995, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 44.7, 44.900000000000006, 41.90000000000001, 5.899999999999643, -50.00000000000044], "episode_lengths": [66, 44, 500, 500, 500, 500, 500, 500, 60, 58, 200, 298, 98, 402, 500, 500, 500, 130, 500, 134, 34, 48, 64, 182, 56, 44, 500, 500, 46, 352, 500, 500, 500, 500, 500, 114, 26, 280, 126, 500, 150, 500, 500, 76, 64, 54, 500, 164, 500, 500, 500, 500, 60, 264, 362, 72, 68, 500, 102, 50, 500, 76, 500, 500, 40, 500, 22, 110, 58, 40, 500, 270, 198, 500, 48, 46, 500, 500, 500, 166, 62, 168, 500, 500, 68, 500, 290, 500, 30, 226, 500, 48, 500, 500, 352, 54, 52, 82, 442, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785861557607987, "mean_inference_ms": 1.213118930299769, "mean_action_processing_ms": 0.1403720426714027, "mean_env_wait_ms": 0.0842892991268563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699445724487305, "StateBufferConnector_ms": 0.006994485855102539, "ViewRequirementAgentConnector_ms": 0.12499642372131348}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.2619999999997931, "episode_len_mean": 287.96, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, 30.099999999999987, 20.299999999999848, 40.30000000000002, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.3, 43.7, 31.900000000000013, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.5, 22.099999999999874, 37.50000000000003, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 44.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.699999999999896, 13.899999999999757, 42.900000000000006, 43.30000000000001, 0.09999999999956088, 39.90000000000002, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.9, 39.10000000000002, 44.300000000000004, 46.099999999999994, -50.00000000000044, 23.099999999999888, 30.29999999999999, -50.00000000000044, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, -50.00000000000044, 47.1, 27.49999999999995, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 44.7, 44.900000000000006, 41.90000000000001, 5.899999999999643, -50.00000000000044], "episode_lengths": [66, 44, 500, 500, 500, 500, 500, 500, 60, 58, 200, 298, 98, 402, 500, 500, 500, 130, 500, 134, 34, 48, 64, 182, 56, 44, 500, 500, 46, 352, 500, 500, 500, 500, 500, 114, 26, 280, 126, 500, 150, 500, 500, 76, 64, 54, 500, 164, 500, 500, 500, 500, 60, 264, 362, 72, 68, 500, 102, 50, 500, 76, 500, 500, 40, 500, 22, 110, 58, 40, 500, 270, 198, 500, 48, 46, 500, 500, 500, 166, 62, 168, 500, 500, 68, 500, 290, 500, 30, 226, 500, 48, 500, 500, 352, 54, 52, 82, 442, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785861557607987, "mean_inference_ms": 1.213118930299769, "mean_action_processing_ms": 0.1403720426714027, "mean_env_wait_ms": 0.0842892991268563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699445724487305, "StateBufferConnector_ms": 0.006994485855102539, "ViewRequirementAgentConnector_ms": 0.12499642372131348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5811.1318150839015, "num_env_steps_trained_throughput_per_sec": 5811.1318150839015, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2123.611, "sample_time_ms": 1912.263, "load_time_ms": 11.747, "load_throughput": 1021566.215, "learn_time_ms": 188.442, "learn_throughput": 63680.002, "synch_weights_time_ms": 9.949}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5540, "training_iteration": 120, "trial_id": "9f288_00018", "date": "2023-10-25_17-06-00", "timestamp": 1698249960, "time_this_iter_s": 2.0699996948242188, "time_total_s": 258.48135781288147, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.48135781288147, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 67.85, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.504632769052528e-37, "cur_lr": 0.0003, "total_loss": 6.360666645897759, "policy_loss": -0.0006184934948881468, "vf_loss": 6.361336655086941, "vf_explained_var": -1.708666483561198e-06, "kl": 0.0005314488464844342, "entropy": 0.5155997044510312, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1085.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7779999999998011, "episode_len_mean": 282.8, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 44.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.699999999999896, 13.899999999999757, 42.900000000000006, 43.30000000000001, 0.09999999999956088, 39.90000000000002, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.9, 39.10000000000002, 44.300000000000004, 46.099999999999994, -50.00000000000044, 23.099999999999888, 30.29999999999999, -50.00000000000044, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, -50.00000000000044, 47.1, 27.49999999999995, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 44.7, 44.900000000000006, 41.90000000000001, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 44.900000000000006, 43.30000000000001, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.5, 33.30000000000003, 44.900000000000006, 40.500000000000014, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.1, -50.00000000000044, 36.900000000000034, 44.7, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, 30.9, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 76, 64, 54, 500, 164, 500, 500, 500, 500, 60, 264, 362, 72, 68, 500, 102, 50, 500, 76, 500, 500, 40, 500, 22, 110, 58, 40, 500, 270, 198, 500, 48, 46, 500, 500, 500, 166, 62, 168, 500, 500, 68, 500, 290, 500, 30, 226, 500, 48, 500, 500, 352, 54, 52, 82, 442, 500, 500, 500, 500, 334, 52, 68, 500, 190, 500, 500, 122, 56, 168, 52, 96, 500, 150, 66, 50, 500, 132, 54, 500, 500, 176, 78, 68, 500, 500, 500, 500, 500, 500, 66, 56, 128, 500, 86, 192, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37884194347611283, "mean_inference_ms": 1.2131129004949772, "mean_action_processing_ms": 0.1402988578132877, "mean_env_wait_ms": 0.08438879931309119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500103950500488, "StateBufferConnector_ms": 0.004993915557861328, "ViewRequirementAgentConnector_ms": 0.11899757385253906}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7779999999998011, "episode_len_mean": 282.8, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 44.7, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 23.699999999999896, 13.899999999999757, 42.900000000000006, 43.30000000000001, 0.09999999999956088, 39.90000000000002, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.9, 39.10000000000002, 44.300000000000004, 46.099999999999994, -50.00000000000044, 23.099999999999888, 30.29999999999999, -50.00000000000044, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.900000000000006, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, -50.00000000000044, 47.1, 27.49999999999995, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 44.7, 44.900000000000006, 41.90000000000001, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 44.900000000000006, 43.30000000000001, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.5, 33.30000000000003, 44.900000000000006, 40.500000000000014, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.1, -50.00000000000044, 36.900000000000034, 44.7, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, 30.9, -50.00000000000044, 44.5], "episode_lengths": [500, 500, 76, 64, 54, 500, 164, 500, 500, 500, 500, 60, 264, 362, 72, 68, 500, 102, 50, 500, 76, 500, 500, 40, 500, 22, 110, 58, 40, 500, 270, 198, 500, 48, 46, 500, 500, 500, 166, 62, 168, 500, 500, 68, 500, 290, 500, 30, 226, 500, 48, 500, 500, 352, 54, 52, 82, 442, 500, 500, 500, 500, 334, 52, 68, 500, 190, 500, 500, 122, 56, 168, 52, 96, 500, 150, 66, 50, 500, 132, 54, 500, 500, 176, 78, 68, 500, 500, 500, 500, 500, 500, 66, 56, 128, 500, 86, 192, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37884194347611283, "mean_inference_ms": 1.2131129004949772, "mean_action_processing_ms": 0.1402988578132877, "mean_env_wait_ms": 0.08438879931309119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500103950500488, "StateBufferConnector_ms": 0.004993915557861328, "ViewRequirementAgentConnector_ms": 0.11899757385253906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.677295241366, "num_env_steps_trained_throughput_per_sec": 5354.677295241366, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2128.311, "sample_time_ms": 1920.088, "load_time_ms": 11.82, "load_throughput": 1015266.789, "learn_time_ms": 185.261, "learn_throughput": 64773.595, "synch_weights_time_ms": 9.931}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5581, "training_iteration": 121, "trial_id": "9f288_00018", "date": "2023-10-25_17-06-02", "timestamp": 1698249962, "time_this_iter_s": 2.246022939682007, "time_total_s": 260.7273807525635, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.7273807525635, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 27.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.52316384526264e-38, "cur_lr": 0.0003, "total_loss": 6.425726148817274, "policy_loss": 9.0313454469045e-05, "vf_loss": 6.4256875779893665, "vf_explained_var": -9.934107462565105e-07, "kl": 0.00030026168487514343, "entropy": 0.516883886522717, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.051000000000211, "episode_len_mean": 296.06, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, -50.00000000000044, 47.1, 27.49999999999995, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 44.7, 44.900000000000006, 41.90000000000001, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 44.900000000000006, 43.30000000000001, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.5, 33.30000000000003, 44.900000000000006, 40.500000000000014, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.1, -50.00000000000044, 36.900000000000034, 44.7, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, 30.9, -50.00000000000044, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, 33.70000000000004, 41.90000000000001, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 37.90000000000003, 4.699999999999626, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 45.1, 11.499999999999723, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.900000000000034, 37.300000000000026, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5], "episode_lengths": [500, 500, 68, 500, 290, 500, 30, 226, 500, 48, 500, 500, 352, 54, 52, 82, 442, 500, 500, 500, 500, 334, 52, 68, 500, 190, 500, 500, 122, 56, 168, 52, 96, 500, 150, 66, 50, 500, 132, 54, 500, 500, 176, 78, 68, 500, 500, 500, 500, 500, 500, 66, 56, 128, 500, 86, 192, 500, 56, 500, 46, 500, 500, 206, 164, 82, 96, 500, 78, 500, 500, 500, 210, 500, 122, 454, 150, 500, 500, 500, 54, 500, 500, 214, 50, 386, 34, 500, 118, 500, 152, 128, 70, 500, 68, 500, 500, 500, 48, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790251976452491, "mean_inference_ms": 1.2129575437825886, "mean_action_processing_ms": 0.14039763546411874, "mean_env_wait_ms": 0.08456726703666584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034989118576049805, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.1129903793334961}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.051000000000211, "episode_len_mean": 296.06, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, -50.00000000000044, 47.1, 27.49999999999995, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 14.899999999999771, 44.7, 44.900000000000006, 41.90000000000001, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 44.900000000000006, 43.30000000000001, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.5, 33.30000000000003, 44.900000000000006, 40.500000000000014, -50.00000000000044, 35.10000000000004, 43.50000000000001, 45.1, -50.00000000000044, 36.900000000000034, 44.7, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, 30.9, -50.00000000000044, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, 33.70000000000004, 41.90000000000001, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 37.90000000000003, 4.699999999999626, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 45.1, 11.499999999999723, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.900000000000034, 37.300000000000026, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5], "episode_lengths": [500, 500, 68, 500, 290, 500, 30, 226, 500, 48, 500, 500, 352, 54, 52, 82, 442, 500, 500, 500, 500, 334, 52, 68, 500, 190, 500, 500, 122, 56, 168, 52, 96, 500, 150, 66, 50, 500, 132, 54, 500, 500, 176, 78, 68, 500, 500, 500, 500, 500, 500, 66, 56, 128, 500, 86, 192, 500, 56, 500, 46, 500, 500, 206, 164, 82, 96, 500, 78, 500, 500, 500, 210, 500, 122, 454, 150, 500, 500, 500, 54, 500, 500, 214, 50, 386, 34, 500, 118, 500, 152, 128, 70, 500, 68, 500, 500, 500, 48, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790251976452491, "mean_inference_ms": 1.2129575437825886, "mean_action_processing_ms": 0.14039763546411874, "mean_env_wait_ms": 0.08456726703666584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034989118576049805, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.1129903793334961}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5813.2104433395125, "num_env_steps_trained_throughput_per_sec": 5813.2104433395125, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2129.501, "sample_time_ms": 1920.183, "load_time_ms": 11.863, "load_throughput": 1011577.551, "learn_time_ms": 186.177, "learn_throughput": 64454.961, "synch_weights_time_ms": 10.0}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5622, "training_iteration": 122, "trial_id": "9f288_00018", "date": "2023-10-25_17-06-04", "timestamp": 1698249964, "time_this_iter_s": 2.0692553520202637, "time_total_s": 262.79663610458374, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.79663610458374, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 61.46666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.76158192263132e-38, "cur_lr": 0.0003, "total_loss": 6.376864115397136, "policy_loss": -0.00023348877827326456, "vf_loss": 6.37714942296346, "vf_explained_var": -1.3510386149088542e-06, "kl": 8.620847246574057e-05, "entropy": 0.5181859102514055, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5300000000002112, "episode_len_mean": 295.86, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.50000000000002, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, 30.9, -50.00000000000044, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, 33.70000000000004, 41.90000000000001, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 37.90000000000003, 4.699999999999626, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 45.1, 11.499999999999723, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.900000000000034, 37.300000000000026, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.10000000000001, 29.899999999999984, 44.7, 9.8999999999997, 22.49999999999988, 43.900000000000006, 34.900000000000034, 47.1, 14.699999999999768, 45.1, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 41.70000000000002, 11.099999999999717, 39.70000000000002, -50.00000000000044, 30.9, 39.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9], "episode_lengths": [500, 500, 176, 78, 68, 500, 500, 500, 500, 500, 500, 66, 56, 128, 500, 86, 192, 500, 56, 500, 46, 500, 500, 206, 164, 82, 96, 500, 78, 500, 500, 500, 210, 500, 122, 454, 150, 500, 500, 500, 54, 500, 500, 214, 50, 386, 34, 500, 118, 500, 152, 128, 70, 500, 68, 500, 500, 500, 48, 36, 500, 500, 500, 86, 500, 80, 202, 54, 402, 276, 62, 152, 30, 354, 50, 500, 500, 376, 50, 500, 500, 500, 210, 84, 64, 500, 500, 500, 84, 84, 390, 104, 500, 192, 104, 90, 500, 500, 92, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789868973495597, "mean_inference_ms": 1.2127636509757904, "mean_action_processing_ms": 0.14033426338667485, "mean_env_wait_ms": 0.08454198463703737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031990766525268555, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.13230490684509277}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5300000000002112, "episode_len_mean": 295.86, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.50000000000002, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 37.300000000000026, -50.00000000000044, 41.500000000000014, 30.9, -50.00000000000044, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, 33.70000000000004, 41.90000000000001, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 37.90000000000003, 4.699999999999626, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 28.699999999999967, 45.1, 11.499999999999723, 46.699999999999996, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.900000000000034, 37.300000000000026, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.10000000000001, 29.899999999999984, 44.7, 9.8999999999997, 22.49999999999988, 43.900000000000006, 34.900000000000034, 47.1, 14.699999999999768, 45.1, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 41.70000000000002, 11.099999999999717, 39.70000000000002, -50.00000000000044, 30.9, 39.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9], "episode_lengths": [500, 500, 176, 78, 68, 500, 500, 500, 500, 500, 500, 66, 56, 128, 500, 86, 192, 500, 56, 500, 46, 500, 500, 206, 164, 82, 96, 500, 78, 500, 500, 500, 210, 500, 122, 454, 150, 500, 500, 500, 54, 500, 500, 214, 50, 386, 34, 500, 118, 500, 152, 128, 70, 500, 68, 500, 500, 500, 48, 36, 500, 500, 500, 86, 500, 80, 202, 54, 402, 276, 62, 152, 30, 354, 50, 500, 500, 376, 50, 500, 500, 500, 210, 84, 64, 500, 500, 500, 84, 84, 390, 104, 500, 192, 104, 90, 500, 500, 92, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3789868973495597, "mean_inference_ms": 1.2127636509757904, "mean_action_processing_ms": 0.14033426338667485, "mean_env_wait_ms": 0.08454198463703737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031990766525268555, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.13230490684509277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5242.750569595313, "num_env_steps_trained_throughput_per_sec": 5242.750569595313, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2129.771, "sample_time_ms": 1923.032, "load_time_ms": 11.479, "load_throughput": 1045389.739, "learn_time_ms": 183.945, "learn_throughput": 65236.929, "synch_weights_time_ms": 9.935}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5662, "training_iteration": 123, "trial_id": "9f288_00018", "date": "2023-10-25_17-06-07", "timestamp": 1698249967, "time_this_iter_s": 2.294865846633911, "time_total_s": 265.09150195121765, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.09150195121765, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 61.43333333333333, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.88079096131566e-38, "cur_lr": 0.0003, "total_loss": 6.970778730180529, "policy_loss": -0.00053498355878724, "vf_loss": 6.971365928649902, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0006729262906838408, "entropy": 0.5213326215744019, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1112.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.627999999999819, "episode_len_mean": 264.36, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.10000000000001, 29.899999999999984, 44.7, 9.8999999999997, 22.49999999999988, 43.900000000000006, 34.900000000000034, 47.1, 14.699999999999768, 45.1, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 41.70000000000002, 11.099999999999717, 39.70000000000002, -50.00000000000044, 30.9, 39.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 46.9, 7.499999999999666, 45.3, -50.00000000000044, 45.3, 45.1, 45.5, 21.299999999999862, -50.00000000000044, 35.70000000000003, 45.5, 43.7, -50.00000000000044, 43.7, -50.00000000000044, 8.299999999999677, 32.700000000000024, 0.09999999999956088, 27.099999999999945, -50.00000000000044, 45.9, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 45.3, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 40.90000000000002, 30.499999999999993, 43.7, 40.10000000000002, 38.700000000000024, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [128, 70, 500, 68, 500, 500, 500, 48, 36, 500, 500, 500, 86, 500, 80, 202, 54, 402, 276, 62, 152, 30, 354, 50, 500, 500, 376, 50, 500, 500, 500, 210, 84, 64, 500, 500, 500, 84, 84, 390, 104, 500, 192, 104, 90, 500, 500, 92, 42, 500, 60, 500, 48, 32, 426, 48, 500, 48, 50, 46, 288, 500, 144, 46, 64, 500, 64, 500, 418, 174, 500, 230, 500, 42, 44, 52, 500, 500, 108, 46, 500, 48, 336, 500, 500, 68, 74, 500, 188, 500, 92, 196, 64, 100, 114, 82, 500, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790506973776397, "mean_inference_ms": 1.2131050219414101, "mean_action_processing_ms": 0.1404005337739589, "mean_env_wait_ms": 0.0844885231480157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399897575378418, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.13329267501831055}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.627999999999819, "episode_len_mean": 264.36, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 42.10000000000001, 29.899999999999984, 44.7, 9.8999999999997, 22.49999999999988, 43.900000000000006, 34.900000000000034, 47.1, 14.699999999999768, 45.1, -50.00000000000044, -50.00000000000044, 12.499999999999737, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 41.70000000000002, 11.099999999999717, 39.70000000000002, -50.00000000000044, 30.9, 39.70000000000002, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.3, 46.9, 7.499999999999666, 45.3, -50.00000000000044, 45.3, 45.1, 45.5, 21.299999999999862, -50.00000000000044, 35.70000000000003, 45.5, 43.7, -50.00000000000044, 43.7, -50.00000000000044, 8.299999999999677, 32.700000000000024, 0.09999999999956088, 27.099999999999945, -50.00000000000044, 45.9, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 45.3, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 40.90000000000002, 30.499999999999993, 43.7, 40.10000000000002, 38.700000000000024, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [128, 70, 500, 68, 500, 500, 500, 48, 36, 500, 500, 500, 86, 500, 80, 202, 54, 402, 276, 62, 152, 30, 354, 50, 500, 500, 376, 50, 500, 500, 500, 210, 84, 64, 500, 500, 500, 84, 84, 390, 104, 500, 192, 104, 90, 500, 500, 92, 42, 500, 60, 500, 48, 32, 426, 48, 500, 48, 50, 46, 288, 500, 144, 46, 64, 500, 64, 500, 418, 174, 500, 230, 500, 42, 44, 52, 500, 500, 108, 46, 500, 48, 336, 500, 500, 68, 74, 500, 188, 500, 92, 196, 64, 100, 114, 82, 500, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790506973776397, "mean_inference_ms": 1.2131050219414101, "mean_action_processing_ms": 0.1404005337739589, "mean_env_wait_ms": 0.0844885231480157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399897575378418, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.13329267501831055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6051.132256852957, "num_env_steps_trained_throughput_per_sec": 6051.132256852957, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2127.648, "sample_time_ms": 1920.862, "load_time_ms": 11.48, "load_throughput": 1045257.308, "learn_time_ms": 184.069, "learn_throughput": 65192.787, "synch_weights_time_ms": 9.855}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5713, "training_iteration": 124, "trial_id": "9f288_00018", "date": "2023-10-25_17-06-09", "timestamp": 1698249969, "time_this_iter_s": 1.9880967140197754, "time_total_s": 267.0795986652374, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.0795986652374, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 59.36666666666667, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.4039548065783e-39, "cur_lr": 0.0003, "total_loss": 7.092579046885173, "policy_loss": 9.405359418855773e-05, "vf_loss": 7.092537668016222, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00010851732981286154, "entropy": 0.5246813098589579, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.92199999999984, "episode_len_mean": 241.46, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.499999999999666, 45.3, -50.00000000000044, 45.3, 45.1, 45.5, 21.299999999999862, -50.00000000000044, 35.70000000000003, 45.5, 43.7, -50.00000000000044, 43.7, -50.00000000000044, 8.299999999999677, 32.700000000000024, 0.09999999999956088, 27.099999999999945, -50.00000000000044, 45.9, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 45.3, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 40.90000000000002, 30.499999999999993, 43.7, 40.10000000000002, 38.700000000000024, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.49999999999995, 44.7, 40.500000000000014, -50.00000000000044, 40.500000000000014, 41.90000000000001, 46.699999999999996, 45.7, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, 42.500000000000014, 45.5, 47.5, 37.300000000000026, 44.300000000000004, 46.099999999999994, 39.10000000000002, 38.90000000000002, -50.00000000000044, 11.499999999999723, 46.9, -50.00000000000044, 29.899999999999984, 47.1, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.5, 44.10000000000001, 11.099999999999717, -50.00000000000044, 13.099999999999746, 39.10000000000002, 41.90000000000001], "episode_lengths": [426, 48, 500, 48, 50, 46, 288, 500, 144, 46, 64, 500, 64, 500, 418, 174, 500, 230, 500, 42, 44, 52, 500, 500, 108, 46, 500, 48, 336, 500, 500, 68, 74, 500, 188, 500, 92, 196, 64, 100, 114, 82, 500, 32, 500, 500, 500, 100, 226, 54, 96, 500, 96, 82, 34, 44, 158, 500, 500, 500, 500, 66, 36, 500, 64, 58, 500, 500, 500, 144, 52, 76, 46, 26, 128, 58, 40, 110, 112, 500, 386, 32, 500, 202, 30, 500, 74, 86, 76, 500, 500, 500, 64, 46, 60, 390, 500, 370, 110, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791356359159158, "mean_inference_ms": 1.2124767632231837, "mean_action_processing_ms": 0.1407922206735585, "mean_env_wait_ms": 0.08459014931659276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998477935791016, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.11099600791931152}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.92199999999984, "episode_len_mean": 241.46, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.499999999999666, 45.3, -50.00000000000044, 45.3, 45.1, 45.5, 21.299999999999862, -50.00000000000044, 35.70000000000003, 45.5, 43.7, -50.00000000000044, 43.7, -50.00000000000044, 8.299999999999677, 32.700000000000024, 0.09999999999956088, 27.099999999999945, -50.00000000000044, 45.9, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, 45.3, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 31.300000000000004, -50.00000000000044, 40.90000000000002, 30.499999999999993, 43.7, 40.10000000000002, 38.700000000000024, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.49999999999995, 44.7, 40.500000000000014, -50.00000000000044, 40.500000000000014, 41.90000000000001, 46.699999999999996, 45.7, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.900000000000006, 42.500000000000014, 45.5, 47.5, 37.300000000000026, 44.300000000000004, 46.099999999999994, 39.10000000000002, 38.90000000000002, -50.00000000000044, 11.499999999999723, 46.9, -50.00000000000044, 29.899999999999984, 47.1, -50.00000000000044, 42.70000000000001, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.5, 44.10000000000001, 11.099999999999717, -50.00000000000044, 13.099999999999746, 39.10000000000002, 41.90000000000001], "episode_lengths": [426, 48, 500, 48, 50, 46, 288, 500, 144, 46, 64, 500, 64, 500, 418, 174, 500, 230, 500, 42, 44, 52, 500, 500, 108, 46, 500, 48, 336, 500, 500, 68, 74, 500, 188, 500, 92, 196, 64, 100, 114, 82, 500, 32, 500, 500, 500, 100, 226, 54, 96, 500, 96, 82, 34, 44, 158, 500, 500, 500, 500, 66, 36, 500, 64, 58, 500, 500, 500, 144, 52, 76, 46, 26, 128, 58, 40, 110, 112, 500, 386, 32, 500, 202, 30, 500, 74, 86, 76, 500, 500, 500, 64, 46, 60, 390, 500, 370, 110, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3791356359159158, "mean_inference_ms": 1.2124767632231837, "mean_action_processing_ms": 0.1407922206735585, "mean_env_wait_ms": 0.08459014931659276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998477935791016, "StateBufferConnector_ms": 0.00699925422668457, "ViewRequirementAgentConnector_ms": 0.11099600791931152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5677.329989386797, "num_env_steps_trained_throughput_per_sec": 5677.329989386797, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2121.293, "sample_time_ms": 1913.165, "load_time_ms": 11.08, "load_throughput": 1082990.272, "learn_time_ms": 185.855, "learn_throughput": 64566.411, "synch_weights_time_ms": 9.712}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5767, "training_iteration": 125, "trial_id": "9f288_00018", "date": "2023-10-25_17-06-11", "timestamp": 1698249971, "time_this_iter_s": 2.118666172027588, "time_total_s": 269.198264837265, "pid": 15120, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.198264837265, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 62.199999999999996, "ram_util_percent": 27.3}}
