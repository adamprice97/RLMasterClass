{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.390443563461304, "policy_loss": 0.01584547230352958, "vf_loss": 9.37400507926941, "vf_explained_var": 5.515416463216146e-05, "kl": 0.0033318076721890514, "entropy": 0.7336096862951914, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 6.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -27.286486486486837, "episode_len_mean": 435.35135135135135, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.900000000000034, 11.499999999999723, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 2.0999999999995893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 17.499999999999808, -50.00000000000044, 13.499999999999751, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 142, 386, 468, 500, 500, 348, 500, 500, 500, 60, 480, 500, 500, 500, 500, 500, 400, 500, 204, 500, 500, 500, 500, 500, 500, 500, 500, 248, 326, 500, 366, 180, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48173372640379125, "mean_inference_ms": 1.568678902723694, "mean_action_processing_ms": 0.19047880060253725, "mean_env_wait_ms": 0.11306336884375215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04053889094172297, "StateBufferConnector_ms": 0.005401791752995671, "ViewRequirementAgentConnector_ms": 0.14867782592773438}}, "episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -27.286486486486837, "episode_len_mean": 435.35135135135135, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.900000000000034, 11.499999999999723, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 2.0999999999995893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 17.499999999999808, -50.00000000000044, 13.499999999999751, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 142, 386, 468, 500, 500, 348, 500, 500, 500, 60, 480, 500, 500, 500, 500, 500, 400, 500, 204, 500, 500, 500, 500, 500, 500, 500, 500, 248, 326, 500, 366, 180, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48173372640379125, "mean_inference_ms": 1.568678902723694, "mean_action_processing_ms": 0.19047880060253725, "mean_env_wait_ms": 0.11306336884375215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04053889094172297, "StateBufferConnector_ms": 0.005401791752995671, "ViewRequirementAgentConnector_ms": 0.14867782592773438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4759.138071694057, "num_env_steps_trained_throughput_per_sec": 4759.138071694057, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3782.197, "sample_time_ms": 3655.918, "load_time_ms": 13.999, "load_throughput": 1285851.279, "learn_time_ms": 96.639, "learn_throughput": 186260.364, "synch_weights_time_ms": 12.626}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 37, "training_iteration": 1, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-35", "timestamp": 1698250955, "time_this_iter_s": 3.788961887359619, "time_total_s": 3.788961887359619, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.788961887359619, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 77.78333333333335, "ram_util_percent": 28.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.172417322794596, "policy_loss": 0.037391143230100475, "vf_loss": 9.135024944941202, "vf_explained_var": 0.0002443095048268636, "kl": 0.0007075484161447321, "entropy": 0.6967981358369192, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 18.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -15.168965517241672, "episode_len_mean": 387.7931034482759, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.900000000000034, 11.499999999999723, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 2.0999999999995893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 17.499999999999808, -50.00000000000044, 13.499999999999751, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 35.500000000000036, 31.500000000000007, 2.299999999999592, -50.00000000000044, -50.00000000000044, 40.500000000000014, 11.899999999999729, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 13.899999999999757, 36.900000000000034, -50.00000000000044, 32.90000000000003, 34.70000000000004, 26.09999999999993, 17.499999999999808, 18.499999999999822, 4.699999999999626, -50.00000000000044, 14.899999999999771, -50.00000000000044, 22.299999999999876, -50.00000000000044, 11.699999999999726, -50.00000000000044, 35.10000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 14.09999999999976, -50.00000000000044, 40.10000000000002, -50.00000000000044, 30.29999999999999, 20.699999999999854, 38.700000000000024, 33.10000000000003], "episode_lengths": [500, 500, 142, 386, 468, 500, 500, 348, 500, 500, 500, 60, 480, 500, 500, 500, 500, 500, 400, 500, 204, 500, 500, 500, 500, 500, 500, 500, 500, 248, 326, 500, 366, 180, 500, 500, 500, 396, 500, 146, 186, 478, 500, 500, 96, 382, 500, 500, 112, 500, 500, 108, 432, 500, 362, 132, 500, 172, 154, 240, 326, 316, 454, 500, 352, 500, 278, 500, 384, 500, 150, 140, 500, 500, 500, 500, 500, 500, 98, 360, 500, 100, 500, 198, 294, 114, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4768654622127305, "mean_inference_ms": 1.5972111695028226, "mean_action_processing_ms": 0.1833178789028856, "mean_env_wait_ms": 0.11122411476388347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038743567192691494, "StateBufferConnector_ms": 0.006897970177661413, "ViewRequirementAgentConnector_ms": 0.14396261894839935}}, "episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -15.168965517241672, "episode_len_mean": 387.7931034482759, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.900000000000034, 11.499999999999723, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 2.0999999999995893, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 17.499999999999808, -50.00000000000044, 13.499999999999751, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 35.500000000000036, 31.500000000000007, 2.299999999999592, -50.00000000000044, -50.00000000000044, 40.500000000000014, 11.899999999999729, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 13.899999999999757, 36.900000000000034, -50.00000000000044, 32.90000000000003, 34.70000000000004, 26.09999999999993, 17.499999999999808, 18.499999999999822, 4.699999999999626, -50.00000000000044, 14.899999999999771, -50.00000000000044, 22.299999999999876, -50.00000000000044, 11.699999999999726, -50.00000000000044, 35.10000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 14.09999999999976, -50.00000000000044, 40.10000000000002, -50.00000000000044, 30.29999999999999, 20.699999999999854, 38.700000000000024, 33.10000000000003], "episode_lengths": [500, 500, 142, 386, 468, 500, 500, 348, 500, 500, 500, 60, 480, 500, 500, 500, 500, 500, 400, 500, 204, 500, 500, 500, 500, 500, 500, 500, 500, 248, 326, 500, 366, 180, 500, 500, 500, 396, 500, 146, 186, 478, 500, 500, 96, 382, 500, 500, 112, 500, 500, 108, 432, 500, 362, 132, 500, 172, 154, 240, 326, 316, 454, 500, 352, 500, 278, 500, 384, 500, 150, 140, 500, 500, 500, 500, 500, 500, 98, 360, 500, 100, 500, 198, 294, 114, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4768654622127305, "mean_inference_ms": 1.5972111695028226, "mean_action_processing_ms": 0.1833178789028856, "mean_env_wait_ms": 0.11122411476388347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038743567192691494, "StateBufferConnector_ms": 0.006897970177661413, "ViewRequirementAgentConnector_ms": 0.14396261894839935}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4465.713440538099, "num_env_steps_trained_throughput_per_sec": 4465.713440538099, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3906.454, "sample_time_ms": 3722.343, "load_time_ms": 16.5, "load_throughput": 1090917.225, "learn_time_ms": 153.751, "learn_throughput": 117072.67, "synch_weights_time_ms": 11.354}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 87, "training_iteration": 2, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-39", "timestamp": 1698250959, "time_this_iter_s": 4.036711692810059, "time_total_s": 7.825673580169678, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 7.825673580169678, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 77.32, "ram_util_percent": 28.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.124979496002197, "policy_loss": -0.04564442470048865, "vf_loss": 9.17050544420878, "vf_explained_var": -9.402632713317871e-06, "kl": 0.003713139552814937, "entropy": 0.672599196434021, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 30.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0189999999998023, "episode_len_mean": 315.46, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 13.899999999999757, 36.900000000000034, -50.00000000000044, 32.90000000000003, 34.70000000000004, 26.09999999999993, 17.499999999999808, 18.499999999999822, 4.699999999999626, -50.00000000000044, 14.899999999999771, -50.00000000000044, 22.299999999999876, -50.00000000000044, 11.699999999999726, -50.00000000000044, 35.10000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 14.09999999999976, -50.00000000000044, 40.10000000000002, -50.00000000000044, 30.29999999999999, 20.699999999999854, 38.700000000000024, 33.10000000000003, -50.00000000000044, 22.099999999999874, 0.49999999999956657, 19.69999999999984, -50.00000000000044, -50.00000000000044, 40.500000000000014, 25.099999999999916, 40.30000000000002, 28.699999999999967, 26.69999999999994, 38.50000000000003, -50.00000000000044, 26.299999999999933, 30.499999999999993, 35.30000000000004, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 27.699999999999953, 14.899999999999771, -50.00000000000044, 33.500000000000036, 5.299999999999635, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.30000000000001, 35.30000000000004, 25.699999999999925, 26.89999999999994, -50.00000000000044, 20.49999999999985, 43.30000000000001, 43.30000000000001, -50.00000000000044, 34.70000000000004, 35.500000000000036, 36.30000000000003, 33.30000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, 18.899999999999828, 39.300000000000026, 38.10000000000002, 34.30000000000004, 44.300000000000004, 29.49999999999998, 27.899999999999956, 32.90000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 32.700000000000024], "episode_lengths": [112, 500, 500, 108, 432, 500, 362, 132, 500, 172, 154, 240, 326, 316, 454, 500, 352, 500, 278, 500, 384, 500, 150, 140, 500, 500, 500, 500, 500, 500, 98, 360, 500, 100, 500, 198, 294, 114, 170, 500, 280, 496, 304, 500, 500, 96, 250, 98, 214, 234, 116, 500, 238, 196, 148, 500, 328, 500, 500, 500, 500, 148, 224, 352, 500, 166, 448, 336, 500, 500, 88, 148, 244, 232, 500, 296, 68, 68, 500, 154, 146, 138, 168, 500, 94, 500, 312, 108, 120, 158, 58, 206, 222, 172, 344, 500, 500, 500, 210, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644865081608549, "mean_inference_ms": 1.5679599117245067, "mean_action_processing_ms": 0.17562012789283035, "mean_env_wait_ms": 0.10764651762894709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024709224700927734, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.13648772239685059}}, "episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0189999999998023, "episode_len_mean": 315.46, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 6.8999999999996575, -50.00000000000044, 13.899999999999757, 36.900000000000034, -50.00000000000044, 32.90000000000003, 34.70000000000004, 26.09999999999993, 17.499999999999808, 18.499999999999822, 4.699999999999626, -50.00000000000044, 14.899999999999771, -50.00000000000044, 22.299999999999876, -50.00000000000044, 11.699999999999726, -50.00000000000044, 35.10000000000004, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 14.09999999999976, -50.00000000000044, 40.10000000000002, -50.00000000000044, 30.29999999999999, 20.699999999999854, 38.700000000000024, 33.10000000000003, -50.00000000000044, 22.099999999999874, 0.49999999999956657, 19.69999999999984, -50.00000000000044, -50.00000000000044, 40.500000000000014, 25.099999999999916, 40.30000000000002, 28.699999999999967, 26.69999999999994, 38.50000000000003, -50.00000000000044, 26.299999999999933, 30.499999999999993, 35.30000000000004, -50.00000000000044, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 27.699999999999953, 14.899999999999771, -50.00000000000044, 33.500000000000036, 5.299999999999635, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.30000000000001, 35.30000000000004, 25.699999999999925, 26.89999999999994, -50.00000000000044, 20.49999999999985, 43.30000000000001, 43.30000000000001, -50.00000000000044, 34.70000000000004, 35.500000000000036, 36.30000000000003, 33.30000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, 18.899999999999828, 39.300000000000026, 38.10000000000002, 34.30000000000004, 44.300000000000004, 29.49999999999998, 27.899999999999956, 32.90000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 32.700000000000024], "episode_lengths": [112, 500, 500, 108, 432, 500, 362, 132, 500, 172, 154, 240, 326, 316, 454, 500, 352, 500, 278, 500, 384, 500, 150, 140, 500, 500, 500, 500, 500, 500, 98, 360, 500, 100, 500, 198, 294, 114, 170, 500, 280, 496, 304, 500, 500, 96, 250, 98, 214, 234, 116, 500, 238, 196, 148, 500, 328, 500, 500, 500, 500, 148, 224, 352, 500, 166, 448, 336, 500, 500, 88, 148, 244, 232, 500, 296, 68, 68, 500, 154, 146, 138, 168, 500, 94, 500, 312, 108, 120, 158, 58, 206, 222, 172, 344, 500, 500, 500, 210, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644865081608549, "mean_inference_ms": 1.5679599117245067, "mean_action_processing_ms": 0.17562012789283035, "mean_env_wait_ms": 0.10764651762894709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024709224700927734, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.13648772239685059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5135.088082292576, "num_env_steps_trained_throughput_per_sec": 5135.088082292576, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3772.735, "sample_time_ms": 3570.253, "load_time_ms": 16.0, "load_throughput": 1124997.72, "learn_time_ms": 171.217, "learn_throughput": 105129.525, "synch_weights_time_ms": 12.915}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 148, "training_iteration": 3, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-42", "timestamp": 1698250962, "time_this_iter_s": 3.512369155883789, "time_total_s": 11.338042736053467, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.338042736053467, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 72.22000000000001, "ram_util_percent": 28.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.15692933400472, "policy_loss": -0.0078028347343206406, "vf_loss": 9.164787451426188, "vf_explained_var": -3.39349110921224e-05, "kl": 0.0003752768519689198, "entropy": 0.6429143448670706, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 42.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.651999999999871, "episode_len_mean": 244.26, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.49999999999985, 43.30000000000001, 43.30000000000001, -50.00000000000044, 34.70000000000004, 35.500000000000036, 36.30000000000003, 33.30000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, 18.899999999999828, 39.300000000000026, 38.10000000000002, 34.30000000000004, 44.300000000000004, 29.49999999999998, 27.899999999999956, 32.90000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 32.700000000000024, 35.500000000000036, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.90000000000002, 37.50000000000003, -50.00000000000044, 21.499999999999865, 33.30000000000003, 18.099999999999817, -50.00000000000044, 41.100000000000016, 38.300000000000026, 40.70000000000002, 41.100000000000016, 38.50000000000003, 35.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, 12.69999999999974, 38.10000000000002, 43.30000000000001, 42.900000000000006, 34.10000000000004, 34.70000000000004, 40.70000000000002, -50.00000000000044, 37.50000000000003, 47.3, 20.299999999999848, 27.49999999999995, 38.10000000000002, -50.00000000000044, 40.500000000000014, 34.50000000000004, -50.00000000000044, 28.29999999999996, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.500000000000014, 40.30000000000002, 45.5, 43.30000000000001, 10.499999999999709, 40.70000000000002, 42.900000000000006, 44.10000000000001, 42.70000000000001, 36.50000000000003, 8.49999999999968, 44.300000000000004, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 39.10000000000002, 17.099999999999802, 31.1, 44.5, 44.300000000000004, 38.700000000000024, 36.900000000000034, -50.00000000000044, -50.00000000000044, 13.499999999999751, 16.699999999999797, 2.0999999999995893, 20.299999999999848, 43.30000000000001, 6.499999999999652, 18.499999999999822, -50.00000000000044], "episode_lengths": [296, 68, 68, 500, 154, 146, 138, 168, 500, 94, 500, 312, 108, 120, 158, 58, 206, 222, 172, 344, 500, 500, 500, 210, 174, 146, 500, 328, 500, 92, 126, 500, 286, 168, 320, 500, 90, 118, 94, 90, 116, 150, 86, 500, 500, 202, 374, 120, 68, 72, 160, 154, 94, 500, 126, 28, 298, 226, 120, 500, 96, 156, 500, 218, 500, 308, 500, 76, 98, 46, 68, 396, 94, 72, 60, 74, 136, 416, 58, 180, 118, 500, 500, 110, 330, 190, 56, 58, 114, 132, 500, 500, 366, 334, 480, 298, 68, 436, 316, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4600099039282422, "mean_inference_ms": 1.515179478071953, "mean_action_processing_ms": 0.17268183354841787, "mean_env_wait_ms": 0.10431791523776973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.1396951675415039}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.651999999999871, "episode_len_mean": 244.26, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.49999999999985, 43.30000000000001, 43.30000000000001, -50.00000000000044, 34.70000000000004, 35.500000000000036, 36.30000000000003, 33.30000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, 18.899999999999828, 39.300000000000026, 38.10000000000002, 34.30000000000004, 44.300000000000004, 29.49999999999998, 27.899999999999956, 32.90000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 32.700000000000024, 35.500000000000036, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.90000000000002, 37.50000000000003, -50.00000000000044, 21.499999999999865, 33.30000000000003, 18.099999999999817, -50.00000000000044, 41.100000000000016, 38.300000000000026, 40.70000000000002, 41.100000000000016, 38.50000000000003, 35.10000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, 12.69999999999974, 38.10000000000002, 43.30000000000001, 42.900000000000006, 34.10000000000004, 34.70000000000004, 40.70000000000002, -50.00000000000044, 37.50000000000003, 47.3, 20.299999999999848, 27.49999999999995, 38.10000000000002, -50.00000000000044, 40.500000000000014, 34.50000000000004, -50.00000000000044, 28.29999999999996, -50.00000000000044, 19.299999999999834, -50.00000000000044, 42.500000000000014, 40.30000000000002, 45.5, 43.30000000000001, 10.499999999999709, 40.70000000000002, 42.900000000000006, 44.10000000000001, 42.70000000000001, 36.50000000000003, 8.49999999999968, 44.300000000000004, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 39.10000000000002, 17.099999999999802, 31.1, 44.5, 44.300000000000004, 38.700000000000024, 36.900000000000034, -50.00000000000044, -50.00000000000044, 13.499999999999751, 16.699999999999797, 2.0999999999995893, 20.299999999999848, 43.30000000000001, 6.499999999999652, 18.499999999999822, -50.00000000000044], "episode_lengths": [296, 68, 68, 500, 154, 146, 138, 168, 500, 94, 500, 312, 108, 120, 158, 58, 206, 222, 172, 344, 500, 500, 500, 210, 174, 146, 500, 328, 500, 92, 126, 500, 286, 168, 320, 500, 90, 118, 94, 90, 116, 150, 86, 500, 500, 202, 374, 120, 68, 72, 160, 154, 94, 500, 126, 28, 298, 226, 120, 500, 96, 156, 500, 218, 500, 308, 500, 76, 98, 46, 68, 396, 94, 72, 60, 74, 136, 416, 58, 180, 118, 500, 500, 110, 330, 190, 56, 58, 114, 132, 500, 500, 366, 334, 480, 298, 68, 436, 316, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4600099039282422, "mean_inference_ms": 1.515179478071953, "mean_action_processing_ms": 0.17268183354841787, "mean_env_wait_ms": 0.10431791523776973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.1396951675415039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4974.662110294654, "num_env_steps_trained_throughput_per_sec": 4974.662110294654, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3734.135, "sample_time_ms": 3511.454, "load_time_ms": 24.009, "load_throughput": 749719.188, "learn_time_ms": 183.872, "learn_throughput": 97894.1, "synch_weights_time_ms": 12.534}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 223, "training_iteration": 4, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-46", "timestamp": 1698250966, "time_this_iter_s": 3.625324010848999, "time_total_s": 14.963366746902466, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 14.963366746902466, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 72.22, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 9.04954735438029, "policy_loss": 0.024245796725153923, "vf_loss": 9.025360266367594, "vf_explained_var": -3.6557515462239585e-06, "kl": 0.00033454968394153184, "entropy": 0.6287366797526678, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 54.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.040999999999851, "episode_len_mean": 255.32, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 44.10000000000001, 42.70000000000001, 36.50000000000003, 8.49999999999968, 44.300000000000004, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 39.10000000000002, 17.099999999999802, 31.1, 44.5, 44.300000000000004, 38.700000000000024, 36.900000000000034, -50.00000000000044, -50.00000000000044, 13.499999999999751, 16.699999999999797, 2.0999999999995893, 20.299999999999848, 43.30000000000001, 6.499999999999652, 18.499999999999822, -50.00000000000044, 31.500000000000007, 40.30000000000002, 38.90000000000002, 42.70000000000001, 43.10000000000001, 18.29999999999982, 40.90000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 42.30000000000001, 33.70000000000004, 12.69999999999974, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 30.699999999999996, 41.30000000000001, 44.10000000000001, 18.499999999999822, -50.00000000000044, 19.09999999999983, 44.300000000000004, 40.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.70000000000004, 44.10000000000001, 46.5, 28.699999999999967, 22.899999999999885, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 38.50000000000003, 45.9, 44.10000000000001, 14.899999999999771, 30.699999999999996, 28.89999999999997, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 37.300000000000026, 36.10000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 23.29999999999989, 32.700000000000024, -50.00000000000044, 43.7, -50.00000000000044, 41.100000000000016, 2.499999999999595, 41.100000000000016, 36.50000000000003, 39.70000000000002, 36.70000000000003], "episode_lengths": [72, 60, 74, 136, 416, 58, 180, 118, 500, 500, 110, 330, 190, 56, 58, 114, 132, 500, 500, 366, 334, 480, 298, 68, 436, 316, 500, 186, 98, 112, 74, 70, 318, 92, 500, 500, 256, 78, 164, 374, 500, 500, 58, 500, 218, 500, 500, 500, 126, 194, 88, 60, 316, 500, 310, 58, 92, 500, 40, 500, 154, 60, 36, 214, 272, 500, 40, 90, 500, 500, 88, 52, 116, 42, 60, 352, 194, 212, 500, 98, 500, 500, 500, 248, 128, 140, 116, 500, 500, 268, 174, 500, 64, 500, 90, 476, 90, 136, 104, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4560544335146507, "mean_inference_ms": 1.506990466761257, "mean_action_processing_ms": 0.17249319383084794, "mean_env_wait_ms": 0.10470709995548606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.014008045196533203, "ViewRequirementAgentConnector_ms": 0.14440631866455078}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.040999999999851, "episode_len_mean": 255.32, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 44.10000000000001, 42.70000000000001, 36.50000000000003, 8.49999999999968, 44.300000000000004, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 39.10000000000002, 17.099999999999802, 31.1, 44.5, 44.300000000000004, 38.700000000000024, 36.900000000000034, -50.00000000000044, -50.00000000000044, 13.499999999999751, 16.699999999999797, 2.0999999999995893, 20.299999999999848, 43.30000000000001, 6.499999999999652, 18.499999999999822, -50.00000000000044, 31.500000000000007, 40.30000000000002, 38.90000000000002, 42.70000000000001, 43.10000000000001, 18.29999999999982, 40.90000000000002, -50.00000000000044, -50.00000000000044, 24.499999999999908, 42.30000000000001, 33.70000000000004, 12.69999999999974, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 30.699999999999996, 41.30000000000001, 44.10000000000001, 18.499999999999822, -50.00000000000044, 19.09999999999983, 44.300000000000004, 40.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.70000000000004, 44.10000000000001, 46.5, 28.699999999999967, 22.899999999999885, -50.00000000000044, 46.099999999999994, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 38.50000000000003, 45.9, 44.10000000000001, 14.899999999999771, 30.699999999999996, 28.89999999999997, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 37.300000000000026, 36.10000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 23.29999999999989, 32.700000000000024, -50.00000000000044, 43.7, -50.00000000000044, 41.100000000000016, 2.499999999999595, 41.100000000000016, 36.50000000000003, 39.70000000000002, 36.70000000000003], "episode_lengths": [72, 60, 74, 136, 416, 58, 180, 118, 500, 500, 110, 330, 190, 56, 58, 114, 132, 500, 500, 366, 334, 480, 298, 68, 436, 316, 500, 186, 98, 112, 74, 70, 318, 92, 500, 500, 256, 78, 164, 374, 500, 500, 58, 500, 218, 500, 500, 500, 126, 194, 88, 60, 316, 500, 310, 58, 92, 500, 40, 500, 154, 60, 36, 214, 272, 500, 40, 90, 500, 500, 88, 52, 116, 42, 60, 352, 194, 212, 500, 98, 500, 500, 500, 248, 128, 140, 116, 500, 500, 268, 174, 500, 64, 500, 90, 476, 90, 136, 104, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4560544335146507, "mean_inference_ms": 1.506990466761257, "mean_action_processing_ms": 0.17249319383084794, "mean_env_wait_ms": 0.10470709995548606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.014008045196533203, "ViewRequirementAgentConnector_ms": 0.14440631866455078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4920.902287748674, "num_env_steps_trained_throughput_per_sec": 4920.902287748674, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3718.881, "sample_time_ms": 3489.196, "load_time_ms": 22.607, "load_throughput": 796198.704, "learn_time_ms": 192.442, "learn_throughput": 93534.542, "synch_weights_time_ms": 12.422}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 296, "training_iteration": 5, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-50", "timestamp": 1698250970, "time_this_iter_s": 3.665999174118042, "time_total_s": 18.629365921020508, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 18.629365921020508, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 71.78, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 9.162563721338907, "policy_loss": 0.007649687739710013, "vf_loss": 9.154974699020386, "vf_explained_var": -6.0300032297770185e-06, "kl": 0.0003795770170924584, "entropy": 0.6319272617499033, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 66.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.561999999999868, "episode_len_mean": 245.12, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.899999999999771, 30.699999999999996, 28.89999999999997, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 37.300000000000026, 36.10000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 23.29999999999989, 32.700000000000024, -50.00000000000044, 43.7, -50.00000000000044, 41.100000000000016, 2.499999999999595, 41.100000000000016, 36.50000000000003, 39.70000000000002, 36.70000000000003, 36.70000000000003, 43.900000000000006, -50.00000000000044, 39.90000000000002, 42.10000000000001, 21.89999999999987, 26.499999999999936, 37.300000000000026, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 37.70000000000003, 43.7, 4.699999999999626, 38.700000000000024, 15.699999999999783, 39.70000000000002, 41.90000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.70000000000003, 44.300000000000004, 43.30000000000001, 39.70000000000002, 41.100000000000016, -50.00000000000044, 44.900000000000006, 43.900000000000006, 33.30000000000003, 32.90000000000003, 24.499999999999908, -50.00000000000044, 42.30000000000001, 34.30000000000004, 40.10000000000002, 38.90000000000002, 43.7, 45.9, 30.499999999999993, 31.900000000000013, 45.7, -50.00000000000044, 37.70000000000003, 39.70000000000002, 23.8999999999999, 42.30000000000001, 32.30000000000002, 22.899999999999885, -50.00000000000044, -50.00000000000044, 32.700000000000024, 43.30000000000001, -50.00000000000044, 10.899999999999714, 23.8999999999999, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 30.699999999999996, 44.5, -50.00000000000044, 45.9, 25.499999999999922, -50.00000000000044, 38.10000000000002, 23.29999999999989, 38.300000000000026, 24.299999999999905], "episode_lengths": [352, 194, 212, 500, 98, 500, 500, 500, 248, 128, 140, 116, 500, 500, 268, 174, 500, 64, 500, 90, 476, 90, 136, 104, 134, 134, 62, 500, 102, 80, 282, 236, 128, 500, 220, 500, 500, 148, 500, 124, 64, 454, 114, 344, 104, 82, 500, 146, 500, 118, 500, 144, 58, 68, 104, 90, 500, 52, 62, 168, 172, 256, 500, 78, 158, 100, 112, 64, 42, 196, 182, 44, 500, 124, 104, 262, 78, 178, 272, 500, 500, 174, 68, 500, 392, 262, 144, 500, 500, 36, 194, 56, 500, 42, 246, 500, 120, 268, 118, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4550485812792287, "mean_inference_ms": 1.4935552700329902, "mean_action_processing_ms": 0.17142684209299788, "mean_env_wait_ms": 0.10386086128823982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025504112243652344, "StateBufferConnector_ms": 0.009013652801513672, "ViewRequirementAgentConnector_ms": 0.16599082946777344}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.561999999999868, "episode_len_mean": 245.12, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.899999999999771, 30.699999999999996, 28.89999999999997, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 37.300000000000026, 36.10000000000004, 38.50000000000003, -50.00000000000044, -50.00000000000044, 23.29999999999989, 32.700000000000024, -50.00000000000044, 43.7, -50.00000000000044, 41.100000000000016, 2.499999999999595, 41.100000000000016, 36.50000000000003, 39.70000000000002, 36.70000000000003, 36.70000000000003, 43.900000000000006, -50.00000000000044, 39.90000000000002, 42.10000000000001, 21.89999999999987, 26.499999999999936, 37.300000000000026, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 37.70000000000003, 43.7, 4.699999999999626, 38.700000000000024, 15.699999999999783, 39.70000000000002, 41.90000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.70000000000003, 44.300000000000004, 43.30000000000001, 39.70000000000002, 41.100000000000016, -50.00000000000044, 44.900000000000006, 43.900000000000006, 33.30000000000003, 32.90000000000003, 24.499999999999908, -50.00000000000044, 42.30000000000001, 34.30000000000004, 40.10000000000002, 38.90000000000002, 43.7, 45.9, 30.499999999999993, 31.900000000000013, 45.7, -50.00000000000044, 37.70000000000003, 39.70000000000002, 23.8999999999999, 42.30000000000001, 32.30000000000002, 22.899999999999885, -50.00000000000044, -50.00000000000044, 32.700000000000024, 43.30000000000001, -50.00000000000044, 10.899999999999714, 23.8999999999999, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 30.699999999999996, 44.5, -50.00000000000044, 45.9, 25.499999999999922, -50.00000000000044, 38.10000000000002, 23.29999999999989, 38.300000000000026, 24.299999999999905], "episode_lengths": [352, 194, 212, 500, 98, 500, 500, 500, 248, 128, 140, 116, 500, 500, 268, 174, 500, 64, 500, 90, 476, 90, 136, 104, 134, 134, 62, 500, 102, 80, 282, 236, 128, 500, 220, 500, 500, 148, 500, 124, 64, 454, 114, 344, 104, 82, 500, 146, 500, 118, 500, 144, 58, 68, 104, 90, 500, 52, 62, 168, 172, 256, 500, 78, 158, 100, 112, 64, 42, 196, 182, 44, 500, 124, 104, 262, 78, 178, 272, 500, 500, 174, 68, 500, 392, 262, 144, 500, 500, 36, 194, 56, 500, 42, 246, 500, 120, 268, 118, 258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4550485812792287, "mean_inference_ms": 1.4935552700329902, "mean_action_processing_ms": 0.17142684209299788, "mean_env_wait_ms": 0.10386086128823982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025504112243652344, "StateBufferConnector_ms": 0.009013652801513672, "ViewRequirementAgentConnector_ms": 0.16599082946777344}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4654.640727386259, "num_env_steps_trained_throughput_per_sec": 4654.640727386259, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3743.586, "sample_time_ms": 3508.337, "load_time_ms": 22.761, "load_throughput": 790836.52, "learn_time_ms": 198.114, "learn_throughput": 90856.78, "synch_weights_time_ms": 12.363}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 371, "training_iteration": 6, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-54", "timestamp": 1698250974, "time_this_iter_s": 3.8731069564819336, "time_total_s": 22.50247287750244, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.50247287750244, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 67.63333333333334, "ram_util_percent": 28.616666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 9.093677361806234, "policy_loss": 0.003320268510530392, "vf_loss": 9.0904168287913, "vf_explained_var": -7.897615432739258e-06, "kl": 0.00018607545797758954, "entropy": 0.6000544230143229, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 78.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.929999999999872, "episode_len_mean": 231.46, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.700000000000024, 43.30000000000001, -50.00000000000044, 10.899999999999714, 23.8999999999999, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 30.699999999999996, 44.5, -50.00000000000044, 45.9, 25.499999999999922, -50.00000000000044, 38.10000000000002, 23.29999999999989, 38.300000000000026, 24.299999999999905, 25.099999999999916, 33.500000000000036, 24.899999999999913, 23.699999999999896, 31.500000000000007, 44.300000000000004, 39.10000000000002, 25.699999999999925, -50.00000000000044, 42.70000000000001, 32.50000000000002, 43.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.70000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.9, 37.300000000000026, 42.10000000000001, 41.30000000000001, 33.90000000000004, 30.29999999999999, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 8.49999999999968, -50.00000000000044, 41.30000000000001, 41.500000000000014, -50.00000000000044, 29.899999999999984, 43.50000000000001, 37.50000000000003, 45.3, 44.300000000000004, 44.900000000000006, 34.70000000000004, 41.70000000000002, 4.699999999999626, 43.30000000000001, -50.00000000000044, 31.1, 41.30000000000001, 26.69999999999994, 40.500000000000014, 15.099999999999774, 43.10000000000001, -50.00000000000044, 23.499999999999893, 42.900000000000006, -50.00000000000044, 44.300000000000004, 16.499999999999794, 40.90000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 30.499999999999993, 38.50000000000003, 41.500000000000014, 44.10000000000001, 45.9, 16.09999999999979, 19.499999999999837, 31.300000000000004, 46.5, -50.00000000000044, 45.9, 44.300000000000004, 44.5, 46.3], "episode_lengths": [500, 500, 174, 68, 500, 392, 262, 144, 500, 500, 36, 194, 56, 500, 42, 246, 500, 120, 268, 118, 258, 250, 166, 252, 264, 186, 58, 110, 244, 500, 74, 176, 70, 42, 500, 500, 74, 94, 154, 500, 500, 500, 166, 42, 128, 80, 88, 162, 198, 500, 500, 204, 500, 416, 500, 88, 86, 500, 202, 66, 126, 48, 58, 52, 154, 84, 454, 68, 500, 190, 88, 234, 96, 350, 70, 500, 266, 72, 500, 58, 336, 92, 500, 500, 112, 56, 196, 116, 86, 60, 42, 340, 306, 188, 36, 500, 42, 58, 56, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45705301641817114, "mean_inference_ms": 1.4848761378168762, "mean_action_processing_ms": 0.1707925667120977, "mean_env_wait_ms": 0.10422006687768136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299880027770996, "StateBufferConnector_ms": 0.0038940906524658203, "ViewRequirementAgentConnector_ms": 0.1701955795288086}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.929999999999872, "episode_len_mean": 231.46, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.700000000000024, 43.30000000000001, -50.00000000000044, 10.899999999999714, 23.8999999999999, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.5, 30.699999999999996, 44.5, -50.00000000000044, 45.9, 25.499999999999922, -50.00000000000044, 38.10000000000002, 23.29999999999989, 38.300000000000026, 24.299999999999905, 25.099999999999916, 33.500000000000036, 24.899999999999913, 23.699999999999896, 31.500000000000007, 44.300000000000004, 39.10000000000002, 25.699999999999925, -50.00000000000044, 42.70000000000001, 32.50000000000002, 43.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.70000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.9, 37.300000000000026, 42.10000000000001, 41.30000000000001, 33.90000000000004, 30.29999999999999, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 8.49999999999968, -50.00000000000044, 41.30000000000001, 41.500000000000014, -50.00000000000044, 29.899999999999984, 43.50000000000001, 37.50000000000003, 45.3, 44.300000000000004, 44.900000000000006, 34.70000000000004, 41.70000000000002, 4.699999999999626, 43.30000000000001, -50.00000000000044, 31.1, 41.30000000000001, 26.69999999999994, 40.500000000000014, 15.099999999999774, 43.10000000000001, -50.00000000000044, 23.499999999999893, 42.900000000000006, -50.00000000000044, 44.300000000000004, 16.499999999999794, 40.90000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 30.499999999999993, 38.50000000000003, 41.500000000000014, 44.10000000000001, 45.9, 16.09999999999979, 19.499999999999837, 31.300000000000004, 46.5, -50.00000000000044, 45.9, 44.300000000000004, 44.5, 46.3], "episode_lengths": [500, 500, 174, 68, 500, 392, 262, 144, 500, 500, 36, 194, 56, 500, 42, 246, 500, 120, 268, 118, 258, 250, 166, 252, 264, 186, 58, 110, 244, 500, 74, 176, 70, 42, 500, 500, 74, 94, 154, 500, 500, 500, 166, 42, 128, 80, 88, 162, 198, 500, 500, 204, 500, 416, 500, 88, 86, 500, 202, 66, 126, 48, 58, 52, 154, 84, 454, 68, 500, 190, 88, 234, 96, 350, 70, 500, 266, 72, 500, 58, 336, 92, 500, 500, 112, 56, 196, 116, 86, 60, 42, 340, 306, 188, 36, 500, 42, 58, 56, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45705301641817114, "mean_inference_ms": 1.4848761378168762, "mean_action_processing_ms": 0.1707925667120977, "mean_env_wait_ms": 0.10422006687768136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299880027770996, "StateBufferConnector_ms": 0.0038940906524658203, "ViewRequirementAgentConnector_ms": 0.1701955795288086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4836.0406886701285, "num_env_steps_trained_throughput_per_sec": 4836.0406886701285, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3740.51, "sample_time_ms": 3503.744, "load_time_ms": 23.035, "load_throughput": 781419.057, "learn_time_ms": 199.616, "learn_throughput": 90172.953, "synch_weights_time_ms": 12.104}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 450, "training_iteration": 7, "trial_id": "9f288_00022", "date": "2023-10-25_17-22-57", "timestamp": 1698250977, "time_this_iter_s": 3.7281501293182373, "time_total_s": 26.23062300682068, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.23062300682068, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 74.16, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.812986612319946, "policy_loss": -0.024871380999684334, "vf_loss": 8.837915182113647, "vf_explained_var": 1.2949109077453613e-05, "kl": 0.00023584462913106563, "entropy": 0.5710102518399557, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.583999999999843, "episode_len_mean": 244.84, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.699999999999626, 43.30000000000001, -50.00000000000044, 31.1, 41.30000000000001, 26.69999999999994, 40.500000000000014, 15.099999999999774, 43.10000000000001, -50.00000000000044, 23.499999999999893, 42.900000000000006, -50.00000000000044, 44.300000000000004, 16.499999999999794, 40.90000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 30.499999999999993, 38.50000000000003, 41.500000000000014, 44.10000000000001, 45.9, 16.09999999999979, 19.499999999999837, 31.300000000000004, 46.5, -50.00000000000044, 45.9, 44.300000000000004, 44.5, 46.3, -50.00000000000044, 44.900000000000006, 44.7, 34.50000000000004, 42.500000000000014, 39.50000000000002, 27.899999999999956, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 37.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 39.90000000000002, 46.3, 40.30000000000002, 14.899999999999771, 42.30000000000001, 44.10000000000001, 45.1, 28.29999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 23.499999999999893, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 46.099999999999994, 44.10000000000001, 22.49999999999988, 46.099999999999994, 27.299999999999947, 42.10000000000001, 27.49999999999995, 35.30000000000004, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, -50.00000000000044], "episode_lengths": [454, 68, 500, 190, 88, 234, 96, 350, 70, 500, 266, 72, 500, 58, 336, 92, 500, 500, 112, 56, 196, 116, 86, 60, 42, 340, 306, 188, 36, 500, 42, 58, 56, 38, 500, 52, 54, 156, 76, 106, 222, 50, 500, 500, 500, 500, 500, 148, 128, 500, 60, 500, 500, 500, 500, 112, 102, 38, 98, 352, 78, 60, 50, 218, 68, 500, 500, 40, 500, 500, 40, 226, 500, 500, 500, 38, 266, 500, 78, 500, 500, 500, 62, 58, 40, 60, 276, 40, 228, 80, 226, 148, 500, 42, 58, 500, 500, 58, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4552415575241484, "mean_inference_ms": 1.4794721602784826, "mean_action_processing_ms": 0.16985207274648093, "mean_env_wait_ms": 0.10461185625548478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598666191101074, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.1410224437713623}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.583999999999843, "episode_len_mean": 244.84, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.699999999999626, 43.30000000000001, -50.00000000000044, 31.1, 41.30000000000001, 26.69999999999994, 40.500000000000014, 15.099999999999774, 43.10000000000001, -50.00000000000044, 23.499999999999893, 42.900000000000006, -50.00000000000044, 44.300000000000004, 16.499999999999794, 40.90000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.5, 30.499999999999993, 38.50000000000003, 41.500000000000014, 44.10000000000001, 45.9, 16.09999999999979, 19.499999999999837, 31.300000000000004, 46.5, -50.00000000000044, 45.9, 44.300000000000004, 44.5, 46.3, -50.00000000000044, 44.900000000000006, 44.7, 34.50000000000004, 42.500000000000014, 39.50000000000002, 27.899999999999956, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 37.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 39.90000000000002, 46.3, 40.30000000000002, 14.899999999999771, 42.30000000000001, 44.10000000000001, 45.1, 28.29999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 23.499999999999893, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 46.099999999999994, 44.10000000000001, 22.49999999999988, 46.099999999999994, 27.299999999999947, 42.10000000000001, 27.49999999999995, 35.30000000000004, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, -50.00000000000044], "episode_lengths": [454, 68, 500, 190, 88, 234, 96, 350, 70, 500, 266, 72, 500, 58, 336, 92, 500, 500, 112, 56, 196, 116, 86, 60, 42, 340, 306, 188, 36, 500, 42, 58, 56, 38, 500, 52, 54, 156, 76, 106, 222, 50, 500, 500, 500, 500, 500, 148, 128, 500, 60, 500, 500, 500, 500, 112, 102, 38, 98, 352, 78, 60, 50, 218, 68, 500, 500, 40, 500, 500, 40, 226, 500, 500, 500, 38, 266, 500, 78, 500, 500, 500, 62, 58, 40, 60, 276, 40, 228, 80, 226, 148, 500, 42, 58, 500, 500, 58, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4552415575241484, "mean_inference_ms": 1.4794721602784826, "mean_action_processing_ms": 0.16985207274648093, "mean_env_wait_ms": 0.10461185625548478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598666191101074, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.1410224437713623}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5031.2442063782855, "num_env_steps_trained_throughput_per_sec": 5031.2442063782855, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3720.151, "sample_time_ms": 3482.309, "load_time_ms": 22.597, "load_throughput": 796552.784, "learn_time_ms": 200.896, "learn_throughput": 89598.561, "synch_weights_time_ms": 12.341}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 516, "training_iteration": 8, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-01", "timestamp": 1698250981, "time_this_iter_s": 3.583646535873413, "time_total_s": 29.814269542694092, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.814269542694092, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 73.72, "ram_util_percent": 28.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 8.75559409459432, "policy_loss": 0.042302693550785385, "vf_loss": 8.713345527648926, "vf_explained_var": 1.7434358596801758e-06, "kl": 0.00047802643258402594, "entropy": 0.543497363726298, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 102.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.993999999999799, "episode_len_mean": 280.66, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 23.499999999999893, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 46.099999999999994, 44.10000000000001, 22.49999999999988, 46.099999999999994, 27.299999999999947, 42.10000000000001, 27.49999999999995, 35.30000000000004, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, -50.00000000000044, 28.499999999999964, 21.89999999999987, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.900000000000006, 42.70000000000001, 45.3, -50.00000000000044, 45.9, 13.099999999999746, 36.900000000000034, 35.70000000000003, -50.00000000000044, 46.5, 20.899999999999856, 44.300000000000004, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 28.29999999999996, 44.7, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 17.69999999999981, 43.50000000000001, 27.49999999999995, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.7, 44.900000000000006, 12.299999999999734, 31.1, 43.7, 46.5], "episode_lengths": [218, 68, 500, 500, 40, 500, 500, 40, 226, 500, 500, 500, 38, 266, 500, 78, 500, 500, 500, 62, 58, 40, 60, 276, 40, 228, 80, 226, 148, 500, 42, 58, 500, 500, 58, 86, 500, 216, 282, 56, 500, 500, 70, 500, 100, 500, 62, 74, 48, 500, 42, 370, 132, 144, 500, 36, 292, 58, 494, 500, 500, 500, 34, 218, 54, 392, 500, 500, 500, 32, 68, 66, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 118, 500, 136, 324, 66, 226, 48, 500, 70, 500, 480, 500, 64, 52, 378, 190, 64, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4557048703832363, "mean_inference_ms": 1.4811335721695644, "mean_action_processing_ms": 0.17007144429491164, "mean_env_wait_ms": 0.10408496611580169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04198575019836426, "StateBufferConnector_ms": 0.012989521026611328, "ViewRequirementAgentConnector_ms": 0.13899016380310059}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.993999999999799, "episode_len_mean": 280.66, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 23.499999999999893, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 46.099999999999994, 44.10000000000001, 22.49999999999988, 46.099999999999994, 27.299999999999947, 42.10000000000001, 27.49999999999995, 35.30000000000004, -50.00000000000044, 45.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, -50.00000000000044, 28.499999999999964, 21.89999999999987, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.900000000000006, 42.70000000000001, 45.3, -50.00000000000044, 45.9, 13.099999999999746, 36.900000000000034, 35.70000000000003, -50.00000000000044, 46.5, 20.899999999999856, 44.300000000000004, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 28.29999999999996, 44.7, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.30000000000001, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 17.69999999999981, 43.50000000000001, 27.49999999999995, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.7, 44.900000000000006, 12.299999999999734, 31.1, 43.7, 46.5], "episode_lengths": [218, 68, 500, 500, 40, 500, 500, 40, 226, 500, 500, 500, 38, 266, 500, 78, 500, 500, 500, 62, 58, 40, 60, 276, 40, 228, 80, 226, 148, 500, 42, 58, 500, 500, 58, 86, 500, 216, 282, 56, 500, 500, 70, 500, 100, 500, 62, 74, 48, 500, 42, 370, 132, 144, 500, 36, 292, 58, 494, 500, 500, 500, 34, 218, 54, 392, 500, 500, 500, 32, 68, 66, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 118, 500, 136, 324, 66, 226, 48, 500, 70, 500, 480, 500, 64, 52, 378, 190, 64, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4557048703832363, "mean_inference_ms": 1.4811335721695644, "mean_action_processing_ms": 0.17007144429491164, "mean_env_wait_ms": 0.10408496611580169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04198575019836426, "StateBufferConnector_ms": 0.012989521026611328, "ViewRequirementAgentConnector_ms": 0.13899016380310059}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4940.209165644675, "num_env_steps_trained_throughput_per_sec": 4940.209165644675, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3711.642, "sample_time_ms": 3476.199, "load_time_ms": 21.776, "load_throughput": 826587.506, "learn_time_ms": 199.52, "learn_throughput": 90216.685, "synch_weights_time_ms": 12.14}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 579, "training_iteration": 9, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-05", "timestamp": 1698250985, "time_this_iter_s": 3.6495678424835205, "time_total_s": 33.46383738517761, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.46383738517761, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 73.36, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 8.640993118286133, "policy_loss": 0.015783378621563315, "vf_loss": 8.62526043256124, "vf_explained_var": 1.2387832005818685e-05, "kl": 0.00014473935614015923, "entropy": 0.5067778180042902, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 114.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.293999999999804, "episode_len_mean": 277.66, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 17.69999999999981, 43.50000000000001, 27.49999999999995, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.7, 44.900000000000006, 12.299999999999734, 31.1, 43.7, 46.5, 40.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, 40.500000000000014, 43.50000000000001, 41.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 42.500000000000014, 39.90000000000002, 12.299999999999734, -50.00000000000044, 11.899999999999729, 5.6999999999996405, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 16.09999999999979, 38.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 33.10000000000003, 46.3, 25.699999999999925, 44.900000000000006, 41.70000000000002, 42.10000000000001, -50.00000000000044, 43.50000000000001, 43.7, 44.7, 45.9, 40.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 32.90000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 46.099999999999994, -50.00000000000044, 30.099999999999987, 44.900000000000006], "episode_lengths": [66, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 118, 500, 136, 324, 66, 226, 48, 500, 70, 500, 480, 500, 64, 52, 378, 190, 64, 36, 94, 500, 32, 500, 96, 66, 86, 82, 500, 500, 84, 500, 76, 500, 500, 500, 500, 416, 76, 102, 378, 500, 382, 444, 500, 500, 500, 500, 164, 340, 118, 60, 500, 500, 46, 170, 38, 244, 52, 84, 80, 500, 66, 64, 54, 42, 92, 500, 44, 500, 36, 162, 500, 500, 186, 172, 500, 40, 64, 500, 500, 136, 86, 40, 500, 500, 24, 40, 500, 200, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537454823851277, "mean_inference_ms": 1.4730176532534682, "mean_action_processing_ms": 0.16925982735871842, "mean_env_wait_ms": 0.103236926320361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03798651695251465, "StateBufferConnector_ms": 0.0069828033447265625, "ViewRequirementAgentConnector_ms": 0.15606451034545898}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.293999999999804, "episode_len_mean": 277.66, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.50000000000003, 17.69999999999981, 43.50000000000001, 27.49999999999995, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 43.7, 44.900000000000006, 12.299999999999734, 31.1, 43.7, 46.5, 40.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, 40.500000000000014, 43.50000000000001, 41.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 42.500000000000014, 39.90000000000002, 12.299999999999734, -50.00000000000044, 11.899999999999729, 5.6999999999996405, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004, 16.09999999999979, 38.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 33.10000000000003, 46.3, 25.699999999999925, 44.900000000000006, 41.70000000000002, 42.10000000000001, -50.00000000000044, 43.50000000000001, 43.7, 44.7, 45.9, 40.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 32.90000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 46.099999999999994, -50.00000000000044, 30.099999999999987, 44.900000000000006], "episode_lengths": [66, 38, 500, 500, 500, 500, 500, 500, 500, 500, 500, 118, 500, 136, 324, 66, 226, 48, 500, 70, 500, 480, 500, 64, 52, 378, 190, 64, 36, 94, 500, 32, 500, 96, 66, 86, 82, 500, 500, 84, 500, 76, 500, 500, 500, 500, 416, 76, 102, 378, 500, 382, 444, 500, 500, 500, 500, 164, 340, 118, 60, 500, 500, 46, 170, 38, 244, 52, 84, 80, 500, 66, 64, 54, 42, 92, 500, 44, 500, 36, 162, 500, 500, 186, 172, 500, 40, 64, 500, 500, 136, 86, 40, 500, 500, 24, 40, 500, 200, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4537454823851277, "mean_inference_ms": 1.4730176532534682, "mean_action_processing_ms": 0.16925982735871842, "mean_env_wait_ms": 0.103236926320361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03798651695251465, "StateBufferConnector_ms": 0.0069828033447265625, "ViewRequirementAgentConnector_ms": 0.15606451034545898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5166.734885819205, "num_env_steps_trained_throughput_per_sec": 5166.734885819205, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3688.861, "sample_time_ms": 3452.752, "load_time_ms": 21.358, "load_throughput": 842758.088, "learn_time_ms": 200.816, "learn_throughput": 89634.085, "synch_weights_time_ms": 11.826}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 650, "training_iteration": 10, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-08", "timestamp": 1698250988, "time_this_iter_s": 3.4907219409942627, "time_total_s": 36.954559326171875, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.954559326171875, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 70.9, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 8.35304351647695, "policy_loss": -0.042341182474046946, "vf_loss": 8.395434856414795, "vf_explained_var": -3.968675931294759e-06, "kl": 3.462948331230583e-05, "entropy": 0.5001569067438444, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 126.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.65299999999982, "episode_len_mean": 259.08, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.699999999999925, 44.900000000000006, 41.70000000000002, 42.10000000000001, -50.00000000000044, 43.50000000000001, 43.7, 44.7, 45.9, 40.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 32.90000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 46.099999999999994, -50.00000000000044, 30.099999999999987, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 45.5, 33.70000000000004, 44.900000000000006, 40.500000000000014, 3.0999999999996035, 1.4999999999995808, -50.00000000000044, 28.89999999999997, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, -50.00000000000044, 45.5, 47.9, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, 28.29999999999996, 47.3, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 46.699999999999996, 45.9, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 47.1, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001], "episode_lengths": [244, 52, 84, 80, 500, 66, 64, 54, 42, 92, 500, 44, 500, 36, 162, 500, 500, 186, 172, 500, 40, 64, 500, 500, 136, 86, 40, 500, 500, 24, 40, 500, 200, 52, 500, 82, 500, 136, 500, 60, 500, 500, 54, 52, 500, 46, 164, 52, 96, 470, 486, 500, 212, 500, 260, 500, 500, 44, 82, 500, 46, 22, 500, 500, 124, 500, 500, 200, 218, 28, 500, 176, 64, 500, 500, 500, 58, 56, 34, 42, 62, 42, 500, 500, 500, 202, 30, 40, 500, 90, 500, 180, 500, 36, 92, 500, 136, 500, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4535233807135936, "mean_inference_ms": 1.4648939613062375, "mean_action_processing_ms": 0.16923178281421614, "mean_env_wait_ms": 0.10244953820599138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027982711791992188, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.14370512962341309}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.65299999999982, "episode_len_mean": 259.08, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.699999999999925, 44.900000000000006, 41.70000000000002, 42.10000000000001, -50.00000000000044, 43.50000000000001, 43.7, 44.7, 45.9, 40.90000000000002, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 31.500000000000007, 32.90000000000003, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 46.099999999999994, -50.00000000000044, 30.099999999999987, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 45.5, 33.70000000000004, 44.900000000000006, 40.500000000000014, 3.0999999999996035, 1.4999999999995808, -50.00000000000044, 28.89999999999997, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, -50.00000000000044, 45.5, 47.9, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, 28.29999999999996, 47.3, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 46.699999999999996, 45.9, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 47.1, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001], "episode_lengths": [244, 52, 84, 80, 500, 66, 64, 54, 42, 92, 500, 44, 500, 36, 162, 500, 500, 186, 172, 500, 40, 64, 500, 500, 136, 86, 40, 500, 500, 24, 40, 500, 200, 52, 500, 82, 500, 136, 500, 60, 500, 500, 54, 52, 500, 46, 164, 52, 96, 470, 486, 500, 212, 500, 260, 500, 500, 44, 82, 500, 46, 22, 500, 500, 124, 500, 500, 200, 218, 28, 500, 176, 64, 500, 500, 500, 58, 56, 34, 42, 62, 42, 500, 500, 500, 202, 30, 40, 500, 90, 500, 180, 500, 36, 92, 500, 136, 500, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4535233807135936, "mean_inference_ms": 1.4648939613062375, "mean_action_processing_ms": 0.16923178281421614, "mean_env_wait_ms": 0.10244953820599138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027982711791992188, "StateBufferConnector_ms": 0.005000591278076172, "ViewRequirementAgentConnector_ms": 0.14370512962341309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5089.046945974149, "num_env_steps_trained_throughput_per_sec": 5089.046945974149, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3664.342, "sample_time_ms": 3417.164, "load_time_ms": 21.357, "load_throughput": 842816.418, "learn_time_ms": 212.165, "learn_throughput": 84839.573, "synch_weights_time_ms": 11.65}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 716, "training_iteration": 11, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-12", "timestamp": 1698250992, "time_this_iter_s": 3.5440027713775635, "time_total_s": 40.49856209754944, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.49856209754944, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 71.6, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 8.337009270985922, "policy_loss": 0.024419184002908878, "vf_loss": 8.31264034907023, "vf_explained_var": 2.7666489283243814e-06, "kl": 7.471044828684843e-05, "entropy": 0.49775508791208267, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 138.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.507999999999826, "episode_len_mean": 255.54, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 47.3, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 46.699999999999996, 45.9, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 47.1, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.700000000000024, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 39.50000000000002, 31.500000000000007, 33.90000000000004, 4.099999999999618, 47.5, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.1, 37.10000000000003, -50.00000000000044, 45.9, 39.70000000000002, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.699999999999768, 44.300000000000004, 43.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 43.7, 45.1, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 47.5, 36.10000000000004, 27.899999999999956, -50.00000000000044, 35.10000000000004, 47.7, -50.00000000000044, 43.900000000000006, 27.699999999999953, 18.29999999999982, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, -50.00000000000044, 32.50000000000002, 33.500000000000036, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.499999999999893], "episode_lengths": [218, 28, 500, 176, 64, 500, 500, 500, 58, 56, 34, 42, 62, 42, 500, 500, 500, 202, 30, 40, 500, 90, 500, 180, 500, 36, 92, 500, 136, 500, 500, 74, 500, 114, 34, 48, 500, 500, 106, 186, 162, 460, 26, 500, 38, 500, 48, 30, 130, 500, 42, 104, 42, 80, 500, 500, 500, 500, 354, 58, 68, 500, 102, 500, 500, 500, 32, 42, 64, 50, 500, 500, 254, 38, 26, 140, 222, 500, 150, 24, 500, 62, 224, 318, 500, 124, 500, 500, 40, 98, 500, 176, 166, 44, 500, 74, 500, 500, 28, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45217592734443657, "mean_inference_ms": 1.4586929865330842, "mean_action_processing_ms": 0.16877769600049183, "mean_env_wait_ms": 0.10205762628822482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199601173400879, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.12098383903503418}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.507999999999826, "episode_len_mean": 255.54, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 47.3, -50.00000000000044, 32.50000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 46.699999999999996, 45.9, 43.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 47.1, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.100000000000016, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.700000000000024, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 39.50000000000002, 31.500000000000007, 33.90000000000004, 4.099999999999618, 47.5, -50.00000000000044, 46.3, -50.00000000000044, 45.3, 47.1, 37.10000000000003, -50.00000000000044, 45.9, 39.70000000000002, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.699999999999768, 44.300000000000004, 43.30000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 43.7, 45.1, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 47.5, 36.10000000000004, 27.899999999999956, -50.00000000000044, 35.10000000000004, 47.7, -50.00000000000044, 43.900000000000006, 27.699999999999953, 18.29999999999982, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, -50.00000000000044, 32.50000000000002, 33.500000000000036, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.499999999999893], "episode_lengths": [218, 28, 500, 176, 64, 500, 500, 500, 58, 56, 34, 42, 62, 42, 500, 500, 500, 202, 30, 40, 500, 90, 500, 180, 500, 36, 92, 500, 136, 500, 500, 74, 500, 114, 34, 48, 500, 500, 106, 186, 162, 460, 26, 500, 38, 500, 48, 30, 130, 500, 42, 104, 42, 80, 500, 500, 500, 500, 354, 58, 68, 500, 102, 500, 500, 500, 32, 42, 64, 50, 500, 500, 254, 38, 26, 140, 222, 500, 150, 24, 500, 62, 224, 318, 500, 124, 500, 500, 40, 98, 500, 176, 166, 44, 500, 74, 500, 500, 28, 266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45217592734443657, "mean_inference_ms": 1.4586929865330842, "mean_action_processing_ms": 0.16877769600049183, "mean_env_wait_ms": 0.10205762628822482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199601173400879, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.12098383903503418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5258.522277900965, "num_env_steps_trained_throughput_per_sec": 5258.522277900965, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3603.572, "sample_time_ms": 3357.279, "load_time_ms": 21.228, "load_throughput": 847931.786, "learn_time_ms": 211.319, "learn_throughput": 85179.329, "synch_weights_time_ms": 11.67}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 784, "training_iteration": 12, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-15", "timestamp": 1698250995, "time_this_iter_s": 3.4280154705047607, "time_total_s": 43.9265775680542, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 43.9265775680542, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 68.75999999999999, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 8.163829445838928, "policy_loss": -0.06336946397398908, "vf_loss": 8.227252642313639, "vf_explained_var": -1.245737075805664e-05, "kl": 7.2677859481729e-05, "entropy": 0.5359984834988912, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 150.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.142999999999827, "episode_len_mean": 254.22, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 43.7, 45.1, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 47.5, 36.10000000000004, 27.899999999999956, -50.00000000000044, 35.10000000000004, 47.7, -50.00000000000044, 43.900000000000006, 27.699999999999953, 18.29999999999982, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, -50.00000000000044, 32.50000000000002, 33.500000000000036, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.499999999999893, -50.00000000000044, 10.899999999999714, 45.1, -50.00000000000044, 0.8999999999995723, 45.9, 44.300000000000004, 43.900000000000006, 39.10000000000002, 6.099999999999646, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 43.10000000000001, -50.00000000000044, 42.70000000000001, 17.499999999999808, 45.1, 44.5, 31.500000000000007, 24.499999999999908, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 31.900000000000013, 24.499999999999908, -50.00000000000044, 14.699999999999768, -50.00000000000044, 45.9, 45.3, -50.00000000000044, 46.099999999999994, 29.099999999999973, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.499999999999922, 45.1, 38.300000000000026, 46.5, 45.5, 42.500000000000014, -50.00000000000044, 38.90000000000002, 46.3, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [42, 64, 50, 500, 500, 254, 38, 26, 140, 222, 500, 150, 24, 500, 62, 224, 318, 500, 124, 500, 500, 40, 98, 500, 176, 166, 44, 500, 74, 500, 500, 28, 266, 500, 392, 50, 500, 492, 42, 58, 62, 110, 440, 70, 500, 500, 60, 72, 500, 500, 34, 34, 70, 500, 74, 326, 50, 56, 186, 256, 28, 500, 500, 32, 182, 256, 500, 354, 500, 42, 48, 500, 40, 210, 500, 500, 26, 500, 500, 60, 500, 500, 500, 84, 246, 50, 118, 36, 46, 76, 500, 112, 38, 500, 134, 68, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4503829141241213, "mean_inference_ms": 1.4567508746202507, "mean_action_processing_ms": 0.16883353300815615, "mean_env_wait_ms": 0.10132841621156716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010295867919922, "StateBufferConnector_ms": 0.008004903793334961, "ViewRequirementAgentConnector_ms": 0.14361882209777832}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.142999999999827, "episode_len_mean": 254.22, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 43.7, 45.1, -50.00000000000044, -50.00000000000044, 24.69999999999991, 46.3, 47.5, 36.10000000000004, 27.899999999999956, -50.00000000000044, 35.10000000000004, 47.7, -50.00000000000044, 43.900000000000006, 27.699999999999953, 18.29999999999982, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.30000000000002, -50.00000000000044, 32.50000000000002, 33.500000000000036, 45.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.499999999999893, -50.00000000000044, 10.899999999999714, 45.1, -50.00000000000044, 0.8999999999995723, 45.9, 44.300000000000004, 43.900000000000006, 39.10000000000002, 6.099999999999646, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 43.10000000000001, -50.00000000000044, 42.70000000000001, 17.499999999999808, 45.1, 44.5, 31.500000000000007, 24.499999999999908, 47.3, -50.00000000000044, -50.00000000000044, 46.9, 31.900000000000013, 24.499999999999908, -50.00000000000044, 14.699999999999768, -50.00000000000044, 45.9, 45.3, -50.00000000000044, 46.099999999999994, 29.099999999999973, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.499999999999922, 45.1, 38.300000000000026, 46.5, 45.5, 42.500000000000014, -50.00000000000044, 38.90000000000002, 46.3, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [42, 64, 50, 500, 500, 254, 38, 26, 140, 222, 500, 150, 24, 500, 62, 224, 318, 500, 124, 500, 500, 40, 98, 500, 176, 166, 44, 500, 74, 500, 500, 28, 266, 500, 392, 50, 500, 492, 42, 58, 62, 110, 440, 70, 500, 500, 60, 72, 500, 500, 34, 34, 70, 500, 74, 326, 50, 56, 186, 256, 28, 500, 500, 32, 182, 256, 500, 354, 500, 42, 48, 500, 40, 210, 500, 500, 26, 500, 500, 60, 500, 500, 500, 84, 246, 50, 118, 36, 46, 76, 500, 112, 38, 500, 134, 68, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4503829141241213, "mean_inference_ms": 1.4567508746202507, "mean_action_processing_ms": 0.16883353300815615, "mean_env_wait_ms": 0.10132841621156716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010295867919922, "StateBufferConnector_ms": 0.008004903793334961, "ViewRequirementAgentConnector_ms": 0.14361882209777832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4893.146753236569, "num_env_steps_trained_throughput_per_sec": 4893.146753236569, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3620.904, "sample_time_ms": 3372.543, "load_time_ms": 21.131, "load_throughput": 851843.847, "learn_time_ms": 213.936, "learn_throughput": 84137.155, "synch_weights_time_ms": 11.121}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 851, "training_iteration": 13, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-19", "timestamp": 1698250999, "time_this_iter_s": 3.6853463649749756, "time_total_s": 47.611923933029175, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.611923933029175, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 73.04, "ram_util_percent": 28.560000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 8.027998884518942, "policy_loss": -0.00299706868827343, "vf_loss": 8.031047701835632, "vf_explained_var": -5.880991617838542e-06, "kl": 0.00021733893478170785, "entropy": 0.519535260895888, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 162.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3659999999998265, "episode_len_mean": 257.0, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.499999999999922, 45.1, 38.300000000000026, 46.5, 45.5, 42.500000000000014, -50.00000000000044, 38.90000000000002, 46.3, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.1, 37.70000000000003, 28.699999999999967, 45.3, 45.3, -50.00000000000044, 36.70000000000003, 40.90000000000002, -50.00000000000044, 40.90000000000002, 30.099999999999987, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.9, 20.099999999999845, 43.900000000000006, 42.30000000000001, 41.90000000000001, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 31.70000000000001, 47.1, 41.100000000000016, 44.900000000000006, -50.00000000000044, 33.90000000000004, 38.300000000000026, 21.299999999999862, 42.500000000000014, 40.90000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.900000000000006, 38.10000000000002, 30.099999999999987, 43.900000000000006, 46.099999999999994, 46.699999999999996, 43.10000000000001, 44.900000000000006, 2.8999999999996007, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, 44.7, 0.2999999999995637, -50.00000000000044, 16.09999999999979, 45.1, 45.1, 12.499999999999737, -50.00000000000044, -50.00000000000044, 44.7, 15.099999999999774, -50.00000000000044, 24.899999999999913, -50.00000000000044, 31.500000000000007, 19.299999999999834, -50.00000000000044, 40.90000000000002, 45.9], "episode_lengths": [500, 500, 26, 500, 500, 60, 500, 500, 500, 84, 246, 50, 118, 36, 46, 76, 500, 112, 38, 500, 134, 68, 500, 500, 72, 500, 500, 500, 54, 30, 124, 214, 48, 48, 500, 134, 92, 500, 92, 200, 500, 500, 68, 32, 300, 62, 78, 82, 500, 492, 500, 184, 30, 90, 52, 500, 162, 118, 288, 76, 92, 500, 110, 500, 500, 32, 62, 120, 200, 62, 40, 34, 70, 52, 472, 28, 500, 500, 500, 500, 358, 54, 498, 500, 340, 50, 50, 376, 500, 500, 54, 350, 500, 252, 500, 186, 308, 500, 92, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45020136545027467, "mean_inference_ms": 1.4532171212991682, "mean_action_processing_ms": 0.16833347468194937, "mean_env_wait_ms": 0.1015039653928434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029747962951660156, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.1447620391845703}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3659999999998265, "episode_len_mean": 257.0, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.499999999999922, 45.1, 38.300000000000026, 46.5, 45.5, 42.500000000000014, -50.00000000000044, 38.90000000000002, 46.3, -50.00000000000044, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.1, 37.70000000000003, 28.699999999999967, 45.3, 45.3, -50.00000000000044, 36.70000000000003, 40.90000000000002, -50.00000000000044, 40.90000000000002, 30.099999999999987, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.9, 20.099999999999845, 43.900000000000006, 42.30000000000001, 41.90000000000001, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 31.70000000000001, 47.1, 41.100000000000016, 44.900000000000006, -50.00000000000044, 33.90000000000004, 38.300000000000026, 21.299999999999862, 42.500000000000014, 40.90000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.900000000000006, 38.10000000000002, 30.099999999999987, 43.900000000000006, 46.099999999999994, 46.699999999999996, 43.10000000000001, 44.900000000000006, 2.8999999999996007, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, 44.7, 0.2999999999995637, -50.00000000000044, 16.09999999999979, 45.1, 45.1, 12.499999999999737, -50.00000000000044, -50.00000000000044, 44.7, 15.099999999999774, -50.00000000000044, 24.899999999999913, -50.00000000000044, 31.500000000000007, 19.299999999999834, -50.00000000000044, 40.90000000000002, 45.9], "episode_lengths": [500, 500, 26, 500, 500, 60, 500, 500, 500, 84, 246, 50, 118, 36, 46, 76, 500, 112, 38, 500, 134, 68, 500, 500, 72, 500, 500, 500, 54, 30, 124, 214, 48, 48, 500, 134, 92, 500, 92, 200, 500, 500, 68, 32, 300, 62, 78, 82, 500, 492, 500, 184, 30, 90, 52, 500, 162, 118, 288, 76, 92, 500, 110, 500, 500, 32, 62, 120, 200, 62, 40, 34, 70, 52, 472, 28, 500, 500, 500, 500, 358, 54, 498, 500, 340, 50, 50, 376, 500, 500, 54, 350, 500, 252, 500, 186, 308, 500, 92, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45020136545027467, "mean_inference_ms": 1.4532171212991682, "mean_action_processing_ms": 0.16833347468194937, "mean_env_wait_ms": 0.1015039653928434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029747962951660156, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.1447620391845703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5217.100639168056, "num_env_steps_trained_throughput_per_sec": 5217.100639168056, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3604.09, "sample_time_ms": 3359.273, "load_time_ms": 18.034, "load_throughput": 998126.263, "learn_time_ms": 213.532, "learn_throughput": 84296.369, "synch_weights_time_ms": 11.079}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 925, "training_iteration": 14, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-22", "timestamp": 1698251002, "time_this_iter_s": 3.4581873416900635, "time_total_s": 51.07011127471924, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.07011127471924, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.42, "ram_util_percent": 28.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.5858460664749146, "policy_loss": -0.009659050808598598, "vf_loss": 6.595553795496623, "vf_explained_var": -1.286466916402181e-06, "kl": 0.0004250748493414373, "entropy": 0.4858628213405609, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 174.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.179999999999802, "episode_len_mean": 278.82, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.900000000000006, 38.10000000000002, 30.099999999999987, 43.900000000000006, 46.099999999999994, 46.699999999999996, 43.10000000000001, 44.900000000000006, 2.8999999999996007, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, 44.7, 0.2999999999995637, -50.00000000000044, 16.09999999999979, 45.1, 45.1, 12.499999999999737, -50.00000000000044, -50.00000000000044, 44.7, 15.099999999999774, -50.00000000000044, 24.899999999999913, -50.00000000000044, 31.500000000000007, 19.299999999999834, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.5, 40.70000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 40.500000000000014, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.10000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 45.5, 21.89999999999987, 42.30000000000001, 41.500000000000014, 27.899999999999956, 0.2999999999995637, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.900000000000006, -50.00000000000044, 12.099999999999731, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 29.899999999999984, -50.00000000000044, 38.50000000000003, -50.00000000000044, 17.099999999999802, 45.1, 44.900000000000006, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.30000000000004, 40.500000000000014], "episode_lengths": [110, 500, 500, 32, 62, 120, 200, 62, 40, 34, 70, 52, 472, 28, 500, 500, 500, 500, 358, 54, 498, 500, 340, 50, 50, 376, 500, 500, 54, 350, 500, 252, 500, 186, 308, 500, 92, 42, 500, 500, 60, 48, 500, 500, 500, 142, 500, 500, 158, 36, 94, 60, 40, 500, 500, 46, 96, 72, 78, 500, 500, 500, 46, 80, 122, 60, 500, 46, 282, 78, 86, 222, 498, 500, 210, 500, 62, 500, 380, 500, 500, 60, 500, 500, 46, 202, 500, 116, 500, 330, 50, 52, 500, 294, 500, 500, 94, 500, 148, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4489409104182807, "mean_inference_ms": 1.4526078975867551, "mean_action_processing_ms": 0.16860099811393575, "mean_env_wait_ms": 0.1010059469469124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034238338470458984, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.13964390754699707}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.179999999999802, "episode_len_mean": 278.82, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.900000000000006, 38.10000000000002, 30.099999999999987, 43.900000000000006, 46.099999999999994, 46.699999999999996, 43.10000000000001, 44.900000000000006, 2.8999999999996007, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, 44.7, 0.2999999999995637, -50.00000000000044, 16.09999999999979, 45.1, 45.1, 12.499999999999737, -50.00000000000044, -50.00000000000044, 44.7, 15.099999999999774, -50.00000000000044, 24.899999999999913, -50.00000000000044, 31.500000000000007, 19.299999999999834, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 34.30000000000004, 46.5, 40.70000000000002, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 40.500000000000014, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.10000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 45.5, 21.89999999999987, 42.30000000000001, 41.500000000000014, 27.899999999999956, 0.2999999999995637, -50.00000000000044, 29.099999999999973, -50.00000000000044, 43.900000000000006, -50.00000000000044, 12.099999999999731, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 29.899999999999984, -50.00000000000044, 38.50000000000003, -50.00000000000044, 17.099999999999802, 45.1, 44.900000000000006, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.30000000000004, 40.500000000000014], "episode_lengths": [110, 500, 500, 32, 62, 120, 200, 62, 40, 34, 70, 52, 472, 28, 500, 500, 500, 500, 358, 54, 498, 500, 340, 50, 50, 376, 500, 500, 54, 350, 500, 252, 500, 186, 308, 500, 92, 42, 500, 500, 60, 48, 500, 500, 500, 142, 500, 500, 158, 36, 94, 60, 40, 500, 500, 46, 96, 72, 78, 500, 500, 500, 46, 80, 122, 60, 500, 46, 282, 78, 86, 222, 498, 500, 210, 500, 62, 500, 380, 500, 500, 60, 500, 500, 46, 202, 500, 116, 500, 330, 50, 52, 500, 294, 500, 500, 94, 500, 148, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4489409104182807, "mean_inference_ms": 1.4526078975867551, "mean_action_processing_ms": 0.16860099811393575, "mean_env_wait_ms": 0.1010059469469124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034238338470458984, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.13964390754699707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5056.427061242816, "num_env_steps_trained_throughput_per_sec": 5056.427061242816, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3594.186, "sample_time_ms": 3363.257, "load_time_ms": 17.534, "load_throughput": 1026603.826, "learn_time_ms": 200.142, "learn_throughput": 89936.177, "synch_weights_time_ms": 10.982}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 987, "training_iteration": 15, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-26", "timestamp": 1698251006, "time_this_iter_s": 3.5665414333343506, "time_total_s": 54.63665270805359, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.63665270805359, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 28.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 7.303507010142009, "policy_loss": 0.05559628394742807, "vf_loss": 7.247961242993672, "vf_explained_var": 6.556510925292969e-07, "kl": 6.291835998695205e-05, "entropy": 0.5050635437170664, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 186.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.136999999999833, "episode_len_mean": 264.3, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, 12.099999999999731, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 29.899999999999984, -50.00000000000044, 38.50000000000003, -50.00000000000044, 17.099999999999802, 45.1, 44.900000000000006, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.30000000000004, 40.500000000000014, -50.00000000000044, 28.699999999999967, 16.09999999999979, 40.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 42.70000000000001, -50.00000000000044, 1.4999999999995808, 43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 44.10000000000001, 39.50000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.50000000000002, 41.500000000000014, 24.899999999999913, 44.5, 40.90000000000002, 35.70000000000003, 38.700000000000024, 39.50000000000002, 43.7, 44.300000000000004, 27.299999999999947, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, 46.099999999999994, 42.500000000000014, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 7.699999999999669, 35.10000000000004, -50.00000000000044, 19.499999999999837, 33.10000000000003, -50.00000000000044, 23.29999999999989, 21.299999999999862, 24.899999999999913, 23.8999999999999, 31.900000000000013, 38.300000000000026, 32.700000000000024, -50.00000000000044, 31.70000000000001, 46.9, 20.099999999999845, 39.10000000000002, 46.099999999999994, 42.10000000000001, 45.9, 42.70000000000001, 20.49999999999985, 46.3], "episode_lengths": [500, 62, 500, 380, 500, 500, 60, 500, 500, 46, 202, 500, 116, 500, 330, 50, 52, 500, 294, 500, 500, 94, 500, 148, 96, 500, 214, 340, 92, 500, 38, 500, 74, 500, 486, 68, 500, 258, 500, 60, 106, 500, 62, 500, 106, 86, 252, 56, 92, 144, 114, 106, 64, 58, 228, 100, 500, 500, 32, 500, 70, 500, 194, 500, 40, 76, 500, 64, 234, 500, 46, 38, 500, 500, 500, 212, 424, 150, 500, 306, 170, 500, 268, 288, 252, 262, 182, 118, 174, 500, 184, 32, 300, 110, 40, 80, 42, 74, 296, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4487404414300889, "mean_inference_ms": 1.4520263476450932, "mean_action_processing_ms": 0.16871241597498532, "mean_env_wait_ms": 0.10091300595047763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034006357192993164, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.15768647193908691}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.136999999999833, "episode_len_mean": 264.3, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, 12.099999999999731, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 29.899999999999984, -50.00000000000044, 38.50000000000003, -50.00000000000044, 17.099999999999802, 45.1, 44.900000000000006, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.30000000000004, 40.500000000000014, -50.00000000000044, 28.699999999999967, 16.09999999999979, 40.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 42.70000000000001, -50.00000000000044, 1.4999999999995808, 43.30000000000001, -50.00000000000044, 24.299999999999905, -50.00000000000044, 44.10000000000001, 39.50000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 39.50000000000002, 41.500000000000014, 24.899999999999913, 44.5, 40.90000000000002, 35.70000000000003, 38.700000000000024, 39.50000000000002, 43.7, 44.300000000000004, 27.299999999999947, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, 46.099999999999994, 42.500000000000014, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 7.699999999999669, 35.10000000000004, -50.00000000000044, 19.499999999999837, 33.10000000000003, -50.00000000000044, 23.29999999999989, 21.299999999999862, 24.899999999999913, 23.8999999999999, 31.900000000000013, 38.300000000000026, 32.700000000000024, -50.00000000000044, 31.70000000000001, 46.9, 20.099999999999845, 39.10000000000002, 46.099999999999994, 42.10000000000001, 45.9, 42.70000000000001, 20.49999999999985, 46.3], "episode_lengths": [500, 62, 500, 380, 500, 500, 60, 500, 500, 46, 202, 500, 116, 500, 330, 50, 52, 500, 294, 500, 500, 94, 500, 148, 96, 500, 214, 340, 92, 500, 38, 500, 74, 500, 486, 68, 500, 258, 500, 60, 106, 500, 62, 500, 106, 86, 252, 56, 92, 144, 114, 106, 64, 58, 228, 100, 500, 500, 32, 500, 70, 500, 194, 500, 40, 76, 500, 64, 234, 500, 46, 38, 500, 500, 500, 212, 424, 150, 500, 306, 170, 500, 268, 288, 252, 262, 182, 118, 174, 500, 184, 32, 300, 110, 40, 80, 42, 74, 296, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4487404414300889, "mean_inference_ms": 1.4520263476450932, "mean_action_processing_ms": 0.16871241597498532, "mean_env_wait_ms": 0.10091300595047763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034006357192993164, "StateBufferConnector_ms": 0.006996870040893555, "ViewRequirementAgentConnector_ms": 0.15768647193908691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5031.754231563752, "num_env_steps_trained_throughput_per_sec": 5031.754231563752, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3565.203, "sample_time_ms": 3337.34, "load_time_ms": 16.581, "load_throughput": 1085599.465, "learn_time_ms": 198.185, "learn_throughput": 90824.267, "synch_weights_time_ms": 10.726}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1062, "training_iteration": 16, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-30", "timestamp": 1698251010, "time_this_iter_s": 3.5852837562561035, "time_total_s": 58.22193646430969, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.22193646430969, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 75.78, "ram_util_percent": 28.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.902967015902202, "policy_loss": -0.0015955620134870212, "vf_loss": 6.904615163803101, "vf_explained_var": -1.7335017522176106e-06, "kl": 7.491265879148538e-05, "entropy": 0.5270242889722189, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 198.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.482999999999834, "episode_len_mean": 260.84, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 26.69999999999994, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 7.699999999999669, 35.10000000000004, -50.00000000000044, 19.499999999999837, 33.10000000000003, -50.00000000000044, 23.29999999999989, 21.299999999999862, 24.899999999999913, 23.8999999999999, 31.900000000000013, 38.300000000000026, 32.700000000000024, -50.00000000000044, 31.70000000000001, 46.9, 20.099999999999845, 39.10000000000002, 46.099999999999994, 42.10000000000001, 45.9, 42.70000000000001, 20.49999999999985, 46.3, -50.00000000000044, 39.300000000000026, 33.10000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 33.500000000000036, 45.5, 31.300000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 41.90000000000001, 42.500000000000014, 46.099999999999994, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 30.099999999999987, 43.7, 23.099999999999888, -50.00000000000044, 40.70000000000002, 46.5, 14.699999999999768, 24.099999999999902, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 10.899999999999714, 46.099999999999994, 41.90000000000001, 0.2999999999995637, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, -50.00000000000044, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.30000000000004, 44.10000000000001], "episode_lengths": [64, 234, 500, 46, 38, 500, 500, 500, 212, 424, 150, 500, 306, 170, 500, 268, 288, 252, 262, 182, 118, 174, 500, 184, 32, 300, 110, 40, 80, 42, 74, 296, 38, 500, 108, 170, 88, 500, 500, 500, 32, 166, 46, 188, 500, 96, 500, 72, 500, 50, 500, 82, 76, 40, 146, 500, 500, 48, 500, 500, 78, 500, 500, 44, 200, 64, 270, 500, 94, 36, 354, 260, 500, 66, 80, 500, 392, 40, 82, 498, 500, 60, 500, 88, 500, 94, 186, 500, 32, 500, 132, 500, 300, 62, 500, 500, 62, 500, 158, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4478120107258349, "mean_inference_ms": 1.4478310212997285, "mean_action_processing_ms": 0.1680110058013652, "mean_env_wait_ms": 0.10091920965271074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03024744987487793, "StateBufferConnector_ms": 0.01116800308227539, "ViewRequirementAgentConnector_ms": 0.13879609107971191}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.482999999999834, "episode_len_mean": 260.84, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 26.69999999999994, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 7.699999999999669, 35.10000000000004, -50.00000000000044, 19.499999999999837, 33.10000000000003, -50.00000000000044, 23.29999999999989, 21.299999999999862, 24.899999999999913, 23.8999999999999, 31.900000000000013, 38.300000000000026, 32.700000000000024, -50.00000000000044, 31.70000000000001, 46.9, 20.099999999999845, 39.10000000000002, 46.099999999999994, 42.10000000000001, 45.9, 42.70000000000001, 20.49999999999985, 46.3, -50.00000000000044, 39.300000000000026, 33.10000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 33.500000000000036, 45.5, 31.300000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 41.90000000000001, 42.500000000000014, 46.099999999999994, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 30.099999999999987, 43.7, 23.099999999999888, -50.00000000000044, 40.70000000000002, 46.5, 14.699999999999768, 24.099999999999902, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 10.899999999999714, 46.099999999999994, 41.90000000000001, 0.2999999999995637, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, -50.00000000000044, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.30000000000004, 44.10000000000001], "episode_lengths": [64, 234, 500, 46, 38, 500, 500, 500, 212, 424, 150, 500, 306, 170, 500, 268, 288, 252, 262, 182, 118, 174, 500, 184, 32, 300, 110, 40, 80, 42, 74, 296, 38, 500, 108, 170, 88, 500, 500, 500, 32, 166, 46, 188, 500, 96, 500, 72, 500, 50, 500, 82, 76, 40, 146, 500, 500, 48, 500, 500, 78, 500, 500, 44, 200, 64, 270, 500, 94, 36, 354, 260, 500, 66, 80, 500, 392, 40, 82, 498, 500, 60, 500, 88, 500, 94, 186, 500, 32, 500, 132, 500, 300, 62, 500, 500, 62, 500, 158, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4478120107258349, "mean_inference_ms": 1.4478310212997285, "mean_action_processing_ms": 0.1680110058013652, "mean_env_wait_ms": 0.10091920965271074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03024744987487793, "StateBufferConnector_ms": 0.01116800308227539, "ViewRequirementAgentConnector_ms": 0.13879609107971191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5258.816771185957, "num_env_steps_trained_throughput_per_sec": 5258.816771185957, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3535.28, "sample_time_ms": 3306.225, "load_time_ms": 15.616, "load_throughput": 1152696.515, "learn_time_ms": 200.297, "learn_throughput": 89866.453, "synch_weights_time_ms": 10.771}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1129, "training_iteration": 17, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-33", "timestamp": 1698251013, "time_this_iter_s": 3.43082332611084, "time_total_s": 61.65275979042053, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.65275979042053, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 68.53999999999999, "ram_util_percent": 28.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.530871431032817, "policy_loss": 0.05998227031280597, "vf_loss": 6.470941503842671, "vf_explained_var": -4.271666208902995e-07, "kl": 0.00035640831542830637, "entropy": 0.5233963429927826, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 210.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.187999999999815, "episode_len_mean": 268.74, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.5, 14.699999999999768, 24.099999999999902, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 10.899999999999714, 46.099999999999994, 41.90000000000001, 0.2999999999995637, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, -50.00000000000044, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.30000000000004, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 34.900000000000034, 40.30000000000002, 43.10000000000001, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 40.500000000000014, 45.3, -50.00000000000044, 41.100000000000016, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 16.699999999999797, 45.9, 39.70000000000002, -50.00000000000044, 25.899999999999928, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 35.30000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 44.5, -50.00000000000044, 25.099999999999916, 46.699999999999996, 18.699999999999825, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.3, 42.10000000000001, 45.1, -50.00000000000044, 41.90000000000001, 3.2999999999996064, 34.50000000000004, 19.899999999999842], "episode_lengths": [94, 36, 354, 260, 500, 66, 80, 500, 392, 40, 82, 498, 500, 60, 500, 88, 500, 94, 186, 500, 32, 500, 132, 500, 300, 62, 500, 500, 62, 500, 158, 60, 500, 52, 36, 500, 500, 500, 80, 152, 98, 70, 70, 500, 46, 500, 500, 500, 152, 500, 36, 500, 46, 500, 50, 96, 48, 500, 90, 124, 500, 500, 500, 22, 334, 42, 104, 500, 242, 50, 500, 500, 500, 148, 148, 72, 500, 500, 190, 88, 56, 500, 250, 34, 314, 500, 108, 26, 500, 500, 88, 500, 38, 80, 50, 500, 82, 468, 156, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4460394837947662, "mean_inference_ms": 1.4428730756864598, "mean_action_processing_ms": 0.16803528740438195, "mean_env_wait_ms": 0.1007635691774112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03412771224975586, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.14133977890014648}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.187999999999815, "episode_len_mean": 268.74, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.5, 14.699999999999768, 24.099999999999902, -50.00000000000044, 43.50000000000001, 42.10000000000001, -50.00000000000044, 10.899999999999714, 46.099999999999994, 41.90000000000001, 0.2999999999995637, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.70000000000002, 31.500000000000007, -50.00000000000044, 46.9, -50.00000000000044, 36.900000000000034, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 34.30000000000004, 44.10000000000001, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 34.900000000000034, 40.30000000000002, 43.10000000000001, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 40.500000000000014, 45.3, -50.00000000000044, 41.100000000000016, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 16.699999999999797, 45.9, 39.70000000000002, -50.00000000000044, 25.899999999999928, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 35.30000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 44.5, -50.00000000000044, 25.099999999999916, 46.699999999999996, 18.699999999999825, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.3, 42.10000000000001, 45.1, -50.00000000000044, 41.90000000000001, 3.2999999999996064, 34.50000000000004, 19.899999999999842], "episode_lengths": [94, 36, 354, 260, 500, 66, 80, 500, 392, 40, 82, 498, 500, 60, 500, 88, 500, 94, 186, 500, 32, 500, 132, 500, 300, 62, 500, 500, 62, 500, 158, 60, 500, 52, 36, 500, 500, 500, 80, 152, 98, 70, 70, 500, 46, 500, 500, 500, 152, 500, 36, 500, 46, 500, 50, 96, 48, 500, 90, 124, 500, 500, 500, 22, 334, 42, 104, 500, 242, 50, 500, 500, 500, 148, 148, 72, 500, 500, 190, 88, 56, 500, 250, 34, 314, 500, 108, 26, 500, 500, 88, 500, 38, 80, 50, 500, 82, 468, 156, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4460394837947662, "mean_inference_ms": 1.4428730756864598, "mean_action_processing_ms": 0.16803528740438195, "mean_env_wait_ms": 0.1007635691774112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03412771224975586, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.14133977890014648}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5030.965932489773, "num_env_steps_trained_throughput_per_sec": 5030.965932489773, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3535.3, "sample_time_ms": 3300.952, "load_time_ms": 15.468, "load_throughput": 1163724.969, "learn_time_ms": 205.695, "learn_throughput": 87508.048, "synch_weights_time_ms": 10.814}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1197, "training_iteration": 18, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-37", "timestamp": 1698251017, "time_this_iter_s": 3.5858378410339355, "time_total_s": 65.23859763145447, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.23859763145447, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 69.38, "ram_util_percent": 28.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.542737364768982, "policy_loss": -0.020054881538574893, "vf_loss": 6.562842011451721, "vf_explained_var": -9.5367431640625e-07, "kl": 0.00040646097779510154, "entropy": 0.4963797504703204, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 222.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.821999999999825, "episode_len_mean": 252.42, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.30000000000004, 35.30000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 44.5, -50.00000000000044, 25.099999999999916, 46.699999999999996, 18.699999999999825, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.3, 42.10000000000001, 45.1, -50.00000000000044, 41.90000000000001, 3.2999999999996064, 34.50000000000004, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, 47.1, 41.90000000000001, 30.099999999999987, 45.1, 41.500000000000014, 44.10000000000001, -50.00000000000044, 10.099999999999703, 20.49999999999985, 46.5, 35.500000000000036, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 26.89999999999994, 44.5, 26.09999999999993, 46.699999999999996, 32.50000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 9.699999999999697, -50.00000000000044, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.5, -50.00000000000044, 29.49999999999998, 44.7, 44.10000000000001, 22.099999999999874, -50.00000000000044, 43.7, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.900000000000006, 46.9, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 500, 148, 148, 72, 500, 500, 190, 88, 56, 500, 250, 34, 314, 500, 108, 26, 500, 500, 88, 500, 38, 80, 50, 500, 82, 468, 156, 302, 500, 500, 500, 52, 98, 30, 82, 200, 50, 86, 60, 500, 400, 296, 36, 146, 40, 500, 500, 500, 500, 52, 232, 56, 240, 34, 176, 500, 108, 500, 46, 40, 500, 404, 500, 56, 46, 500, 500, 64, 500, 36, 500, 206, 54, 60, 280, 500, 64, 500, 28, 500, 34, 500, 500, 88, 62, 32, 34, 500, 52, 80, 500, 500, 46, 88, 42, 500, 38, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44568889113304144, "mean_inference_ms": 1.441872546290066, "mean_action_processing_ms": 0.1677088299652631, "mean_env_wait_ms": 0.10009057772105882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029018402099609375, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.1538093090057373}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.821999999999825, "episode_len_mean": 252.42, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.30000000000004, 35.30000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 31.1, 41.30000000000001, 44.5, -50.00000000000044, 25.099999999999916, 46.699999999999996, 18.699999999999825, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.3, 42.10000000000001, 45.1, -50.00000000000044, 41.90000000000001, 3.2999999999996064, 34.50000000000004, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, 47.1, 41.90000000000001, 30.099999999999987, 45.1, 41.500000000000014, 44.10000000000001, -50.00000000000044, 10.099999999999703, 20.49999999999985, 46.5, 35.500000000000036, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 26.89999999999994, 44.5, 26.09999999999993, 46.699999999999996, 32.50000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 9.699999999999697, -50.00000000000044, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.5, -50.00000000000044, 29.49999999999998, 44.7, 44.10000000000001, 22.099999999999874, -50.00000000000044, 43.7, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.900000000000006, 46.9, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 500, 148, 148, 72, 500, 500, 190, 88, 56, 500, 250, 34, 314, 500, 108, 26, 500, 500, 88, 500, 38, 80, 50, 500, 82, 468, 156, 302, 500, 500, 500, 52, 98, 30, 82, 200, 50, 86, 60, 500, 400, 296, 36, 146, 40, 500, 500, 500, 500, 52, 232, 56, 240, 34, 176, 500, 108, 500, 46, 40, 500, 404, 500, 56, 46, 500, 500, 64, 500, 36, 500, 206, 54, 60, 280, 500, 64, 500, 28, 500, 34, 500, 500, 88, 62, 32, 34, 500, 52, 80, 500, 500, 46, 88, 42, 500, 38, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44568889113304144, "mean_inference_ms": 1.441872546290066, "mean_action_processing_ms": 0.1677088299652631, "mean_env_wait_ms": 0.10009057772105882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029018402099609375, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.1538093090057373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5153.236586665735, "num_env_steps_trained_throughput_per_sec": 5153.236586665735, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3520.238, "sample_time_ms": 3289.511, "load_time_ms": 15.297, "load_throughput": 1176673.223, "learn_time_ms": 202.148, "learn_throughput": 89043.877, "synch_weights_time_ms": 10.861}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1268, "training_iteration": 19, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-40", "timestamp": 1698251020, "time_this_iter_s": 3.5009450912475586, "time_total_s": 68.73954272270203, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.73954272270203, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 69.47999999999999, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.5214279890060425, "policy_loss": -0.01780951830248038, "vf_loss": 6.53928542137146, "vf_explained_var": -2.125898996988932e-06, "kl": 9.216275049350742e-05, "entropy": 0.47988253086805344, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 234.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.498999999999832, "episode_len_mean": 240.64, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 44.10000000000001, 22.099999999999874, -50.00000000000044, 43.7, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.900000000000006, 46.9, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 33.30000000000003, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 30.29999999999999, 46.099999999999994, 44.300000000000004, 41.70000000000002, 22.099999999999874, 8.49999999999968, 40.90000000000002, 42.10000000000001, 5.6999999999996405, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.9, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 44.5, 45.7, 44.5, -50.00000000000044, 43.7, -50.00000000000044, 36.50000000000003, 46.9, 44.5, -50.00000000000044, 41.30000000000001, 38.300000000000026, -50.00000000000044, 45.5, 37.300000000000026, 38.300000000000026, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.7, 32.50000000000002, 46.9, 45.1, 44.5, -50.00000000000044, 37.70000000000003, 39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 39.70000000000002], "episode_lengths": [54, 60, 280, 500, 64, 500, 28, 500, 34, 500, 500, 88, 62, 32, 34, 500, 52, 80, 500, 500, 46, 88, 42, 500, 38, 500, 90, 500, 168, 500, 160, 500, 500, 44, 500, 38, 500, 68, 198, 40, 58, 84, 280, 416, 92, 80, 444, 500, 500, 500, 26, 500, 500, 500, 500, 44, 500, 500, 500, 28, 42, 56, 62, 500, 500, 34, 30, 56, 44, 56, 500, 64, 500, 136, 32, 56, 500, 88, 118, 500, 46, 128, 118, 58, 120, 500, 44, 176, 32, 50, 56, 500, 124, 106, 500, 38, 500, 50, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4465880670156919, "mean_inference_ms": 1.4400720693345597, "mean_action_processing_ms": 0.1674706645117814, "mean_env_wait_ms": 0.10027645444201382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199505805969238, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.16795849800109863}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.498999999999832, "episode_len_mean": 240.64, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 44.10000000000001, 22.099999999999874, -50.00000000000044, 43.7, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.900000000000006, 46.9, 46.699999999999996, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.30000000000001, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 33.30000000000003, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 30.29999999999999, 46.099999999999994, 44.300000000000004, 41.70000000000002, 22.099999999999874, 8.49999999999968, 40.90000000000002, 42.10000000000001, 5.6999999999996405, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 45.9, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 44.5, 45.7, 44.5, -50.00000000000044, 43.7, -50.00000000000044, 36.50000000000003, 46.9, 44.5, -50.00000000000044, 41.30000000000001, 38.300000000000026, -50.00000000000044, 45.5, 37.300000000000026, 38.300000000000026, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.7, 32.50000000000002, 46.9, 45.1, 44.5, -50.00000000000044, 37.70000000000003, 39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 39.70000000000002], "episode_lengths": [54, 60, 280, 500, 64, 500, 28, 500, 34, 500, 500, 88, 62, 32, 34, 500, 52, 80, 500, 500, 46, 88, 42, 500, 38, 500, 90, 500, 168, 500, 160, 500, 500, 44, 500, 38, 500, 68, 198, 40, 58, 84, 280, 416, 92, 80, 444, 500, 500, 500, 26, 500, 500, 500, 500, 44, 500, 500, 500, 28, 42, 56, 62, 500, 500, 34, 30, 56, 44, 56, 500, 64, 500, 136, 32, 56, 500, 88, 118, 500, 46, 128, 118, 58, 120, 500, 44, 176, 32, 50, 56, 500, 124, 106, 500, 38, 500, 50, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4465880670156919, "mean_inference_ms": 1.4400720693345597, "mean_action_processing_ms": 0.1674706645117814, "mean_env_wait_ms": 0.10027645444201382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199505805969238, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.16795849800109863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4862.544280422722, "num_env_steps_trained_throughput_per_sec": 4862.544280422722, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3542.032, "sample_time_ms": 3304.81, "load_time_ms": 16.237, "load_throughput": 1108550.1, "learn_time_ms": 207.533, "learn_throughput": 86733.074, "synch_weights_time_ms": 11.018}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1341, "training_iteration": 20, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-44", "timestamp": 1698251024, "time_this_iter_s": 3.7086684703826904, "time_total_s": 72.44821119308472, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.44821119308472, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 74.30000000000001, "ram_util_percent": 28.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.792390465736389, "policy_loss": 0.03319670104732116, "vf_loss": 6.7592408657073975, "vf_explained_var": -1.5298525492350261e-06, "kl": 3.7185904087818265e-05, "entropy": 0.47036556899547577, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 246.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.982999999999855, "episode_len_mean": 225.86, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 37.300000000000026, 38.300000000000026, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.7, 32.50000000000002, 46.9, 45.1, 44.5, -50.00000000000044, 37.70000000000003, 39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, 43.50000000000001, 45.3, 38.700000000000024, 38.700000000000024, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 45.1, 45.5, -50.00000000000044, 28.499999999999964, 45.1, 43.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.5, 37.70000000000003, 36.900000000000034, 46.3, 37.90000000000003, 38.300000000000026, 42.500000000000014, -50.00000000000044, 16.09999999999979, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 25.499999999999922, 45.5, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 45.1, 44.7, 46.699999999999996, -50.00000000000044, 30.099999999999987, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 37.70000000000003, 23.499999999999893, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 47.3, 39.300000000000026, -50.00000000000044, 46.3, 21.09999999999986, 15.699999999999783, 46.5, 42.30000000000001, 46.3, 23.099999999999888, 46.5, -50.00000000000044, 23.8999999999999], "episode_lengths": [500, 46, 128, 118, 58, 120, 500, 44, 176, 32, 50, 56, 500, 124, 106, 500, 38, 500, 50, 500, 104, 500, 64, 66, 48, 114, 114, 38, 500, 500, 500, 102, 42, 50, 500, 500, 56, 30, 50, 46, 500, 216, 50, 64, 104, 500, 500, 500, 114, 36, 124, 132, 38, 122, 118, 76, 500, 340, 500, 52, 500, 56, 500, 246, 46, 500, 62, 70, 500, 50, 54, 34, 500, 200, 38, 500, 56, 500, 34, 124, 266, 86, 500, 500, 500, 500, 480, 28, 108, 500, 38, 290, 344, 36, 78, 38, 270, 36, 500, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4466428895709674, "mean_inference_ms": 1.4411388232655926, "mean_action_processing_ms": 0.16776103550470448, "mean_env_wait_ms": 0.10114577682512028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028008222579956055, "StateBufferConnector_ms": 0.004509925842285156, "ViewRequirementAgentConnector_ms": 0.1325054168701172}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.982999999999855, "episode_len_mean": 225.86, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 37.300000000000026, 38.300000000000026, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.7, 32.50000000000002, 46.9, 45.1, 44.5, -50.00000000000044, 37.70000000000003, 39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, 43.50000000000001, 45.3, 38.700000000000024, 38.700000000000024, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.9, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 45.1, 45.5, -50.00000000000044, 28.499999999999964, 45.1, 43.7, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.5, 37.70000000000003, 36.900000000000034, 46.3, 37.90000000000003, 38.300000000000026, 42.500000000000014, -50.00000000000044, 16.09999999999979, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, 25.499999999999922, 45.5, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 45.1, 44.7, 46.699999999999996, -50.00000000000044, 30.099999999999987, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 37.70000000000003, 23.499999999999893, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 47.3, 39.300000000000026, -50.00000000000044, 46.3, 21.09999999999986, 15.699999999999783, 46.5, 42.30000000000001, 46.3, 23.099999999999888, 46.5, -50.00000000000044, 23.8999999999999], "episode_lengths": [500, 46, 128, 118, 58, 120, 500, 44, 176, 32, 50, 56, 500, 124, 106, 500, 38, 500, 50, 500, 104, 500, 64, 66, 48, 114, 114, 38, 500, 500, 500, 102, 42, 50, 500, 500, 56, 30, 50, 46, 500, 216, 50, 64, 104, 500, 500, 500, 114, 36, 124, 132, 38, 122, 118, 76, 500, 340, 500, 52, 500, 56, 500, 246, 46, 500, 62, 70, 500, 50, 54, 34, 500, 200, 38, 500, 56, 500, 34, 124, 266, 86, 500, 500, 500, 500, 480, 28, 108, 500, 38, 290, 344, 36, 78, 38, 270, 36, 500, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4466428895709674, "mean_inference_ms": 1.4411388232655926, "mean_action_processing_ms": 0.16776103550470448, "mean_env_wait_ms": 0.10114577682512028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028008222579956055, "StateBufferConnector_ms": 0.004509925842285156, "ViewRequirementAgentConnector_ms": 0.1325054168701172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5031.440357674746, "num_env_steps_trained_throughput_per_sec": 5031.440357674746, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3546.082, "sample_time_ms": 3309.18, "load_time_ms": 16.728, "load_throughput": 1076049.64, "learn_time_ms": 206.807, "learn_throughput": 87037.625, "synch_weights_time_ms": 10.931}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1420, "training_iteration": 21, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-48", "timestamp": 1698251028, "time_this_iter_s": 3.5844829082489014, "time_total_s": 76.03269410133362, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.03269410133362, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 71.12, "ram_util_percent": 28.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.491582194964091, "policy_loss": 0.004490341370304425, "vf_loss": 6.487142006556193, "vf_explained_var": -9.934107462565105e-07, "kl": 0.00022943188528283068, "entropy": 0.5007555410265923, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 258.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.527999999999822, "episode_len_mean": 255.34, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 46.699999999999996, -50.00000000000044, 30.099999999999987, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 37.70000000000003, 23.499999999999893, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 47.3, 39.300000000000026, -50.00000000000044, 46.3, 21.09999999999986, 15.699999999999783, 46.5, 42.30000000000001, 46.3, 23.099999999999888, 46.5, -50.00000000000044, 23.8999999999999, -50.00000000000044, 43.30000000000001, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 27.699999999999953, 45.7, 47.1, 39.90000000000002, 43.900000000000006, -50.00000000000044, 45.1, 42.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 39.50000000000002, 45.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 14.899999999999771, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 36.50000000000003, 32.50000000000002, 42.500000000000014, -50.00000000000044, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, 46.3, 46.099999999999994, 20.49999999999985, 45.1, 39.10000000000002, -50.00000000000044, 46.5, 41.500000000000014, 45.3, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [54, 34, 500, 200, 38, 500, 56, 500, 34, 124, 266, 86, 500, 500, 500, 500, 480, 28, 108, 500, 38, 290, 344, 36, 78, 38, 270, 36, 500, 262, 500, 68, 84, 54, 500, 500, 500, 500, 86, 224, 44, 30, 102, 62, 500, 50, 78, 102, 500, 500, 500, 44, 106, 50, 500, 148, 500, 70, 500, 500, 64, 500, 500, 40, 500, 500, 58, 46, 352, 500, 500, 76, 34, 500, 136, 176, 76, 500, 158, 54, 500, 500, 500, 500, 500, 60, 66, 38, 40, 296, 50, 110, 500, 36, 86, 48, 54, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4472347051654808, "mean_inference_ms": 1.4438759990979457, "mean_action_processing_ms": 0.1682240648413662, "mean_env_wait_ms": 0.10086204131624768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029987096786499023, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.16064834594726562}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.527999999999822, "episode_len_mean": 255.34, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 46.699999999999996, -50.00000000000044, 30.099999999999987, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, 37.70000000000003, 23.499999999999893, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, 47.3, 39.300000000000026, -50.00000000000044, 46.3, 21.09999999999986, 15.699999999999783, 46.5, 42.30000000000001, 46.3, 23.099999999999888, 46.5, -50.00000000000044, 23.8999999999999, -50.00000000000044, 43.30000000000001, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 27.699999999999953, 45.7, 47.1, 39.90000000000002, 43.900000000000006, -50.00000000000044, 45.1, 42.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 39.50000000000002, 45.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.5, 14.899999999999771, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 36.50000000000003, 32.50000000000002, 42.500000000000014, -50.00000000000044, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, 46.3, 46.099999999999994, 20.49999999999985, 45.1, 39.10000000000002, -50.00000000000044, 46.5, 41.500000000000014, 45.3, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [54, 34, 500, 200, 38, 500, 56, 500, 34, 124, 266, 86, 500, 500, 500, 500, 480, 28, 108, 500, 38, 290, 344, 36, 78, 38, 270, 36, 500, 262, 500, 68, 84, 54, 500, 500, 500, 500, 86, 224, 44, 30, 102, 62, 500, 50, 78, 102, 500, 500, 500, 44, 106, 50, 500, 148, 500, 70, 500, 500, 64, 500, 500, 40, 500, 500, 58, 46, 352, 500, 500, 76, 34, 500, 136, 176, 76, 500, 158, 54, 500, 500, 500, 500, 500, 60, 66, 38, 40, 296, 50, 110, 500, 36, 86, 48, 54, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4472347051654808, "mean_inference_ms": 1.4438759990979457, "mean_action_processing_ms": 0.1682240648413662, "mean_env_wait_ms": 0.10086204131624768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029987096786499023, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.16064834594726562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4794.183387655473, "num_env_steps_trained_throughput_per_sec": 4794.183387655473, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3579.136, "sample_time_ms": 3353.361, "load_time_ms": 16.157, "load_throughput": 1114098.944, "learn_time_ms": 195.65, "learn_throughput": 92001.177, "synch_weights_time_ms": 11.604}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1490, "training_iteration": 22, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-51", "timestamp": 1698251031, "time_this_iter_s": 3.7615907192230225, "time_total_s": 79.79428482055664, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.79428482055664, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 75.21666666666668, "ram_util_percent": 28.816666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.4864563544591265, "policy_loss": -0.05788557262470325, "vf_loss": 6.5443893273671465, "vf_explained_var": -2.88089116414388e-07, "kl": 0.00015509722640179766, "entropy": 0.47370920578638714, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 270.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.241999999999816, "episode_len_mean": 258.18, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 36.50000000000003, 32.50000000000002, 42.500000000000014, -50.00000000000044, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, 46.3, 46.099999999999994, 20.49999999999985, 45.1, 39.10000000000002, -50.00000000000044, 46.5, 41.500000000000014, 45.3, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 42.500000000000014, 42.70000000000001, 44.7, -50.00000000000044, 46.699999999999996, 44.7, 45.5, 34.70000000000004, 17.899999999999814, 46.099999999999994, 46.3, -50.00000000000044, 43.7, 39.300000000000026, 45.5, 42.70000000000001, -50.00000000000044, 43.50000000000001, 13.699999999999754, -50.00000000000044, 44.900000000000006, 46.9, 25.899999999999928, 45.3, 40.70000000000002, 31.70000000000001, 37.90000000000003, 28.699999999999967, -50.00000000000044, 41.30000000000001, 44.900000000000006, 26.499999999999936, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, 33.10000000000003, 37.90000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 76, 34, 500, 136, 176, 76, 500, 158, 54, 500, 500, 500, 500, 500, 60, 66, 38, 40, 296, 50, 110, 500, 36, 86, 48, 54, 500, 78, 500, 500, 500, 500, 34, 28, 500, 500, 500, 68, 500, 500, 500, 62, 500, 74, 76, 74, 54, 500, 34, 54, 46, 154, 322, 40, 38, 500, 64, 108, 46, 74, 500, 66, 364, 500, 52, 32, 242, 48, 94, 184, 122, 214, 500, 88, 52, 236, 500, 58, 500, 500, 500, 500, 38, 292, 170, 122, 70, 40, 500, 500, 500, 40, 500, 72, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44735188256516806, "mean_inference_ms": 1.448213784696394, "mean_action_processing_ms": 0.168636971968546, "mean_env_wait_ms": 0.10065532768295653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400540351867676, "StateBufferConnector_ms": 0.008990287780761719, "ViewRequirementAgentConnector_ms": 0.1657721996307373}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.241999999999816, "episode_len_mean": 258.18, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.500000000000014, 46.699999999999996, -50.00000000000044, 36.50000000000003, 32.50000000000002, 42.500000000000014, -50.00000000000044, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, 46.3, 46.099999999999994, 20.49999999999985, 45.1, 39.10000000000002, -50.00000000000044, 46.5, 41.500000000000014, 45.3, 44.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 42.500000000000014, 42.70000000000001, 44.7, -50.00000000000044, 46.699999999999996, 44.7, 45.5, 34.70000000000004, 17.899999999999814, 46.099999999999994, 46.3, -50.00000000000044, 43.7, 39.300000000000026, 45.5, 42.70000000000001, -50.00000000000044, 43.50000000000001, 13.699999999999754, -50.00000000000044, 44.900000000000006, 46.9, 25.899999999999928, 45.3, 40.70000000000002, 31.70000000000001, 37.90000000000003, 28.699999999999967, -50.00000000000044, 41.30000000000001, 44.900000000000006, 26.499999999999936, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, 33.10000000000003, 37.90000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 76, 34, 500, 136, 176, 76, 500, 158, 54, 500, 500, 500, 500, 500, 60, 66, 38, 40, 296, 50, 110, 500, 36, 86, 48, 54, 500, 78, 500, 500, 500, 500, 34, 28, 500, 500, 500, 68, 500, 500, 500, 62, 500, 74, 76, 74, 54, 500, 34, 54, 46, 154, 322, 40, 38, 500, 64, 108, 46, 74, 500, 66, 364, 500, 52, 32, 242, 48, 94, 184, 122, 214, 500, 88, 52, 236, 500, 58, 500, 500, 500, 500, 38, 292, 170, 122, 70, 40, 500, 500, 500, 40, 500, 72, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44735188256516806, "mean_inference_ms": 1.448213784696394, "mean_action_processing_ms": 0.168636971968546, "mean_env_wait_ms": 0.10065532768295653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400540351867676, "StateBufferConnector_ms": 0.008990287780761719, "ViewRequirementAgentConnector_ms": 0.1657721996307373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4785.8957528538995, "num_env_steps_trained_throughput_per_sec": 4785.8957528538995, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3587.379, "sample_time_ms": 3361.297, "load_time_ms": 16.455, "load_throughput": 1093917.355, "learn_time_ms": 195.716, "learn_throughput": 91970.132, "synch_weights_time_ms": 11.646}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1559, "training_iteration": 23, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-55", "timestamp": 1698251035, "time_this_iter_s": 3.7679555416107178, "time_total_s": 83.56224036216736, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.56224036216736, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 79.47999999999999, "ram_util_percent": 28.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.807537039120992, "policy_loss": -0.05384632374625653, "vf_loss": 6.861437082290649, "vf_explained_var": -1.2914339701334635e-07, "kl": 0.00031909266215279786, "entropy": 0.5373915433883667, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 282.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.027999999999829, "episode_len_mean": 250.34, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, 33.10000000000003, 37.90000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.3, 41.70000000000002, 46.099999999999994, 39.50000000000002, 19.499999999999837, 43.900000000000006, 43.7, -50.00000000000044, 43.30000000000001, 23.499999999999893, -50.00000000000044, 11.099999999999717, 47.3, -50.00000000000044, 33.500000000000036, 42.30000000000001, -50.00000000000044, 32.30000000000002, 47.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, 45.5, -50.00000000000044, 44.5, -50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, 45.5, 35.10000000000004, 35.10000000000004, 44.900000000000006, 46.5, 23.099999999999888, 38.10000000000002, 44.5, 44.900000000000006, 43.7, 45.1, 44.10000000000001, 44.10000000000001, 20.099999999999845, 45.1, 42.900000000000006, 25.29999999999992, -50.00000000000044, 41.90000000000001, 46.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.1, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 58, 500, 500, 500, 500, 38, 292, 170, 122, 70, 40, 500, 500, 500, 40, 500, 72, 500, 500, 500, 500, 500, 500, 48, 500, 124, 500, 48, 84, 40, 106, 306, 62, 64, 500, 68, 266, 500, 390, 28, 500, 166, 78, 500, 178, 26, 500, 500, 100, 64, 500, 46, 500, 56, 500, 48, 500, 82, 56, 500, 32, 50, 500, 96, 500, 44, 46, 150, 150, 52, 36, 270, 120, 56, 52, 64, 50, 60, 60, 300, 50, 72, 248, 500, 82, 36, 500, 154, 500, 92, 42, 500, 500, 500, 500, 70, 30, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44859959740445604, "mean_inference_ms": 1.4480133462734952, "mean_action_processing_ms": 0.16870605502081698, "mean_env_wait_ms": 0.10134925088181021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03551506996154785, "StateBufferConnector_ms": 0.012997150421142578, "ViewRequirementAgentConnector_ms": 0.16339397430419922}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.027999999999829, "episode_len_mean": 250.34, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, 33.10000000000003, 37.90000000000003, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.3, 41.70000000000002, 46.099999999999994, 39.50000000000002, 19.499999999999837, 43.900000000000006, 43.7, -50.00000000000044, 43.30000000000001, 23.499999999999893, -50.00000000000044, 11.099999999999717, 47.3, -50.00000000000044, 33.500000000000036, 42.30000000000001, -50.00000000000044, 32.30000000000002, 47.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, 45.5, -50.00000000000044, 44.5, -50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 44.5, -50.00000000000044, 46.9, 45.1, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.7, 45.5, 35.10000000000004, 35.10000000000004, 44.900000000000006, 46.5, 23.099999999999888, 38.10000000000002, 44.5, 44.900000000000006, 43.7, 45.1, 44.10000000000001, 44.10000000000001, 20.099999999999845, 45.1, 42.900000000000006, 25.29999999999992, -50.00000000000044, 41.90000000000001, 46.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.1, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 58, 500, 500, 500, 500, 38, 292, 170, 122, 70, 40, 500, 500, 500, 40, 500, 72, 500, 500, 500, 500, 500, 500, 48, 500, 124, 500, 48, 84, 40, 106, 306, 62, 64, 500, 68, 266, 500, 390, 28, 500, 166, 78, 500, 178, 26, 500, 500, 100, 64, 500, 46, 500, 56, 500, 48, 500, 82, 56, 500, 32, 50, 500, 96, 500, 44, 46, 150, 150, 52, 36, 270, 120, 56, 52, 64, 50, 60, 60, 300, 50, 72, 248, 500, 82, 36, 500, 154, 500, 92, 42, 500, 500, 500, 500, 70, 30, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44859959740445604, "mean_inference_ms": 1.4480133462734952, "mean_action_processing_ms": 0.16870605502081698, "mean_env_wait_ms": 0.10134925088181021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03551506996154785, "StateBufferConnector_ms": 0.012997150421142578, "ViewRequirementAgentConnector_ms": 0.16339397430419922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5064.374174663838, "num_env_steps_trained_throughput_per_sec": 5064.374174663838, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3597.784, "sample_time_ms": 3371.725, "load_time_ms": 16.548, "load_throughput": 1087754.813, "learn_time_ms": 195.596, "learn_throughput": 92026.409, "synch_weights_time_ms": 11.649}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1637, "training_iteration": 24, "trial_id": "9f288_00022", "date": "2023-10-25_17-23-59", "timestamp": 1698251039, "time_this_iter_s": 3.5622289180755615, "time_total_s": 87.12446928024292, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.12446928024292, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 75.32, "ram_util_percent": 29.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.131338795026143, "policy_loss": -0.03710218177487453, "vf_loss": 6.168490886688232, "vf_explained_var": 2.9802322387695312e-08, "kl": 0.00023913155805151595, "entropy": 0.5002090906103452, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 294.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.687999999999834, "episode_len_mean": 243.76, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 45.7, 45.5, 35.10000000000004, 35.10000000000004, 44.900000000000006, 46.5, 23.099999999999888, 38.10000000000002, 44.5, 44.900000000000006, 43.7, 45.1, 44.10000000000001, 44.10000000000001, 20.099999999999845, 45.1, 42.900000000000006, 25.29999999999992, -50.00000000000044, 41.90000000000001, 46.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.1, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 24.899999999999913, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 30.099999999999987, -50.00000000000044, 46.099999999999994, 44.300000000000004, 15.099999999999774, 44.7, 41.500000000000014, -50.00000000000044, 38.90000000000002, 46.3, 43.30000000000001, 40.30000000000002, 45.5, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, 42.900000000000006, 45.7, 36.70000000000003, -50.00000000000044, 45.5, 39.10000000000002, 46.099999999999994, -50.00000000000044, 32.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 41.100000000000016, -50.00000000000044, 45.3, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044], "episode_lengths": [96, 500, 44, 46, 150, 150, 52, 36, 270, 120, 56, 52, 64, 50, 60, 60, 300, 50, 72, 248, 500, 82, 36, 500, 154, 500, 92, 42, 500, 500, 500, 500, 70, 30, 500, 34, 56, 500, 500, 500, 86, 252, 500, 40, 500, 42, 500, 200, 500, 40, 58, 350, 54, 86, 500, 112, 38, 68, 98, 46, 272, 500, 500, 500, 86, 106, 500, 500, 500, 500, 500, 36, 500, 500, 500, 102, 52, 72, 44, 134, 500, 46, 110, 40, 500, 178, 50, 500, 90, 90, 500, 48, 52, 58, 500, 72, 500, 496, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.449074474165352, "mean_inference_ms": 1.4492969267559073, "mean_action_processing_ms": 0.16887344701035165, "mean_env_wait_ms": 0.10110406559791964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04051804542541504, "StateBufferConnector_ms": 0.010003328323364258, "ViewRequirementAgentConnector_ms": 0.17594432830810547}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.687999999999834, "episode_len_mean": 243.76, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 45.7, 45.5, 35.10000000000004, 35.10000000000004, 44.900000000000006, 46.5, 23.099999999999888, 38.10000000000002, 44.5, 44.900000000000006, 43.7, 45.1, 44.10000000000001, 44.10000000000001, 20.099999999999845, 45.1, 42.900000000000006, 25.29999999999992, -50.00000000000044, 41.90000000000001, 46.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 47.1, -50.00000000000044, 46.699999999999996, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 24.899999999999913, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 30.099999999999987, -50.00000000000044, 46.099999999999994, 44.300000000000004, 15.099999999999774, 44.7, 41.500000000000014, -50.00000000000044, 38.90000000000002, 46.3, 43.30000000000001, 40.30000000000002, 45.5, 22.899999999999885, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.900000000000006, 42.900000000000006, 45.7, 36.70000000000003, -50.00000000000044, 45.5, 39.10000000000002, 46.099999999999994, -50.00000000000044, 32.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 41.100000000000016, -50.00000000000044, 45.3, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044], "episode_lengths": [96, 500, 44, 46, 150, 150, 52, 36, 270, 120, 56, 52, 64, 50, 60, 60, 300, 50, 72, 248, 500, 82, 36, 500, 154, 500, 92, 42, 500, 500, 500, 500, 70, 30, 500, 34, 56, 500, 500, 500, 86, 252, 500, 40, 500, 42, 500, 200, 500, 40, 58, 350, 54, 86, 500, 112, 38, 68, 98, 46, 272, 500, 500, 500, 86, 106, 500, 500, 500, 500, 500, 36, 500, 500, 500, 102, 52, 72, 44, 134, 500, 46, 110, 40, 500, 178, 50, 500, 90, 90, 500, 48, 52, 58, 500, 72, 500, 496, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.449074474165352, "mean_inference_ms": 1.4492969267559073, "mean_action_processing_ms": 0.16887344701035165, "mean_env_wait_ms": 0.10110406559791964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04051804542541504, "StateBufferConnector_ms": 0.010003328323364258, "ViewRequirementAgentConnector_ms": 0.17594432830810547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4720.76620788662, "num_env_steps_trained_throughput_per_sec": 4720.76620788662, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3623.195, "sample_time_ms": 3385.282, "load_time_ms": 17.048, "load_throughput": 1055839.294, "learn_time_ms": 207.051, "learn_throughput": 86935.237, "synch_weights_time_ms": 11.548}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1701, "training_iteration": 25, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-03", "timestamp": 1698251043, "time_this_iter_s": 3.8209404945373535, "time_total_s": 90.94540977478027, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.94540977478027, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 78.17999999999999, "ram_util_percent": 29.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.86382790406545, "policy_loss": -0.03405600848297278, "vf_loss": 6.897938688596089, "vf_explained_var": -7.748603820800781e-07, "kl": 1.8691355724816578e-05, "entropy": 0.5469289049506187, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 306.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.014999999999846, "episode_len_mean": 235.54, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 42.900000000000006, 45.7, 36.70000000000003, -50.00000000000044, 45.5, 39.10000000000002, 46.099999999999994, -50.00000000000044, 32.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 41.100000000000016, -50.00000000000044, 45.3, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.099999999999987, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 45.9, 43.7, -50.00000000000044, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.70000000000002, 43.900000000000006, 39.90000000000002, 46.699999999999996, 28.89999999999997, 45.1, 42.30000000000001, -50.00000000000044, 44.10000000000001, 46.699999999999996, 36.900000000000034, 26.89999999999994, 43.50000000000001, 1.4999999999995808, 25.499999999999922, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.5, 39.10000000000002, 40.10000000000002, -50.00000000000044, 41.90000000000001, 4.499999999999623, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.3, -50.00000000000044, 44.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 24.499999999999908, 35.900000000000034, 22.299999999999876, 42.30000000000001, 34.50000000000004, 44.300000000000004, 42.30000000000001, 44.10000000000001, 42.500000000000014, 35.900000000000034, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.29999999999999, 46.3, -50.00000000000044], "episode_lengths": [52, 72, 44, 134, 500, 46, 110, 40, 500, 178, 50, 500, 90, 90, 500, 48, 52, 58, 500, 72, 500, 496, 500, 500, 500, 74, 200, 40, 50, 500, 500, 500, 46, 40, 42, 64, 500, 68, 68, 500, 500, 52, 104, 62, 102, 34, 212, 50, 78, 500, 60, 34, 132, 232, 66, 486, 246, 500, 480, 500, 500, 56, 110, 100, 500, 82, 456, 500, 414, 500, 500, 108, 38, 500, 54, 80, 500, 500, 72, 52, 256, 142, 278, 78, 156, 58, 78, 60, 76, 142, 500, 40, 500, 44, 500, 34, 500, 198, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45121669276499476, "mean_inference_ms": 1.453132382290863, "mean_action_processing_ms": 0.1689652095686415, "mean_env_wait_ms": 0.10176660173507568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002666473388672, "StateBufferConnector_ms": 0.009006500244140625, "ViewRequirementAgentConnector_ms": 0.19816374778747559}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.014999999999846, "episode_len_mean": 235.54, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 42.900000000000006, 45.7, 36.70000000000003, -50.00000000000044, 45.5, 39.10000000000002, 46.099999999999994, -50.00000000000044, 32.30000000000002, 45.1, -50.00000000000044, 41.100000000000016, 41.100000000000016, -50.00000000000044, 45.3, 44.900000000000006, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.099999999999987, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 45.9, 43.7, -50.00000000000044, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.70000000000002, 43.900000000000006, 39.90000000000002, 46.699999999999996, 28.89999999999997, 45.1, 42.30000000000001, -50.00000000000044, 44.10000000000001, 46.699999999999996, 36.900000000000034, 26.89999999999994, 43.50000000000001, 1.4999999999995808, 25.499999999999922, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 44.5, 39.10000000000002, 40.10000000000002, -50.00000000000044, 41.90000000000001, 4.499999999999623, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.3, -50.00000000000044, 44.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.900000000000006, 24.499999999999908, 35.900000000000034, 22.299999999999876, 42.30000000000001, 34.50000000000004, 44.300000000000004, 42.30000000000001, 44.10000000000001, 42.500000000000014, 35.900000000000034, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.29999999999999, 46.3, -50.00000000000044], "episode_lengths": [52, 72, 44, 134, 500, 46, 110, 40, 500, 178, 50, 500, 90, 90, 500, 48, 52, 58, 500, 72, 500, 496, 500, 500, 500, 74, 200, 40, 50, 500, 500, 500, 46, 40, 42, 64, 500, 68, 68, 500, 500, 52, 104, 62, 102, 34, 212, 50, 78, 500, 60, 34, 132, 232, 66, 486, 246, 500, 480, 500, 500, 56, 110, 100, 500, 82, 456, 500, 414, 500, 500, 108, 38, 500, 54, 80, 500, 500, 72, 52, 256, 142, 278, 78, 156, 58, 78, 60, 76, 142, 500, 40, 500, 44, 500, 34, 500, 198, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45121669276499476, "mean_inference_ms": 1.453132382290863, "mean_action_processing_ms": 0.1689652095686415, "mean_env_wait_ms": 0.10176660173507568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002666473388672, "StateBufferConnector_ms": 0.009006500244140625, "ViewRequirementAgentConnector_ms": 0.19816374778747559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4950.877583911824, "num_env_steps_trained_throughput_per_sec": 4950.877583911824, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3629.039, "sample_time_ms": 3403.009, "load_time_ms": 16.815, "load_throughput": 1070462.498, "learn_time_ms": 195.176, "learn_throughput": 92224.575, "synch_weights_time_ms": 11.573}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1777, "training_iteration": 26, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-06", "timestamp": 1698251046, "time_this_iter_s": 3.641711473464966, "time_total_s": 94.58712124824524, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.58712124824524, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 77.6, "ram_util_percent": 29.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 7.361302614212036, "policy_loss": 0.01005264837294817, "vf_loss": 7.351303895314534, "vf_explained_var": -1.0281801223754883e-06, "kl": 0.00021426382326102575, "entropy": 0.5406294564406077, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 318.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.342999999999863, "episode_len_mean": 222.3, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.299999999999876, 42.30000000000001, 34.50000000000004, 44.300000000000004, 42.30000000000001, 44.10000000000001, 42.500000000000014, 35.900000000000034, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.29999999999999, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.900000000000006, 23.8999999999999, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 4.499999999999623, 34.30000000000004, -50.00000000000044, 21.09999999999986, 13.699999999999754, 42.900000000000006, -50.00000000000044, 46.9, 29.299999999999976, 35.900000000000034, -50.00000000000044, 46.3, 45.1, -50.00000000000044, 46.9, 46.099999999999994, 40.30000000000002, 47.1, 20.299999999999848, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 27.299999999999947, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.300000000000026, 43.7, 46.5, 44.5, 37.70000000000003, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 45.3, 44.900000000000006, 16.8999999999998, -50.00000000000044, 43.900000000000006, 33.500000000000036, 43.7, 45.3, 11.899999999999729, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 45.1, 44.900000000000006, 44.300000000000004, 41.500000000000014, 41.90000000000001, 45.5, 15.299999999999777, 40.90000000000002, 43.30000000000001, 43.50000000000001, 9.8999999999997, -50.00000000000044, 32.700000000000024, 35.500000000000036, 32.90000000000003], "episode_lengths": [278, 78, 156, 58, 78, 60, 76, 142, 500, 40, 500, 44, 500, 34, 500, 198, 38, 500, 500, 500, 224, 62, 262, 500, 500, 46, 68, 500, 456, 158, 500, 290, 364, 72, 500, 32, 208, 142, 500, 38, 50, 500, 32, 40, 98, 30, 298, 40, 56, 500, 500, 266, 500, 500, 74, 42, 228, 500, 500, 76, 118, 64, 36, 56, 124, 70, 54, 500, 500, 500, 62, 24, 48, 52, 332, 500, 62, 166, 64, 48, 382, 44, 500, 500, 50, 50, 52, 58, 86, 82, 46, 348, 92, 68, 66, 402, 500, 174, 146, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45085925295543655, "mean_inference_ms": 1.4561039979365782, "mean_action_processing_ms": 0.16972748431923088, "mean_env_wait_ms": 0.10173393009933815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03901028633117676, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.16212177276611328}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.342999999999863, "episode_len_mean": 222.3, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.299999999999876, 42.30000000000001, 34.50000000000004, 44.300000000000004, 42.30000000000001, 44.10000000000001, 42.500000000000014, 35.900000000000034, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 30.29999999999999, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.900000000000006, 23.8999999999999, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 4.499999999999623, 34.30000000000004, -50.00000000000044, 21.09999999999986, 13.699999999999754, 42.900000000000006, -50.00000000000044, 46.9, 29.299999999999976, 35.900000000000034, -50.00000000000044, 46.3, 45.1, -50.00000000000044, 46.9, 46.099999999999994, 40.30000000000002, 47.1, 20.299999999999848, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 27.299999999999947, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.300000000000026, 43.7, 46.5, 44.5, 37.70000000000003, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 45.3, 44.900000000000006, 16.8999999999998, -50.00000000000044, 43.900000000000006, 33.500000000000036, 43.7, 45.3, 11.899999999999729, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 45.1, 44.900000000000006, 44.300000000000004, 41.500000000000014, 41.90000000000001, 45.5, 15.299999999999777, 40.90000000000002, 43.30000000000001, 43.50000000000001, 9.8999999999997, -50.00000000000044, 32.700000000000024, 35.500000000000036, 32.90000000000003], "episode_lengths": [278, 78, 156, 58, 78, 60, 76, 142, 500, 40, 500, 44, 500, 34, 500, 198, 38, 500, 500, 500, 224, 62, 262, 500, 500, 46, 68, 500, 456, 158, 500, 290, 364, 72, 500, 32, 208, 142, 500, 38, 50, 500, 32, 40, 98, 30, 298, 40, 56, 500, 500, 266, 500, 500, 74, 42, 228, 500, 500, 76, 118, 64, 36, 56, 124, 70, 54, 500, 500, 500, 62, 24, 48, 52, 332, 500, 62, 166, 64, 48, 382, 44, 500, 500, 50, 50, 52, 58, 86, 82, 46, 348, 92, 68, 66, 402, 500, 174, 146, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45085925295543655, "mean_inference_ms": 1.4561039979365782, "mean_action_processing_ms": 0.16972748431923088, "mean_env_wait_ms": 0.10173393009933815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03901028633117676, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.16212177276611328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4601.2940856825, "num_env_steps_trained_throughput_per_sec": 4601.2940856825, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3677.851, "sample_time_ms": 3451.753, "load_time_ms": 16.933, "load_throughput": 1062991.344, "learn_time_ms": 195.145, "learn_throughput": 92239.009, "synch_weights_time_ms": 11.473}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1859, "training_iteration": 27, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-10", "timestamp": 1698251050, "time_this_iter_s": 3.918792963027954, "time_total_s": 98.5059142112732, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.5059142112732, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 81.21666666666667, "ram_util_percent": 29.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 7.210792700449626, "policy_loss": -0.003748709956804911, "vf_loss": 7.214592893918355, "vf_explained_var": -2.260009447733561e-06, "kl": 0.0005273092152246287, "entropy": 0.5149968614180883, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 330.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.220999999999858, "episode_len_mean": 233.52, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 44.900000000000006, 16.8999999999998, -50.00000000000044, 43.900000000000006, 33.500000000000036, 43.7, 45.3, 11.899999999999729, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 45.1, 44.900000000000006, 44.300000000000004, 41.500000000000014, 41.90000000000001, 45.5, 15.299999999999777, 40.90000000000002, 43.30000000000001, 43.50000000000001, 9.8999999999997, -50.00000000000044, 32.700000000000024, 35.500000000000036, 32.90000000000003, 28.499999999999964, 45.1, 40.90000000000002, 46.3, 42.900000000000006, 44.10000000000001, 37.10000000000003, -50.00000000000044, 43.30000000000001, 25.699999999999925, 31.1, 39.90000000000002, 27.099999999999945, 44.900000000000006, -50.00000000000044, 44.5, 30.699999999999996, 42.500000000000014, 44.10000000000001, -50.00000000000044, 46.3, 10.099999999999703, 28.09999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.70000000000003, 43.10000000000001, 44.5, -50.00000000000044, 19.299999999999834, 42.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 42.30000000000001, -50.00000000000044, 46.099999999999994, 44.7, 45.5, 43.7, 24.899999999999913, -50.00000000000044, 39.300000000000026, 23.099999999999888, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 39.90000000000002, 44.300000000000004, 14.499999999999766, 23.29999999999989, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [48, 52, 332, 500, 62, 166, 64, 48, 382, 44, 500, 500, 50, 50, 52, 58, 86, 82, 46, 348, 92, 68, 66, 402, 500, 174, 146, 172, 216, 50, 92, 38, 72, 60, 130, 500, 68, 244, 190, 102, 230, 52, 500, 56, 194, 76, 60, 500, 38, 400, 220, 500, 500, 62, 500, 84, 500, 500, 60, 124, 70, 56, 500, 308, 80, 62, 500, 500, 500, 382, 330, 500, 500, 500, 500, 430, 78, 500, 40, 54, 46, 64, 252, 500, 108, 270, 118, 74, 500, 500, 56, 102, 58, 356, 268, 500, 138, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45278556297238226, "mean_inference_ms": 1.4587033400462297, "mean_action_processing_ms": 0.17018227113988896, "mean_env_wait_ms": 0.1022485828764232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038002967834472656, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.1408836841583252}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.220999999999858, "episode_len_mean": 233.52, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 44.900000000000006, 16.8999999999998, -50.00000000000044, 43.900000000000006, 33.500000000000036, 43.7, 45.3, 11.899999999999729, 45.7, -50.00000000000044, -50.00000000000044, 45.1, 45.1, 44.900000000000006, 44.300000000000004, 41.500000000000014, 41.90000000000001, 45.5, 15.299999999999777, 40.90000000000002, 43.30000000000001, 43.50000000000001, 9.8999999999997, -50.00000000000044, 32.700000000000024, 35.500000000000036, 32.90000000000003, 28.499999999999964, 45.1, 40.90000000000002, 46.3, 42.900000000000006, 44.10000000000001, 37.10000000000003, -50.00000000000044, 43.30000000000001, 25.699999999999925, 31.1, 39.90000000000002, 27.099999999999945, 44.900000000000006, -50.00000000000044, 44.5, 30.699999999999996, 42.500000000000014, 44.10000000000001, -50.00000000000044, 46.3, 10.099999999999703, 28.09999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.70000000000003, 43.10000000000001, 44.5, -50.00000000000044, 19.299999999999834, 42.10000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.899999999999729, 17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 42.30000000000001, -50.00000000000044, 46.099999999999994, 44.7, 45.5, 43.7, 24.899999999999913, -50.00000000000044, 39.300000000000026, 23.099999999999888, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 39.90000000000002, 44.300000000000004, 14.499999999999766, 23.29999999999989, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7], "episode_lengths": [48, 52, 332, 500, 62, 166, 64, 48, 382, 44, 500, 500, 50, 50, 52, 58, 86, 82, 46, 348, 92, 68, 66, 402, 500, 174, 146, 172, 216, 50, 92, 38, 72, 60, 130, 500, 68, 244, 190, 102, 230, 52, 500, 56, 194, 76, 60, 500, 38, 400, 220, 500, 500, 62, 500, 84, 500, 500, 60, 124, 70, 56, 500, 308, 80, 62, 500, 500, 500, 382, 330, 500, 500, 500, 500, 430, 78, 500, 40, 54, 46, 64, 252, 500, 108, 270, 118, 74, 500, 500, 56, 102, 58, 356, 268, 500, 138, 500, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45278556297238226, "mean_inference_ms": 1.4587033400462297, "mean_action_processing_ms": 0.17018227113988896, "mean_env_wait_ms": 0.1022485828764232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038002967834472656, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.1408836841583252}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4670.533090226523, "num_env_steps_trained_throughput_per_sec": 4670.533090226523, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3705.461, "sample_time_ms": 3482.606, "load_time_ms": 16.892, "load_throughput": 1065571.871, "learn_time_ms": 192.386, "learn_throughput": 93561.863, "synch_weights_time_ms": 11.03}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1931, "training_iteration": 28, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-14", "timestamp": 1698251054, "time_this_iter_s": 3.860950469970703, "time_total_s": 102.3668646812439, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.3668646812439, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 79.67999999999999, "ram_util_percent": 29.640000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 7.000453273455302, "policy_loss": -0.03799093778555592, "vf_loss": 7.038496534029643, "vf_explained_var": -1.2914339701334635e-07, "kl": 0.00019618873618535795, "entropy": 0.5230041022102038, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 342.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.038999999999819, "episode_len_mean": 265.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 42.30000000000001, -50.00000000000044, 46.099999999999994, 44.7, 45.5, 43.7, 24.899999999999913, -50.00000000000044, 39.300000000000026, 23.099999999999888, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 39.90000000000002, 44.300000000000004, 14.499999999999766, 23.29999999999989, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.5, 29.299999999999976, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 44.5, 11.29999999999972, 44.10000000000001, 5.499999999999638, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 46.5, 41.70000000000002, 44.300000000000004, 12.69999999999974, 44.900000000000006, 42.900000000000006, 42.70000000000001, 21.09999999999986, 43.10000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 32.100000000000016, -50.00000000000044, 17.899999999999814, 42.500000000000014, 2.8999999999996007, 31.900000000000013, 46.9, 42.30000000000001, 43.7, 30.9, 41.70000000000002, 41.500000000000014, -50.00000000000044, 12.499999999999737, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 34.10000000000004, 44.900000000000006, 45.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 42.900000000000006], "episode_lengths": [330, 500, 500, 500, 500, 430, 78, 500, 40, 54, 46, 64, 252, 500, 108, 270, 118, 74, 500, 500, 56, 102, 58, 356, 268, 500, 138, 500, 500, 44, 500, 500, 26, 208, 34, 500, 46, 72, 56, 388, 60, 446, 500, 500, 32, 500, 500, 68, 130, 500, 500, 500, 36, 500, 50, 36, 84, 58, 374, 52, 72, 74, 290, 70, 164, 58, 500, 180, 500, 322, 76, 472, 182, 32, 78, 64, 192, 84, 86, 500, 376, 500, 52, 500, 58, 500, 142, 500, 500, 500, 148, 500, 160, 52, 42, 500, 286, 500, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45329684872019443, "mean_inference_ms": 1.4614783044152961, "mean_action_processing_ms": 0.1705720095015564, "mean_env_wait_ms": 0.10252586664247737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005578994750977, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.15208959579467773}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.038999999999819, "episode_len_mean": 265.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.099999999999802, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 42.30000000000001, -50.00000000000044, 46.099999999999994, 44.7, 45.5, 43.7, 24.899999999999913, -50.00000000000044, 39.300000000000026, 23.099999999999888, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 39.90000000000002, 44.300000000000004, 14.499999999999766, 23.29999999999989, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.5, 29.299999999999976, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 44.5, 11.29999999999972, 44.10000000000001, 5.499999999999638, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.1, 46.5, 41.70000000000002, 44.300000000000004, 12.69999999999974, 44.900000000000006, 42.900000000000006, 42.70000000000001, 21.09999999999986, 43.10000000000001, 33.70000000000004, 44.300000000000004, -50.00000000000044, 32.100000000000016, -50.00000000000044, 17.899999999999814, 42.500000000000014, 2.8999999999996007, 31.900000000000013, 46.9, 42.30000000000001, 43.7, 30.9, 41.70000000000002, 41.500000000000014, -50.00000000000044, 12.499999999999737, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 34.10000000000004, 44.900000000000006, 45.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 42.900000000000006], "episode_lengths": [330, 500, 500, 500, 500, 430, 78, 500, 40, 54, 46, 64, 252, 500, 108, 270, 118, 74, 500, 500, 56, 102, 58, 356, 268, 500, 138, 500, 500, 44, 500, 500, 26, 208, 34, 500, 46, 72, 56, 388, 60, 446, 500, 500, 32, 500, 500, 68, 130, 500, 500, 500, 36, 500, 50, 36, 84, 58, 374, 52, 72, 74, 290, 70, 164, 58, 500, 180, 500, 322, 76, 472, 182, 32, 78, 64, 192, 84, 86, 500, 376, 500, 52, 500, 58, 500, 142, 500, 500, 500, 148, 500, 160, 52, 42, 500, 286, 500, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45329684872019443, "mean_inference_ms": 1.4614783044152961, "mean_action_processing_ms": 0.1705720095015564, "mean_env_wait_ms": 0.10252586664247737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005578994750977, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.15208959579467773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4751.07868830093, "num_env_steps_trained_throughput_per_sec": 4751.07868830093, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3735.028, "sample_time_ms": 3503.482, "load_time_ms": 16.942, "load_throughput": 1062473.747, "learn_time_ms": 200.993, "learn_throughput": 89555.33, "synch_weights_time_ms": 11.115}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 2001, "training_iteration": 29, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-18", "timestamp": 1698251058, "time_this_iter_s": 3.797614097595215, "time_total_s": 106.16447877883911, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.16447877883911, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 74.45, "ram_util_percent": 29.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.833621184031169, "policy_loss": -0.04139697179198265, "vf_loss": 6.875069101651509, "vf_explained_var": -1.3709068298339844e-06, "kl": 0.00040089793088782244, "entropy": 0.5096858143806458, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 354.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.802999999999815, "episode_len_mean": 267.6, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.899999999999814, 42.500000000000014, 2.8999999999996007, 31.900000000000013, 46.9, 42.30000000000001, 43.7, 30.9, 41.70000000000002, 41.500000000000014, -50.00000000000044, 12.499999999999737, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 34.10000000000004, 44.900000000000006, 45.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 42.900000000000006, 9.299999999999692, -50.00000000000044, 45.1, 31.70000000000001, 25.499999999999922, 45.3, 43.50000000000001, 43.10000000000001, -50.00000000000044, 41.100000000000016, 45.5, 47.3, -50.00000000000044, 19.69999999999984, -50.00000000000044, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 15.299999999999777, 46.3, -50.00000000000044, 31.70000000000001, 44.900000000000006, 46.9, -50.00000000000044, 43.7, 24.499999999999908, 17.69999999999981, 42.500000000000014, 46.5, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 27.899999999999956, 41.500000000000014, 37.50000000000003, 45.9, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 34.50000000000004, 37.70000000000003, 46.5, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [322, 76, 472, 182, 32, 78, 64, 192, 84, 86, 500, 376, 500, 52, 500, 58, 500, 142, 500, 500, 500, 148, 500, 160, 52, 42, 500, 286, 500, 500, 72, 408, 500, 50, 184, 246, 48, 66, 70, 500, 90, 46, 28, 500, 304, 500, 34, 54, 500, 500, 500, 342, 348, 38, 500, 184, 52, 32, 500, 64, 256, 324, 76, 36, 54, 76, 500, 500, 500, 26, 44, 500, 500, 500, 48, 222, 86, 126, 42, 500, 158, 42, 500, 500, 500, 500, 66, 46, 156, 124, 36, 408, 500, 500, 500, 500, 54, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45428074976181165, "mean_inference_ms": 1.4661325419934303, "mean_action_processing_ms": 0.17082712197780844, "mean_env_wait_ms": 0.10322520668585923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699732780456543, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.16704893112182617}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.802999999999815, "episode_len_mean": 267.6, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.899999999999814, 42.500000000000014, 2.8999999999996007, 31.900000000000013, 46.9, 42.30000000000001, 43.7, 30.9, 41.70000000000002, 41.500000000000014, -50.00000000000044, 12.499999999999737, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 34.10000000000004, 44.900000000000006, 45.9, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, 42.900000000000006, 9.299999999999692, -50.00000000000044, 45.1, 31.70000000000001, 25.499999999999922, 45.3, 43.50000000000001, 43.10000000000001, -50.00000000000044, 41.100000000000016, 45.5, 47.3, -50.00000000000044, 19.69999999999984, -50.00000000000044, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 15.299999999999777, 46.3, -50.00000000000044, 31.70000000000001, 44.900000000000006, 46.9, -50.00000000000044, 43.7, 24.499999999999908, 17.69999999999981, 42.500000000000014, 46.5, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 27.899999999999956, 41.500000000000014, 37.50000000000003, 45.9, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 34.50000000000004, 37.70000000000003, 46.5, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [322, 76, 472, 182, 32, 78, 64, 192, 84, 86, 500, 376, 500, 52, 500, 58, 500, 142, 500, 500, 500, 148, 500, 160, 52, 42, 500, 286, 500, 500, 72, 408, 500, 50, 184, 246, 48, 66, 70, 500, 90, 46, 28, 500, 304, 500, 34, 54, 500, 500, 500, 342, 348, 38, 500, 184, 52, 32, 500, 64, 256, 324, 76, 36, 54, 76, 500, 500, 500, 26, 44, 500, 500, 500, 48, 222, 86, 126, 42, 500, 158, 42, 500, 500, 500, 500, 66, 46, 156, 124, 36, 408, 500, 500, 500, 500, 54, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45428074976181165, "mean_inference_ms": 1.4661325419934303, "mean_action_processing_ms": 0.17082712197780844, "mean_env_wait_ms": 0.10322520668585923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699732780456543, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.16704893112182617}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4765.415784141023, "num_env_steps_trained_throughput_per_sec": 4765.415784141023, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3742.573, "sample_time_ms": 3529.961, "load_time_ms": 15.538, "load_throughput": 1158416.399, "learn_time_ms": 183.233, "learn_throughput": 98235.632, "synch_weights_time_ms": 11.357}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2070, "training_iteration": 30, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-22", "timestamp": 1698251062, "time_this_iter_s": 3.7832138538360596, "time_total_s": 109.94769263267517, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.94769263267517, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 83.86, "ram_util_percent": 29.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.259953061739604, "policy_loss": -0.00048626959323883057, "vf_loss": 6.260488351186116, "vf_explained_var": 1.0381142298380535e-06, "kl": 0.00035584617623859077, "entropy": 0.49024346470832825, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 366.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.25700000000022, "episode_len_mean": 298.1, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 31.70000000000001, 44.900000000000006, 46.9, -50.00000000000044, 43.7, 24.499999999999908, 17.69999999999981, 42.500000000000014, 46.5, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 27.899999999999956, 41.500000000000014, 37.50000000000003, 45.9, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 34.50000000000004, 37.70000000000003, 46.5, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 16.499999999999794, -50.00000000000044, 20.899999999999856, -50.00000000000044, 44.7, 28.699999999999967, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.499999999999609, 31.300000000000004, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 31.70000000000001, 43.50000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 43.50000000000001, -50.00000000000044], "episode_lengths": [38, 500, 184, 52, 32, 500, 64, 256, 324, 76, 36, 54, 76, 500, 500, 500, 26, 44, 500, 500, 500, 48, 222, 86, 126, 42, 500, 158, 42, 500, 500, 500, 500, 66, 46, 156, 124, 36, 408, 500, 500, 500, 500, 54, 500, 90, 500, 500, 32, 500, 500, 46, 500, 500, 66, 500, 336, 500, 292, 500, 54, 214, 44, 500, 500, 500, 52, 466, 188, 500, 500, 122, 28, 500, 120, 500, 500, 24, 500, 184, 66, 104, 500, 500, 80, 94, 64, 500, 176, 500, 500, 500, 500, 54, 500, 500, 500, 372, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45507135121453507, "mean_inference_ms": 1.4694510237102105, "mean_action_processing_ms": 0.1711923713264148, "mean_env_wait_ms": 0.10332692113539889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030996084213256836, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.1701803207397461}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.25700000000022, "episode_len_mean": 298.1, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 31.70000000000001, 44.900000000000006, 46.9, -50.00000000000044, 43.7, 24.499999999999908, 17.69999999999981, 42.500000000000014, 46.5, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 27.899999999999956, 41.500000000000014, 37.50000000000003, 45.9, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 34.50000000000004, 37.70000000000003, 46.5, 9.299999999999692, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 16.499999999999794, -50.00000000000044, 20.899999999999856, -50.00000000000044, 44.7, 28.699999999999967, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.499999999999609, 31.300000000000004, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 31.70000000000001, 43.50000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 43.50000000000001, -50.00000000000044], "episode_lengths": [38, 500, 184, 52, 32, 500, 64, 256, 324, 76, 36, 54, 76, 500, 500, 500, 26, 44, 500, 500, 500, 48, 222, 86, 126, 42, 500, 158, 42, 500, 500, 500, 500, 66, 46, 156, 124, 36, 408, 500, 500, 500, 500, 54, 500, 90, 500, 500, 32, 500, 500, 46, 500, 500, 66, 500, 336, 500, 292, 500, 54, 214, 44, 500, 500, 500, 52, 466, 188, 500, 500, 122, 28, 500, 120, 500, 500, 24, 500, 184, 66, 104, 500, 500, 80, 94, 64, 500, 176, 500, 500, 500, 500, 54, 500, 500, 500, 372, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45507135121453507, "mean_inference_ms": 1.4694510237102105, "mean_action_processing_ms": 0.1711923713264148, "mean_env_wait_ms": 0.10332692113539889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030996084213256836, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.1701803207397461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4529.526180098072, "num_env_steps_trained_throughput_per_sec": 4529.526180098072, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3782.215, "sample_time_ms": 3571.171, "load_time_ms": 15.153, "load_throughput": 1187907.671, "learn_time_ms": 181.57, "learn_throughput": 99135.252, "synch_weights_time_ms": 11.74}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2123, "training_iteration": 31, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-26", "timestamp": 1698251066, "time_this_iter_s": 3.9799246788024902, "time_total_s": 113.92761731147766, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.92761731147766, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 84.17999999999999, "ram_util_percent": 29.860000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.637319842974345, "policy_loss": 0.010761404565225044, "vf_loss": 6.626606822013855, "vf_explained_var": -4.967053731282552e-07, "kl": 0.00016356417833662817, "entropy": 0.48181671400864917, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 378.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.145999999999806, "episode_len_mean": 269.12, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 31.70000000000001, 43.50000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 43.50000000000001, 39.10000000000002, 45.3, 38.50000000000003, 46.099999999999994, 45.9, 45.7, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, 41.100000000000016, 10.899999999999714, 27.49999999999995, 17.499999999999808, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 22.699999999999882, -50.00000000000044, 14.699999999999768, 44.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, 45.9, 38.700000000000024, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 44.10000000000001, 45.3, 47.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.1, 41.500000000000014, 46.699999999999996, -50.00000000000044, 45.9, 44.10000000000001, 28.89999999999997, 43.30000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3], "episode_lengths": [120, 500, 500, 24, 500, 184, 66, 104, 500, 500, 80, 94, 64, 500, 176, 500, 500, 500, 500, 54, 500, 500, 500, 372, 66, 500, 500, 130, 66, 110, 48, 116, 40, 42, 44, 52, 500, 28, 500, 500, 500, 500, 50, 60, 90, 392, 226, 326, 38, 500, 68, 500, 36, 500, 500, 140, 500, 274, 500, 354, 58, 500, 52, 500, 500, 56, 198, 500, 500, 42, 114, 500, 28, 76, 500, 500, 500, 38, 500, 38, 60, 48, 26, 500, 50, 500, 500, 90, 50, 86, 34, 500, 42, 60, 212, 68, 204, 500, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45519673835441227, "mean_inference_ms": 1.4687275369911204, "mean_action_processing_ms": 0.17110112783748277, "mean_env_wait_ms": 0.10337931784413357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026987075805664062, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1540822982788086}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.145999999999806, "episode_len_mean": 269.12, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 31.70000000000001, 43.50000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.70000000000002, 43.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 43.50000000000001, 39.10000000000002, 45.3, 38.50000000000003, 46.099999999999994, 45.9, 45.7, 44.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, 41.100000000000016, 10.899999999999714, 27.49999999999995, 17.499999999999808, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 22.699999999999882, -50.00000000000044, 14.699999999999768, 44.300000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 30.29999999999999, -50.00000000000044, -50.00000000000044, 45.9, 38.700000000000024, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 44.10000000000001, 45.3, 47.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.1, 41.500000000000014, 46.699999999999996, -50.00000000000044, 45.9, 44.10000000000001, 28.89999999999997, 43.30000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3], "episode_lengths": [120, 500, 500, 24, 500, 184, 66, 104, 500, 500, 80, 94, 64, 500, 176, 500, 500, 500, 500, 54, 500, 500, 500, 372, 66, 500, 500, 130, 66, 110, 48, 116, 40, 42, 44, 52, 500, 28, 500, 500, 500, 500, 50, 60, 90, 392, 226, 326, 38, 500, 68, 500, 36, 500, 500, 140, 500, 274, 500, 354, 58, 500, 52, 500, 500, 56, 198, 500, 500, 42, 114, 500, 28, 76, 500, 500, 500, 38, 500, 38, 60, 48, 26, 500, 50, 500, 500, 90, 50, 86, 34, 500, 42, 60, 212, 68, 204, 500, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45519673835441227, "mean_inference_ms": 1.4687275369911204, "mean_action_processing_ms": 0.17110112783748277, "mean_env_wait_ms": 0.10337931784413357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026987075805664062, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1540822982788086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5159.211913900735, "num_env_steps_trained_throughput_per_sec": 5159.211913900735, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3755.75, "sample_time_ms": 3532.65, "load_time_ms": 17.496, "load_throughput": 1028784.753, "learn_time_ms": 191.859, "learn_throughput": 93818.708, "synch_weights_time_ms": 11.053}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2197, "training_iteration": 32, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-29", "timestamp": 1698251069, "time_this_iter_s": 3.4939048290252686, "time_total_s": 117.42152214050293, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.42152214050293, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 74.46, "ram_util_percent": 29.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.533664385477702, "policy_loss": -0.006907454201912818, "vf_loss": 6.540617068608602, "vf_explained_var": -3.0597050984700522e-06, "kl": 0.00011700184501250988, "entropy": 0.4531503493587176, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 390.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.286999999999822, "episode_len_mean": 252.74, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 38.700000000000024, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 44.10000000000001, 45.3, 47.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.1, 41.500000000000014, 46.699999999999996, -50.00000000000044, 45.9, 44.10000000000001, 28.89999999999997, 43.30000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.5, -50.00000000000044, 47.3, 45.1, 47.9, -50.00000000000044, -50.00000000000044, 32.100000000000016, 43.50000000000001, -50.00000000000044, 1.8999999999995865, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, 43.900000000000006, -50.00000000000044, 27.899999999999956, 46.099999999999994, 47.1, 41.100000000000016, 43.50000000000001, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 24.69999999999991, 46.9, 45.5, 36.50000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.500000000000014, 46.3, -50.00000000000044, 41.70000000000002, 41.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 26.299999999999933, 10.899999999999714, 46.5, 46.099999999999994, 45.1, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 40.30000000000002, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 42, 114, 500, 28, 76, 500, 500, 500, 38, 500, 38, 60, 48, 26, 500, 50, 500, 500, 90, 50, 86, 34, 500, 42, 60, 212, 68, 204, 500, 500, 48, 500, 46, 500, 28, 50, 22, 500, 500, 180, 66, 500, 482, 98, 500, 500, 500, 500, 72, 122, 62, 500, 222, 40, 30, 90, 66, 60, 38, 500, 500, 500, 500, 154, 254, 32, 46, 136, 500, 76, 500, 86, 38, 500, 84, 88, 500, 144, 500, 500, 500, 122, 30, 500, 238, 392, 36, 40, 50, 500, 206, 500, 500, 500, 88, 64, 98, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.454650636419996, "mean_inference_ms": 1.466462655192074, "mean_action_processing_ms": 0.17076504513160082, "mean_env_wait_ms": 0.10305824650046484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098536491394043, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.14300251007080078}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.286999999999822, "episode_len_mean": 252.74, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 38.700000000000024, -50.00000000000044, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 44.10000000000001, 45.3, 47.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.1, 41.500000000000014, 46.699999999999996, -50.00000000000044, 45.9, 44.10000000000001, 28.89999999999997, 43.30000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.5, -50.00000000000044, 47.3, 45.1, 47.9, -50.00000000000044, -50.00000000000044, 32.100000000000016, 43.50000000000001, -50.00000000000044, 1.8999999999995865, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, 43.900000000000006, -50.00000000000044, 27.899999999999956, 46.099999999999994, 47.1, 41.100000000000016, 43.50000000000001, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 24.69999999999991, 46.9, 45.5, 36.50000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.500000000000014, 46.3, -50.00000000000044, 41.70000000000002, 41.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 26.299999999999933, 10.899999999999714, 46.5, 46.099999999999994, 45.1, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 40.30000000000002, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 42, 114, 500, 28, 76, 500, 500, 500, 38, 500, 38, 60, 48, 26, 500, 50, 500, 500, 90, 50, 86, 34, 500, 42, 60, 212, 68, 204, 500, 500, 48, 500, 46, 500, 28, 50, 22, 500, 500, 180, 66, 500, 482, 98, 500, 500, 500, 500, 72, 122, 62, 500, 222, 40, 30, 90, 66, 60, 38, 500, 500, 500, 500, 154, 254, 32, 46, 136, 500, 76, 500, 86, 38, 500, 84, 88, 500, 144, 500, 500, 500, 122, 30, 500, 238, 392, 36, 40, 50, 500, 206, 500, 500, 500, 88, 64, 98, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.454650636419996, "mean_inference_ms": 1.466462655192074, "mean_action_processing_ms": 0.17076504513160082, "mean_env_wait_ms": 0.10305824650046484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02098536491394043, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.14300251007080078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4608.23879362401, "num_env_steps_trained_throughput_per_sec": 4608.23879362401, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3770.249, "sample_time_ms": 3548.027, "load_time_ms": 17.496, "load_throughput": 1028819.802, "learn_time_ms": 191.146, "learn_throughput": 94168.918, "synch_weights_time_ms": 10.891}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2265, "training_iteration": 33, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-33", "timestamp": 1698251073, "time_this_iter_s": 3.91321063041687, "time_total_s": 121.3347327709198, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.3347327709198, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 67.68333333333334, "ram_util_percent": 30.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.801537791887919, "policy_loss": 0.027439921473463375, "vf_loss": 6.774142940839131, "vf_explained_var": 2.632538477579753e-07, "kl": 5.1829745374950185e-05, "entropy": 0.449364073574543, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 402.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.492999999999828, "episode_len_mean": 250.7, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 26.299999999999933, 10.899999999999714, 46.5, 46.099999999999994, 45.1, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 40.30000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 5.499999999999638, -50.00000000000044, 44.900000000000006, 46.5, 43.30000000000001, 39.10000000000002, 41.70000000000002, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, 41.90000000000001, 35.70000000000003, -50.00000000000044, 47.1, 44.7, 43.7, -50.00000000000044, 30.499999999999993, 44.900000000000006, 14.499999999999766, -50.00000000000044, 11.699999999999726, 44.10000000000001, 37.10000000000003, 30.29999999999999, 34.10000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 36.900000000000034, 36.70000000000003, 44.300000000000004, 42.900000000000006, 46.099999999999994, -50.00000000000044, 40.500000000000014, 32.50000000000002, 44.7, 46.099999999999994, 47.3, 45.9, 35.70000000000003, 45.9, -50.00000000000044, 46.099999999999994, 43.900000000000006], "episode_lengths": [88, 500, 144, 500, 500, 500, 122, 30, 500, 238, 392, 36, 40, 50, 500, 206, 500, 500, 500, 88, 64, 98, 84, 500, 500, 58, 500, 48, 500, 48, 500, 30, 500, 210, 500, 500, 500, 500, 500, 500, 500, 62, 500, 60, 446, 500, 52, 36, 68, 110, 84, 70, 500, 50, 500, 500, 122, 28, 500, 500, 52, 500, 50, 82, 144, 500, 30, 54, 64, 500, 196, 52, 356, 500, 384, 60, 130, 198, 160, 500, 80, 500, 56, 132, 134, 58, 72, 40, 500, 96, 176, 54, 40, 28, 42, 144, 42, 500, 40, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45472856952444773, "mean_inference_ms": 1.4647315034681614, "mean_action_processing_ms": 0.17053869665985324, "mean_env_wait_ms": 0.1028412948749796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999424934387207, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.14208579063415527}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.492999999999828, "episode_len_mean": 250.7, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.1, -50.00000000000044, 26.299999999999933, 10.899999999999714, 46.5, 46.099999999999994, 45.1, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 40.30000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 47.1, -50.00000000000044, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 5.499999999999638, -50.00000000000044, 44.900000000000006, 46.5, 43.30000000000001, 39.10000000000002, 41.70000000000002, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, 41.90000000000001, 35.70000000000003, -50.00000000000044, 47.1, 44.7, 43.7, -50.00000000000044, 30.499999999999993, 44.900000000000006, 14.499999999999766, -50.00000000000044, 11.699999999999726, 44.10000000000001, 37.10000000000003, 30.29999999999999, 34.10000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 36.900000000000034, 36.70000000000003, 44.300000000000004, 42.900000000000006, 46.099999999999994, -50.00000000000044, 40.500000000000014, 32.50000000000002, 44.7, 46.099999999999994, 47.3, 45.9, 35.70000000000003, 45.9, -50.00000000000044, 46.099999999999994, 43.900000000000006], "episode_lengths": [88, 500, 144, 500, 500, 500, 122, 30, 500, 238, 392, 36, 40, 50, 500, 206, 500, 500, 500, 88, 64, 98, 84, 500, 500, 58, 500, 48, 500, 48, 500, 30, 500, 210, 500, 500, 500, 500, 500, 500, 500, 62, 500, 60, 446, 500, 52, 36, 68, 110, 84, 70, 500, 50, 500, 500, 122, 28, 500, 500, 52, 500, 50, 82, 144, 500, 30, 54, 64, 500, 196, 52, 356, 500, 384, 60, 130, 198, 160, 500, 80, 500, 56, 132, 134, 58, 72, 40, 500, 96, 176, 54, 40, 28, 42, 144, 42, 500, 40, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45472856952444773, "mean_inference_ms": 1.4647315034681614, "mean_action_processing_ms": 0.17053869665985324, "mean_env_wait_ms": 0.1028412948749796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999424934387207, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.14208579063415527}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5077.424711207596, "num_env_steps_trained_throughput_per_sec": 5077.424711207596, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3769.336, "sample_time_ms": 3547.374, "load_time_ms": 17.396, "load_throughput": 1034722.219, "learn_time_ms": 190.885, "learn_throughput": 94297.581, "synch_weights_time_ms": 10.992}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2341, "training_iteration": 34, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-37", "timestamp": 1698251077, "time_this_iter_s": 3.5511252880096436, "time_total_s": 124.88585805892944, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 124.88585805892944, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 75.22, "ram_util_percent": 30.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.648012121518453, "policy_loss": 0.004851222969591618, "vf_loss": 6.643207669258118, "vf_explained_var": -1.7434358596801758e-06, "kl": 0.00013858400514266123, "entropy": 0.4674784541130066, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 414.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.523999999999848, "episode_len_mean": 235.48, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 47.1, 44.7, 43.7, -50.00000000000044, 30.499999999999993, 44.900000000000006, 14.499999999999766, -50.00000000000044, 11.699999999999726, 44.10000000000001, 37.10000000000003, 30.29999999999999, 34.10000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 36.900000000000034, 36.70000000000003, 44.300000000000004, 42.900000000000006, 46.099999999999994, -50.00000000000044, 40.500000000000014, 32.50000000000002, 44.7, 46.099999999999994, 47.3, 45.9, 35.70000000000003, 45.9, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.10000000000001, 43.900000000000006, 46.099999999999994, 16.499999999999794, 47.9, -50.00000000000044, 46.099999999999994, 46.9, 46.5, 45.9, -50.00000000000044, 21.699999999999868, 47.1, -50.00000000000044, 25.699999999999925, -50.00000000000044, 39.50000000000002, 45.1, 24.69999999999991, 45.9, -50.00000000000044, 46.9, 7.499999999999666, 43.30000000000001, 43.7, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001, 47.3, 15.49999999999978, 44.900000000000006, -50.00000000000044, 40.90000000000002, 17.099999999999802, 10.099999999999703, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 38.700000000000024, 28.699999999999967, 27.299999999999947, 46.5, 11.899999999999729, -50.00000000000044, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.099999999999817, 6.8999999999996575], "episode_lengths": [144, 500, 30, 54, 64, 500, 196, 52, 356, 500, 384, 60, 130, 198, 160, 500, 80, 500, 56, 132, 134, 58, 72, 40, 500, 96, 176, 54, 40, 28, 42, 144, 42, 500, 40, 62, 500, 70, 62, 40, 336, 22, 500, 40, 32, 36, 42, 500, 284, 30, 500, 244, 500, 106, 50, 254, 42, 500, 32, 426, 68, 64, 500, 274, 500, 500, 500, 40, 74, 28, 346, 52, 500, 92, 330, 400, 500, 68, 500, 104, 500, 500, 500, 500, 80, 62, 114, 214, 228, 36, 382, 500, 60, 360, 500, 500, 48, 500, 320, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4536044298908412, "mean_inference_ms": 1.4603989441634713, "mean_action_processing_ms": 0.1699314532834081, "mean_env_wait_ms": 0.10272302128861467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.11770892143249512}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.523999999999848, "episode_len_mean": 235.48, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 47.1, 44.7, 43.7, -50.00000000000044, 30.499999999999993, 44.900000000000006, 14.499999999999766, -50.00000000000044, 11.699999999999726, 44.10000000000001, 37.10000000000003, 30.29999999999999, 34.10000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 36.900000000000034, 36.70000000000003, 44.300000000000004, 42.900000000000006, 46.099999999999994, -50.00000000000044, 40.500000000000014, 32.50000000000002, 44.7, 46.099999999999994, 47.3, 45.9, 35.70000000000003, 45.9, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.10000000000001, 43.900000000000006, 46.099999999999994, 16.499999999999794, 47.9, -50.00000000000044, 46.099999999999994, 46.9, 46.5, 45.9, -50.00000000000044, 21.699999999999868, 47.1, -50.00000000000044, 25.699999999999925, -50.00000000000044, 39.50000000000002, 45.1, 24.69999999999991, 45.9, -50.00000000000044, 46.9, 7.499999999999666, 43.30000000000001, 43.7, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.70000000000001, 47.3, 15.49999999999978, 44.900000000000006, -50.00000000000044, 40.90000000000002, 17.099999999999802, 10.099999999999703, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 38.700000000000024, 28.699999999999967, 27.299999999999947, 46.5, 11.899999999999729, -50.00000000000044, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.099999999999817, 6.8999999999996575], "episode_lengths": [144, 500, 30, 54, 64, 500, 196, 52, 356, 500, 384, 60, 130, 198, 160, 500, 80, 500, 56, 132, 134, 58, 72, 40, 500, 96, 176, 54, 40, 28, 42, 144, 42, 500, 40, 62, 500, 70, 62, 40, 336, 22, 500, 40, 32, 36, 42, 500, 284, 30, 500, 244, 500, 106, 50, 254, 42, 500, 32, 426, 68, 64, 500, 274, 500, 500, 500, 40, 74, 28, 346, 52, 500, 92, 330, 400, 500, 68, 500, 104, 500, 500, 500, 500, 80, 62, 114, 214, 228, 36, 382, 500, 60, 360, 500, 500, 48, 500, 320, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4536044298908412, "mean_inference_ms": 1.4603989441634713, "mean_action_processing_ms": 0.1699314532834081, "mean_env_wait_ms": 0.10272302128861467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.11770892143249512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5676.3629460182365, "num_env_steps_trained_throughput_per_sec": 5676.3629460182365, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3705.146, "sample_time_ms": 3475.349, "load_time_ms": 17.604, "load_throughput": 1022518.812, "learn_time_ms": 198.312, "learn_throughput": 90765.925, "synch_weights_time_ms": 11.092}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2405, "training_iteration": 35, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-40", "timestamp": 1698251080, "time_this_iter_s": 3.1760449409484863, "time_total_s": 128.06190299987793, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.06190299987793, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 68.80000000000001, "ram_util_percent": 30.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.493639548619588, "policy_loss": 0.022867284327124555, "vf_loss": 6.470823764801025, "vf_explained_var": -6.755193074544271e-07, "kl": 0.00016947622054412173, "entropy": 0.5140317479769388, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 426.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.125999999999799, "episode_len_mean": 279.32, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 40.90000000000002, 17.099999999999802, 10.099999999999703, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 38.700000000000024, 28.699999999999967, 27.299999999999947, 46.5, 11.899999999999729, -50.00000000000044, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.099999999999817, 6.8999999999996575, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 38.50000000000003, 42.500000000000014, 22.099999999999874, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 19.499999999999837, 45.7, 39.70000000000002, 46.699999999999996, 44.7, 40.30000000000002, 46.9, -50.00000000000044, 45.1, 42.900000000000006, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 44.300000000000004, 41.100000000000016, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 45.1, 45.9, -50.00000000000044, 45.9, 41.500000000000014, 44.10000000000001, -50.00000000000044, 39.90000000000002, 43.50000000000001], "episode_lengths": [52, 500, 92, 330, 400, 500, 68, 500, 104, 500, 500, 500, 500, 80, 62, 114, 214, 228, 36, 382, 500, 60, 360, 500, 500, 48, 500, 320, 432, 500, 124, 500, 500, 500, 500, 500, 500, 76, 64, 116, 76, 280, 34, 500, 500, 500, 42, 306, 44, 104, 34, 54, 98, 32, 500, 50, 72, 54, 40, 500, 500, 500, 144, 500, 44, 84, 500, 80, 48, 500, 114, 500, 500, 500, 294, 500, 42, 500, 500, 500, 500, 118, 500, 500, 190, 58, 90, 500, 66, 500, 30, 50, 42, 500, 42, 86, 60, 500, 102, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4511806452597474, "mean_inference_ms": 1.453182545750221, "mean_action_processing_ms": 0.16917512391778985, "mean_env_wait_ms": 0.10199628655068478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199721336364746, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.10119819641113281}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.125999999999799, "episode_len_mean": 279.32, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 40.90000000000002, 17.099999999999802, 10.099999999999703, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 43.900000000000006, 38.700000000000024, 28.699999999999967, 27.299999999999947, 46.5, 11.899999999999729, -50.00000000000044, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 18.099999999999817, 6.8999999999996575, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, 38.50000000000003, 42.500000000000014, 22.099999999999874, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 19.499999999999837, 45.7, 39.70000000000002, 46.699999999999996, 44.7, 40.30000000000002, 46.9, -50.00000000000044, 45.1, 42.900000000000006, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 44.300000000000004, 41.100000000000016, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 45.1, 45.9, -50.00000000000044, 45.9, 41.500000000000014, 44.10000000000001, -50.00000000000044, 39.90000000000002, 43.50000000000001], "episode_lengths": [52, 500, 92, 330, 400, 500, 68, 500, 104, 500, 500, 500, 500, 80, 62, 114, 214, 228, 36, 382, 500, 60, 360, 500, 500, 48, 500, 320, 432, 500, 124, 500, 500, 500, 500, 500, 500, 76, 64, 116, 76, 280, 34, 500, 500, 500, 42, 306, 44, 104, 34, 54, 98, 32, 500, 50, 72, 54, 40, 500, 500, 500, 144, 500, 44, 84, 500, 80, 48, 500, 114, 500, 500, 500, 294, 500, 42, 500, 500, 500, 500, 118, 500, 500, 190, 58, 90, 500, 66, 500, 30, 50, 42, 500, 42, 86, 60, 500, 102, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4511806452597474, "mean_inference_ms": 1.453182545750221, "mean_action_processing_ms": 0.16917512391778985, "mean_env_wait_ms": 0.10199628655068478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199721336364746, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.10119819641113281}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5891.465734946333, "num_env_steps_trained_throughput_per_sec": 5891.465734946333, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3647.101, "sample_time_ms": 3408.877, "load_time_ms": 17.74, "load_throughput": 1014640.503, "learn_time_ms": 206.815, "learn_throughput": 87034.114, "synch_weights_time_ms": 11.08}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2476, "training_iteration": 36, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-43", "timestamp": 1698251083, "time_this_iter_s": 3.0602667331695557, "time_total_s": 131.12216973304749, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.12216973304749, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 61.279999999999994, "ram_util_percent": 30.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.8105194965998335, "policy_loss": -0.004723619514455398, "vf_loss": 6.815297444661458, "vf_explained_var": -1.5298525492350261e-06, "kl": 0.00016009705895688361, "entropy": 0.5430205141504606, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 438.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.809999999999821, "episode_len_mean": 262.52, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 44.300000000000004, 41.100000000000016, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 45.1, 45.9, -50.00000000000044, 45.9, 41.500000000000014, 44.10000000000001, -50.00000000000044, 39.90000000000002, 43.50000000000001, -50.00000000000044, 42.10000000000001, 38.90000000000002, 39.10000000000002, 41.70000000000002, 46.699999999999996, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 36.50000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.1, 36.70000000000003, 33.500000000000036, -50.00000000000044, 21.699999999999868, -50.00000000000044, 40.500000000000014, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 29.099999999999973, 15.699999999999783, 7.699999999999669, -50.00000000000044, 29.69999999999998, -50.00000000000044, 46.099999999999994, 40.90000000000002, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.899999999999828, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.10000000000001, 44.900000000000006, 42.10000000000001, 39.90000000000002, 13.299999999999748, 41.500000000000014, 42.10000000000001, 12.499999999999737, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, -50.00000000000044, 42.30000000000001, 45.1, 46.099999999999994, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [114, 500, 500, 500, 294, 500, 42, 500, 500, 500, 500, 118, 500, 500, 190, 58, 90, 500, 66, 500, 30, 50, 42, 500, 42, 86, 60, 500, 102, 66, 500, 80, 112, 110, 84, 34, 30, 500, 500, 36, 60, 136, 500, 118, 500, 50, 134, 166, 500, 284, 500, 96, 100, 500, 52, 500, 500, 500, 78, 210, 344, 424, 500, 204, 500, 40, 92, 146, 38, 500, 500, 68, 312, 500, 500, 98, 60, 52, 80, 102, 368, 86, 80, 376, 500, 50, 46, 500, 500, 170, 68, 500, 78, 50, 40, 310, 500, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44897578867331034, "mean_inference_ms": 1.445790115715951, "mean_action_processing_ms": 0.16852171306326308, "mean_env_wait_ms": 0.10127817077058304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899886131286621, "StateBufferConnector_ms": 0.013997554779052734, "ViewRequirementAgentConnector_ms": 0.12478351593017578}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.809999999999821, "episode_len_mean": 262.52, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 44.300000000000004, 41.100000000000016, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 45.1, 45.9, -50.00000000000044, 45.9, 41.500000000000014, 44.10000000000001, -50.00000000000044, 39.90000000000002, 43.50000000000001, -50.00000000000044, 42.10000000000001, 38.90000000000002, 39.10000000000002, 41.70000000000002, 46.699999999999996, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 36.50000000000003, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.1, 36.70000000000003, 33.500000000000036, -50.00000000000044, 21.699999999999868, -50.00000000000044, 40.500000000000014, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 29.099999999999973, 15.699999999999783, 7.699999999999669, -50.00000000000044, 29.69999999999998, -50.00000000000044, 46.099999999999994, 40.90000000000002, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 18.899999999999828, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.10000000000001, 44.900000000000006, 42.10000000000001, 39.90000000000002, 13.299999999999748, 41.500000000000014, 42.10000000000001, 12.499999999999737, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, -50.00000000000044, 42.30000000000001, 45.1, 46.099999999999994, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [114, 500, 500, 500, 294, 500, 42, 500, 500, 500, 500, 118, 500, 500, 190, 58, 90, 500, 66, 500, 30, 50, 42, 500, 42, 86, 60, 500, 102, 66, 500, 80, 112, 110, 84, 34, 30, 500, 500, 36, 60, 136, 500, 118, 500, 50, 134, 166, 500, 284, 500, 96, 100, 500, 52, 500, 500, 500, 78, 210, 344, 424, 500, 204, 500, 40, 92, 146, 38, 500, 500, 68, 312, 500, 500, 98, 60, 52, 80, 102, 368, 86, 80, 376, 500, 50, 46, 500, 500, 170, 68, 500, 78, 50, 40, 310, 500, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44897578867331034, "mean_inference_ms": 1.445790115715951, "mean_action_processing_ms": 0.16852171306326308, "mean_env_wait_ms": 0.10127817077058304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899886131286621, "StateBufferConnector_ms": 0.013997554779052734, "ViewRequirementAgentConnector_ms": 0.12478351593017578}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5769.902933990712, "num_env_steps_trained_throughput_per_sec": 5769.902933990712, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3567.971, "sample_time_ms": 3328.793, "load_time_ms": 18.122, "load_throughput": 993272.779, "learn_time_ms": 207.568, "learn_throughput": 86718.718, "synch_weights_time_ms": 10.98}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2546, "training_iteration": 37, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-46", "timestamp": 1698251086, "time_this_iter_s": 3.125636100769043, "time_total_s": 134.24780583381653, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.24780583381653, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 30.650000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 7.074848850568135, "policy_loss": 0.025409509738286335, "vf_loss": 7.049493948618571, "vf_explained_var": -3.645817438761393e-06, "kl": 0.0003633045222877958, "entropy": 0.5465090870857239, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 450.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.151999999999832, "episode_len_mean": 249.16, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, 44.10000000000001, 44.900000000000006, 42.10000000000001, 39.90000000000002, 13.299999999999748, 41.500000000000014, 42.10000000000001, 12.499999999999737, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, -50.00000000000044, 42.30000000000001, 45.1, 46.099999999999994, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, -50.00000000000044, 42.500000000000014, 15.49999999999978, -50.00000000000044, 6.299999999999649, 45.3, -50.00000000000044, 23.099999999999888, 11.699999999999726, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 42.500000000000014, 43.50000000000001, 41.30000000000001, 45.9, 39.90000000000002, 44.300000000000004, 17.299999999999805, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, 44.7, 7.299999999999663, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 47.1, 22.899999999999885, 43.10000000000001, -50.00000000000044, 33.30000000000003, 42.900000000000006, 41.500000000000014, 45.3, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 27.099999999999945, -50.00000000000044, 47.3, 41.100000000000016, 46.5, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.90000000000003, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 24.899999999999913, 46.9, 40.30000000000002, 44.900000000000006, 45.9, 41.70000000000002, 1.099999999999575, -50.00000000000044], "episode_lengths": [500, 98, 60, 52, 80, 102, 368, 86, 80, 376, 500, 50, 46, 500, 500, 170, 68, 500, 78, 50, 40, 310, 500, 500, 500, 50, 66, 500, 76, 346, 500, 438, 48, 500, 270, 384, 84, 500, 500, 76, 54, 76, 66, 88, 42, 102, 58, 328, 500, 500, 78, 46, 54, 428, 500, 64, 500, 500, 500, 500, 500, 312, 30, 272, 70, 500, 168, 72, 86, 48, 228, 500, 500, 500, 166, 500, 230, 500, 28, 90, 36, 58, 88, 500, 500, 98, 172, 42, 500, 84, 500, 52, 252, 32, 98, 52, 42, 84, 490, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44822263368244863, "mean_inference_ms": 1.438530428658482, "mean_action_processing_ms": 0.1674771018232797, "mean_env_wait_ms": 0.1007244516664305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998477935791016, "StateBufferConnector_ms": 0.011007308959960938, "ViewRequirementAgentConnector_ms": 0.1250011920928955}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.151999999999832, "episode_len_mean": 249.16, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, 44.10000000000001, 44.900000000000006, 42.10000000000001, 39.90000000000002, 13.299999999999748, 41.500000000000014, 42.10000000000001, 12.499999999999737, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, -50.00000000000044, 42.30000000000001, 45.1, 46.099999999999994, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, -50.00000000000044, 42.500000000000014, 15.49999999999978, -50.00000000000044, 6.299999999999649, 45.3, -50.00000000000044, 23.099999999999888, 11.699999999999726, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 42.500000000000014, 43.50000000000001, 41.30000000000001, 45.9, 39.90000000000002, 44.300000000000004, 17.299999999999805, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, 44.7, 7.299999999999663, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 47.1, 22.899999999999885, 43.10000000000001, -50.00000000000044, 33.30000000000003, 42.900000000000006, 41.500000000000014, 45.3, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 27.099999999999945, -50.00000000000044, 47.3, 41.100000000000016, 46.5, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.90000000000003, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 24.899999999999913, 46.9, 40.30000000000002, 44.900000000000006, 45.9, 41.70000000000002, 1.099999999999575, -50.00000000000044], "episode_lengths": [500, 98, 60, 52, 80, 102, 368, 86, 80, 376, 500, 50, 46, 500, 500, 170, 68, 500, 78, 50, 40, 310, 500, 500, 500, 50, 66, 500, 76, 346, 500, 438, 48, 500, 270, 384, 84, 500, 500, 76, 54, 76, 66, 88, 42, 102, 58, 328, 500, 500, 78, 46, 54, 428, 500, 64, 500, 500, 500, 500, 500, 312, 30, 272, 70, 500, 168, 72, 86, 48, 228, 500, 500, 500, 166, 500, 230, 500, 28, 90, 36, 58, 88, 500, 500, 98, 172, 42, 500, 84, 500, 52, 252, 32, 98, 52, 42, 84, 490, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44822263368244863, "mean_inference_ms": 1.438530428658482, "mean_action_processing_ms": 0.1674771018232797, "mean_env_wait_ms": 0.1007244516664305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998477935791016, "StateBufferConnector_ms": 0.011007308959960938, "ViewRequirementAgentConnector_ms": 0.1250011920928955}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5868.927002173752, "num_env_steps_trained_throughput_per_sec": 5868.927002173752, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3489.276, "sample_time_ms": 3257.587, "load_time_ms": 17.46, "load_throughput": 1030907.393, "learn_time_ms": 200.743, "learn_throughput": 89666.778, "synch_weights_time_ms": 10.878}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2620, "training_iteration": 38, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-49", "timestamp": 1698251089, "time_this_iter_s": 3.0719993114471436, "time_total_s": 137.31980514526367, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 137.31980514526367, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 65.05, "ram_util_percent": 30.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.787056565284729, "policy_loss": -0.01992426426537956, "vf_loss": 6.8070376714070635, "vf_explained_var": -1.6391277313232422e-07, "kl": 0.00027242025047750457, "entropy": 0.5680341174205145, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 462.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.902999999999848, "episode_len_mean": 246.66, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.30000000000003, 42.900000000000006, 41.500000000000014, 45.3, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 27.099999999999945, -50.00000000000044, 47.3, 41.100000000000016, 46.5, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.90000000000003, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 24.899999999999913, 46.9, 40.30000000000002, 44.900000000000006, 45.9, 41.70000000000002, 1.099999999999575, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, 38.90000000000002, 21.09999999999986, 43.10000000000001, 31.900000000000013, 26.69999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 39.300000000000026, 42.70000000000001, 44.10000000000001, 16.8999999999998, 38.90000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.299999999999905, 38.50000000000003, 43.30000000000001, 40.500000000000014, -50.00000000000044, 46.9, 29.49999999999998, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, 10.699999999999712, 42.900000000000006, 43.7, 44.10000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 2.299999999999592, 42.500000000000014, 43.30000000000001, 38.10000000000002, 33.70000000000004, 18.29999999999982, 38.50000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.299999999999933, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 39.300000000000026, 41.100000000000016, 43.7, -50.00000000000044, 14.699999999999768], "episode_lengths": [168, 72, 86, 48, 228, 500, 500, 500, 166, 500, 230, 500, 28, 90, 36, 58, 88, 500, 500, 98, 172, 42, 500, 84, 500, 52, 252, 32, 98, 52, 42, 84, 490, 500, 500, 132, 58, 112, 290, 70, 182, 234, 500, 40, 500, 500, 500, 500, 500, 500, 216, 108, 74, 60, 332, 112, 500, 80, 500, 258, 116, 68, 96, 500, 32, 206, 500, 500, 100, 98, 394, 72, 64, 60, 86, 52, 500, 478, 76, 68, 120, 164, 318, 116, 500, 84, 500, 500, 500, 68, 238, 500, 132, 90, 500, 108, 90, 64, 500, 354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44519146214004013, "mean_inference_ms": 1.4334816924235134, "mean_action_processing_ms": 0.16706941436823727, "mean_env_wait_ms": 0.10003091853189058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.012023448944091797, "ViewRequirementAgentConnector_ms": 0.11699438095092773}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.902999999999848, "episode_len_mean": 246.66, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.30000000000003, 42.900000000000006, 41.500000000000014, 45.3, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 27.099999999999945, -50.00000000000044, 47.3, 41.100000000000016, 46.5, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.90000000000003, 45.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.900000000000006, 24.899999999999913, 46.9, 40.30000000000002, 44.900000000000006, 45.9, 41.70000000000002, 1.099999999999575, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.300000000000004, 38.90000000000002, 21.09999999999986, 43.10000000000001, 31.900000000000013, 26.69999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 39.300000000000026, 42.70000000000001, 44.10000000000001, 16.8999999999998, 38.90000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.299999999999905, 38.50000000000003, 43.30000000000001, 40.500000000000014, -50.00000000000044, 46.9, 29.49999999999998, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, 10.699999999999712, 42.900000000000006, 43.7, 44.10000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 2.299999999999592, 42.500000000000014, 43.30000000000001, 38.10000000000002, 33.70000000000004, 18.29999999999982, 38.50000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.299999999999933, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 39.300000000000026, 41.100000000000016, 43.7, -50.00000000000044, 14.699999999999768], "episode_lengths": [168, 72, 86, 48, 228, 500, 500, 500, 166, 500, 230, 500, 28, 90, 36, 58, 88, 500, 500, 98, 172, 42, 500, 84, 500, 52, 252, 32, 98, 52, 42, 84, 490, 500, 500, 132, 58, 112, 290, 70, 182, 234, 500, 40, 500, 500, 500, 500, 500, 500, 216, 108, 74, 60, 332, 112, 500, 80, 500, 258, 116, 68, 96, 500, 32, 206, 500, 500, 100, 98, 394, 72, 64, 60, 86, 52, 500, 478, 76, 68, 120, 164, 318, 116, 500, 84, 500, 500, 500, 68, 238, 500, 132, 90, 500, 108, 90, 64, 500, 354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44519146214004013, "mean_inference_ms": 1.4334816924235134, "mean_action_processing_ms": 0.16706941436823727, "mean_env_wait_ms": 0.10003091853189058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.012023448944091797, "ViewRequirementAgentConnector_ms": 0.11699438095092773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5838.52421293865, "num_env_steps_trained_throughput_per_sec": 5838.52421293865, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3418.712, "sample_time_ms": 3187.216, "load_time_ms": 17.964, "load_throughput": 1002027.641, "learn_time_ms": 200.233, "learn_throughput": 89895.109, "synch_weights_time_ms": 10.591}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2686, "training_iteration": 39, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-52", "timestamp": 1698251092, "time_this_iter_s": 3.0879697799682617, "time_total_s": 140.40777492523193, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.40777492523193, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 61.67999999999999, "ram_util_percent": 30.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 7.434235135714213, "policy_loss": -0.00978586326042811, "vf_loss": 7.444076855977376, "vf_explained_var": -1.773238182067871e-06, "kl": 3.698581596722761e-05, "entropy": 0.5597866773605347, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 474.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.430999999999848, "episode_len_mean": 251.42, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 43.7, 44.10000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 2.299999999999592, 42.500000000000014, 43.30000000000001, 38.10000000000002, 33.70000000000004, 18.29999999999982, 38.50000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.299999999999933, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 39.300000000000026, 41.100000000000016, 43.7, -50.00000000000044, 14.699999999999768, -50.00000000000044, 36.50000000000003, 45.7, 25.499999999999922, 39.70000000000002, -50.00000000000044, 43.900000000000006, 45.5, 17.69999999999981, 45.1, -50.00000000000044, 28.89999999999997, -50.00000000000044, 34.30000000000004, 38.300000000000026, 31.1, 17.899999999999814, 43.10000000000001, 44.10000000000001, 32.30000000000002, 35.900000000000034, 37.70000000000003, 10.099999999999703, 18.29999999999982, 39.300000000000026, 42.70000000000001, 43.7, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9, 44.900000000000006, -50.00000000000044, 41.90000000000001, 41.90000000000001, 15.299999999999777, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 37.300000000000026, 29.299999999999976, 35.70000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, 29.69999999999998, 4.099999999999618, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 17.099999999999802, 43.7, 19.09999999999983, -50.00000000000044, 1.299999999999578, 29.49999999999998, 10.099999999999703, 46.5, 22.49999999999988, -50.00000000000044, 28.699999999999967, -50.00000000000044, 20.899999999999856], "episode_lengths": [72, 64, 60, 86, 52, 500, 478, 76, 68, 120, 164, 318, 116, 500, 84, 500, 500, 500, 68, 238, 500, 132, 90, 500, 108, 90, 64, 500, 354, 500, 136, 44, 246, 104, 500, 62, 46, 324, 50, 500, 212, 500, 158, 118, 190, 322, 70, 60, 178, 142, 124, 400, 318, 108, 74, 64, 190, 500, 500, 500, 92, 42, 52, 500, 82, 82, 348, 64, 500, 500, 82, 74, 500, 128, 208, 144, 500, 68, 500, 72, 204, 460, 500, 94, 500, 500, 88, 330, 64, 310, 500, 488, 206, 400, 36, 276, 500, 214, 500, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4438457028473216, "mean_inference_ms": 1.4278156370072486, "mean_action_processing_ms": 0.16676031629517596, "mean_env_wait_ms": 0.10008422451549408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200007438659668, "StateBufferConnector_ms": 0.001001596450805664, "ViewRequirementAgentConnector_ms": 0.10605311393737793}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.430999999999848, "episode_len_mean": 251.42, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 43.7, 44.10000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 2.299999999999592, 42.500000000000014, 43.30000000000001, 38.10000000000002, 33.70000000000004, 18.29999999999982, 38.50000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 26.299999999999933, -50.00000000000044, 36.900000000000034, 41.100000000000016, -50.00000000000044, 39.300000000000026, 41.100000000000016, 43.7, -50.00000000000044, 14.699999999999768, -50.00000000000044, 36.50000000000003, 45.7, 25.499999999999922, 39.70000000000002, -50.00000000000044, 43.900000000000006, 45.5, 17.69999999999981, 45.1, -50.00000000000044, 28.89999999999997, -50.00000000000044, 34.30000000000004, 38.300000000000026, 31.1, 17.899999999999814, 43.10000000000001, 44.10000000000001, 32.30000000000002, 35.900000000000034, 37.70000000000003, 10.099999999999703, 18.29999999999982, 39.300000000000026, 42.70000000000001, 43.7, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.9, 44.900000000000006, -50.00000000000044, 41.90000000000001, 41.90000000000001, 15.299999999999777, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 37.300000000000026, 29.299999999999976, 35.70000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, 29.69999999999998, 4.099999999999618, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 17.099999999999802, 43.7, 19.09999999999983, -50.00000000000044, 1.299999999999578, 29.49999999999998, 10.099999999999703, 46.5, 22.49999999999988, -50.00000000000044, 28.699999999999967, -50.00000000000044, 20.899999999999856], "episode_lengths": [72, 64, 60, 86, 52, 500, 478, 76, 68, 120, 164, 318, 116, 500, 84, 500, 500, 500, 68, 238, 500, 132, 90, 500, 108, 90, 64, 500, 354, 500, 136, 44, 246, 104, 500, 62, 46, 324, 50, 500, 212, 500, 158, 118, 190, 322, 70, 60, 178, 142, 124, 400, 318, 108, 74, 64, 190, 500, 500, 500, 92, 42, 52, 500, 82, 82, 348, 64, 500, 500, 82, 74, 500, 128, 208, 144, 500, 68, 500, 72, 204, 460, 500, 94, 500, 500, 88, 330, 64, 310, 500, 488, 206, 400, 36, 276, 500, 214, 500, 292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4438457028473216, "mean_inference_ms": 1.4278156370072486, "mean_action_processing_ms": 0.16676031629517596, "mean_env_wait_ms": 0.10008422451549408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200007438659668, "StateBufferConnector_ms": 0.001001596450805664, "ViewRequirementAgentConnector_ms": 0.10605311393737793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5381.210748811639, "num_env_steps_trained_throughput_per_sec": 5381.210748811639, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3375.487, "sample_time_ms": 3125.562, "load_time_ms": 18.567, "load_throughput": 969467.456, "learn_time_ms": 218.462, "learn_throughput": 82394.232, "synch_weights_time_ms": 10.188}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2757, "training_iteration": 40, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-56", "timestamp": 1698251096, "time_this_iter_s": 3.350001096725464, "time_total_s": 143.7577760219574, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 143.7577760219574, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 68.375, "ram_util_percent": 30.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.826928933461507, "policy_loss": -0.0177726986973236, "vf_loss": 6.844757596651713, "vf_explained_var": -5.513429641723633e-07, "kl": 0.00022995033102250298, "entropy": 0.5584621379772822, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 486.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.40699999999982, "episode_len_mean": 271.58, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 37.300000000000026, 29.299999999999976, 35.70000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, 29.69999999999998, 4.099999999999618, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 17.099999999999802, 43.7, 19.09999999999983, -50.00000000000044, 1.299999999999578, 29.49999999999998, 10.099999999999703, 46.5, 22.49999999999988, -50.00000000000044, 28.699999999999967, -50.00000000000044, 20.899999999999856, -50.00000000000044, 45.5, 34.900000000000034, -50.00000000000044, 41.500000000000014, 45.3, 42.500000000000014, 43.50000000000001, 38.10000000000002, 44.5, 43.7, 3.0999999999996035, -50.00000000000044, 33.500000000000036, 37.90000000000003, -50.00000000000044, 46.9, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, 22.49999999999988, 39.50000000000002, 30.9, 42.10000000000001, -50.00000000000044, 35.30000000000004, 43.30000000000001, 36.900000000000034, 42.900000000000006, -50.00000000000044, 36.70000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 4.699999999999626, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 42.900000000000006, 42.500000000000014, 14.299999999999763, -50.00000000000044, 44.5, 47.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.9, -50.00000000000044, 44.10000000000001, 42.30000000000001, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044], "episode_lengths": [500, 500, 82, 74, 500, 128, 208, 144, 500, 68, 500, 72, 204, 460, 500, 94, 500, 500, 88, 330, 64, 310, 500, 488, 206, 400, 36, 276, 500, 214, 500, 292, 500, 46, 152, 500, 86, 48, 76, 66, 120, 56, 64, 470, 500, 166, 122, 500, 32, 500, 362, 500, 52, 146, 500, 500, 276, 106, 192, 80, 500, 148, 68, 132, 72, 500, 134, 90, 500, 500, 82, 70, 500, 84, 500, 500, 454, 140, 500, 500, 50, 72, 500, 72, 76, 358, 500, 56, 26, 500, 156, 500, 22, 500, 60, 78, 500, 122, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44191487860799034, "mean_inference_ms": 1.422588528929764, "mean_action_processing_ms": 0.16591965417187182, "mean_env_wait_ms": 0.0996745517969643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017993927001953125, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.1020197868347168}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.40699999999982, "episode_len_mean": 271.58, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.90000000000001, 42.70000000000001, -50.00000000000044, 37.300000000000026, 29.299999999999976, 35.70000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.900000000000006, 29.69999999999998, 4.099999999999618, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 17.099999999999802, 43.7, 19.09999999999983, -50.00000000000044, 1.299999999999578, 29.49999999999998, 10.099999999999703, 46.5, 22.49999999999988, -50.00000000000044, 28.699999999999967, -50.00000000000044, 20.899999999999856, -50.00000000000044, 45.5, 34.900000000000034, -50.00000000000044, 41.500000000000014, 45.3, 42.500000000000014, 43.50000000000001, 38.10000000000002, 44.5, 43.7, 3.0999999999996035, -50.00000000000044, 33.500000000000036, 37.90000000000003, -50.00000000000044, 46.9, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.900000000000006, 35.500000000000036, -50.00000000000044, -50.00000000000044, 22.49999999999988, 39.50000000000002, 30.9, 42.10000000000001, -50.00000000000044, 35.30000000000004, 43.30000000000001, 36.900000000000034, 42.900000000000006, -50.00000000000044, 36.70000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 4.699999999999626, 36.10000000000004, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 42.900000000000006, 42.500000000000014, 14.299999999999763, -50.00000000000044, 44.5, 47.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.9, -50.00000000000044, 44.10000000000001, 42.30000000000001, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044], "episode_lengths": [500, 500, 82, 74, 500, 128, 208, 144, 500, 68, 500, 72, 204, 460, 500, 94, 500, 500, 88, 330, 64, 310, 500, 488, 206, 400, 36, 276, 500, 214, 500, 292, 500, 46, 152, 500, 86, 48, 76, 66, 120, 56, 64, 470, 500, 166, 122, 500, 32, 500, 362, 500, 52, 146, 500, 500, 276, 106, 192, 80, 500, 148, 68, 132, 72, 500, 134, 90, 500, 500, 82, 70, 500, 84, 500, 500, 454, 140, 500, 500, 50, 72, 500, 72, 76, 358, 500, 56, 26, 500, 156, 500, 22, 500, 60, 78, 500, 122, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44191487860799034, "mean_inference_ms": 1.422588528929764, "mean_action_processing_ms": 0.16591965417187182, "mean_env_wait_ms": 0.0996745517969643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017993927001953125, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.1020197868347168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5916.999662523792, "num_env_steps_trained_throughput_per_sec": 5916.999662523792, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3282.303, "sample_time_ms": 3034.287, "load_time_ms": 18.264, "load_throughput": 985555.219, "learn_time_ms": 217.341, "learn_throughput": 82819.003, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2825, "training_iteration": 41, "trial_id": "9f288_00022", "date": "2023-10-25_17-24-59", "timestamp": 1698251099, "time_this_iter_s": 3.0480799674987793, "time_total_s": 146.80585598945618, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.80585598945618, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 58.61999999999999, "ram_util_percent": 31.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 7.662036259969075, "policy_loss": -0.032075344623687364, "vf_loss": 7.694170633951823, "vf_explained_var": -3.248453140258789e-06, "kl": 0.000556323278890621, "entropy": 0.5922590891520182, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 498.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.12699999999988, "episode_len_mean": 214.5, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.9, -50.00000000000044, 44.10000000000001, 42.30000000000001, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044, 21.699999999999868, 40.90000000000002, 46.3, 27.699999999999953, -50.00000000000044, 27.899999999999956, 44.10000000000001, 43.30000000000001, 13.499999999999751, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, 41.70000000000002, 44.7, 44.900000000000006, 40.90000000000002, 26.499999999999936, 44.10000000000001, 13.699999999999754, 44.10000000000001, -50.00000000000044, 45.3, 37.50000000000003, -50.00000000000044, 35.30000000000004, 41.70000000000002, -50.00000000000044, 37.70000000000003, 40.70000000000002, 36.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 33.30000000000003, 45.5, 43.50000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, 46.099999999999994, 44.300000000000004, -50.00000000000044, 11.499999999999723, 44.7, 41.90000000000001, 40.70000000000002, 33.500000000000036, 3.0999999999996035, 11.499999999999723, 44.10000000000001, 41.70000000000002, -50.00000000000044, 30.099999999999987, 41.90000000000001, 33.10000000000003, -50.00000000000044, 29.69999999999998, 47.1, 40.500000000000014, 42.900000000000006, 40.10000000000002, 47.9, 19.899999999999842, 41.70000000000002, -50.00000000000044, 45.7, 20.899999999999856, 43.7, 40.10000000000002, 44.7, 43.7, 44.10000000000001, 33.10000000000003, 42.70000000000001, 46.9, 37.10000000000003, 13.899999999999757, 44.7, 42.70000000000001, 41.500000000000014, -50.00000000000044, 37.10000000000003], "episode_lengths": [26, 500, 156, 500, 22, 500, 60, 78, 500, 122, 80, 500, 284, 92, 38, 224, 500, 222, 60, 68, 366, 500, 92, 500, 500, 348, 500, 84, 54, 52, 92, 236, 60, 364, 60, 500, 48, 126, 500, 148, 84, 500, 124, 94, 134, 52, 500, 500, 500, 306, 168, 46, 66, 500, 124, 500, 58, 40, 58, 500, 386, 54, 82, 94, 166, 470, 386, 60, 84, 500, 200, 82, 170, 500, 204, 30, 96, 72, 100, 22, 302, 84, 500, 44, 292, 64, 100, 54, 64, 60, 170, 74, 32, 130, 362, 54, 74, 86, 500, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44042363630556314, "mean_inference_ms": 1.4156340249979422, "mean_action_processing_ms": 0.1649064005426046, "mean_env_wait_ms": 0.09902221635959518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099752426147461, "StateBufferConnector_ms": 0.007004499435424805, "ViewRequirementAgentConnector_ms": 0.10898256301879883}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.12699999999988, "episode_len_mean": 214.5, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.9, -50.00000000000044, 44.10000000000001, 42.30000000000001, -50.00000000000044, 37.90000000000003, 42.10000000000001, -50.00000000000044, 21.699999999999868, 40.90000000000002, 46.3, 27.699999999999953, -50.00000000000044, 27.899999999999956, 44.10000000000001, 43.30000000000001, 13.499999999999751, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, 41.70000000000002, 44.7, 44.900000000000006, 40.90000000000002, 26.499999999999936, 44.10000000000001, 13.699999999999754, 44.10000000000001, -50.00000000000044, 45.3, 37.50000000000003, -50.00000000000044, 35.30000000000004, 41.70000000000002, -50.00000000000044, 37.70000000000003, 40.70000000000002, 36.70000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, 33.30000000000003, 45.5, 43.50000000000001, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, 46.099999999999994, 44.300000000000004, -50.00000000000044, 11.499999999999723, 44.7, 41.90000000000001, 40.70000000000002, 33.500000000000036, 3.0999999999996035, 11.499999999999723, 44.10000000000001, 41.70000000000002, -50.00000000000044, 30.099999999999987, 41.90000000000001, 33.10000000000003, -50.00000000000044, 29.69999999999998, 47.1, 40.500000000000014, 42.900000000000006, 40.10000000000002, 47.9, 19.899999999999842, 41.70000000000002, -50.00000000000044, 45.7, 20.899999999999856, 43.7, 40.10000000000002, 44.7, 43.7, 44.10000000000001, 33.10000000000003, 42.70000000000001, 46.9, 37.10000000000003, 13.899999999999757, 44.7, 42.70000000000001, 41.500000000000014, -50.00000000000044, 37.10000000000003], "episode_lengths": [26, 500, 156, 500, 22, 500, 60, 78, 500, 122, 80, 500, 284, 92, 38, 224, 500, 222, 60, 68, 366, 500, 92, 500, 500, 348, 500, 84, 54, 52, 92, 236, 60, 364, 60, 500, 48, 126, 500, 148, 84, 500, 124, 94, 134, 52, 500, 500, 500, 306, 168, 46, 66, 500, 124, 500, 58, 40, 58, 500, 386, 54, 82, 94, 166, 470, 386, 60, 84, 500, 200, 82, 170, 500, 204, 30, 96, 72, 100, 22, 302, 84, 500, 44, 292, 64, 100, 54, 64, 60, 170, 74, 32, 130, 362, 54, 74, 86, 500, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44042363630556314, "mean_inference_ms": 1.4156340249979422, "mean_action_processing_ms": 0.1649064005426046, "mean_env_wait_ms": 0.09902221635959518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099752426147461, "StateBufferConnector_ms": 0.007004499435424805, "ViewRequirementAgentConnector_ms": 0.10898256301879883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5773.818275870956, "num_env_steps_trained_throughput_per_sec": 5773.818275870956, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3245.165, "sample_time_ms": 2993.188, "load_time_ms": 16.62, "load_throughput": 1083042.318, "learn_time_ms": 223.07, "learn_throughput": 80692.305, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2913, "training_iteration": 42, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-02", "timestamp": 1698251102, "time_this_iter_s": 3.122520923614502, "time_total_s": 149.92837691307068, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.92837691307068, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 68.9, "ram_util_percent": 31.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.767242670059204, "policy_loss": -0.03313581723098954, "vf_loss": 6.800432602564494, "vf_explained_var": -1.5050172805786133e-06, "kl": 0.0001251787997584112, "entropy": 0.5425360053777695, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.181999999999867, "episode_len_mean": 228.9, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 30.099999999999987, 41.90000000000001, 33.10000000000003, -50.00000000000044, 29.69999999999998, 47.1, 40.500000000000014, 42.900000000000006, 40.10000000000002, 47.9, 19.899999999999842, 41.70000000000002, -50.00000000000044, 45.7, 20.899999999999856, 43.7, 40.10000000000002, 44.7, 43.7, 44.10000000000001, 33.10000000000003, 42.70000000000001, 46.9, 37.10000000000003, 13.899999999999757, 44.7, 42.70000000000001, 41.500000000000014, -50.00000000000044, 37.10000000000003, 26.69999999999994, -50.00000000000044, 33.30000000000003, 28.699999999999967, 38.300000000000026, 19.69999999999984, 46.5, -50.00000000000044, 36.50000000000003, 38.700000000000024, 45.5, 41.30000000000001, 41.100000000000016, 43.7, -50.00000000000044, 34.70000000000004, 39.90000000000002, 43.50000000000001, 43.900000000000006, -50.00000000000044, 41.30000000000001, -50.00000000000044, 29.299999999999976, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, -50.00000000000044, 44.10000000000001, 46.5, 46.699999999999996, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 14.699999999999768, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 41.70000000000002, 41.70000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 22.099999999999874, -50.00000000000044, 27.299999999999947, 42.500000000000014, 39.300000000000026, 45.1, 43.7, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [84, 500, 200, 82, 170, 500, 204, 30, 96, 72, 100, 22, 302, 84, 500, 44, 292, 64, 100, 54, 64, 60, 170, 74, 32, 130, 362, 54, 74, 86, 500, 130, 234, 500, 168, 214, 118, 304, 36, 500, 136, 114, 46, 88, 90, 64, 500, 154, 102, 66, 62, 500, 88, 500, 208, 170, 500, 500, 500, 410, 500, 60, 36, 34, 500, 84, 500, 60, 354, 500, 98, 500, 500, 114, 500, 62, 84, 84, 186, 500, 500, 294, 500, 80, 500, 56, 280, 500, 228, 76, 108, 50, 64, 500, 192, 46, 500, 52, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4384190876332059, "mean_inference_ms": 1.4105220112186447, "mean_action_processing_ms": 0.16422132522775057, "mean_env_wait_ms": 0.09835825694866279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024008989334106445, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.1270132064819336}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.181999999999867, "episode_len_mean": 228.9, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 30.099999999999987, 41.90000000000001, 33.10000000000003, -50.00000000000044, 29.69999999999998, 47.1, 40.500000000000014, 42.900000000000006, 40.10000000000002, 47.9, 19.899999999999842, 41.70000000000002, -50.00000000000044, 45.7, 20.899999999999856, 43.7, 40.10000000000002, 44.7, 43.7, 44.10000000000001, 33.10000000000003, 42.70000000000001, 46.9, 37.10000000000003, 13.899999999999757, 44.7, 42.70000000000001, 41.500000000000014, -50.00000000000044, 37.10000000000003, 26.69999999999994, -50.00000000000044, 33.30000000000003, 28.699999999999967, 38.300000000000026, 19.69999999999984, 46.5, -50.00000000000044, 36.50000000000003, 38.700000000000024, 45.5, 41.30000000000001, 41.100000000000016, 43.7, -50.00000000000044, 34.70000000000004, 39.90000000000002, 43.50000000000001, 43.900000000000006, -50.00000000000044, 41.30000000000001, -50.00000000000044, 29.299999999999976, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.099999999999689, -50.00000000000044, 44.10000000000001, 46.5, 46.699999999999996, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 14.699999999999768, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 41.70000000000002, 41.70000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 22.099999999999874, -50.00000000000044, 27.299999999999947, 42.500000000000014, 39.300000000000026, 45.1, 43.7, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [84, 500, 200, 82, 170, 500, 204, 30, 96, 72, 100, 22, 302, 84, 500, 44, 292, 64, 100, 54, 64, 60, 170, 74, 32, 130, 362, 54, 74, 86, 500, 130, 234, 500, 168, 214, 118, 304, 36, 500, 136, 114, 46, 88, 90, 64, 500, 154, 102, 66, 62, 500, 88, 500, 208, 170, 500, 500, 500, 410, 500, 60, 36, 34, 500, 84, 500, 60, 354, 500, 98, 500, 500, 114, 500, 62, 84, 84, 186, 500, 500, 294, 500, 80, 500, 56, 280, 500, 228, 76, 108, 50, 64, 500, 192, 46, 500, 52, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4384190876332059, "mean_inference_ms": 1.4105220112186447, "mean_action_processing_ms": 0.16422132522775057, "mean_env_wait_ms": 0.09835825694866279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024008989334106445, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.1270132064819336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5940.660025494547, "num_env_steps_trained_throughput_per_sec": 5940.660025494547, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3157.557, "sample_time_ms": 2908.8, "load_time_ms": 16.323, "load_throughput": 1102771.072, "learn_time_ms": 219.982, "learn_throughput": 81824.902, "synch_weights_time_ms": 9.855}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2981, "training_iteration": 43, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-05", "timestamp": 1698251105, "time_this_iter_s": 3.0349674224853516, "time_total_s": 152.96334433555603, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.96334433555603, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 63.75, "ram_util_percent": 31.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 7.030546863873799, "policy_loss": -0.023881956934928894, "vf_loss": 7.0544852415720625, "vf_explained_var": -2.980232238769531e-07, "kl": 0.0006356398799169938, "entropy": 0.56360791126887, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 522.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.286999999999843, "episode_len_mean": 242.8, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 22.099999999999874, -50.00000000000044, 27.299999999999947, 42.500000000000014, 39.300000000000026, 45.1, 43.7, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.90000000000003, 46.5, 32.90000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.30000000000001, 39.300000000000026, 44.10000000000001, 45.7, 37.70000000000003, 33.30000000000003, 9.8999999999997, -50.00000000000044, 45.9, 19.09999999999983, 40.500000000000014, 42.900000000000006, 44.900000000000006, 6.499999999999652, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.900000000000006, 20.299999999999848, 45.7, -50.00000000000044, 45.3, 31.1, 25.899999999999928, 39.300000000000026, -50.00000000000044, 45.7, 45.3, 37.90000000000003, 43.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.90000000000002, 44.7, -50.00000000000044, 35.500000000000036, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, 9.8999999999997, 41.70000000000002, 39.10000000000002, 45.5, 46.9, -50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [84, 186, 500, 500, 294, 500, 80, 500, 56, 280, 500, 228, 76, 108, 50, 64, 500, 192, 46, 500, 52, 500, 500, 500, 48, 500, 500, 42, 500, 58, 500, 500, 172, 36, 172, 82, 500, 500, 140, 88, 108, 60, 44, 124, 168, 402, 500, 42, 310, 96, 72, 52, 436, 118, 500, 500, 86, 72, 298, 44, 500, 48, 190, 242, 108, 500, 44, 48, 122, 64, 66, 500, 500, 110, 500, 68, 500, 102, 54, 500, 146, 42, 40, 60, 500, 500, 500, 104, 100, 402, 84, 110, 46, 32, 500, 80, 56, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4367927289543222, "mean_inference_ms": 1.4058191075220055, "mean_action_processing_ms": 0.1636639215200919, "mean_env_wait_ms": 0.09767883059543514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022028446197509766, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.12639737129211426}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.286999999999843, "episode_len_mean": 242.8, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 22.099999999999874, -50.00000000000044, 27.299999999999947, 42.500000000000014, 39.300000000000026, 45.1, 43.7, -50.00000000000044, 30.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.90000000000003, 46.5, 32.90000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.30000000000001, 39.300000000000026, 44.10000000000001, 45.7, 37.70000000000003, 33.30000000000003, 9.8999999999997, -50.00000000000044, 45.9, 19.09999999999983, 40.500000000000014, 42.900000000000006, 44.900000000000006, 6.499999999999652, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.900000000000006, 20.299999999999848, 45.7, -50.00000000000044, 45.3, 31.1, 25.899999999999928, 39.300000000000026, -50.00000000000044, 45.7, 45.3, 37.90000000000003, 43.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.90000000000002, 44.7, -50.00000000000044, 35.500000000000036, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, 9.8999999999997, 41.70000000000002, 39.10000000000002, 45.5, 46.9, -50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [84, 186, 500, 500, 294, 500, 80, 500, 56, 280, 500, 228, 76, 108, 50, 64, 500, 192, 46, 500, 52, 500, 500, 500, 48, 500, 500, 42, 500, 58, 500, 500, 172, 36, 172, 82, 500, 500, 140, 88, 108, 60, 44, 124, 168, 402, 500, 42, 310, 96, 72, 52, 436, 118, 500, 500, 86, 72, 298, 44, 500, 48, 190, 242, 108, 500, 44, 48, 122, 64, 66, 500, 500, 110, 500, 68, 500, 102, 54, 500, 146, 42, 40, 60, 500, 500, 500, 104, 100, 402, 84, 110, 46, 32, 500, 80, 56, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4367927289543222, "mean_inference_ms": 1.4058191075220055, "mean_action_processing_ms": 0.1636639215200919, "mean_env_wait_ms": 0.09767883059543514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022028446197509766, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.12639737129211426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5780.3506516396, "num_env_steps_trained_throughput_per_sec": 5780.3506516396, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3114.446, "sample_time_ms": 2864.889, "load_time_ms": 16.825, "load_throughput": 1069819.343, "learn_time_ms": 220.58, "learn_throughput": 81603.124, "synch_weights_time_ms": 9.554}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3058, "training_iteration": 44, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-08", "timestamp": 1698251108, "time_this_iter_s": 3.1199960708618164, "time_total_s": 156.08334040641785, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.08334040641785, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 62.61999999999999, "ram_util_percent": 31.259999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.6596386432647705, "policy_loss": 0.03713813082625469, "vf_loss": 6.622553865114848, "vf_explained_var": -8.344650268554688e-07, "kl": 0.000526568149268769, "entropy": 0.5335845351219177, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 534.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.096999999999845, "episode_len_mean": 244.7, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.90000000000002, 44.7, -50.00000000000044, 35.500000000000036, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, 9.8999999999997, 41.70000000000002, 39.10000000000002, 45.5, 46.9, -50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.7, 25.099999999999916, 43.900000000000006, 9.699999999999697, 34.30000000000004, -50.00000000000044, 42.10000000000001, 45.5, 41.500000000000014, 46.699999999999996, -50.00000000000044, 40.10000000000002, 43.50000000000001, 43.10000000000001, 31.500000000000007, -50.00000000000044, -50.00000000000044, 41.70000000000002, 39.300000000000026, 39.70000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 36.30000000000003, 5.099999999999632, 33.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 43.7, 31.500000000000007, -50.00000000000044, 40.90000000000002, 41.70000000000002, 8.099999999999675, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.500000000000036, -50.00000000000044, 38.300000000000026, 44.10000000000001, 29.299999999999976, 42.30000000000001, 31.500000000000007, 39.300000000000026, 45.5, 45.5, -50.00000000000044, 17.499999999999808], "episode_lengths": [500, 110, 500, 68, 500, 102, 54, 500, 146, 42, 40, 60, 500, 500, 500, 104, 100, 402, 84, 110, 46, 32, 500, 80, 56, 500, 46, 500, 500, 78, 54, 250, 62, 404, 158, 500, 80, 46, 86, 34, 500, 100, 66, 70, 186, 500, 500, 84, 108, 104, 158, 500, 500, 44, 500, 50, 500, 500, 78, 138, 450, 168, 78, 500, 500, 500, 60, 88, 64, 186, 500, 92, 84, 420, 500, 500, 234, 122, 92, 164, 500, 500, 500, 68, 500, 96, 500, 42, 166, 500, 118, 60, 208, 78, 186, 108, 46, 46, 500, 326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4360370977681626, "mean_inference_ms": 1.4019423870185124, "mean_action_processing_ms": 0.16320098054625182, "mean_env_wait_ms": 0.09734453897461424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199840545654297, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.10308504104614258}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.096999999999845, "episode_len_mean": 244.7, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.90000000000002, 44.7, -50.00000000000044, 35.500000000000036, 45.9, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, 9.8999999999997, 41.70000000000002, 39.10000000000002, 45.5, 46.9, -50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.7, 25.099999999999916, 43.900000000000006, 9.699999999999697, 34.30000000000004, -50.00000000000044, 42.10000000000001, 45.5, 41.500000000000014, 46.699999999999996, -50.00000000000044, 40.10000000000002, 43.50000000000001, 43.10000000000001, 31.500000000000007, -50.00000000000044, -50.00000000000044, 41.70000000000002, 39.300000000000026, 39.70000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.30000000000001, 36.30000000000003, 5.099999999999632, 33.30000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 43.7, 31.500000000000007, -50.00000000000044, 40.90000000000002, 41.70000000000002, 8.099999999999675, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.500000000000036, -50.00000000000044, 38.300000000000026, 44.10000000000001, 29.299999999999976, 42.30000000000001, 31.500000000000007, 39.300000000000026, 45.5, 45.5, -50.00000000000044, 17.499999999999808], "episode_lengths": [500, 110, 500, 68, 500, 102, 54, 500, 146, 42, 40, 60, 500, 500, 500, 104, 100, 402, 84, 110, 46, 32, 500, 80, 56, 500, 46, 500, 500, 78, 54, 250, 62, 404, 158, 500, 80, 46, 86, 34, 500, 100, 66, 70, 186, 500, 500, 84, 108, 104, 158, 500, 500, 44, 500, 50, 500, 500, 78, 138, 450, 168, 78, 500, 500, 500, 60, 88, 64, 186, 500, 92, 84, 420, 500, 500, 234, 122, 92, 164, 500, 500, 500, 68, 500, 96, 500, 42, 166, 500, 118, 60, 208, 78, 186, 108, 46, 46, 500, 326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4360370977681626, "mean_inference_ms": 1.4019423870185124, "mean_action_processing_ms": 0.16320098054625182, "mean_env_wait_ms": 0.09734453897461424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199840545654297, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.10308504104614258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6028.055589955215, "num_env_steps_trained_throughput_per_sec": 6028.055589955215, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3095.945, "sample_time_ms": 2859.756, "load_time_ms": 16.322, "load_throughput": 1102829.063, "learn_time_ms": 208.119, "learn_throughput": 86488.926, "synch_weights_time_ms": 9.35}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3130, "training_iteration": 45, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-11", "timestamp": 1698251111, "time_this_iter_s": 2.99206805229187, "time_total_s": 159.07540845870972, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 159.07540845870972, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 67.82499999999999, "ram_util_percent": 31.325000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 7.013844887415568, "policy_loss": -0.011732336754600206, "vf_loss": 7.025629997253418, "vf_explained_var": -1.3907750447591145e-06, "kl": 4.959056641951065e-05, "entropy": 0.5271584192911783, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 546.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7539999999998255, "episode_len_mean": 263.1, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.099999999999675, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.500000000000036, -50.00000000000044, 38.300000000000026, 44.10000000000001, 29.299999999999976, 42.30000000000001, 31.500000000000007, 39.300000000000026, 45.5, 45.5, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.3, 44.7, 44.5, 43.50000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 18.499999999999822, -50.00000000000044, 44.7, 42.500000000000014, 42.10000000000001, 17.499999999999808, -50.00000000000044, 19.899999999999842, 44.900000000000006, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.5, 36.10000000000004, 45.3, 41.90000000000001, 42.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 39.70000000000002, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 25.099999999999916, 44.7, 41.30000000000001, -50.00000000000044, 45.1, 42.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 23.699999999999896, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 27.49999999999995, 42.500000000000014, 29.099999999999973, 15.099999999999774, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 23.099999999999888], "episode_lengths": [420, 500, 500, 234, 122, 92, 164, 500, 500, 500, 68, 500, 96, 500, 42, 166, 500, 118, 60, 208, 78, 186, 108, 46, 46, 500, 326, 500, 500, 82, 38, 54, 56, 66, 500, 122, 500, 500, 500, 500, 232, 316, 500, 54, 76, 80, 326, 500, 302, 52, 134, 500, 500, 74, 56, 140, 48, 82, 78, 500, 52, 500, 36, 104, 500, 416, 500, 500, 500, 136, 500, 250, 54, 88, 500, 50, 80, 76, 500, 500, 40, 62, 264, 500, 500, 92, 500, 226, 76, 210, 350, 100, 500, 38, 40, 500, 500, 88, 64, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4343271701187092, "mean_inference_ms": 1.3974562064798801, "mean_action_processing_ms": 0.1626862258818472, "mean_env_wait_ms": 0.09680808744440121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006895065307617, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.12201976776123047}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7539999999998255, "episode_len_mean": 263.1, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.099999999999675, -50.00000000000044, -50.00000000000044, 26.69999999999994, 37.90000000000003, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.9, 33.500000000000036, -50.00000000000044, 38.300000000000026, 44.10000000000001, 29.299999999999976, 42.30000000000001, 31.500000000000007, 39.300000000000026, 45.5, 45.5, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.3, 44.7, 44.5, 43.50000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 18.499999999999822, -50.00000000000044, 44.7, 42.500000000000014, 42.10000000000001, 17.499999999999808, -50.00000000000044, 19.899999999999842, 44.900000000000006, 36.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.5, 36.10000000000004, 45.3, 41.90000000000001, 42.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 39.70000000000002, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 25.099999999999916, 44.7, 41.30000000000001, -50.00000000000044, 45.1, 42.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 23.699999999999896, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 27.49999999999995, 42.500000000000014, 29.099999999999973, 15.099999999999774, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 23.099999999999888], "episode_lengths": [420, 500, 500, 234, 122, 92, 164, 500, 500, 500, 68, 500, 96, 500, 42, 166, 500, 118, 60, 208, 78, 186, 108, 46, 46, 500, 326, 500, 500, 82, 38, 54, 56, 66, 500, 122, 500, 500, 500, 500, 232, 316, 500, 54, 76, 80, 326, 500, 302, 52, 134, 500, 500, 74, 56, 140, 48, 82, 78, 500, 52, 500, 36, 104, 500, 416, 500, 500, 500, 136, 500, 250, 54, 88, 500, 50, 80, 76, 500, 500, 40, 62, 264, 500, 500, 92, 500, 226, 76, 210, 350, 100, 500, 38, 40, 500, 500, 88, 64, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4343271701187092, "mean_inference_ms": 1.3974562064798801, "mean_action_processing_ms": 0.1626862258818472, "mean_env_wait_ms": 0.09680808744440121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006895065307617, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.12201976776123047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5815.831037287042, "num_env_steps_trained_throughput_per_sec": 5815.831037287042, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3099.919, "sample_time_ms": 2853.315, "load_time_ms": 17.018, "load_throughput": 1057709.024, "learn_time_ms": 217.701, "learn_throughput": 82682.354, "synch_weights_time_ms": 9.487}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3203, "training_iteration": 46, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-14", "timestamp": 1698251114, "time_this_iter_s": 3.1000027656555176, "time_total_s": 162.17541122436523, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.17541122436523, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 66.275, "ram_util_percent": 31.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.937865654627482, "policy_loss": 0.011691205824414888, "vf_loss": 6.926228761672974, "vf_explained_var": -5.463759104410807e-07, "kl": 0.00011969891815362861, "entropy": 0.5407911762595177, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 558.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.27199999999984, "episode_len_mean": 247.96, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.099999999999916, 44.7, 41.30000000000001, -50.00000000000044, 45.1, 42.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 23.699999999999896, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 27.49999999999995, 42.500000000000014, 29.099999999999973, 15.099999999999774, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 23.099999999999888, 15.49999999999978, 41.90000000000001, 36.10000000000004, 31.300000000000004, 41.90000000000001, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 8.899999999999686, -50.00000000000044, 28.89999999999997, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, 28.29999999999996, 45.5, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.10000000000004, 38.50000000000003, 41.90000000000001, 41.500000000000014, 22.099999999999874, 38.300000000000026, -50.00000000000044, 38.300000000000026, 42.10000000000001, 45.9, -50.00000000000044, 45.7, 23.499999999999893, -50.00000000000044, 45.3, 43.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 45.5, 44.10000000000001, 37.70000000000003, 15.899999999999785, -50.00000000000044, 40.10000000000002, 39.90000000000002, 8.699999999999683, 41.30000000000001, 19.69999999999984, -50.00000000000044, -50.00000000000044, 38.10000000000002], "episode_lengths": [250, 54, 88, 500, 50, 80, 76, 500, 500, 40, 62, 264, 500, 500, 92, 500, 226, 76, 210, 350, 100, 500, 38, 40, 500, 500, 88, 64, 270, 346, 82, 140, 188, 82, 80, 500, 54, 500, 412, 500, 212, 62, 500, 36, 500, 84, 120, 500, 218, 46, 300, 198, 500, 500, 500, 94, 58, 500, 500, 500, 500, 28, 52, 500, 500, 52, 140, 116, 82, 86, 280, 118, 500, 118, 80, 42, 500, 44, 266, 500, 48, 62, 62, 500, 56, 34, 500, 46, 60, 124, 342, 500, 100, 102, 414, 88, 304, 500, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.433723611877316, "mean_inference_ms": 1.3929072109074556, "mean_action_processing_ms": 0.16196166076192062, "mean_env_wait_ms": 0.09673713092780357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.1250016689300537}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.27199999999984, "episode_len_mean": 247.96, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.099999999999916, 44.7, 41.30000000000001, -50.00000000000044, 45.1, 42.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 23.699999999999896, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 27.49999999999995, 42.500000000000014, 29.099999999999973, 15.099999999999774, 40.10000000000002, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.7, 23.099999999999888, 15.49999999999978, 41.90000000000001, 36.10000000000004, 31.300000000000004, 41.90000000000001, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 8.899999999999686, -50.00000000000044, 28.89999999999997, 43.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 41.70000000000002, 38.10000000000002, -50.00000000000044, 28.29999999999996, 45.5, 20.099999999999845, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.10000000000004, 38.50000000000003, 41.90000000000001, 41.500000000000014, 22.099999999999874, 38.300000000000026, -50.00000000000044, 38.300000000000026, 42.10000000000001, 45.9, -50.00000000000044, 45.7, 23.499999999999893, -50.00000000000044, 45.3, 43.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 45.5, 44.10000000000001, 37.70000000000003, 15.899999999999785, -50.00000000000044, 40.10000000000002, 39.90000000000002, 8.699999999999683, 41.30000000000001, 19.69999999999984, -50.00000000000044, -50.00000000000044, 38.10000000000002], "episode_lengths": [250, 54, 88, 500, 50, 80, 76, 500, 500, 40, 62, 264, 500, 500, 92, 500, 226, 76, 210, 350, 100, 500, 38, 40, 500, 500, 88, 64, 270, 346, 82, 140, 188, 82, 80, 500, 54, 500, 412, 500, 212, 62, 500, 36, 500, 84, 120, 500, 218, 46, 300, 198, 500, 500, 500, 94, 58, 500, 500, 500, 500, 28, 52, 500, 500, 52, 140, 116, 82, 86, 280, 118, 500, 118, 80, 42, 500, 44, 266, 500, 48, 62, 62, 500, 56, 34, 500, 46, 60, 124, 342, 500, 100, 102, 414, 88, 304, 500, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.433723611877316, "mean_inference_ms": 1.3929072109074556, "mean_action_processing_ms": 0.16196166076192062, "mean_env_wait_ms": 0.09673713092780357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.1250016689300537}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5649.675465788311, "num_env_steps_trained_throughput_per_sec": 5649.675465788311, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3106.557, "sample_time_ms": 2855.448, "load_time_ms": 16.818, "load_throughput": 1070274.325, "learn_time_ms": 222.309, "learn_throughput": 80968.341, "synch_weights_time_ms": 9.584}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3274, "training_iteration": 47, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-18", "timestamp": 1698251118, "time_this_iter_s": 3.1910221576690674, "time_total_s": 165.3664333820343, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.3664333820343, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 62.14, "ram_util_percent": 31.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.359841664632161, "policy_loss": -0.05620830304299792, "vf_loss": 6.416102409362793, "vf_explained_var": -5.612770716349284e-07, "kl": 1.9474490873472305e-05, "entropy": 0.5253254001339277, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.554999999999834, "episode_len_mean": 250.1, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.10000000000004, 38.50000000000003, 41.90000000000001, 41.500000000000014, 22.099999999999874, 38.300000000000026, -50.00000000000044, 38.300000000000026, 42.10000000000001, 45.9, -50.00000000000044, 45.7, 23.499999999999893, -50.00000000000044, 45.3, 43.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 45.5, 44.10000000000001, 37.70000000000003, 15.899999999999785, -50.00000000000044, 40.10000000000002, 39.90000000000002, 8.699999999999683, 41.30000000000001, 19.69999999999984, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.10000000000001, 31.900000000000013, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 46.9, 20.699999999999854, 42.30000000000001, 41.70000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 41.70000000000002, -50.00000000000044, 42.10000000000001, 46.3, 43.10000000000001, 34.10000000000004, -50.00000000000044, 16.699999999999797, 25.699999999999925, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 37.300000000000026, 47.3, 36.10000000000004, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, 14.09999999999976, 42.500000000000014, 42.500000000000014, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 500, 52, 140, 116, 82, 86, 280, 118, 500, 118, 80, 42, 500, 44, 266, 500, 48, 62, 62, 500, 56, 34, 500, 46, 60, 124, 342, 500, 100, 102, 414, 88, 304, 500, 500, 120, 500, 80, 182, 500, 74, 110, 500, 32, 294, 78, 84, 132, 500, 500, 500, 26, 84, 500, 80, 38, 70, 160, 500, 334, 244, 500, 500, 68, 500, 500, 70, 128, 28, 140, 58, 38, 500, 500, 54, 74, 360, 76, 76, 208, 500, 500, 70, 500, 52, 500, 500, 74, 500, 84, 70, 500, 500, 194, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4319472673948983, "mean_inference_ms": 1.3897143169111117, "mean_action_processing_ms": 0.16179625498394096, "mean_env_wait_ms": 0.0966744451427278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199411392211914, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.11799931526184082}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.554999999999834, "episode_len_mean": 250.1, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.10000000000004, 38.50000000000003, 41.90000000000001, 41.500000000000014, 22.099999999999874, 38.300000000000026, -50.00000000000044, 38.300000000000026, 42.10000000000001, 45.9, -50.00000000000044, 45.7, 23.499999999999893, -50.00000000000044, 45.3, 43.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 45.5, 44.10000000000001, 37.70000000000003, 15.899999999999785, -50.00000000000044, 40.10000000000002, 39.90000000000002, 8.699999999999683, 41.30000000000001, 19.69999999999984, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.10000000000001, 31.900000000000013, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 46.9, 20.699999999999854, 42.30000000000001, 41.70000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 41.70000000000002, -50.00000000000044, 42.10000000000001, 46.3, 43.10000000000001, 34.10000000000004, -50.00000000000044, 16.699999999999797, 25.699999999999925, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 37.300000000000026, 47.3, 36.10000000000004, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, 14.09999999999976, 42.500000000000014, 42.500000000000014, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 500, 52, 140, 116, 82, 86, 280, 118, 500, 118, 80, 42, 500, 44, 266, 500, 48, 62, 62, 500, 56, 34, 500, 46, 60, 124, 342, 500, 100, 102, 414, 88, 304, 500, 500, 120, 500, 80, 182, 500, 74, 110, 500, 32, 294, 78, 84, 132, 500, 500, 500, 26, 84, 500, 80, 38, 70, 160, 500, 334, 244, 500, 500, 68, 500, 500, 70, 128, 28, 140, 58, 38, 500, 500, 54, 74, 360, 76, 76, 208, 500, 500, 70, 500, 52, 500, 500, 74, 500, 84, 70, 500, 500, 194, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4319472673948983, "mean_inference_ms": 1.3897143169111117, "mean_action_processing_ms": 0.16179625498394096, "mean_env_wait_ms": 0.0966744451427278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199411392211914, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.11799931526184082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5707.090802628282, "num_env_steps_trained_throughput_per_sec": 5707.090802628282, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3115.254, "sample_time_ms": 2852.645, "load_time_ms": 17.518, "load_throughput": 1027496.621, "learn_time_ms": 232.809, "learn_throughput": 77316.568, "synch_weights_time_ms": 9.884}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3336, "training_iteration": 48, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-21", "timestamp": 1698251121, "time_this_iter_s": 3.1599698066711426, "time_total_s": 168.52640318870544, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.52640318870544, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 67.25, "ram_util_percent": 31.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.835281848907471, "policy_loss": -0.05046996670231844, "vf_loss": 6.88580580552419, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0002952153547119603, "entropy": 0.5383315881093343, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 582.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.143999999999826, "episode_len_mean": 259.18, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 14.09999999999976, 42.500000000000014, 42.500000000000014, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 34.50000000000004, 43.7, -50.00000000000044, 41.500000000000014, 33.30000000000003, 24.69999999999991, 12.899999999999743, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 5.299999999999635, 46.099999999999994, 42.10000000000001, -50.00000000000044, 44.5, 39.90000000000002, -50.00000000000044, 46.9, 45.1, 45.1, 21.299999999999862, 44.300000000000004, 46.099999999999994, 44.5, 39.90000000000002, 44.900000000000006, 45.3, 46.5, 45.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.90000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 33.500000000000036, 40.500000000000014, 34.10000000000004, 15.699999999999783, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [74, 360, 76, 76, 208, 500, 500, 70, 500, 52, 500, 500, 74, 500, 84, 70, 500, 500, 194, 500, 48, 500, 500, 500, 110, 156, 64, 500, 86, 168, 254, 372, 64, 500, 122, 500, 74, 86, 42, 500, 500, 448, 40, 80, 500, 56, 102, 500, 32, 50, 50, 288, 58, 40, 56, 102, 52, 48, 36, 44, 114, 500, 500, 70, 46, 500, 500, 40, 500, 162, 80, 500, 500, 38, 166, 96, 160, 344, 500, 88, 500, 84, 500, 500, 130, 500, 500, 116, 38, 500, 44, 500, 188, 500, 230, 500, 84, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43072615889050636, "mean_inference_ms": 1.3855105053240655, "mean_action_processing_ms": 0.1615684170112976, "mean_env_wait_ms": 0.09642830143256771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017989635467529297, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.11700797080993652}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.143999999999826, "episode_len_mean": 259.18, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 14.09999999999976, 42.500000000000014, 42.500000000000014, 29.299999999999976, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 34.50000000000004, 43.7, -50.00000000000044, 41.500000000000014, 33.30000000000003, 24.69999999999991, 12.899999999999743, 43.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 5.299999999999635, 46.099999999999994, 42.10000000000001, -50.00000000000044, 44.5, 39.90000000000002, -50.00000000000044, 46.9, 45.1, 45.1, 21.299999999999862, 44.300000000000004, 46.099999999999994, 44.5, 39.90000000000002, 44.900000000000006, 45.3, 46.5, 45.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.90000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 33.500000000000036, 40.500000000000014, 34.10000000000004, 15.699999999999783, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996], "episode_lengths": [74, 360, 76, 76, 208, 500, 500, 70, 500, 52, 500, 500, 74, 500, 84, 70, 500, 500, 194, 500, 48, 500, 500, 500, 110, 156, 64, 500, 86, 168, 254, 372, 64, 500, 122, 500, 74, 86, 42, 500, 500, 448, 40, 80, 500, 56, 102, 500, 32, 50, 50, 288, 58, 40, 56, 102, 52, 48, 36, 44, 114, 500, 500, 70, 46, 500, 500, 40, 500, 162, 80, 500, 500, 38, 166, 96, 160, 344, 500, 88, 500, 84, 500, 500, 130, 500, 500, 116, 38, 500, 44, 500, 188, 500, 230, 500, 84, 500, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43072615889050636, "mean_inference_ms": 1.3855105053240655, "mean_action_processing_ms": 0.1615684170112976, "mean_env_wait_ms": 0.09642830143256771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017989635467529297, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.11700797080993652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5938.631976553024, "num_env_steps_trained_throughput_per_sec": 5938.631976553024, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3110.057, "sample_time_ms": 2849.648, "load_time_ms": 17.515, "load_throughput": 1027677.045, "learn_time_ms": 230.709, "learn_throughput": 78020.378, "synch_weights_time_ms": 9.887}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3413, "training_iteration": 49, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-24", "timestamp": 1698251124, "time_this_iter_s": 3.0410006046295166, "time_total_s": 171.56740379333496, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.56740379333496, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 60.04, "ram_util_percent": 31.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.538382291793823, "policy_loss": -0.0278769595703731, "vf_loss": 6.566310842831929, "vf_explained_var": 6.953875223795573e-08, "kl": 0.00038943160489187295, "entropy": 0.5163962294658025, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 594.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3469999999998192, "episode_len_mean": 272.12, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.90000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 33.500000000000036, 40.500000000000014, 34.10000000000004, 15.699999999999783, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 28.499999999999964, 41.30000000000001, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 34.10000000000004, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.70000000000003, -50.00000000000044, 44.10000000000001, 18.499999999999822, 36.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 35.900000000000034, 34.900000000000034, 42.900000000000006, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 35.500000000000036, 45.3, -50.00000000000044, 39.90000000000002, 45.5, 46.3, 43.900000000000006, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 37.50000000000003, 37.90000000000003, 33.90000000000004, 36.900000000000034, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 45.9, -50.00000000000044], "episode_lengths": [500, 162, 80, 500, 500, 38, 166, 96, 160, 344, 500, 88, 500, 84, 500, 500, 130, 500, 500, 116, 38, 500, 44, 500, 188, 500, 230, 500, 84, 500, 500, 34, 114, 500, 216, 88, 54, 500, 58, 500, 160, 62, 36, 500, 500, 500, 76, 134, 500, 60, 316, 140, 90, 110, 500, 142, 152, 72, 56, 382, 500, 500, 30, 500, 146, 48, 500, 102, 46, 38, 62, 64, 62, 500, 500, 298, 500, 94, 500, 500, 132, 500, 500, 36, 126, 122, 162, 132, 150, 500, 500, 28, 500, 500, 500, 500, 80, 112, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43016741944727344, "mean_inference_ms": 1.382316753156544, "mean_action_processing_ms": 0.1607642746375147, "mean_env_wait_ms": 0.09615419356384133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020031452178955078, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.13014626502990723}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3469999999998192, "episode_len_mean": 272.12, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.90000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, 33.500000000000036, 40.500000000000014, 34.10000000000004, 15.699999999999783, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 31.300000000000004, -50.00000000000044, 27.099999999999945, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.700000000000024, -50.00000000000044, 28.499999999999964, 41.30000000000001, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 34.10000000000004, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.70000000000003, -50.00000000000044, 44.10000000000001, 18.499999999999822, 36.10000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, 35.900000000000034, 34.900000000000034, 42.900000000000006, 44.5, 11.899999999999729, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 35.500000000000036, 45.3, -50.00000000000044, 39.90000000000002, 45.5, 46.3, 43.900000000000006, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 37.50000000000003, 37.90000000000003, 33.90000000000004, 36.900000000000034, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 45.9, -50.00000000000044], "episode_lengths": [500, 162, 80, 500, 500, 38, 166, 96, 160, 344, 500, 88, 500, 84, 500, 500, 130, 500, 500, 116, 38, 500, 44, 500, 188, 500, 230, 500, 84, 500, 500, 34, 114, 500, 216, 88, 54, 500, 58, 500, 160, 62, 36, 500, 500, 500, 76, 134, 500, 60, 316, 140, 90, 110, 500, 142, 152, 72, 56, 382, 500, 500, 30, 500, 146, 48, 500, 102, 46, 38, 62, 64, 62, 500, 500, 298, 500, 94, 500, 500, 132, 500, 500, 36, 126, 122, 162, 132, 150, 500, 500, 28, 500, 500, 500, 500, 80, 112, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43016741944727344, "mean_inference_ms": 1.382316753156544, "mean_action_processing_ms": 0.1607642746375147, "mean_env_wait_ms": 0.09615419356384133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020031452178955078, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.13014626502990723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5919.102524248553, "num_env_steps_trained_throughput_per_sec": 5919.102524248553, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3079.66, "sample_time_ms": 2830.351, "load_time_ms": 16.715, "load_throughput": 1076867.708, "learn_time_ms": 220.406, "learn_throughput": 81667.439, "synch_weights_time_ms": 9.887}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3481, "training_iteration": 50, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-27", "timestamp": 1698251127, "time_this_iter_s": 3.046001434326172, "time_total_s": 174.61340522766113, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.61340522766113, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 31.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.467429478963216, "policy_loss": 0.07994299288839102, "vf_loss": 6.387542366981506, "vf_explained_var": -1.0033448537190755e-06, "kl": 0.00015819426843558895, "entropy": 0.5576739261547724, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 606.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6429999999998275, "episode_len_mean": 259.18, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.299999999999848, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 37.50000000000003, 37.90000000000003, 33.90000000000004, 36.900000000000034, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 34.10000000000004, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.099999999999994, 35.70000000000003, -50.00000000000044, 43.900000000000006, 42.70000000000001, 37.90000000000003, 46.699999999999996, -50.00000000000044, 35.10000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.90000000000001, 12.899999999999743, 17.499999999999808, -50.00000000000044, 43.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.10000000000004, 39.90000000000002, 41.30000000000001, 15.099999999999774, 47.1, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, -50.00000000000044, 44.900000000000006, 34.50000000000004, 45.3, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 39.90000000000002, 43.30000000000001, 40.500000000000014, 35.70000000000003, 41.30000000000001, 43.900000000000006, 40.90000000000002, 46.9, 43.900000000000006, 26.69999999999994], "episode_lengths": [500, 298, 500, 94, 500, 500, 132, 500, 500, 36, 126, 122, 162, 132, 150, 500, 500, 28, 500, 500, 500, 500, 80, 112, 42, 500, 500, 500, 46, 38, 160, 500, 48, 62, 500, 74, 500, 500, 500, 70, 36, 500, 500, 500, 500, 112, 40, 144, 500, 62, 74, 122, 34, 500, 150, 108, 500, 500, 82, 372, 326, 500, 62, 62, 500, 500, 500, 118, 500, 500, 52, 140, 102, 88, 350, 30, 90, 38, 500, 500, 92, 60, 500, 52, 156, 48, 500, 500, 130, 94, 102, 68, 96, 144, 88, 62, 92, 32, 62, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42922111519351885, "mean_inference_ms": 1.3779678769600128, "mean_action_processing_ms": 0.1602837631831092, "mean_env_wait_ms": 0.09564641400277253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997617721557617, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.11901617050170898}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6429999999998275, "episode_len_mean": 259.18, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.299999999999848, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 37.50000000000003, 37.90000000000003, 33.90000000000004, 36.900000000000034, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 34.10000000000004, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.099999999999994, 35.70000000000003, -50.00000000000044, 43.900000000000006, 42.70000000000001, 37.90000000000003, 46.699999999999996, -50.00000000000044, 35.10000000000004, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.90000000000001, 12.899999999999743, 17.499999999999808, -50.00000000000044, 43.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.900000000000006, 36.10000000000004, 39.90000000000002, 41.30000000000001, 15.099999999999774, 47.1, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, -50.00000000000044, 44.900000000000006, 34.50000000000004, 45.3, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 39.90000000000002, 43.30000000000001, 40.500000000000014, 35.70000000000003, 41.30000000000001, 43.900000000000006, 40.90000000000002, 46.9, 43.900000000000006, 26.69999999999994], "episode_lengths": [500, 298, 500, 94, 500, 500, 132, 500, 500, 36, 126, 122, 162, 132, 150, 500, 500, 28, 500, 500, 500, 500, 80, 112, 42, 500, 500, 500, 46, 38, 160, 500, 48, 62, 500, 74, 500, 500, 500, 70, 36, 500, 500, 500, 500, 112, 40, 144, 500, 62, 74, 122, 34, 500, 150, 108, 500, 500, 82, 372, 326, 500, 62, 62, 500, 500, 500, 118, 500, 500, 52, 140, 102, 88, 350, 30, 90, 38, 500, 500, 92, 60, 500, 52, 156, 48, 500, 500, 130, 94, 102, 68, 96, 144, 88, 62, 92, 32, 62, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42922111519351885, "mean_inference_ms": 1.3779678769600128, "mean_action_processing_ms": 0.1602837631831092, "mean_env_wait_ms": 0.09564641400277253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997617721557617, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.11901617050170898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5630.286316730542, "num_env_steps_trained_throughput_per_sec": 5630.286316730542, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3095.152, "sample_time_ms": 2834.842, "load_time_ms": 17.415, "load_throughput": 1033581.885, "learn_time_ms": 230.706, "learn_throughput": 78021.386, "synch_weights_time_ms": 9.787}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3555, "training_iteration": 51, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-30", "timestamp": 1698251130, "time_this_iter_s": 3.2019948959350586, "time_total_s": 177.8154001235962, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.8154001235962, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 66.9, "ram_util_percent": 31.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.872103810310364, "policy_loss": 0.0463617906110206, "vf_loss": 6.825794855753581, "vf_explained_var": 9.437402089436849e-08, "kl": 2.433074896224241e-05, "entropy": 0.5290048271417618, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 618.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.605999999999863, "episode_len_mean": 224.64, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, -50.00000000000044, 44.900000000000006, 34.50000000000004, 45.3, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 39.90000000000002, 43.30000000000001, 40.500000000000014, 35.70000000000003, 41.30000000000001, 43.900000000000006, 40.90000000000002, 46.9, 43.900000000000006, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 44.5, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 42.30000000000001, 40.10000000000002, 46.699999999999996, 41.500000000000014, 35.10000000000004, -50.00000000000044, 41.70000000000002, 23.099999999999888, 46.5, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 15.099999999999774, 39.90000000000002, 27.699999999999953, -50.00000000000044, 44.7, 25.699999999999925, 44.300000000000004, 29.49999999999998, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 7.899999999999672, -50.00000000000044, 21.499999999999865, 32.50000000000002, 42.500000000000014, -50.00000000000044, 43.50000000000001, 28.499999999999964, 23.29999999999989, 43.10000000000001, 44.7, 44.900000000000006, 45.3, 44.10000000000001, 41.90000000000001, -50.00000000000044, 40.70000000000002, 32.30000000000002, 45.7, 29.299999999999976, 43.10000000000001, -50.00000000000044, 43.7], "episode_lengths": [38, 500, 500, 92, 60, 500, 52, 156, 48, 500, 500, 130, 94, 102, 68, 96, 144, 88, 62, 92, 32, 62, 234, 500, 500, 500, 56, 500, 52, 46, 104, 500, 500, 500, 62, 106, 56, 56, 76, 500, 500, 80, 500, 500, 500, 54, 78, 100, 34, 86, 150, 500, 84, 270, 36, 56, 500, 34, 500, 48, 500, 90, 68, 500, 350, 102, 224, 500, 54, 244, 58, 206, 122, 500, 500, 38, 500, 422, 500, 286, 176, 76, 500, 66, 216, 268, 70, 54, 52, 48, 60, 82, 500, 94, 178, 44, 208, 70, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4282252618548897, "mean_inference_ms": 1.3744427639183152, "mean_action_processing_ms": 0.1597742345105598, "mean_env_wait_ms": 0.09572615998221848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.11599111557006836}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.605999999999863, "episode_len_mean": 224.64, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, -50.00000000000044, 44.900000000000006, 34.50000000000004, 45.3, -50.00000000000044, -50.00000000000044, 37.10000000000003, 40.70000000000002, 39.90000000000002, 43.30000000000001, 40.500000000000014, 35.70000000000003, 41.30000000000001, 43.900000000000006, 40.90000000000002, 46.9, 43.900000000000006, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 44.5, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 42.30000000000001, 40.10000000000002, 46.699999999999996, 41.500000000000014, 35.10000000000004, -50.00000000000044, 41.70000000000002, 23.099999999999888, 46.5, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, 43.30000000000001, -50.00000000000044, 15.099999999999774, 39.90000000000002, 27.699999999999953, -50.00000000000044, 44.7, 25.699999999999925, 44.300000000000004, 29.49999999999998, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 7.899999999999672, -50.00000000000044, 21.499999999999865, 32.50000000000002, 42.500000000000014, -50.00000000000044, 43.50000000000001, 28.499999999999964, 23.29999999999989, 43.10000000000001, 44.7, 44.900000000000006, 45.3, 44.10000000000001, 41.90000000000001, -50.00000000000044, 40.70000000000002, 32.30000000000002, 45.7, 29.299999999999976, 43.10000000000001, -50.00000000000044, 43.7], "episode_lengths": [38, 500, 500, 92, 60, 500, 52, 156, 48, 500, 500, 130, 94, 102, 68, 96, 144, 88, 62, 92, 32, 62, 234, 500, 500, 500, 56, 500, 52, 46, 104, 500, 500, 500, 62, 106, 56, 56, 76, 500, 500, 80, 500, 500, 500, 54, 78, 100, 34, 86, 150, 500, 84, 270, 36, 56, 500, 34, 500, 48, 500, 90, 68, 500, 350, 102, 224, 500, 54, 244, 58, 206, 122, 500, 500, 38, 500, 422, 500, 286, 176, 76, 500, 66, 216, 268, 70, 54, 52, 48, 60, 82, 500, 94, 178, 44, 208, 70, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4282252618548897, "mean_inference_ms": 1.3744427639183152, "mean_action_processing_ms": 0.1597742345105598, "mean_env_wait_ms": 0.09572615998221848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.010995149612426758, "ViewRequirementAgentConnector_ms": 0.11599111557006836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5863.191854565607, "num_env_steps_trained_throughput_per_sec": 5863.191854565607, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3090.4, "sample_time_ms": 2832.89, "load_time_ms": 17.419, "load_throughput": 1033382.408, "learn_time_ms": 227.903, "learn_throughput": 78981.041, "synch_weights_time_ms": 9.686}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3632, "training_iteration": 52, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-33", "timestamp": 1698251133, "time_this_iter_s": 3.0749998092651367, "time_total_s": 180.89039993286133, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.89039993286133, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 59.120000000000005, "ram_util_percent": 31.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.887117306391398, "policy_loss": 0.012492958145836989, "vf_loss": 6.87468163172404, "vf_explained_var": -1.917282740275065e-06, "kl": 0.00026889484268544095, "entropy": 0.5731435666481653, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 630.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.149999999999848, "episode_len_mean": 239.2, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 7.899999999999672, -50.00000000000044, 21.499999999999865, 32.50000000000002, 42.500000000000014, -50.00000000000044, 43.50000000000001, 28.499999999999964, 23.29999999999989, 43.10000000000001, 44.7, 44.900000000000006, 45.3, 44.10000000000001, 41.90000000000001, -50.00000000000044, 40.70000000000002, 32.30000000000002, 45.7, 29.299999999999976, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.30000000000003, 1.8999999999995865, 47.3, -50.00000000000044, 35.30000000000004, 41.90000000000001, -50.00000000000044, 38.90000000000002, 12.499999999999737, 42.900000000000006, 34.900000000000034, 45.3, 1.6999999999995836, -50.00000000000044, 30.099999999999987, 43.30000000000001, 43.50000000000001, 45.7, 44.10000000000001, -50.00000000000044, 16.699999999999797, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 22.49999999999988, 43.10000000000001, -50.00000000000044, 43.50000000000001, 41.70000000000002, 32.30000000000002, 47.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 38.10000000000002, -50.00000000000044, 5.6999999999996405, 40.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 37.50000000000003, 42.30000000000001, -50.00000000000044, 42.70000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, 16.499999999999794, 45.7, 45.7, 43.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 47.1, 47.1], "episode_lengths": [122, 500, 500, 38, 500, 422, 500, 286, 176, 76, 500, 66, 216, 268, 70, 54, 52, 48, 60, 82, 500, 94, 178, 44, 208, 70, 500, 64, 500, 500, 500, 76, 138, 482, 28, 500, 148, 82, 500, 112, 376, 72, 152, 48, 484, 500, 200, 68, 66, 44, 60, 500, 334, 80, 500, 500, 78, 276, 70, 500, 66, 84, 178, 30, 500, 98, 500, 500, 98, 500, 132, 500, 50, 120, 500, 444, 92, 110, 500, 500, 48, 500, 40, 126, 78, 500, 74, 84, 52, 500, 336, 44, 44, 62, 500, 102, 500, 100, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42669617341806965, "mean_inference_ms": 1.3705038310213091, "mean_action_processing_ms": 0.15938453462943392, "mean_env_wait_ms": 0.09510894559631579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998933792114258, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.1069939136505127}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.149999999999848, "episode_len_mean": 239.2, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 7.899999999999672, -50.00000000000044, 21.499999999999865, 32.50000000000002, 42.500000000000014, -50.00000000000044, 43.50000000000001, 28.499999999999964, 23.29999999999989, 43.10000000000001, 44.7, 44.900000000000006, 45.3, 44.10000000000001, 41.90000000000001, -50.00000000000044, 40.70000000000002, 32.30000000000002, 45.7, 29.299999999999976, 43.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.30000000000003, 1.8999999999995865, 47.3, -50.00000000000044, 35.30000000000004, 41.90000000000001, -50.00000000000044, 38.90000000000002, 12.499999999999737, 42.900000000000006, 34.900000000000034, 45.3, 1.6999999999995836, -50.00000000000044, 30.099999999999987, 43.30000000000001, 43.50000000000001, 45.7, 44.10000000000001, -50.00000000000044, 16.699999999999797, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 22.49999999999988, 43.10000000000001, -50.00000000000044, 43.50000000000001, 41.70000000000002, 32.30000000000002, 47.1, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 38.10000000000002, -50.00000000000044, 5.6999999999996405, 40.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 37.50000000000003, 42.30000000000001, -50.00000000000044, 42.70000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, 16.499999999999794, 45.7, 45.7, 43.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 47.1, 47.1], "episode_lengths": [122, 500, 500, 38, 500, 422, 500, 286, 176, 76, 500, 66, 216, 268, 70, 54, 52, 48, 60, 82, 500, 94, 178, 44, 208, 70, 500, 64, 500, 500, 500, 76, 138, 482, 28, 500, 148, 82, 500, 112, 376, 72, 152, 48, 484, 500, 200, 68, 66, 44, 60, 500, 334, 80, 500, 500, 78, 276, 70, 500, 66, 84, 178, 30, 500, 98, 500, 500, 98, 500, 132, 500, 50, 120, 500, 444, 92, 110, 500, 500, 48, 500, 40, 126, 78, 500, 74, 84, 52, 500, 336, 44, 44, 62, 500, 102, 500, 100, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42669617341806965, "mean_inference_ms": 1.3705038310213091, "mean_action_processing_ms": 0.15938453462943392, "mean_env_wait_ms": 0.09510894559631579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998933792114258, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.1069939136505127}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5827.183416469314, "num_env_steps_trained_throughput_per_sec": 5827.183416469314, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3096.3, "sample_time_ms": 2836.89, "load_time_ms": 17.116, "load_throughput": 1051657.942, "learn_time_ms": 230.209, "learn_throughput": 78189.975, "synch_weights_time_ms": 9.583}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3704, "training_iteration": 53, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-36", "timestamp": 1698251136, "time_this_iter_s": 3.0939698219299316, "time_total_s": 183.98436975479126, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.98436975479126, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 69.875, "ram_util_percent": 31.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.699228604634603, "policy_loss": 0.0012047321846087773, "vf_loss": 6.698080698649089, "vf_explained_var": -1.321236292521159e-06, "kl": 0.0002017468370449175, "entropy": 0.5692103082935015, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 642.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.413999999999843, "episode_len_mean": 246.52, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, 5.6999999999996405, 40.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 37.50000000000003, 42.30000000000001, -50.00000000000044, 42.70000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, 16.499999999999794, 45.7, 45.7, 43.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 47.1, 47.1, 33.90000000000004, -50.00000000000044, 37.300000000000026, -50.00000000000044, 34.70000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 24.69999999999991, -50.00000000000044, 39.90000000000002, 42.30000000000001, 8.099999999999675, 44.7, -50.00000000000044, 43.10000000000001, 43.900000000000006, -50.00000000000044, 36.900000000000034, 44.900000000000006, 46.3, 36.900000000000034, 21.299999999999862, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.90000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.7, -50.00000000000044, 27.099999999999945, 42.500000000000014, 44.7, 27.49999999999995, 40.90000000000002, 39.50000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 41.90000000000001, 39.10000000000002, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 30.9, 35.30000000000004, -50.00000000000044, 36.50000000000003, 46.099999999999994, 43.50000000000001, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, 39.90000000000002], "episode_lengths": [120, 500, 444, 92, 110, 500, 500, 48, 500, 40, 126, 78, 500, 74, 84, 52, 500, 336, 44, 44, 62, 500, 102, 500, 100, 30, 30, 162, 500, 128, 500, 154, 78, 500, 500, 500, 82, 500, 254, 500, 102, 78, 420, 54, 500, 70, 62, 500, 132, 52, 38, 132, 288, 40, 500, 500, 106, 82, 272, 500, 500, 78, 64, 500, 230, 76, 54, 226, 92, 106, 500, 130, 500, 500, 122, 82, 110, 70, 500, 42, 500, 500, 78, 500, 500, 52, 192, 148, 500, 136, 40, 66, 500, 98, 38, 500, 500, 126, 292, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42574231270715335, "mean_inference_ms": 1.36779133928352, "mean_action_processing_ms": 0.159029235657296, "mean_env_wait_ms": 0.09475476203527494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200364112854004, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.11502695083618164}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.413999999999843, "episode_len_mean": 246.52, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, 5.6999999999996405, 40.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, 37.50000000000003, 42.30000000000001, -50.00000000000044, 42.70000000000001, 41.70000000000002, 44.900000000000006, -50.00000000000044, 16.499999999999794, 45.7, 45.7, 43.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.10000000000002, 47.1, 47.1, 33.90000000000004, -50.00000000000044, 37.300000000000026, -50.00000000000044, 34.70000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 24.69999999999991, -50.00000000000044, 39.90000000000002, 42.30000000000001, 8.099999999999675, 44.7, -50.00000000000044, 43.10000000000001, 43.900000000000006, -50.00000000000044, 36.900000000000034, 44.900000000000006, 46.3, 36.900000000000034, 21.299999999999862, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.90000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.7, -50.00000000000044, 27.099999999999945, 42.500000000000014, 44.7, 27.49999999999995, 40.90000000000002, 39.50000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 41.90000000000001, 39.10000000000002, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 30.9, 35.30000000000004, -50.00000000000044, 36.50000000000003, 46.099999999999994, 43.50000000000001, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, 39.90000000000002], "episode_lengths": [120, 500, 444, 92, 110, 500, 500, 48, 500, 40, 126, 78, 500, 74, 84, 52, 500, 336, 44, 44, 62, 500, 102, 500, 100, 30, 30, 162, 500, 128, 500, 154, 78, 500, 500, 500, 82, 500, 254, 500, 102, 78, 420, 54, 500, 70, 62, 500, 132, 52, 38, 132, 288, 40, 500, 500, 106, 82, 272, 500, 500, 78, 64, 500, 230, 76, 54, 226, 92, 106, 500, 130, 500, 500, 122, 82, 110, 70, 500, 42, 500, 500, 78, 500, 500, 52, 192, 148, 500, 136, 40, 66, 500, 98, 38, 500, 500, 126, 292, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42574231270715335, "mean_inference_ms": 1.36779133928352, "mean_action_processing_ms": 0.159029235657296, "mean_env_wait_ms": 0.09475476203527494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200364112854004, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.11502695083618164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5737.971289422323, "num_env_steps_trained_throughput_per_sec": 5737.971289422323, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3098.6, "sample_time_ms": 2833.49, "load_time_ms": 16.916, "load_throughput": 1064068.542, "learn_time_ms": 236.011, "learn_throughput": 76267.53, "synch_weights_time_ms": 9.68}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3777, "training_iteration": 54, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-39", "timestamp": 1698251139, "time_this_iter_s": 3.141998052597046, "time_total_s": 187.1263678073883, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.1263678073883, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 64.25, "ram_util_percent": 31.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 7.629579345385234, "policy_loss": 0.007922231530149778, "vf_loss": 7.62171737353007, "vf_explained_var": -1.2665987014770508e-06, "kl": 2.9410905952431676e-05, "entropy": 0.6042589843273163, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 654.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.010999999999855, "episode_len_mean": 245.6, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 39.10000000000002, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 30.9, 35.30000000000004, -50.00000000000044, 36.50000000000003, 46.099999999999994, 43.50000000000001, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, 39.90000000000002, 24.099999999999902, 44.5, 35.500000000000036, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.7, 41.70000000000002, 15.49999999999978, 35.900000000000034, 45.3, 34.50000000000004, 32.90000000000003, -50.00000000000044, 38.300000000000026, 42.900000000000006, 30.099999999999987, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.10000000000001, 18.29999999999982, 40.90000000000002, -50.00000000000044, 28.499999999999964, 14.499999999999766, -50.00000000000044, 47.1, 32.100000000000016, 44.7, 31.500000000000007, 39.70000000000002, -50.00000000000044, 4.299999999999621, 18.899999999999828, 40.70000000000002, 28.89999999999997, 38.700000000000024, 43.900000000000006, 22.099999999999874, 39.50000000000002, -50.00000000000044, 25.499999999999922, -50.00000000000044, 45.7, 42.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 13.899999999999757, 39.10000000000002, 38.700000000000024, 6.8999999999996575, 1.299999999999578, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 44.900000000000006, 44.900000000000006, -50.00000000000044, 45.3, 38.50000000000003, 41.100000000000016, 42.900000000000006, 41.90000000000001], "episode_lengths": [82, 110, 70, 500, 42, 500, 500, 78, 500, 500, 52, 192, 148, 500, 136, 40, 66, 500, 98, 38, 500, 500, 126, 292, 102, 260, 56, 146, 500, 116, 500, 500, 44, 84, 346, 142, 48, 156, 172, 500, 118, 72, 200, 138, 500, 40, 500, 500, 500, 148, 80, 318, 92, 500, 216, 356, 500, 30, 180, 54, 186, 104, 500, 458, 312, 94, 212, 114, 62, 280, 106, 500, 246, 500, 44, 80, 110, 500, 500, 500, 98, 500, 38, 362, 110, 114, 432, 488, 500, 500, 92, 122, 52, 52, 500, 48, 116, 90, 72, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42487611270827, "mean_inference_ms": 1.365291060747905, "mean_action_processing_ms": 0.1587553433104998, "mean_env_wait_ms": 0.09457675580419785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018013477325439453, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.13202118873596191}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.010999999999855, "episode_len_mean": 245.6, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 39.10000000000002, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 30.9, 35.30000000000004, -50.00000000000044, 36.50000000000003, 46.099999999999994, 43.50000000000001, -50.00000000000044, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, 39.90000000000002, 24.099999999999902, 44.5, 35.500000000000036, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.7, 41.70000000000002, 15.49999999999978, 35.900000000000034, 45.3, 34.50000000000004, 32.90000000000003, -50.00000000000044, 38.300000000000026, 42.900000000000006, 30.099999999999987, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.10000000000001, 18.29999999999982, 40.90000000000002, -50.00000000000044, 28.499999999999964, 14.499999999999766, -50.00000000000044, 47.1, 32.100000000000016, 44.7, 31.500000000000007, 39.70000000000002, -50.00000000000044, 4.299999999999621, 18.899999999999828, 40.70000000000002, 28.89999999999997, 38.700000000000024, 43.900000000000006, 22.099999999999874, 39.50000000000002, -50.00000000000044, 25.499999999999922, -50.00000000000044, 45.7, 42.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 13.899999999999757, 39.10000000000002, 38.700000000000024, 6.8999999999996575, 1.299999999999578, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 44.900000000000006, 44.900000000000006, -50.00000000000044, 45.3, 38.50000000000003, 41.100000000000016, 42.900000000000006, 41.90000000000001], "episode_lengths": [82, 110, 70, 500, 42, 500, 500, 78, 500, 500, 52, 192, 148, 500, 136, 40, 66, 500, 98, 38, 500, 500, 126, 292, 102, 260, 56, 146, 500, 116, 500, 500, 44, 84, 346, 142, 48, 156, 172, 500, 118, 72, 200, 138, 500, 40, 500, 500, 500, 148, 80, 318, 92, 500, 216, 356, 500, 30, 180, 54, 186, 104, 500, 458, 312, 94, 212, 114, 62, 280, 106, 500, 246, 500, 44, 80, 110, 500, 500, 500, 98, 500, 38, 362, 110, 114, 432, 488, 500, 500, 92, 122, 52, 52, 500, 48, 116, 90, 72, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42487611270827, "mean_inference_ms": 1.365291060747905, "mean_action_processing_ms": 0.1587553433104998, "mean_env_wait_ms": 0.09457675580419785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018013477325439453, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.13202118873596191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5842.313992872448, "num_env_steps_trained_throughput_per_sec": 5842.313992872448, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3108.093, "sample_time_ms": 2834.09, "load_time_ms": 17.512, "load_throughput": 1027865.929, "learn_time_ms": 244.208, "learn_throughput": 73707.608, "synch_weights_time_ms": 9.781}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3852, "training_iteration": 55, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-43", "timestamp": 1698251143, "time_this_iter_s": 3.086970567703247, "time_total_s": 190.21333837509155, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.21333837509155, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 61.14, "ram_util_percent": 31.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.609757502873738, "policy_loss": 0.026696207545076806, "vf_loss": 6.58311680952708, "vf_explained_var": -5.066394805908203e-07, "kl": 9.726984368659448e-05, "entropy": 0.5563762784004211, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 666.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.806999999999846, "episode_len_mean": 247.64, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.899999999999828, 40.70000000000002, 28.89999999999997, 38.700000000000024, 43.900000000000006, 22.099999999999874, 39.50000000000002, -50.00000000000044, 25.499999999999922, -50.00000000000044, 45.7, 42.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 13.899999999999757, 39.10000000000002, 38.700000000000024, 6.8999999999996575, 1.299999999999578, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 44.900000000000006, 44.900000000000006, -50.00000000000044, 45.3, 38.50000000000003, 41.100000000000016, 42.900000000000006, 41.90000000000001, 40.70000000000002, 45.1, 36.50000000000003, 42.10000000000001, 37.70000000000003, -50.00000000000044, 37.70000000000003, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 38.300000000000026, 46.9, 42.10000000000001, 43.30000000000001, 40.10000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.500000000000007, -50.00000000000044, 40.70000000000002, 43.900000000000006, 44.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 17.099999999999802, 20.899999999999856, -50.00000000000044, 44.10000000000001, 42.10000000000001, 0.8999999999995723, -50.00000000000044, 40.30000000000002, 41.500000000000014, 40.500000000000014, 5.6999999999996405, 43.50000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.100000000000016, 40.70000000000002, 1.8999999999995865, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, 42.900000000000006, -50.00000000000044, 30.699999999999996, 42.70000000000001, 41.100000000000016, 44.7], "episode_lengths": [312, 94, 212, 114, 62, 280, 106, 500, 246, 500, 44, 80, 110, 500, 500, 500, 98, 500, 38, 362, 110, 114, 432, 488, 500, 500, 92, 122, 52, 52, 500, 48, 116, 90, 72, 82, 94, 50, 136, 80, 124, 500, 124, 454, 500, 500, 500, 500, 110, 118, 32, 80, 68, 100, 186, 500, 500, 98, 500, 500, 62, 186, 500, 94, 62, 54, 500, 68, 500, 330, 292, 500, 60, 80, 492, 500, 98, 86, 96, 444, 66, 66, 500, 500, 40, 180, 94, 482, 500, 272, 500, 500, 74, 120, 72, 500, 194, 74, 90, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4246564024962736, "mean_inference_ms": 1.3634313422634063, "mean_action_processing_ms": 0.1583225399673168, "mean_env_wait_ms": 0.09452937004869261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001028060913086, "StateBufferConnector_ms": 0.009004354476928711, "ViewRequirementAgentConnector_ms": 0.14606952667236328}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.806999999999846, "episode_len_mean": 247.64, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.899999999999828, 40.70000000000002, 28.89999999999997, 38.700000000000024, 43.900000000000006, 22.099999999999874, 39.50000000000002, -50.00000000000044, 25.499999999999922, -50.00000000000044, 45.7, 42.10000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.3, 13.899999999999757, 39.10000000000002, 38.700000000000024, 6.8999999999996575, 1.299999999999578, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 44.900000000000006, 44.900000000000006, -50.00000000000044, 45.3, 38.50000000000003, 41.100000000000016, 42.900000000000006, 41.90000000000001, 40.70000000000002, 45.1, 36.50000000000003, 42.10000000000001, 37.70000000000003, -50.00000000000044, 37.70000000000003, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 38.300000000000026, 46.9, 42.10000000000001, 43.30000000000001, 40.10000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.500000000000007, -50.00000000000044, 40.70000000000002, 43.900000000000006, 44.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 17.099999999999802, 20.899999999999856, -50.00000000000044, 44.10000000000001, 42.10000000000001, 0.8999999999995723, -50.00000000000044, 40.30000000000002, 41.500000000000014, 40.500000000000014, 5.6999999999996405, 43.50000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.100000000000016, 40.70000000000002, 1.8999999999995865, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, 42.900000000000006, -50.00000000000044, 30.699999999999996, 42.70000000000001, 41.100000000000016, 44.7], "episode_lengths": [312, 94, 212, 114, 62, 280, 106, 500, 246, 500, 44, 80, 110, 500, 500, 500, 98, 500, 38, 362, 110, 114, 432, 488, 500, 500, 92, 122, 52, 52, 500, 48, 116, 90, 72, 82, 94, 50, 136, 80, 124, 500, 124, 454, 500, 500, 500, 500, 110, 118, 32, 80, 68, 100, 186, 500, 500, 98, 500, 500, 62, 186, 500, 94, 62, 54, 500, 68, 500, 330, 292, 500, 60, 80, 492, 500, 98, 86, 96, 444, 66, 66, 500, 500, 40, 180, 94, 482, 500, 272, 500, 500, 74, 120, 72, 500, 194, 74, 90, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4246564024962736, "mean_inference_ms": 1.3634313422634063, "mean_action_processing_ms": 0.1583225399673168, "mean_env_wait_ms": 0.09452937004869261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001028060913086, "StateBufferConnector_ms": 0.009004354476928711, "ViewRequirementAgentConnector_ms": 0.14606952667236328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5893.927302881345, "num_env_steps_trained_throughput_per_sec": 5893.927302881345, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3103.992, "sample_time_ms": 2841.39, "load_time_ms": 16.712, "load_throughput": 1077081.255, "learn_time_ms": 233.811, "learn_throughput": 76985.25, "synch_weights_time_ms": 9.578}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3916, "training_iteration": 56, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-46", "timestamp": 1698251146, "time_this_iter_s": 3.058990001678467, "time_total_s": 193.27232837677002, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.27232837677002, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 67.775, "ram_util_percent": 31.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 7.023884415626526, "policy_loss": 0.013328948911900321, "vf_loss": 7.010610620180766, "vf_explained_var": -7.996956507364909e-07, "kl": 2.804479147755501e-05, "entropy": 0.5522065733869871, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 678.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.02399999999983, "episode_len_mean": 260.42, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.10000000000001, 0.8999999999995723, -50.00000000000044, 40.30000000000002, 41.500000000000014, 40.500000000000014, 5.6999999999996405, 43.50000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.100000000000016, 40.70000000000002, 1.8999999999995865, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, 42.900000000000006, -50.00000000000044, 30.699999999999996, 42.70000000000001, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 40.30000000000002, 38.90000000000002, 28.29999999999996, 40.10000000000002, 45.3, -50.00000000000044, 41.100000000000016, 41.90000000000001, 44.5, 40.30000000000002, 45.1, 42.10000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 37.50000000000003, 38.300000000000026, -50.00000000000044, 26.69999999999994, 33.30000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 25.899999999999928, -50.00000000000044, 11.899999999999729, 45.5, 15.299999999999777, 45.3, 42.900000000000006, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 19.09999999999983, -50.00000000000044, 40.500000000000014, 43.900000000000006, 37.70000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.900000000000006, 45.5, 38.700000000000024, 42.10000000000001, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 20.299999999999848], "episode_lengths": [60, 80, 492, 500, 98, 86, 96, 444, 66, 66, 500, 500, 40, 180, 94, 482, 500, 272, 500, 500, 74, 120, 72, 500, 194, 74, 90, 54, 500, 500, 500, 258, 500, 96, 500, 500, 92, 500, 98, 112, 218, 100, 48, 500, 90, 82, 56, 98, 50, 80, 158, 500, 500, 500, 40, 126, 118, 500, 234, 168, 500, 500, 88, 500, 500, 132, 242, 500, 382, 46, 348, 48, 72, 70, 500, 500, 500, 500, 84, 500, 310, 500, 96, 62, 124, 500, 108, 78, 500, 248, 500, 72, 46, 114, 80, 98, 500, 182, 58, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4234307054260407, "mean_inference_ms": 1.3596380049443277, "mean_action_processing_ms": 0.15795641661983445, "mean_env_wait_ms": 0.09418821559710736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800154685974121, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.11501884460449219}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.02399999999983, "episode_len_mean": 260.42, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.10000000000001, 0.8999999999995723, -50.00000000000044, 40.30000000000002, 41.500000000000014, 40.500000000000014, 5.6999999999996405, 43.50000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 32.100000000000016, 40.70000000000002, 1.8999999999995865, -50.00000000000044, 22.899999999999885, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, 42.900000000000006, -50.00000000000044, 30.699999999999996, 42.70000000000001, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 40.30000000000002, 38.90000000000002, 28.29999999999996, 40.10000000000002, 45.3, -50.00000000000044, 41.100000000000016, 41.90000000000001, 44.5, 40.30000000000002, 45.1, 42.10000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 37.50000000000003, 38.300000000000026, -50.00000000000044, 26.69999999999994, 33.30000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 25.899999999999928, -50.00000000000044, 11.899999999999729, 45.5, 15.299999999999777, 45.3, 42.900000000000006, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 19.09999999999983, -50.00000000000044, 40.500000000000014, 43.900000000000006, 37.70000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.900000000000006, 45.5, 38.700000000000024, 42.10000000000001, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 20.299999999999848], "episode_lengths": [60, 80, 492, 500, 98, 86, 96, 444, 66, 66, 500, 500, 40, 180, 94, 482, 500, 272, 500, 500, 74, 120, 72, 500, 194, 74, 90, 54, 500, 500, 500, 258, 500, 96, 500, 500, 92, 500, 98, 112, 218, 100, 48, 500, 90, 82, 56, 98, 50, 80, 158, 500, 500, 500, 40, 126, 118, 500, 234, 168, 500, 500, 88, 500, 500, 132, 242, 500, 382, 46, 348, 48, 72, 70, 500, 500, 500, 500, 84, 500, 310, 500, 96, 62, 124, 500, 108, 78, 500, 248, 500, 72, 46, 114, 80, 98, 500, 182, 58, 298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4234307054260407, "mean_inference_ms": 1.3596380049443277, "mean_action_processing_ms": 0.15795641661983445, "mean_env_wait_ms": 0.09418821559710736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800154685974121, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.11501884460449219}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5815.829693246695, "num_env_steps_trained_throughput_per_sec": 5815.829693246695, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3094.89, "sample_time_ms": 2838.493, "load_time_ms": 16.812, "load_throughput": 1070667.438, "learn_time_ms": 227.505, "learn_throughput": 79118.977, "synch_weights_time_ms": 9.478}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3988, "training_iteration": 57, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-49", "timestamp": 1698251149, "time_this_iter_s": 3.1000003814697266, "time_total_s": 196.37232875823975, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.37232875823975, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 65.19999999999999, "ram_util_percent": 31.950000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 7.436488787333171, "policy_loss": -0.04855386974910895, "vf_loss": 7.485101501146953, "vf_explained_var": -1.519918441772461e-06, "kl": 0.0002115508221036677, "entropy": 0.5867649515469869, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 690.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.890999999999885, "episode_len_mean": 216.86, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 43.900000000000006, 37.70000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.900000000000006, 45.5, 38.700000000000024, 42.10000000000001, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 20.299999999999848, 24.299999999999905, 41.70000000000002, 42.10000000000001, 38.700000000000024, -50.00000000000044, 34.50000000000004, 33.90000000000004, 44.5, 20.899999999999856, 45.3, 41.30000000000001, 42.500000000000014, 31.500000000000007, 43.7, -50.00000000000044, 15.899999999999785, 38.700000000000024, 45.5, 32.30000000000002, 31.300000000000004, 30.699999999999996, -50.00000000000044, 34.900000000000034, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, 1.099999999999575, 39.70000000000002, 41.70000000000002, 46.9, 42.500000000000014, 42.900000000000006, 43.900000000000006, 28.09999999999996, 41.90000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.3, 36.900000000000034, 10.099999999999703, 37.10000000000003, 28.29999999999996, 44.900000000000006, 41.30000000000001, 47.3, 18.499999999999822, 39.50000000000002, 40.30000000000002, 25.29999999999992, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 23.29999999999989, 41.90000000000001, -50.00000000000044, 38.50000000000003, 32.30000000000002, 43.900000000000006, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.7, 36.30000000000003, 46.3, 45.5, -50.00000000000044, 24.299999999999905, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 31.900000000000013, 46.3, -50.00000000000044], "episode_lengths": [96, 62, 124, 500, 108, 78, 500, 248, 500, 72, 46, 114, 80, 98, 500, 182, 58, 298, 258, 84, 80, 114, 500, 156, 162, 56, 292, 48, 88, 76, 186, 64, 500, 342, 114, 46, 178, 188, 194, 500, 152, 500, 92, 500, 64, 490, 104, 84, 32, 76, 72, 62, 220, 82, 202, 500, 500, 68, 48, 132, 400, 130, 218, 52, 88, 28, 316, 106, 98, 248, 62, 500, 44, 500, 268, 82, 500, 116, 178, 62, 184, 500, 500, 64, 138, 38, 46, 500, 258, 98, 500, 500, 116, 500, 500, 500, 158, 182, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42249837315319977, "mean_inference_ms": 1.3568262586125235, "mean_action_processing_ms": 0.15786822035297032, "mean_env_wait_ms": 0.0941165830098337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028009414672851562, "StateBufferConnector_ms": 0.0010006427764892578, "ViewRequirementAgentConnector_ms": 0.11797451972961426}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.890999999999885, "episode_len_mean": 216.86, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 43.900000000000006, 37.70000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.900000000000006, 45.5, 38.700000000000024, 42.10000000000001, 40.30000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 20.299999999999848, 24.299999999999905, 41.70000000000002, 42.10000000000001, 38.700000000000024, -50.00000000000044, 34.50000000000004, 33.90000000000004, 44.5, 20.899999999999856, 45.3, 41.30000000000001, 42.500000000000014, 31.500000000000007, 43.7, -50.00000000000044, 15.899999999999785, 38.700000000000024, 45.5, 32.30000000000002, 31.300000000000004, 30.699999999999996, -50.00000000000044, 34.900000000000034, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, 1.099999999999575, 39.70000000000002, 41.70000000000002, 46.9, 42.500000000000014, 42.900000000000006, 43.900000000000006, 28.09999999999996, 41.90000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.3, 36.900000000000034, 10.099999999999703, 37.10000000000003, 28.29999999999996, 44.900000000000006, 41.30000000000001, 47.3, 18.499999999999822, 39.50000000000002, 40.30000000000002, 25.29999999999992, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, 23.29999999999989, 41.90000000000001, -50.00000000000044, 38.50000000000003, 32.30000000000002, 43.900000000000006, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.7, 36.30000000000003, 46.3, 45.5, -50.00000000000044, 24.299999999999905, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 31.900000000000013, 46.3, -50.00000000000044], "episode_lengths": [96, 62, 124, 500, 108, 78, 500, 248, 500, 72, 46, 114, 80, 98, 500, 182, 58, 298, 258, 84, 80, 114, 500, 156, 162, 56, 292, 48, 88, 76, 186, 64, 500, 342, 114, 46, 178, 188, 194, 500, 152, 500, 92, 500, 64, 490, 104, 84, 32, 76, 72, 62, 220, 82, 202, 500, 500, 68, 48, 132, 400, 130, 218, 52, 88, 28, 316, 106, 98, 248, 62, 500, 44, 500, 268, 82, 500, 116, 178, 62, 184, 500, 500, 64, 138, 38, 46, 500, 258, 98, 500, 500, 116, 500, 500, 500, 158, 182, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42249837315319977, "mean_inference_ms": 1.3568262586125235, "mean_action_processing_ms": 0.15786822035297032, "mean_env_wait_ms": 0.0941165830098337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028009414672851562, "StateBufferConnector_ms": 0.0010006427764892578, "ViewRequirementAgentConnector_ms": 0.11797451972961426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5872.75316886481, "num_env_steps_trained_throughput_per_sec": 5872.75316886481, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3085.993, "sample_time_ms": 2835.496, "load_time_ms": 16.412, "load_throughput": 1096734.846, "learn_time_ms": 222.405, "learn_throughput": 80933.344, "synch_weights_time_ms": 9.177}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4070, "training_iteration": 58, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-52", "timestamp": 1698251152, "time_this_iter_s": 3.071000337600708, "time_total_s": 199.44332909584045, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 199.44332909584045, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 62.71999999999999, "ram_util_percent": 32.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 7.259626706441243, "policy_loss": 0.011777598410844803, "vf_loss": 7.2479056517283125, "vf_explained_var": -9.238719940185547e-07, "kl": 0.00031006302803623004, "entropy": 0.5662391235431036, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 702.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.474999999999861, "episode_len_mean": 240.96, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, 43.900000000000006, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.7, 36.30000000000003, 46.3, 45.5, -50.00000000000044, 24.299999999999905, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 31.900000000000013, 46.3, -50.00000000000044, 7.699999999999669, -50.00000000000044, 37.300000000000026, 43.30000000000001, 37.90000000000003, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 24.299999999999905, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 43.10000000000001, 36.900000000000034, 22.699999999999882, -50.00000000000044, -50.00000000000044, 38.700000000000024, 24.499999999999908, 35.500000000000036, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 38.300000000000026, 37.10000000000003, 42.70000000000001, 45.1, 42.30000000000001, 23.8999999999999, 27.49999999999995, -50.00000000000044, 19.499999999999837, 31.300000000000004, 39.10000000000002, 34.50000000000004, 33.10000000000003, 13.299999999999748, 43.7, 35.900000000000034, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.300000000000026, 41.70000000000002, 40.500000000000014, 40.70000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, 42.30000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.5, -50.00000000000044, 46.699999999999996, 41.30000000000001, 41.500000000000014, 45.9, 35.10000000000004, 41.90000000000001, 41.70000000000002, 41.100000000000016, -50.00000000000044, 37.10000000000003, 42.10000000000001, 35.500000000000036, 33.90000000000004, 39.50000000000002], "episode_lengths": [178, 62, 184, 500, 500, 64, 138, 38, 46, 500, 258, 98, 500, 500, 116, 500, 500, 500, 158, 182, 38, 500, 424, 500, 128, 68, 122, 40, 60, 500, 500, 110, 258, 66, 500, 500, 500, 500, 78, 500, 140, 70, 132, 274, 500, 500, 114, 256, 146, 500, 500, 332, 500, 118, 130, 74, 50, 78, 262, 226, 500, 306, 188, 110, 156, 170, 368, 64, 142, 68, 104, 500, 118, 84, 96, 94, 500, 450, 500, 66, 78, 68, 500, 214, 56, 500, 34, 88, 86, 42, 150, 82, 84, 90, 500, 130, 80, 146, 162, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4213389562163444, "mean_inference_ms": 1.3536732095763633, "mean_action_processing_ms": 0.1573590746260004, "mean_env_wait_ms": 0.09352253219331721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995710372924805, "StateBufferConnector_ms": 0.008004903793334961, "ViewRequirementAgentConnector_ms": 0.1300041675567627}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.474999999999861, "episode_len_mean": 240.96, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, 43.900000000000006, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.7, 36.30000000000003, 46.3, 45.5, -50.00000000000044, 24.299999999999905, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 31.900000000000013, 46.3, -50.00000000000044, 7.699999999999669, -50.00000000000044, 37.300000000000026, 43.30000000000001, 37.90000000000003, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 24.299999999999905, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.10000000000004, 43.10000000000001, 36.900000000000034, 22.699999999999882, -50.00000000000044, -50.00000000000044, 38.700000000000024, 24.499999999999908, 35.500000000000036, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 38.300000000000026, 37.10000000000003, 42.70000000000001, 45.1, 42.30000000000001, 23.8999999999999, 27.49999999999995, -50.00000000000044, 19.499999999999837, 31.300000000000004, 39.10000000000002, 34.50000000000004, 33.10000000000003, 13.299999999999748, 43.7, 35.900000000000034, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.300000000000026, 41.70000000000002, 40.500000000000014, 40.70000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, 42.30000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.5, -50.00000000000044, 46.699999999999996, 41.30000000000001, 41.500000000000014, 45.9, 35.10000000000004, 41.90000000000001, 41.70000000000002, 41.100000000000016, -50.00000000000044, 37.10000000000003, 42.10000000000001, 35.500000000000036, 33.90000000000004, 39.50000000000002], "episode_lengths": [178, 62, 184, 500, 500, 64, 138, 38, 46, 500, 258, 98, 500, 500, 116, 500, 500, 500, 158, 182, 38, 500, 424, 500, 128, 68, 122, 40, 60, 500, 500, 110, 258, 66, 500, 500, 500, 500, 78, 500, 140, 70, 132, 274, 500, 500, 114, 256, 146, 500, 500, 332, 500, 118, 130, 74, 50, 78, 262, 226, 500, 306, 188, 110, 156, 170, 368, 64, 142, 68, 104, 500, 118, 84, 96, 94, 500, 450, 500, 66, 78, 68, 500, 214, 56, 500, 34, 88, 86, 42, 150, 82, 84, 90, 500, 130, 80, 146, 162, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4213389562163444, "mean_inference_ms": 1.3536732095763633, "mean_action_processing_ms": 0.1573590746260004, "mean_env_wait_ms": 0.09352253219331721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995710372924805, "StateBufferConnector_ms": 0.008004903793334961, "ViewRequirementAgentConnector_ms": 0.1300041675567627}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5849.854845132111, "num_env_steps_trained_throughput_per_sec": 5849.854845132111, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3090.593, "sample_time_ms": 2839.796, "load_time_ms": 16.412, "load_throughput": 1096726.88, "learn_time_ms": 222.605, "learn_throughput": 80860.66, "synch_weights_time_ms": 9.177}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4148, "training_iteration": 59, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-55", "timestamp": 1698251155, "time_this_iter_s": 3.082998037338257, "time_total_s": 202.5263271331787, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.5263271331787, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 68.425, "ram_util_percent": 32.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.783544580141704, "policy_loss": 0.013922026691337427, "vf_loss": 6.769679268201192, "vf_explained_var": -1.0480483373006184e-06, "kl": 7.247753503255201e-05, "entropy": 0.5672382265329361, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 714.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.719999999999851, "episode_len_mean": 243.5, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.299999999999748, 43.7, 35.900000000000034, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.300000000000026, 41.70000000000002, 40.500000000000014, 40.70000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, 42.30000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.5, -50.00000000000044, 46.699999999999996, 41.30000000000001, 41.500000000000014, 45.9, 35.10000000000004, 41.90000000000001, 41.70000000000002, 41.100000000000016, -50.00000000000044, 37.10000000000003, 42.10000000000001, 35.500000000000036, 33.90000000000004, 39.50000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 19.69999999999984, 36.50000000000003, 43.30000000000001, 46.099999999999994, 44.5, 34.50000000000004, 18.099999999999817, 37.10000000000003, 19.09999999999983, 42.900000000000006, 43.30000000000001, 38.50000000000003, 39.10000000000002, 41.500000000000014, 45.5, 43.7, 9.499999999999694, 32.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 24.499999999999908, 40.90000000000002, 41.70000000000002, 44.10000000000001, -50.00000000000044, 27.699999999999953, 38.300000000000026, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 12.299999999999734, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.500000000000014], "episode_lengths": [368, 64, 142, 68, 104, 500, 118, 84, 96, 94, 500, 450, 500, 66, 78, 68, 500, 214, 56, 500, 34, 88, 86, 42, 150, 82, 84, 90, 500, 130, 80, 146, 162, 106, 500, 108, 500, 500, 174, 56, 500, 500, 500, 500, 472, 304, 136, 68, 40, 56, 156, 320, 130, 310, 72, 68, 116, 110, 86, 46, 64, 406, 176, 500, 48, 500, 46, 500, 500, 256, 92, 84, 60, 500, 224, 118, 72, 500, 500, 500, 162, 142, 500, 500, 88, 500, 500, 70, 500, 168, 94, 500, 500, 158, 378, 106, 500, 500, 84, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4210941538030285, "mean_inference_ms": 1.3512692801709127, "mean_action_processing_ms": 0.15719547287978408, "mean_env_wait_ms": 0.09358024049007525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599858283996582, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.10499024391174316}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.719999999999851, "episode_len_mean": 243.5, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.299999999999748, 43.7, 35.900000000000034, 43.30000000000001, 39.70000000000002, -50.00000000000044, 38.300000000000026, 41.70000000000002, 40.500000000000014, 40.70000000000002, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.50000000000001, 42.30000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.5, -50.00000000000044, 46.699999999999996, 41.30000000000001, 41.500000000000014, 45.9, 35.10000000000004, 41.90000000000001, 41.70000000000002, 41.100000000000016, -50.00000000000044, 37.10000000000003, 42.10000000000001, 35.500000000000036, 33.90000000000004, 39.50000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 19.69999999999984, 36.50000000000003, 43.30000000000001, 46.099999999999994, 44.5, 34.50000000000004, 18.099999999999817, 37.10000000000003, 19.09999999999983, 42.900000000000006, 43.30000000000001, 38.50000000000003, 39.10000000000002, 41.500000000000014, 45.5, 43.7, 9.499999999999694, 32.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 24.499999999999908, 40.90000000000002, 41.70000000000002, 44.10000000000001, -50.00000000000044, 27.699999999999953, 38.300000000000026, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 12.299999999999734, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.500000000000014], "episode_lengths": [368, 64, 142, 68, 104, 500, 118, 84, 96, 94, 500, 450, 500, 66, 78, 68, 500, 214, 56, 500, 34, 88, 86, 42, 150, 82, 84, 90, 500, 130, 80, 146, 162, 106, 500, 108, 500, 500, 174, 56, 500, 500, 500, 500, 472, 304, 136, 68, 40, 56, 156, 320, 130, 310, 72, 68, 116, 110, 86, 46, 64, 406, 176, 500, 48, 500, 46, 500, 500, 256, 92, 84, 60, 500, 224, 118, 72, 500, 500, 500, 162, 142, 500, 500, 88, 500, 500, 70, 500, 168, 94, 500, 500, 158, 378, 106, 500, 500, 84, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4210941538030285, "mean_inference_ms": 1.3512692801709127, "mean_action_processing_ms": 0.15719547287978408, "mean_env_wait_ms": 0.09358024049007525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599858283996582, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.10499024391174316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5944.511988434978, "num_env_steps_trained_throughput_per_sec": 5944.511988434978, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3089.293, "sample_time_ms": 2838.496, "load_time_ms": 16.512, "load_throughput": 1090091.845, "learn_time_ms": 222.505, "learn_throughput": 80897.016, "synch_weights_time_ms": 9.28}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4214, "training_iteration": 60, "trial_id": "9f288_00022", "date": "2023-10-25_17-25-58", "timestamp": 1698251158, "time_this_iter_s": 3.0340306758880615, "time_total_s": 205.56035780906677, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.56035780906677, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 65.85, "ram_util_percent": 32.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 7.288772503534953, "policy_loss": 0.027286715805530548, "vf_loss": 7.261545737584432, "vf_explained_var": -5.960464477539062e-07, "kl": 0.0002417190488597972, "entropy": 0.5999404887358347, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 726.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.95999999999988, "episode_len_mean": 221.16, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 33.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 12.299999999999734, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.500000000000014, -50.00000000000044, 31.1, 30.099999999999987, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 36.70000000000003, -50.00000000000044, 43.7, 46.699999999999996, 42.10000000000001, 42.10000000000001, 40.30000000000002, 41.500000000000014, 24.299999999999905, 41.90000000000001, 32.90000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 32.50000000000002, 12.099999999999731, -50.00000000000044, 23.699999999999896, 46.099999999999994, 38.10000000000002, 43.50000000000001, 27.299999999999947, 35.30000000000004, 37.300000000000026, 40.90000000000002, 41.500000000000014, -50.00000000000044, 11.29999999999972, 44.900000000000006, 19.299999999999834, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.7, 44.10000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.300000000000026, 42.30000000000001, 39.300000000000026, 46.9, 42.900000000000006, 39.50000000000002, 44.10000000000001, 46.5, 37.90000000000003, -50.00000000000044, 44.5, 26.299999999999933, 37.10000000000003, 36.30000000000003, 12.499999999999737, 45.7, 38.90000000000002, 39.90000000000002, 42.500000000000014, 44.10000000000001, 45.7, 44.7, 39.300000000000026, 25.899999999999928, -50.00000000000044, 37.50000000000003, 42.10000000000001, 38.700000000000024, 24.499999999999908, 45.3, 12.099999999999731, 41.100000000000016, 11.699999999999726, 46.099999999999994], "episode_lengths": [500, 70, 500, 168, 94, 500, 500, 158, 378, 106, 500, 500, 84, 76, 500, 190, 200, 500, 108, 500, 500, 86, 134, 500, 64, 34, 80, 80, 98, 86, 258, 82, 172, 88, 500, 500, 500, 102, 176, 380, 500, 264, 40, 120, 66, 228, 148, 128, 92, 86, 500, 388, 52, 308, 90, 500, 500, 96, 500, 54, 60, 232, 500, 500, 500, 92, 108, 78, 108, 32, 72, 106, 60, 36, 122, 500, 56, 238, 130, 138, 376, 44, 112, 102, 76, 60, 44, 54, 108, 242, 500, 126, 80, 114, 256, 48, 380, 90, 384, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42070640743008936, "mean_inference_ms": 1.347998648231143, "mean_action_processing_ms": 0.1567521917401419, "mean_env_wait_ms": 0.09337384478355175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000044822692871, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.1179814338684082}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.95999999999988, "episode_len_mean": 221.16, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 33.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 12.299999999999734, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.500000000000014, -50.00000000000044, 31.1, 30.099999999999987, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, 36.70000000000003, -50.00000000000044, 43.7, 46.699999999999996, 42.10000000000001, 42.10000000000001, 40.30000000000002, 41.500000000000014, 24.299999999999905, 41.90000000000001, 32.90000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 32.50000000000002, 12.099999999999731, -50.00000000000044, 23.699999999999896, 46.099999999999994, 38.10000000000002, 43.50000000000001, 27.299999999999947, 35.30000000000004, 37.300000000000026, 40.90000000000002, 41.500000000000014, -50.00000000000044, 11.29999999999972, 44.900000000000006, 19.299999999999834, 41.100000000000016, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.7, 44.10000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.300000000000026, 42.30000000000001, 39.300000000000026, 46.9, 42.900000000000006, 39.50000000000002, 44.10000000000001, 46.5, 37.90000000000003, -50.00000000000044, 44.5, 26.299999999999933, 37.10000000000003, 36.30000000000003, 12.499999999999737, 45.7, 38.90000000000002, 39.90000000000002, 42.500000000000014, 44.10000000000001, 45.7, 44.7, 39.300000000000026, 25.899999999999928, -50.00000000000044, 37.50000000000003, 42.10000000000001, 38.700000000000024, 24.499999999999908, 45.3, 12.099999999999731, 41.100000000000016, 11.699999999999726, 46.099999999999994], "episode_lengths": [500, 70, 500, 168, 94, 500, 500, 158, 378, 106, 500, 500, 84, 76, 500, 190, 200, 500, 108, 500, 500, 86, 134, 500, 64, 34, 80, 80, 98, 86, 258, 82, 172, 88, 500, 500, 500, 102, 176, 380, 500, 264, 40, 120, 66, 228, 148, 128, 92, 86, 500, 388, 52, 308, 90, 500, 500, 96, 500, 54, 60, 232, 500, 500, 500, 92, 108, 78, 108, 32, 72, 106, 60, 36, 122, 500, 56, 238, 130, 138, 376, 44, 112, 102, 76, 60, 44, 54, 108, 242, 500, 126, 80, 114, 256, 48, 380, 90, 384, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42070640743008936, "mean_inference_ms": 1.347998648231143, "mean_action_processing_ms": 0.1567521917401419, "mean_env_wait_ms": 0.09337384478355175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000044822692871, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.1179814338684082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5642.682470094837, "num_env_steps_trained_throughput_per_sec": 5642.682470094837, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3088.591, "sample_time_ms": 2836.293, "load_time_ms": 16.615, "load_throughput": 1083332.932, "learn_time_ms": 215.902, "learn_throughput": 83371.134, "synch_weights_time_ms": 17.38}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4300, "training_iteration": 61, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-01", "timestamp": 1698251161, "time_this_iter_s": 3.195970058441162, "time_total_s": 208.75632786750793, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.75632786750793, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 32.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 7.3467094500859575, "policy_loss": 0.008392946794629097, "vf_loss": 7.3383762439092, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0001880699336590889, "entropy": 0.5987990448872248, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 738.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.878999999999879, "episode_len_mean": 226.98, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 39.300000000000026, 46.9, 42.900000000000006, 39.50000000000002, 44.10000000000001, 46.5, 37.90000000000003, -50.00000000000044, 44.5, 26.299999999999933, 37.10000000000003, 36.30000000000003, 12.499999999999737, 45.7, 38.90000000000002, 39.90000000000002, 42.500000000000014, 44.10000000000001, 45.7, 44.7, 39.300000000000026, 25.899999999999928, -50.00000000000044, 37.50000000000003, 42.10000000000001, 38.700000000000024, 24.499999999999908, 45.3, 12.099999999999731, 41.100000000000016, 11.699999999999726, 46.099999999999994, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.699999999999996, 43.50000000000001, 40.70000000000002, 27.299999999999947, -50.00000000000044, 40.90000000000002, 42.500000000000014, 13.899999999999757, 32.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.10000000000003, 36.10000000000004, -50.00000000000044, 36.70000000000003, 18.29999999999982, 41.100000000000016, 17.499999999999808, 33.500000000000036, 16.8999999999998, 9.499999999999694, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.50000000000002, 39.50000000000002, 39.50000000000002, 41.30000000000001, 14.09999999999976, 32.50000000000002, 45.5, 29.099999999999973, 45.9, 34.30000000000004, 45.7, 28.29999999999996, 41.500000000000014, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.70000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.3, 11.29999999999972, -50.00000000000044, 33.10000000000003, 42.30000000000001, 41.90000000000001], "episode_lengths": [78, 108, 32, 72, 106, 60, 36, 122, 500, 56, 238, 130, 138, 376, 44, 112, 102, 76, 60, 44, 54, 108, 242, 500, 126, 80, 114, 256, 48, 380, 90, 384, 40, 500, 500, 352, 500, 500, 74, 194, 66, 94, 228, 500, 92, 76, 362, 176, 500, 72, 500, 130, 140, 500, 134, 318, 90, 326, 166, 332, 406, 50, 500, 500, 500, 500, 180, 500, 500, 500, 166, 106, 106, 106, 88, 360, 176, 46, 210, 42, 158, 44, 218, 86, 148, 500, 48, 500, 500, 98, 84, 500, 182, 500, 38, 388, 500, 170, 78, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41957288357727834, "mean_inference_ms": 1.345624562225733, "mean_action_processing_ms": 0.15656500193307893, "mean_env_wait_ms": 0.09289592165295592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003173828125, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.10496354103088379}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.878999999999879, "episode_len_mean": 226.98, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 39.300000000000026, 46.9, 42.900000000000006, 39.50000000000002, 44.10000000000001, 46.5, 37.90000000000003, -50.00000000000044, 44.5, 26.299999999999933, 37.10000000000003, 36.30000000000003, 12.499999999999737, 45.7, 38.90000000000002, 39.90000000000002, 42.500000000000014, 44.10000000000001, 45.7, 44.7, 39.300000000000026, 25.899999999999928, -50.00000000000044, 37.50000000000003, 42.10000000000001, 38.700000000000024, 24.499999999999908, 45.3, 12.099999999999731, 41.100000000000016, 11.699999999999726, 46.099999999999994, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 42.70000000000001, 30.699999999999996, 43.50000000000001, 40.70000000000002, 27.299999999999947, -50.00000000000044, 40.90000000000002, 42.500000000000014, 13.899999999999757, 32.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 37.10000000000003, 36.10000000000004, -50.00000000000044, 36.70000000000003, 18.29999999999982, 41.100000000000016, 17.499999999999808, 33.500000000000036, 16.8999999999998, 9.499999999999694, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 39.50000000000002, 39.50000000000002, 39.50000000000002, 41.30000000000001, 14.09999999999976, 32.50000000000002, 45.5, 29.099999999999973, 45.9, 34.30000000000004, 45.7, 28.29999999999996, 41.500000000000014, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.70000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.3, 11.29999999999972, -50.00000000000044, 33.10000000000003, 42.30000000000001, 41.90000000000001], "episode_lengths": [78, 108, 32, 72, 106, 60, 36, 122, 500, 56, 238, 130, 138, 376, 44, 112, 102, 76, 60, 44, 54, 108, 242, 500, 126, 80, 114, 256, 48, 380, 90, 384, 40, 500, 500, 352, 500, 500, 74, 194, 66, 94, 228, 500, 92, 76, 362, 176, 500, 72, 500, 130, 140, 500, 134, 318, 90, 326, 166, 332, 406, 50, 500, 500, 500, 500, 180, 500, 500, 500, 166, 106, 106, 106, 88, 360, 176, 46, 210, 42, 158, 44, 218, 86, 148, 500, 48, 500, 500, 98, 84, 500, 182, 500, 38, 388, 500, 170, 78, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41957288357727834, "mean_inference_ms": 1.345624562225733, "mean_action_processing_ms": 0.15656500193307893, "mean_env_wait_ms": 0.09289592165295592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003173828125, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.10496354103088379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5994.059727604927, "num_env_steps_trained_throughput_per_sec": 5994.059727604927, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3081.888, "sample_time_ms": 2835.49, "load_time_ms": 15.812, "load_throughput": 1138355.918, "learn_time_ms": 210.805, "learn_throughput": 85386.829, "synch_weights_time_ms": 17.48}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4367, "training_iteration": 62, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-04", "timestamp": 1698251164, "time_this_iter_s": 3.00896954536438, "time_total_s": 211.76529741287231, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.76529741287231, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 66.925, "ram_util_percent": 32.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 7.618112842241923, "policy_loss": 0.009206586517393589, "vf_loss": 7.608965992927551, "vf_explained_var": -1.0530153910319011e-06, "kl": 0.00014527386541137352, "entropy": 0.5988094409306844, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 750.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.041999999999874, "episode_len_mean": 230.36, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 14.09999999999976, 32.50000000000002, 45.5, 29.099999999999973, 45.9, 34.30000000000004, 45.7, 28.29999999999996, 41.500000000000014, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.70000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.3, 11.29999999999972, -50.00000000000044, 33.10000000000003, 42.30000000000001, 41.90000000000001, -50.00000000000044, 40.500000000000014, 40.30000000000002, 29.099999999999973, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 39.90000000000002, 35.30000000000004, -50.00000000000044, 36.900000000000034, 43.50000000000001, 13.499999999999751, 15.299999999999777, 42.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, 10.899999999999714, 42.70000000000001, 39.10000000000002, 20.099999999999845, 24.499999999999908, 42.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, 22.49999999999988, 45.9, 45.7, 44.5, 43.900000000000006, 45.3, 35.900000000000034, 42.10000000000001, 40.500000000000014, 41.100000000000016, 40.500000000000014, 40.90000000000002, 44.900000000000006, 0.2999999999995637, 31.300000000000004, -50.00000000000044, 37.70000000000003, 39.50000000000002, 14.699999999999768, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 18.499999999999822, 35.900000000000034, 26.69999999999994, 34.30000000000004, 41.100000000000016, -50.00000000000044, 11.899999999999729, 41.500000000000014, 41.70000000000002, 40.10000000000002, 0.8999999999995723, 17.299999999999805, 43.10000000000001, -50.00000000000044, 19.299999999999834, 35.30000000000004, 40.30000000000002], "episode_lengths": [88, 360, 176, 46, 210, 42, 158, 44, 218, 86, 148, 500, 48, 500, 500, 98, 84, 500, 182, 500, 38, 388, 500, 170, 78, 82, 500, 96, 98, 210, 154, 500, 500, 500, 192, 102, 148, 500, 132, 66, 366, 348, 78, 32, 500, 500, 392, 74, 110, 300, 256, 72, 110, 500, 500, 98, 92, 106, 500, 500, 276, 42, 44, 56, 62, 48, 142, 80, 96, 90, 96, 92, 52, 498, 188, 500, 124, 106, 354, 68, 500, 500, 110, 316, 142, 234, 158, 90, 500, 382, 86, 84, 100, 492, 328, 70, 500, 308, 148, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41880658565494033, "mean_inference_ms": 1.3442797379326936, "mean_action_processing_ms": 0.1563507068340099, "mean_env_wait_ms": 0.09288963274463871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019006013870239258, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.10397791862487793}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.041999999999874, "episode_len_mean": 230.36, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 14.09999999999976, 32.50000000000002, 45.5, 29.099999999999973, 45.9, 34.30000000000004, 45.7, 28.29999999999996, 41.500000000000014, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, 41.70000000000002, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.3, 11.29999999999972, -50.00000000000044, 33.10000000000003, 42.30000000000001, 41.90000000000001, -50.00000000000044, 40.500000000000014, 40.30000000000002, 29.099999999999973, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 39.90000000000002, 35.30000000000004, -50.00000000000044, 36.900000000000034, 43.50000000000001, 13.499999999999751, 15.299999999999777, 42.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, 10.899999999999714, 42.70000000000001, 39.10000000000002, 20.099999999999845, 24.499999999999908, 42.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, 22.49999999999988, 45.9, 45.7, 44.5, 43.900000000000006, 45.3, 35.900000000000034, 42.10000000000001, 40.500000000000014, 41.100000000000016, 40.500000000000014, 40.90000000000002, 44.900000000000006, 0.2999999999995637, 31.300000000000004, -50.00000000000044, 37.70000000000003, 39.50000000000002, 14.699999999999768, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 18.499999999999822, 35.900000000000034, 26.69999999999994, 34.30000000000004, 41.100000000000016, -50.00000000000044, 11.899999999999729, 41.500000000000014, 41.70000000000002, 40.10000000000002, 0.8999999999995723, 17.299999999999805, 43.10000000000001, -50.00000000000044, 19.299999999999834, 35.30000000000004, 40.30000000000002], "episode_lengths": [88, 360, 176, 46, 210, 42, 158, 44, 218, 86, 148, 500, 48, 500, 500, 98, 84, 500, 182, 500, 38, 388, 500, 170, 78, 82, 500, 96, 98, 210, 154, 500, 500, 500, 192, 102, 148, 500, 132, 66, 366, 348, 78, 32, 500, 500, 392, 74, 110, 300, 256, 72, 110, 500, 500, 98, 92, 106, 500, 500, 276, 42, 44, 56, 62, 48, 142, 80, 96, 90, 96, 92, 52, 498, 188, 500, 124, 106, 354, 68, 500, 500, 110, 316, 142, 234, 158, 90, 500, 382, 86, 84, 100, 492, 328, 70, 500, 308, 148, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41880658565494033, "mean_inference_ms": 1.3442797379326936, "mean_action_processing_ms": 0.1563507068340099, "mean_env_wait_ms": 0.09288963274463871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019006013870239258, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.10397791862487793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5647.945978991631, "num_env_steps_trained_throughput_per_sec": 5647.945978991631, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3091.691, "sample_time_ms": 2837.596, "load_time_ms": 16.612, "load_throughput": 1083538.165, "learn_time_ms": 217.199, "learn_throughput": 82873.258, "synch_weights_time_ms": 17.984}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4441, "training_iteration": 63, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-08", "timestamp": 1698251168, "time_this_iter_s": 3.1919994354248047, "time_total_s": 214.95729684829712, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.95729684829712, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 59.839999999999996, "ram_util_percent": 32.519999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 7.356722831726074, "policy_loss": -0.01208698625365893, "vf_loss": 7.36886994043986, "vf_explained_var": -6.059805552164713e-07, "kl": 0.00012545384580183358, "entropy": 0.6027466555436453, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 762.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.000999999999847, "episode_len_mean": 255.72, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.900000000000006, 0.2999999999995637, 31.300000000000004, -50.00000000000044, 37.70000000000003, 39.50000000000002, 14.699999999999768, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 18.499999999999822, 35.900000000000034, 26.69999999999994, 34.30000000000004, 41.100000000000016, -50.00000000000044, 11.899999999999729, 41.500000000000014, 41.70000000000002, 40.10000000000002, 0.8999999999995723, 17.299999999999805, 43.10000000000001, -50.00000000000044, 19.299999999999834, 35.30000000000004, 40.30000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.900000000000006, 38.700000000000024, 46.3, 6.699999999999655, -50.00000000000044, 26.09999999999993, 38.90000000000002, -50.00000000000044, 39.90000000000002, 45.9, 40.500000000000014, 32.100000000000016, 38.700000000000024, -50.00000000000044, 29.69999999999998, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, 42.500000000000014, 2.8999999999996007, 43.900000000000006, 1.8999999999995865, 46.5, 30.9, 40.90000000000002, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 31.300000000000004, 35.30000000000004, 40.500000000000014, 44.300000000000004, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 12.299999999999734, 28.09999999999996, 40.90000000000002, 22.699999999999882, 44.7, 39.10000000000002, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, 29.299999999999976, -50.00000000000044, 35.500000000000036, 42.500000000000014, -50.00000000000044, 36.70000000000003], "episode_lengths": [92, 52, 498, 188, 500, 124, 106, 354, 68, 500, 500, 110, 316, 142, 234, 158, 90, 500, 382, 86, 84, 100, 492, 328, 70, 500, 308, 148, 98, 500, 78, 500, 62, 114, 38, 434, 500, 240, 112, 500, 102, 42, 96, 180, 114, 500, 204, 500, 120, 500, 500, 96, 264, 500, 500, 310, 500, 500, 120, 72, 500, 76, 472, 62, 482, 36, 192, 92, 500, 134, 42, 500, 188, 148, 96, 58, 70, 102, 500, 46, 500, 122, 500, 378, 220, 92, 274, 54, 110, 114, 68, 500, 500, 354, 208, 500, 146, 76, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41796878653793657, "mean_inference_ms": 1.3426444229493035, "mean_action_processing_ms": 0.15596769284183054, "mean_env_wait_ms": 0.0926954958609246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899886131286621, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.10601520538330078}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.000999999999847, "episode_len_mean": 255.72, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.900000000000006, 0.2999999999995637, 31.300000000000004, -50.00000000000044, 37.70000000000003, 39.50000000000002, 14.699999999999768, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 18.499999999999822, 35.900000000000034, 26.69999999999994, 34.30000000000004, 41.100000000000016, -50.00000000000044, 11.899999999999729, 41.500000000000014, 41.70000000000002, 40.10000000000002, 0.8999999999995723, 17.299999999999805, 43.10000000000001, -50.00000000000044, 19.299999999999834, 35.30000000000004, 40.30000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.900000000000006, 38.700000000000024, 46.3, 6.699999999999655, -50.00000000000044, 26.09999999999993, 38.90000000000002, -50.00000000000044, 39.90000000000002, 45.9, 40.500000000000014, 32.100000000000016, 38.700000000000024, -50.00000000000044, 29.69999999999998, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 23.699999999999896, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, 42.500000000000014, 2.8999999999996007, 43.900000000000006, 1.8999999999995865, 46.5, 30.9, 40.90000000000002, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 31.300000000000004, 35.30000000000004, 40.500000000000014, 44.300000000000004, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 12.299999999999734, 28.09999999999996, 40.90000000000002, 22.699999999999882, 44.7, 39.10000000000002, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, 29.299999999999976, -50.00000000000044, 35.500000000000036, 42.500000000000014, -50.00000000000044, 36.70000000000003], "episode_lengths": [92, 52, 498, 188, 500, 124, 106, 354, 68, 500, 500, 110, 316, 142, 234, 158, 90, 500, 382, 86, 84, 100, 492, 328, 70, 500, 308, 148, 98, 500, 78, 500, 62, 114, 38, 434, 500, 240, 112, 500, 102, 42, 96, 180, 114, 500, 204, 500, 120, 500, 500, 96, 264, 500, 500, 310, 500, 500, 120, 72, 500, 76, 472, 62, 482, 36, 192, 92, 500, 134, 42, 500, 188, 148, 96, 58, 70, 102, 500, 46, 500, 122, 500, 378, 220, 92, 274, 54, 110, 114, 68, 500, 500, 354, 208, 500, 146, 76, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41796878653793657, "mean_inference_ms": 1.3426444229493035, "mean_action_processing_ms": 0.15596769284183054, "mean_env_wait_ms": 0.0926954958609246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899886131286621, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.10601520538330078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5665.769493920276, "num_env_steps_trained_throughput_per_sec": 5665.769493920276, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3095.689, "sample_time_ms": 2842.394, "load_time_ms": 16.412, "load_throughput": 1096763.524, "learn_time_ms": 216.499, "learn_throughput": 83141.117, "synch_weights_time_ms": 18.084}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4512, "training_iteration": 64, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-11", "timestamp": 1698251171, "time_this_iter_s": 3.1829724311828613, "time_total_s": 218.14026927947998, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.14026927947998, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 70.375, "ram_util_percent": 32.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 7.117364605267842, "policy_loss": 0.0069439224898815155, "vf_loss": 7.110480984052022, "vf_explained_var": -1.0232130686442058e-06, "kl": 0.00035059884663605584, "entropy": 0.6034779896338781, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 774.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.778999999999856, "episode_len_mean": 247.92, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.300000000000004, 35.30000000000004, 40.500000000000014, 44.300000000000004, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 12.299999999999734, 28.09999999999996, 40.90000000000002, 22.699999999999882, 44.7, 39.10000000000002, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, 29.299999999999976, -50.00000000000044, 35.500000000000036, 42.500000000000014, -50.00000000000044, 36.70000000000003, 38.300000000000026, 40.30000000000002, 42.900000000000006, 39.70000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 27.899999999999956, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 24.099999999999902, 41.90000000000001, 43.50000000000001, 42.10000000000001, 46.5, 31.300000000000004, 45.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 35.900000000000034, -50.00000000000044, 36.900000000000034, 41.70000000000002, 46.5, -50.00000000000044, -50.00000000000044, 30.499999999999993, 43.10000000000001, 42.900000000000006, 41.500000000000014, 34.30000000000004, 6.8999999999996575, -50.00000000000044, 25.099999999999916, 23.099999999999888, 44.7, 40.90000000000002, 47.3, 42.30000000000001, -50.00000000000044, 44.900000000000006, 35.10000000000004, 30.9, 6.8999999999996575, 28.499999999999964, -50.00000000000044, 34.30000000000004, 39.90000000000002, 28.29999999999996, 37.50000000000003, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 32.50000000000002, 45.5, 26.499999999999936, 42.70000000000001], "episode_lengths": [188, 148, 96, 58, 70, 102, 500, 46, 500, 122, 500, 378, 220, 92, 274, 54, 110, 114, 68, 500, 500, 354, 208, 500, 146, 76, 500, 134, 118, 98, 72, 104, 278, 500, 500, 500, 500, 288, 222, 500, 62, 500, 500, 500, 500, 500, 106, 260, 82, 66, 80, 36, 188, 44, 500, 78, 500, 500, 92, 500, 142, 500, 132, 84, 36, 500, 500, 196, 70, 72, 86, 158, 432, 500, 250, 270, 54, 92, 28, 78, 500, 52, 150, 192, 432, 216, 500, 158, 102, 218, 126, 44, 90, 500, 500, 468, 176, 46, 236, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41723785329987256, "mean_inference_ms": 1.3395265150725628, "mean_action_processing_ms": 0.1561529106838455, "mean_env_wait_ms": 0.09242257574035755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025008201599121094, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.11100435256958008}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.778999999999856, "episode_len_mean": 247.92, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.300000000000004, 35.30000000000004, 40.500000000000014, 44.300000000000004, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 12.299999999999734, 28.09999999999996, 40.90000000000002, 22.699999999999882, 44.7, 39.10000000000002, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, 29.299999999999976, -50.00000000000044, 35.500000000000036, 42.500000000000014, -50.00000000000044, 36.70000000000003, 38.300000000000026, 40.30000000000002, 42.900000000000006, 39.70000000000002, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 27.899999999999956, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 24.099999999999902, 41.90000000000001, 43.50000000000001, 42.10000000000001, 46.5, 31.300000000000004, 45.7, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 35.900000000000034, -50.00000000000044, 36.900000000000034, 41.70000000000002, 46.5, -50.00000000000044, -50.00000000000044, 30.499999999999993, 43.10000000000001, 42.900000000000006, 41.500000000000014, 34.30000000000004, 6.8999999999996575, -50.00000000000044, 25.099999999999916, 23.099999999999888, 44.7, 40.90000000000002, 47.3, 42.30000000000001, -50.00000000000044, 44.900000000000006, 35.10000000000004, 30.9, 6.8999999999996575, 28.499999999999964, -50.00000000000044, 34.30000000000004, 39.90000000000002, 28.29999999999996, 37.50000000000003, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 32.50000000000002, 45.5, 26.499999999999936, 42.70000000000001], "episode_lengths": [188, 148, 96, 58, 70, 102, 500, 46, 500, 122, 500, 378, 220, 92, 274, 54, 110, 114, 68, 500, 500, 354, 208, 500, 146, 76, 500, 134, 118, 98, 72, 104, 278, 500, 500, 500, 500, 288, 222, 500, 62, 500, 500, 500, 500, 500, 106, 260, 82, 66, 80, 36, 188, 44, 500, 78, 500, 500, 92, 500, 142, 500, 132, 84, 36, 500, 500, 196, 70, 72, 86, 158, 432, 500, 250, 270, 54, 92, 28, 78, 500, 52, 150, 192, 432, 216, 500, 158, 102, 218, 126, 44, 90, 500, 500, 468, 176, 46, 236, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41723785329987256, "mean_inference_ms": 1.3395265150725628, "mean_action_processing_ms": 0.1561529106838455, "mean_env_wait_ms": 0.09242257574035755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025008201599121094, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.11100435256958008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5710.713119490349, "num_env_steps_trained_throughput_per_sec": 5710.713119490349, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3102.789, "sample_time_ms": 2845.391, "load_time_ms": 16.312, "load_throughput": 1103488.338, "learn_time_ms": 220.699, "learn_throughput": 81558.87, "synch_weights_time_ms": 18.087}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4584, "training_iteration": 65, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-14", "timestamp": 1698251174, "time_this_iter_s": 3.156970739364624, "time_total_s": 221.2972400188446, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.2972400188446, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 64.44999999999999, "ram_util_percent": 32.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.922421495119731, "policy_loss": 0.008233217522501945, "vf_loss": 6.914247910181682, "vf_explained_var": -8.841355641682943e-07, "kl": 0.00023107107324449316, "entropy": 0.5954847385485967, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 786.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.649999999999856, "episode_len_mean": 244.24, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.499999999999993, 43.10000000000001, 42.900000000000006, 41.500000000000014, 34.30000000000004, 6.8999999999996575, -50.00000000000044, 25.099999999999916, 23.099999999999888, 44.7, 40.90000000000002, 47.3, 42.30000000000001, -50.00000000000044, 44.900000000000006, 35.10000000000004, 30.9, 6.8999999999996575, 28.499999999999964, -50.00000000000044, 34.30000000000004, 39.90000000000002, 28.29999999999996, 37.50000000000003, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 32.50000000000002, 45.5, 26.499999999999936, 42.70000000000001, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 8.099999999999675, 43.900000000000006, 44.10000000000001, -50.00000000000044, 37.70000000000003, 28.499999999999964, 43.30000000000001, 21.699999999999868, 36.30000000000003, 37.90000000000003, 32.90000000000003, 39.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.70000000000002, 41.70000000000002, 43.10000000000001, -50.00000000000044, 39.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 34.30000000000004, 28.699999999999967, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.5, -50.00000000000044, 25.699999999999925, 41.30000000000001, 41.100000000000016, 35.10000000000004, 46.099999999999994, 43.30000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 31.500000000000007, 43.30000000000001, 24.099999999999902, -50.00000000000044, 31.500000000000007, 18.699999999999825, 38.50000000000003, 17.299999999999805, -50.00000000000044, 10.899999999999714, 19.69999999999984, 43.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 28.89999999999997], "episode_lengths": [196, 70, 72, 86, 158, 432, 500, 250, 270, 54, 92, 28, 78, 500, 52, 150, 192, 432, 216, 500, 158, 102, 218, 126, 44, 90, 500, 500, 468, 176, 46, 236, 74, 500, 468, 500, 420, 62, 60, 500, 124, 216, 68, 284, 138, 122, 172, 110, 500, 88, 500, 500, 60, 500, 94, 84, 70, 500, 108, 44, 500, 500, 158, 214, 56, 500, 80, 500, 500, 500, 54, 36, 500, 244, 88, 90, 150, 40, 68, 70, 500, 500, 66, 98, 186, 68, 260, 500, 186, 314, 116, 328, 500, 392, 304, 68, 500, 120, 500, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4166638606055289, "mean_inference_ms": 1.3373791432391875, "mean_action_processing_ms": 0.1556466704788959, "mean_env_wait_ms": 0.09220277269955986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600550651550293, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.11394119262695312}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.649999999999856, "episode_len_mean": 244.24, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.499999999999993, 43.10000000000001, 42.900000000000006, 41.500000000000014, 34.30000000000004, 6.8999999999996575, -50.00000000000044, 25.099999999999916, 23.099999999999888, 44.7, 40.90000000000002, 47.3, 42.30000000000001, -50.00000000000044, 44.900000000000006, 35.10000000000004, 30.9, 6.8999999999996575, 28.499999999999964, -50.00000000000044, 34.30000000000004, 39.90000000000002, 28.29999999999996, 37.50000000000003, 45.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 32.50000000000002, 45.5, 26.499999999999936, 42.70000000000001, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 8.099999999999675, 43.900000000000006, 44.10000000000001, -50.00000000000044, 37.70000000000003, 28.499999999999964, 43.30000000000001, 21.699999999999868, 36.30000000000003, 37.90000000000003, 32.90000000000003, 39.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.70000000000002, 41.70000000000002, 43.10000000000001, -50.00000000000044, 39.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 34.30000000000004, 28.699999999999967, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.5, -50.00000000000044, 25.699999999999925, 41.30000000000001, 41.100000000000016, 35.10000000000004, 46.099999999999994, 43.30000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 31.500000000000007, 43.30000000000001, 24.099999999999902, -50.00000000000044, 31.500000000000007, 18.699999999999825, 38.50000000000003, 17.299999999999805, -50.00000000000044, 10.899999999999714, 19.69999999999984, 43.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 28.89999999999997], "episode_lengths": [196, 70, 72, 86, 158, 432, 500, 250, 270, 54, 92, 28, 78, 500, 52, 150, 192, 432, 216, 500, 158, 102, 218, 126, 44, 90, 500, 500, 468, 176, 46, 236, 74, 500, 468, 500, 420, 62, 60, 500, 124, 216, 68, 284, 138, 122, 172, 110, 500, 88, 500, 500, 60, 500, 94, 84, 70, 500, 108, 44, 500, 500, 158, 214, 56, 500, 80, 500, 500, 500, 54, 36, 500, 244, 88, 90, 150, 40, 68, 70, 500, 500, 66, 98, 186, 68, 260, 500, 186, 314, 116, 328, 500, 392, 304, 68, 500, 120, 500, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4166638606055289, "mean_inference_ms": 1.3373791432391875, "mean_action_processing_ms": 0.1556466704788959, "mean_env_wait_ms": 0.09220277269955986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600550651550293, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.11394119262695312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5690.800968237408, "num_env_steps_trained_throughput_per_sec": 5690.800968237408, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3113.689, "sample_time_ms": 2843.995, "load_time_ms": 16.911, "load_throughput": 1064365.568, "learn_time_ms": 232.197, "learn_throughput": 77520.422, "synch_weights_time_ms": 18.187}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4651, "training_iteration": 66, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-17", "timestamp": 1698251177, "time_this_iter_s": 3.1680004596710205, "time_total_s": 224.46524047851562, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 224.46524047851562, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 61.519999999999996, "ram_util_percent": 32.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 7.277383844057719, "policy_loss": 0.0520799458026886, "vf_loss": 7.225366592407227, "vf_explained_var": -1.4801820119222005e-06, "kl": 0.000412761530460178, "entropy": 0.6261431078116099, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 798.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.17799999999984, "episode_len_mean": 258.94, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 46.5, -50.00000000000044, 25.699999999999925, 41.30000000000001, 41.100000000000016, 35.10000000000004, 46.099999999999994, 43.30000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 31.500000000000007, 43.30000000000001, 24.099999999999902, -50.00000000000044, 31.500000000000007, 18.699999999999825, 38.50000000000003, 17.299999999999805, -50.00000000000044, 10.899999999999714, 19.69999999999984, 43.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 28.89999999999997, -50.00000000000044, 38.300000000000026, 19.69999999999984, 42.10000000000001, 34.10000000000004, 19.899999999999842, 45.7, 35.500000000000036, 32.30000000000002, 40.30000000000002, 1.6999999999995836, 5.899999999999643, 43.50000000000001, 44.900000000000006, 30.9, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 32.50000000000002, 3.0999999999996035, -50.00000000000044, 13.099999999999746, 42.70000000000001, 41.100000000000016, -50.00000000000044, 44.10000000000001, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 40.10000000000002, 45.5, 37.70000000000003, 16.09999999999979, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, 39.90000000000002, -50.00000000000044, 27.699999999999953, 43.900000000000006, -50.00000000000044, 19.499999999999837, 43.7, 11.699999999999726, 40.10000000000002, 38.10000000000002, 14.499999999999766, 29.899999999999984, 41.500000000000014], "episode_lengths": [54, 36, 500, 244, 88, 90, 150, 40, 68, 70, 500, 500, 66, 98, 186, 68, 260, 500, 186, 314, 116, 328, 500, 392, 304, 68, 500, 120, 500, 212, 500, 118, 304, 80, 160, 302, 44, 146, 178, 98, 484, 442, 66, 52, 192, 402, 500, 500, 500, 74, 32, 500, 500, 114, 176, 470, 500, 370, 74, 90, 500, 60, 58, 72, 500, 500, 90, 60, 500, 94, 500, 100, 46, 124, 340, 112, 500, 500, 500, 500, 60, 500, 252, 58, 500, 500, 336, 102, 500, 224, 62, 500, 306, 64, 384, 100, 120, 356, 202, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4160083870237146, "mean_inference_ms": 1.3363455968170936, "mean_action_processing_ms": 0.15565665273296522, "mean_env_wait_ms": 0.09232473073492006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995399475097656, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.11899733543395996}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.17799999999984, "episode_len_mean": 258.94, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 46.5, -50.00000000000044, 25.699999999999925, 41.30000000000001, 41.100000000000016, 35.10000000000004, 46.099999999999994, 43.30000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 31.500000000000007, 43.30000000000001, 24.099999999999902, -50.00000000000044, 31.500000000000007, 18.699999999999825, 38.50000000000003, 17.299999999999805, -50.00000000000044, 10.899999999999714, 19.69999999999984, 43.30000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 28.89999999999997, -50.00000000000044, 38.300000000000026, 19.69999999999984, 42.10000000000001, 34.10000000000004, 19.899999999999842, 45.7, 35.500000000000036, 32.30000000000002, 40.30000000000002, 1.6999999999995836, 5.899999999999643, 43.50000000000001, 44.900000000000006, 30.9, 9.8999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, 32.50000000000002, 3.0999999999996035, -50.00000000000044, 13.099999999999746, 42.70000000000001, 41.100000000000016, -50.00000000000044, 44.10000000000001, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 40.10000000000002, 45.5, 37.70000000000003, 16.09999999999979, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, 39.90000000000002, -50.00000000000044, 27.699999999999953, 43.900000000000006, -50.00000000000044, 19.499999999999837, 43.7, 11.699999999999726, 40.10000000000002, 38.10000000000002, 14.499999999999766, 29.899999999999984, 41.500000000000014], "episode_lengths": [54, 36, 500, 244, 88, 90, 150, 40, 68, 70, 500, 500, 66, 98, 186, 68, 260, 500, 186, 314, 116, 328, 500, 392, 304, 68, 500, 120, 500, 212, 500, 118, 304, 80, 160, 302, 44, 146, 178, 98, 484, 442, 66, 52, 192, 402, 500, 500, 500, 74, 32, 500, 500, 114, 176, 470, 500, 370, 74, 90, 500, 60, 58, 72, 500, 500, 90, 60, 500, 94, 500, 100, 46, 124, 340, 112, 500, 500, 500, 500, 60, 500, 252, 58, 500, 500, 336, 102, 500, 224, 62, 500, 306, 64, 384, 100, 120, 356, 202, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4160083870237146, "mean_inference_ms": 1.3363455968170936, "mean_action_processing_ms": 0.15565665273296522, "mean_env_wait_ms": 0.09232473073492006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995399475097656, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.11899733543395996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5730.715515555087, "num_env_steps_trained_throughput_per_sec": 5730.715515555087, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3118.286, "sample_time_ms": 2844.092, "load_time_ms": 16.811, "load_throughput": 1070697.806, "learn_time_ms": 236.897, "learn_throughput": 75982.438, "synch_weights_time_ms": 18.187}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4721, "training_iteration": 67, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-20", "timestamp": 1698251180, "time_this_iter_s": 3.145968437194824, "time_total_s": 227.61120891571045, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.61120891571045, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 64.75, "ram_util_percent": 32.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.821913758913676, "policy_loss": 0.00597091531381011, "vf_loss": 6.816003203392029, "vf_explained_var": -1.430511474609375e-06, "kl": 0.0002743315149208077, "entropy": 0.6044913033644358, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 810.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8849999999998022, "episode_len_mean": 286.76, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 40.10000000000002, 45.5, 37.70000000000003, 16.09999999999979, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, 39.90000000000002, -50.00000000000044, 27.699999999999953, 43.900000000000006, -50.00000000000044, 19.499999999999837, 43.7, 11.699999999999726, 40.10000000000002, 38.10000000000002, 14.499999999999766, 29.899999999999984, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.89999999999997, 40.70000000000002, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 34.900000000000034, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, 40.30000000000002, 27.49999999999995, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 45.7, 8.49999999999968, 34.50000000000004, 9.8999999999997, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 40.70000000000002, 5.099999999999632, -50.00000000000044, 46.5, -50.00000000000044, 14.499999999999766, 40.70000000000002, -50.00000000000044, 42.500000000000014, 43.900000000000006, 39.50000000000002, 43.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 21.499999999999865, 36.70000000000003, -50.00000000000044], "episode_lengths": [500, 60, 58, 72, 500, 500, 90, 60, 500, 94, 500, 100, 46, 124, 340, 112, 500, 500, 500, 500, 60, 500, 252, 58, 500, 500, 336, 102, 500, 224, 62, 500, 306, 64, 384, 100, 120, 356, 202, 86, 500, 500, 500, 104, 500, 212, 94, 500, 500, 262, 80, 500, 500, 42, 500, 152, 42, 40, 500, 500, 54, 92, 98, 226, 500, 58, 500, 42, 44, 416, 156, 402, 254, 500, 500, 104, 500, 500, 50, 94, 450, 500, 36, 500, 356, 94, 500, 76, 62, 106, 68, 500, 110, 500, 500, 500, 412, 286, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41552249524859314, "mean_inference_ms": 1.3345730950473012, "mean_action_processing_ms": 0.15526030534916319, "mean_env_wait_ms": 0.09191777232879378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006532669067383, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.125030517578125}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8849999999998022, "episode_len_mean": 286.76, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 40.10000000000002, 45.5, 37.70000000000003, 16.09999999999979, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 16.499999999999794, 39.90000000000002, -50.00000000000044, 27.699999999999953, 43.900000000000006, -50.00000000000044, 19.499999999999837, 43.7, 11.699999999999726, 40.10000000000002, 38.10000000000002, 14.499999999999766, 29.899999999999984, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.89999999999997, 40.70000000000002, -50.00000000000044, -50.00000000000044, 23.8999999999999, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 34.900000000000034, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, 40.30000000000002, 27.49999999999995, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 45.7, 8.49999999999968, 34.50000000000004, 9.8999999999997, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 40.70000000000002, 5.099999999999632, -50.00000000000044, 46.5, -50.00000000000044, 14.499999999999766, 40.70000000000002, -50.00000000000044, 42.500000000000014, 43.900000000000006, 39.50000000000002, 43.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 21.499999999999865, 36.70000000000003, -50.00000000000044], "episode_lengths": [500, 60, 58, 72, 500, 500, 90, 60, 500, 94, 500, 100, 46, 124, 340, 112, 500, 500, 500, 500, 60, 500, 252, 58, 500, 500, 336, 102, 500, 224, 62, 500, 306, 64, 384, 100, 120, 356, 202, 86, 500, 500, 500, 104, 500, 212, 94, 500, 500, 262, 80, 500, 500, 42, 500, 152, 42, 40, 500, 500, 54, 92, 98, 226, 500, 58, 500, 42, 44, 416, 156, 402, 254, 500, 500, 104, 500, 500, 50, 94, 450, 500, 36, 500, 356, 94, 500, 76, 62, 106, 68, 500, 110, 500, 500, 500, 412, 286, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41552249524859314, "mean_inference_ms": 1.3345730950473012, "mean_action_processing_ms": 0.15526030534916319, "mean_env_wait_ms": 0.09191777232879378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006532669067383, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.125030517578125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5836.629812462418, "num_env_steps_trained_throughput_per_sec": 5836.629812462418, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3120.183, "sample_time_ms": 2843.589, "load_time_ms": 17.308, "load_throughput": 1039988.87, "learn_time_ms": 238.797, "learn_throughput": 75377.795, "synch_weights_time_ms": 18.19}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4781, "training_iteration": 68, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-23", "timestamp": 1698251183, "time_this_iter_s": 3.089970827102661, "time_total_s": 230.7011797428131, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.7011797428131, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 59.720000000000006, "ram_util_percent": 32.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.9682936668396, "policy_loss": -0.0460971686989069, "vf_loss": 7.014449596405029, "vf_explained_var": -1.152356465657552e-06, "kl": 0.0017576076309827233, "entropy": 0.5869861443837484, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 822.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.630999999999829, "episode_len_mean": 269.36, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.50000000000004, 9.8999999999997, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 40.70000000000002, 5.099999999999632, -50.00000000000044, 46.5, -50.00000000000044, 14.499999999999766, 40.70000000000002, -50.00000000000044, 42.500000000000014, 43.900000000000006, 39.50000000000002, 43.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 21.499999999999865, 36.70000000000003, -50.00000000000044, 46.5, 40.10000000000002, 25.499999999999922, -50.00000000000044, 39.90000000000002, 45.9, 39.10000000000002, -50.00000000000044, 41.500000000000014, 30.099999999999987, 36.30000000000003, 25.099999999999916, 43.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.30000000000003, 39.90000000000002, 45.7, 42.900000000000006, 34.900000000000034, 34.30000000000004, 35.70000000000003, -50.00000000000044, 37.70000000000003, 36.10000000000004, 13.699999999999754, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.90000000000002, 44.300000000000004, 41.30000000000001, 44.900000000000006, 40.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.300000000000026, -50.00000000000044, 5.6999999999996405, 31.70000000000001, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 34.900000000000034, 44.5, 41.90000000000001, 42.30000000000001, 37.50000000000003, 15.49999999999978, 31.1, -50.00000000000044, 41.30000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.10000000000004, -50.00000000000044], "episode_lengths": [156, 402, 254, 500, 500, 104, 500, 500, 50, 94, 450, 500, 36, 500, 356, 94, 500, 76, 62, 106, 68, 500, 110, 500, 500, 500, 412, 286, 134, 500, 36, 100, 246, 500, 102, 42, 110, 500, 86, 200, 138, 250, 62, 500, 98, 500, 138, 102, 44, 72, 152, 158, 144, 500, 124, 140, 364, 500, 500, 72, 92, 58, 88, 52, 94, 168, 500, 500, 500, 500, 490, 78, 500, 500, 102, 108, 500, 444, 184, 78, 66, 500, 500, 484, 152, 56, 82, 78, 126, 346, 190, 500, 88, 292, 500, 500, 500, 60, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4151880689923738, "mean_inference_ms": 1.3325197380897478, "mean_action_processing_ms": 0.15503140645893093, "mean_env_wait_ms": 0.09183781118831565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002168655395508, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.1120305061340332}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.630999999999829, "episode_len_mean": 269.36, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.50000000000004, 9.8999999999997, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, 40.70000000000002, 5.099999999999632, -50.00000000000044, 46.5, -50.00000000000044, 14.499999999999766, 40.70000000000002, -50.00000000000044, 42.500000000000014, 43.900000000000006, 39.50000000000002, 43.30000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, 21.499999999999865, 36.70000000000003, -50.00000000000044, 46.5, 40.10000000000002, 25.499999999999922, -50.00000000000044, 39.90000000000002, 45.9, 39.10000000000002, -50.00000000000044, 41.500000000000014, 30.099999999999987, 36.30000000000003, 25.099999999999916, 43.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.30000000000003, 39.90000000000002, 45.7, 42.900000000000006, 34.900000000000034, 34.30000000000004, 35.70000000000003, -50.00000000000044, 37.70000000000003, 36.10000000000004, 13.699999999999754, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.90000000000002, 44.300000000000004, 41.30000000000001, 44.900000000000006, 40.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.300000000000026, -50.00000000000044, 5.6999999999996405, 31.70000000000001, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 34.900000000000034, 44.5, 41.90000000000001, 42.30000000000001, 37.50000000000003, 15.49999999999978, 31.1, -50.00000000000044, 41.30000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.10000000000004, -50.00000000000044], "episode_lengths": [156, 402, 254, 500, 500, 104, 500, 500, 50, 94, 450, 500, 36, 500, 356, 94, 500, 76, 62, 106, 68, 500, 110, 500, 500, 500, 412, 286, 134, 500, 36, 100, 246, 500, 102, 42, 110, 500, 86, 200, 138, 250, 62, 500, 98, 500, 138, 102, 44, 72, 152, 158, 144, 500, 124, 140, 364, 500, 500, 72, 92, 58, 88, 52, 94, 168, 500, 500, 500, 500, 490, 78, 500, 500, 102, 108, 500, 444, 184, 78, 66, 500, 500, 484, 152, 56, 82, 78, 126, 346, 190, 500, 88, 292, 500, 500, 500, 60, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4151880689923738, "mean_inference_ms": 1.3325197380897478, "mean_action_processing_ms": 0.15503140645893093, "mean_env_wait_ms": 0.09183781118831565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002168655395508, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.1120305061340332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5834.68117693556, "num_env_steps_trained_throughput_per_sec": 5834.68117693556, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3120.983, "sample_time_ms": 2850.089, "load_time_ms": 16.511, "load_throughput": 1090194.162, "learn_time_ms": 233.797, "learn_throughput": 76989.796, "synch_weights_time_ms": 18.287}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4851, "training_iteration": 69, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-27", "timestamp": 1698251187, "time_this_iter_s": 3.0899999141693115, "time_total_s": 233.79117965698242, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.79117965698242, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 70.89999999999999, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 7.098257422447205, "policy_loss": -0.02938872513671716, "vf_loss": 7.12770672639211, "vf_explained_var": -1.5000502268473308e-06, "kl": 0.00013998012618247438, "entropy": 0.6056754142045975, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 834.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9049999999998124, "episode_len_mean": 286.58, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 1.099999999999575, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.300000000000026, -50.00000000000044, 5.6999999999996405, 31.70000000000001, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 34.900000000000034, 44.5, 41.90000000000001, 42.30000000000001, 37.50000000000003, 15.49999999999978, 31.1, -50.00000000000044, 41.30000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 16.09999999999979, 41.70000000000002, -50.00000000000044, 19.899999999999842, 43.30000000000001, 41.90000000000001, 13.699999999999754, 32.700000000000024, 35.500000000000036, 36.900000000000034, -50.00000000000044, 32.90000000000003, 42.30000000000001, -50.00000000000044, 43.10000000000001, 41.90000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 14.899999999999771, 42.30000000000001, 37.70000000000003, -50.00000000000044, 47.1, 37.300000000000026, 40.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.099999999999987, 28.29999999999996, 42.70000000000001, 25.899999999999928, 21.699999999999868, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.900000000000034, 38.90000000000002, 34.70000000000004, 23.499999999999893, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 33.10000000000003, 36.50000000000003, -50.00000000000044, 40.90000000000002, 13.099999999999746, -50.00000000000044, 39.70000000000002, -50.00000000000044, 38.90000000000002, 27.49999999999995, -50.00000000000044], "episode_lengths": [500, 500, 490, 78, 500, 500, 102, 108, 500, 444, 184, 78, 66, 500, 500, 484, 152, 56, 82, 78, 126, 346, 190, 500, 88, 292, 500, 500, 500, 60, 150, 500, 500, 44, 500, 340, 84, 500, 302, 68, 82, 364, 174, 146, 132, 500, 172, 78, 500, 70, 82, 224, 500, 500, 352, 78, 124, 500, 30, 128, 94, 500, 82, 500, 64, 52, 500, 500, 200, 218, 74, 242, 284, 500, 60, 500, 132, 112, 154, 266, 500, 102, 500, 500, 500, 500, 500, 84, 500, 170, 136, 500, 92, 370, 500, 104, 500, 112, 226, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145626345519301, "mean_inference_ms": 1.3306761229768174, "mean_action_processing_ms": 0.1549187420481764, "mean_env_wait_ms": 0.09177417663686438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12003564834594727}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9049999999998124, "episode_len_mean": 286.58, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 1.099999999999575, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 39.300000000000026, -50.00000000000044, 5.6999999999996405, 31.70000000000001, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 1.6999999999995836, 34.900000000000034, 44.5, 41.90000000000001, 42.30000000000001, 37.50000000000003, 15.49999999999978, 31.1, -50.00000000000044, 41.30000000000001, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 16.09999999999979, 41.70000000000002, -50.00000000000044, 19.899999999999842, 43.30000000000001, 41.90000000000001, 13.699999999999754, 32.700000000000024, 35.500000000000036, 36.900000000000034, -50.00000000000044, 32.90000000000003, 42.30000000000001, -50.00000000000044, 43.10000000000001, 41.90000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 14.899999999999771, 42.30000000000001, 37.70000000000003, -50.00000000000044, 47.1, 37.300000000000026, 40.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 30.099999999999987, 28.29999999999996, 42.70000000000001, 25.899999999999928, 21.699999999999868, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.900000000000034, 38.90000000000002, 34.70000000000004, 23.499999999999893, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 33.10000000000003, 36.50000000000003, -50.00000000000044, 40.90000000000002, 13.099999999999746, -50.00000000000044, 39.70000000000002, -50.00000000000044, 38.90000000000002, 27.49999999999995, -50.00000000000044], "episode_lengths": [500, 500, 490, 78, 500, 500, 102, 108, 500, 444, 184, 78, 66, 500, 500, 484, 152, 56, 82, 78, 126, 346, 190, 500, 88, 292, 500, 500, 500, 60, 150, 500, 500, 44, 500, 340, 84, 500, 302, 68, 82, 364, 174, 146, 132, 500, 172, 78, 500, 70, 82, 224, 500, 500, 352, 78, 124, 500, 30, 128, 94, 500, 82, 500, 64, 52, 500, 500, 200, 218, 74, 242, 284, 500, 60, 500, 132, 112, 154, 266, 500, 102, 500, 500, 500, 500, 500, 84, 500, 170, 136, 500, 92, 370, 500, 104, 500, 112, 226, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145626345519301, "mean_inference_ms": 1.3306761229768174, "mean_action_processing_ms": 0.1549187420481764, "mean_env_wait_ms": 0.09177417663686438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12003564834594727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5878.508419084566, "num_env_steps_trained_throughput_per_sec": 5878.508419084566, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3124.383, "sample_time_ms": 2848.289, "load_time_ms": 17.214, "load_throughput": 1045681.496, "learn_time_ms": 238.297, "learn_throughput": 75536.01, "synch_weights_time_ms": 18.184}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4919, "training_iteration": 70, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-30", "timestamp": 1698251190, "time_this_iter_s": 3.066999912261963, "time_total_s": 236.85817956924438, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.85817956924438, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 65.375, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 7.098524689674377, "policy_loss": -0.013421384617686272, "vf_loss": 7.112007896105449, "vf_explained_var": -9.834766387939453e-07, "kl": 0.000658320578063846, "entropy": 0.6188171803951263, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 846.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.406999999999841, "episode_len_mean": 261.6, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.699999999999868, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.900000000000034, 38.90000000000002, 34.70000000000004, 23.499999999999893, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 33.10000000000003, 36.50000000000003, -50.00000000000044, 40.90000000000002, 13.099999999999746, -50.00000000000044, 39.70000000000002, -50.00000000000044, 38.90000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, 38.300000000000026, 18.699999999999825, 36.10000000000004, -50.00000000000044, 43.30000000000001, 45.7, 41.30000000000001, 42.70000000000001, -50.00000000000044, 42.500000000000014, 18.699999999999825, -50.00000000000044, -50.00000000000044, 40.30000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.7, 35.10000000000004, -50.00000000000044, 44.7, 45.5, -50.00000000000044, 36.900000000000034, 35.10000000000004, 44.300000000000004, 27.299999999999947, 38.700000000000024, -50.00000000000044, 40.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.9, -50.00000000000044, 14.09999999999976, 31.300000000000004, -50.00000000000044, 29.299999999999976, 20.299999999999848, 44.900000000000006, 43.7, 13.299999999999748, 35.30000000000004, 36.70000000000003, 43.30000000000001, 39.300000000000026, 37.10000000000003, 36.50000000000003, 43.7, 32.50000000000002, 45.7, 38.700000000000024, 43.900000000000006, 12.69999999999974, 22.49999999999988, -50.00000000000044, 34.70000000000004, 24.899999999999913, 43.30000000000001, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001], "episode_lengths": [284, 500, 60, 500, 132, 112, 154, 266, 500, 102, 500, 500, 500, 500, 500, 84, 500, 170, 136, 500, 92, 370, 500, 104, 500, 112, 226, 500, 500, 154, 500, 318, 500, 500, 118, 314, 140, 500, 68, 44, 88, 74, 500, 76, 314, 500, 500, 98, 140, 500, 500, 74, 64, 150, 500, 54, 46, 500, 132, 150, 58, 228, 114, 500, 94, 500, 74, 500, 32, 500, 360, 188, 500, 208, 298, 52, 64, 368, 148, 134, 68, 108, 130, 136, 64, 176, 44, 114, 62, 374, 276, 500, 154, 252, 68, 54, 500, 62, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142818485343558, "mean_inference_ms": 1.329072528519169, "mean_action_processing_ms": 0.1542362378151002, "mean_env_wait_ms": 0.09142177982478172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01800251007080078, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11102819442749023}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.406999999999841, "episode_len_mean": 261.6, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.699999999999868, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.900000000000034, 38.90000000000002, 34.70000000000004, 23.499999999999893, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 33.10000000000003, 36.50000000000003, -50.00000000000044, 40.90000000000002, 13.099999999999746, -50.00000000000044, 39.70000000000002, -50.00000000000044, 38.90000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, 38.300000000000026, 18.699999999999825, 36.10000000000004, -50.00000000000044, 43.30000000000001, 45.7, 41.30000000000001, 42.70000000000001, -50.00000000000044, 42.500000000000014, 18.699999999999825, -50.00000000000044, -50.00000000000044, 40.30000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.7, 35.10000000000004, -50.00000000000044, 44.7, 45.5, -50.00000000000044, 36.900000000000034, 35.10000000000004, 44.300000000000004, 27.299999999999947, 38.700000000000024, -50.00000000000044, 40.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.9, -50.00000000000044, 14.09999999999976, 31.300000000000004, -50.00000000000044, 29.299999999999976, 20.299999999999848, 44.900000000000006, 43.7, 13.299999999999748, 35.30000000000004, 36.70000000000003, 43.30000000000001, 39.300000000000026, 37.10000000000003, 36.50000000000003, 43.7, 32.50000000000002, 45.7, 38.700000000000024, 43.900000000000006, 12.69999999999974, 22.49999999999988, -50.00000000000044, 34.70000000000004, 24.899999999999913, 43.30000000000001, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001], "episode_lengths": [284, 500, 60, 500, 132, 112, 154, 266, 500, 102, 500, 500, 500, 500, 500, 84, 500, 170, 136, 500, 92, 370, 500, 104, 500, 112, 226, 500, 500, 154, 500, 318, 500, 500, 118, 314, 140, 500, 68, 44, 88, 74, 500, 76, 314, 500, 500, 98, 140, 500, 500, 74, 64, 150, 500, 54, 46, 500, 132, 150, 58, 228, 114, 500, 94, 500, 74, 500, 32, 500, 360, 188, 500, 208, 298, 52, 64, 368, 148, 134, 68, 108, 130, 136, 64, 176, 44, 114, 62, 374, 276, 500, 154, 252, 68, 54, 500, 62, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142818485343558, "mean_inference_ms": 1.329072528519169, "mean_action_processing_ms": 0.1542362378151002, "mean_env_wait_ms": 0.09142177982478172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01800251007080078, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.11102819442749023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5879.20973299551, "num_env_steps_trained_throughput_per_sec": 5879.20973299551, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3111.55, "sample_time_ms": 2843.856, "load_time_ms": 16.411, "load_throughput": 1096846.381, "learn_time_ms": 238.797, "learn_throughput": 75377.825, "synch_weights_time_ms": 10.087}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4991, "training_iteration": 71, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-33", "timestamp": 1698251193, "time_this_iter_s": 3.0676355361938477, "time_total_s": 239.92581510543823, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.92581510543823, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 61.08, "ram_util_percent": 32.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.861338376998901, "policy_loss": 0.008717566728591919, "vf_loss": 6.8526771068573, "vf_explained_var": -3.3279259999593097e-07, "kl": 0.0004330558607345362, "entropy": 0.5610489845275879, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 858.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.699999999999866, "episode_len_mean": 233.72, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.299999999999976, 20.299999999999848, 44.900000000000006, 43.7, 13.299999999999748, 35.30000000000004, 36.70000000000003, 43.30000000000001, 39.300000000000026, 37.10000000000003, 36.50000000000003, 43.7, 32.50000000000002, 45.7, 38.700000000000024, 43.900000000000006, 12.69999999999974, 22.49999999999988, -50.00000000000044, 34.70000000000004, 24.899999999999913, 43.30000000000001, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 39.50000000000002, 38.50000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.70000000000002, 42.30000000000001, 34.900000000000034, 43.50000000000001, 36.70000000000003, 36.70000000000003, 38.50000000000003, -50.00000000000044, 39.50000000000002, 41.500000000000014, 38.300000000000026, 13.299999999999748, 42.70000000000001, 43.50000000000001, -50.00000000000044, 40.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 39.70000000000002, 39.300000000000026, 42.10000000000001, 43.7, 40.500000000000014, -50.00000000000044, 46.099999999999994, 41.30000000000001, 38.300000000000026, 45.3, 43.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.300000000000004, 45.5, 9.8999999999997, 32.90000000000003, 41.500000000000014, 39.50000000000002, 33.90000000000004, -50.00000000000044, 44.5, -50.00000000000044, 25.499999999999922, 43.7, 44.900000000000006, 44.5, -50.00000000000044, 31.500000000000007], "episode_lengths": [208, 298, 52, 64, 368, 148, 134, 68, 108, 130, 136, 64, 176, 44, 114, 62, 374, 276, 500, 154, 252, 68, 54, 500, 62, 500, 78, 500, 500, 42, 40, 500, 500, 500, 500, 500, 500, 218, 106, 116, 500, 250, 500, 68, 500, 84, 78, 152, 66, 134, 134, 116, 500, 106, 86, 118, 368, 74, 66, 500, 92, 76, 500, 500, 292, 500, 500, 104, 108, 80, 64, 96, 500, 40, 88, 118, 48, 64, 128, 500, 500, 500, 368, 500, 58, 46, 402, 172, 86, 106, 162, 500, 56, 500, 246, 64, 52, 56, 500, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4134785094540303, "mean_inference_ms": 1.3267489086002973, "mean_action_processing_ms": 0.15410791845285532, "mean_env_wait_ms": 0.09097262145777622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997089385986328, "StateBufferConnector_ms": 0.003983736038208008, "ViewRequirementAgentConnector_ms": 0.11197185516357422}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.699999999999866, "episode_len_mean": 233.72, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.299999999999976, 20.299999999999848, 44.900000000000006, 43.7, 13.299999999999748, 35.30000000000004, 36.70000000000003, 43.30000000000001, 39.300000000000026, 37.10000000000003, 36.50000000000003, 43.7, 32.50000000000002, 45.7, 38.700000000000024, 43.900000000000006, 12.69999999999974, 22.49999999999988, -50.00000000000044, 34.70000000000004, 24.899999999999913, 43.30000000000001, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.29999999999996, 39.50000000000002, 38.50000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.30000000000001, -50.00000000000044, 41.70000000000002, 42.30000000000001, 34.900000000000034, 43.50000000000001, 36.70000000000003, 36.70000000000003, 38.50000000000003, -50.00000000000044, 39.50000000000002, 41.500000000000014, 38.300000000000026, 13.299999999999748, 42.70000000000001, 43.50000000000001, -50.00000000000044, 40.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 39.70000000000002, 39.300000000000026, 42.10000000000001, 43.7, 40.500000000000014, -50.00000000000044, 46.099999999999994, 41.30000000000001, 38.300000000000026, 45.3, 43.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.300000000000004, 45.5, 9.8999999999997, 32.90000000000003, 41.500000000000014, 39.50000000000002, 33.90000000000004, -50.00000000000044, 44.5, -50.00000000000044, 25.499999999999922, 43.7, 44.900000000000006, 44.5, -50.00000000000044, 31.500000000000007], "episode_lengths": [208, 298, 52, 64, 368, 148, 134, 68, 108, 130, 136, 64, 176, 44, 114, 62, 374, 276, 500, 154, 252, 68, 54, 500, 62, 500, 78, 500, 500, 42, 40, 500, 500, 500, 500, 500, 500, 218, 106, 116, 500, 250, 500, 68, 500, 84, 78, 152, 66, 134, 134, 116, 500, 106, 86, 118, 368, 74, 66, 500, 92, 76, 500, 500, 292, 500, 500, 104, 108, 80, 64, 96, 500, 40, 88, 118, 48, 64, 128, 500, 500, 500, 368, 500, 58, 46, 402, 172, 86, 106, 162, 500, 56, 500, 246, 64, 52, 56, 500, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4134785094540303, "mean_inference_ms": 1.3267489086002973, "mean_action_processing_ms": 0.15410791845285532, "mean_env_wait_ms": 0.09097262145777622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997089385986328, "StateBufferConnector_ms": 0.003983736038208008, "ViewRequirementAgentConnector_ms": 0.11197185516357422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5639.095793370038, "num_env_steps_trained_throughput_per_sec": 5639.095793370038, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3130.452, "sample_time_ms": 2851.559, "load_time_ms": 17.311, "load_throughput": 1039811.258, "learn_time_ms": 249.0, "learn_throughput": 72289.191, "synch_weights_time_ms": 10.084}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 5064, "training_iteration": 72, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-36", "timestamp": 1698251196, "time_this_iter_s": 3.1979994773864746, "time_total_s": 243.1238145828247, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.1238145828247, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.509023825327556, "policy_loss": -0.013735184445977211, "vf_loss": 6.522812167803447, "vf_explained_var": -9.685754776000977e-07, "kl": 0.00012104256529236561, "entropy": 0.5316598067680994, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.699999999999833, "episode_len_mean": 253.64, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 39.300000000000026, 42.10000000000001, 43.7, 40.500000000000014, -50.00000000000044, 46.099999999999994, 41.30000000000001, 38.300000000000026, 45.3, 43.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.300000000000004, 45.5, 9.8999999999997, 32.90000000000003, 41.500000000000014, 39.50000000000002, 33.90000000000004, -50.00000000000044, 44.5, -50.00000000000044, 25.499999999999922, 43.7, 44.900000000000006, 44.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 40.30000000000002, 40.90000000000002, -50.00000000000044, 18.499999999999822, 41.100000000000016, 46.3, 45.9, 42.10000000000001, 45.7, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 28.499999999999964, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 42.900000000000006, 33.90000000000004, 44.300000000000004, 44.300000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.900000000000013, 11.899999999999729, -50.00000000000044, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.90000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 104, 108, 80, 64, 96, 500, 40, 88, 118, 48, 64, 128, 500, 500, 500, 368, 500, 58, 46, 402, 172, 86, 106, 162, 500, 56, 500, 246, 64, 52, 56, 500, 186, 500, 98, 92, 500, 316, 90, 38, 42, 80, 44, 146, 500, 500, 500, 34, 62, 500, 500, 34, 216, 500, 270, 500, 500, 88, 52, 72, 162, 58, 58, 226, 500, 500, 40, 500, 202, 500, 182, 382, 500, 40, 70, 150, 500, 500, 32, 500, 500, 66, 106, 500, 50, 500, 58, 500, 90, 222, 500, 48, 500, 500, 162, 102, 500, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41263622064860733, "mean_inference_ms": 1.3250024281014925, "mean_action_processing_ms": 0.1544422664486327, "mean_env_wait_ms": 0.09106035529701563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299283981323242, "StateBufferConnector_ms": 0.004983663558959961, "ViewRequirementAgentConnector_ms": 0.12699151039123535}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.699999999999833, "episode_len_mean": 253.64, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 39.300000000000026, 42.10000000000001, 43.7, 40.500000000000014, -50.00000000000044, 46.099999999999994, 41.30000000000001, 38.300000000000026, 45.3, 43.7, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.300000000000004, 45.5, 9.8999999999997, 32.90000000000003, 41.500000000000014, 39.50000000000002, 33.90000000000004, -50.00000000000044, 44.5, -50.00000000000044, 25.499999999999922, 43.7, 44.900000000000006, 44.5, -50.00000000000044, 31.500000000000007, -50.00000000000044, 40.30000000000002, 40.90000000000002, -50.00000000000044, 18.499999999999822, 41.100000000000016, 46.3, 45.9, 42.10000000000001, 45.7, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 28.499999999999964, -50.00000000000044, 23.099999999999888, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 42.900000000000006, 33.90000000000004, 44.300000000000004, 44.300000000000004, 27.49999999999995, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.900000000000013, 11.899999999999729, -50.00000000000044, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.90000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 104, 108, 80, 64, 96, 500, 40, 88, 118, 48, 64, 128, 500, 500, 500, 368, 500, 58, 46, 402, 172, 86, 106, 162, 500, 56, 500, 246, 64, 52, 56, 500, 186, 500, 98, 92, 500, 316, 90, 38, 42, 80, 44, 146, 500, 500, 500, 34, 62, 500, 500, 34, 216, 500, 270, 500, 500, 88, 52, 72, 162, 58, 58, 226, 500, 500, 40, 500, 202, 500, 182, 382, 500, 40, 70, 150, 500, 500, 32, 500, 500, 66, 106, 500, 50, 500, 58, 500, 90, 222, 500, 48, 500, 500, 162, 102, 500, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41263622064860733, "mean_inference_ms": 1.3250024281014925, "mean_action_processing_ms": 0.1544422664486327, "mean_env_wait_ms": 0.09106035529701563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299283981323242, "StateBufferConnector_ms": 0.004983663558959961, "ViewRequirementAgentConnector_ms": 0.12699151039123535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5671.131561587471, "num_env_steps_trained_throughput_per_sec": 5671.131561587471, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3129.149, "sample_time_ms": 2850.752, "load_time_ms": 17.311, "load_throughput": 1039808.393, "learn_time_ms": 249.003, "learn_throughput": 72288.305, "synch_weights_time_ms": 9.684}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5130, "training_iteration": 73, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-39", "timestamp": 1698251199, "time_this_iter_s": 3.178969144821167, "time_total_s": 246.30278372764587, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.30278372764587, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 59.540000000000006, "ram_util_percent": 33.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.9341938098271685, "policy_loss": -0.01688689924776554, "vf_loss": 6.951133569081624, "vf_explained_var": -4.818042119344076e-07, "kl": 5.735052515021266e-05, "entropy": 0.5298221011956533, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 882.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8179999999998144, "episode_len_mean": 272.44, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.900000000000013, 11.899999999999729, -50.00000000000044, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.90000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 35.500000000000036, 38.700000000000024, 43.900000000000006, 42.30000000000001, -50.00000000000044, 41.30000000000001, 33.70000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 21.299999999999862, 42.70000000000001, 45.5, -50.00000000000044, 46.699999999999996, 42.30000000000001, 42.10000000000001, 27.299999999999947, 40.90000000000002, -50.00000000000044, 30.29999999999999, 44.7, -50.00000000000044, 5.099999999999632, -50.00000000000044, 37.10000000000003, 36.70000000000003, 46.5, -50.00000000000044, 2.0999999999995893, 17.499999999999808, 37.50000000000003, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 37.70000000000003, 17.299999999999805, 44.300000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 32.700000000000024, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 3.699999999999612, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, 4.899999999999629], "episode_lengths": [40, 500, 202, 500, 182, 382, 500, 40, 70, 150, 500, 500, 32, 500, 500, 66, 106, 500, 50, 500, 58, 500, 90, 222, 500, 48, 500, 500, 162, 102, 500, 86, 500, 58, 146, 114, 62, 78, 500, 88, 164, 500, 76, 500, 288, 74, 46, 500, 34, 78, 80, 228, 92, 500, 198, 54, 500, 450, 500, 130, 134, 36, 500, 480, 326, 126, 500, 500, 162, 500, 500, 58, 500, 46, 124, 328, 58, 42, 500, 500, 500, 48, 54, 174, 500, 500, 144, 500, 464, 52, 500, 70, 50, 500, 500, 40, 50, 100, 500, 452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4130342925279529, "mean_inference_ms": 1.3247439917694372, "mean_action_processing_ms": 0.15424198270895242, "mean_env_wait_ms": 0.09126827856159243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499650955200195, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.14599394798278809}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8179999999998144, "episode_len_mean": 272.44, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 29.899999999999984, -50.00000000000044, 31.900000000000013, 11.899999999999729, -50.00000000000044, 46.099999999999994, 43.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.100000000000016, 27.899999999999956, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.90000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, 35.500000000000036, 38.700000000000024, 43.900000000000006, 42.30000000000001, -50.00000000000044, 41.30000000000001, 33.70000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 21.299999999999862, 42.70000000000001, 45.5, -50.00000000000044, 46.699999999999996, 42.30000000000001, 42.10000000000001, 27.299999999999947, 40.90000000000002, -50.00000000000044, 30.29999999999999, 44.7, -50.00000000000044, 5.099999999999632, -50.00000000000044, 37.10000000000003, 36.70000000000003, 46.5, -50.00000000000044, 2.0999999999995893, 17.499999999999808, 37.50000000000003, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, 37.70000000000003, 17.299999999999805, 44.300000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 32.700000000000024, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 3.699999999999612, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, 4.899999999999629], "episode_lengths": [40, 500, 202, 500, 182, 382, 500, 40, 70, 150, 500, 500, 32, 500, 500, 66, 106, 500, 50, 500, 58, 500, 90, 222, 500, 48, 500, 500, 162, 102, 500, 86, 500, 58, 146, 114, 62, 78, 500, 88, 164, 500, 76, 500, 288, 74, 46, 500, 34, 78, 80, 228, 92, 500, 198, 54, 500, 450, 500, 130, 134, 36, 500, 480, 326, 126, 500, 500, 162, 500, 500, 58, 500, 46, 124, 328, 58, 42, 500, 500, 500, 48, 54, 174, 500, 500, 144, 500, 464, 52, 500, 70, 50, 500, 500, 40, 50, 100, 500, 452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4130342925279529, "mean_inference_ms": 1.3247439917694372, "mean_action_processing_ms": 0.15424198270895242, "mean_env_wait_ms": 0.09126827856159243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499650955200195, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.14599394798278809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5341.980792141096, "num_env_steps_trained_throughput_per_sec": 5341.980792141096, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3148.406, "sample_time_ms": 2869.709, "load_time_ms": 17.408, "load_throughput": 1034013.641, "learn_time_ms": 249.403, "learn_throughput": 72172.306, "synch_weights_time_ms": 9.487}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5197, "training_iteration": 74, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-43", "timestamp": 1698251203, "time_this_iter_s": 3.3745338916778564, "time_total_s": 249.67731761932373, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.67731761932373, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 75.475, "ram_util_percent": 33.175000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.765612284342448, "policy_loss": -0.014469316074003776, "vf_loss": 6.780134876569112, "vf_explained_var": -1.2914339701334636e-06, "kl": 0.000277189182143663, "entropy": 0.533507764339447, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 894.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.806999999999817, "episode_len_mean": 257.56, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 32.700000000000024, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 3.699999999999612, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.900000000000006, 44.10000000000001, 44.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 32.700000000000024, 43.900000000000006, 30.699999999999996, 14.09999999999976, 43.7, 46.099999999999994, 46.3, -50.00000000000044, 43.10000000000001, 46.3, -50.00000000000044, 43.10000000000001, 39.70000000000002, 43.30000000000001, 44.5, 44.7, 8.49999999999968, 42.10000000000001, 46.099999999999994, -50.00000000000044, 38.50000000000003, 39.70000000000002, -50.00000000000044, 14.899999999999771, 33.10000000000003, 42.500000000000014, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 8.49999999999968, 40.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, 28.499999999999964, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, 46.5, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 46.3, 47.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, 45.1], "episode_lengths": [42, 500, 500, 500, 48, 54, 174, 500, 500, 144, 500, 464, 52, 500, 70, 50, 500, 500, 40, 50, 100, 500, 452, 500, 72, 60, 60, 500, 34, 500, 440, 500, 500, 174, 62, 194, 360, 64, 40, 38, 500, 70, 38, 500, 70, 104, 68, 56, 54, 416, 80, 40, 500, 116, 104, 500, 352, 170, 76, 88, 72, 500, 500, 40, 416, 94, 500, 84, 500, 500, 100, 500, 56, 216, 500, 500, 26, 72, 36, 500, 46, 46, 500, 38, 24, 92, 500, 500, 500, 46, 178, 500, 500, 142, 500, 500, 36, 106, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41260517703587607, "mean_inference_ms": 1.3240240237384824, "mean_action_processing_ms": 0.1539940691366598, "mean_env_wait_ms": 0.09089637165559665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003889083862305, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.12500286102294922}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.806999999999817, "episode_len_mean": 257.56, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 32.700000000000024, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 3.699999999999612, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 40.10000000000002, -50.00000000000044, 4.899999999999629, -50.00000000000044, 42.900000000000006, 44.10000000000001, 44.10000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 32.700000000000024, 43.900000000000006, 30.699999999999996, 14.09999999999976, 43.7, 46.099999999999994, 46.3, -50.00000000000044, 43.10000000000001, 46.3, -50.00000000000044, 43.10000000000001, 39.70000000000002, 43.30000000000001, 44.5, 44.7, 8.49999999999968, 42.10000000000001, 46.099999999999994, -50.00000000000044, 38.50000000000003, 39.70000000000002, -50.00000000000044, 14.899999999999771, 33.10000000000003, 42.500000000000014, 41.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 8.49999999999968, 40.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, 28.499999999999964, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, 46.5, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 46.3, 47.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, 45.1], "episode_lengths": [42, 500, 500, 500, 48, 54, 174, 500, 500, 144, 500, 464, 52, 500, 70, 50, 500, 500, 40, 50, 100, 500, 452, 500, 72, 60, 60, 500, 34, 500, 440, 500, 500, 174, 62, 194, 360, 64, 40, 38, 500, 70, 38, 500, 70, 104, 68, 56, 54, 416, 80, 40, 500, 116, 104, 500, 352, 170, 76, 88, 72, 500, 500, 40, 416, 94, 500, 84, 500, 500, 100, 500, 56, 216, 500, 500, 26, 72, 36, 500, 46, 46, 500, 38, 24, 92, 500, 500, 500, 46, 178, 500, 500, 142, 500, 500, 36, 106, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41260517703587607, "mean_inference_ms": 1.3240240237384824, "mean_action_processing_ms": 0.1539940691366598, "mean_env_wait_ms": 0.09089637165559665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003889083862305, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.12500286102294922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5823.4132345237995, "num_env_steps_trained_throughput_per_sec": 5823.4132345237995, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3142.306, "sample_time_ms": 2883.109, "load_time_ms": 17.508, "load_throughput": 1028089.881, "learn_time_ms": 229.703, "learn_throughput": 78362.076, "synch_weights_time_ms": 9.487}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5274, "training_iteration": 75, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-46", "timestamp": 1698251206, "time_this_iter_s": 3.095970630645752, "time_total_s": 252.77328824996948, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.77328824996948, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 33.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.580630977948506, "policy_loss": 0.05429502824942271, "vf_loss": 6.52638574441274, "vf_explained_var": -1.341104507446289e-06, "kl": 0.00044518575699233526, "entropy": 0.4974394738674164, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 906.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.274999999999827, "episode_len_mean": 252.88, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, 28.499999999999964, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, 46.5, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 46.3, 47.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, 45.1, 33.500000000000036, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, 27.299999999999947, 25.099999999999916, 40.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, 40.500000000000014, 44.7, 41.30000000000001, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 45.1, 44.7, 33.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, 29.69999999999998, 20.899999999999856, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.1, 45.9, 45.1, 42.70000000000001, 44.7, 10.299999999999706, 3.499999999999609, 45.5, 45.1, 33.90000000000004, -50.00000000000044, 42.900000000000006, 33.500000000000036, 31.1, 36.900000000000034], "episode_lengths": [500, 500, 100, 500, 56, 216, 500, 500, 26, 72, 36, 500, 46, 46, 500, 38, 24, 92, 500, 500, 500, 46, 178, 500, 500, 142, 500, 500, 36, 106, 500, 50, 166, 42, 500, 500, 36, 84, 228, 250, 96, 66, 500, 56, 96, 54, 88, 410, 500, 500, 500, 70, 500, 164, 500, 50, 500, 58, 500, 500, 52, 36, 500, 50, 54, 166, 500, 500, 84, 500, 48, 30, 500, 500, 216, 50, 204, 292, 500, 78, 500, 500, 500, 36, 116, 50, 42, 50, 74, 54, 398, 466, 46, 50, 162, 500, 72, 166, 190, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41179899496302297, "mean_inference_ms": 1.3220642627509407, "mean_action_processing_ms": 0.15399448865975762, "mean_env_wait_ms": 0.09100816531936844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024016141891479492, "StateBufferConnector_ms": 0.009000539779663086, "ViewRequirementAgentConnector_ms": 0.09598970413208008}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.274999999999827, "episode_len_mean": 252.88, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, 28.499999999999964, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, 46.5, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 46.3, 47.7, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.30000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.5, 39.50000000000002, -50.00000000000044, 45.1, 33.500000000000036, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, 27.299999999999947, 25.099999999999916, 40.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, 40.500000000000014, 44.7, 41.30000000000001, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, 45.1, 44.7, 33.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, 29.69999999999998, 20.899999999999856, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.1, 45.9, 45.1, 42.70000000000001, 44.7, 10.299999999999706, 3.499999999999609, 45.5, 45.1, 33.90000000000004, -50.00000000000044, 42.900000000000006, 33.500000000000036, 31.1, 36.900000000000034], "episode_lengths": [500, 500, 100, 500, 56, 216, 500, 500, 26, 72, 36, 500, 46, 46, 500, 38, 24, 92, 500, 500, 500, 46, 178, 500, 500, 142, 500, 500, 36, 106, 500, 50, 166, 42, 500, 500, 36, 84, 228, 250, 96, 66, 500, 56, 96, 54, 88, 410, 500, 500, 500, 70, 500, 164, 500, 50, 500, 58, 500, 500, 52, 36, 500, 50, 54, 166, 500, 500, 84, 500, 48, 30, 500, 500, 216, 50, 204, 292, 500, 78, 500, 500, 500, 36, 116, 50, 42, 50, 74, 54, 398, 466, 46, 50, 162, 500, 72, 166, 190, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41179899496302297, "mean_inference_ms": 1.3220642627509407, "mean_action_processing_ms": 0.15399448865975762, "mean_env_wait_ms": 0.09100816531936844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024016141891479492, "StateBufferConnector_ms": 0.009000539779663086, "ViewRequirementAgentConnector_ms": 0.09598970413208008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 6008.0115338585065, "num_env_steps_trained_throughput_per_sec": 6008.0115338585065, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3125.606, "sample_time_ms": 2887.705, "load_time_ms": 16.509, "load_throughput": 1090334.289, "learn_time_ms": 209.603, "learn_throughput": 85876.741, "synch_weights_time_ms": 9.29}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5342, "training_iteration": 76, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-49", "timestamp": 1698251209, "time_this_iter_s": 3.0019986629486084, "time_total_s": 255.7752869129181, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.7752869129181, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 70.85, "ram_util_percent": 33.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.553524136543274, "policy_loss": -0.015076157947381338, "vf_loss": 6.568647146224976, "vf_explained_var": -8.046627044677734e-07, "kl": 1.7153492147296372e-05, "entropy": 0.468275065223376, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 918.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0299999999998155, "episode_len_mean": 270.32, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, 29.69999999999998, 20.899999999999856, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.1, 45.9, 45.1, 42.70000000000001, 44.7, 10.299999999999706, 3.499999999999609, 45.5, 45.1, 33.90000000000004, -50.00000000000044, 42.900000000000006, 33.500000000000036, 31.1, 36.900000000000034, 36.10000000000004, 43.30000000000001, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, 45.7, 25.099999999999916, 44.10000000000001, 46.5, 39.90000000000002, 30.9, 24.899999999999913, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 43.900000000000006, 38.700000000000024, 19.299999999999834, 25.499999999999922, -50.00000000000044, 37.300000000000026, 31.900000000000013, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044], "episode_lengths": [166, 500, 500, 84, 500, 48, 30, 500, 500, 216, 50, 204, 292, 500, 78, 500, 500, 500, 36, 116, 50, 42, 50, 74, 54, 398, 466, 46, 50, 162, 500, 72, 166, 190, 132, 140, 68, 198, 500, 500, 500, 348, 62, 198, 500, 500, 44, 250, 60, 36, 102, 192, 252, 500, 66, 500, 66, 86, 500, 500, 500, 500, 56, 40, 58, 500, 500, 86, 500, 500, 96, 500, 56, 500, 72, 62, 114, 308, 246, 500, 128, 182, 500, 62, 500, 36, 54, 500, 500, 486, 38, 60, 500, 500, 500, 116, 500, 236, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41161898109967543, "mean_inference_ms": 1.3209537777446523, "mean_action_processing_ms": 0.15365905700578453, "mean_env_wait_ms": 0.09085678668326186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024017333984375, "StateBufferConnector_ms": 0.010005950927734375, "ViewRequirementAgentConnector_ms": 0.11001324653625488}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.0299999999998155, "episode_len_mean": 270.32, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.500000000000036, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 28.499999999999964, 45.1, 29.69999999999998, 20.899999999999856, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.1, 45.9, 45.1, 42.70000000000001, 44.7, 10.299999999999706, 3.499999999999609, 45.5, 45.1, 33.90000000000004, -50.00000000000044, 42.900000000000006, 33.500000000000036, 31.1, 36.900000000000034, 36.10000000000004, 43.30000000000001, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, 45.7, 25.099999999999916, 44.10000000000001, 46.5, 39.90000000000002, 30.9, 24.899999999999913, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.50000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 43.900000000000006, 38.700000000000024, 19.299999999999834, 25.499999999999922, -50.00000000000044, 37.300000000000026, 31.900000000000013, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044], "episode_lengths": [166, 500, 500, 84, 500, 48, 30, 500, 500, 216, 50, 204, 292, 500, 78, 500, 500, 500, 36, 116, 50, 42, 50, 74, 54, 398, 466, 46, 50, 162, 500, 72, 166, 190, 132, 140, 68, 198, 500, 500, 500, 348, 62, 198, 500, 500, 44, 250, 60, 36, 102, 192, 252, 500, 66, 500, 66, 86, 500, 500, 500, 500, 56, 40, 58, 500, 500, 86, 500, 500, 96, 500, 56, 500, 72, 62, 114, 308, 246, 500, 128, 182, 500, 62, 500, 36, 54, 500, 500, 486, 38, 60, 500, 500, 500, 116, 500, 236, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41161898109967543, "mean_inference_ms": 1.3209537777446523, "mean_action_processing_ms": 0.15365905700578453, "mean_env_wait_ms": 0.09085678668326186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024017333984375, "StateBufferConnector_ms": 0.010005950927734375, "ViewRequirementAgentConnector_ms": 0.11001324653625488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5817.71061337753, "num_env_steps_trained_throughput_per_sec": 5817.71061337753, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3120.909, "sample_time_ms": 2886.711, "load_time_ms": 16.606, "load_throughput": 1083970.653, "learn_time_ms": 205.6, "learn_throughput": 87548.74, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5407, "training_iteration": 77, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-52", "timestamp": 1698251212, "time_this_iter_s": 3.0999999046325684, "time_total_s": 258.87528681755066, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.87528681755066, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 67.75, "ram_util_percent": 33.574999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.673551519711812, "policy_loss": -0.03893755842000246, "vf_loss": 6.712538043657939, "vf_explained_var": -1.1920928955078125e-06, "kl": 9.886831696759302e-05, "entropy": 0.48967024435599643, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2430000000002088, "episode_len_mean": 287.98, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 43.900000000000006, 38.700000000000024, 19.299999999999834, 25.499999999999922, -50.00000000000044, 37.300000000000026, 31.900000000000013, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 21.299999999999862, -50.00000000000044, 45.9, 43.30000000000001, 46.5, 47.3, -50.00000000000044, 38.90000000000002, 31.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, 24.099999999999902, 36.30000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 24.299999999999905, 46.3, 45.3, 45.9, 35.30000000000004, 31.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.5, 45.3, -50.00000000000044], "episode_lengths": [58, 500, 500, 86, 500, 500, 96, 500, 56, 500, 72, 62, 114, 308, 246, 500, 128, 182, 500, 62, 500, 36, 54, 500, 500, 486, 38, 60, 500, 500, 500, 116, 500, 236, 500, 500, 500, 438, 44, 64, 500, 500, 500, 500, 106, 56, 500, 500, 84, 288, 500, 42, 68, 36, 28, 500, 112, 190, 136, 500, 500, 260, 138, 44, 500, 500, 500, 500, 500, 78, 258, 38, 48, 42, 148, 188, 64, 500, 500, 58, 500, 50, 80, 500, 24, 500, 500, 148, 78, 500, 500, 34, 38, 500, 500, 210, 500, 36, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109618298918311, "mean_inference_ms": 1.3205325771977943, "mean_action_processing_ms": 0.15351738590305827, "mean_env_wait_ms": 0.0904957979836414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700352668762207, "StateBufferConnector_ms": 0.0070037841796875, "ViewRequirementAgentConnector_ms": 0.12199258804321289}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2430000000002088, "episode_len_mean": 287.98, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 43.900000000000006, 38.700000000000024, 19.299999999999834, 25.499999999999922, -50.00000000000044, 37.300000000000026, 31.900000000000013, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 21.299999999999862, -50.00000000000044, 45.9, 43.30000000000001, 46.5, 47.3, -50.00000000000044, 38.90000000000002, 31.1, 36.50000000000003, -50.00000000000044, -50.00000000000044, 24.099999999999902, 36.30000000000003, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 24.299999999999905, 46.3, 45.3, 45.9, 35.30000000000004, 31.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.5, 45.3, -50.00000000000044], "episode_lengths": [58, 500, 500, 86, 500, 500, 96, 500, 56, 500, 72, 62, 114, 308, 246, 500, 128, 182, 500, 62, 500, 36, 54, 500, 500, 486, 38, 60, 500, 500, 500, 116, 500, 236, 500, 500, 500, 438, 44, 64, 500, 500, 500, 500, 106, 56, 500, 500, 84, 288, 500, 42, 68, 36, 28, 500, 112, 190, 136, 500, 500, 260, 138, 44, 500, 500, 500, 500, 500, 78, 258, 38, 48, 42, 148, 188, 64, 500, 500, 58, 500, 50, 80, 500, 24, 500, 500, 148, 78, 500, 500, 34, 38, 500, 500, 210, 500, 36, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109618298918311, "mean_inference_ms": 1.3205325771977943, "mean_action_processing_ms": 0.15351738590305827, "mean_env_wait_ms": 0.0904957979836414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700352668762207, "StateBufferConnector_ms": 0.0070037841796875, "ViewRequirementAgentConnector_ms": 0.12199258804321289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5745.29005516348, "num_env_steps_trained_throughput_per_sec": 5745.29005516348, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3125.812, "sample_time_ms": 2887.614, "load_time_ms": 16.708, "load_throughput": 1077299.498, "learn_time_ms": 209.5, "learn_throughput": 85918.912, "synch_weights_time_ms": 9.39}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5471, "training_iteration": 78, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-55", "timestamp": 1698251215, "time_this_iter_s": 3.1389997005462646, "time_total_s": 262.0142865180969, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.0142865180969, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 61.919999999999995, "ram_util_percent": 33.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.202446977297465, "policy_loss": -0.0319232443968455, "vf_loss": 6.2344173192977905, "vf_explained_var": -1.4603137969970703e-06, "kl": 0.00016147932806376275, "entropy": 0.47061529010534286, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 942.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.376999999999811, "episode_len_mean": 261.82, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 24.299999999999905, 46.3, 45.3, 45.9, 35.30000000000004, 31.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 22.49999999999988, -50.00000000000044, 46.099999999999994, 47.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 26.299999999999933, -50.00000000000044, 40.10000000000002, 44.10000000000001, -50.00000000000044, 38.10000000000002, 22.299999999999876, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 37.50000000000003, -50.00000000000044, 47.1, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 44.7, -50.00000000000044, 47.1, 45.9, 46.3, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, -50.00000000000044, 47.5, 43.7, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 23.8999999999999, 27.49999999999995, 40.10000000000002, -50.00000000000044, 2.299999999999592, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 78, 258, 38, 48, 42, 148, 188, 64, 500, 500, 58, 500, 50, 80, 500, 24, 500, 500, 148, 78, 500, 500, 34, 38, 500, 500, 210, 500, 36, 48, 500, 276, 500, 40, 30, 90, 500, 500, 500, 500, 42, 46, 238, 500, 100, 60, 500, 120, 278, 68, 500, 500, 500, 500, 152, 126, 500, 30, 34, 62, 500, 500, 78, 46, 56, 500, 500, 44, 82, 54, 500, 30, 42, 38, 46, 500, 66, 500, 500, 36, 84, 500, 26, 64, 500, 54, 62, 500, 500, 202, 500, 262, 226, 100, 500, 478, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41090043329625403, "mean_inference_ms": 1.3191792944581682, "mean_action_processing_ms": 0.15374407736722834, "mean_env_wait_ms": 0.09063131890061098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400468826293945, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.12298417091369629}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.376999999999811, "episode_len_mean": 261.82, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 24.299999999999905, 46.3, 45.3, 45.9, 35.30000000000004, 31.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 22.49999999999988, -50.00000000000044, 46.099999999999994, 47.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 26.299999999999933, -50.00000000000044, 40.10000000000002, 44.10000000000001, -50.00000000000044, 38.10000000000002, 22.299999999999876, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 37.50000000000003, -50.00000000000044, 47.1, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 44.7, -50.00000000000044, 47.1, 45.9, 46.3, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, -50.00000000000044, 47.5, 43.7, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 23.8999999999999, 27.49999999999995, 40.10000000000002, -50.00000000000044, 2.299999999999592, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 78, 258, 38, 48, 42, 148, 188, 64, 500, 500, 58, 500, 50, 80, 500, 24, 500, 500, 148, 78, 500, 500, 34, 38, 500, 500, 210, 500, 36, 48, 500, 276, 500, 40, 30, 90, 500, 500, 500, 500, 42, 46, 238, 500, 100, 60, 500, 120, 278, 68, 500, 500, 500, 500, 152, 126, 500, 30, 34, 62, 500, 500, 78, 46, 56, 500, 500, 44, 82, 54, 500, 30, 42, 38, 46, 500, 66, 500, 500, 36, 84, 500, 26, 64, 500, 54, 62, 500, 500, 202, 500, 262, 226, 100, 500, 478, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41090043329625403, "mean_inference_ms": 1.3191792944581682, "mean_action_processing_ms": 0.15374407736722834, "mean_env_wait_ms": 0.09063131890061098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400468826293945, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.12298417091369629}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5897.82438768768, "num_env_steps_trained_throughput_per_sec": 5897.82438768768, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3122.509, "sample_time_ms": 2892.811, "load_time_ms": 16.505, "load_throughput": 1090551.635, "learn_time_ms": 201.1, "learn_throughput": 89507.743, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5539, "training_iteration": 79, "trial_id": "9f288_00022", "date": "2023-10-25_17-26-58", "timestamp": 1698251218, "time_this_iter_s": 3.0569727420806885, "time_total_s": 265.0712592601776, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.0712592601776, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 70.375, "ram_util_percent": 33.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.436928431193034, "policy_loss": -0.03220128578444322, "vf_loss": 6.46917728583018, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00020275823756676914, "entropy": 0.4781711623072624, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 954.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.328999999999802, "episode_len_mean": 272.3, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 44.7, -50.00000000000044, 47.1, 45.9, 46.3, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, -50.00000000000044, 47.5, 43.7, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 23.8999999999999, 27.49999999999995, 40.10000000000002, -50.00000000000044, 2.299999999999592, 45.5, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.9, 42.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 23.699999999999896, 45.3, 21.89999999999987, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 26.499999999999936, 44.5, 45.9, 24.69999999999991, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, 8.099999999999675, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, -50.00000000000044, 12.299999999999734, 36.900000000000034, 43.50000000000001, -50.00000000000044, 39.50000000000002, 20.099999999999845, 47.5, 42.900000000000006, 45.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 44.10000000000001], "episode_lengths": [500, 500, 44, 82, 54, 500, 30, 42, 38, 46, 500, 66, 500, 500, 36, 84, 500, 26, 64, 500, 54, 62, 500, 500, 202, 500, 262, 226, 100, 500, 478, 46, 500, 500, 214, 32, 80, 500, 104, 500, 500, 72, 500, 44, 264, 48, 282, 90, 500, 500, 500, 40, 500, 500, 36, 92, 500, 500, 44, 236, 56, 42, 254, 54, 70, 500, 500, 138, 420, 38, 42, 500, 500, 500, 334, 500, 500, 44, 104, 500, 378, 132, 66, 500, 106, 300, 26, 72, 44, 126, 500, 500, 500, 500, 500, 500, 36, 500, 68, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4110760967764254, "mean_inference_ms": 1.3194234585361628, "mean_action_processing_ms": 0.15376266009945072, "mean_env_wait_ms": 0.09053913226347234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.13449692726135254}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.328999999999802, "episode_len_mean": 272.3, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 44.7, -50.00000000000044, 47.1, 45.9, 46.3, 45.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.5, 41.70000000000002, -50.00000000000044, 47.5, 43.7, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 23.8999999999999, 27.49999999999995, 40.10000000000002, -50.00000000000044, 2.299999999999592, 45.5, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.9, 42.10000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.7, 23.699999999999896, 45.3, 21.89999999999987, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 26.499999999999936, 44.5, 45.9, 24.69999999999991, 44.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 36.30000000000003, 8.099999999999675, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, -50.00000000000044, 12.299999999999734, 36.900000000000034, 43.50000000000001, -50.00000000000044, 39.50000000000002, 20.099999999999845, 47.5, 42.900000000000006, 45.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 44.10000000000001], "episode_lengths": [500, 500, 44, 82, 54, 500, 30, 42, 38, 46, 500, 66, 500, 500, 36, 84, 500, 26, 64, 500, 54, 62, 500, 500, 202, 500, 262, 226, 100, 500, 478, 46, 500, 500, 214, 32, 80, 500, 104, 500, 500, 72, 500, 44, 264, 48, 282, 90, 500, 500, 500, 40, 500, 500, 36, 92, 500, 500, 44, 236, 56, 42, 254, 54, 70, 500, 500, 138, 420, 38, 42, 500, 500, 500, 334, 500, 500, 44, 104, 500, 378, 132, 66, 500, 106, 300, 26, 72, 44, 126, 500, 500, 500, 500, 500, 500, 36, 500, 68, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4110760967764254, "mean_inference_ms": 1.3194234585361628, "mean_action_processing_ms": 0.15376266009945072, "mean_env_wait_ms": 0.09053913226347234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998281478881836, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.13449692726135254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4806.993818062626, "num_env_steps_trained_throughput_per_sec": 4806.993818062626, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3190.763, "sample_time_ms": 2956.066, "load_time_ms": 16.502, "load_throughput": 1090750.158, "learn_time_ms": 206.003, "learn_throughput": 87377.399, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5605, "training_iteration": 80, "trial_id": "9f288_00022", "date": "2023-10-25_17-27-02", "timestamp": 1698251222, "time_this_iter_s": 3.750544548034668, "time_total_s": 268.8218038082123, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.8218038082123, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 76.86, "ram_util_percent": 33.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.7166588306427, "policy_loss": 0.07216162731250127, "vf_loss": 6.6445463101069135, "vf_explained_var": -1.2715657552083333e-06, "kl": 8.486599897317149e-05, "entropy": 0.49090735365947086, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 966.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.291999999999822, "episode_len_mean": 257.72, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, -50.00000000000044, 12.299999999999734, 36.900000000000034, 43.50000000000001, -50.00000000000044, 39.50000000000002, 20.099999999999845, 47.5, 42.900000000000006, 45.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 36.10000000000004, -50.00000000000044, 46.9, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 45.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.1, 41.500000000000014, 41.500000000000014, 41.70000000000002, 42.30000000000001, -50.00000000000044, 35.30000000000004, 21.89999999999987, 11.499999999999723, 39.50000000000002, 46.3, 43.10000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 45.7, 17.899999999999814, 39.70000000000002, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 39.10000000000002, 8.49999999999968, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, 18.099999999999817, 12.899999999999743, 44.300000000000004, 3.499999999999609, 43.7, 45.5, 32.700000000000024, 46.3, 46.699999999999996, 45.3, 43.900000000000006, 42.500000000000014], "episode_lengths": [500, 334, 500, 500, 44, 104, 500, 378, 132, 66, 500, 106, 300, 26, 72, 44, 126, 500, 500, 500, 500, 500, 500, 36, 500, 68, 60, 500, 500, 500, 500, 154, 140, 500, 32, 60, 98, 500, 500, 40, 46, 44, 110, 500, 500, 28, 50, 86, 86, 84, 78, 500, 148, 282, 386, 106, 38, 70, 166, 500, 500, 68, 40, 500, 500, 500, 500, 138, 44, 322, 104, 44, 500, 40, 500, 40, 100, 500, 114, 500, 110, 416, 500, 500, 54, 500, 500, 152, 320, 372, 58, 466, 64, 46, 174, 38, 34, 48, 62, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41182415189328947, "mean_inference_ms": 1.3199553364944823, "mean_action_processing_ms": 0.15339420156226782, "mean_env_wait_ms": 0.09040333797058228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029990434646606445, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.13419246673583984}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.291999999999822, "episode_len_mean": 257.72, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 45.7, 39.70000000000002, -50.00000000000044, 12.299999999999734, 36.900000000000034, 43.50000000000001, -50.00000000000044, 39.50000000000002, 20.099999999999845, 47.5, 42.900000000000006, 45.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 36.10000000000004, -50.00000000000044, 46.9, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 45.7, 39.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.1, 41.500000000000014, 41.500000000000014, 41.70000000000002, 42.30000000000001, -50.00000000000044, 35.30000000000004, 21.89999999999987, 11.499999999999723, 39.50000000000002, 46.3, 43.10000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 45.7, 17.899999999999814, 39.70000000000002, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 40.10000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 39.10000000000002, 8.49999999999968, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, 18.099999999999817, 12.899999999999743, 44.300000000000004, 3.499999999999609, 43.7, 45.5, 32.700000000000024, 46.3, 46.699999999999996, 45.3, 43.900000000000006, 42.500000000000014], "episode_lengths": [500, 334, 500, 500, 44, 104, 500, 378, 132, 66, 500, 106, 300, 26, 72, 44, 126, 500, 500, 500, 500, 500, 500, 36, 500, 68, 60, 500, 500, 500, 500, 154, 140, 500, 32, 60, 98, 500, 500, 40, 46, 44, 110, 500, 500, 28, 50, 86, 86, 84, 78, 500, 148, 282, 386, 106, 38, 70, 166, 500, 500, 68, 40, 500, 500, 500, 500, 138, 44, 322, 104, 44, 500, 40, 500, 40, 100, 500, 114, 500, 110, 416, 500, 500, 54, 500, 500, 152, 320, 372, 58, 466, 64, 46, 174, 38, 34, 48, 62, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41182415189328947, "mean_inference_ms": 1.3199553364944823, "mean_action_processing_ms": 0.15339420156226782, "mean_env_wait_ms": 0.09040333797058228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029990434646606445, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.13419246673583984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5469.460372215399, "num_env_steps_trained_throughput_per_sec": 5469.460372215399, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3213.7, "sample_time_ms": 2982.203, "load_time_ms": 16.602, "load_throughput": 1084179.242, "learn_time_ms": 202.5, "learn_throughput": 88888.968, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5678, "training_iteration": 81, "trial_id": "9f288_00022", "date": "2023-10-25_17-27-05", "timestamp": 1698251225, "time_this_iter_s": 3.2960009574890137, "time_total_s": 272.1178047657013, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.1178047657013, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 69.62, "ram_util_percent": 33.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.991438666979472, "policy_loss": 0.031115279921020072, "vf_loss": 6.9603748718897505, "vf_explained_var": -1.430511474609375e-06, "kl": 2.8319014662603337e-05, "entropy": 0.5143884643912315, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 978.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.839999999999876, "episode_len_mean": 212.36, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, 18.099999999999817, 12.899999999999743, 44.300000000000004, 3.499999999999609, 43.7, 45.5, 32.700000000000024, 46.3, 46.699999999999996, 45.3, 43.900000000000006, 42.500000000000014, -50.00000000000044, 39.70000000000002, 44.7, -50.00000000000044, 25.29999999999992, -50.00000000000044, 2.499999999999595, 45.1, 39.10000000000002, 44.900000000000006, 43.900000000000006, 44.900000000000006, 45.9, 40.90000000000002, 45.5, 45.9, 45.5, 43.30000000000001, 44.900000000000006, 34.900000000000034, 45.5, 46.5, -50.00000000000044, 45.1, 17.69999999999981, 44.300000000000004, -50.00000000000044, 38.90000000000002, 43.30000000000001, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.10000000000004, 32.100000000000016, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.30000000000002, 30.499999999999993, 15.299999999999777, -50.00000000000044, 44.10000000000001, 38.10000000000002, 42.30000000000001, 42.70000000000001, 45.7, -50.00000000000044, 31.1, -50.00000000000044, 33.10000000000003, 27.49999999999995, -50.00000000000044, 46.3, 41.70000000000002, 41.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 2.499999999999595, 41.100000000000016, 45.3, 43.7, 43.30000000000001, 45.3, -50.00000000000044, 35.10000000000004, 43.900000000000006, 32.100000000000016, 37.300000000000026, 43.900000000000006, -50.00000000000044, 44.7, 7.09999999999966, -50.00000000000044, 39.50000000000002, 45.9], "episode_lengths": [54, 500, 500, 152, 320, 372, 58, 466, 64, 46, 174, 38, 34, 48, 62, 76, 500, 104, 54, 500, 248, 500, 476, 50, 110, 52, 62, 52, 42, 92, 46, 42, 46, 68, 52, 152, 46, 36, 500, 50, 324, 58, 500, 112, 68, 36, 68, 500, 500, 500, 118, 500, 150, 180, 500, 500, 160, 98, 196, 348, 500, 60, 120, 78, 74, 44, 500, 190, 500, 170, 226, 500, 38, 84, 90, 500, 154, 500, 78, 500, 500, 62, 476, 90, 48, 64, 68, 48, 500, 150, 62, 180, 128, 62, 500, 54, 430, 500, 106, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4119451725478481, "mean_inference_ms": 1.3188505732066134, "mean_action_processing_ms": 0.15326718222926744, "mean_env_wait_ms": 0.09081054607750075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028007984161376953, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12520289421081543}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.839999999999876, "episode_len_mean": 212.36, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, 18.099999999999817, 12.899999999999743, 44.300000000000004, 3.499999999999609, 43.7, 45.5, 32.700000000000024, 46.3, 46.699999999999996, 45.3, 43.900000000000006, 42.500000000000014, -50.00000000000044, 39.70000000000002, 44.7, -50.00000000000044, 25.29999999999992, -50.00000000000044, 2.499999999999595, 45.1, 39.10000000000002, 44.900000000000006, 43.900000000000006, 44.900000000000006, 45.9, 40.90000000000002, 45.5, 45.9, 45.5, 43.30000000000001, 44.900000000000006, 34.900000000000034, 45.5, 46.5, -50.00000000000044, 45.1, 17.69999999999981, 44.300000000000004, -50.00000000000044, 38.90000000000002, 43.30000000000001, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 35.10000000000004, 32.100000000000016, -50.00000000000044, -50.00000000000044, 34.10000000000004, 40.30000000000002, 30.499999999999993, 15.299999999999777, -50.00000000000044, 44.10000000000001, 38.10000000000002, 42.30000000000001, 42.70000000000001, 45.7, -50.00000000000044, 31.1, -50.00000000000044, 33.10000000000003, 27.49999999999995, -50.00000000000044, 46.3, 41.70000000000002, 41.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 2.499999999999595, 41.100000000000016, 45.3, 43.7, 43.30000000000001, 45.3, -50.00000000000044, 35.10000000000004, 43.900000000000006, 32.100000000000016, 37.300000000000026, 43.900000000000006, -50.00000000000044, 44.7, 7.09999999999966, -50.00000000000044, 39.50000000000002, 45.9], "episode_lengths": [54, 500, 500, 152, 320, 372, 58, 466, 64, 46, 174, 38, 34, 48, 62, 76, 500, 104, 54, 500, 248, 500, 476, 50, 110, 52, 62, 52, 42, 92, 46, 42, 46, 68, 52, 152, 46, 36, 500, 50, 324, 58, 500, 112, 68, 36, 68, 500, 500, 500, 118, 500, 150, 180, 500, 500, 160, 98, 196, 348, 500, 60, 120, 78, 74, 44, 500, 190, 500, 170, 226, 500, 38, 84, 90, 500, 154, 500, 78, 500, 500, 62, 476, 90, 48, 64, 68, 48, 500, 150, 62, 180, 128, 62, 500, 54, 430, 500, 106, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4119451725478481, "mean_inference_ms": 1.3188505732066134, "mean_action_processing_ms": 0.15326718222926744, "mean_env_wait_ms": 0.09081054607750075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028007984161376953, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12520289421081543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5221.9320744297565, "num_env_steps_trained_throughput_per_sec": 5221.9320744297565, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3239.2, "sample_time_ms": 2996.603, "load_time_ms": 16.602, "load_throughput": 1084207.267, "learn_time_ms": 213.597, "learn_throughput": 84270.908, "synch_weights_time_ms": 9.496}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5762, "training_iteration": 82, "trial_id": "9f288_00022", "date": "2023-10-25_17-27-09", "timestamp": 1698251229, "time_this_iter_s": 3.4529993534088135, "time_total_s": 275.5708041191101, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 275.5708041191101, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 65.35999999999999, "ram_util_percent": 33.720000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.43850560983022, "policy_loss": 0.03245370462536812, "vf_loss": 6.406102021535237, "vf_explained_var": -1.3113021850585938e-06, "kl": 2.2855525437866692e-05, "entropy": 0.501598484814167, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 990.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.58599999999984, "episode_len_mean": 234.82, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 41.70000000000002, 41.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 2.499999999999595, 41.100000000000016, 45.3, 43.7, 43.30000000000001, 45.3, -50.00000000000044, 35.10000000000004, 43.900000000000006, 32.100000000000016, 37.300000000000026, 43.900000000000006, -50.00000000000044, 44.7, 7.09999999999966, -50.00000000000044, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 45.1, 46.9, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.5, 46.3, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.500000000000014, 43.7, 46.3, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, 32.100000000000016, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 2.499999999999595, 35.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, 46.5, 13.699999999999754, 46.5, 44.300000000000004, -50.00000000000044, 45.5, 44.900000000000006, 36.900000000000034, 45.3, 44.5, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 45.9, 44.900000000000006, 44.7, 45.9, 42.30000000000001, 33.10000000000003, 35.70000000000003, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 43.900000000000006, 32.50000000000002, 0.8999999999995723, -50.00000000000044, 46.9, 40.10000000000002], "episode_lengths": [38, 84, 90, 500, 154, 500, 78, 500, 500, 62, 476, 90, 48, 64, 68, 48, 500, 150, 62, 180, 128, 62, 500, 54, 430, 500, 106, 42, 500, 500, 50, 32, 500, 188, 500, 56, 38, 50, 500, 76, 500, 500, 500, 500, 46, 76, 64, 38, 500, 500, 266, 500, 180, 500, 352, 500, 500, 476, 142, 48, 500, 500, 34, 78, 500, 36, 364, 36, 58, 500, 46, 52, 132, 48, 56, 48, 500, 92, 500, 50, 42, 52, 54, 42, 78, 170, 144, 500, 66, 36, 500, 500, 58, 56, 62, 176, 492, 500, 32, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41101620300742314, "mean_inference_ms": 1.3179462263461925, "mean_action_processing_ms": 0.15300321850013132, "mean_env_wait_ms": 0.09069770578596914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.12500667572021484}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.58599999999984, "episode_len_mean": 234.82, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 41.70000000000002, 41.100000000000016, -50.00000000000044, 34.70000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 2.499999999999595, 41.100000000000016, 45.3, 43.7, 43.30000000000001, 45.3, -50.00000000000044, 35.10000000000004, 43.900000000000006, 32.100000000000016, 37.300000000000026, 43.900000000000006, -50.00000000000044, 44.7, 7.09999999999966, -50.00000000000044, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 45.1, 46.9, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.5, 46.3, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.500000000000014, 43.7, 46.3, -50.00000000000044, -50.00000000000044, 23.499999999999893, -50.00000000000044, 32.100000000000016, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 2.499999999999595, 35.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.30000000000001, -50.00000000000044, 46.5, 13.699999999999754, 46.5, 44.300000000000004, -50.00000000000044, 45.5, 44.900000000000006, 36.900000000000034, 45.3, 44.5, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 45.9, 44.900000000000006, 44.7, 45.9, 42.30000000000001, 33.10000000000003, 35.70000000000003, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 43.900000000000006, 32.50000000000002, 0.8999999999995723, -50.00000000000044, 46.9, 40.10000000000002], "episode_lengths": [38, 84, 90, 500, 154, 500, 78, 500, 500, 62, 476, 90, 48, 64, 68, 48, 500, 150, 62, 180, 128, 62, 500, 54, 430, 500, 106, 42, 500, 500, 50, 32, 500, 188, 500, 56, 38, 50, 500, 76, 500, 500, 500, 500, 46, 76, 64, 38, 500, 500, 266, 500, 180, 500, 352, 500, 500, 476, 142, 48, 500, 500, 34, 78, 500, 36, 364, 36, 58, 500, 46, 52, 132, 48, 56, 48, 500, 92, 500, 50, 42, 52, 54, 42, 78, 170, 144, 500, 66, 36, 500, 500, 58, 56, 62, 176, 492, 500, 32, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41101620300742314, "mean_inference_ms": 1.3179462263461925, "mean_action_processing_ms": 0.15300321850013132, "mean_env_wait_ms": 0.09069770578596914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.12500667572021484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5298.432593960848, "num_env_steps_trained_throughput_per_sec": 5298.432593960848, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3261.526, "sample_time_ms": 3023.906, "load_time_ms": 17.502, "load_throughput": 1028451.21, "learn_time_ms": 207.717, "learn_throughput": 86656.468, "synch_weights_time_ms": 9.495}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5834, "training_iteration": 83, "trial_id": "9f288_00022", "date": "2023-10-25_17-27-12", "timestamp": 1698251232, "time_this_iter_s": 3.4032270908355713, "time_total_s": 278.9740312099457, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 278.9740312099457, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 70.58000000000001, "ram_util_percent": 33.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.914396007855733, "policy_loss": 0.03627243575950464, "vf_loss": 6.8781737089157104, "vf_explained_var": -1.2218952178955078e-06, "kl": 2.246609075247837e-05, "entropy": 0.4996983955303828, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1002.5, "diff_num_grad_updates_vs_sampler_policy": 5.5}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.46099999999984, "episode_len_mean": 241.06, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 44.900000000000006, 36.900000000000034, 45.3, 44.5, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 45.9, 44.900000000000006, 44.7, 45.9, 42.30000000000001, 33.10000000000003, 35.70000000000003, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 43.900000000000006, 32.50000000000002, 0.8999999999995723, -50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, 29.099999999999973, 45.7, 45.3, -50.00000000000044, 46.3, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 41.90000000000001, 41.70000000000002, 47.5, 42.500000000000014, 38.300000000000026, 34.10000000000004, 41.500000000000014, 30.9, 38.50000000000003, 45.5, 15.299999999999777, 46.3, 39.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 36.900000000000034, 46.099999999999994, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 5.299999999999635, 28.09999999999996, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, 22.699999999999882, 46.3, 14.899999999999771, 42.30000000000001, -50.00000000000044, 43.30000000000001], "episode_lengths": [46, 52, 132, 48, 56, 48, 500, 92, 500, 50, 42, 52, 54, 42, 78, 170, 144, 500, 66, 36, 500, 500, 58, 56, 62, 176, 492, 500, 32, 100, 500, 210, 44, 48, 500, 38, 92, 42, 500, 500, 500, 56, 500, 322, 500, 42, 80, 500, 500, 286, 70, 500, 500, 52, 500, 500, 500, 114, 82, 84, 26, 76, 118, 160, 86, 192, 116, 46, 348, 38, 110, 500, 58, 500, 88, 500, 132, 40, 246, 500, 500, 500, 74, 500, 448, 220, 500, 198, 500, 500, 500, 500, 84, 46, 274, 38, 352, 78, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4116875032869829, "mean_inference_ms": 1.3197353735195927, "mean_action_processing_ms": 0.1531702849888023, "mean_env_wait_ms": 0.09071707504273675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600454330444336, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.1389923095703125}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.46099999999984, "episode_len_mean": 241.06, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 44.900000000000006, 36.900000000000034, 45.3, 44.5, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.1, 45.9, 44.900000000000006, 44.7, 45.9, 42.30000000000001, 33.10000000000003, 35.70000000000003, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, 43.900000000000006, 32.50000000000002, 0.8999999999995723, -50.00000000000044, 46.9, 40.10000000000002, -50.00000000000044, 29.099999999999973, 45.7, 45.3, -50.00000000000044, 46.3, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 21.499999999999865, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 41.90000000000001, 41.70000000000002, 47.5, 42.500000000000014, 38.300000000000026, 34.10000000000004, 41.500000000000014, 30.9, 38.50000000000003, 45.5, 15.299999999999777, 46.3, 39.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, -50.00000000000044, 36.900000000000034, 46.099999999999994, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 5.299999999999635, 28.09999999999996, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, 22.699999999999882, 46.3, 14.899999999999771, 42.30000000000001, -50.00000000000044, 43.30000000000001], "episode_lengths": [46, 52, 132, 48, 56, 48, 500, 92, 500, 50, 42, 52, 54, 42, 78, 170, 144, 500, 66, 36, 500, 500, 58, 56, 62, 176, 492, 500, 32, 100, 500, 210, 44, 48, 500, 38, 92, 42, 500, 500, 500, 56, 500, 322, 500, 42, 80, 500, 500, 286, 70, 500, 500, 52, 500, 500, 500, 114, 82, 84, 26, 76, 118, 160, 86, 192, 116, 46, 348, 38, 110, 500, 58, 500, 88, 500, 132, 40, 246, 500, 500, 500, 74, 500, 448, 220, 500, 198, 500, 500, 500, 500, 84, 46, 274, 38, 352, 78, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4116875032869829, "mean_inference_ms": 1.3197353735195927, "mean_action_processing_ms": 0.1531702849888023, "mean_env_wait_ms": 0.09071707504273675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600454330444336, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.1389923095703125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5281.73449293791, "num_env_steps_trained_throughput_per_sec": 5281.73449293791, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3265.369, "sample_time_ms": 3037.65, "load_time_ms": 16.802, "load_throughput": 1071304.012, "learn_time_ms": 198.317, "learn_throughput": 90763.972, "synch_weights_time_ms": 9.696}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5904, "training_iteration": 84, "trial_id": "9f288_00022", "date": "2023-10-25_17-27-15", "timestamp": 1698251235, "time_this_iter_s": 3.4139699935913086, "time_total_s": 282.388001203537, "pid": 1236, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 282.388001203537, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 80.025, "ram_util_percent": 34.025}}
