{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999993, "cur_lr": 0.0003, "total_loss": 9.163730155097113, "policy_loss": -0.0014403202467494541, "vf_loss": 9.164614401923286, "vf_explained_var": 9.476343790690104e-05, "kl": 0.0031324378643737038, "entropy": 0.7025867117775811, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 36.70000000000003, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -40.058333333333735, "episode_len_mean": 470.1666666666667, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 338, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 134, 500, 500, 332, 500, 310, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37753036650662514, "mean_inference_ms": 1.1991811756978636, "mean_action_processing_ms": 0.13974250064488122, "mean_env_wait_ms": 0.08306023070157274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0361429320441352, "StateBufferConnector_ms": 0.0027795632680257163, "ViewRequirementAgentConnector_ms": 0.08608500162760417}}, "episode_reward_max": 36.70000000000003, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -40.058333333333735, "episode_len_mean": 470.1666666666667, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 338, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 134, 500, 500, 332, 500, 310, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37753036650662514, "mean_inference_ms": 1.1991811756978636, "mean_action_processing_ms": 0.13974250064488122, "mean_env_wait_ms": 0.08306023070157274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0361429320441352, "StateBufferConnector_ms": 0.0027795632680257163, "ViewRequirementAgentConnector_ms": 0.08608500162760417}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5601.201709440136, "num_env_steps_trained_throughput_per_sec": 5601.201709440136, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3213.596, "sample_time_ms": 2905.999, "load_time_ms": 10.002, "load_throughput": 1799658.459, "learn_time_ms": 283.587, "learn_throughput": 63472.59, "synch_weights_time_ms": 11.003}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 36, "training_iteration": 1, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-02", "timestamp": 1698250622, "time_this_iter_s": 3.218587636947632, "time_total_s": 3.218587636947632, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.218587636947632, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 61.580000000000005, "ram_util_percent": 26.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999996, "cur_lr": 0.0003, "total_loss": 8.837346818712023, "policy_loss": -0.0030138755838076273, "vf_loss": 8.840035120646158, "vf_explained_var": 1.463227801852756e-05, "kl": 0.003959814489982231, "entropy": 0.7041953868336148, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -23.442307692308024, "episode_len_mean": 420.6923076923077, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 37.50000000000003, 27.899999999999956, -50.00000000000044, 26.299999999999933, -50.00000000000044, 6.699999999999655, 45.9, -50.00000000000044, -50.00000000000044, 14.899999999999771, 12.299999999999734, 29.69999999999998, -50.00000000000044, -50.00000000000044, 7.299999999999663, 39.90000000000002, 5.299999999999635, 38.10000000000002, 11.899999999999729, -50.00000000000044, -50.00000000000044, 4.699999999999626, 19.899999999999842, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 21.299999999999862, 18.899999999999828, 38.700000000000024, 0.6999999999995694, 34.50000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 338, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 134, 500, 500, 332, 500, 310, 500, 500, 500, 500, 500, 500, 500, 398, 500, 126, 222, 500, 238, 500, 434, 42, 500, 500, 352, 378, 204, 500, 500, 428, 102, 448, 120, 382, 500, 500, 454, 302, 500, 390, 500, 500, 500, 500, 206, 500, 500, 298, 500, 288, 312, 114, 494, 156, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38348489597237817, "mean_inference_ms": 1.2198315938639017, "mean_action_processing_ms": 0.1406190948087514, "mean_env_wait_ms": 0.08566196609114855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03976638500507061, "StateBufferConnector_ms": 0.006409180470002003, "ViewRequirementAgentConnector_ms": 0.10251570970584185}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -23.442307692308024, "episode_len_mean": 420.6923076923077, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 16.8999999999998, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, 37.50000000000003, 27.899999999999956, -50.00000000000044, 26.299999999999933, -50.00000000000044, 6.699999999999655, 45.9, -50.00000000000044, -50.00000000000044, 14.899999999999771, 12.299999999999734, 29.69999999999998, -50.00000000000044, -50.00000000000044, 7.299999999999663, 39.90000000000002, 5.299999999999635, 38.10000000000002, 11.899999999999729, -50.00000000000044, -50.00000000000044, 4.699999999999626, 19.899999999999842, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 21.299999999999862, 18.899999999999828, 38.700000000000024, 0.6999999999995694, 34.50000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 338, 500, 500, 500, 500, 500, 500, 500, 312, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 134, 500, 500, 332, 500, 310, 500, 500, 500, 500, 500, 500, 500, 398, 500, 126, 222, 500, 238, 500, 434, 42, 500, 500, 352, 378, 204, 500, 500, 428, 102, 448, 120, 382, 500, 500, 454, 302, 500, 390, 500, 500, 500, 500, 206, 500, 500, 298, 500, 288, 312, 114, 494, 156, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38348489597237817, "mean_inference_ms": 1.2198315938639017, "mean_action_processing_ms": 0.1406190948087514, "mean_env_wait_ms": 0.08566196609114855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03976638500507061, "StateBufferConnector_ms": 0.006409180470002003, "ViewRequirementAgentConnector_ms": 0.10251570970584185}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5466.732047592139, "num_env_steps_trained_throughput_per_sec": 5466.732047592139, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3252.622, "sample_time_ms": 2943.0, "load_time_ms": 10.501, "load_throughput": 1714079.123, "learn_time_ms": 286.613, "learn_throughput": 62802.379, "synch_weights_time_ms": 10.503}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 78, "training_iteration": 2, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-05", "timestamp": 1698250625, "time_this_iter_s": 3.2976417541503906, "time_total_s": 6.5162293910980225, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.5162293910980225, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.08, "ram_util_percent": 26.860000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.04999999999999998, "cur_lr": 0.0003, "total_loss": 8.830695427788628, "policy_loss": -0.0007027982009781732, "vf_loss": 8.831338161892361, "vf_explained_var": -8.111529880099827e-06, "kl": 0.0025738638050724046, "entropy": 0.6851827383041382, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.889000000000224, "episode_len_mean": 334.52, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 27.899999999999956, -50.00000000000044, 26.299999999999933, -50.00000000000044, 6.699999999999655, 45.9, -50.00000000000044, -50.00000000000044, 14.899999999999771, 12.299999999999734, 29.69999999999998, -50.00000000000044, -50.00000000000044, 7.299999999999663, 39.90000000000002, 5.299999999999635, 38.10000000000002, 11.899999999999729, -50.00000000000044, -50.00000000000044, 4.699999999999626, 19.899999999999842, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 21.299999999999862, 18.899999999999828, 38.700000000000024, 0.6999999999995694, 34.50000000000004, -50.00000000000044, 14.499999999999766, -50.00000000000044, 34.70000000000004, 32.90000000000003, 37.90000000000003, -50.00000000000044, 37.90000000000003, 15.299999999999777, 10.499999999999709, 18.099999999999817, -50.00000000000044, 24.899999999999913, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.300000000000026, 22.899999999999885, 28.29999999999996, 40.70000000000002, -50.00000000000044, 43.10000000000001, 20.099999999999845, -50.00000000000044, 17.499999999999808, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 11.099999999999717, 29.099999999999973, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.30000000000002, 29.899999999999984, 33.10000000000003, 17.69999999999981, 34.900000000000034, 1.8999999999995865, 29.49999999999998, -50.00000000000044, 35.70000000000003, 31.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 38.300000000000026, 38.700000000000024, 32.700000000000024, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 27.49999999999995, 36.50000000000003], "episode_lengths": [126, 222, 500, 238, 500, 434, 42, 500, 500, 352, 378, 204, 500, 500, 428, 102, 448, 120, 382, 500, 500, 454, 302, 500, 390, 500, 500, 500, 500, 206, 500, 500, 298, 500, 288, 312, 114, 494, 156, 500, 356, 500, 154, 172, 122, 500, 122, 348, 396, 320, 500, 252, 76, 500, 500, 108, 272, 218, 94, 500, 70, 300, 500, 326, 124, 500, 500, 500, 106, 390, 210, 382, 500, 500, 98, 202, 170, 324, 152, 482, 206, 500, 144, 190, 134, 500, 500, 500, 500, 368, 118, 114, 174, 500, 500, 104, 500, 202, 226, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38966496806550976, "mean_inference_ms": 1.2450704547569662, "mean_action_processing_ms": 0.1440027948287821, "mean_env_wait_ms": 0.08819444011138422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002666473388672, "StateBufferConnector_ms": 0.008993864059448242, "ViewRequirementAgentConnector_ms": 0.12297391891479492}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.889000000000224, "episode_len_mean": 334.52, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 27.899999999999956, -50.00000000000044, 26.299999999999933, -50.00000000000044, 6.699999999999655, 45.9, -50.00000000000044, -50.00000000000044, 14.899999999999771, 12.299999999999734, 29.69999999999998, -50.00000000000044, -50.00000000000044, 7.299999999999663, 39.90000000000002, 5.299999999999635, 38.10000000000002, 11.899999999999729, -50.00000000000044, -50.00000000000044, 4.699999999999626, 19.899999999999842, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 21.299999999999862, 18.899999999999828, 38.700000000000024, 0.6999999999995694, 34.50000000000004, -50.00000000000044, 14.499999999999766, -50.00000000000044, 34.70000000000004, 32.90000000000003, 37.90000000000003, -50.00000000000044, 37.90000000000003, 15.299999999999777, 10.499999999999709, 18.099999999999817, -50.00000000000044, 24.899999999999913, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.300000000000026, 22.899999999999885, 28.29999999999996, 40.70000000000002, -50.00000000000044, 43.10000000000001, 20.099999999999845, -50.00000000000044, 17.499999999999808, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 11.099999999999717, 29.099999999999973, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.30000000000002, 29.899999999999984, 33.10000000000003, 17.69999999999981, 34.900000000000034, 1.8999999999995865, 29.49999999999998, -50.00000000000044, 35.70000000000003, 31.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 38.300000000000026, 38.700000000000024, 32.700000000000024, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 27.49999999999995, 36.50000000000003], "episode_lengths": [126, 222, 500, 238, 500, 434, 42, 500, 500, 352, 378, 204, 500, 500, 428, 102, 448, 120, 382, 500, 500, 454, 302, 500, 390, 500, 500, 500, 500, 206, 500, 500, 298, 500, 288, 312, 114, 494, 156, 500, 356, 500, 154, 172, 122, 500, 122, 348, 396, 320, 500, 252, 76, 500, 500, 108, 272, 218, 94, 500, 70, 300, 500, 326, 124, 500, 500, 500, 106, 390, 210, 382, 500, 500, 98, 202, 170, 324, 152, 482, 206, 500, 144, 190, 134, 500, 500, 500, 500, 368, 118, 114, 174, 500, 500, 104, 500, 202, 226, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38966496806550976, "mean_inference_ms": 1.2450704547569662, "mean_action_processing_ms": 0.1440027948287821, "mean_env_wait_ms": 0.08819444011138422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002666473388672, "StateBufferConnector_ms": 0.008993864059448242, "ViewRequirementAgentConnector_ms": 0.12297391891479492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5029.336134045689, "num_env_steps_trained_throughput_per_sec": 5029.336134045689, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3361.415, "sample_time_ms": 2958.667, "load_time_ms": 14.0, "load_throughput": 1285734.488, "learn_time_ms": 376.076, "learn_throughput": 47862.729, "synch_weights_time_ms": 10.669}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 138, "training_iteration": 3, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-09", "timestamp": 1698250629, "time_this_iter_s": 3.5840344429016113, "time_total_s": 10.100263833999634, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.100263833999634, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 59.879999999999995, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02499999999999999, "cur_lr": 0.0003, "total_loss": 8.152572313944498, "policy_loss": -0.0008209379182921515, "vf_loss": 8.153392802344428, "vf_explained_var": 1.9815233018663196e-06, "kl": 0.0024462231582598787, "entropy": 0.6059765974680583, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.4109999999997981, "episode_len_mean": 301.5, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 11.099999999999717, 29.099999999999973, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.30000000000002, 29.899999999999984, 33.10000000000003, 17.69999999999981, 34.900000000000034, 1.8999999999995865, 29.49999999999998, -50.00000000000044, 35.70000000000003, 31.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 38.300000000000026, 38.700000000000024, 32.700000000000024, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 27.49999999999995, 36.50000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 34.30000000000004, 39.10000000000002, 30.9, 43.30000000000001, 41.500000000000014, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 7.699999999999669, 14.699999999999768, 39.70000000000002, 43.50000000000001, 42.30000000000001, -50.00000000000044, 44.300000000000004, 42.10000000000001, 14.699999999999768, 27.49999999999995, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 44.10000000000001, 44.5, -50.00000000000044, 36.30000000000003, 0.8999999999995723, -50.00000000000044, 37.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 8.099999999999675, 42.70000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 39.70000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024], "episode_lengths": [124, 500, 500, 500, 106, 390, 210, 382, 500, 500, 98, 202, 170, 324, 152, 482, 206, 500, 144, 190, 134, 500, 500, 500, 500, 368, 118, 114, 174, 500, 500, 104, 500, 202, 226, 136, 500, 54, 500, 44, 158, 110, 192, 68, 86, 100, 500, 42, 500, 88, 500, 500, 170, 424, 354, 104, 66, 78, 500, 58, 80, 354, 226, 100, 500, 500, 64, 64, 60, 56, 500, 138, 492, 500, 128, 54, 500, 500, 420, 74, 494, 500, 500, 500, 188, 500, 500, 500, 92, 500, 500, 500, 192, 104, 500, 204, 500, 500, 500, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917581760968477, "mean_inference_ms": 1.2463885715524325, "mean_action_processing_ms": 0.14544411575246877, "mean_env_wait_ms": 0.08817816096954595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020995378494262695, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.12503337860107422}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.4109999999997981, "episode_len_mean": 301.5, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 11.099999999999717, 29.099999999999973, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.30000000000002, 29.899999999999984, 33.10000000000003, 17.69999999999981, 34.900000000000034, 1.8999999999995865, 29.49999999999998, -50.00000000000044, 35.70000000000003, 31.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 38.300000000000026, 38.700000000000024, 32.700000000000024, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 27.49999999999995, 36.50000000000003, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 34.30000000000004, 39.10000000000002, 30.9, 43.30000000000001, 41.500000000000014, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 7.699999999999669, 14.699999999999768, 39.70000000000002, 43.50000000000001, 42.30000000000001, -50.00000000000044, 44.300000000000004, 42.10000000000001, 14.699999999999768, 27.49999999999995, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 44.10000000000001, 44.5, -50.00000000000044, 36.30000000000003, 0.8999999999995723, -50.00000000000044, 37.300000000000026, 44.7, -50.00000000000044, -50.00000000000044, 8.099999999999675, 42.70000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 39.70000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024], "episode_lengths": [124, 500, 500, 500, 106, 390, 210, 382, 500, 500, 98, 202, 170, 324, 152, 482, 206, 500, 144, 190, 134, 500, 500, 500, 500, 368, 118, 114, 174, 500, 500, 104, 500, 202, 226, 136, 500, 54, 500, 44, 158, 110, 192, 68, 86, 100, 500, 42, 500, 88, 500, 500, 170, 424, 354, 104, 66, 78, 500, 58, 80, 354, 226, 100, 500, 500, 64, 64, 60, 56, 500, 138, 492, 500, 128, 54, 500, 500, 420, 74, 494, 500, 500, 500, 188, 500, 500, 500, 92, 500, 500, 500, 192, 104, 500, 204, 500, 500, 500, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917581760968477, "mean_inference_ms": 1.2463885715524325, "mean_action_processing_ms": 0.14544411575246877, "mean_env_wait_ms": 0.08817816096954595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020995378494262695, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.12503337860107422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5294.759821652492, "num_env_steps_trained_throughput_per_sec": 5294.759821652492, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3370.958, "sample_time_ms": 2943.251, "load_time_ms": 13.999, "load_throughput": 1285763.684, "learn_time_ms": 400.204, "learn_throughput": 44977.115, "synch_weights_time_ms": 11.501}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 202, "training_iteration": 4, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-12", "timestamp": 1698250632, "time_this_iter_s": 3.4055843353271484, "time_total_s": 13.505848169326782, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.505848169326782, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.9, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012499999999999995, "cur_lr": 0.0003, "total_loss": 7.454042572445339, "policy_loss": -0.0008081644359562132, "vf_loss": 7.454884624481201, "vf_explained_var": 6.344583299424913e-07, "kl": 0.0021388758023527365, "entropy": 0.6056511706776089, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.673999999999843, "episode_len_mean": 253.94, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 39.70000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 27.899999999999956, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.50000000000001, 42.30000000000001, -50.00000000000044, 26.09999999999993, 24.099999999999902, 44.5, 37.90000000000003, 44.5, -50.00000000000044, 39.10000000000002, 46.099999999999994, 44.10000000000001, -50.00000000000044, 41.500000000000014, 39.300000000000026, 32.90000000000003, 34.30000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 31.1, 35.900000000000034, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 21.499999999999865, 43.10000000000001, 40.70000000000002, -50.00000000000044, 32.90000000000003, 47.3, 18.29999999999982, 46.099999999999994, 0.49999999999956657, 39.50000000000002, -50.00000000000044, 38.90000000000002, 42.70000000000001, 39.50000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 18.099999999999817, 43.7, 36.70000000000003, 8.099999999999675, 28.09999999999996, 39.90000000000002, 46.5, 32.30000000000002, 44.7, -50.00000000000044, 41.500000000000014, 39.10000000000002, 44.300000000000004, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 39.90000000000002, -50.00000000000044, 14.299999999999763, 43.7, 41.70000000000002, 36.10000000000004, 41.100000000000016, 45.5, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 39.70000000000002], "episode_lengths": [74, 494, 500, 500, 500, 188, 500, 500, 500, 92, 500, 500, 500, 192, 104, 500, 204, 500, 500, 500, 114, 222, 500, 500, 166, 66, 78, 500, 240, 260, 56, 122, 56, 500, 110, 40, 60, 500, 86, 108, 172, 158, 500, 74, 500, 190, 142, 372, 500, 500, 500, 78, 286, 70, 94, 500, 172, 28, 318, 40, 496, 106, 500, 112, 74, 106, 500, 88, 500, 320, 64, 134, 420, 220, 102, 36, 178, 54, 500, 86, 110, 58, 68, 34, 500, 58, 102, 500, 358, 64, 84, 140, 90, 46, 58, 500, 40, 58, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878973617801833, "mean_inference_ms": 1.2425738455812216, "mean_action_processing_ms": 0.14607750647717166, "mean_env_wait_ms": 0.0866715057492229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999187469482422, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.11005187034606934}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.673999999999843, "episode_len_mean": 253.94, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 39.70000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 27.899999999999956, -50.00000000000044, -50.00000000000044, 33.500000000000036, 43.50000000000001, 42.30000000000001, -50.00000000000044, 26.09999999999993, 24.099999999999902, 44.5, 37.90000000000003, 44.5, -50.00000000000044, 39.10000000000002, 46.099999999999994, 44.10000000000001, -50.00000000000044, 41.500000000000014, 39.300000000000026, 32.90000000000003, 34.30000000000004, -50.00000000000044, 42.70000000000001, -50.00000000000044, 31.1, 35.900000000000034, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 21.499999999999865, 43.10000000000001, 40.70000000000002, -50.00000000000044, 32.90000000000003, 47.3, 18.29999999999982, 46.099999999999994, 0.49999999999956657, 39.50000000000002, -50.00000000000044, 38.90000000000002, 42.70000000000001, 39.50000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 18.099999999999817, 43.7, 36.70000000000003, 8.099999999999675, 28.09999999999996, 39.90000000000002, 46.5, 32.30000000000002, 44.7, -50.00000000000044, 41.500000000000014, 39.10000000000002, 44.300000000000004, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 39.90000000000002, -50.00000000000044, 14.299999999999763, 43.7, 41.70000000000002, 36.10000000000004, 41.100000000000016, 45.5, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 39.70000000000002], "episode_lengths": [74, 494, 500, 500, 500, 188, 500, 500, 500, 92, 500, 500, 500, 192, 104, 500, 204, 500, 500, 500, 114, 222, 500, 500, 166, 66, 78, 500, 240, 260, 56, 122, 56, 500, 110, 40, 60, 500, 86, 108, 172, 158, 500, 74, 500, 190, 142, 372, 500, 500, 500, 78, 286, 70, 94, 500, 172, 28, 318, 40, 496, 106, 500, 112, 74, 106, 500, 88, 500, 320, 64, 134, 420, 220, 102, 36, 178, 54, 500, 86, 110, 58, 68, 34, 500, 58, 102, 500, 358, 64, 84, 140, 90, 46, 58, 500, 40, 58, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878973617801833, "mean_inference_ms": 1.2425738455812216, "mean_action_processing_ms": 0.14607750647717166, "mean_env_wait_ms": 0.0866715057492229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999187469482422, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.11005187034606934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5467.797469186843, "num_env_steps_trained_throughput_per_sec": 5467.797469186843, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3355.167, "sample_time_ms": 2924.4, "load_time_ms": 15.6, "load_throughput": 1153855.719, "learn_time_ms": 401.963, "learn_throughput": 44780.289, "synch_weights_time_ms": 11.002}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 281, "training_iteration": 5, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-16", "timestamp": 1698250636, "time_this_iter_s": 3.296999931335449, "time_total_s": 16.80284810066223, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.80284810066223, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 65.7, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006249999999999998, "cur_lr": 0.0003, "total_loss": 7.0266712612575954, "policy_loss": -0.0007001225940055317, "vf_loss": 7.027419312795003, "vf_explained_var": -1.1006991068522134e-06, "kl": 0.0014556879294534359, "entropy": 0.5691339863671196, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.626999999999862, "episode_len_mean": 229.44, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.09999999999996, 39.90000000000002, 46.5, 32.30000000000002, 44.7, -50.00000000000044, 41.500000000000014, 39.10000000000002, 44.300000000000004, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 39.90000000000002, -50.00000000000044, 14.299999999999763, 43.7, 41.70000000000002, 36.10000000000004, 41.100000000000016, 45.5, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 15.899999999999785, 43.10000000000001, 42.900000000000006, 41.70000000000002, 34.30000000000004, -50.00000000000044, 25.899999999999928, 46.5, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 39.70000000000002, 26.89999999999994, 39.90000000000002, -50.00000000000044, 37.90000000000003, 44.7, 40.90000000000002, 36.10000000000004, 41.70000000000002, 26.299999999999933, 45.3, 39.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 40.30000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 3.2999999999996064, 11.29999999999972, -50.00000000000044, 42.10000000000001, 5.6999999999996405, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 20.099999999999845, 39.70000000000002, 27.899999999999956, 47.1, -50.00000000000044, 40.70000000000002, 36.70000000000003, 45.7, 42.900000000000006, 29.69999999999998, -50.00000000000044], "episode_lengths": [220, 102, 36, 178, 54, 500, 86, 110, 58, 68, 34, 500, 58, 102, 500, 358, 64, 84, 140, 90, 46, 58, 500, 40, 58, 500, 104, 500, 64, 500, 342, 70, 72, 84, 158, 500, 242, 36, 500, 40, 62, 500, 500, 80, 86, 500, 500, 94, 60, 104, 232, 102, 500, 122, 54, 92, 140, 84, 238, 48, 102, 42, 500, 500, 500, 182, 98, 500, 66, 500, 500, 92, 70, 500, 500, 46, 500, 50, 500, 70, 468, 388, 500, 80, 444, 108, 500, 80, 500, 300, 104, 222, 30, 500, 94, 134, 44, 72, 204, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3868643781071488, "mean_inference_ms": 1.2407302933759154, "mean_action_processing_ms": 0.14530437412748884, "mean_env_wait_ms": 0.08703809276628557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995161056518555, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.10499453544616699}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.626999999999862, "episode_len_mean": 229.44, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.09999999999996, 39.90000000000002, 46.5, 32.30000000000002, 44.7, -50.00000000000044, 41.500000000000014, 39.10000000000002, 44.300000000000004, 43.30000000000001, 46.699999999999996, -50.00000000000044, 44.300000000000004, 39.90000000000002, -50.00000000000044, 14.299999999999763, 43.7, 41.70000000000002, 36.10000000000004, 41.100000000000016, 45.5, 44.300000000000004, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 15.899999999999785, 43.10000000000001, 42.900000000000006, 41.70000000000002, 34.30000000000004, -50.00000000000044, 25.899999999999928, 46.5, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 39.70000000000002, 26.89999999999994, 39.90000000000002, -50.00000000000044, 37.90000000000003, 44.7, 40.90000000000002, 36.10000000000004, 41.70000000000002, 26.299999999999933, 45.3, 39.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 40.30000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 3.2999999999996064, 11.29999999999972, -50.00000000000044, 42.10000000000001, 5.6999999999996405, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 20.099999999999845, 39.70000000000002, 27.899999999999956, 47.1, -50.00000000000044, 40.70000000000002, 36.70000000000003, 45.7, 42.900000000000006, 29.69999999999998, -50.00000000000044], "episode_lengths": [220, 102, 36, 178, 54, 500, 86, 110, 58, 68, 34, 500, 58, 102, 500, 358, 64, 84, 140, 90, 46, 58, 500, 40, 58, 500, 104, 500, 64, 500, 342, 70, 72, 84, 158, 500, 242, 36, 500, 40, 62, 500, 500, 80, 86, 500, 500, 94, 60, 104, 232, 102, 500, 122, 54, 92, 140, 84, 238, 48, 102, 42, 500, 500, 500, 182, 98, 500, 66, 500, 500, 92, 70, 500, 500, 46, 500, 50, 500, 70, 468, 388, 500, 80, 444, 108, 500, 80, 500, 300, 104, 222, 30, 500, 94, 134, 44, 72, 204, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3868643781071488, "mean_inference_ms": 1.2407302933759154, "mean_action_processing_ms": 0.14530437412748884, "mean_env_wait_ms": 0.08703809276628557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995161056518555, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.10499453544616699}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5321.386713821606, "num_env_steps_trained_throughput_per_sec": 5321.386713821606, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3359.735, "sample_time_ms": 2925.667, "load_time_ms": 17.166, "load_throughput": 1048566.291, "learn_time_ms": 404.071, "learn_throughput": 44546.669, "synch_weights_time_ms": 10.663}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 354, "training_iteration": 6, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-19", "timestamp": 1698250639, "time_this_iter_s": 3.3885788917541504, "time_total_s": 20.191426992416382, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.191426992416382, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.3, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003124999999999999, "cur_lr": 0.0003, "total_loss": 6.7229504055447045, "policy_loss": -0.000625974726345804, "vf_loss": 6.723630248175727, "vf_explained_var": -7.510185241699219e-07, "kl": 0.0011780532202010363, "entropy": 0.575279868973626, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.912999999999829, "episode_len_mean": 256.52, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 3.2999999999996064, 11.29999999999972, -50.00000000000044, 42.10000000000001, 5.6999999999996405, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 20.099999999999845, 39.70000000000002, 27.899999999999956, 47.1, -50.00000000000044, 40.70000000000002, 36.70000000000003, 45.7, 42.900000000000006, 29.69999999999998, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 30.099999999999987, 38.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 28.89999999999997, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 34.50000000000004, 46.099999999999994, 40.90000000000002, 31.300000000000004, 45.5, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 29.899999999999984, 14.699999999999768, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.100000000000016, 21.09999999999986, 18.899999999999828, 42.900000000000006, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, 44.7, 46.099999999999994, 41.90000000000001, 44.900000000000006, 45.5, 45.3, 47.1, 41.100000000000016, 35.70000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.3], "episode_lengths": [70, 500, 500, 46, 500, 50, 500, 70, 468, 388, 500, 80, 444, 108, 500, 80, 500, 300, 104, 222, 30, 500, 94, 134, 44, 72, 204, 500, 500, 74, 500, 500, 200, 118, 500, 82, 500, 500, 64, 42, 212, 500, 100, 500, 74, 110, 500, 206, 500, 156, 40, 92, 188, 46, 500, 226, 500, 56, 40, 500, 500, 500, 500, 48, 202, 354, 42, 500, 66, 500, 500, 108, 500, 180, 290, 312, 72, 500, 92, 96, 52, 500, 500, 58, 38, 54, 40, 82, 52, 46, 48, 30, 90, 144, 500, 84, 500, 290, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38586755842029996, "mean_inference_ms": 1.2410424472853612, "mean_action_processing_ms": 0.14618225946974509, "mean_env_wait_ms": 0.08577132304843449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199411392211914, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.10596799850463867}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.912999999999829, "episode_len_mean": 256.52, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, -50.00000000000044, 43.10000000000001, 3.2999999999996064, 11.29999999999972, -50.00000000000044, 42.10000000000001, 5.6999999999996405, 39.300000000000026, -50.00000000000044, 42.10000000000001, -50.00000000000044, 20.099999999999845, 39.70000000000002, 27.899999999999956, 47.1, -50.00000000000044, 40.70000000000002, 36.70000000000003, 45.7, 42.900000000000006, 29.69999999999998, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 30.099999999999987, 38.300000000000026, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 28.89999999999997, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.70000000000001, 39.10000000000002, -50.00000000000044, 29.49999999999998, -50.00000000000044, 34.50000000000004, 46.099999999999994, 40.90000000000002, 31.300000000000004, 45.5, -50.00000000000044, 27.49999999999995, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 29.899999999999984, 14.699999999999768, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.100000000000016, 21.09999999999986, 18.899999999999828, 42.900000000000006, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, 44.7, 46.099999999999994, 41.90000000000001, 44.900000000000006, 45.5, 45.3, 47.1, 41.100000000000016, 35.70000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.3], "episode_lengths": [70, 500, 500, 46, 500, 50, 500, 70, 468, 388, 500, 80, 444, 108, 500, 80, 500, 300, 104, 222, 30, 500, 94, 134, 44, 72, 204, 500, 500, 74, 500, 500, 200, 118, 500, 82, 500, 500, 64, 42, 212, 500, 100, 500, 74, 110, 500, 206, 500, 156, 40, 92, 188, 46, 500, 226, 500, 56, 40, 500, 500, 500, 500, 48, 202, 354, 42, 500, 66, 500, 500, 108, 500, 180, 290, 312, 72, 500, 92, 96, 52, 500, 500, 58, 38, 54, 40, 82, 52, 46, 48, 30, 90, 144, 500, 84, 500, 290, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38586755842029996, "mean_inference_ms": 1.2410424472853612, "mean_action_processing_ms": 0.14618225946974509, "mean_env_wait_ms": 0.08577132304843449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199411392211914, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.10596799850463867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5346.047959267274, "num_env_steps_trained_throughput_per_sec": 5346.047959267274, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3360.769, "sample_time_ms": 2914.282, "load_time_ms": 16.428, "load_throughput": 1095683.885, "learn_time_ms": 417.346, "learn_throughput": 43129.65, "synch_weights_time_ms": 10.568}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 426, "training_iteration": 7, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-22", "timestamp": 1698250642, "time_this_iter_s": 3.3719701766967773, "time_total_s": 23.56339716911316, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.56339716911316, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.78000000000001, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015624999999999994, "cur_lr": 0.0003, "total_loss": 6.241169410281711, "policy_loss": -0.00045435925324757893, "vf_loss": 6.241672960917155, "vf_explained_var": 2.49942143758138e-06, "kl": 0.0016390307113848873, "entropy": 0.5184327079190149, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9289999999998075, "episode_len_mean": 276.3, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 29.899999999999984, 14.699999999999768, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.100000000000016, 21.09999999999986, 18.899999999999828, 42.900000000000006, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, 44.7, 46.099999999999994, 41.90000000000001, 44.900000000000006, 45.5, 45.3, 47.1, 41.100000000000016, 35.70000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.3, 37.10000000000003, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 37.90000000000003, 45.7, 14.499999999999766, 36.30000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.500000000000014, 41.500000000000014, 39.10000000000002, 44.7, 45.5, -50.00000000000044, 37.70000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 22.49999999999988, -50.00000000000044, 47.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 29.899999999999984, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 16.8999999999998, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 45.7], "episode_lengths": [56, 40, 500, 500, 500, 500, 48, 202, 354, 42, 500, 66, 500, 500, 108, 500, 180, 290, 312, 72, 500, 92, 96, 52, 500, 500, 58, 38, 54, 40, 82, 52, 46, 48, 30, 90, 144, 500, 84, 500, 290, 500, 48, 130, 44, 500, 44, 500, 122, 44, 356, 138, 500, 500, 200, 500, 500, 500, 72, 500, 500, 148, 76, 86, 110, 54, 46, 500, 124, 88, 500, 500, 500, 88, 500, 500, 126, 276, 500, 28, 500, 174, 500, 202, 500, 254, 500, 500, 500, 210, 332, 54, 500, 500, 500, 500, 36, 500, 310, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855201045059256, "mean_inference_ms": 1.2401430911336992, "mean_action_processing_ms": 0.14537783363188284, "mean_env_wait_ms": 0.0856101121601188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.013011932373046875, "ViewRequirementAgentConnector_ms": 0.10999798774719238}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9289999999998075, "episode_len_mean": 276.3, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 29.899999999999984, 14.699999999999768, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.100000000000016, 21.09999999999986, 18.899999999999828, 42.900000000000006, -50.00000000000044, 40.90000000000002, 40.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, 44.7, 46.099999999999994, 41.90000000000001, 44.900000000000006, 45.5, 45.3, 47.1, 41.100000000000016, 35.70000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 21.09999999999986, -50.00000000000044, 45.3, 37.10000000000003, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 37.90000000000003, 45.7, 14.499999999999766, 36.30000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, 42.500000000000014, 41.500000000000014, 39.10000000000002, 44.7, 45.5, -50.00000000000044, 37.70000000000003, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 22.49999999999988, -50.00000000000044, 47.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 29.899999999999984, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 16.8999999999998, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 45.7], "episode_lengths": [56, 40, 500, 500, 500, 500, 48, 202, 354, 42, 500, 66, 500, 500, 108, 500, 180, 290, 312, 72, 500, 92, 96, 52, 500, 500, 58, 38, 54, 40, 82, 52, 46, 48, 30, 90, 144, 500, 84, 500, 290, 500, 48, 130, 44, 500, 44, 500, 122, 44, 356, 138, 500, 500, 200, 500, 500, 500, 72, 500, 500, 148, 76, 86, 110, 54, 46, 500, 124, 88, 500, 500, 500, 88, 500, 500, 126, 276, 500, 28, 500, 174, 500, 202, 500, 254, 500, 500, 500, 210, 332, 54, 500, 500, 500, 500, 36, 500, 310, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855201045059256, "mean_inference_ms": 1.2401430911336992, "mean_action_processing_ms": 0.14537783363188284, "mean_env_wait_ms": 0.0856101121601188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.013011932373046875, "ViewRequirementAgentConnector_ms": 0.10999798774719238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5295.677537291411, "num_env_steps_trained_throughput_per_sec": 5295.677537291411, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3365.548, "sample_time_ms": 2913.747, "load_time_ms": 16.875, "load_throughput": 1066674.277, "learn_time_ms": 422.303, "learn_throughput": 42623.449, "synch_weights_time_ms": 10.372}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 483, "training_iteration": 8, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-26", "timestamp": 1698250646, "time_this_iter_s": 3.4049971103668213, "time_total_s": 26.96839427947998, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.96839427947998, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.9, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812499999999997, "cur_lr": 0.0003, "total_loss": 6.8689098887973365, "policy_loss": -0.0004530833827124702, "vf_loss": 6.8694128354390465, "vf_explained_var": 1.0172526041666667e-06, "kl": 0.001023970166140013, "entropy": 0.5067698326375749, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6099999999998085, "episode_len_mean": 274.5, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.50000000000003, 22.49999999999988, -50.00000000000044, 47.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 29.899999999999984, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 16.8999999999998, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 45.7, -50.00000000000044, 34.50000000000004, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 20.899999999999856, 31.1, 46.099999999999994, -50.00000000000044, 33.30000000000003, 42.30000000000001, 19.299999999999834, -50.00000000000044, 34.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 44.7, 44.300000000000004, -50.00000000000044, 4.699999999999626, 44.10000000000001, -50.00000000000044, 43.10000000000001, 36.50000000000003, -50.00000000000044, 26.89999999999994, 44.900000000000006, 14.09999999999976, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016, 41.90000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 39.300000000000026, 35.900000000000034, -50.00000000000044, 23.699999999999896, 41.100000000000016, 44.7, 45.5, 46.3, 46.099999999999994, 44.7, 39.50000000000002, 43.50000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [500, 500, 126, 276, 500, 28, 500, 174, 500, 202, 500, 254, 500, 500, 500, 210, 332, 54, 500, 500, 500, 500, 36, 500, 310, 44, 500, 156, 380, 500, 500, 500, 54, 292, 190, 40, 500, 168, 78, 308, 500, 152, 32, 500, 500, 84, 46, 500, 42, 500, 58, 54, 58, 500, 454, 60, 500, 70, 136, 500, 232, 52, 360, 78, 54, 500, 500, 500, 500, 28, 500, 90, 82, 88, 500, 500, 44, 44, 108, 142, 500, 264, 90, 54, 46, 38, 40, 54, 106, 66, 52, 76, 500, 500, 106, 500, 48, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38426663247071846, "mean_inference_ms": 1.2368524459862764, "mean_action_processing_ms": 0.14464099020336219, "mean_env_wait_ms": 0.08565581717963525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799391746520996, "StateBufferConnector_ms": 0.007992267608642578, "ViewRequirementAgentConnector_ms": 0.10202550888061523}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6099999999998085, "episode_len_mean": 274.5, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.50000000000003, 22.49999999999988, -50.00000000000044, 47.3, -50.00000000000044, 32.700000000000024, -50.00000000000044, 29.899999999999984, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 16.8999999999998, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 19.09999999999983, 45.7, -50.00000000000044, 34.50000000000004, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 20.899999999999856, 31.1, 46.099999999999994, -50.00000000000044, 33.30000000000003, 42.30000000000001, 19.299999999999834, -50.00000000000044, 34.900000000000034, 46.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 44.300000000000004, 44.7, 44.300000000000004, -50.00000000000044, 4.699999999999626, 44.10000000000001, -50.00000000000044, 43.10000000000001, 36.50000000000003, -50.00000000000044, 26.89999999999994, 44.900000000000006, 14.09999999999976, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016, 41.90000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 39.300000000000026, 35.900000000000034, -50.00000000000044, 23.699999999999896, 41.100000000000016, 44.7, 45.5, 46.3, 46.099999999999994, 44.7, 39.50000000000002, 43.50000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [500, 500, 126, 276, 500, 28, 500, 174, 500, 202, 500, 254, 500, 500, 500, 210, 332, 54, 500, 500, 500, 500, 36, 500, 310, 44, 500, 156, 380, 500, 500, 500, 54, 292, 190, 40, 500, 168, 78, 308, 500, 152, 32, 500, 500, 84, 46, 500, 42, 500, 58, 54, 58, 500, 454, 60, 500, 70, 136, 500, 232, 52, 360, 78, 54, 500, 500, 500, 500, 28, 500, 90, 82, 88, 500, 500, 44, 44, 108, 142, 500, 264, 90, 54, 46, 38, 40, 54, 106, 66, 52, 76, 500, 500, 106, 500, 48, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38426663247071846, "mean_inference_ms": 1.2368524459862764, "mean_action_processing_ms": 0.14464099020336219, "mean_env_wait_ms": 0.08565581717963525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799391746520996, "StateBufferConnector_ms": 0.007992267608642578, "ViewRequirementAgentConnector_ms": 0.10202550888061523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5327.063510672159, "num_env_steps_trained_throughput_per_sec": 5327.063510672159, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3367.039, "sample_time_ms": 2908.216, "load_time_ms": 17.111, "load_throughput": 1051936.352, "learn_time_ms": 429.269, "learn_throughput": 41931.749, "synch_weights_time_ms": 10.22}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 557, "training_iteration": 9, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-29", "timestamp": 1698250649, "time_this_iter_s": 3.3839704990386963, "time_total_s": 30.352364778518677, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.352364778518677, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.959999999999994, "ram_util_percent": 26.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062499999999986, "cur_lr": 0.0003, "total_loss": 6.280148813459609, "policy_loss": 2.0664185285568237e-05, "vf_loss": 6.2801787270439995, "vf_explained_var": -2.227889166937934e-06, "kl": 0.00048659708149393233, "entropy": 0.5091575112607744, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.235999999999813, "episode_len_mean": 268.24, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, 26.89999999999994, 44.900000000000006, 14.09999999999976, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016, 41.90000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 39.300000000000026, 35.900000000000034, -50.00000000000044, 23.699999999999896, 41.100000000000016, 44.7, 45.5, 46.3, 46.099999999999994, 44.7, 39.50000000000002, 43.50000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 44.900000000000006, 25.899999999999928, -50.00000000000044, 43.50000000000001, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, 46.5, 33.10000000000003, -50.00000000000044, 38.90000000000002, 43.10000000000001, -50.00000000000044, 43.900000000000006, 42.900000000000006, 31.70000000000001, 16.09999999999979, -50.00000000000044, 45.7, 37.10000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.10000000000001, 38.700000000000024, 26.09999999999993, 42.10000000000001, 43.10000000000001, -50.00000000000044, 17.899999999999814, 24.499999999999908, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.5, 45.5, 46.5, 35.900000000000034, -50.00000000000044], "episode_lengths": [136, 500, 232, 52, 360, 78, 54, 500, 500, 500, 500, 28, 500, 90, 82, 88, 500, 500, 44, 44, 108, 142, 500, 264, 90, 54, 46, 38, 40, 54, 106, 66, 52, 76, 500, 500, 106, 500, 48, 500, 500, 50, 500, 500, 500, 36, 500, 500, 500, 500, 500, 56, 500, 70, 52, 242, 500, 66, 500, 454, 500, 500, 36, 170, 500, 112, 70, 500, 62, 72, 184, 340, 500, 44, 130, 40, 500, 500, 500, 500, 500, 70, 60, 114, 240, 80, 70, 500, 322, 256, 196, 500, 500, 500, 282, 46, 46, 36, 142, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840351118189719, "mean_inference_ms": 1.2353886624293333, "mean_action_processing_ms": 0.14473597961817025, "mean_env_wait_ms": 0.08556162157816598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996135711669922, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.10299158096313477}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.235999999999813, "episode_len_mean": 268.24, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, 26.89999999999994, 44.900000000000006, 14.09999999999976, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 41.100000000000016, 41.90000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 39.300000000000026, 35.900000000000034, -50.00000000000044, 23.699999999999896, 41.100000000000016, 44.7, 45.5, 46.3, 46.099999999999994, 44.7, 39.50000000000002, 43.50000000000001, 44.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 44.900000000000006, 25.899999999999928, -50.00000000000044, 43.50000000000001, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, 46.5, 33.10000000000003, -50.00000000000044, 38.90000000000002, 43.10000000000001, -50.00000000000044, 43.900000000000006, 42.900000000000006, 31.70000000000001, 16.09999999999979, -50.00000000000044, 45.7, 37.10000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.10000000000001, 38.700000000000024, 26.09999999999993, 42.10000000000001, 43.10000000000001, -50.00000000000044, 17.899999999999814, 24.499999999999908, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.5, 45.5, 46.5, 35.900000000000034, -50.00000000000044], "episode_lengths": [136, 500, 232, 52, 360, 78, 54, 500, 500, 500, 500, 28, 500, 90, 82, 88, 500, 500, 44, 44, 108, 142, 500, 264, 90, 54, 46, 38, 40, 54, 106, 66, 52, 76, 500, 500, 106, 500, 48, 500, 500, 50, 500, 500, 500, 36, 500, 500, 500, 500, 500, 56, 500, 70, 52, 242, 500, 66, 500, 454, 500, 500, 36, 170, 500, 112, 70, 500, 62, 72, 184, 340, 500, 44, 130, 40, 500, 500, 500, 500, 500, 70, 60, 114, 240, 80, 70, 500, 322, 256, 196, 500, 500, 500, 282, 46, 46, 36, 142, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840351118189719, "mean_inference_ms": 1.2353886624293333, "mean_action_processing_ms": 0.14473597961817025, "mean_env_wait_ms": 0.08556162157816598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996135711669922, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.10299158096313477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5339.64247951595, "num_env_steps_trained_throughput_per_sec": 5339.64247951595, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3367.437, "sample_time_ms": 2902.094, "load_time_ms": 17.6, "load_throughput": 1022719.658, "learn_time_ms": 435.445, "learn_throughput": 41337.019, "synch_weights_time_ms": 10.096}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 615, "training_iteration": 10, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-33", "timestamp": 1698250653, "time_this_iter_s": 3.377028703689575, "time_total_s": 33.72939348220825, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.72939348220825, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 55.160000000000004, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531249999999993, "cur_lr": 0.0003, "total_loss": 6.72404670715332, "policy_loss": -0.00028115008026361463, "vf_loss": 6.724380662706163, "vf_explained_var": -1.7099910312228733e-06, "kl": 0.0009338545641293155, "entropy": 0.5304327468077342, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.428999999999839, "episode_len_mean": 241.38, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.10000000000001, 38.700000000000024, 26.09999999999993, 42.10000000000001, 43.10000000000001, -50.00000000000044, 17.899999999999814, 24.499999999999908, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.5, 45.5, 46.5, 35.900000000000034, -50.00000000000044, 18.899999999999828, 36.30000000000003, 44.10000000000001, 41.500000000000014, 28.699999999999967, 41.70000000000002, 40.500000000000014, -50.00000000000044, 46.699999999999996, 43.10000000000001, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 44.300000000000004, 41.30000000000001, 29.099999999999973, 43.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 37.10000000000003, 44.300000000000004, -50.00000000000044, 26.09999999999993, 43.900000000000006, 40.500000000000014, 46.3, -50.00000000000044, 46.699999999999996, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 47.1, 16.29999999999979, 42.70000000000001, 19.09999999999983, 41.30000000000001, 47.3, 45.9, -50.00000000000044, 5.299999999999635, 46.099999999999994, 44.7, -50.00000000000044, 37.90000000000003, 46.099999999999994, 46.699999999999996, 43.50000000000001, 45.7, 44.5, 26.299999999999933, 14.499999999999766, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044], "episode_lengths": [500, 500, 500, 70, 60, 114, 240, 80, 70, 500, 322, 256, 196, 500, 500, 500, 282, 46, 46, 36, 142, 500, 312, 138, 60, 86, 214, 84, 96, 500, 34, 70, 500, 50, 54, 500, 38, 32, 500, 58, 88, 210, 70, 48, 500, 500, 30, 500, 200, 500, 50, 500, 500, 500, 500, 500, 160, 500, 130, 58, 500, 240, 62, 96, 38, 500, 34, 30, 500, 42, 500, 500, 134, 500, 132, 500, 30, 338, 74, 310, 88, 28, 42, 500, 448, 40, 54, 500, 122, 40, 34, 66, 44, 56, 238, 356, 40, 500, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838741419280488, "mean_inference_ms": 1.231650060450109, "mean_action_processing_ms": 0.14442096699329235, "mean_env_wait_ms": 0.08523695354242211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.13699102401733398}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.428999999999839, "episode_len_mean": 241.38, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 44.10000000000001, 38.700000000000024, 26.09999999999993, 42.10000000000001, 43.10000000000001, -50.00000000000044, 17.899999999999814, 24.499999999999908, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.5, 45.5, 46.5, 35.900000000000034, -50.00000000000044, 18.899999999999828, 36.30000000000003, 44.10000000000001, 41.500000000000014, 28.699999999999967, 41.70000000000002, 40.500000000000014, -50.00000000000044, 46.699999999999996, 43.10000000000001, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 46.3, 46.9, -50.00000000000044, 44.300000000000004, 41.30000000000001, 29.099999999999973, 43.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 37.10000000000003, 44.300000000000004, -50.00000000000044, 26.09999999999993, 43.900000000000006, 40.500000000000014, 46.3, -50.00000000000044, 46.699999999999996, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 47.1, 16.29999999999979, 42.70000000000001, 19.09999999999983, 41.30000000000001, 47.3, 45.9, -50.00000000000044, 5.299999999999635, 46.099999999999994, 44.7, -50.00000000000044, 37.90000000000003, 46.099999999999994, 46.699999999999996, 43.50000000000001, 45.7, 44.5, 26.299999999999933, 14.499999999999766, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044], "episode_lengths": [500, 500, 500, 70, 60, 114, 240, 80, 70, 500, 322, 256, 196, 500, 500, 500, 282, 46, 46, 36, 142, 500, 312, 138, 60, 86, 214, 84, 96, 500, 34, 70, 500, 50, 54, 500, 38, 32, 500, 58, 88, 210, 70, 48, 500, 500, 30, 500, 200, 500, 50, 500, 500, 500, 500, 500, 160, 500, 130, 58, 500, 240, 62, 96, 38, 500, 34, 30, 500, 42, 500, 500, 134, 500, 132, 500, 30, 338, 74, 310, 88, 28, 42, 500, 448, 40, 54, 500, 122, 40, 34, 66, 44, 56, 238, 356, 40, 500, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838741419280488, "mean_inference_ms": 1.231650060450109, "mean_action_processing_ms": 0.14442096699329235, "mean_env_wait_ms": 0.08523695354242211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018995285034179688, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.13699102401733398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5738.02144115804, "num_env_steps_trained_throughput_per_sec": 5738.02144115804, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3359.774, "sample_time_ms": 2895.091, "load_time_ms": 17.5, "load_throughput": 1028580.117, "learn_time_ms": 435.289, "learn_throughput": 41351.828, "synch_weights_time_ms": 9.892}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 693, "training_iteration": 11, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-36", "timestamp": 1698250656, "time_this_iter_s": 3.1439661979675293, "time_total_s": 36.87335968017578, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.87335968017578, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 60.974999999999994, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765624999999996e-05, "cur_lr": 0.0003, "total_loss": 6.601720269521078, "policy_loss": -0.0005025515539778604, "vf_loss": 6.602271101209852, "vf_explained_var": -7.735358344184028e-07, "kl": 0.0009223287713167889, "entropy": 0.4825193875365787, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.861999999999823, "episode_len_mean": 252.04, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 46.699999999999996, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 47.1, 16.29999999999979, 42.70000000000001, 19.09999999999983, 41.30000000000001, 47.3, 45.9, -50.00000000000044, 5.299999999999635, 46.099999999999994, 44.7, -50.00000000000044, 37.90000000000003, 46.099999999999994, 46.699999999999996, 43.50000000000001, 45.7, 44.5, 26.299999999999933, 14.499999999999766, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 7.899999999999672, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 4.699999999999626, 24.899999999999913, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.299999999999578, 37.70000000000003, 35.900000000000034, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, 28.89999999999997, 31.500000000000007, 47.1, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, 42.500000000000014, 40.70000000000002, 40.10000000000002, 30.29999999999999, 47.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 14.899999999999771, 43.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 44.300000000000004, 23.099999999999888, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014], "episode_lengths": [38, 500, 34, 30, 500, 42, 500, 500, 134, 500, 132, 500, 30, 338, 74, 310, 88, 28, 42, 500, 448, 40, 54, 500, 122, 40, 34, 66, 44, 56, 238, 356, 40, 500, 52, 500, 500, 500, 58, 500, 422, 500, 50, 88, 500, 500, 454, 252, 50, 500, 34, 500, 114, 68, 500, 500, 488, 124, 142, 500, 64, 58, 500, 212, 186, 30, 500, 68, 42, 500, 34, 500, 102, 76, 94, 100, 198, 28, 96, 60, 500, 352, 68, 500, 32, 500, 38, 36, 500, 492, 500, 58, 270, 500, 40, 30, 500, 500, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846310083694705, "mean_inference_ms": 1.2317741347014748, "mean_action_processing_ms": 0.14417702596585033, "mean_env_wait_ms": 0.08476424333611289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11703085899353027}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.861999999999823, "episode_len_mean": 252.04, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, 46.699999999999996, 47.1, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 47.1, 16.29999999999979, 42.70000000000001, 19.09999999999983, 41.30000000000001, 47.3, 45.9, -50.00000000000044, 5.299999999999635, 46.099999999999994, 44.7, -50.00000000000044, 37.90000000000003, 46.099999999999994, 46.699999999999996, 43.50000000000001, 45.7, 44.5, 26.299999999999933, 14.499999999999766, 46.099999999999994, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 7.899999999999672, -50.00000000000044, 45.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 4.699999999999626, 24.899999999999913, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.700000000000024, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.299999999999578, 37.70000000000003, 35.900000000000034, -50.00000000000044, 43.7, 44.300000000000004, -50.00000000000044, 28.89999999999997, 31.500000000000007, 47.1, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, 42.500000000000014, 40.70000000000002, 40.10000000000002, 30.29999999999999, 47.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 14.899999999999771, 43.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 44.300000000000004, 23.099999999999888, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014], "episode_lengths": [38, 500, 34, 30, 500, 42, 500, 500, 134, 500, 132, 500, 30, 338, 74, 310, 88, 28, 42, 500, 448, 40, 54, 500, 122, 40, 34, 66, 44, 56, 238, 356, 40, 500, 52, 500, 500, 500, 58, 500, 422, 500, 50, 88, 500, 500, 454, 252, 50, 500, 34, 500, 114, 68, 500, 500, 488, 124, 142, 500, 64, 58, 500, 212, 186, 30, 500, 68, 42, 500, 34, 500, 102, 76, 94, 100, 198, 28, 96, 60, 500, 352, 68, 500, 32, 500, 38, 36, 500, 492, 500, 58, 270, 500, 40, 30, 500, 500, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846310083694705, "mean_inference_ms": 1.2317741347014748, "mean_action_processing_ms": 0.14417702596585033, "mean_env_wait_ms": 0.08476424333611289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999359130859375, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.11703085899353027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5328.615198284057, "num_env_steps_trained_throughput_per_sec": 5328.615198284057, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3368.408, "sample_time_ms": 2885.189, "load_time_ms": 18.4, "load_throughput": 978272.197, "learn_time_ms": 452.926, "learn_throughput": 39741.586, "synch_weights_time_ms": 9.792}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 757, "training_iteration": 12, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-39", "timestamp": 1698250659, "time_this_iter_s": 3.3839826583862305, "time_total_s": 40.25734233856201, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.25734233856201, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 60.92, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812499999998e-05, "cur_lr": 0.0003, "total_loss": 6.857740751902262, "policy_loss": -0.0006011061370372773, "vf_loss": 6.858395173814562, "vf_explained_var": -2.0424524943033854e-06, "kl": 0.0015090802938352175, "entropy": 0.5345231744978163, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.3709999999998175, "episode_len_mean": 261.92, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 42.500000000000014, 40.70000000000002, 40.10000000000002, 30.29999999999999, 47.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 14.899999999999771, 43.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 44.300000000000004, 23.099999999999888, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 36.900000000000034, 40.10000000000002, 40.70000000000002, 35.900000000000034, 30.499999999999993, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 16.699999999999797, 4.899999999999629, 44.7, 13.699999999999754, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 38.90000000000002, -50.00000000000044, 45.1, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.699999999999996, 43.7, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.500000000000014, 40.500000000000014, 45.9, 35.900000000000034, 47.3, 37.50000000000003, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 46.099999999999994, 44.10000000000001, -50.00000000000044, 32.90000000000003, 46.5, 43.900000000000006, -50.00000000000044, 30.099999999999987, 44.7, 45.9, 37.50000000000003, 44.300000000000004, 45.5, 42.30000000000001, -50.00000000000044], "episode_lengths": [102, 76, 94, 100, 198, 28, 96, 60, 500, 352, 68, 500, 32, 500, 38, 36, 500, 492, 500, 58, 270, 500, 40, 30, 500, 500, 500, 86, 500, 42, 500, 500, 440, 500, 500, 132, 100, 94, 142, 196, 204, 500, 500, 500, 500, 500, 500, 112, 334, 452, 54, 364, 62, 500, 82, 500, 70, 112, 500, 50, 500, 138, 500, 34, 64, 46, 500, 500, 500, 500, 500, 500, 26, 500, 76, 96, 42, 142, 28, 126, 500, 48, 82, 500, 472, 40, 60, 500, 172, 36, 62, 500, 200, 54, 42, 126, 58, 46, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38404392633691986, "mean_inference_ms": 1.2312290816203804, "mean_action_processing_ms": 0.14407211447537221, "mean_env_wait_ms": 0.08483294814178426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017007112503051758, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.10401368141174316}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.3709999999998175, "episode_len_mean": 261.92, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 42.500000000000014, 40.70000000000002, 40.10000000000002, 30.29999999999999, 47.3, 40.500000000000014, 44.10000000000001, -50.00000000000044, 14.899999999999771, 43.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.5, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 44.300000000000004, 23.099999999999888, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 36.900000000000034, 40.10000000000002, 40.70000000000002, 35.900000000000034, 30.499999999999993, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 16.699999999999797, 4.899999999999629, 44.7, 13.699999999999754, 43.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 38.90000000000002, -50.00000000000044, 45.1, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.699999999999996, 43.7, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.500000000000014, 40.500000000000014, 45.9, 35.900000000000034, 47.3, 37.50000000000003, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 46.099999999999994, 44.10000000000001, -50.00000000000044, 32.90000000000003, 46.5, 43.900000000000006, -50.00000000000044, 30.099999999999987, 44.7, 45.9, 37.50000000000003, 44.300000000000004, 45.5, 42.30000000000001, -50.00000000000044], "episode_lengths": [102, 76, 94, 100, 198, 28, 96, 60, 500, 352, 68, 500, 32, 500, 38, 36, 500, 492, 500, 58, 270, 500, 40, 30, 500, 500, 500, 86, 500, 42, 500, 500, 440, 500, 500, 132, 100, 94, 142, 196, 204, 500, 500, 500, 500, 500, 500, 112, 334, 452, 54, 364, 62, 500, 82, 500, 70, 112, 500, 50, 500, 138, 500, 34, 64, 46, 500, 500, 500, 500, 500, 500, 26, 500, 76, 96, 42, 142, 28, 126, 500, 48, 82, 500, 472, 40, 60, 500, 172, 36, 62, 500, 200, 54, 42, 126, 58, 46, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38404392633691986, "mean_inference_ms": 1.2312290816203804, "mean_action_processing_ms": 0.14407211447537221, "mean_env_wait_ms": 0.08483294814178426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017007112503051758, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.10401368141174316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5320.7191654352255, "num_env_steps_trained_throughput_per_sec": 5320.7191654352255, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3348.808, "sample_time_ms": 2876.588, "load_time_ms": 17.4, "load_throughput": 1034486.864, "learn_time_ms": 443.029, "learn_throughput": 40629.373, "synch_weights_time_ms": 9.689}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 829, "training_iteration": 13, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-43", "timestamp": 1698250663, "time_this_iter_s": 3.38900089263916, "time_total_s": 43.64634323120117, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 43.64634323120117, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 55.64, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.441406249999999e-05, "cur_lr": 0.0003, "total_loss": 6.430581633249918, "policy_loss": -0.0007402831481562721, "vf_loss": 6.4313729816012914, "vf_explained_var": -2.659691704644097e-06, "kl": 0.0014707969552445218, "entropy": 0.5112383140458001, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4569999999998116, "episode_len_mean": 261.02, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.500000000000014, 40.500000000000014, 45.9, 35.900000000000034, 47.3, 37.50000000000003, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 46.099999999999994, 44.10000000000001, -50.00000000000044, 32.90000000000003, 46.5, 43.900000000000006, -50.00000000000044, 30.099999999999987, 44.7, 45.9, 37.50000000000003, 44.300000000000004, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 10.299999999999706, -50.00000000000044, 36.70000000000003, 43.900000000000006, 42.500000000000014, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 45.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 45.1, 45.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 32.50000000000002, 23.8999999999999, 46.699999999999996, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 41.500000000000014, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, -50.00000000000044, 47.1, 38.300000000000026, 39.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, 46.3, 36.50000000000003, 45.7, 47.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 26, 500, 76, 96, 42, 142, 28, 126, 500, 48, 82, 500, 472, 40, 60, 500, 172, 36, 62, 500, 200, 54, 42, 126, 58, 46, 78, 500, 500, 102, 398, 500, 134, 62, 76, 68, 46, 500, 500, 22, 500, 44, 78, 500, 500, 500, 500, 38, 42, 50, 42, 500, 30, 500, 500, 58, 50, 500, 500, 176, 262, 34, 500, 500, 482, 86, 52, 38, 500, 500, 500, 500, 118, 500, 500, 500, 68, 118, 500, 30, 118, 106, 500, 60, 500, 100, 38, 136, 44, 26, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838678414782503, "mean_inference_ms": 1.2304216749078396, "mean_action_processing_ms": 0.1438723504285804, "mean_env_wait_ms": 0.08495271910419142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11499762535095215}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4569999999998116, "episode_len_mean": 261.02, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.500000000000014, 40.500000000000014, 45.9, 35.900000000000034, 47.3, 37.50000000000003, -50.00000000000044, 45.3, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 46.099999999999994, 44.10000000000001, -50.00000000000044, 32.90000000000003, 46.5, 43.900000000000006, -50.00000000000044, 30.099999999999987, 44.7, 45.9, 37.50000000000003, 44.300000000000004, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 10.299999999999706, -50.00000000000044, 36.70000000000003, 43.900000000000006, 42.500000000000014, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 45.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.9, 45.1, 45.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 32.50000000000002, 23.8999999999999, 46.699999999999996, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 41.500000000000014, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, -50.00000000000044, 47.1, 38.300000000000026, 39.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, 46.3, 36.50000000000003, 45.7, 47.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 26, 500, 76, 96, 42, 142, 28, 126, 500, 48, 82, 500, 472, 40, 60, 500, 172, 36, 62, 500, 200, 54, 42, 126, 58, 46, 78, 500, 500, 102, 398, 500, 134, 62, 76, 68, 46, 500, 500, 22, 500, 44, 78, 500, 500, 500, 500, 38, 42, 50, 42, 500, 30, 500, 500, 58, 50, 500, 500, 176, 262, 34, 500, 500, 482, 86, 52, 38, 500, 500, 500, 500, 118, 500, 500, 500, 68, 118, 500, 30, 118, 106, 500, 60, 500, 100, 38, 136, 44, 26, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838678414782503, "mean_inference_ms": 1.2304216749078396, "mean_action_processing_ms": 0.1438723504285804, "mean_env_wait_ms": 0.08495271910419142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11499762535095215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5385.992554668228, "num_env_steps_trained_throughput_per_sec": 5385.992554668228, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3343.05, "sample_time_ms": 2867.488, "load_time_ms": 18.703, "load_throughput": 962398.556, "learn_time_ms": 445.57, "learn_throughput": 40397.67, "synch_weights_time_ms": 9.187}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 895, "training_iteration": 14, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-46", "timestamp": 1698250666, "time_this_iter_s": 3.3470005989074707, "time_total_s": 46.99334383010864, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 46.99334383010864, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 53.339999999999996, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031249999996e-05, "cur_lr": 0.0003, "total_loss": 6.885272630055746, "policy_loss": -0.0005327453390539934, "vf_loss": 6.885855007171631, "vf_explained_var": 3.761715359157986e-07, "kl": 0.0010472493091204646, "entropy": 0.4951736476686266, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.820999999999835, "episode_len_mean": 247.44, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, -50.00000000000044, 47.1, 38.300000000000026, 39.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, 46.3, 36.50000000000003, 45.7, 47.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 46.5, 39.90000000000002, 1.099999999999575, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 26.499999999999936, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.300000000000004, 46.5, 24.899999999999913, 43.10000000000001, 41.70000000000002, -50.00000000000044, 44.7, 45.7, 47.5, 41.70000000000002, -50.00000000000044, 45.7, 33.90000000000004, 47.1, 45.1, 41.90000000000001, 19.69999999999984, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, 45.5, 39.90000000000002, 36.10000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 16.29999999999979, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, 45.1, 21.299999999999862, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 25.899999999999928, 31.500000000000007, 1.299999999999578, 44.10000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 23.099999999999888, 43.30000000000001], "episode_lengths": [500, 500, 500, 118, 500, 500, 500, 68, 118, 500, 30, 118, 106, 500, 60, 500, 100, 38, 136, 44, 26, 500, 500, 58, 500, 64, 36, 102, 490, 82, 500, 52, 500, 236, 500, 152, 500, 58, 36, 252, 70, 84, 500, 54, 44, 26, 84, 500, 44, 162, 30, 50, 82, 304, 52, 500, 500, 54, 500, 62, 46, 102, 140, 122, 500, 500, 126, 500, 68, 500, 338, 36, 54, 500, 500, 500, 500, 86, 80, 500, 108, 500, 86, 50, 288, 500, 48, 500, 54, 242, 186, 488, 60, 208, 500, 500, 50, 58, 270, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38306678962296475, "mean_inference_ms": 1.2264780453915411, "mean_action_processing_ms": 0.1435712418580833, "mean_env_wait_ms": 0.08494840117011089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199721336364746, "StateBufferConnector_ms": 0.003979682922363281, "ViewRequirementAgentConnector_ms": 0.10904264450073242}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.820999999999835, "episode_len_mean": 247.44, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, -50.00000000000044, 47.1, 38.300000000000026, 39.50000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, 46.3, 36.50000000000003, 45.7, 47.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 46.5, 39.90000000000002, 1.099999999999575, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 26.499999999999936, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.300000000000004, 46.5, 24.899999999999913, 43.10000000000001, 41.70000000000002, -50.00000000000044, 44.7, 45.7, 47.5, 41.70000000000002, -50.00000000000044, 45.7, 33.90000000000004, 47.1, 45.1, 41.90000000000001, 19.69999999999984, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, 45.5, 39.90000000000002, 36.10000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 16.29999999999979, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, 45.1, 21.299999999999862, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 25.899999999999928, 31.500000000000007, 1.299999999999578, 44.10000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 23.099999999999888, 43.30000000000001], "episode_lengths": [500, 500, 500, 118, 500, 500, 500, 68, 118, 500, 30, 118, 106, 500, 60, 500, 100, 38, 136, 44, 26, 500, 500, 58, 500, 64, 36, 102, 490, 82, 500, 52, 500, 236, 500, 152, 500, 58, 36, 252, 70, 84, 500, 54, 44, 26, 84, 500, 44, 162, 30, 50, 82, 304, 52, 500, 500, 54, 500, 62, 46, 102, 140, 122, 500, 500, 126, 500, 68, 500, 338, 36, 54, 500, 500, 500, 500, 86, 80, 500, 108, 500, 86, 50, 288, 500, 48, 500, 54, 242, 186, 488, 60, 208, 500, 500, 50, 58, 270, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38306678962296475, "mean_inference_ms": 1.2264780453915411, "mean_action_processing_ms": 0.1435712418580833, "mean_env_wait_ms": 0.08494840117011089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199721336364746, "StateBufferConnector_ms": 0.003979682922363281, "ViewRequirementAgentConnector_ms": 0.10904264450073242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5319.148087716323, "num_env_steps_trained_throughput_per_sec": 5319.148087716323, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3352.25, "sample_time_ms": 2870.988, "load_time_ms": 18.003, "load_throughput": 999832.764, "learn_time_ms": 451.971, "learn_throughput": 39825.603, "synch_weights_time_ms": 9.286}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 970, "training_iteration": 15, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-49", "timestamp": 1698250669, "time_this_iter_s": 3.3899998664855957, "time_total_s": 50.38334369659424, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.38334369659424, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 66.0, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515624999998e-06, "cur_lr": 0.0003, "total_loss": 6.412773651546902, "policy_loss": -0.0006464090405238999, "vf_loss": 6.413468933105468, "vf_explained_var": -8.662541707356771e-07, "kl": 0.0013125645167229372, "entropy": 0.4880087594191233, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.212999999999801, "episode_len_mean": 283.46, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, 45.5, 39.90000000000002, 36.10000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 16.29999999999979, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, 45.1, 21.299999999999862, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 25.899999999999928, 31.500000000000007, 1.299999999999578, 44.10000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 23.099999999999888, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.499999999999623, -50.00000000000044, 44.900000000000006, 44.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 38.90000000000002, 21.09999999999986, -50.00000000000044, -50.00000000000044, 34.30000000000004, 18.099999999999817, 37.300000000000026, 14.899999999999771, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.9, 38.50000000000003, 42.30000000000001, 33.30000000000003, -50.00000000000044, 37.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, -50.00000000000044, 21.499999999999865, 42.30000000000001], "episode_lengths": [500, 54, 500, 62, 46, 102, 140, 122, 500, 500, 126, 500, 68, 500, 338, 36, 54, 500, 500, 500, 500, 86, 80, 500, 108, 500, 86, 50, 288, 500, 48, 500, 54, 242, 186, 488, 60, 208, 500, 500, 50, 58, 270, 68, 500, 46, 500, 500, 92, 456, 500, 52, 56, 40, 500, 56, 500, 500, 500, 500, 500, 194, 500, 40, 38, 500, 40, 500, 500, 190, 500, 112, 290, 500, 500, 158, 320, 128, 352, 500, 500, 64, 500, 32, 116, 78, 168, 500, 128, 44, 500, 500, 36, 178, 500, 40, 360, 500, 286, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821770512473439, "mean_inference_ms": 1.2271393774952952, "mean_action_processing_ms": 0.14352207497261346, "mean_env_wait_ms": 0.08469480004801065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998477935791016, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12002325057983398}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.212999999999801, "episode_len_mean": 283.46, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, 45.5, 39.90000000000002, 36.10000000000004, 37.90000000000003, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 16.29999999999979, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.500000000000014, 45.1, 21.299999999999862, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 25.899999999999928, 31.500000000000007, 1.299999999999578, 44.10000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 23.099999999999888, 43.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 4.499999999999623, -50.00000000000044, 44.900000000000006, 44.5, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, 46.099999999999994, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 38.90000000000002, 21.09999999999986, -50.00000000000044, -50.00000000000044, 34.30000000000004, 18.099999999999817, 37.300000000000026, 14.899999999999771, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.9, 38.50000000000003, 42.30000000000001, 33.30000000000003, -50.00000000000044, 37.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, -50.00000000000044, 21.499999999999865, 42.30000000000001], "episode_lengths": [500, 54, 500, 62, 46, 102, 140, 122, 500, 500, 126, 500, 68, 500, 338, 36, 54, 500, 500, 500, 500, 86, 80, 500, 108, 500, 86, 50, 288, 500, 48, 500, 54, 242, 186, 488, 60, 208, 500, 500, 50, 58, 270, 68, 500, 46, 500, 500, 92, 456, 500, 52, 56, 40, 500, 56, 500, 500, 500, 500, 500, 194, 500, 40, 38, 500, 40, 500, 500, 190, 500, 112, 290, 500, 500, 158, 320, 128, 352, 500, 500, 64, 500, 32, 116, 78, 168, 500, 128, 44, 500, 500, 36, 178, 500, 40, 360, 500, 286, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821770512473439, "mean_inference_ms": 1.2271393774952952, "mean_action_processing_ms": 0.14352207497261346, "mean_env_wait_ms": 0.08469480004801065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020998477935791016, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12002325057983398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5179.856968039692, "num_env_steps_trained_throughput_per_sec": 5179.856968039692, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3361.492, "sample_time_ms": 2871.688, "load_time_ms": 17.806, "load_throughput": 1010875.943, "learn_time_ms": 460.61, "learn_throughput": 39078.649, "synch_weights_time_ms": 9.386}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1026, "training_iteration": 16, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-53", "timestamp": 1698250673, "time_this_iter_s": 3.480029344558716, "time_total_s": 53.863373041152954, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.863373041152954, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 56.98, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812499999e-06, "cur_lr": 0.0003, "total_loss": 6.910325802697075, "policy_loss": -0.00034805192715591855, "vf_loss": 6.910725159115262, "vf_explained_var": -9.351306491427951e-07, "kl": 0.0012232974068254127, "entropy": 0.51388714644644, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.506999999999861, "episode_len_mean": 220.64, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, -50.00000000000044, 21.499999999999865, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 37.50000000000003, 10.499999999999709, 43.7, 38.10000000000002, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.50000000000003, 47.5, 44.300000000000004, 32.30000000000002, 40.10000000000002, 42.30000000000001, 7.899999999999672, -50.00000000000044, 40.90000000000002, 39.300000000000026, -50.00000000000044, 45.9, 47.7, 41.70000000000002, 43.900000000000006, -50.00000000000044, 47.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.1, 40.10000000000002, -50.00000000000044, 46.699999999999996, 42.70000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 42.900000000000006, -50.00000000000044, 38.700000000000024, -50.00000000000044, 26.69999999999994, 45.1, 46.9, -50.00000000000044, 44.300000000000004, 43.10000000000001, 40.90000000000002, 45.9, 42.10000000000001, 45.7, 42.10000000000001, 20.49999999999985, 35.70000000000003, 40.500000000000014, 34.30000000000004, 44.300000000000004, 8.899999999999686, -50.00000000000044, 47.7, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 28.499999999999964, 43.50000000000001, 44.300000000000004, 40.10000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 36.10000000000004, 44.900000000000006, 36.900000000000034, -50.00000000000044, 46.099999999999994], "episode_lengths": [128, 44, 500, 500, 36, 178, 500, 40, 360, 500, 286, 78, 500, 40, 500, 500, 58, 500, 48, 126, 396, 64, 120, 74, 500, 66, 500, 136, 26, 58, 178, 100, 78, 422, 500, 92, 108, 500, 42, 24, 84, 62, 500, 26, 140, 500, 500, 500, 28, 30, 100, 500, 34, 74, 224, 500, 500, 36, 500, 68, 72, 500, 114, 500, 234, 50, 32, 500, 58, 70, 92, 42, 80, 44, 80, 296, 144, 96, 158, 58, 412, 500, 24, 32, 500, 36, 500, 60, 216, 66, 58, 100, 500, 164, 500, 140, 52, 132, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831380081591281, "mean_inference_ms": 1.2294060645469094, "mean_action_processing_ms": 0.1441547587504533, "mean_env_wait_ms": 0.08465790027184691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028993606567382812, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.11396908760070801}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.506999999999861, "episode_len_mean": 220.64, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.300000000000026, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 32.30000000000002, -50.00000000000044, 46.099999999999994, 14.09999999999976, -50.00000000000044, 21.499999999999865, 42.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 37.50000000000003, 10.499999999999709, 43.7, 38.10000000000002, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.50000000000003, 47.5, 44.300000000000004, 32.30000000000002, 40.10000000000002, 42.30000000000001, 7.899999999999672, -50.00000000000044, 40.90000000000002, 39.300000000000026, -50.00000000000044, 45.9, 47.7, 41.70000000000002, 43.900000000000006, -50.00000000000044, 47.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.1, 40.10000000000002, -50.00000000000044, 46.699999999999996, 42.70000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 42.900000000000006, -50.00000000000044, 38.700000000000024, -50.00000000000044, 26.69999999999994, 45.1, 46.9, -50.00000000000044, 44.300000000000004, 43.10000000000001, 40.90000000000002, 45.9, 42.10000000000001, 45.7, 42.10000000000001, 20.49999999999985, 35.70000000000003, 40.500000000000014, 34.30000000000004, 44.300000000000004, 8.899999999999686, -50.00000000000044, 47.7, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 28.499999999999964, 43.50000000000001, 44.300000000000004, 40.10000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 36.10000000000004, 44.900000000000006, 36.900000000000034, -50.00000000000044, 46.099999999999994], "episode_lengths": [128, 44, 500, 500, 36, 178, 500, 40, 360, 500, 286, 78, 500, 40, 500, 500, 58, 500, 48, 126, 396, 64, 120, 74, 500, 66, 500, 136, 26, 58, 178, 100, 78, 422, 500, 92, 108, 500, 42, 24, 84, 62, 500, 26, 140, 500, 500, 500, 28, 30, 100, 500, 34, 74, 224, 500, 500, 36, 500, 68, 72, 500, 114, 500, 234, 50, 32, 500, 58, 70, 92, 42, 80, 44, 80, 296, 144, 96, 158, 58, 412, 500, 24, 32, 500, 36, 500, 60, 216, 66, 58, 100, 500, 164, 500, 140, 52, 132, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831380081591281, "mean_inference_ms": 1.2294060645469094, "mean_action_processing_ms": 0.1441547587504533, "mean_env_wait_ms": 0.08465790027184691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028993606567382812, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.11396908760070801}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5417.250768701335, "num_env_steps_trained_throughput_per_sec": 5417.250768701335, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3357.066, "sample_time_ms": 2888.191, "load_time_ms": 17.506, "load_throughput": 1028192.092, "learn_time_ms": 440.081, "learn_throughput": 40901.568, "synch_weights_time_ms": 9.287}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1114, "training_iteration": 17, "trial_id": "9f288_00021", "date": "2023-10-25_17-17-56", "timestamp": 1698250676, "time_this_iter_s": 3.3287148475646973, "time_total_s": 57.19208788871765, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.19208788871765, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.21999999999999, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062499994e-06, "cur_lr": 0.0003, "total_loss": 6.893889162275526, "policy_loss": -0.0008610521753629048, "vf_loss": 6.8947988192240395, "vf_explained_var": -1.8517176310221354e-06, "kl": 0.0011574773186415162, "entropy": 0.48657153447469076, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.173999999999864, "episode_len_mean": 218.96, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 28.499999999999964, 43.50000000000001, 44.300000000000004, 40.10000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 36.10000000000004, 44.900000000000006, 36.900000000000034, -50.00000000000044, 46.099999999999994, 42.500000000000014, -50.00000000000044, 40.70000000000002, 44.5, 38.50000000000003, 37.300000000000026, -50.00000000000044, 18.099999999999817, 29.49999999999998, -50.00000000000044, 45.9, 41.70000000000002, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.3, 26.499999999999936, 46.5, -50.00000000000044, 27.699999999999953, 43.30000000000001, 45.1, 24.899999999999913, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 47.7, 43.10000000000001, 46.099999999999994, 44.10000000000001, 38.50000000000003, -50.00000000000044, 30.9, 37.50000000000003, 46.9, 45.7, 43.900000000000006, 46.3, 46.3, -50.00000000000044, 41.500000000000014, 42.10000000000001, -50.00000000000044, 32.50000000000002, 28.499999999999964, 42.500000000000014, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.300000000000004, 45.1, 45.5, 34.10000000000004, 40.10000000000002, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 40.90000000000002, 32.50000000000002, 45.5, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 2.299999999999592, 43.50000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [500, 36, 500, 60, 216, 66, 58, 100, 500, 164, 500, 140, 52, 132, 500, 40, 76, 500, 94, 56, 116, 128, 500, 320, 206, 500, 42, 84, 500, 66, 56, 500, 500, 122, 500, 500, 38, 236, 36, 500, 224, 68, 50, 252, 500, 38, 500, 68, 24, 70, 40, 60, 116, 500, 192, 126, 32, 44, 62, 38, 38, 500, 86, 80, 500, 176, 216, 76, 64, 500, 52, 500, 96, 500, 58, 50, 46, 160, 100, 500, 70, 50, 500, 92, 176, 46, 76, 500, 28, 500, 38, 500, 44, 478, 66, 138, 500, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847358076899664, "mean_inference_ms": 1.23431203297606, "mean_action_processing_ms": 0.14459546670609394, "mean_env_wait_ms": 0.08518048297155349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400158882141113, "StateBufferConnector_ms": 0.010010719299316406, "ViewRequirementAgentConnector_ms": 0.12301826477050781}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.173999999999864, "episode_len_mean": 218.96, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 28.499999999999964, 43.50000000000001, 44.300000000000004, 40.10000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 36.10000000000004, 44.900000000000006, 36.900000000000034, -50.00000000000044, 46.099999999999994, 42.500000000000014, -50.00000000000044, 40.70000000000002, 44.5, 38.50000000000003, 37.300000000000026, -50.00000000000044, 18.099999999999817, 29.49999999999998, -50.00000000000044, 45.9, 41.70000000000002, -50.00000000000044, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.3, 26.499999999999936, 46.5, -50.00000000000044, 27.699999999999953, 43.30000000000001, 45.1, 24.899999999999913, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 47.7, 43.10000000000001, 46.099999999999994, 44.10000000000001, 38.50000000000003, -50.00000000000044, 30.9, 37.50000000000003, 46.9, 45.7, 43.900000000000006, 46.3, 46.3, -50.00000000000044, 41.500000000000014, 42.10000000000001, -50.00000000000044, 32.50000000000002, 28.499999999999964, 42.500000000000014, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.300000000000004, 45.1, 45.5, 34.10000000000004, 40.10000000000002, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 40.90000000000002, 32.50000000000002, 45.5, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 2.299999999999592, 43.50000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [500, 36, 500, 60, 216, 66, 58, 100, 500, 164, 500, 140, 52, 132, 500, 40, 76, 500, 94, 56, 116, 128, 500, 320, 206, 500, 42, 84, 500, 66, 56, 500, 500, 122, 500, 500, 38, 236, 36, 500, 224, 68, 50, 252, 500, 38, 500, 68, 24, 70, 40, 60, 116, 500, 192, 126, 32, 44, 62, 38, 38, 500, 86, 80, 500, 176, 216, 76, 64, 500, 52, 500, 96, 500, 58, 50, 46, 160, 100, 500, 70, 50, 500, 92, 176, 46, 76, 500, 28, 500, 38, 500, 44, 478, 66, 138, 500, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847358076899664, "mean_inference_ms": 1.23431203297606, "mean_action_processing_ms": 0.14459546670609394, "mean_env_wait_ms": 0.08518048297155349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400158882141113, "StateBufferConnector_ms": 0.010010719299316406, "ViewRequirementAgentConnector_ms": 0.12301826477050781}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5108.695500658435, "num_env_steps_trained_throughput_per_sec": 5108.695500658435, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3369.507, "sample_time_ms": 2902.691, "load_time_ms": 17.906, "load_throughput": 1005241.705, "learn_time_ms": 437.625, "learn_throughput": 41131.148, "synch_weights_time_ms": 9.283}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1198, "training_iteration": 18, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-00", "timestamp": 1698250680, "time_this_iter_s": 3.528402328491211, "time_total_s": 60.72049021720886, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.72049021720886, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531249997e-07, "cur_lr": 0.0003, "total_loss": 6.65625836054484, "policy_loss": -0.00035921914709938896, "vf_loss": 6.656669606102837, "vf_explained_var": -1.0967254638671874e-06, "kl": 0.0010085265527449237, "entropy": 0.5203363511297437, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.81699999999984, "episode_len_mean": 237.48, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 40.90000000000002, 32.50000000000002, 45.5, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 2.299999999999592, 43.50000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.30000000000004, 45.5, 23.499999999999893, 44.300000000000004, 43.7, 47.1, 41.90000000000001, 40.70000000000002, 45.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.900000000000006, 40.10000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.5, 31.1, 27.899999999999956, 44.900000000000006, 47.1, 37.90000000000003, -50.00000000000044, 38.50000000000003, 45.7, 31.300000000000004, -50.00000000000044, 43.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, 36.70000000000003, 43.50000000000001, -50.00000000000044, 12.499999999999737, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.1, 27.699999999999953, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 15.899999999999785, 43.7, 43.900000000000006, 39.300000000000026], "episode_lengths": [100, 500, 70, 50, 500, 92, 176, 46, 76, 500, 28, 500, 38, 500, 44, 478, 66, 138, 500, 500, 500, 52, 158, 46, 266, 58, 64, 30, 82, 94, 44, 500, 72, 500, 500, 156, 52, 100, 500, 74, 58, 500, 500, 72, 36, 190, 222, 52, 30, 122, 500, 116, 44, 188, 500, 62, 34, 500, 500, 500, 500, 500, 54, 500, 82, 134, 66, 500, 376, 44, 500, 48, 500, 40, 500, 44, 50, 224, 46, 500, 500, 40, 500, 44, 52, 500, 500, 500, 40, 86, 500, 60, 100, 500, 500, 66, 342, 64, 62, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38658288398602336, "mean_inference_ms": 1.2381435966403151, "mean_action_processing_ms": 0.1446434163927472, "mean_env_wait_ms": 0.08553612460414779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043003082275390625, "StateBufferConnector_ms": 0.007009029388427734, "ViewRequirementAgentConnector_ms": 0.13501238822937012}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.81699999999984, "episode_len_mean": 237.48, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 40.90000000000002, 32.50000000000002, 45.5, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 2.299999999999592, 43.50000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.30000000000004, 45.5, 23.499999999999893, 44.300000000000004, 43.7, 47.1, 41.90000000000001, 40.70000000000002, 45.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 44.900000000000006, 40.10000000000002, -50.00000000000044, 42.70000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.5, 31.1, 27.899999999999956, 44.900000000000006, 47.1, 37.90000000000003, -50.00000000000044, 38.50000000000003, 45.7, 31.300000000000004, -50.00000000000044, 43.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, 36.70000000000003, 43.50000000000001, -50.00000000000044, 12.499999999999737, 45.7, -50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.1, 27.699999999999953, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 15.899999999999785, 43.7, 43.900000000000006, 39.300000000000026], "episode_lengths": [100, 500, 70, 50, 500, 92, 176, 46, 76, 500, 28, 500, 38, 500, 44, 478, 66, 138, 500, 500, 500, 52, 158, 46, 266, 58, 64, 30, 82, 94, 44, 500, 72, 500, 500, 156, 52, 100, 500, 74, 58, 500, 500, 72, 36, 190, 222, 52, 30, 122, 500, 116, 44, 188, 500, 62, 34, 500, 500, 500, 500, 500, 54, 500, 82, 134, 66, 500, 376, 44, 500, 48, 500, 40, 500, 44, 50, 224, 46, 500, 500, 40, 500, 44, 52, 500, 500, 500, 40, 86, 500, 60, 100, 500, 500, 66, 342, 64, 62, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38658288398602336, "mean_inference_ms": 1.2381435966403151, "mean_action_processing_ms": 0.1446434163927472, "mean_env_wait_ms": 0.08553612460414779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043003082275390625, "StateBufferConnector_ms": 0.007009029388427734, "ViewRequirementAgentConnector_ms": 0.13501238822937012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4957.30546783494, "num_env_steps_trained_throughput_per_sec": 4957.30546783494, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3394.71, "sample_time_ms": 2928.594, "load_time_ms": 17.406, "load_throughput": 1034135.448, "learn_time_ms": 437.225, "learn_throughput": 41168.763, "synch_weights_time_ms": 9.383}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1276, "training_iteration": 19, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-03", "timestamp": 1698250683, "time_this_iter_s": 3.6369993686676025, "time_total_s": 64.35748958587646, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.35748958587646, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 63.540000000000006, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656249986e-07, "cur_lr": 0.0003, "total_loss": 6.331525399949816, "policy_loss": -0.00026062894612550737, "vf_loss": 6.331833034091526, "vf_explained_var": -3.337860107421875e-07, "kl": 0.0007809274788415779, "entropy": 0.47003779080179003, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7429999999998147, "episode_len_mean": 258.16, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.1, 27.699999999999953, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 15.899999999999785, 43.7, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, 37.10000000000003, 45.9, 39.300000000000026, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, 11.29999999999972, 47.5, -50.00000000000044, 36.10000000000004, 45.3, -50.00000000000044, 38.300000000000026, 42.10000000000001, 44.900000000000006, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 27.299999999999947, 38.700000000000024, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 44.7, 46.3, 46.9, 46.9, 25.29999999999992, 41.100000000000016, 32.700000000000024, 24.69999999999991, -50.00000000000044, 36.70000000000003], "episode_lengths": [500, 48, 500, 40, 500, 44, 50, 224, 46, 500, 500, 40, 500, 44, 52, 500, 500, 500, 40, 86, 500, 60, 100, 500, 500, 66, 342, 64, 62, 108, 500, 500, 34, 500, 116, 500, 130, 42, 108, 72, 46, 500, 500, 500, 500, 56, 500, 500, 500, 186, 34, 42, 500, 500, 388, 26, 500, 140, 48, 500, 118, 80, 52, 500, 110, 500, 76, 500, 500, 80, 42, 500, 28, 42, 500, 500, 64, 500, 40, 500, 26, 500, 500, 228, 114, 58, 500, 72, 500, 46, 54, 38, 32, 32, 248, 90, 174, 254, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877983812149441, "mean_inference_ms": 1.2424437877385142, "mean_action_processing_ms": 0.14516677457749347, "mean_env_wait_ms": 0.08562722406660365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.010008811950683594, "ViewRequirementAgentConnector_ms": 0.14203548431396484}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.7429999999998147, "episode_len_mean": 258.16, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.1, 27.699999999999953, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, -50.00000000000044, 44.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 15.899999999999785, 43.7, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 38.50000000000003, -50.00000000000044, 37.10000000000003, 45.9, 39.300000000000026, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, 11.29999999999972, 47.5, -50.00000000000044, 36.10000000000004, 45.3, -50.00000000000044, 38.300000000000026, 42.10000000000001, 44.900000000000006, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 27.299999999999947, 38.700000000000024, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 44.7, 46.3, 46.9, 46.9, 25.29999999999992, 41.100000000000016, 32.700000000000024, 24.69999999999991, -50.00000000000044, 36.70000000000003], "episode_lengths": [500, 48, 500, 40, 500, 44, 50, 224, 46, 500, 500, 40, 500, 44, 52, 500, 500, 500, 40, 86, 500, 60, 100, 500, 500, 66, 342, 64, 62, 108, 500, 500, 34, 500, 116, 500, 130, 42, 108, 72, 46, 500, 500, 500, 500, 56, 500, 500, 500, 186, 34, 42, 500, 500, 388, 26, 500, 140, 48, 500, 118, 80, 52, 500, 110, 500, 76, 500, 500, 80, 42, 500, 28, 42, 500, 500, 64, 500, 40, 500, 26, 500, 500, 228, 114, 58, 500, 72, 500, 46, 54, 38, 32, 32, 248, 90, 174, 254, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877983812149441, "mean_inference_ms": 1.2424437877385142, "mean_action_processing_ms": 0.14516677457749347, "mean_env_wait_ms": 0.08562722406660365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.010008811950683594, "ViewRequirementAgentConnector_ms": 0.14203548431396484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5102.033752266004, "num_env_steps_trained_throughput_per_sec": 5102.033752266004, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3410.409, "sample_time_ms": 2942.894, "load_time_ms": 17.809, "load_throughput": 1010752.788, "learn_time_ms": 438.119, "learn_throughput": 41084.739, "synch_weights_time_ms": 9.486}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1346, "training_iteration": 20, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-07", "timestamp": 1698250687, "time_this_iter_s": 3.532999277114868, "time_total_s": 67.89048886299133, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.89048886299133, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.92, "ram_util_percent": 26.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328124993e-07, "cur_lr": 0.0003, "total_loss": 6.731896792517768, "policy_loss": -0.0007197565916511748, "vf_loss": 6.732664309607612, "vf_explained_var": -1.629193623860677e-06, "kl": 0.0012522527015170859, "entropy": 0.4772236744562785, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.866999999999887, "episode_len_mean": 197.08, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.700000000000024, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 44.7, 46.3, 46.9, 46.9, 25.29999999999992, 41.100000000000016, 32.700000000000024, 24.69999999999991, -50.00000000000044, 36.70000000000003, 47.1, 41.100000000000016, 43.900000000000006, 34.900000000000034, 45.7, 37.90000000000003, 34.30000000000004, 46.9, -50.00000000000044, 45.9, 45.9, 46.3, 35.30000000000004, -50.00000000000044, 47.3, 43.30000000000001, 45.9, 44.7, -50.00000000000044, 45.3, 21.89999999999987, 7.899999999999672, 35.500000000000036, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.09999999999986, 33.90000000000004, -50.00000000000044, 24.499999999999908, 45.5, 43.30000000000001, 41.100000000000016, -50.00000000000044, 32.90000000000003, 39.10000000000002, 41.90000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 29.49999999999998, 43.7, 45.1, -50.00000000000044, 45.9, 43.10000000000001, 45.9, 42.30000000000001, 37.300000000000026, 33.30000000000003, 45.9, -50.00000000000044, 45.5, 47.7, 45.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 29.69999999999998, 43.900000000000006, 44.10000000000001, -50.00000000000044, 31.300000000000004, 43.30000000000001, 45.5, 44.7, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004], "episode_lengths": [114, 58, 500, 72, 500, 46, 54, 38, 32, 32, 248, 90, 174, 254, 500, 134, 30, 90, 62, 152, 44, 122, 158, 32, 500, 42, 42, 38, 148, 500, 28, 68, 42, 54, 500, 48, 282, 422, 146, 52, 500, 500, 290, 162, 500, 256, 46, 68, 90, 500, 172, 110, 82, 500, 122, 500, 64, 500, 500, 228, 500, 206, 64, 50, 500, 42, 70, 42, 78, 128, 168, 42, 500, 46, 24, 48, 52, 500, 40, 204, 62, 60, 500, 188, 68, 46, 54, 500, 34, 42, 500, 500, 500, 30, 46, 38, 500, 40, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38697055435905, "mean_inference_ms": 1.239455279681014, "mean_action_processing_ms": 0.14511753202207595, "mean_env_wait_ms": 0.08597976779490925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001266479492188, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.10900640487670898}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.866999999999887, "episode_len_mean": 197.08, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.700000000000024, 44.300000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 44.7, 46.3, 46.9, 46.9, 25.29999999999992, 41.100000000000016, 32.700000000000024, 24.69999999999991, -50.00000000000044, 36.70000000000003, 47.1, 41.100000000000016, 43.900000000000006, 34.900000000000034, 45.7, 37.90000000000003, 34.30000000000004, 46.9, -50.00000000000044, 45.9, 45.9, 46.3, 35.30000000000004, -50.00000000000044, 47.3, 43.30000000000001, 45.9, 44.7, -50.00000000000044, 45.3, 21.89999999999987, 7.899999999999672, 35.500000000000036, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.09999999999986, 33.90000000000004, -50.00000000000044, 24.499999999999908, 45.5, 43.30000000000001, 41.100000000000016, -50.00000000000044, 32.90000000000003, 39.10000000000002, 41.90000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 29.49999999999998, 43.7, 45.1, -50.00000000000044, 45.9, 43.10000000000001, 45.9, 42.30000000000001, 37.300000000000026, 33.30000000000003, 45.9, -50.00000000000044, 45.5, 47.7, 45.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 29.69999999999998, 43.900000000000006, 44.10000000000001, -50.00000000000044, 31.300000000000004, 43.30000000000001, 45.5, 44.7, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004], "episode_lengths": [114, 58, 500, 72, 500, 46, 54, 38, 32, 32, 248, 90, 174, 254, 500, 134, 30, 90, 62, 152, 44, 122, 158, 32, 500, 42, 42, 38, 148, 500, 28, 68, 42, 54, 500, 48, 282, 422, 146, 52, 500, 500, 290, 162, 500, 256, 46, 68, 90, 500, 172, 110, 82, 500, 122, 500, 64, 500, 500, 228, 500, 206, 64, 50, 500, 42, 70, 42, 78, 128, 168, 42, 500, 46, 24, 48, 52, 500, 40, 204, 62, 60, 500, 188, 68, 46, 54, 500, 34, 42, 500, 500, 500, 30, 46, 38, 500, 40, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38697055435905, "mean_inference_ms": 1.239455279681014, "mean_action_processing_ms": 0.14511753202207595, "mean_env_wait_ms": 0.08597976779490925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001266479492188, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.10900640487670898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5496.178644745473, "num_env_steps_trained_throughput_per_sec": 5496.178644745473, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3424.213, "sample_time_ms": 2935.298, "load_time_ms": 18.112, "load_throughput": 993833.707, "learn_time_ms": 459.013, "learn_throughput": 39214.567, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1430, "training_iteration": 21, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-10", "timestamp": 1698250690, "time_this_iter_s": 3.281001091003418, "time_total_s": 71.17148995399475, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.17148995399475, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 53.120000000000005, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062497e-08, "cur_lr": 0.0003, "total_loss": 6.129880714416504, "policy_loss": -0.00011100226806269752, "vf_loss": 6.130039797888862, "vf_explained_var": 9.006924099392361e-07, "kl": 0.0005023434369157877, "entropy": 0.48156778282589385, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.530999999999835, "episode_len_mean": 240.32, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 45.9, 42.30000000000001, 37.300000000000026, 33.30000000000003, 45.9, -50.00000000000044, 45.5, 47.7, 45.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 29.69999999999998, 43.900000000000006, 44.10000000000001, -50.00000000000044, 31.300000000000004, 43.30000000000001, 45.5, 44.7, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 3.0999999999996035, 39.300000000000026, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.5, 42.70000000000001, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 47.5, 45.7, 43.10000000000001, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 36.900000000000034, 45.1, 33.90000000000004, 44.300000000000004, 46.099999999999994, 43.10000000000001, 37.10000000000003, 47.5, -50.00000000000044, 43.50000000000001, 47.5, 47.3, 38.300000000000026, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044], "episode_lengths": [70, 42, 78, 128, 168, 42, 500, 46, 24, 48, 52, 500, 40, 204, 62, 60, 500, 188, 68, 46, 54, 500, 34, 42, 500, 500, 500, 30, 46, 38, 500, 40, 500, 58, 264, 500, 500, 500, 500, 500, 142, 470, 108, 500, 500, 208, 64, 78, 500, 500, 500, 500, 40, 26, 74, 56, 76, 500, 500, 56, 66, 500, 500, 120, 26, 44, 70, 500, 312, 500, 500, 500, 132, 34, 500, 132, 50, 162, 58, 40, 70, 130, 26, 500, 66, 26, 28, 118, 500, 138, 80, 500, 36, 500, 124, 500, 500, 500, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867478433291617, "mean_inference_ms": 1.2391337723972544, "mean_action_processing_ms": 0.14477269849142108, "mean_env_wait_ms": 0.0862086226137507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997835159301758, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.11501288414001465}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.530999999999835, "episode_len_mean": 240.32, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 45.9, 42.30000000000001, 37.300000000000026, 33.30000000000003, 45.9, -50.00000000000044, 45.5, 47.7, 45.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 29.69999999999998, 43.900000000000006, 44.10000000000001, -50.00000000000044, 31.300000000000004, 43.30000000000001, 45.5, 44.7, -50.00000000000044, 46.699999999999996, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 23.699999999999896, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 3.0999999999996035, 39.300000000000026, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.5, 42.70000000000001, 44.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, 47.5, 45.7, 43.10000000000001, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 36.900000000000034, 45.1, 33.90000000000004, 44.300000000000004, 46.099999999999994, 43.10000000000001, 37.10000000000003, 47.5, -50.00000000000044, 43.50000000000001, 47.5, 47.3, 38.300000000000026, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044], "episode_lengths": [70, 42, 78, 128, 168, 42, 500, 46, 24, 48, 52, 500, 40, 204, 62, 60, 500, 188, 68, 46, 54, 500, 34, 42, 500, 500, 500, 30, 46, 38, 500, 40, 500, 58, 264, 500, 500, 500, 500, 500, 142, 470, 108, 500, 500, 208, 64, 78, 500, 500, 500, 500, 40, 26, 74, 56, 76, 500, 500, 56, 66, 500, 500, 120, 26, 44, 70, 500, 312, 500, 500, 500, 132, 34, 500, 132, 50, 162, 58, 40, 70, 130, 26, 500, 66, 26, 28, 118, 500, 138, 80, 500, 36, 500, 124, 500, 500, 500, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867478433291617, "mean_inference_ms": 1.2391337723972544, "mean_action_processing_ms": 0.14477269849142108, "mean_env_wait_ms": 0.0862086226137507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997835159301758, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.11501288414001465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4951.49679250317, "num_env_steps_trained_throughput_per_sec": 4951.49679250317, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3449.94, "sample_time_ms": 2948.101, "load_time_ms": 18.211, "load_throughput": 988389.918, "learn_time_ms": 471.938, "learn_throughput": 38140.583, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1496, "training_iteration": 22, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-14", "timestamp": 1698250694, "time_this_iter_s": 3.641261577606201, "time_total_s": 74.81275153160095, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.81275153160095, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 60.28000000000001, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031248e-08, "cur_lr": 0.0003, "total_loss": 6.496565193600125, "policy_loss": -0.00012176988853348625, "vf_loss": 6.496730836232503, "vf_explained_var": 5.165735880533854e-07, "kl": 0.0005376136970625112, "entropy": 0.4385506444507175, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.42399999999980176, "episode_len_mean": 276.32, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 47.5, 45.7, 43.10000000000001, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 36.900000000000034, 45.1, 33.90000000000004, 44.300000000000004, 46.099999999999994, 43.10000000000001, 37.10000000000003, 47.5, -50.00000000000044, 43.50000000000001, 47.5, 47.3, 38.300000000000026, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 33.70000000000004, -50.00000000000044, 46.5, 42.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 14.499999999999766, 46.099999999999994, 33.90000000000004, -50.00000000000044, 1.099999999999575, 44.900000000000006, 28.09999999999996, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 35.10000000000004, 40.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 33.30000000000003, 21.699999999999868, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 45.9, 47.7], "episode_lengths": [500, 120, 26, 44, 70, 500, 312, 500, 500, 500, 132, 34, 500, 132, 50, 162, 58, 40, 70, 130, 26, 500, 66, 26, 28, 118, 500, 138, 80, 500, 36, 500, 124, 500, 500, 500, 74, 500, 500, 500, 500, 46, 164, 500, 36, 80, 500, 120, 500, 500, 42, 500, 500, 72, 500, 164, 356, 40, 162, 500, 490, 52, 220, 50, 76, 500, 500, 50, 150, 100, 500, 40, 500, 500, 130, 500, 168, 284, 38, 500, 500, 500, 68, 500, 500, 500, 40, 50, 500, 500, 500, 500, 500, 110, 500, 34, 38, 500, 42, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3871239975927399, "mean_inference_ms": 1.2397064528521953, "mean_action_processing_ms": 0.144310606974668, "mean_env_wait_ms": 0.08587367517692199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030991077423095703, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.1400012969970703}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.42399999999980176, "episode_len_mean": 276.32, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 47.5, 45.7, 43.10000000000001, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.699999999999996, -50.00000000000044, 36.900000000000034, 45.1, 33.90000000000004, 44.300000000000004, 46.099999999999994, 43.10000000000001, 37.10000000000003, 47.5, -50.00000000000044, 43.50000000000001, 47.5, 47.3, 38.300000000000026, -50.00000000000044, 36.30000000000003, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 33.70000000000004, -50.00000000000044, 46.5, 42.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 33.70000000000004, 14.499999999999766, 46.099999999999994, 33.90000000000004, -50.00000000000044, 1.099999999999575, 44.900000000000006, 28.09999999999996, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 35.10000000000004, 40.10000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 33.30000000000003, 21.699999999999868, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 45.9, 47.7], "episode_lengths": [500, 120, 26, 44, 70, 500, 312, 500, 500, 500, 132, 34, 500, 132, 50, 162, 58, 40, 70, 130, 26, 500, 66, 26, 28, 118, 500, 138, 80, 500, 36, 500, 124, 500, 500, 500, 74, 500, 500, 500, 500, 46, 164, 500, 36, 80, 500, 120, 500, 500, 42, 500, 500, 72, 500, 164, 356, 40, 162, 500, 490, 52, 220, 50, 76, 500, 500, 50, 150, 100, 500, 40, 500, 500, 130, 500, 168, 284, 38, 500, 500, 500, 68, 500, 500, 500, 40, 50, 500, 500, 500, 500, 500, 110, 500, 34, 38, 500, 42, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3871239975927399, "mean_inference_ms": 1.2397064528521953, "mean_action_processing_ms": 0.144310606974668, "mean_env_wait_ms": 0.08587367517692199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030991077423095703, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.1400012969970703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5250.872265160263, "num_env_steps_trained_throughput_per_sec": 5250.872265160263, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3454.44, "sample_time_ms": 2949.501, "load_time_ms": 18.314, "load_throughput": 982839.081, "learn_time_ms": 474.935, "learn_throughput": 37899.89, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1558, "training_iteration": 23, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-17", "timestamp": 1698250697, "time_this_iter_s": 3.434030532836914, "time_total_s": 78.24678206443787, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.24678206443787, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 57.94000000000001, "ram_util_percent": 26.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.384185791015624e-08, "cur_lr": 0.0003, "total_loss": 6.485669422149658, "policy_loss": -0.00019126374067531693, "vf_loss": 6.485904767778185, "vf_explained_var": -7.557868957519531e-06, "kl": 0.0007047295341509299, "entropy": 0.44077809982829624, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.520999999999807, "episode_len_mean": 260.38, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.10000000000003, -50.00000000000044, 33.30000000000003, 21.699999999999868, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 45.9, 47.7, 34.70000000000004, -50.00000000000044, 44.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.9, 41.70000000000002, 47.9, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.3, 46.3, 41.90000000000001, 47.1, 29.299999999999976, 46.9, -50.00000000000044, 7.299999999999663, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 47.1, 24.499999999999908, -50.00000000000044, 44.300000000000004, 46.9, 29.49999999999998, -50.00000000000044, 45.9, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.30000000000001, 45.3, 11.899999999999729, -50.00000000000044, 47.1, 43.30000000000001, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.5, 44.5, 41.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 10.899999999999714, -50.00000000000044, 43.7, 45.5, 45.3, 46.3, 42.10000000000001, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044], "episode_lengths": [500, 130, 500, 168, 284, 38, 500, 500, 500, 68, 500, 500, 500, 40, 50, 500, 500, 500, 500, 500, 110, 500, 34, 38, 500, 42, 24, 154, 500, 52, 22, 500, 500, 32, 84, 22, 500, 212, 500, 500, 38, 38, 82, 30, 208, 32, 500, 428, 72, 500, 500, 500, 90, 30, 256, 500, 58, 32, 206, 500, 42, 40, 50, 500, 500, 38, 64, 500, 90, 500, 68, 48, 382, 500, 30, 68, 500, 66, 34, 500, 500, 500, 328, 36, 56, 88, 500, 32, 500, 392, 500, 64, 46, 48, 38, 80, 500, 38, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38668861553407985, "mean_inference_ms": 1.2390318588765397, "mean_action_processing_ms": 0.1440652774140857, "mean_env_wait_ms": 0.08552940120454142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026993751525878906, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.13199591636657715}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.520999999999807, "episode_len_mean": 260.38, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.10000000000003, -50.00000000000044, 33.30000000000003, 21.699999999999868, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, 45.9, 47.7, 34.70000000000004, -50.00000000000044, 44.900000000000006, 47.9, -50.00000000000044, -50.00000000000044, 46.9, 41.70000000000002, 47.9, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 46.3, 46.3, 41.90000000000001, 47.1, 29.299999999999976, 46.9, -50.00000000000044, 7.299999999999663, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 47.1, 24.499999999999908, -50.00000000000044, 44.300000000000004, 46.9, 29.49999999999998, -50.00000000000044, 45.9, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.30000000000001, 45.3, 11.899999999999729, -50.00000000000044, 47.1, 43.30000000000001, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.5, 44.5, 41.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 10.899999999999714, -50.00000000000044, 43.7, 45.5, 45.3, 46.3, 42.10000000000001, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044], "episode_lengths": [500, 130, 500, 168, 284, 38, 500, 500, 500, 68, 500, 500, 500, 40, 50, 500, 500, 500, 500, 500, 110, 500, 34, 38, 500, 42, 24, 154, 500, 52, 22, 500, 500, 32, 84, 22, 500, 212, 500, 500, 38, 38, 82, 30, 208, 32, 500, 428, 72, 500, 500, 500, 90, 30, 256, 500, 58, 32, 206, 500, 42, 40, 50, 500, 500, 38, 64, 500, 90, 500, 68, 48, 382, 500, 30, 68, 500, 66, 34, 500, 500, 500, 328, 36, 56, 88, 500, 32, 500, 392, 500, 64, 46, 48, 38, 80, 500, 38, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38668861553407985, "mean_inference_ms": 1.2390318588765397, "mean_action_processing_ms": 0.1440652774140857, "mean_env_wait_ms": 0.08552940120454142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026993751525878906, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.13199591636657715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5394.061304023333, "num_env_steps_trained_throughput_per_sec": 5394.061304023333, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3453.94, "sample_time_ms": 2953.601, "load_time_ms": 17.814, "load_throughput": 1010460.585, "learn_time_ms": 470.833, "learn_throughput": 38230.097, "synch_weights_time_ms": 9.492}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1631, "training_iteration": 24, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-21", "timestamp": 1698250701, "time_this_iter_s": 3.3439998626708984, "time_total_s": 81.59078192710876, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.59078192710876, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 66.85, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.192092895507812e-08, "cur_lr": 0.0003, "total_loss": 6.634924189249674, "policy_loss": -0.0004846774869494968, "vf_loss": 6.635457505120171, "vf_explained_var": -9.491708543565538e-06, "kl": 0.0006717832260973309, "entropy": 0.4855510334173838, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.610999999999828, "episode_len_mean": 239.54, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.5, 44.5, 41.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 10.899999999999714, -50.00000000000044, 43.7, 45.5, 45.3, 46.3, 42.10000000000001, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 24.099999999999902, 18.899999999999828, 47.1, 46.9, 43.30000000000001, 10.099999999999703, -50.00000000000044, -50.00000000000044, 45.7, 47.5, 17.69999999999981, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 47.5, 26.499999999999936, -50.00000000000044, 45.9, 45.1, 22.699999999999882, 43.10000000000001, 47.1, 41.30000000000001, -50.00000000000044, 43.7, 44.7, 43.50000000000001, 47.7, 11.29999999999972, -50.00000000000044, 46.9, 41.30000000000001, 36.30000000000003, 45.3, 40.500000000000014, 45.3, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.900000000000006, 42.70000000000001, 45.5, -50.00000000000044, 26.69999999999994, 46.5, 47.1, 47.3, 43.50000000000001, 45.5, -50.00000000000044, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 66, 34, 500, 500, 500, 328, 36, 56, 88, 500, 32, 500, 392, 500, 64, 46, 48, 38, 80, 500, 38, 68, 500, 500, 500, 34, 500, 500, 500, 44, 500, 260, 312, 30, 32, 68, 400, 500, 500, 44, 26, 324, 36, 500, 42, 500, 26, 236, 500, 42, 50, 274, 70, 30, 88, 500, 64, 54, 66, 24, 388, 500, 32, 88, 138, 48, 96, 48, 68, 500, 40, 500, 500, 72, 500, 102, 500, 58, 500, 240, 500, 500, 74, 500, 62, 74, 46, 500, 234, 36, 30, 28, 66, 46, 500, 42, 208, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863607339726674, "mean_inference_ms": 1.2400398759992262, "mean_action_processing_ms": 0.14409070300177654, "mean_env_wait_ms": 0.08564761467666887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02002573013305664, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.12003326416015625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.610999999999828, "episode_len_mean": 239.54, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.5, 44.5, 41.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, 10.899999999999714, -50.00000000000044, 43.7, 45.5, 45.3, 46.3, 42.10000000000001, -50.00000000000044, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 24.099999999999902, 18.899999999999828, 47.1, 46.9, 43.30000000000001, 10.099999999999703, -50.00000000000044, -50.00000000000044, 45.7, 47.5, 17.69999999999981, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 47.5, 26.499999999999936, -50.00000000000044, 45.9, 45.1, 22.699999999999882, 43.10000000000001, 47.1, 41.30000000000001, -50.00000000000044, 43.7, 44.7, 43.50000000000001, 47.7, 11.29999999999972, -50.00000000000044, 46.9, 41.30000000000001, 36.30000000000003, 45.3, 40.500000000000014, 45.3, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.900000000000006, 42.70000000000001, 45.5, -50.00000000000044, 26.69999999999994, 46.5, 47.1, 47.3, 43.50000000000001, 45.5, -50.00000000000044, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 66, 34, 500, 500, 500, 328, 36, 56, 88, 500, 32, 500, 392, 500, 64, 46, 48, 38, 80, 500, 38, 68, 500, 500, 500, 34, 500, 500, 500, 44, 500, 260, 312, 30, 32, 68, 400, 500, 500, 44, 26, 324, 36, 500, 42, 500, 26, 236, 500, 42, 50, 274, 70, 30, 88, 500, 64, 54, 66, 24, 388, 500, 32, 88, 138, 48, 96, 48, 68, 500, 40, 500, 500, 72, 500, 102, 500, 58, 500, 240, 500, 500, 74, 500, 62, 74, 46, 500, 234, 36, 30, 28, 66, 46, 500, 42, 208, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863607339726674, "mean_inference_ms": 1.2400398759992262, "mean_action_processing_ms": 0.14409070300177654, "mean_env_wait_ms": 0.08564761467666887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02002573013305664, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.12003326416015625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5250.872995559908, "num_env_steps_trained_throughput_per_sec": 5250.872995559908, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3458.341, "sample_time_ms": 2955.901, "load_time_ms": 17.617, "load_throughput": 1021743.871, "learn_time_ms": 473.03, "learn_throughput": 38052.569, "synch_weights_time_ms": 9.591}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1707, "training_iteration": 25, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-24", "timestamp": 1698250704, "time_this_iter_s": 3.434000015258789, "time_total_s": 85.02478194236755, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.02478194236755, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 58.339999999999996, "ram_util_percent": 26.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.96046447753906e-09, "cur_lr": 0.0003, "total_loss": 6.580632887946235, "policy_loss": -0.0005906236668427786, "vf_loss": 6.581269751654731, "vf_explained_var": -0.0002231213781568739, "kl": 0.0009258380088422453, "entropy": 0.4622190720505185, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.400999999999803, "episode_len_mean": 271.58, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 45.3, 40.500000000000014, 45.3, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.900000000000006, 42.70000000000001, 45.5, -50.00000000000044, 26.69999999999994, 46.5, 47.1, 47.3, 43.50000000000001, 45.5, -50.00000000000044, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 28.699999999999967, 46.9, 47.1, 45.7, -50.00000000000044, 33.70000000000004, 44.300000000000004, 8.699999999999683, 19.899999999999842, 13.099999999999746, 44.5, 44.10000000000001, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 41.70000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 21.09999999999986, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 23.499999999999893, 46.699999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 35.500000000000036, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [138, 48, 96, 48, 68, 500, 40, 500, 500, 72, 500, 102, 500, 58, 500, 240, 500, 500, 74, 500, 62, 74, 46, 500, 234, 36, 30, 28, 66, 46, 500, 42, 208, 500, 500, 500, 500, 40, 500, 500, 500, 66, 72, 214, 32, 30, 44, 500, 164, 58, 414, 302, 370, 56, 60, 58, 500, 70, 500, 500, 500, 38, 44, 84, 36, 500, 500, 500, 38, 74, 32, 500, 500, 500, 500, 446, 290, 500, 58, 46, 500, 500, 260, 500, 266, 34, 100, 500, 500, 168, 98, 500, 500, 500, 406, 146, 30, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3866351876122448, "mean_inference_ms": 1.2398074578742357, "mean_action_processing_ms": 0.14368453815986892, "mean_env_wait_ms": 0.08564791880988419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998332977294922, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.13300180435180664}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.400999999999803, "episode_len_mean": 271.58, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 45.3, 40.500000000000014, 45.3, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.900000000000006, 42.70000000000001, 45.5, -50.00000000000044, 26.69999999999994, 46.5, 47.1, 47.3, 43.50000000000001, 45.5, -50.00000000000044, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 28.699999999999967, 46.9, 47.1, 45.7, -50.00000000000044, 33.70000000000004, 44.300000000000004, 8.699999999999683, 19.899999999999842, 13.099999999999746, 44.5, 44.10000000000001, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 41.70000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 21.09999999999986, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 23.499999999999893, 46.699999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 35.500000000000036, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [138, 48, 96, 48, 68, 500, 40, 500, 500, 72, 500, 102, 500, 58, 500, 240, 500, 500, 74, 500, 62, 74, 46, 500, 234, 36, 30, 28, 66, 46, 500, 42, 208, 500, 500, 500, 500, 40, 500, 500, 500, 66, 72, 214, 32, 30, 44, 500, 164, 58, 414, 302, 370, 56, 60, 58, 500, 70, 500, 500, 500, 38, 44, 84, 36, 500, 500, 500, 38, 74, 32, 500, 500, 500, 500, 446, 290, 500, 58, 46, 500, 500, 260, 500, 266, 34, 100, 500, 500, 168, 98, 500, 500, 500, 406, 146, 30, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3866351876122448, "mean_inference_ms": 1.2398074578742357, "mean_action_processing_ms": 0.14368453815986892, "mean_env_wait_ms": 0.08564791880988419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998332977294922, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.13300180435180664}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5188.995167955872, "num_env_steps_trained_throughput_per_sec": 5188.995167955872, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3457.729, "sample_time_ms": 2954.101, "load_time_ms": 17.517, "load_throughput": 1027587.525, "learn_time_ms": 474.317, "learn_throughput": 37949.296, "synch_weights_time_ms": 9.492}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1772, "training_iteration": 26, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-28", "timestamp": 1698250708, "time_this_iter_s": 3.4748737812042236, "time_total_s": 88.49965572357178, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.49965572357178, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 59.54, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.98023223876953e-09, "cur_lr": 0.0003, "total_loss": 7.201142946879069, "policy_loss": -0.0008111083129834798, "vf_loss": 7.2019990073310005, "vf_explained_var": 0.00038807921939425997, "kl": 0.0014652705627762922, "entropy": 0.4497231019867791, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.077999999999854, "episode_len_mean": 229.94, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.099999999999902, -50.00000000000044, 23.499999999999893, 46.699999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 35.500000000000036, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 45.7, 20.899999999999856, -50.00000000000044, 46.699999999999996, 39.70000000000002, 40.10000000000002, 43.30000000000001, 33.70000000000004, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.70000000000002, 47.7, 27.699999999999953, -50.00000000000044, 6.699999999999655, -50.00000000000044, 43.50000000000001, -50.00000000000044, 0.09999999999956088, 46.699999999999996, -50.00000000000044, 19.899999999999842, 43.7, -50.00000000000044, 40.90000000000002, 46.699999999999996, 44.300000000000004, 38.700000000000024, 43.30000000000001, 29.69999999999998, 35.500000000000036, 44.900000000000006, 42.30000000000001, -50.00000000000044, 46.699999999999996, 46.099999999999994, 45.5, 44.5, -50.00000000000044, 45.1, 40.70000000000002, -50.00000000000044, 45.3, 41.100000000000016, 43.50000000000001, 43.900000000000006, 23.29999999999989, 0.8999999999995723, 41.100000000000016, 34.70000000000004, -50.00000000000044, 44.5, -50.00000000000044, 21.699999999999868, 43.50000000000001, 44.300000000000004, 42.30000000000001, -50.00000000000044, 37.90000000000003, 45.3, 10.699999999999712, 46.099999999999994, 20.899999999999856, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 41.70000000000002, 32.50000000000002, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.1, 39.70000000000002], "episode_lengths": [260, 500, 266, 34, 100, 500, 500, 168, 98, 500, 500, 500, 406, 146, 30, 58, 500, 500, 500, 44, 76, 44, 292, 500, 34, 104, 100, 68, 164, 500, 46, 44, 500, 104, 24, 224, 500, 434, 500, 66, 500, 500, 34, 500, 302, 64, 500, 92, 34, 58, 114, 68, 204, 146, 52, 78, 500, 34, 40, 46, 56, 500, 50, 94, 500, 48, 90, 66, 62, 268, 492, 90, 154, 500, 56, 500, 284, 66, 58, 78, 500, 122, 48, 394, 40, 292, 32, 56, 500, 500, 64, 84, 176, 40, 500, 40, 500, 500, 190, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867157635998224, "mean_inference_ms": 1.2417269965694135, "mean_action_processing_ms": 0.14372463811695563, "mean_env_wait_ms": 0.085535286882479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991533279418945, "StateBufferConnector_ms": 0.004005908966064453, "ViewRequirementAgentConnector_ms": 0.13103318214416504}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.077999999999854, "episode_len_mean": 229.94, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.099999999999902, -50.00000000000044, 23.499999999999893, 46.699999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.499999999999694, 35.500000000000036, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, 45.7, 20.899999999999856, -50.00000000000044, 46.699999999999996, 39.70000000000002, 40.10000000000002, 43.30000000000001, 33.70000000000004, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 39.70000000000002, 47.7, 27.699999999999953, -50.00000000000044, 6.699999999999655, -50.00000000000044, 43.50000000000001, -50.00000000000044, 0.09999999999956088, 46.699999999999996, -50.00000000000044, 19.899999999999842, 43.7, -50.00000000000044, 40.90000000000002, 46.699999999999996, 44.300000000000004, 38.700000000000024, 43.30000000000001, 29.69999999999998, 35.500000000000036, 44.900000000000006, 42.30000000000001, -50.00000000000044, 46.699999999999996, 46.099999999999994, 45.5, 44.5, -50.00000000000044, 45.1, 40.70000000000002, -50.00000000000044, 45.3, 41.100000000000016, 43.50000000000001, 43.900000000000006, 23.29999999999989, 0.8999999999995723, 41.100000000000016, 34.70000000000004, -50.00000000000044, 44.5, -50.00000000000044, 21.699999999999868, 43.50000000000001, 44.300000000000004, 42.30000000000001, -50.00000000000044, 37.90000000000003, 45.3, 10.699999999999712, 46.099999999999994, 20.899999999999856, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 41.70000000000002, 32.50000000000002, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.1, 39.70000000000002], "episode_lengths": [260, 500, 266, 34, 100, 500, 500, 168, 98, 500, 500, 500, 406, 146, 30, 58, 500, 500, 500, 44, 76, 44, 292, 500, 34, 104, 100, 68, 164, 500, 46, 44, 500, 104, 24, 224, 500, 434, 500, 66, 500, 500, 34, 500, 302, 64, 500, 92, 34, 58, 114, 68, 204, 146, 52, 78, 500, 34, 40, 46, 56, 500, 50, 94, 500, 48, 90, 66, 62, 268, 492, 90, 154, 500, 56, 500, 284, 66, 58, 78, 500, 122, 48, 394, 40, 292, 32, 56, 500, 500, 64, 84, 176, 40, 500, 40, 500, 500, 190, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867157635998224, "mean_inference_ms": 1.2417269965694135, "mean_action_processing_ms": 0.14372463811695563, "mean_env_wait_ms": 0.085535286882479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991533279418945, "StateBufferConnector_ms": 0.004005908966064453, "ViewRequirementAgentConnector_ms": 0.13103318214416504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5281.681284704607, "num_env_steps_trained_throughput_per_sec": 5281.681284704607, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3466.257, "sample_time_ms": 2946.101, "load_time_ms": 18.017, "load_throughput": 999075.95, "learn_time_ms": 490.349, "learn_throughput": 36708.557, "synch_weights_time_ms": 9.488}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1854, "training_iteration": 27, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-31", "timestamp": 1698250711, "time_this_iter_s": 3.414003849029541, "time_total_s": 91.91365957260132, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.91365957260132, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 58.46, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384765e-09, "cur_lr": 0.0003, "total_loss": 6.521712017059326, "policy_loss": -0.00011782588230239021, "vf_loss": 6.521877341800266, "vf_explained_var": -6.833076477050782e-05, "kl": 0.0005789241463137134, "entropy": 0.4749586383501689, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1238.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.01299999999984, "episode_len_mean": 235.54, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.699999999999868, 43.50000000000001, 44.300000000000004, 42.30000000000001, -50.00000000000044, 37.90000000000003, 45.3, 10.699999999999712, 46.099999999999994, 20.899999999999856, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 41.70000000000002, 32.50000000000002, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.1, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, -50.00000000000044, 26.09999999999993, 16.09999999999979, -50.00000000000044, 46.5, 30.099999999999987, 42.500000000000014, 43.7, -50.00000000000044, 26.89999999999994, 42.900000000000006, 45.7, 42.70000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.10000000000001, 0.09999999999956088, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.7, 46.099999999999994, 46.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.7, 47.5, 46.699999999999996, 42.30000000000001, -50.00000000000044, 46.9, 46.9, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 27.49999999999995, 43.10000000000001, 45.3, -50.00000000000044, 46.5, 44.5, 39.90000000000002, -50.00000000000044, 45.5, 43.50000000000001, 39.50000000000002, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 43.7, 40.500000000000014, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 284, 66, 58, 78, 500, 122, 48, 394, 40, 292, 32, 56, 500, 500, 64, 84, 176, 40, 500, 40, 500, 500, 190, 104, 500, 500, 92, 58, 500, 240, 340, 500, 36, 200, 76, 64, 500, 232, 72, 44, 74, 500, 142, 500, 500, 112, 80, 500, 500, 150, 500, 154, 500, 54, 40, 36, 76, 500, 500, 62, 66, 54, 26, 34, 78, 500, 32, 32, 68, 52, 500, 500, 500, 500, 56, 226, 70, 48, 500, 36, 56, 102, 500, 46, 66, 106, 30, 500, 44, 500, 58, 64, 96, 348, 500, 500, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38717596802463644, "mean_inference_ms": 1.2388600202575433, "mean_action_processing_ms": 0.14413984911616626, "mean_env_wait_ms": 0.08590307974091724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200484275817871, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.11699390411376953}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.01299999999984, "episode_len_mean": 235.54, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.699999999999868, 43.50000000000001, 44.300000000000004, 42.30000000000001, -50.00000000000044, 37.90000000000003, 45.3, 10.699999999999712, 46.099999999999994, 20.899999999999856, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 41.70000000000002, 32.50000000000002, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 31.1, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.300000000000004, -50.00000000000044, 26.09999999999993, 16.09999999999979, -50.00000000000044, 46.5, 30.099999999999987, 42.500000000000014, 43.7, -50.00000000000044, 26.89999999999994, 42.900000000000006, 45.7, 42.70000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.10000000000001, 0.09999999999956088, -50.00000000000044, 35.10000000000004, -50.00000000000044, 34.70000000000004, -50.00000000000044, 44.7, 46.099999999999994, 46.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.7, 47.5, 46.699999999999996, 42.30000000000001, -50.00000000000044, 46.9, 46.9, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 27.49999999999995, 43.10000000000001, 45.3, -50.00000000000044, 46.5, 44.5, 39.90000000000002, -50.00000000000044, 45.5, 43.50000000000001, 39.50000000000002, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 43.7, 40.500000000000014, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 284, 66, 58, 78, 500, 122, 48, 394, 40, 292, 32, 56, 500, 500, 64, 84, 176, 40, 500, 40, 500, 500, 190, 104, 500, 500, 92, 58, 500, 240, 340, 500, 36, 200, 76, 64, 500, 232, 72, 44, 74, 500, 142, 500, 500, 112, 80, 500, 500, 150, 500, 154, 500, 54, 40, 36, 76, 500, 500, 62, 66, 54, 26, 34, 78, 500, 32, 32, 68, 52, 500, 500, 500, 500, 56, 226, 70, 48, 500, 36, 56, 102, 500, 46, 66, 106, 30, 500, 44, 500, 58, 64, 96, 348, 500, 500, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38717596802463644, "mean_inference_ms": 1.2388600202575433, "mean_action_processing_ms": 0.14413984911616626, "mean_env_wait_ms": 0.08590307974091724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200484275817871, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.11699390411376953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5366.721954046953, "num_env_steps_trained_throughput_per_sec": 5366.721954046953, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3449.317, "sample_time_ms": 2924.8, "load_time_ms": 17.917, "load_throughput": 1004650.45, "learn_time_ms": 494.909, "learn_throughput": 36370.352, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1929, "training_iteration": 28, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-35", "timestamp": 1698250715, "time_this_iter_s": 3.3590006828308105, "time_total_s": 95.27266025543213, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 95.27266025543213, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 65.05, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923825e-10, "cur_lr": 0.0003, "total_loss": 6.7246586269802515, "policy_loss": -0.00042233837561474907, "vf_loss": 6.72512510087755, "vf_explained_var": -6.324450174967448e-05, "kl": 0.0011350598848136112, "entropy": 0.4415566232469347, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.332999999999833, "episode_len_mean": 242.32, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 27.49999999999995, 43.10000000000001, 45.3, -50.00000000000044, 46.5, 44.5, 39.90000000000002, -50.00000000000044, 45.5, 43.50000000000001, 39.50000000000002, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 43.7, 40.500000000000014, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 4.899999999999629, 43.900000000000006, 44.300000000000004, 41.30000000000001, 42.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.30000000000001, 45.3, 47.1, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.89999999999987, 41.90000000000001, 47.1, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 41.100000000000016, 33.10000000000003, -50.00000000000044, 46.699999999999996, 39.70000000000002, -50.00000000000044, 46.9, 45.5, 21.89999999999987, 46.699999999999996, 36.900000000000034, -50.00000000000044, 38.700000000000024, 45.5, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 17.099999999999802, 43.900000000000006, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, 29.49999999999998, 31.900000000000013, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, 10.099999999999703, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 56, 226, 70, 48, 500, 36, 56, 102, 500, 46, 66, 106, 30, 500, 44, 500, 58, 64, 96, 348, 500, 500, 500, 500, 58, 452, 62, 58, 88, 72, 500, 30, 500, 48, 500, 500, 84, 500, 88, 48, 30, 132, 500, 500, 46, 500, 52, 500, 500, 282, 82, 30, 54, 500, 500, 500, 500, 50, 124, 90, 170, 500, 34, 104, 500, 32, 46, 282, 34, 132, 500, 114, 46, 42, 32, 500, 500, 330, 62, 42, 500, 50, 500, 84, 34, 500, 300, 62, 500, 206, 182, 180, 118, 500, 500, 68, 400, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38686647165227883, "mean_inference_ms": 1.2385242309708997, "mean_action_processing_ms": 0.14362271107485014, "mean_env_wait_ms": 0.08572335767248006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12999248504638672}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.332999999999833, "episode_len_mean": 242.32, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 27.49999999999995, 43.10000000000001, 45.3, -50.00000000000044, 46.5, 44.5, 39.90000000000002, -50.00000000000044, 45.5, 43.50000000000001, 39.50000000000002, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 43.7, 40.500000000000014, 15.299999999999777, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 4.899999999999629, 43.900000000000006, 44.300000000000004, 41.30000000000001, 42.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.30000000000001, 45.3, 47.1, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.89999999999987, 41.90000000000001, 47.1, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 37.70000000000003, 41.100000000000016, 33.10000000000003, -50.00000000000044, 46.699999999999996, 39.70000000000002, -50.00000000000044, 46.9, 45.5, 21.89999999999987, 46.699999999999996, 36.900000000000034, -50.00000000000044, 38.700000000000024, 45.5, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 17.099999999999802, 43.900000000000006, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, 29.49999999999998, 31.900000000000013, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, 10.099999999999703, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 56, 226, 70, 48, 500, 36, 56, 102, 500, 46, 66, 106, 30, 500, 44, 500, 58, 64, 96, 348, 500, 500, 500, 500, 58, 452, 62, 58, 88, 72, 500, 30, 500, 48, 500, 500, 84, 500, 88, 48, 30, 132, 500, 500, 46, 500, 52, 500, 500, 282, 82, 30, 54, 500, 500, 500, 500, 50, 124, 90, 170, 500, 34, 104, 500, 32, 46, 282, 34, 132, 500, 114, 46, 42, 32, 500, 500, 330, 62, 42, 500, 50, 500, 84, 34, 500, 300, 62, 500, 206, 182, 180, 118, 500, 500, 68, 400, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38686647165227883, "mean_inference_ms": 1.2385242309708997, "mean_action_processing_ms": 0.14362271107485014, "mean_env_wait_ms": 0.08572335767248006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12999248504638672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5431.500549391296, "num_env_steps_trained_throughput_per_sec": 5431.500549391296, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3417.617, "sample_time_ms": 2894.3, "load_time_ms": 18.02, "load_throughput": 998909.393, "learn_time_ms": 493.809, "learn_throughput": 36451.377, "synch_weights_time_ms": 9.386}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 2003, "training_iteration": 29, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-38", "timestamp": 1698250718, "time_this_iter_s": 3.3189992904663086, "time_total_s": 98.59165954589844, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.59165954589844, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.21999999999999, "ram_util_percent": 27.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619127e-10, "cur_lr": 0.0003, "total_loss": 6.397137302822537, "policy_loss": -0.0002993830376201206, "vf_loss": 6.3974793434143065, "vf_explained_var": 0.0009066091643439399, "kl": 0.0007624687734764595, "entropy": 0.4269463333818648, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1328.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.844999999999816, "episode_len_mean": 257.16, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 21.89999999999987, 46.699999999999996, 36.900000000000034, -50.00000000000044, 38.700000000000024, 45.5, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 17.099999999999802, 43.900000000000006, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, 29.49999999999998, 31.900000000000013, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, 10.099999999999703, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 45.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.5, 4.899999999999629, 43.900000000000006, 40.90000000000002, -50.00000000000044, 47.5, 46.099999999999994, 44.5, 24.899999999999913, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 42.500000000000014, 38.700000000000024, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 46.099999999999994, 41.500000000000014, 46.099999999999994, 46.099999999999994, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 24.299999999999905, -50.00000000000044, -50.00000000000044, 41.100000000000016, 24.499999999999908, 45.9, 40.500000000000014, 46.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, 44.7, 25.699999999999925], "episode_lengths": [46, 282, 34, 132, 500, 114, 46, 42, 32, 500, 500, 330, 62, 42, 500, 50, 500, 84, 34, 500, 300, 62, 500, 206, 182, 180, 118, 500, 500, 68, 400, 500, 34, 500, 50, 44, 500, 500, 54, 500, 500, 500, 500, 30, 36, 452, 62, 92, 500, 26, 40, 56, 252, 110, 500, 500, 74, 500, 500, 38, 500, 76, 114, 22, 500, 500, 500, 48, 80, 40, 86, 40, 40, 28, 500, 500, 500, 500, 500, 48, 258, 500, 500, 90, 256, 42, 96, 32, 500, 72, 500, 500, 500, 44, 500, 82, 500, 28, 54, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869412018029581, "mean_inference_ms": 1.237949452768028, "mean_action_processing_ms": 0.14318549841659148, "mean_env_wait_ms": 0.08541248743965203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027013301849365234, "StateBufferConnector_ms": 0.007997274398803711, "ViewRequirementAgentConnector_ms": 0.10899949073791504}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.844999999999816, "episode_len_mean": 257.16, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 21.89999999999987, 46.699999999999996, 36.900000000000034, -50.00000000000044, 38.700000000000024, 45.5, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 17.099999999999802, 43.900000000000006, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 20.099999999999845, 43.900000000000006, -50.00000000000044, 29.49999999999998, 31.900000000000013, 32.100000000000016, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, 10.099999999999703, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 45.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.5, 4.899999999999629, 43.900000000000006, 40.90000000000002, -50.00000000000044, 47.5, 46.099999999999994, 44.5, 24.899999999999913, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 42.500000000000014, 38.700000000000024, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 46.099999999999994, 41.500000000000014, 46.099999999999994, 46.099999999999994, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 24.299999999999905, -50.00000000000044, -50.00000000000044, 41.100000000000016, 24.499999999999908, 45.9, 40.500000000000014, 46.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, 44.7, 25.699999999999925], "episode_lengths": [46, 282, 34, 132, 500, 114, 46, 42, 32, 500, 500, 330, 62, 42, 500, 50, 500, 84, 34, 500, 300, 62, 500, 206, 182, 180, 118, 500, 500, 68, 400, 500, 34, 500, 50, 44, 500, 500, 54, 500, 500, 500, 500, 30, 36, 452, 62, 92, 500, 26, 40, 56, 252, 110, 500, 500, 74, 500, 500, 38, 500, 76, 114, 22, 500, 500, 500, 48, 80, 40, 86, 40, 40, 28, 500, 500, 500, 500, 500, 48, 258, 500, 500, 90, 256, 42, 96, 32, 500, 72, 500, 500, 500, 44, 500, 82, 500, 28, 54, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869412018029581, "mean_inference_ms": 1.237949452768028, "mean_action_processing_ms": 0.14318549841659148, "mean_env_wait_ms": 0.08541248743965203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027013301849365234, "StateBufferConnector_ms": 0.007997274398803711, "ViewRequirementAgentConnector_ms": 0.10899949073791504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5072.852430081826, "num_env_steps_trained_throughput_per_sec": 5072.852430081826, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3419.646, "sample_time_ms": 2892.301, "load_time_ms": 17.917, "load_throughput": 1004655.797, "learn_time_ms": 498.108, "learn_throughput": 36136.717, "synch_weights_time_ms": 9.219}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2070, "training_iteration": 30, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-42", "timestamp": 1698250722, "time_this_iter_s": 3.55329966545105, "time_total_s": 102.14495921134949, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.14495921134949, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 62.879999999999995, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309564e-10, "cur_lr": 0.0003, "total_loss": 6.339442592196995, "policy_loss": -0.00033471319410536025, "vf_loss": 6.33982596927219, "vf_explained_var": -0.006689944532182482, "kl": 0.001097078485169176, "entropy": 0.4868321683671739, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.305999999999845, "episode_len_mean": 227.6, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 24.499999999999908, 45.9, 40.500000000000014, 46.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, 44.7, 25.699999999999925, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 40.70000000000002, 40.90000000000002, 46.699999999999996, 3.2999999999996064, -50.00000000000044, 39.10000000000002, 40.90000000000002, 0.49999999999956657, 47.1, 44.5, 41.500000000000014, -50.00000000000044, 46.5, 46.3, 44.7, 43.30000000000001, 43.10000000000001, 37.10000000000003, 44.10000000000001, 45.1, -50.00000000000044, 28.89999999999997, 41.30000000000001, 42.10000000000001, 45.9, 45.7, 46.5, 36.70000000000003, 45.1, -50.00000000000044, 46.3, 35.30000000000004, 40.10000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 46.3, 42.30000000000001, 43.10000000000001, -50.00000000000044, 47.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 45.7, 46.099999999999994, 46.9, 38.300000000000026, -50.00000000000044, 45.9, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 90, 256, 42, 96, 32, 500, 72, 500, 500, 500, 44, 500, 82, 500, 28, 54, 244, 40, 500, 500, 38, 94, 92, 34, 468, 500, 110, 92, 496, 30, 56, 86, 500, 36, 38, 54, 68, 70, 130, 60, 50, 500, 212, 88, 80, 42, 44, 36, 134, 50, 500, 38, 148, 100, 500, 114, 500, 144, 38, 78, 70, 500, 30, 80, 500, 500, 500, 66, 500, 500, 78, 500, 60, 48, 500, 26, 500, 46, 70, 500, 44, 40, 32, 118, 500, 42, 202, 500, 38, 500, 56, 44, 500, 500, 500, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38662147927850676, "mean_inference_ms": 1.2369108764322825, "mean_action_processing_ms": 0.14337621772518921, "mean_env_wait_ms": 0.08531446725103312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027363300323486328, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.12403631210327148}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.305999999999845, "episode_len_mean": 227.6, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 24.499999999999908, 45.9, 40.500000000000014, 46.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.3, 44.7, 25.699999999999925, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 40.70000000000002, 40.90000000000002, 46.699999999999996, 3.2999999999996064, -50.00000000000044, 39.10000000000002, 40.90000000000002, 0.49999999999956657, 47.1, 44.5, 41.500000000000014, -50.00000000000044, 46.5, 46.3, 44.7, 43.30000000000001, 43.10000000000001, 37.10000000000003, 44.10000000000001, 45.1, -50.00000000000044, 28.89999999999997, 41.30000000000001, 42.10000000000001, 45.9, 45.7, 46.5, 36.70000000000003, 45.1, -50.00000000000044, 46.3, 35.30000000000004, 40.10000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 35.70000000000003, 46.3, 42.30000000000001, 43.10000000000001, -50.00000000000044, 47.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 45.7, 46.099999999999994, 46.9, 38.300000000000026, -50.00000000000044, 45.9, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 90, 256, 42, 96, 32, 500, 72, 500, 500, 500, 44, 500, 82, 500, 28, 54, 244, 40, 500, 500, 38, 94, 92, 34, 468, 500, 110, 92, 496, 30, 56, 86, 500, 36, 38, 54, 68, 70, 130, 60, 50, 500, 212, 88, 80, 42, 44, 36, 134, 50, 500, 38, 148, 100, 500, 114, 500, 144, 38, 78, 70, 500, 30, 80, 500, 500, 500, 66, 500, 500, 78, 500, 60, 48, 500, 26, 500, 46, 70, 500, 44, 40, 32, 118, 500, 42, 202, 500, 38, 500, 56, 44, 500, 500, 500, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38662147927850676, "mean_inference_ms": 1.2369108764322825, "mean_action_processing_ms": 0.14337621772518921, "mean_env_wait_ms": 0.08531446725103312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027363300323486328, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.12403631210327148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5340.803634641145, "num_env_steps_trained_throughput_per_sec": 5340.803634641145, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3429.174, "sample_time_ms": 2911.394, "load_time_ms": 18.113, "load_throughput": 993746.061, "learn_time_ms": 488.349, "learn_throughput": 36858.918, "synch_weights_time_ms": 9.216}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2152, "training_iteration": 31, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-45", "timestamp": 1698250725, "time_this_iter_s": 3.376272439956665, "time_total_s": 105.52123165130615, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.52123165130615, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 59.94, "ram_util_percent": 27.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154782e-11, "cur_lr": 0.0003, "total_loss": 6.436809550391303, "policy_loss": -0.0003206882211897108, "vf_loss": 6.437176269955105, "vf_explained_var": -0.005366775724622939, "kl": 0.0010377113452907198, "entropy": 0.46065539055400423, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.814999999999827, "episode_len_mean": 247.48, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 45.7, 46.099999999999994, 46.9, 38.300000000000026, -50.00000000000044, 45.9, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 47.7, -50.00000000000044, 39.90000000000002, 36.10000000000004, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.70000000000002, 42.500000000000014, 45.9, -50.00000000000044, 39.300000000000026, 46.099999999999994, 17.499999999999808, 43.10000000000001, 46.5, 43.7, 20.299999999999848, 40.10000000000002, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.699999999999996, 27.699999999999953, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.5, -50.00000000000044, 44.900000000000006, 41.100000000000016, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 34.50000000000004, 44.7, 15.699999999999783, 46.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 45.5, 42.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, 45.9], "episode_lengths": [78, 500, 60, 48, 500, 26, 500, 46, 70, 500, 44, 40, 32, 118, 500, 42, 202, 500, 38, 500, 56, 44, 500, 500, 500, 500, 42, 500, 500, 500, 500, 394, 24, 500, 102, 140, 32, 500, 42, 500, 76, 500, 84, 76, 42, 500, 108, 40, 326, 70, 36, 64, 298, 100, 500, 428, 500, 500, 174, 500, 34, 224, 500, 500, 214, 56, 500, 52, 90, 42, 40, 500, 500, 40, 60, 156, 54, 344, 38, 500, 82, 156, 500, 500, 32, 500, 218, 500, 170, 54, 42, 46, 80, 130, 500, 500, 68, 500, 42, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38788843546510776, "mean_inference_ms": 1.2380417649363638, "mean_action_processing_ms": 0.14344732549030292, "mean_env_wait_ms": 0.08523013628219134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028012990951538086, "StateBufferConnector_ms": 0.005005598068237305, "ViewRequirementAgentConnector_ms": 0.12303924560546875}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.814999999999827, "episode_len_mean": 247.48, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 44.10000000000001, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 45.7, 46.099999999999994, 46.9, 38.300000000000026, -50.00000000000044, 45.9, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 47.7, -50.00000000000044, 39.90000000000002, 36.10000000000004, 46.9, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.70000000000002, 42.500000000000014, 45.9, -50.00000000000044, 39.300000000000026, 46.099999999999994, 17.499999999999808, 43.10000000000001, 46.5, 43.7, 20.299999999999848, 40.10000000000002, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.699999999999996, 27.699999999999953, -50.00000000000044, -50.00000000000044, 28.699999999999967, 44.5, -50.00000000000044, 44.900000000000006, 41.100000000000016, 45.9, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 34.50000000000004, 44.7, 15.699999999999783, 46.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 45.5, 42.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, 45.9], "episode_lengths": [78, 500, 60, 48, 500, 26, 500, 46, 70, 500, 44, 40, 32, 118, 500, 42, 202, 500, 38, 500, 56, 44, 500, 500, 500, 500, 42, 500, 500, 500, 500, 394, 24, 500, 102, 140, 32, 500, 42, 500, 76, 500, 84, 76, 42, 500, 108, 40, 326, 70, 36, 64, 298, 100, 500, 428, 500, 500, 174, 500, 34, 224, 500, 500, 214, 56, 500, 52, 90, 42, 40, 500, 500, 40, 60, 156, 54, 344, 38, 500, 82, 156, 500, 500, 32, 500, 218, 500, 170, 54, 42, 46, 80, 130, 500, 500, 68, 500, 42, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38788843546510776, "mean_inference_ms": 1.2380417649363638, "mean_action_processing_ms": 0.14344732549030292, "mean_env_wait_ms": 0.08523013628219134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028012990951538086, "StateBufferConnector_ms": 0.005005598068237305, "ViewRequirementAgentConnector_ms": 0.12303924560546875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5245.8198448713965, "num_env_steps_trained_throughput_per_sec": 5245.8198448713965, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3408.778, "sample_time_ms": 2905.093, "load_time_ms": 18.114, "load_throughput": 993732.981, "learn_time_ms": 474.253, "learn_throughput": 37954.457, "synch_weights_time_ms": 9.116}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2223, "training_iteration": 32, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-48", "timestamp": 1698250728, "time_this_iter_s": 3.43730092048645, "time_total_s": 108.9585325717926, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.9585325717926, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 57.94, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077391e-11, "cur_lr": 0.0003, "total_loss": 6.637606101565891, "policy_loss": -0.0004573575324482388, "vf_loss": 6.638114505343967, "vf_explained_var": -0.0027175638410780164, "kl": 0.0006577187537977301, "entropy": 0.509466313653522, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.790999999999822, "episode_len_mean": 257.72, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 34.50000000000004, 44.7, 15.699999999999783, 46.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 45.5, 42.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, 45.9, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, 45.5, 38.50000000000003, 41.500000000000014, 22.49999999999988, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 32.100000000000016, 8.899999999999686, 47.1, -50.00000000000044, 46.9, 36.30000000000003, 32.30000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, 44.300000000000004, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, 3.2999999999996064, 40.30000000000002, 44.5, 44.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, 46.699999999999996, 8.49999999999968, 40.500000000000014, -50.00000000000044, 47.1, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.7, 42.70000000000001, 26.299999999999933, 47.5, 47.9, 42.70000000000001, 44.7], "episode_lengths": [40, 500, 500, 40, 60, 156, 54, 344, 38, 500, 82, 156, 500, 500, 32, 500, 218, 500, 170, 54, 42, 46, 80, 130, 500, 500, 68, 500, 42, 42, 500, 122, 500, 74, 46, 116, 86, 276, 500, 500, 94, 500, 180, 412, 30, 500, 32, 138, 178, 500, 500, 200, 58, 40, 500, 48, 500, 468, 98, 56, 56, 500, 136, 500, 32, 500, 500, 500, 500, 446, 500, 500, 500, 318, 500, 66, 34, 416, 96, 500, 30, 40, 34, 500, 64, 500, 38, 500, 500, 120, 500, 148, 500, 64, 74, 238, 26, 22, 74, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878950604598985, "mean_inference_ms": 1.2397785508516959, "mean_action_processing_ms": 0.14409347798132718, "mean_env_wait_ms": 0.08572070717022245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033008575439453125, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.1293184757232666}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.790999999999822, "episode_len_mean": 257.72, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 34.50000000000004, 44.7, 15.699999999999783, 46.3, -50.00000000000044, 41.90000000000001, 34.50000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.10000000000003, 44.7, 45.9, 45.5, 42.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.9, 45.9, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, 45.5, 38.50000000000003, 41.500000000000014, 22.49999999999988, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 32.100000000000016, 8.899999999999686, 47.1, -50.00000000000044, 46.9, 36.30000000000003, 32.30000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, 44.300000000000004, 46.099999999999994, -50.00000000000044, 45.3, -50.00000000000044, 3.2999999999996064, 40.30000000000002, 44.5, 44.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, 46.699999999999996, 8.49999999999968, 40.500000000000014, -50.00000000000044, 47.1, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.7, 42.70000000000001, 26.299999999999933, 47.5, 47.9, 42.70000000000001, 44.7], "episode_lengths": [40, 500, 500, 40, 60, 156, 54, 344, 38, 500, 82, 156, 500, 500, 32, 500, 218, 500, 170, 54, 42, 46, 80, 130, 500, 500, 68, 500, 42, 42, 500, 122, 500, 74, 46, 116, 86, 276, 500, 500, 94, 500, 180, 412, 30, 500, 32, 138, 178, 500, 500, 200, 58, 40, 500, 48, 500, 468, 98, 56, 56, 500, 136, 500, 32, 500, 500, 500, 500, 446, 500, 500, 500, 318, 500, 66, 34, 416, 96, 500, 30, 40, 34, 500, 64, 500, 38, 500, 500, 120, 500, 148, 500, 64, 74, 238, 26, 22, 74, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878950604598985, "mean_inference_ms": 1.2397785508516959, "mean_action_processing_ms": 0.14409347798132718, "mean_env_wait_ms": 0.08572070717022245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033008575439453125, "StateBufferConnector_ms": 0.0049953460693359375, "ViewRequirementAgentConnector_ms": 0.1293184757232666}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5046.252423869721, "num_env_steps_trained_throughput_per_sec": 5046.252423869721, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3422.678, "sample_time_ms": 2912.493, "load_time_ms": 18.611, "load_throughput": 967185.958, "learn_time_ms": 480.453, "learn_throughput": 37464.677, "synch_weights_time_ms": 8.919}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2293, "training_iteration": 33, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-52", "timestamp": 1698250732, "time_this_iter_s": 3.57300066947937, "time_total_s": 112.53153324127197, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.53153324127197, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 59.64, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386954e-11, "cur_lr": 0.0003, "total_loss": 6.281224727630615, "policy_loss": -0.00014050205548604328, "vf_loss": 6.281415907541911, "vf_explained_var": -0.013196318679385715, "kl": 0.0009377849402783215, "entropy": 0.5074603603945838, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1508.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.990999999999819, "episode_len_mean": 255.74, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.499999999999638, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, 46.699999999999996, 8.49999999999968, 40.500000000000014, -50.00000000000044, 47.1, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.7, 42.70000000000001, 26.299999999999933, 47.5, 47.9, 42.70000000000001, 44.7, -50.00000000000044, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.300000000000004, 45.5, 19.299999999999834, -50.00000000000044, 33.90000000000004, 42.70000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.699999999999996, 46.3, -50.00000000000044, 45.1, 43.10000000000001, 46.5, 39.50000000000002, 44.5, 13.899999999999757, -50.00000000000044, 1.4999999999995808, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.099999999999994, 46.9, 41.500000000000014, 41.500000000000014, -50.00000000000044, 44.7, 45.9, 22.099999999999874, -50.00000000000044, 43.50000000000001, 36.30000000000003, -50.00000000000044, 26.499999999999936, 41.30000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.900000000000006, 46.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 23.29999999999989, 43.30000000000001, 46.3, 42.10000000000001, 13.099999999999746, -50.00000000000044, 33.10000000000003, 47.7, 46.3, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [446, 500, 500, 500, 318, 500, 66, 34, 416, 96, 500, 30, 40, 34, 500, 64, 500, 38, 500, 500, 120, 500, 148, 500, 64, 74, 238, 26, 22, 74, 54, 500, 38, 500, 48, 500, 396, 500, 500, 290, 58, 46, 308, 500, 162, 74, 56, 500, 500, 500, 500, 194, 34, 38, 500, 50, 70, 36, 106, 56, 362, 500, 486, 500, 102, 500, 40, 32, 86, 86, 500, 54, 42, 280, 500, 66, 138, 500, 236, 88, 500, 118, 500, 62, 38, 202, 500, 500, 268, 68, 38, 80, 370, 500, 170, 24, 38, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876795348552853, "mean_inference_ms": 1.2398037418977434, "mean_action_processing_ms": 0.14413985008537342, "mean_env_wait_ms": 0.085922263794845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250091552734375, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1210014820098877}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.990999999999819, "episode_len_mean": 255.74, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.499999999999638, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, 46.699999999999996, 8.49999999999968, 40.500000000000014, -50.00000000000044, 47.1, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 43.7, 42.70000000000001, 26.299999999999933, 47.5, 47.9, 42.70000000000001, 44.7, -50.00000000000044, 46.3, -50.00000000000044, 45.3, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.300000000000004, 45.5, 19.299999999999834, -50.00000000000044, 33.90000000000004, 42.70000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.699999999999996, 46.3, -50.00000000000044, 45.1, 43.10000000000001, 46.5, 39.50000000000002, 44.5, 13.899999999999757, -50.00000000000044, 1.4999999999995808, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.099999999999994, 46.9, 41.500000000000014, 41.500000000000014, -50.00000000000044, 44.7, 45.9, 22.099999999999874, -50.00000000000044, 43.50000000000001, 36.30000000000003, -50.00000000000044, 26.499999999999936, 41.30000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.900000000000006, 46.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 23.29999999999989, 43.30000000000001, 46.3, 42.10000000000001, 13.099999999999746, -50.00000000000044, 33.10000000000003, 47.7, 46.3, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [446, 500, 500, 500, 318, 500, 66, 34, 416, 96, 500, 30, 40, 34, 500, 64, 500, 38, 500, 500, 120, 500, 148, 500, 64, 74, 238, 26, 22, 74, 54, 500, 38, 500, 48, 500, 396, 500, 500, 290, 58, 46, 308, 500, 162, 74, 56, 500, 500, 500, 500, 194, 34, 38, 500, 50, 70, 36, 106, 56, 362, 500, 486, 500, 102, 500, 40, 32, 86, 86, 500, 54, 42, 280, 500, 66, 138, 500, 236, 88, 500, 118, 500, 62, 38, 202, 500, 500, 268, 68, 38, 80, 370, 500, 170, 24, 38, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876795348552853, "mean_inference_ms": 1.2398037418977434, "mean_action_processing_ms": 0.14413985008537342, "mean_env_wait_ms": 0.085922263794845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250091552734375, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1210014820098877}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5147.265960297229, "num_env_steps_trained_throughput_per_sec": 5147.265960297229, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3438.678, "sample_time_ms": 2924.193, "load_time_ms": 18.611, "load_throughput": 967158.7, "learn_time_ms": 484.552, "learn_throughput": 37147.718, "synch_weights_time_ms": 9.019}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2362, "training_iteration": 34, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-55", "timestamp": 1698250735, "time_this_iter_s": 3.502000093460083, "time_total_s": 116.03353333473206, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.03353333473206, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 57.720000000000006, "ram_util_percent": 27.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693477e-11, "cur_lr": 0.0003, "total_loss": 6.5430084122551815, "policy_loss": -0.0004109782735920615, "vf_loss": 6.543468210432264, "vf_explained_var": 0.0011402408281962076, "kl": 0.0009426058013644933, "entropy": 0.4876122852166494, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.45199999999982, "episode_len_mean": 256.1, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 45.9, 22.099999999999874, -50.00000000000044, 43.50000000000001, 36.30000000000003, -50.00000000000044, 26.499999999999936, 41.30000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.900000000000006, 46.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 23.29999999999989, 43.30000000000001, 46.3, 42.10000000000001, 13.099999999999746, -50.00000000000044, 33.10000000000003, 47.7, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.7, 34.70000000000004, 44.10000000000001, 45.9, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 31.900000000000013, -50.00000000000044, 41.100000000000016, 45.7, 43.900000000000006, 28.499999999999964, -50.00000000000044, 13.899999999999757, -50.00000000000044, 8.899999999999686, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 47.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.7, 34.30000000000004, 45.7, 47.3, -50.00000000000044, 40.500000000000014, 8.299999999999677, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 39.10000000000002, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, -50.00000000000044, 28.699999999999967], "episode_lengths": [500, 54, 42, 280, 500, 66, 138, 500, 236, 88, 500, 118, 500, 62, 38, 202, 500, 500, 268, 68, 38, 80, 370, 500, 170, 24, 38, 38, 500, 500, 500, 500, 500, 500, 500, 56, 44, 154, 60, 42, 38, 500, 46, 500, 32, 72, 500, 58, 500, 86, 60, 500, 30, 500, 92, 500, 500, 36, 182, 500, 90, 44, 62, 216, 500, 362, 500, 412, 64, 500, 500, 136, 28, 500, 56, 44, 500, 500, 182, 44, 158, 44, 28, 500, 96, 418, 42, 500, 38, 500, 110, 78, 500, 44, 500, 500, 36, 58, 500, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873251365859505, "mean_inference_ms": 1.2382419693546576, "mean_action_processing_ms": 0.14389940666634385, "mean_env_wait_ms": 0.08566799076684589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200045108795166, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.13097667694091797}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.45199999999982, "episode_len_mean": 256.1, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 45.9, 22.099999999999874, -50.00000000000044, 43.50000000000001, 36.30000000000003, -50.00000000000044, 26.499999999999936, 41.30000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.900000000000006, 46.3, 29.899999999999984, -50.00000000000044, -50.00000000000044, 23.29999999999989, 43.30000000000001, 46.3, 42.10000000000001, 13.099999999999746, -50.00000000000044, 33.10000000000003, 47.7, 46.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.7, 34.70000000000004, 44.10000000000001, 45.9, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 31.900000000000013, -50.00000000000044, 41.100000000000016, 45.7, 43.900000000000006, 28.499999999999964, -50.00000000000044, 13.899999999999757, -50.00000000000044, 8.899999999999686, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 47.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.7, 34.30000000000004, 45.7, 47.3, -50.00000000000044, 40.500000000000014, 8.299999999999677, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 39.10000000000002, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, -50.00000000000044, 28.699999999999967], "episode_lengths": [500, 54, 42, 280, 500, 66, 138, 500, 236, 88, 500, 118, 500, 62, 38, 202, 500, 500, 268, 68, 38, 80, 370, 500, 170, 24, 38, 38, 500, 500, 500, 500, 500, 500, 500, 56, 44, 154, 60, 42, 38, 500, 46, 500, 32, 72, 500, 58, 500, 86, 60, 500, 30, 500, 92, 500, 500, 36, 182, 500, 90, 44, 62, 216, 500, 362, 500, 412, 64, 500, 500, 136, 28, 500, 56, 44, 500, 500, 182, 44, 158, 44, 28, 500, 96, 418, 42, 500, 38, 500, 110, 78, 500, 44, 500, 500, 36, 58, 500, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873251365859505, "mean_inference_ms": 1.2382419693546576, "mean_action_processing_ms": 0.14389940666634385, "mean_env_wait_ms": 0.08566799076684589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200045108795166, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.13097667694091797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5546.090547404244, "num_env_steps_trained_throughput_per_sec": 5546.090547404244, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3420.431, "sample_time_ms": 2909.146, "load_time_ms": 18.411, "load_throughput": 977674.249, "learn_time_ms": 481.656, "learn_throughput": 37371.101, "synch_weights_time_ms": 8.816}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2432, "training_iteration": 35, "trial_id": "9f288_00021", "date": "2023-10-25_17-18-59", "timestamp": 1698250739, "time_this_iter_s": 3.250526189804077, "time_total_s": 119.28405952453613, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 119.28405952453613, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346739e-12, "cur_lr": 0.0003, "total_loss": 6.389976268344455, "policy_loss": -0.0003467595411671533, "vf_loss": 6.390366617838541, "vf_explained_var": -0.0032280604044596355, "kl": 0.0013222577518553812, "entropy": 0.4361814737319946, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1598.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6949999999997969, "episode_len_mean": 278.62, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 43.900000000000006, 28.499999999999964, -50.00000000000044, 13.899999999999757, -50.00000000000044, 8.899999999999686, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 47.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.7, 34.30000000000004, 45.7, 47.3, -50.00000000000044, 40.500000000000014, 8.299999999999677, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 39.10000000000002, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.499999999999609, 37.10000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 47.9, 41.90000000000001, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 45.7, 38.700000000000024, -50.00000000000044, 46.699999999999996, 46.3, 35.10000000000004, -50.00000000000044, 13.699999999999754, -50.00000000000044, 42.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 39.90000000000002, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, 29.69999999999998, -50.00000000000044], "episode_lengths": [44, 62, 216, 500, 362, 500, 412, 64, 500, 500, 136, 28, 500, 56, 44, 500, 500, 182, 44, 158, 44, 28, 500, 96, 418, 42, 500, 38, 500, 110, 78, 500, 44, 500, 500, 36, 58, 500, 214, 500, 500, 500, 500, 500, 500, 36, 56, 58, 500, 500, 176, 500, 500, 500, 500, 52, 466, 130, 500, 132, 500, 500, 22, 82, 44, 500, 52, 500, 36, 44, 114, 500, 34, 38, 150, 500, 364, 500, 76, 162, 500, 500, 500, 40, 44, 40, 60, 500, 500, 40, 44, 102, 500, 306, 500, 500, 106, 38, 204, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.387321177105494, "mean_inference_ms": 1.2394580555359425, "mean_action_processing_ms": 0.14368053511562412, "mean_env_wait_ms": 0.08547434006015851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.006000041961669922, "ViewRequirementAgentConnector_ms": 0.1380002498626709}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.6949999999997969, "episode_len_mean": 278.62, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 43.900000000000006, 28.499999999999964, -50.00000000000044, 13.899999999999757, -50.00000000000044, 8.899999999999686, 43.7, -50.00000000000044, -50.00000000000044, 36.50000000000003, 47.3, -50.00000000000044, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.7, 34.30000000000004, 45.7, 47.3, -50.00000000000044, 40.500000000000014, 8.299999999999677, 45.9, -50.00000000000044, 46.3, -50.00000000000044, 39.10000000000002, 42.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 3.499999999999609, 37.10000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 47.9, 41.90000000000001, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 45.7, 38.700000000000024, -50.00000000000044, 46.699999999999996, 46.3, 35.10000000000004, -50.00000000000044, 13.699999999999754, -50.00000000000044, 42.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 39.90000000000002, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, 29.69999999999998, -50.00000000000044], "episode_lengths": [44, 62, 216, 500, 362, 500, 412, 64, 500, 500, 136, 28, 500, 56, 44, 500, 500, 182, 44, 158, 44, 28, 500, 96, 418, 42, 500, 38, 500, 110, 78, 500, 44, 500, 500, 36, 58, 500, 214, 500, 500, 500, 500, 500, 500, 36, 56, 58, 500, 500, 176, 500, 500, 500, 500, 52, 466, 130, 500, 132, 500, 500, 22, 82, 44, 500, 52, 500, 36, 44, 114, 500, 34, 38, 150, 500, 364, 500, 76, 162, 500, 500, 500, 40, 44, 40, 60, 500, 500, 40, 44, 102, 500, 306, 500, 500, 106, 38, 204, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.387321177105494, "mean_inference_ms": 1.2394580555359425, "mean_action_processing_ms": 0.14368053511562412, "mean_env_wait_ms": 0.08547434006015851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.006000041961669922, "ViewRequirementAgentConnector_ms": 0.1380002498626709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4966.882416404076, "num_env_steps_trained_throughput_per_sec": 4966.882416404076, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3435.843, "sample_time_ms": 2920.447, "load_time_ms": 19.208, "load_throughput": 937125.721, "learn_time_ms": 484.868, "learn_throughput": 37123.491, "synch_weights_time_ms": 9.019}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2493, "training_iteration": 36, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-02", "timestamp": 1698250742, "time_this_iter_s": 3.6290009021759033, "time_total_s": 122.91306042671204, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 122.91306042671204, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 62.48, "ram_util_percent": 27.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733693e-12, "cur_lr": 0.0003, "total_loss": 6.555940384334988, "policy_loss": -0.00011800544129477606, "vf_loss": 6.556103642781576, "vf_explained_var": -0.002873327996995714, "kl": 0.00040143701666642707, "entropy": 0.45257430771986645, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1643.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.314999999999822, "episode_len_mean": 252.48, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.3, 35.10000000000004, -50.00000000000044, 13.699999999999754, -50.00000000000044, 42.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 39.90000000000002, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, 29.69999999999998, -50.00000000000044, 45.9, 45.5, -50.00000000000044, 40.500000000000014, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.099999999999994, 47.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, 23.29999999999989, 47.3, 7.499999999999666, 45.1, 17.499999999999808, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.699999999999996, 37.300000000000026, 47.1, 34.50000000000004, 43.30000000000001, 31.900000000000013, 46.9, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, 26.89999999999994, 13.499999999999751, 38.700000000000024, 43.7, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.099999999999945, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 27.699999999999953], "episode_lengths": [34, 38, 150, 500, 364, 500, 76, 162, 500, 500, 500, 40, 44, 40, 60, 500, 500, 40, 44, 102, 500, 306, 500, 500, 106, 38, 204, 500, 42, 46, 500, 96, 386, 500, 500, 500, 22, 36, 40, 26, 500, 30, 500, 500, 500, 500, 500, 500, 40, 48, 268, 28, 426, 50, 326, 500, 62, 500, 500, 500, 98, 34, 128, 30, 156, 68, 182, 32, 40, 124, 500, 34, 500, 232, 366, 114, 64, 48, 46, 500, 500, 62, 500, 44, 64, 500, 500, 90, 230, 54, 500, 32, 500, 38, 194, 500, 60, 40, 500, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38811017927160146, "mean_inference_ms": 1.2411359292073003, "mean_action_processing_ms": 0.14415106797697985, "mean_env_wait_ms": 0.08586268284322753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499699592590332, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.1450197696685791}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.314999999999822, "episode_len_mean": 252.48, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.3, 35.10000000000004, -50.00000000000044, 13.699999999999754, -50.00000000000044, 42.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 46.099999999999994, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.7, 39.90000000000002, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.3, 29.69999999999998, -50.00000000000044, 45.9, 45.5, -50.00000000000044, 40.500000000000014, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 46.5, 46.099999999999994, 47.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.3, 23.29999999999989, 47.3, 7.499999999999666, 45.1, 17.499999999999808, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.699999999999996, 37.300000000000026, 47.1, 34.50000000000004, 43.30000000000001, 31.900000000000013, 46.9, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, 26.89999999999994, 13.499999999999751, 38.700000000000024, 43.7, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.099999999999945, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 27.699999999999953], "episode_lengths": [34, 38, 150, 500, 364, 500, 76, 162, 500, 500, 500, 40, 44, 40, 60, 500, 500, 40, 44, 102, 500, 306, 500, 500, 106, 38, 204, 500, 42, 46, 500, 96, 386, 500, 500, 500, 22, 36, 40, 26, 500, 30, 500, 500, 500, 500, 500, 500, 40, 48, 268, 28, 426, 50, 326, 500, 62, 500, 500, 500, 98, 34, 128, 30, 156, 68, 182, 32, 40, 124, 500, 34, 500, 232, 366, 114, 64, 48, 46, 500, 500, 62, 500, 44, 64, 500, 500, 90, 230, 54, 500, 32, 500, 38, 194, 500, 60, 40, 500, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38811017927160146, "mean_inference_ms": 1.2411359292073003, "mean_action_processing_ms": 0.14415106797697985, "mean_env_wait_ms": 0.08586268284322753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499699592590332, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.1450197696685791}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4960.042530339723, "num_env_steps_trained_throughput_per_sec": 4960.042530339723, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3457.943, "sample_time_ms": 2937.747, "load_time_ms": 19.311, "load_throughput": 932089.419, "learn_time_ms": 489.661, "learn_throughput": 36760.11, "synch_weights_time_ms": 8.922}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2565, "training_iteration": 37, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-06", "timestamp": 1698250746, "time_this_iter_s": 3.6349995136260986, "time_total_s": 126.54805994033813, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.54805994033813, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 69.0, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366847e-12, "cur_lr": 0.0003, "total_loss": 6.594719643063016, "policy_loss": -0.00018376832207043966, "vf_loss": 6.59494883219401, "vf_explained_var": -0.0009510278701782227, "kl": 0.0005637554794314307, "entropy": 0.4540799021720886, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.58499999999983, "episode_len_mean": 249.78, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.89999999999994, 13.499999999999751, 38.700000000000024, 43.7, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.099999999999945, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 11.499999999999723, 39.70000000000002, 46.5, 41.30000000000001, 46.5, 38.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.7, 40.10000000000002, 46.3, 43.7, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.7, 37.10000000000003, 40.30000000000002, 46.5, 39.90000000000002, 37.90000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.500000000000014, 44.7, 46.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.1, 32.30000000000002, 46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.900000000000006, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 45.7, 18.29999999999982, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.300000000000026, -50.00000000000044, 46.099999999999994], "episode_lengths": [232, 366, 114, 64, 48, 46, 500, 500, 62, 500, 44, 64, 500, 500, 90, 230, 54, 500, 32, 500, 38, 194, 500, 60, 40, 500, 224, 500, 500, 386, 104, 36, 88, 36, 120, 500, 66, 500, 54, 100, 38, 64, 500, 370, 500, 64, 130, 98, 36, 102, 122, 40, 500, 500, 500, 170, 86, 54, 32, 500, 84, 500, 500, 156, 50, 178, 36, 132, 500, 500, 500, 80, 500, 500, 70, 68, 500, 500, 102, 62, 42, 100, 500, 500, 46, 500, 500, 118, 500, 44, 58, 500, 44, 318, 500, 500, 134, 118, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38812706101707073, "mean_inference_ms": 1.2415796421685732, "mean_action_processing_ms": 0.14446813311928403, "mean_env_wait_ms": 0.08604781134347633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0220029354095459, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12598395347595215}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.58499999999983, "episode_len_mean": 249.78, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.89999999999994, 13.499999999999751, 38.700000000000024, 43.7, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, 41.100000000000016, 27.099999999999945, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 30.699999999999996, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 11.499999999999723, 39.70000000000002, 46.5, 41.30000000000001, 46.5, 38.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.7, 40.10000000000002, 46.3, 43.7, -50.00000000000044, 13.099999999999746, -50.00000000000044, 43.7, 37.10000000000003, 40.30000000000002, 46.5, 39.90000000000002, 37.90000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.500000000000014, 44.7, 46.9, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.1, 32.30000000000002, 46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.900000000000006, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 45.7, 18.29999999999982, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.300000000000026, -50.00000000000044, 46.099999999999994], "episode_lengths": [232, 366, 114, 64, 48, 46, 500, 500, 62, 500, 44, 64, 500, 500, 90, 230, 54, 500, 32, 500, 38, 194, 500, 60, 40, 500, 224, 500, 500, 386, 104, 36, 88, 36, 120, 500, 66, 500, 54, 100, 38, 64, 500, 370, 500, 64, 130, 98, 36, 102, 122, 40, 500, 500, 500, 170, 86, 54, 32, 500, 84, 500, 500, 156, 50, 178, 36, 132, 500, 500, 500, 80, 500, 500, 70, 68, 500, 500, 102, 62, 42, 100, 500, 500, 46, 500, 500, 118, 500, 44, 58, 500, 44, 318, 500, 500, 134, 118, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38812706101707073, "mean_inference_ms": 1.2415796421685732, "mean_action_processing_ms": 0.14446813311928403, "mean_env_wait_ms": 0.08604781134347633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0220029354095459, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12598395347595215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5451.238053717216, "num_env_steps_trained_throughput_per_sec": 5451.238053717216, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3452.742, "sample_time_ms": 2949.247, "load_time_ms": 18.111, "load_throughput": 993866.415, "learn_time_ms": 473.958, "learn_throughput": 37978.051, "synch_weights_time_ms": 9.125}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2638, "training_iteration": 38, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-09", "timestamp": 1698250749, "time_this_iter_s": 3.3079993724823, "time_total_s": 129.85605931282043, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.85605931282043, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 61.779999999999994, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183423e-13, "cur_lr": 0.0003, "total_loss": 7.030395168728298, "policy_loss": -5.440513292948405e-05, "vf_loss": 7.030501874287923, "vf_explained_var": 0.00010597970750596788, "kl": 0.00031917943033224423, "entropy": 0.5239947511090173, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1733.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.993999999999799, "episode_len_mean": 280.66, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.900000000000006, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 45.7, 18.29999999999982, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.300000000000026, -50.00000000000044, 46.099999999999994, -50.00000000000044, 9.099999999999689, 42.10000000000001, 30.499999999999993, 7.499999999999666, -50.00000000000044, 44.7, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 26.499999999999936, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 38.10000000000002, 44.5, 47.1, 45.5, -50.00000000000044, 16.29999999999979, -50.00000000000044, 16.29999999999979, -50.00000000000044, 47.3, 41.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 37.70000000000003, 35.500000000000036, -50.00000000000044, 10.499999999999709, 42.900000000000006, 45.5, -50.00000000000044, 22.899999999999885, 46.699999999999996, -50.00000000000044, 45.5, 45.9, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, 24.69999999999991, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 1.099999999999575, 40.500000000000014, 20.699999999999854, -50.00000000000044], "episode_lengths": [36, 132, 500, 500, 500, 80, 500, 500, 70, 68, 500, 500, 102, 62, 42, 100, 500, 500, 46, 500, 500, 118, 500, 44, 58, 500, 44, 318, 500, 500, 134, 118, 500, 40, 500, 410, 80, 196, 426, 500, 54, 130, 48, 500, 500, 104, 500, 236, 500, 76, 52, 500, 500, 160, 500, 120, 56, 30, 46, 500, 338, 500, 338, 500, 28, 88, 500, 46, 500, 82, 124, 146, 500, 396, 72, 46, 500, 272, 34, 500, 46, 42, 78, 500, 50, 500, 452, 500, 500, 254, 60, 250, 500, 64, 44, 500, 490, 96, 294, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38857798567055923, "mean_inference_ms": 1.241943659567729, "mean_action_processing_ms": 0.1445640215275578, "mean_env_wait_ms": 0.08598007601908123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021009206771850586, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.10597491264343262}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.993999999999799, "episode_len_mean": 280.66, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.900000000000006, 45.9, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 45.7, 18.29999999999982, -50.00000000000044, -50.00000000000044, 36.70000000000003, 38.300000000000026, -50.00000000000044, 46.099999999999994, -50.00000000000044, 9.099999999999689, 42.10000000000001, 30.499999999999993, 7.499999999999666, -50.00000000000044, 44.7, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 26.499999999999936, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 38.10000000000002, 44.5, 47.1, 45.5, -50.00000000000044, 16.29999999999979, -50.00000000000044, 16.29999999999979, -50.00000000000044, 47.3, 41.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 37.70000000000003, 35.500000000000036, -50.00000000000044, 10.499999999999709, 42.900000000000006, 45.5, -50.00000000000044, 22.899999999999885, 46.699999999999996, -50.00000000000044, 45.5, 45.9, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, 24.69999999999991, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 1.099999999999575, 40.500000000000014, 20.699999999999854, -50.00000000000044], "episode_lengths": [36, 132, 500, 500, 500, 80, 500, 500, 70, 68, 500, 500, 102, 62, 42, 100, 500, 500, 46, 500, 500, 118, 500, 44, 58, 500, 44, 318, 500, 500, 134, 118, 500, 40, 500, 410, 80, 196, 426, 500, 54, 130, 48, 500, 500, 104, 500, 236, 500, 76, 52, 500, 500, 160, 500, 120, 56, 30, 46, 500, 338, 500, 338, 500, 28, 88, 500, 46, 500, 82, 124, 146, 500, 396, 72, 46, 500, 272, 34, 500, 46, 42, 78, 500, 50, 500, 452, 500, 500, 254, 60, 250, 500, 64, 44, 500, 490, 96, 294, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38857798567055923, "mean_inference_ms": 1.241943659567729, "mean_action_processing_ms": 0.1445640215275578, "mean_env_wait_ms": 0.08598007601908123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021009206771850586, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.10597491264343262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5147.2670130882, "num_env_steps_trained_throughput_per_sec": 5147.2670130882, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3471.042, "sample_time_ms": 2957.247, "load_time_ms": 18.808, "load_throughput": 957033.123, "learn_time_ms": 483.358, "learn_throughput": 37239.477, "synch_weights_time_ms": 9.228}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2704, "training_iteration": 39, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-13", "timestamp": 1698250753, "time_this_iter_s": 3.5029995441436768, "time_total_s": 133.3590588569641, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.3590588569641, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 58.44, "ram_util_percent": 27.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917116e-13, "cur_lr": 0.0003, "total_loss": 6.2912367184956866, "policy_loss": -0.00015055793854925367, "vf_loss": 6.291434065500895, "vf_explained_var": -0.0016371104452345107, "kl": 0.0007948576104425342, "entropy": 0.46744600004620024, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1778.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.843999999999828, "episode_len_mean": 242.2, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 45.5, -50.00000000000044, 22.899999999999885, 46.699999999999996, -50.00000000000044, 45.5, 45.9, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, 24.69999999999991, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 1.099999999999575, 40.500000000000014, 20.699999999999854, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 38.10000000000002, 45.7, -50.00000000000044, 22.299999999999876, -50.00000000000044, 45.9, 43.30000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 45.3, 46.099999999999994, 45.9, 42.30000000000001, 46.3, 43.7, -50.00000000000044, 45.9, 40.10000000000002, 46.099999999999994, 30.699999999999996, 43.900000000000006, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, 46.5, 40.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, 41.500000000000014, 47.3, 45.7, 45.3, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 46.699999999999996, 37.10000000000003, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, 41.500000000000014, 29.899999999999984, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.300000000000004], "episode_lengths": [72, 46, 500, 272, 34, 500, 46, 42, 78, 500, 50, 500, 452, 500, 500, 254, 60, 250, 500, 64, 44, 500, 490, 96, 294, 500, 500, 40, 66, 120, 44, 500, 278, 500, 42, 68, 174, 500, 500, 48, 500, 500, 500, 500, 500, 68, 30, 500, 58, 500, 500, 38, 500, 50, 48, 40, 42, 78, 38, 64, 500, 42, 100, 40, 194, 62, 500, 60, 96, 500, 36, 92, 84, 500, 500, 500, 40, 500, 118, 86, 28, 44, 48, 500, 70, 46, 500, 34, 130, 500, 44, 84, 500, 86, 202, 34, 500, 184, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3894013031568845, "mean_inference_ms": 1.2441232826081416, "mean_action_processing_ms": 0.14478447995732208, "mean_env_wait_ms": 0.08589522578570798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009321212768555, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.14598464965820312}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.843999999999828, "episode_len_mean": 242.2, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 45.5, -50.00000000000044, 22.899999999999885, 46.699999999999996, -50.00000000000044, 45.5, 45.9, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, 24.69999999999991, 44.10000000000001, 25.099999999999916, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 1.099999999999575, 40.500000000000014, 20.699999999999854, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 38.10000000000002, 45.7, -50.00000000000044, 22.299999999999876, -50.00000000000044, 45.9, 43.30000000000001, 32.700000000000024, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.1, 45.3, 46.099999999999994, 45.9, 42.30000000000001, 46.3, 43.7, -50.00000000000044, 45.9, 40.10000000000002, 46.099999999999994, 30.699999999999996, 43.900000000000006, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, 46.5, 40.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, 41.500000000000014, 47.3, 45.7, 45.3, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 46.699999999999996, 37.10000000000003, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, 41.500000000000014, 29.899999999999984, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.300000000000004], "episode_lengths": [72, 46, 500, 272, 34, 500, 46, 42, 78, 500, 50, 500, 452, 500, 500, 254, 60, 250, 500, 64, 44, 500, 490, 96, 294, 500, 500, 40, 66, 120, 44, 500, 278, 500, 42, 68, 174, 500, 500, 48, 500, 500, 500, 500, 500, 68, 30, 500, 58, 500, 500, 38, 500, 50, 48, 40, 42, 78, 38, 64, 500, 42, 100, 40, 194, 62, 500, 60, 96, 500, 36, 92, 84, 500, 500, 500, 40, 500, 118, 86, 28, 44, 48, 500, 70, 46, 500, 34, 130, 500, 44, 84, 500, 86, 202, 34, 500, 184, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3894013031568845, "mean_inference_ms": 1.2441232826081416, "mean_action_processing_ms": 0.14478447995732208, "mean_env_wait_ms": 0.08589522578570798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009321212768555, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.14598464965820312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4949.133787366556, "num_env_steps_trained_throughput_per_sec": 4949.133787366556, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3479.913, "sample_time_ms": 2964.446, "load_time_ms": 18.409, "load_throughput": 977807.204, "learn_time_ms": 485.364, "learn_throughput": 37085.579, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2778, "training_iteration": 40, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-17", "timestamp": 1698250757, "time_this_iter_s": 3.642998695373535, "time_total_s": 137.00205755233765, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 137.00205755233765, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 67.41999999999999, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458558e-13, "cur_lr": 0.0003, "total_loss": 6.52733687294854, "policy_loss": -0.0003826614883210924, "vf_loss": 6.527766397264268, "vf_explained_var": -0.0021339323785569933, "kl": 0.000863355549592547, "entropy": 0.46817853848139446, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7539999999998255, "episode_len_mean": 253.08, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, 46.5, 40.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, 41.500000000000014, 47.3, 45.7, 45.3, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 46.699999999999996, 37.10000000000003, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, 41.500000000000014, 29.899999999999984, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 34.70000000000004, 43.30000000000001, -50.00000000000044, 45.3, 25.099999999999916, 46.099999999999994, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.5, 39.70000000000002, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 21.499999999999865, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, 35.30000000000004, 20.49999999999985, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.900000000000006, 32.30000000000002, 9.499999999999694, -50.00000000000044, 38.10000000000002, 44.900000000000006, 28.499999999999964, 34.70000000000004, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.9], "episode_lengths": [62, 500, 60, 96, 500, 36, 92, 84, 500, 500, 500, 40, 500, 118, 86, 28, 44, 48, 500, 70, 46, 500, 34, 130, 500, 44, 84, 500, 86, 202, 34, 500, 184, 500, 58, 500, 500, 500, 500, 250, 186, 154, 68, 500, 48, 250, 40, 66, 60, 500, 500, 48, 500, 500, 52, 32, 500, 500, 34, 500, 56, 104, 58, 70, 500, 500, 56, 500, 286, 24, 500, 500, 500, 40, 38, 148, 296, 46, 40, 500, 500, 66, 128, 52, 178, 406, 500, 120, 52, 216, 154, 500, 160, 500, 68, 500, 500, 350, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.389050527928717, "mean_inference_ms": 1.2423608441520129, "mean_action_processing_ms": 0.14452216108992114, "mean_env_wait_ms": 0.08609435394051151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025004148483276367, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.12700796127319336}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7539999999998255, "episode_len_mean": 253.08, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 44.10000000000001, 40.500000000000014, -50.00000000000044, 46.5, 40.90000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 38.300000000000026, 41.500000000000014, 47.3, 45.7, 45.3, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, 46.699999999999996, 37.10000000000003, -50.00000000000044, 45.7, 41.70000000000002, -50.00000000000044, 41.500000000000014, 29.899999999999984, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 31.500000000000007, 34.70000000000004, 43.30000000000001, -50.00000000000044, 45.3, 25.099999999999916, 46.099999999999994, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.5, 39.70000000000002, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 21.499999999999865, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.3, 35.30000000000004, 20.49999999999985, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.900000000000006, 32.30000000000002, 9.499999999999694, -50.00000000000044, 38.10000000000002, 44.900000000000006, 28.499999999999964, 34.70000000000004, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.9], "episode_lengths": [62, 500, 60, 96, 500, 36, 92, 84, 500, 500, 500, 40, 500, 118, 86, 28, 44, 48, 500, 70, 46, 500, 34, 130, 500, 44, 84, 500, 86, 202, 34, 500, 184, 500, 58, 500, 500, 500, 500, 250, 186, 154, 68, 500, 48, 250, 40, 66, 60, 500, 500, 48, 500, 500, 52, 32, 500, 500, 34, 500, 56, 104, 58, 70, 500, 500, 56, 500, 286, 24, 500, 500, 500, 40, 38, 148, 296, 46, 40, 500, 500, 66, 128, 52, 178, 406, 500, 120, 52, 216, 154, 500, 160, 500, 68, 500, 500, 350, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.389050527928717, "mean_inference_ms": 1.2423608441520129, "mean_action_processing_ms": 0.14452216108992114, "mean_env_wait_ms": 0.08609435394051151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025004148483276367, "StateBufferConnector_ms": 0.00900125503540039, "ViewRequirementAgentConnector_ms": 0.12700796127319336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5388.700480288473, "num_env_steps_trained_throughput_per_sec": 5388.700480288473, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3476.917, "sample_time_ms": 2953.353, "load_time_ms": 19.312, "load_throughput": 932061.802, "learn_time_ms": 492.558, "learn_throughput": 36543.941, "synch_weights_time_ms": 9.392}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2843, "training_iteration": 41, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-20", "timestamp": 1698250760, "time_this_iter_s": 3.3453118801116943, "time_total_s": 140.34736943244934, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.34736943244934, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.14, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729279e-14, "cur_lr": 0.0003, "total_loss": 6.578189086914063, "policy_loss": -3.331158724096086e-05, "vf_loss": 6.5782707002427845, "vf_explained_var": -0.0010428587595621745, "kl": 0.0005446239331958067, "entropy": 0.4833560042911106, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1868.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.132999999999826, "episode_len_mean": 254.32, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 46.3, 35.30000000000004, 20.49999999999985, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.900000000000006, 32.30000000000002, 9.499999999999694, -50.00000000000044, 38.10000000000002, 44.900000000000006, 28.499999999999964, 34.70000000000004, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.9, -50.00000000000044, 1.099999999999575, 35.500000000000036, 33.90000000000004, -50.00000000000044, 44.300000000000004, 46.699999999999996, 40.30000000000002, 47.5, 45.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 45.9, 44.900000000000006, 39.300000000000026, 22.49999999999988, 44.7, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 46.9, 45.9, 46.3, 42.70000000000001, 30.099999999999987, -50.00000000000044, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 17.499999999999808, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 28.699999999999967, 46.099999999999994, 22.49999999999988, 44.900000000000006, 41.100000000000016, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, 2.499999999999595, -50.00000000000044, 38.300000000000026, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, 28.699999999999967], "episode_lengths": [500, 40, 38, 148, 296, 46, 40, 500, 500, 66, 128, 52, 178, 406, 500, 120, 52, 216, 154, 500, 160, 500, 68, 500, 500, 350, 500, 42, 500, 490, 146, 162, 500, 58, 34, 98, 26, 46, 500, 52, 34, 42, 52, 108, 276, 54, 500, 178, 500, 500, 36, 500, 64, 500, 32, 42, 38, 74, 200, 500, 48, 500, 450, 500, 500, 40, 500, 500, 66, 500, 326, 90, 500, 500, 50, 36, 500, 214, 40, 276, 52, 90, 500, 28, 500, 76, 476, 500, 118, 48, 500, 48, 500, 94, 500, 500, 500, 74, 36, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38816198393100704, "mean_inference_ms": 1.2412702850460757, "mean_action_processing_ms": 0.14457483676712493, "mean_env_wait_ms": 0.085949042670386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997949600219727, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.11600089073181152}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.132999999999826, "episode_len_mean": 254.32, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 46.3, 35.30000000000004, 20.49999999999985, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.300000000000026, 44.900000000000006, 32.30000000000002, 9.499999999999694, -50.00000000000044, 38.10000000000002, 44.900000000000006, 28.499999999999964, 34.70000000000004, -50.00000000000044, 34.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 45.9, -50.00000000000044, 1.099999999999575, 35.500000000000036, 33.90000000000004, -50.00000000000044, 44.300000000000004, 46.699999999999996, 40.30000000000002, 47.5, 45.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 45.9, 44.900000000000006, 39.300000000000026, 22.49999999999988, 44.7, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 46.9, 45.9, 46.3, 42.70000000000001, 30.099999999999987, -50.00000000000044, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 17.499999999999808, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 28.699999999999967, 46.099999999999994, 22.49999999999988, 44.900000000000006, 41.100000000000016, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, 2.499999999999595, -50.00000000000044, 38.300000000000026, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, 28.699999999999967], "episode_lengths": [500, 40, 38, 148, 296, 46, 40, 500, 500, 66, 128, 52, 178, 406, 500, 120, 52, 216, 154, 500, 160, 500, 68, 500, 500, 350, 500, 42, 500, 490, 146, 162, 500, 58, 34, 98, 26, 46, 500, 52, 34, 42, 52, 108, 276, 54, 500, 178, 500, 500, 36, 500, 64, 500, 32, 42, 38, 74, 200, 500, 48, 500, 450, 500, 500, 40, 500, 500, 66, 500, 326, 90, 500, 500, 50, 36, 500, 214, 40, 276, 52, 90, 500, 28, 500, 76, 476, 500, 118, 48, 500, 48, 500, 94, 500, 500, 500, 74, 36, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38816198393100704, "mean_inference_ms": 1.2412702850460757, "mean_action_processing_ms": 0.14457483676712493, "mean_env_wait_ms": 0.085949042670386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024997949600219727, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.11600089073181152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5371.53153753108, "num_env_steps_trained_throughput_per_sec": 5371.53153753108, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3468.887, "sample_time_ms": 2943.453, "load_time_ms": 18.415, "load_throughput": 977457.8, "learn_time_ms": 495.225, "learn_throughput": 36347.146, "synch_weights_time_ms": 9.592}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2915, "training_iteration": 42, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-23", "timestamp": 1698250763, "time_this_iter_s": 3.3590006828308105, "time_total_s": 143.70637011528015, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 143.70637011528015, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 58.120000000000005, "ram_util_percent": 27.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.5474735088646395e-14, "cur_lr": 0.0003, "total_loss": 6.5747577773200145, "policy_loss": -0.0004767037100262112, "vf_loss": 6.575279288821751, "vf_explained_var": -0.0013933142026265463, "kl": 0.0012082337940878714, "entropy": 0.4493664304415385, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1913.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.1639999999998185, "episode_len_mean": 258.96, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 46.5, -50.00000000000044, 28.699999999999967, 46.099999999999994, 22.49999999999988, 44.900000000000006, 41.100000000000016, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, 2.499999999999595, -50.00000000000044, 38.300000000000026, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, 28.699999999999967, -50.00000000000044, 36.900000000000034, 42.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 39.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.90000000000002, 46.5, 47.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, 40.500000000000014, 45.9, 46.3, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.5, -50.00000000000044, -50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, 38.300000000000026, 46.3, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 28.29999999999996, 41.30000000000001, 42.500000000000014, 46.5, 41.100000000000016, 44.300000000000004, 26.299999999999933, 30.29999999999999, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 50, 36, 500, 214, 40, 276, 52, 90, 500, 28, 500, 76, 476, 500, 118, 48, 500, 48, 500, 94, 500, 500, 500, 74, 36, 214, 500, 132, 80, 500, 50, 500, 500, 296, 108, 500, 60, 500, 102, 36, 30, 500, 500, 60, 500, 92, 500, 500, 120, 96, 42, 38, 500, 110, 74, 500, 500, 66, 26, 500, 500, 26, 60, 500, 500, 500, 122, 26, 500, 500, 500, 50, 500, 66, 500, 500, 500, 66, 500, 278, 500, 118, 38, 68, 78, 54, 500, 86, 80, 218, 88, 76, 36, 90, 58, 238, 198, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38868073921898444, "mean_inference_ms": 1.242520733782881, "mean_action_processing_ms": 0.1449900202450899, "mean_env_wait_ms": 0.08593297310828603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599811553955078, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.12407660484313965}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.1639999999998185, "episode_len_mean": 258.96, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 46.5, -50.00000000000044, 28.699999999999967, 46.099999999999994, 22.49999999999988, 44.900000000000006, 41.100000000000016, -50.00000000000044, 47.3, -50.00000000000044, 42.500000000000014, 2.499999999999595, -50.00000000000044, 38.300000000000026, 45.3, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, 28.699999999999967, -50.00000000000044, 36.900000000000034, 42.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 20.49999999999985, 39.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.90000000000002, 46.5, 47.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, 40.500000000000014, 45.9, 46.3, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 47.5, -50.00000000000044, -50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, 38.300000000000026, 46.3, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 28.29999999999996, 41.30000000000001, 42.500000000000014, 46.5, 41.100000000000016, 44.300000000000004, 26.299999999999933, 30.29999999999999, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 50, 36, 500, 214, 40, 276, 52, 90, 500, 28, 500, 76, 476, 500, 118, 48, 500, 48, 500, 94, 500, 500, 500, 74, 36, 214, 500, 132, 80, 500, 50, 500, 500, 296, 108, 500, 60, 500, 102, 36, 30, 500, 500, 60, 500, 92, 500, 500, 120, 96, 42, 38, 500, 110, 74, 500, 500, 66, 26, 500, 500, 26, 60, 500, 500, 500, 122, 26, 500, 500, 500, 50, 500, 66, 500, 500, 500, 66, 500, 278, 500, 118, 38, 68, 78, 54, 500, 86, 80, 218, 88, 76, 36, 90, 58, 238, 198, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38868073921898444, "mean_inference_ms": 1.242520733782881, "mean_action_processing_ms": 0.1449900202450899, "mean_env_wait_ms": 0.08593297310828603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599811553955078, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.12407660484313965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5331.114385678297, "num_env_steps_trained_throughput_per_sec": 5331.114385678297, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3449.827, "sample_time_ms": 2933.953, "load_time_ms": 18.715, "load_throughput": 961785.541, "learn_time_ms": 485.165, "learn_throughput": 37100.787, "synch_weights_time_ms": 9.692}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2988, "training_iteration": 43, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-27", "timestamp": 1698250767, "time_this_iter_s": 3.3824048042297363, "time_total_s": 147.0887749195099, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.0887749195099, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 69.0, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323198e-14, "cur_lr": 0.0003, "total_loss": 5.783754846784803, "policy_loss": -0.00022224901864926022, "vf_loss": 5.784020921919081, "vf_explained_var": -0.0010325034459431966, "kl": 0.0006932050758198077, "entropy": 0.4377058956358168, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6979999999998057, "episode_len_mean": 263.58, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, 38.300000000000026, 46.3, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 28.29999999999996, 41.30000000000001, 42.500000000000014, 46.5, 41.100000000000016, 44.300000000000004, 26.299999999999933, 30.29999999999999, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 41.70000000000002, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, 46.099999999999994, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 44.900000000000006, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 14.499999999999766, -50.00000000000044, 44.10000000000001, 46.099999999999994, 45.1, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 44.900000000000006], "episode_lengths": [500, 26, 60, 500, 500, 500, 122, 26, 500, 500, 500, 50, 500, 66, 500, 500, 500, 66, 500, 278, 500, 118, 38, 68, 78, 54, 500, 86, 80, 218, 88, 76, 36, 90, 58, 238, 198, 500, 90, 500, 54, 44, 500, 84, 52, 34, 500, 500, 500, 106, 500, 66, 500, 74, 40, 76, 500, 500, 500, 38, 500, 66, 30, 500, 500, 500, 30, 52, 52, 42, 32, 500, 500, 52, 356, 500, 60, 40, 50, 34, 500, 104, 500, 44, 112, 500, 500, 34, 32, 500, 500, 500, 500, 500, 500, 500, 58, 500, 50, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3891123589973884, "mean_inference_ms": 1.241690141563696, "mean_action_processing_ms": 0.14408848383922723, "mean_env_wait_ms": 0.08571649221229395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499484062194824, "StateBufferConnector_ms": 0.0060083866119384766, "ViewRequirementAgentConnector_ms": 0.12303495407104492}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6979999999998057, "episode_len_mean": 263.58, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 22.299999999999876, -50.00000000000044, 38.300000000000026, 46.3, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 28.29999999999996, 41.30000000000001, 42.500000000000014, 46.5, 41.100000000000016, 44.300000000000004, 26.299999999999933, 30.29999999999999, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 41.70000000000002, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, 46.099999999999994, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 44.900000000000006, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 14.499999999999766, -50.00000000000044, 44.10000000000001, 46.099999999999994, 45.1, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 44.900000000000006], "episode_lengths": [500, 26, 60, 500, 500, 500, 122, 26, 500, 500, 500, 50, 500, 66, 500, 500, 500, 66, 500, 278, 500, 118, 38, 68, 78, 54, 500, 86, 80, 218, 88, 76, 36, 90, 58, 238, 198, 500, 90, 500, 54, 44, 500, 84, 52, 34, 500, 500, 500, 106, 500, 66, 500, 74, 40, 76, 500, 500, 500, 38, 500, 66, 30, 500, 500, 500, 30, 52, 52, 42, 32, 500, 500, 52, 356, 500, 60, 40, 50, 34, 500, 104, 500, 44, 112, 500, 500, 34, 32, 500, 500, 500, 500, 500, 500, 500, 58, 500, 50, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3891123589973884, "mean_inference_ms": 1.241690141563696, "mean_action_processing_ms": 0.14408848383922723, "mean_env_wait_ms": 0.08571649221229395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499484062194824, "StateBufferConnector_ms": 0.0060083866119384766, "ViewRequirementAgentConnector_ms": 0.12303495407104492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5477.707812329043, "num_env_steps_trained_throughput_per_sec": 5477.707812329043, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3428.731, "sample_time_ms": 2919.458, "load_time_ms": 17.715, "load_throughput": 1016068.853, "learn_time_ms": 479.768, "learn_throughput": 37518.142, "synch_weights_time_ms": 9.589}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3049, "training_iteration": 44, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-30", "timestamp": 1698250770, "time_this_iter_s": 3.292043685913086, "time_total_s": 150.38081860542297, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 150.38081860542297, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.78000000000001, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161599e-14, "cur_lr": 0.0003, "total_loss": 6.2714472982618545, "policy_loss": -0.00030839211410946314, "vf_loss": 6.271800168355306, "vf_explained_var": -0.000904450151655409, "kl": 0.0008411992245745144, "entropy": 0.4444336732228597, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2003.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4130000000002048, "episode_len_mean": 279.68, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 44.900000000000006, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 14.499999999999766, -50.00000000000044, 44.10000000000001, 46.099999999999994, 45.1, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 17.899999999999814, 41.70000000000002, -50.00000000000044, 40.500000000000014, 45.5, 45.1, 46.099999999999994, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 47.3, 30.099999999999987, 27.49999999999995, 45.7, -50.00000000000044, 31.900000000000013, 42.10000000000001, 44.300000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 33.30000000000003, 46.5, 33.90000000000004, 43.30000000000001, -50.00000000000044, 23.099999999999888, 47.5, -50.00000000000044, -50.00000000000044, 44.7, 34.50000000000004, -50.00000000000044, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 34.50000000000004, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 30, 52, 52, 42, 32, 500, 500, 52, 356, 500, 60, 40, 50, 34, 500, 104, 500, 44, 112, 500, 500, 34, 32, 500, 500, 500, 500, 500, 500, 500, 58, 500, 50, 52, 500, 322, 84, 500, 96, 46, 50, 40, 68, 64, 500, 500, 500, 310, 500, 28, 200, 226, 44, 500, 182, 80, 58, 500, 104, 500, 168, 36, 162, 68, 500, 270, 26, 500, 500, 54, 156, 500, 420, 500, 500, 500, 140, 36, 500, 500, 500, 98, 156, 34, 48, 500, 500, 192, 500, 500, 500, 48, 500, 500, 30, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38815136739108114, "mean_inference_ms": 1.239057343270505, "mean_action_processing_ms": 0.14411837622897322, "mean_env_wait_ms": 0.08571892235491997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298138618469238, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.12604427337646484}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4130000000002048, "episode_len_mean": 279.68, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 44.900000000000006, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 14.499999999999766, -50.00000000000044, 44.10000000000001, 46.099999999999994, 45.1, 46.699999999999996, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 17.899999999999814, 41.70000000000002, -50.00000000000044, 40.500000000000014, 45.5, 45.1, 46.099999999999994, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 47.3, 30.099999999999987, 27.49999999999995, 45.7, -50.00000000000044, 31.900000000000013, 42.10000000000001, 44.300000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 33.30000000000003, 46.5, 33.90000000000004, 43.30000000000001, -50.00000000000044, 23.099999999999888, 47.5, -50.00000000000044, -50.00000000000044, 44.7, 34.50000000000004, -50.00000000000044, 8.099999999999675, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 34.50000000000004, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 30, 52, 52, 42, 32, 500, 500, 52, 356, 500, 60, 40, 50, 34, 500, 104, 500, 44, 112, 500, 500, 34, 32, 500, 500, 500, 500, 500, 500, 500, 58, 500, 50, 52, 500, 322, 84, 500, 96, 46, 50, 40, 68, 64, 500, 500, 500, 310, 500, 28, 200, 226, 44, 500, 182, 80, 58, 500, 104, 500, 168, 36, 162, 68, 500, 270, 26, 500, 500, 54, 156, 500, 420, 500, 500, 500, 140, 36, 500, 500, 500, 98, 156, 34, 48, 500, 500, 192, 500, 500, 500, 48, 500, 500, 30, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38815136739108114, "mean_inference_ms": 1.239057343270505, "mean_action_processing_ms": 0.14411837622897322, "mean_env_wait_ms": 0.08571892235491997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298138618469238, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.12604427337646484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5316.007965406909, "num_env_steps_trained_throughput_per_sec": 5316.007965406909, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3442.778, "sample_time_ms": 2926.005, "load_time_ms": 18.512, "load_throughput": 972324.177, "learn_time_ms": 486.567, "learn_throughput": 36993.845, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3113, "training_iteration": 45, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-33", "timestamp": 1698250773, "time_this_iter_s": 3.392000198364258, "time_total_s": 153.77281880378723, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.77281880378723, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.14, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860807994e-15, "cur_lr": 0.0003, "total_loss": 6.8734068552653, "policy_loss": -0.00035826943607793915, "vf_loss": 6.873810482025147, "vf_explained_var": -0.0026607804828219944, "kl": 0.0009552015901514703, "entropy": 0.4538646592034234, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2048.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.66599999999981, "episode_len_mean": 263.94, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 34.50000000000004, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 6.699999999999655, 22.899999999999885, 17.099999999999802, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, 39.50000000000002, 43.7, 15.099999999999774, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 20.299999999999848, -50.00000000000044, 18.099999999999817, 21.699999999999868, 45.1, 35.70000000000003, 46.699999999999996, 45.7, 45.7, 47.9, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, 43.7, 47.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.5, 45.1, 46.699999999999996, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 36.50000000000003, 9.8999999999997, 45.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 23.8999999999999, 46.5, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, 45.7, 42.70000000000001, -50.00000000000044, 47.1, 44.5], "episode_lengths": [500, 500, 500, 98, 156, 34, 48, 500, 500, 192, 500, 500, 500, 48, 500, 500, 30, 38, 500, 500, 500, 100, 434, 272, 330, 64, 500, 46, 500, 500, 48, 58, 106, 64, 350, 500, 140, 500, 500, 94, 298, 500, 320, 284, 50, 144, 34, 44, 44, 22, 26, 500, 500, 42, 140, 500, 64, 22, 114, 500, 500, 54, 500, 500, 156, 500, 36, 50, 34, 500, 128, 32, 500, 500, 34, 136, 402, 48, 500, 50, 500, 500, 500, 74, 500, 44, 500, 262, 36, 60, 44, 500, 500, 74, 38, 44, 74, 500, 30, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38855445621030854, "mean_inference_ms": 1.241906767743266, "mean_action_processing_ms": 0.1448378870589589, "mean_env_wait_ms": 0.08573628118089452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032998085021972656, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.1169888973236084}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.66599999999981, "episode_len_mean": 263.94, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 34.50000000000004, 46.699999999999996, 45.3, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 6.699999999999655, 22.899999999999885, 17.099999999999802, 43.7, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, 39.50000000000002, 43.7, 15.099999999999774, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, 20.299999999999848, -50.00000000000044, 18.099999999999817, 21.699999999999868, 45.1, 35.70000000000003, 46.699999999999996, 45.7, 45.7, 47.9, 47.5, -50.00000000000044, -50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, 43.7, 47.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.5, 45.1, 46.699999999999996, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 36.50000000000003, 9.8999999999997, 45.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 23.8999999999999, 46.5, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, 45.7, 42.70000000000001, -50.00000000000044, 47.1, 44.5], "episode_lengths": [500, 500, 500, 98, 156, 34, 48, 500, 500, 192, 500, 500, 500, 48, 500, 500, 30, 38, 500, 500, 500, 100, 434, 272, 330, 64, 500, 46, 500, 500, 48, 58, 106, 64, 350, 500, 140, 500, 500, 94, 298, 500, 320, 284, 50, 144, 34, 44, 44, 22, 26, 500, 500, 42, 140, 500, 64, 22, 114, 500, 500, 54, 500, 500, 156, 500, 36, 50, 34, 500, 128, 32, 500, 500, 34, 136, 402, 48, 500, 50, 500, 500, 500, 74, 500, 44, 500, 262, 36, 60, 44, 500, 500, 74, 38, 44, 74, 500, 30, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38855445621030854, "mean_inference_ms": 1.241906767743266, "mean_action_processing_ms": 0.1448378870589589, "mean_env_wait_ms": 0.08573628118089452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032998085021972656, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.1169888973236084}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4566.20683323376, "num_env_steps_trained_throughput_per_sec": 4566.20683323376, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3474.678, "sample_time_ms": 2965.407, "load_time_ms": 17.71, "load_throughput": 1016390.307, "learn_time_ms": 479.967, "learn_throughput": 37502.547, "synch_weights_time_ms": 9.392}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3193, "training_iteration": 46, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-37", "timestamp": 1698250777, "time_this_iter_s": 3.9489996433258057, "time_total_s": 157.72181844711304, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.72181844711304, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 68.64, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430403997e-15, "cur_lr": 0.0003, "total_loss": 6.1380888303120935, "policy_loss": -0.0003890190480483903, "vf_loss": 6.138522730933295, "vf_explained_var": -0.0019065353605482312, "kl": 0.0006772487869612734, "entropy": 0.4500944064723121, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.69400000000023, "episode_len_mean": 297.44, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, 43.7, 47.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.5, 45.1, 46.699999999999996, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 36.50000000000003, 9.8999999999997, 45.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 23.8999999999999, 46.5, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, 45.7, 42.70000000000001, -50.00000000000044, 47.1, 44.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 6.8999999999996575, 45.7, 45.3, 46.3, 36.30000000000003, 45.7, 42.900000000000006, 45.1, -50.00000000000044, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 21.499999999999865, 33.500000000000036], "episode_lengths": [500, 42, 140, 500, 64, 22, 114, 500, 500, 54, 500, 500, 156, 500, 36, 50, 34, 500, 128, 32, 500, 500, 34, 136, 402, 48, 500, 50, 500, 500, 500, 74, 500, 44, 500, 262, 36, 60, 44, 500, 500, 74, 38, 44, 74, 500, 30, 56, 500, 500, 44, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 296, 500, 500, 500, 500, 500, 56, 500, 432, 44, 48, 38, 138, 44, 72, 50, 500, 48, 282, 500, 500, 500, 40, 72, 500, 500, 48, 500, 500, 500, 500, 42, 500, 500, 500, 58, 286, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3894375064164798, "mean_inference_ms": 1.243609449451099, "mean_action_processing_ms": 0.14442193973240763, "mean_env_wait_ms": 0.08556158172219817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899669647216797, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.11496520042419434}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.69400000000023, "episode_len_mean": 297.44, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, 43.7, 47.9, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 46.5, 45.1, 46.699999999999996, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 36.50000000000003, 9.8999999999997, 45.3, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, 23.8999999999999, 46.5, 44.10000000000001, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.3, 45.7, 42.70000000000001, -50.00000000000044, 47.1, 44.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 6.8999999999996575, 45.7, 45.3, 46.3, 36.30000000000003, 45.7, 42.900000000000006, 45.1, -50.00000000000044, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 21.499999999999865, 33.500000000000036], "episode_lengths": [500, 42, 140, 500, 64, 22, 114, 500, 500, 54, 500, 500, 156, 500, 36, 50, 34, 500, 128, 32, 500, 500, 34, 136, 402, 48, 500, 50, 500, 500, 500, 74, 500, 44, 500, 262, 36, 60, 44, 500, 500, 74, 38, 44, 74, 500, 30, 56, 500, 500, 44, 500, 500, 500, 500, 500, 500, 500, 500, 62, 500, 500, 296, 500, 500, 500, 500, 500, 56, 500, 432, 44, 48, 38, 138, 44, 72, 50, 500, 48, 282, 500, 500, 500, 40, 72, 500, 500, 48, 500, 500, 500, 500, 42, 500, 500, 500, 58, 286, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3894375064164798, "mean_inference_ms": 1.243609449451099, "mean_action_processing_ms": 0.14442193973240763, "mean_env_wait_ms": 0.08556158172219817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899669647216797, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.11496520042419434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5322.240144555472, "num_env_steps_trained_throughput_per_sec": 5322.240144555472, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3449.981, "sample_time_ms": 2948.71, "load_time_ms": 17.606, "load_throughput": 1022360.961, "learn_time_ms": 471.968, "learn_throughput": 38138.155, "synch_weights_time_ms": 9.492}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3245, "training_iteration": 47, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-41", "timestamp": 1698250781, "time_this_iter_s": 3.388000249862671, "time_total_s": 161.1098186969757, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 161.1098186969757, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 60.379999999999995, "ram_util_percent": 27.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715201999e-15, "cur_lr": 0.0003, "total_loss": 6.46500842836168, "policy_loss": -0.00020558618836932711, "vf_loss": 6.465264373355442, "vf_explained_var": -0.001042616367340088, "kl": 0.0005622229139327651, "entropy": 0.5037739005353715, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2138.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5940000000002107, "episode_len_mean": 286.5, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 6.8999999999996575, 45.7, 45.3, 46.3, 36.30000000000003, 45.7, 42.900000000000006, 45.1, -50.00000000000044, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 21.499999999999865, 33.500000000000036, -50.00000000000044, 32.30000000000002, 43.50000000000001, 47.5, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 41.90000000000001, -50.00000000000044, 45.1, 37.300000000000026, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.50000000000002, 38.90000000000002, 12.899999999999743, -50.00000000000044, 20.899999999999856, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.500000000000014, 44.900000000000006, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 11.899999999999729, 38.50000000000003, 47.1, 42.10000000000001, 18.699999999999825, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 22.699999999999882, 45.3, 28.699999999999967, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 296, 500, 500, 500, 500, 500, 56, 500, 432, 44, 48, 38, 138, 44, 72, 50, 500, 48, 282, 500, 500, 500, 40, 72, 500, 500, 48, 500, 500, 500, 500, 42, 500, 500, 500, 58, 286, 166, 500, 178, 66, 26, 500, 56, 46, 500, 88, 500, 500, 500, 366, 82, 500, 50, 128, 500, 500, 170, 500, 500, 500, 76, 106, 112, 372, 500, 292, 76, 500, 58, 86, 52, 38, 46, 500, 500, 382, 116, 30, 80, 314, 500, 500, 52, 42, 500, 500, 274, 48, 214, 30, 500, 500, 40, 68, 98, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38914774452849565, "mean_inference_ms": 1.242676410699298, "mean_action_processing_ms": 0.1444655118059543, "mean_env_wait_ms": 0.08580587690325359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027972698211669922, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11593484878540039}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5940000000002107, "episode_len_mean": 286.5, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.49999999999985, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 6.8999999999996575, 45.7, 45.3, 46.3, 36.30000000000003, 45.7, 42.900000000000006, 45.1, -50.00000000000044, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 21.499999999999865, 33.500000000000036, -50.00000000000044, 32.30000000000002, 43.50000000000001, 47.5, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 41.90000000000001, -50.00000000000044, 45.1, 37.300000000000026, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.50000000000002, 38.90000000000002, 12.899999999999743, -50.00000000000044, 20.899999999999856, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.500000000000014, 44.900000000000006, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 11.899999999999729, 38.50000000000003, 47.1, 42.10000000000001, 18.699999999999825, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 22.699999999999882, 45.3, 28.699999999999967, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9], "episode_lengths": [500, 296, 500, 500, 500, 500, 500, 56, 500, 432, 44, 48, 38, 138, 44, 72, 50, 500, 48, 282, 500, 500, 500, 40, 72, 500, 500, 48, 500, 500, 500, 500, 42, 500, 500, 500, 58, 286, 166, 500, 178, 66, 26, 500, 56, 46, 500, 88, 500, 500, 500, 366, 82, 500, 50, 128, 500, 500, 170, 500, 500, 500, 76, 106, 112, 372, 500, 292, 76, 500, 58, 86, 52, 38, 46, 500, 500, 382, 116, 30, 80, 314, 500, 500, 52, 42, 500, 500, 274, 48, 214, 30, 500, 500, 40, 68, 98, 500, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38914774452849565, "mean_inference_ms": 1.242676410699298, "mean_action_processing_ms": 0.1444655118059543, "mean_env_wait_ms": 0.08580587690325359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027972698211669922, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11593484878540039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5305.00566881673, "num_env_steps_trained_throughput_per_sec": 5305.00566881673, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3459.083, "sample_time_ms": 2945.11, "load_time_ms": 17.91, "load_throughput": 1005039.637, "learn_time_ms": 484.467, "learn_throughput": 37154.237, "synch_weights_time_ms": 9.392}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3306, "training_iteration": 48, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-44", "timestamp": 1698250784, "time_this_iter_s": 3.3990116119384766, "time_total_s": 164.50883030891418, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.50883030891418, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 59.2, "ram_util_percent": 27.179999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357600999e-16, "cur_lr": 0.0003, "total_loss": 6.391956308152941, "policy_loss": -0.00028702828826175793, "vf_loss": 6.392291026645236, "vf_explained_var": -0.0044827328787909616, "kl": 0.0010745920282355806, "entropy": 0.47696112526787654, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2183.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.375999999999789, "episode_len_mean": 286.82, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, 12.899999999999743, -50.00000000000044, 20.899999999999856, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.500000000000014, 44.900000000000006, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 11.899999999999729, 38.50000000000003, 47.1, 42.10000000000001, 18.699999999999825, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 22.699999999999882, 45.3, 28.699999999999967, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 8.699999999999683, 42.30000000000001, -50.00000000000044, 21.09999999999986, 45.5, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 22.099999999999874, -50.00000000000044, 42.30000000000001, -50.00000000000044, 7.699999999999669, 45.7, -50.00000000000044, 39.90000000000002, 41.90000000000001, 45.5, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 18.29999999999982, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 46.9, -50.00000000000044, 9.699999999999697, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 32.90000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.3], "episode_lengths": [112, 372, 500, 292, 76, 500, 58, 86, 52, 38, 46, 500, 500, 382, 116, 30, 80, 314, 500, 500, 52, 42, 500, 500, 274, 48, 214, 30, 500, 500, 40, 68, 98, 500, 500, 32, 500, 44, 500, 500, 116, 54, 414, 78, 500, 290, 46, 500, 240, 500, 500, 58, 64, 500, 500, 82, 500, 280, 500, 78, 500, 424, 44, 500, 102, 82, 46, 84, 500, 500, 500, 38, 500, 70, 500, 318, 70, 40, 500, 500, 444, 32, 500, 404, 28, 76, 500, 500, 106, 500, 500, 500, 500, 28, 500, 172, 500, 250, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3889754651465417, "mean_inference_ms": 1.2424316381845566, "mean_action_processing_ms": 0.14447788197116104, "mean_env_wait_ms": 0.08563175633622432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026970386505126953, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.12694358825683594}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.375999999999789, "episode_len_mean": 286.82, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, 12.899999999999743, -50.00000000000044, 20.899999999999856, 42.500000000000014, -50.00000000000044, 44.300000000000004, 41.500000000000014, 44.900000000000006, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 11.899999999999729, 38.50000000000003, 47.1, 42.10000000000001, 18.699999999999825, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 22.699999999999882, 45.3, 28.699999999999967, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 8.699999999999683, 42.30000000000001, -50.00000000000044, 21.09999999999986, 45.5, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 22.099999999999874, -50.00000000000044, 42.30000000000001, -50.00000000000044, 7.699999999999669, 45.7, -50.00000000000044, 39.90000000000002, 41.90000000000001, 45.5, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 18.29999999999982, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 46.9, -50.00000000000044, 9.699999999999697, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 32.90000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.3], "episode_lengths": [112, 372, 500, 292, 76, 500, 58, 86, 52, 38, 46, 500, 500, 382, 116, 30, 80, 314, 500, 500, 52, 42, 500, 500, 274, 48, 214, 30, 500, 500, 40, 68, 98, 500, 500, 32, 500, 44, 500, 500, 116, 54, 414, 78, 500, 290, 46, 500, 240, 500, 500, 58, 64, 500, 500, 82, 500, 280, 500, 78, 500, 424, 44, 500, 102, 82, 46, 84, 500, 500, 500, 38, 500, 70, 500, 318, 70, 40, 500, 500, 444, 32, 500, 404, 28, 76, 500, 500, 106, 500, 500, 500, 500, 28, 500, 172, 500, 250, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3889754651465417, "mean_inference_ms": 1.2424316381845566, "mean_action_processing_ms": 0.14447788197116104, "mean_env_wait_ms": 0.08563175633622432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026970386505126953, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.12694358825683594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5236.321870490674, "num_env_steps_trained_throughput_per_sec": 5236.321870490674, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3453.136, "sample_time_ms": 2940.662, "load_time_ms": 17.61, "load_throughput": 1022158.872, "learn_time_ms": 483.567, "learn_throughput": 37223.389, "synch_weights_time_ms": 9.191}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3370, "training_iteration": 49, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-48", "timestamp": 1698250788, "time_this_iter_s": 3.4435219764709473, "time_total_s": 167.95235228538513, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.95235228538513, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.06, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788004996e-16, "cur_lr": 0.0003, "total_loss": 6.1721405135260685, "policy_loss": -0.00010544796112096973, "vf_loss": 6.172296163770888, "vf_explained_var": -0.005048498842451308, "kl": 0.0005290142654050417, "entropy": 0.502254237069024, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2228.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6679999999998127, "episode_len_mean": 263.92, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 18.29999999999982, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 46.9, -50.00000000000044, 9.699999999999697, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 32.90000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.3, -50.00000000000044, 43.7, 46.3, 42.900000000000006, -50.00000000000044, 33.10000000000003, 42.30000000000001, 39.10000000000002, 33.10000000000003, 23.099999999999888, 36.900000000000034, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 33.500000000000036, -50.00000000000044, 43.7, -50.00000000000044, 39.10000000000002, 40.70000000000002, 47.1, 37.300000000000026, -50.00000000000044, 46.9, -50.00000000000044, 45.7, 44.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.900000000000006, 46.5, 44.10000000000001, 22.099999999999874, 47.3, 39.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.9, 45.1, 47.1, 42.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.1, 11.699999999999726, -50.00000000000044], "episode_lengths": [500, 500, 38, 500, 70, 500, 318, 70, 40, 500, 500, 444, 32, 500, 404, 28, 76, 500, 500, 106, 500, 500, 500, 500, 28, 500, 172, 500, 250, 500, 28, 500, 64, 38, 72, 500, 170, 78, 110, 170, 270, 132, 500, 68, 500, 96, 46, 500, 500, 88, 166, 500, 64, 500, 110, 94, 30, 128, 500, 32, 500, 44, 60, 112, 500, 500, 500, 66, 52, 36, 60, 280, 28, 108, 500, 88, 500, 236, 500, 44, 500, 500, 100, 32, 50, 30, 80, 72, 500, 500, 500, 30, 62, 500, 500, 60, 98, 50, 384, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3883188600337254, "mean_inference_ms": 1.2400212721147303, "mean_action_processing_ms": 0.1446157400195634, "mean_env_wait_ms": 0.08568741213138675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01997971534729004, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.11700081825256348}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6679999999998127, "episode_len_mean": 263.92, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 18.29999999999982, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 5.6999999999996405, 46.9, -50.00000000000044, 9.699999999999697, 47.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 32.90000000000003, -50.00000000000044, 25.099999999999916, -50.00000000000044, 47.3, -50.00000000000044, 43.7, 46.3, 42.900000000000006, -50.00000000000044, 33.10000000000003, 42.30000000000001, 39.10000000000002, 33.10000000000003, 23.099999999999888, 36.900000000000034, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, 41.30000000000001, 33.500000000000036, -50.00000000000044, 43.7, -50.00000000000044, 39.10000000000002, 40.70000000000002, 47.1, 37.300000000000026, -50.00000000000044, 46.9, -50.00000000000044, 45.7, 44.10000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.900000000000006, 46.5, 44.10000000000001, 22.099999999999874, 47.3, 39.300000000000026, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.9, 45.1, 47.1, 42.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.1, 11.699999999999726, -50.00000000000044], "episode_lengths": [500, 500, 38, 500, 70, 500, 318, 70, 40, 500, 500, 444, 32, 500, 404, 28, 76, 500, 500, 106, 500, 500, 500, 500, 28, 500, 172, 500, 250, 500, 28, 500, 64, 38, 72, 500, 170, 78, 110, 170, 270, 132, 500, 68, 500, 96, 46, 500, 500, 88, 166, 500, 64, 500, 110, 94, 30, 128, 500, 32, 500, 44, 60, 112, 500, 500, 500, 66, 52, 36, 60, 280, 28, 108, 500, 88, 500, 236, 500, 44, 500, 500, 100, 32, 50, 30, 80, 72, 500, 500, 500, 30, 62, 500, 500, 60, 98, 50, 384, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3883188600337254, "mean_inference_ms": 1.2400212721147303, "mean_action_processing_ms": 0.1446157400195634, "mean_env_wait_ms": 0.08568741213138675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01997971534729004, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.11700081825256348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5190.259419914434, "num_env_steps_trained_throughput_per_sec": 5190.259419914434, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3436.239, "sample_time_ms": 2934.658, "load_time_ms": 17.507, "load_throughput": 1028158.486, "learn_time_ms": 472.774, "learn_throughput": 38073.161, "synch_weights_time_ms": 9.094}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3439, "training_iteration": 50, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-51", "timestamp": 1698250791, "time_this_iter_s": 3.4730324745178223, "time_total_s": 171.42538475990295, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.42538475990295, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 50.02, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002498e-16, "cur_lr": 0.0003, "total_loss": 6.736505974663628, "policy_loss": -0.00018782955076959397, "vf_loss": 6.7367459721035425, "vf_explained_var": -0.005717900064256456, "kl": 0.0006125324493470746, "entropy": 0.5213805635770162, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2273.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.450999999999828, "episode_len_mean": 251.12, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.9, 45.1, 47.1, 42.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.1, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.7, 33.90000000000004, 46.699999999999996, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.10000000000001, 44.300000000000004, 42.70000000000001, 47.7, -50.00000000000044, 33.70000000000004, 10.499999999999709, 43.10000000000001, 12.099999999999731, -50.00000000000044, 46.099999999999994, 44.10000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.100000000000016, 20.49999999999985, -50.00000000000044, 43.7, 39.300000000000026, 40.10000000000002, 35.900000000000034, 41.30000000000001, 46.699999999999996, 15.899999999999785, -50.00000000000044, 27.49999999999995, 43.30000000000001, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 47.1, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.7, 18.499999999999822, -50.00000000000044, 43.30000000000001], "episode_lengths": [88, 500, 236, 500, 44, 500, 500, 100, 32, 50, 30, 80, 72, 500, 500, 500, 30, 62, 500, 500, 60, 98, 50, 384, 500, 500, 44, 162, 34, 58, 60, 500, 500, 106, 500, 70, 58, 74, 24, 500, 164, 396, 70, 380, 500, 40, 60, 500, 134, 500, 500, 82, 90, 296, 500, 64, 108, 100, 142, 88, 34, 342, 500, 226, 68, 56, 64, 500, 500, 100, 68, 22, 500, 500, 34, 42, 30, 500, 114, 500, 500, 112, 58, 500, 500, 74, 116, 500, 500, 500, 500, 114, 146, 500, 500, 34, 54, 316, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38769925694913837, "mean_inference_ms": 1.2388746565273594, "mean_action_processing_ms": 0.14412131792445762, "mean_env_wait_ms": 0.08517080017189319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023988962173461914, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.11800813674926758}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.450999999999828, "episode_len_mean": 251.12, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.9, 45.1, 47.1, 42.10000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 45.1, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.7, 33.90000000000004, 46.699999999999996, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.10000000000001, 44.300000000000004, 42.70000000000001, 47.7, -50.00000000000044, 33.70000000000004, 10.499999999999709, 43.10000000000001, 12.099999999999731, -50.00000000000044, 46.099999999999994, 44.10000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.100000000000016, 20.49999999999985, -50.00000000000044, 43.7, 39.300000000000026, 40.10000000000002, 35.900000000000034, 41.30000000000001, 46.699999999999996, 15.899999999999785, -50.00000000000044, 27.49999999999995, 43.30000000000001, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 47.1, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.7, 18.499999999999822, -50.00000000000044, 43.30000000000001], "episode_lengths": [88, 500, 236, 500, 44, 500, 500, 100, 32, 50, 30, 80, 72, 500, 500, 500, 30, 62, 500, 500, 60, 98, 50, 384, 500, 500, 44, 162, 34, 58, 60, 500, 500, 106, 500, 70, 58, 74, 24, 500, 164, 396, 70, 380, 500, 40, 60, 500, 134, 500, 500, 82, 90, 296, 500, 64, 108, 100, 142, 88, 34, 342, 500, 226, 68, 56, 64, 500, 500, 100, 68, 22, 500, 500, 34, 42, 30, 500, 114, 500, 500, 112, 58, 500, 500, 74, 116, 500, 500, 500, 500, 114, 146, 500, 500, 34, 54, 316, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38769925694913837, "mean_inference_ms": 1.2388746565273594, "mean_action_processing_ms": 0.14412131792445762, "mean_env_wait_ms": 0.08517080017189319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023988962173461914, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.11800813674926758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5651.489352050396, "num_env_steps_trained_throughput_per_sec": 5651.489352050396, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3420.707, "sample_time_ms": 2923.061, "load_time_ms": 16.401, "load_throughput": 1097506.498, "learn_time_ms": 469.743, "learn_throughput": 38318.818, "synch_weights_time_ms": 9.297}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3514, "training_iteration": 51, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-54", "timestamp": 1698250794, "time_this_iter_s": 3.1910316944122314, "time_total_s": 174.61641645431519, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.61641645431519, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.474999999999994, "ram_util_percent": 27.125000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001249e-17, "cur_lr": 0.0003, "total_loss": 6.601241620381673, "policy_loss": -0.00028453552060657075, "vf_loss": 6.601581806606717, "vf_explained_var": -0.0008720702595180935, "kl": 0.0011091071354220124, "entropy": 0.5569126652346716, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2318.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.48199999999984, "episode_len_mean": 245.84, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.7, 18.499999999999822, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 11.29999999999972, 44.7, 43.30000000000001, 41.90000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 33.500000000000036, 41.30000000000001, 43.7, 47.5, 40.500000000000014, 45.1, 4.699999999999626, 46.3, 39.300000000000026, 31.70000000000001, -50.00000000000044, 43.900000000000006, 47.1, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 41.100000000000016, 32.50000000000002, 24.899999999999913, -50.00000000000044, 38.90000000000002, 43.900000000000006, 14.699999999999768, -50.00000000000044, 25.499999999999922, 40.70000000000002, 46.3, 38.300000000000026, 11.29999999999972, 42.900000000000006, 42.900000000000006, 42.900000000000006, 38.10000000000002, 40.10000000000002, 16.8999999999998, 43.50000000000001, 39.10000000000002, 42.900000000000006, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 35.30000000000004, 38.300000000000026, 46.5, 35.70000000000003, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 500, 114, 500, 500, 112, 58, 500, 500, 74, 116, 500, 500, 500, 500, 114, 146, 500, 500, 34, 54, 316, 500, 68, 500, 500, 388, 54, 68, 82, 50, 500, 500, 500, 500, 66, 74, 500, 166, 88, 64, 26, 96, 50, 454, 38, 108, 184, 500, 62, 30, 58, 72, 500, 500, 54, 500, 500, 30, 102, 500, 500, 36, 36, 90, 176, 252, 500, 112, 62, 354, 500, 246, 94, 38, 118, 388, 72, 72, 72, 120, 100, 332, 66, 110, 72, 106, 42, 500, 500, 148, 118, 36, 144, 500, 168, 500, 104, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877046406314073, "mean_inference_ms": 1.238136142250324, "mean_action_processing_ms": 0.14432227492815802, "mean_env_wait_ms": 0.08544440655203629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01499319076538086, "StateBufferConnector_ms": 0.009005546569824219, "ViewRequirementAgentConnector_ms": 0.11703801155090332}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.48199999999984, "episode_len_mean": 245.84, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.7, 18.499999999999822, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 11.29999999999972, 44.7, 43.30000000000001, 41.90000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 33.500000000000036, 41.30000000000001, 43.7, 47.5, 40.500000000000014, 45.1, 4.699999999999626, 46.3, 39.300000000000026, 31.70000000000001, -50.00000000000044, 43.900000000000006, 47.1, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 41.100000000000016, 32.50000000000002, 24.899999999999913, -50.00000000000044, 38.90000000000002, 43.900000000000006, 14.699999999999768, -50.00000000000044, 25.499999999999922, 40.70000000000002, 46.3, 38.300000000000026, 11.29999999999972, 42.900000000000006, 42.900000000000006, 42.900000000000006, 38.10000000000002, 40.10000000000002, 16.8999999999998, 43.50000000000001, 39.10000000000002, 42.900000000000006, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 35.30000000000004, 38.300000000000026, 46.5, 35.70000000000003, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 500, 114, 500, 500, 112, 58, 500, 500, 74, 116, 500, 500, 500, 500, 114, 146, 500, 500, 34, 54, 316, 500, 68, 500, 500, 388, 54, 68, 82, 50, 500, 500, 500, 500, 66, 74, 500, 166, 88, 64, 26, 96, 50, 454, 38, 108, 184, 500, 62, 30, 58, 72, 500, 500, 54, 500, 500, 30, 102, 500, 500, 36, 36, 90, 176, 252, 500, 112, 62, 354, 500, 246, 94, 38, 118, 388, 72, 72, 72, 120, 100, 332, 66, 110, 72, 106, 42, 500, 500, 148, 118, 36, 144, 500, 168, 500, 104, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877046406314073, "mean_inference_ms": 1.238136142250324, "mean_action_processing_ms": 0.14432227492815802, "mean_env_wait_ms": 0.08544440655203629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01499319076538086, "StateBufferConnector_ms": 0.009005546569824219, "ViewRequirementAgentConnector_ms": 0.11703801155090332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5603.978586889071, "num_env_steps_trained_throughput_per_sec": 5603.978586889071, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3406.808, "sample_time_ms": 2928.762, "load_time_ms": 16.198, "load_throughput": 1111279.972, "learn_time_ms": 450.246, "learn_throughput": 39978.135, "synch_weights_time_ms": 9.297}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3590, "training_iteration": 52, "trial_id": "9f288_00021", "date": "2023-10-25_17-19-58", "timestamp": 1698250798, "time_this_iter_s": 3.2179996967315674, "time_total_s": 177.83441615104675, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.83441615104675, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.720000000000006, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006246e-17, "cur_lr": 0.0003, "total_loss": 7.018807368808322, "policy_loss": -0.0008568267027537028, "vf_loss": 7.019719219207763, "vf_explained_var": -0.001808068487379286, "kl": 0.0018308956778001731, "entropy": 0.5502180284923978, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.590999999999845, "episode_len_mean": 249.78, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.3, 38.300000000000026, 11.29999999999972, 42.900000000000006, 42.900000000000006, 42.900000000000006, 38.10000000000002, 40.10000000000002, 16.8999999999998, 43.50000000000001, 39.10000000000002, 42.900000000000006, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 35.30000000000004, 38.300000000000026, 46.5, 35.70000000000003, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 39.90000000000002, -50.00000000000044, 46.5, 43.7, 28.499999999999964, -50.00000000000044, 3.2999999999996064, 41.90000000000001, 31.300000000000004, 45.1, 47.3, -50.00000000000044, 9.499999999999694, 42.500000000000014, 33.70000000000004, 46.699999999999996, -50.00000000000044, 29.49999999999998, 26.89999999999994, 45.9, 33.90000000000004, -50.00000000000044, 24.099999999999902, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, 35.900000000000034, 41.30000000000001, 22.699999999999882, 37.10000000000003, 31.900000000000013, 39.10000000000002, 41.70000000000002, 45.7, 42.500000000000014, -50.00000000000044, 38.300000000000026, 42.900000000000006, 8.699999999999683, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 15.299999999999777, -50.00000000000044, 44.10000000000001, 18.29999999999982, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.7], "episode_lengths": [94, 38, 118, 388, 72, 72, 72, 120, 100, 332, 66, 110, 72, 106, 42, 500, 500, 148, 118, 36, 144, 500, 168, 500, 104, 500, 500, 500, 188, 102, 500, 36, 64, 216, 500, 468, 82, 188, 50, 28, 500, 406, 76, 164, 34, 500, 206, 232, 42, 162, 500, 260, 76, 500, 500, 448, 500, 142, 88, 274, 130, 182, 110, 84, 44, 76, 500, 118, 72, 414, 48, 500, 500, 500, 500, 92, 56, 500, 70, 42, 500, 348, 500, 60, 318, 30, 500, 500, 80, 52, 500, 120, 500, 500, 500, 242, 500, 94, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867979161243747, "mean_inference_ms": 1.2379190220179002, "mean_action_processing_ms": 0.14424382991999007, "mean_env_wait_ms": 0.08521976445288455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021990060806274414, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.12795495986938477}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.590999999999845, "episode_len_mean": 249.78, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.3, 38.300000000000026, 11.29999999999972, 42.900000000000006, 42.900000000000006, 42.900000000000006, 38.10000000000002, 40.10000000000002, 16.8999999999998, 43.50000000000001, 39.10000000000002, 42.900000000000006, 39.50000000000002, 45.9, -50.00000000000044, -50.00000000000044, 35.30000000000004, 38.300000000000026, 46.5, 35.70000000000003, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 39.90000000000002, -50.00000000000044, 46.5, 43.7, 28.499999999999964, -50.00000000000044, 3.2999999999996064, 41.90000000000001, 31.300000000000004, 45.1, 47.3, -50.00000000000044, 9.499999999999694, 42.500000000000014, 33.70000000000004, 46.699999999999996, -50.00000000000044, 29.49999999999998, 26.89999999999994, 45.9, 33.90000000000004, -50.00000000000044, 24.099999999999902, 42.500000000000014, -50.00000000000044, -50.00000000000044, 5.299999999999635, -50.00000000000044, 35.900000000000034, 41.30000000000001, 22.699999999999882, 37.10000000000003, 31.900000000000013, 39.10000000000002, 41.70000000000002, 45.7, 42.500000000000014, -50.00000000000044, 38.300000000000026, 42.900000000000006, 8.699999999999683, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.5, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 15.299999999999777, -50.00000000000044, 44.10000000000001, 18.29999999999982, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.7], "episode_lengths": [94, 38, 118, 388, 72, 72, 72, 120, 100, 332, 66, 110, 72, 106, 42, 500, 500, 148, 118, 36, 144, 500, 168, 500, 104, 500, 500, 500, 188, 102, 500, 36, 64, 216, 500, 468, 82, 188, 50, 28, 500, 406, 76, 164, 34, 500, 206, 232, 42, 162, 500, 260, 76, 500, 500, 448, 500, 142, 88, 274, 130, 182, 110, 84, 44, 76, 500, 118, 72, 414, 48, 500, 500, 500, 500, 92, 56, 500, 70, 42, 500, 348, 500, 60, 318, 30, 500, 500, 80, 52, 500, 120, 500, 500, 500, 242, 500, 94, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867979161243747, "mean_inference_ms": 1.2379190220179002, "mean_action_processing_ms": 0.14424382991999007, "mean_env_wait_ms": 0.08521976445288455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021990060806274414, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.12795495986938477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5394.060918634333, "num_env_steps_trained_throughput_per_sec": 5394.060918634333, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3402.868, "sample_time_ms": 2924.762, "load_time_ms": 16.197, "load_throughput": 1111286.515, "learn_time_ms": 450.309, "learn_throughput": 39972.591, "synch_weights_time_ms": 9.394}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3663, "training_iteration": 53, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-01", "timestamp": 1698250801, "time_this_iter_s": 3.3429994583129883, "time_total_s": 181.17741560935974, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.17741560935974, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.875, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503123e-17, "cur_lr": 0.0003, "total_loss": 6.869315020243326, "policy_loss": -7.420861058764988e-05, "vf_loss": 6.869442431131999, "vf_explained_var": -0.001074316766526964, "kl": 0.00046257570081225356, "entropy": 0.5319177561336094, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2408.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.942999999999849, "episode_len_mean": 236.26, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.299999999999777, -50.00000000000044, 44.10000000000001, 18.29999999999982, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.7, 2.699999999999598, 41.90000000000001, -50.00000000000044, 45.7, 46.099999999999994, 41.70000000000002, -50.00000000000044, 45.1, 39.300000000000026, -50.00000000000044, 46.699999999999996, 40.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 28.699999999999967, 25.499999999999922, 44.10000000000001, -50.00000000000044, 31.900000000000013, -50.00000000000044, 20.299999999999848, 45.1, 45.7, 36.70000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 44.5, 45.1, 33.70000000000004, 41.500000000000014, 44.900000000000006, -50.00000000000044, 42.10000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 47.1, 41.500000000000014, 11.499999999999723, 42.900000000000006, 44.10000000000001, 14.899999999999771, 45.7, 38.700000000000024, 42.900000000000006, 38.90000000000002, 44.10000000000001, 42.10000000000001, 46.699999999999996, -50.00000000000044, 47.3, -50.00000000000044, 34.70000000000004, 31.300000000000004, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 43.50000000000001, 43.30000000000001, 7.699999999999669, 41.100000000000016, 34.30000000000004, 42.500000000000014, 40.90000000000002], "episode_lengths": [348, 500, 60, 318, 30, 500, 500, 80, 52, 500, 120, 500, 500, 500, 242, 500, 94, 500, 44, 474, 82, 500, 44, 40, 84, 500, 50, 108, 500, 34, 100, 70, 500, 500, 100, 500, 58, 42, 500, 500, 38, 214, 246, 60, 500, 182, 500, 298, 50, 44, 134, 500, 108, 500, 64, 500, 56, 50, 164, 86, 52, 500, 80, 158, 500, 500, 322, 500, 30, 86, 386, 72, 60, 352, 44, 114, 72, 112, 60, 80, 34, 500, 28, 500, 154, 188, 30, 500, 70, 500, 36, 500, 64, 66, 68, 424, 90, 158, 76, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38857075495949017, "mean_inference_ms": 1.243368224203205, "mean_action_processing_ms": 0.1449012918326179, "mean_env_wait_ms": 0.08555391080813057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598785400390625, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.1632080078125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.942999999999849, "episode_len_mean": 236.26, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.299999999999777, -50.00000000000044, 44.10000000000001, 18.29999999999982, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.7, 2.699999999999598, 41.90000000000001, -50.00000000000044, 45.7, 46.099999999999994, 41.70000000000002, -50.00000000000044, 45.1, 39.300000000000026, -50.00000000000044, 46.699999999999996, 40.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.300000000000004, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 28.699999999999967, 25.499999999999922, 44.10000000000001, -50.00000000000044, 31.900000000000013, -50.00000000000044, 20.299999999999848, 45.1, 45.7, 36.70000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, 44.5, 45.1, 33.70000000000004, 41.500000000000014, 44.900000000000006, -50.00000000000044, 42.10000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 47.1, 41.500000000000014, 11.499999999999723, 42.900000000000006, 44.10000000000001, 14.899999999999771, 45.7, 38.700000000000024, 42.900000000000006, 38.90000000000002, 44.10000000000001, 42.10000000000001, 46.699999999999996, -50.00000000000044, 47.3, -50.00000000000044, 34.70000000000004, 31.300000000000004, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 43.50000000000001, 43.30000000000001, 7.699999999999669, 41.100000000000016, 34.30000000000004, 42.500000000000014, 40.90000000000002], "episode_lengths": [348, 500, 60, 318, 30, 500, 500, 80, 52, 500, 120, 500, 500, 500, 242, 500, 94, 500, 44, 474, 82, 500, 44, 40, 84, 500, 50, 108, 500, 34, 100, 70, 500, 500, 100, 500, 58, 42, 500, 500, 38, 214, 246, 60, 500, 182, 500, 298, 50, 44, 134, 500, 108, 500, 64, 500, 56, 50, 164, 86, 52, 500, 80, 158, 500, 500, 322, 500, 30, 86, 386, 72, 60, 352, 44, 114, 72, 112, 60, 80, 34, 500, 28, 500, 154, 188, 30, 500, 70, 500, 36, 500, 64, 66, 68, 424, 90, 158, 76, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38857075495949017, "mean_inference_ms": 1.243368224203205, "mean_action_processing_ms": 0.1449012918326179, "mean_env_wait_ms": 0.08555391080813057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598785400390625, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.1632080078125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4299.387968747927, "num_env_steps_trained_throughput_per_sec": 4299.387968747927, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3492.927, "sample_time_ms": 3001.957, "load_time_ms": 16.994, "load_throughput": 1059191.452, "learn_time_ms": 462.291, "learn_throughput": 38936.484, "synch_weights_time_ms": 9.479}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3744, "training_iteration": 54, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-05", "timestamp": 1698250805, "time_this_iter_s": 4.193606615066528, "time_total_s": 185.37102222442627, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.37102222442627, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 75.2, "ram_util_percent": 27.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251561e-17, "cur_lr": 0.0003, "total_loss": 7.223606883154975, "policy_loss": -0.00044305622577667236, "vf_loss": 7.224108356899685, "vf_explained_var": -0.004998405774434407, "kl": 0.0009882480968902503, "entropy": 0.5846325397491455, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2453.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 24.819801980197944, "episode_len_mean": 168.47524752475246, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.900000000000006, 45.7, 34.900000000000034, 43.7, 23.29999999999989, 44.900000000000006, 47.5, 41.70000000000002, 44.900000000000006, 41.30000000000001, 45.3, 39.300000000000026, 35.900000000000034, -50.00000000000044, 30.29999999999999, 38.700000000000024, 42.900000000000006, 45.5, 43.50000000000001, 38.90000000000002, -50.00000000000044, 31.500000000000007, 45.3, 46.3, 38.50000000000003, 38.300000000000026, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.5, 44.300000000000004, 43.50000000000001, 41.90000000000001, 23.29999999999989, 42.70000000000001, 33.10000000000003, 42.500000000000014, 45.7, 45.5, 45.7, 29.299999999999976, 42.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 19.09999999999983, 42.70000000000001, 38.10000000000002, -50.00000000000044, 37.90000000000003, 40.90000000000002, 39.50000000000002, 44.7, 45.3, 36.50000000000003, 46.3, 40.10000000000002, 44.7, -50.00000000000044, 18.29999999999982, 46.5, 34.30000000000004, -50.00000000000044, 26.69999999999994, 38.50000000000003, 40.90000000000002, 44.10000000000001, 41.90000000000001, -50.00000000000044, 45.5, 45.5, 45.3, 28.09999999999996, 44.5, 45.7, 33.10000000000003, 36.70000000000003, 16.29999999999979, 44.900000000000006, 37.90000000000003, 36.900000000000034, -50.00000000000044, 31.70000000000001, 40.90000000000002, 44.10000000000001, 46.5, 39.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044], "episode_lengths": [500, 500, 46, 98, 500, 52, 56, 500, 62, 44, 152, 64, 268, 52, 26, 84, 52, 88, 48, 108, 142, 500, 198, 114, 72, 46, 66, 112, 500, 186, 48, 38, 116, 118, 94, 500, 500, 26, 58, 66, 82, 268, 74, 170, 76, 44, 46, 44, 208, 74, 500, 122, 500, 310, 74, 120, 500, 122, 92, 106, 54, 48, 136, 38, 100, 54, 500, 318, 36, 158, 500, 234, 116, 92, 60, 82, 500, 46, 46, 48, 220, 56, 44, 170, 134, 338, 52, 122, 132, 500, 184, 92, 60, 36, 102, 64, 66, 500, 104, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901885703196555, "mean_inference_ms": 1.2490452324226926, "mean_action_processing_ms": 0.1458259293393934, "mean_env_wait_ms": 0.08638936944180815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03366777212312906, "StateBufferConnector_ms": 0.010894784832944964, "ViewRequirementAgentConnector_ms": 0.17042490515378442}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 24.819801980197944, "episode_len_mean": 168.47524752475246, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.900000000000006, 45.7, 34.900000000000034, 43.7, 23.29999999999989, 44.900000000000006, 47.5, 41.70000000000002, 44.900000000000006, 41.30000000000001, 45.3, 39.300000000000026, 35.900000000000034, -50.00000000000044, 30.29999999999999, 38.700000000000024, 42.900000000000006, 45.5, 43.50000000000001, 38.90000000000002, -50.00000000000044, 31.500000000000007, 45.3, 46.3, 38.50000000000003, 38.300000000000026, 40.70000000000002, -50.00000000000044, -50.00000000000044, 47.5, 44.300000000000004, 43.50000000000001, 41.90000000000001, 23.29999999999989, 42.70000000000001, 33.10000000000003, 42.500000000000014, 45.7, 45.5, 45.7, 29.299999999999976, 42.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 19.09999999999983, 42.70000000000001, 38.10000000000002, -50.00000000000044, 37.90000000000003, 40.90000000000002, 39.50000000000002, 44.7, 45.3, 36.50000000000003, 46.3, 40.10000000000002, 44.7, -50.00000000000044, 18.29999999999982, 46.5, 34.30000000000004, -50.00000000000044, 26.69999999999994, 38.50000000000003, 40.90000000000002, 44.10000000000001, 41.90000000000001, -50.00000000000044, 45.5, 45.5, 45.3, 28.09999999999996, 44.5, 45.7, 33.10000000000003, 36.70000000000003, 16.29999999999979, 44.900000000000006, 37.90000000000003, 36.900000000000034, -50.00000000000044, 31.70000000000001, 40.90000000000002, 44.10000000000001, 46.5, 39.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044], "episode_lengths": [500, 500, 46, 98, 500, 52, 56, 500, 62, 44, 152, 64, 268, 52, 26, 84, 52, 88, 48, 108, 142, 500, 198, 114, 72, 46, 66, 112, 500, 186, 48, 38, 116, 118, 94, 500, 500, 26, 58, 66, 82, 268, 74, 170, 76, 44, 46, 44, 208, 74, 500, 122, 500, 310, 74, 120, 500, 122, 92, 106, 54, 48, 136, 38, 100, 54, 500, 318, 36, 158, 500, 234, 116, 92, 60, 82, 500, 46, 46, 48, 220, 56, 44, 170, 134, 338, 52, 122, 132, 500, 184, 92, 60, 36, 102, 64, 66, 500, 104, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901885703196555, "mean_inference_ms": 1.2490452324226926, "mean_action_processing_ms": 0.1458259293393934, "mean_env_wait_ms": 0.08638936944180815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03366777212312906, "StateBufferConnector_ms": 0.010894784832944964, "ViewRequirementAgentConnector_ms": 0.17042490515378442}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3696.0649933914106, "num_env_steps_trained_throughput_per_sec": 3696.0649933914106, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3641.332, "sample_time_ms": 3104.977, "load_time_ms": 17.494, "load_throughput": 1028933.376, "learn_time_ms": 476.618, "learn_throughput": 37766.105, "synch_weights_time_ms": 39.937}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3845, "training_iteration": 55, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-10", "timestamp": 1698250810, "time_this_iter_s": 4.883043527603149, "time_total_s": 190.25406575202942, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.25406575202942, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 75.02857142857142, "ram_util_percent": 27.657142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125781e-18, "cur_lr": 0.0003, "total_loss": 6.741366036732992, "policy_loss": -0.000386057628525628, "vf_loss": 6.741805214352078, "vf_explained_var": -0.002089969317118327, "kl": 0.0013074779761495848, "entropy": 0.5310750954680973, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2498.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.291999999999836, "episode_len_mean": 247.74, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.69999999999994, 38.50000000000003, 40.90000000000002, 44.10000000000001, 41.90000000000001, -50.00000000000044, 45.5, 45.5, 45.3, 28.09999999999996, 44.5, 45.7, 33.10000000000003, 36.70000000000003, 16.29999999999979, 44.900000000000006, 37.90000000000003, 36.900000000000034, -50.00000000000044, 31.70000000000001, 40.90000000000002, 44.10000000000001, 46.5, 39.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, 23.29999999999989, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, 39.10000000000002, 34.900000000000034, 39.10000000000002, -50.00000000000044, 44.10000000000001, 4.699999999999626, -50.00000000000044, 24.099999999999902, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.900000000000006, 44.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 4.899999999999629, 46.5, 41.90000000000001, 10.499999999999709, 43.7, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, 45.1, 41.100000000000016, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, 43.50000000000001, 47.3, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.7, 44.900000000000006, 24.899999999999913, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 234, 116, 92, 60, 82, 500, 46, 46, 48, 220, 56, 44, 170, 134, 338, 52, 122, 132, 500, 184, 92, 60, 36, 102, 64, 66, 500, 104, 42, 500, 500, 500, 134, 500, 500, 500, 86, 54, 268, 500, 58, 500, 64, 500, 70, 110, 152, 110, 500, 60, 454, 500, 260, 38, 500, 500, 42, 500, 500, 500, 40, 500, 52, 56, 88, 500, 500, 500, 104, 500, 48, 500, 500, 54, 452, 36, 82, 396, 64, 144, 500, 500, 240, 50, 90, 500, 98, 500, 136, 66, 28, 500, 320, 70, 54, 52, 252, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3942652571231411, "mean_inference_ms": 1.2631766422129598, "mean_action_processing_ms": 0.14724119836873217, "mean_env_wait_ms": 0.08728106886955171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046003103256225586, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.19979453086853027}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.291999999999836, "episode_len_mean": 247.74, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.69999999999994, 38.50000000000003, 40.90000000000002, 44.10000000000001, 41.90000000000001, -50.00000000000044, 45.5, 45.5, 45.3, 28.09999999999996, 44.5, 45.7, 33.10000000000003, 36.70000000000003, 16.29999999999979, 44.900000000000006, 37.90000000000003, 36.900000000000034, -50.00000000000044, 31.70000000000001, 40.90000000000002, 44.10000000000001, 46.5, 39.90000000000002, 43.7, 43.50000000000001, -50.00000000000044, 39.70000000000002, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.7, 23.29999999999989, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, 39.10000000000002, 34.900000000000034, 39.10000000000002, -50.00000000000044, 44.10000000000001, 4.699999999999626, -50.00000000000044, 24.099999999999902, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.900000000000006, 44.5, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 4.899999999999629, 46.5, 41.90000000000001, 10.499999999999709, 43.7, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, 45.1, 41.100000000000016, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, 43.50000000000001, 47.3, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.7, 44.900000000000006, 24.899999999999913, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 234, 116, 92, 60, 82, 500, 46, 46, 48, 220, 56, 44, 170, 134, 338, 52, 122, 132, 500, 184, 92, 60, 36, 102, 64, 66, 500, 104, 42, 500, 500, 500, 134, 500, 500, 500, 86, 54, 268, 500, 58, 500, 64, 500, 70, 110, 152, 110, 500, 60, 454, 500, 260, 38, 500, 500, 42, 500, 500, 500, 40, 500, 52, 56, 88, 500, 500, 500, 104, 500, 48, 500, 500, 54, 452, 36, 82, 396, 64, 144, 500, 500, 240, 50, 90, 500, 98, 500, 136, 66, 28, 500, 320, 70, 54, 52, 252, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3942652571231411, "mean_inference_ms": 1.2631766422129598, "mean_action_processing_ms": 0.14724119836873217, "mean_env_wait_ms": 0.08728106886955171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046003103256225586, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.19979453086853027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3183.19526938576, "num_env_steps_trained_throughput_per_sec": 3183.19526938576, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3812.601, "sample_time_ms": 3268.768, "load_time_ms": 17.144, "load_throughput": 1049936.543, "learn_time_ms": 483.545, "learn_throughput": 37225.069, "synch_weights_time_ms": 40.837}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3914, "training_iteration": 56, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-16", "timestamp": 1698250816, "time_this_iter_s": 5.673686981201172, "time_total_s": 195.9277527332306, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.9277527332306, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 88.14999999999999, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628903e-18, "cur_lr": 0.0003, "total_loss": 6.616671286688911, "policy_loss": -0.00039498917758464815, "vf_loss": 6.617118697696262, "vf_explained_var": -0.0008229692776997884, "kl": 0.0005830772178089521, "entropy": 0.5240329345067342, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2543.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.531999999999842, "episode_len_mean": 245.36, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 4.899999999999629, 46.5, 41.90000000000001, 10.499999999999709, 43.7, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, 45.1, 41.100000000000016, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, 43.50000000000001, 47.3, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.7, 44.900000000000006, 24.899999999999913, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 30.699999999999996, -50.00000000000044, 43.900000000000006, 17.499999999999808, 16.699999999999797, 46.9, 37.10000000000003, -50.00000000000044, 45.5, -50.00000000000044, 37.300000000000026, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 15.699999999999783, 44.7, -50.00000000000044, 45.3, 28.89999999999997, -50.00000000000044, 42.70000000000001, 46.099999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 25.499999999999922, 40.10000000000002, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.30000000000001, 37.90000000000003, 46.099999999999994, 43.50000000000001, 46.099999999999994, 0.09999999999956088, -50.00000000000044, 37.90000000000003, -50.00000000000044, 41.100000000000016, 34.50000000000004, -50.00000000000044, 30.9, 37.300000000000026, 37.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, 45.1, 35.70000000000003, 40.10000000000002, 23.8999999999999, 44.5, 47.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 48, 500, 500, 54, 452, 36, 82, 396, 64, 144, 500, 500, 240, 50, 90, 500, 98, 500, 136, 66, 28, 500, 320, 70, 54, 52, 252, 500, 500, 44, 38, 194, 500, 62, 326, 334, 32, 130, 500, 46, 500, 128, 30, 500, 500, 48, 500, 500, 344, 54, 500, 48, 212, 500, 74, 40, 62, 88, 500, 500, 216, 246, 100, 500, 110, 60, 500, 500, 500, 72, 500, 88, 122, 40, 66, 40, 500, 500, 122, 500, 90, 156, 500, 192, 128, 124, 142, 32, 500, 50, 144, 100, 262, 56, 24, 500, 122, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991851951964033, "mean_inference_ms": 1.2799113592691698, "mean_action_processing_ms": 0.14983797630869955, "mean_env_wait_ms": 0.08847770745707559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04579949378967285, "StateBufferConnector_ms": 0.012001276016235352, "ViewRequirementAgentConnector_ms": 0.21680331230163574}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.531999999999842, "episode_len_mean": 245.36, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 4.899999999999629, 46.5, 41.90000000000001, 10.499999999999709, 43.7, 35.70000000000003, -50.00000000000044, -50.00000000000044, 26.09999999999993, 45.1, 41.100000000000016, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.50000000000003, 43.50000000000001, 47.3, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.7, 44.900000000000006, 24.899999999999913, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 30.699999999999996, -50.00000000000044, 43.900000000000006, 17.499999999999808, 16.699999999999797, 46.9, 37.10000000000003, -50.00000000000044, 45.5, -50.00000000000044, 37.300000000000026, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 15.699999999999783, 44.7, -50.00000000000044, 45.3, 28.89999999999997, -50.00000000000044, 42.70000000000001, 46.099999999999994, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, 25.499999999999922, 40.10000000000002, -50.00000000000044, 39.10000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.30000000000001, 37.90000000000003, 46.099999999999994, 43.50000000000001, 46.099999999999994, 0.09999999999956088, -50.00000000000044, 37.90000000000003, -50.00000000000044, 41.100000000000016, 34.50000000000004, -50.00000000000044, 30.9, 37.300000000000026, 37.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, 45.1, 35.70000000000003, 40.10000000000002, 23.8999999999999, 44.5, 47.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 48, 500, 500, 54, 452, 36, 82, 396, 64, 144, 500, 500, 240, 50, 90, 500, 98, 500, 136, 66, 28, 500, 320, 70, 54, 52, 252, 500, 500, 44, 38, 194, 500, 62, 326, 334, 32, 130, 500, 46, 500, 128, 30, 500, 500, 48, 500, 500, 344, 54, 500, 48, 212, 500, 74, 40, 62, 88, 500, 500, 216, 246, 100, 500, 110, 60, 500, 500, 500, 72, 500, 88, 122, 40, 66, 40, 500, 500, 122, 500, 90, 156, 500, 192, 128, 124, 142, 32, 500, 50, 144, 100, 262, 56, 24, 500, 122, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991851951964033, "mean_inference_ms": 1.2799113592691698, "mean_action_processing_ms": 0.14983797630869955, "mean_env_wait_ms": 0.08847770745707559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04579949378967285, "StateBufferConnector_ms": 0.012001276016235352, "ViewRequirementAgentConnector_ms": 0.21680331230163574}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3115.8274808842743, "num_env_steps_trained_throughput_per_sec": 3115.8274808842743, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 4052.093, "sample_time_ms": 3487.701, "load_time_ms": 19.003, "load_throughput": 947239.764, "learn_time_ms": 501.748, "learn_throughput": 35874.558, "synch_weights_time_ms": 41.438}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3984, "training_iteration": 57, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-22", "timestamp": 1698250822, "time_this_iter_s": 5.7859580516815186, "time_total_s": 201.7137107849121, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.7137107849121, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 94.42857142857143, "ram_util_percent": 28.499999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814452e-18, "cur_lr": 0.0003, "total_loss": 6.7433961656358505, "policy_loss": -0.0001020001040564643, "vf_loss": 6.743548011779785, "vf_explained_var": -0.00444177786509196, "kl": 0.00038200533182235734, "entropy": 0.49844850897789, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2588.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.369999999999852, "episode_len_mean": 236.98, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 37.90000000000003, 46.099999999999994, 43.50000000000001, 46.099999999999994, 0.09999999999956088, -50.00000000000044, 37.90000000000003, -50.00000000000044, 41.100000000000016, 34.50000000000004, -50.00000000000044, 30.9, 37.300000000000026, 37.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, 45.1, 35.70000000000003, 40.10000000000002, 23.8999999999999, 44.5, 47.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 35.70000000000003, 41.70000000000002, 44.900000000000006, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.1, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, 45.1, -50.00000000000044, 45.9, 44.5, 47.9, 30.9, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 35.30000000000004, -50.00000000000044, 29.099999999999973, 45.3, 43.7, 46.3, 41.100000000000016, 35.900000000000034, -50.00000000000044, 21.499999999999865, 33.70000000000004, 0.49999999999956657, 32.90000000000003, 46.3, -50.00000000000044, 23.099999999999888, 41.70000000000002, 4.899999999999629, 37.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 37.70000000000003, 33.90000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 88, 122, 40, 66, 40, 500, 500, 122, 500, 90, 156, 500, 192, 128, 124, 142, 32, 500, 50, 144, 100, 262, 56, 24, 500, 122, 500, 66, 500, 34, 500, 72, 500, 38, 500, 108, 500, 500, 500, 78, 44, 144, 84, 52, 116, 500, 500, 500, 144, 50, 56, 500, 500, 52, 98, 50, 500, 42, 56, 22, 192, 500, 44, 70, 500, 500, 500, 500, 36, 46, 148, 500, 210, 48, 64, 38, 90, 142, 500, 286, 164, 496, 172, 38, 500, 270, 84, 452, 128, 38, 500, 500, 28, 40, 124, 162, 82, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4022831586732993, "mean_inference_ms": 1.290641578660243, "mean_action_processing_ms": 0.15111018656753555, "mean_env_wait_ms": 0.089400806855337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038788795471191406, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.20730948448181152}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.369999999999852, "episode_len_mean": 236.98, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 37.90000000000003, 46.099999999999994, 43.50000000000001, 46.099999999999994, 0.09999999999956088, -50.00000000000044, 37.90000000000003, -50.00000000000044, 41.100000000000016, 34.50000000000004, -50.00000000000044, 30.9, 37.300000000000026, 37.70000000000003, 35.900000000000034, 46.9, -50.00000000000044, 45.1, 35.70000000000003, 40.10000000000002, 23.8999999999999, 44.5, 47.7, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 35.70000000000003, 41.70000000000002, 44.900000000000006, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.1, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, 45.1, -50.00000000000044, 45.9, 44.5, 47.9, 30.9, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 35.30000000000004, -50.00000000000044, 29.099999999999973, 45.3, 43.7, 46.3, 41.100000000000016, 35.900000000000034, -50.00000000000044, 21.499999999999865, 33.70000000000004, 0.49999999999956657, 32.90000000000003, 46.3, -50.00000000000044, 23.099999999999888, 41.70000000000002, 4.899999999999629, 37.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 37.70000000000003, 33.90000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 88, 122, 40, 66, 40, 500, 500, 122, 500, 90, 156, 500, 192, 128, 124, 142, 32, 500, 50, 144, 100, 262, 56, 24, 500, 122, 500, 66, 500, 34, 500, 72, 500, 38, 500, 108, 500, 500, 500, 78, 44, 144, 84, 52, 116, 500, 500, 500, 144, 50, 56, 500, 500, 52, 98, 50, 500, 42, 56, 22, 192, 500, 44, 70, 500, 500, 500, 500, 36, 46, 148, 500, 210, 48, 64, 38, 90, 142, 500, 286, 164, 496, 172, 38, 500, 270, 84, 452, 128, 38, 500, 500, 28, 40, 124, 162, 82, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4022831586732993, "mean_inference_ms": 1.290641578660243, "mean_action_processing_ms": 0.15111018656753555, "mean_env_wait_ms": 0.089400806855337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038788795471191406, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.20730948448181152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3678.0104366431747, "num_env_steps_trained_throughput_per_sec": 3678.0104366431747, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 4202.186, "sample_time_ms": 3628.567, "load_time_ms": 19.599, "load_throughput": 918393.694, "learn_time_ms": 509.268, "learn_throughput": 35344.835, "synch_weights_time_ms": 42.51}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4055, "training_iteration": 58, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-27", "timestamp": 1698250827, "time_this_iter_s": 4.902554273605347, "time_total_s": 206.61626505851746, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.61626505851746, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 88.11428571428573, "ram_util_percent": 28.657142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907226e-19, "cur_lr": 0.0003, "total_loss": 6.4512981414794925, "policy_loss": -0.00035267168035109836, "vf_loss": 6.4517075326707625, "vf_explained_var": 0.00017527871661716037, "kl": 0.0011394169632151514, "entropy": 0.5679742243554857, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2633.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.245999999999844, "episode_len_mean": 248.22, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 45.5, 35.30000000000004, -50.00000000000044, 29.099999999999973, 45.3, 43.7, 46.3, 41.100000000000016, 35.900000000000034, -50.00000000000044, 21.499999999999865, 33.70000000000004, 0.49999999999956657, 32.90000000000003, 46.3, -50.00000000000044, 23.099999999999888, 41.70000000000002, 4.899999999999629, 37.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 37.70000000000003, 33.90000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 20.299999999999848, -50.00000000000044, -50.00000000000044, 42.10000000000001, 39.50000000000002, 25.699999999999925, 41.100000000000016, 40.500000000000014, 45.7, 35.900000000000034, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.900000000000006, 45.5, 34.70000000000004, 46.5, -50.00000000000044, 32.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 33.500000000000036, 44.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 12.499999999999737, 28.699999999999967, 32.50000000000002, 44.10000000000001, 41.70000000000002, 40.500000000000014, 41.30000000000001, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.30000000000003, 45.9, 41.70000000000002, 38.700000000000024, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.5], "episode_lengths": [36, 46, 148, 500, 210, 48, 64, 38, 90, 142, 500, 286, 164, 496, 172, 38, 500, 270, 84, 452, 128, 38, 500, 500, 28, 40, 124, 162, 82, 500, 500, 500, 500, 98, 298, 500, 500, 80, 106, 244, 90, 96, 44, 142, 500, 114, 500, 86, 40, 500, 58, 62, 46, 154, 36, 500, 180, 70, 500, 500, 96, 166, 56, 500, 370, 500, 500, 32, 500, 500, 158, 500, 98, 500, 500, 60, 376, 214, 176, 60, 84, 96, 88, 492, 500, 500, 66, 500, 138, 42, 84, 114, 500, 108, 74, 500, 500, 500, 108, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4048747543840206, "mean_inference_ms": 1.2982896723665118, "mean_action_processing_ms": 0.15168997888141353, "mean_env_wait_ms": 0.08993145691624878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02924823760986328, "StateBufferConnector_ms": 0.0040056705474853516, "ViewRequirementAgentConnector_ms": 0.1659858226776123}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.245999999999844, "episode_len_mean": 248.22, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 45.5, 35.30000000000004, -50.00000000000044, 29.099999999999973, 45.3, 43.7, 46.3, 41.100000000000016, 35.900000000000034, -50.00000000000044, 21.499999999999865, 33.70000000000004, 0.49999999999956657, 32.90000000000003, 46.3, -50.00000000000044, 23.099999999999888, 41.70000000000002, 4.899999999999629, 37.300000000000026, 46.3, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, 37.70000000000003, 33.90000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 20.299999999999848, -50.00000000000044, -50.00000000000044, 42.10000000000001, 39.50000000000002, 25.699999999999925, 41.100000000000016, 40.500000000000014, 45.7, 35.900000000000034, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.500000000000014, 46.099999999999994, -50.00000000000044, 44.300000000000004, 43.900000000000006, 45.5, 34.70000000000004, 46.5, -50.00000000000044, 32.100000000000016, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 33.500000000000036, 44.5, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 12.499999999999737, 28.699999999999967, 32.50000000000002, 44.10000000000001, 41.70000000000002, 40.500000000000014, 41.30000000000001, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.30000000000003, 45.9, 41.70000000000002, 38.700000000000024, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.5], "episode_lengths": [36, 46, 148, 500, 210, 48, 64, 38, 90, 142, 500, 286, 164, 496, 172, 38, 500, 270, 84, 452, 128, 38, 500, 500, 28, 40, 124, 162, 82, 500, 500, 500, 500, 98, 298, 500, 500, 80, 106, 244, 90, 96, 44, 142, 500, 114, 500, 86, 40, 500, 58, 62, 46, 154, 36, 500, 180, 70, 500, 500, 96, 166, 56, 500, 370, 500, 500, 32, 500, 500, 158, 500, 98, 500, 500, 60, 376, 214, 176, 60, 84, 96, 88, 492, 500, 500, 66, 500, 138, 42, 84, 114, 500, 108, 74, 500, 500, 500, 108, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4048747543840206, "mean_inference_ms": 1.2982896723665118, "mean_action_processing_ms": 0.15168997888141353, "mean_env_wait_ms": 0.08993145691624878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02924823760986328, "StateBufferConnector_ms": 0.0040056705474853516, "ViewRequirementAgentConnector_ms": 0.1659858226776123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3893.3090341459792, "num_env_steps_trained_throughput_per_sec": 3893.3090341459792, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 4320.765, "sample_time_ms": 3747.106, "load_time_ms": 19.499, "load_throughput": 923104.327, "learn_time_ms": 508.906, "learn_throughput": 35369.988, "synch_weights_time_ms": 43.012}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4124, "training_iteration": 59, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-31", "timestamp": 1698250831, "time_this_iter_s": 4.631924390792847, "time_total_s": 211.2481894493103, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.2481894493103, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 86.64999999999999, "ram_util_percent": 28.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953613e-19, "cur_lr": 0.0003, "total_loss": 6.84296350479126, "policy_loss": -0.0005020679699050055, "vf_loss": 6.843524763319228, "vf_explained_var": 0.005375875367058648, "kl": 0.0009895673946339735, "entropy": 0.5920834236674839, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2678.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.558999999999822, "episode_len_mean": 270.04, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 12.499999999999737, 28.699999999999967, 32.50000000000002, 44.10000000000001, 41.70000000000002, 40.500000000000014, 41.30000000000001, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.30000000000003, 45.9, 41.70000000000002, 38.700000000000024, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 42.10000000000001, 38.90000000000002, 35.500000000000036, 41.70000000000002, -50.00000000000044, 39.90000000000002, 0.8999999999995723, 46.099999999999994, 42.30000000000001, 26.499999999999936, 31.900000000000013, 27.899999999999956, 11.099999999999717, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, 37.300000000000026, -50.00000000000044, 42.500000000000014, 41.90000000000001, 41.70000000000002, 32.50000000000002, -50.00000000000044, 15.899999999999785, -50.00000000000044, 44.5, -50.00000000000044, 31.70000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 22.299999999999876, 39.50000000000002, 42.900000000000006, 36.900000000000034, -50.00000000000044, 38.700000000000024, 30.29999999999999, -50.00000000000044, 29.49999999999998, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 40.70000000000002, -50.00000000000044, 2.499999999999595], "episode_lengths": [500, 500, 158, 500, 98, 500, 500, 60, 376, 214, 176, 60, 84, 96, 88, 492, 500, 500, 66, 500, 138, 42, 84, 114, 500, 108, 74, 500, 500, 500, 108, 36, 500, 500, 500, 500, 500, 500, 40, 500, 500, 38, 52, 80, 112, 146, 84, 500, 102, 492, 40, 78, 236, 182, 222, 390, 92, 500, 500, 44, 34, 128, 500, 76, 82, 84, 176, 500, 342, 500, 56, 500, 184, 82, 500, 500, 66, 62, 500, 278, 106, 72, 132, 500, 114, 198, 500, 206, 48, 500, 58, 500, 114, 62, 500, 72, 500, 94, 500, 476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4069698335807543, "mean_inference_ms": 1.3061068740636035, "mean_action_processing_ms": 0.1530164886212488, "mean_env_wait_ms": 0.09069839339601198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044474124908447266, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.16205978393554688}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.558999999999822, "episode_len_mean": 270.04, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 12.499999999999737, 28.699999999999967, 32.50000000000002, 44.10000000000001, 41.70000000000002, 40.500000000000014, 41.30000000000001, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.30000000000003, 45.9, 41.70000000000002, 38.700000000000024, -50.00000000000044, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, 44.900000000000006, 42.10000000000001, 38.90000000000002, 35.500000000000036, 41.70000000000002, -50.00000000000044, 39.90000000000002, 0.8999999999995723, 46.099999999999994, 42.30000000000001, 26.499999999999936, 31.900000000000013, 27.899999999999956, 11.099999999999717, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, 37.300000000000026, -50.00000000000044, 42.500000000000014, 41.90000000000001, 41.70000000000002, 32.50000000000002, -50.00000000000044, 15.899999999999785, -50.00000000000044, 44.5, -50.00000000000044, 31.70000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 22.299999999999876, 39.50000000000002, 42.900000000000006, 36.900000000000034, -50.00000000000044, 38.700000000000024, 30.29999999999999, -50.00000000000044, 29.49999999999998, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 40.70000000000002, -50.00000000000044, 2.499999999999595], "episode_lengths": [500, 500, 158, 500, 98, 500, 500, 60, 376, 214, 176, 60, 84, 96, 88, 492, 500, 500, 66, 500, 138, 42, 84, 114, 500, 108, 74, 500, 500, 500, 108, 36, 500, 500, 500, 500, 500, 500, 40, 500, 500, 38, 52, 80, 112, 146, 84, 500, 102, 492, 40, 78, 236, 182, 222, 390, 92, 500, 500, 44, 34, 128, 500, 76, 82, 84, 176, 500, 342, 500, 56, 500, 184, 82, 500, 500, 66, 62, 500, 278, 106, 72, 132, 500, 114, 198, 500, 206, 48, 500, 58, 500, 114, 62, 500, 72, 500, 94, 500, 476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4069698335807543, "mean_inference_ms": 1.3061068740636035, "mean_action_processing_ms": 0.1530164886212488, "mean_env_wait_ms": 0.09069839339601198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044474124908447266, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.16205978393554688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3980.789700176389, "num_env_steps_trained_throughput_per_sec": 3980.789700176389, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 4426.133, "sample_time_ms": 3839.599, "load_time_ms": 19.246, "load_throughput": 935238.128, "learn_time_ms": 521.772, "learn_throughput": 34497.825, "synch_weights_time_ms": 43.273}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4192, "training_iteration": 60, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-36", "timestamp": 1698250836, "time_this_iter_s": 4.529344081878662, "time_total_s": 215.77753353118896, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.77753353118896, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 83.18333333333334, "ram_util_percent": 28.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768065e-19, "cur_lr": 0.0003, "total_loss": 6.93514944712321, "policy_loss": -0.00015377261572413974, "vf_loss": 6.935363218519423, "vf_explained_var": 0.0009881721602545844, "kl": 0.0006352095894638884, "entropy": 0.5997566130426195, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2723.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.304999999999821, "episode_len_mean": 272.6, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.899999999999785, -50.00000000000044, 44.5, -50.00000000000044, 31.70000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 22.299999999999876, 39.50000000000002, 42.900000000000006, 36.900000000000034, -50.00000000000044, 38.700000000000024, 30.29999999999999, -50.00000000000044, 29.49999999999998, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 40.70000000000002, -50.00000000000044, 2.499999999999595, -50.00000000000044, 36.50000000000003, 43.50000000000001, 45.1, 42.500000000000014, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 47.3, 35.900000000000034, -50.00000000000044, 30.699999999999996, 35.500000000000036, 35.500000000000036, 33.10000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 40.500000000000014, -50.00000000000044, 38.300000000000026, 43.50000000000001, 44.10000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, 45.7, 45.3, 12.099999999999731, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 37.70000000000003, 36.50000000000003, -50.00000000000044, 32.50000000000002, 20.49999999999985, 45.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 2.499999999999595, 34.70000000000004, 42.900000000000006, -50.00000000000044, 28.89999999999997, -50.00000000000044, 6.699999999999655, 10.099999999999703, 33.10000000000003, 46.3, -50.00000000000044, 35.10000000000004, 23.499999999999893, 43.30000000000001], "episode_lengths": [342, 500, 56, 500, 184, 82, 500, 500, 66, 62, 500, 278, 106, 72, 132, 500, 114, 198, 500, 206, 48, 500, 58, 500, 114, 62, 500, 72, 500, 94, 500, 476, 500, 136, 66, 50, 76, 336, 500, 500, 500, 500, 500, 130, 28, 142, 500, 194, 146, 146, 170, 500, 500, 96, 60, 500, 500, 258, 96, 500, 118, 66, 60, 500, 102, 500, 96, 44, 48, 380, 500, 84, 500, 44, 124, 136, 500, 176, 296, 48, 148, 500, 500, 352, 500, 46, 476, 154, 72, 500, 212, 500, 434, 400, 170, 38, 500, 150, 266, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40819611426434776, "mean_inference_ms": 1.3112835470404767, "mean_action_processing_ms": 0.15337859880342383, "mean_env_wait_ms": 0.09108015745750553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04088020324707031, "StateBufferConnector_ms": 0.00900721549987793, "ViewRequirementAgentConnector_ms": 0.1595325469970703}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.304999999999821, "episode_len_mean": 272.6, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.899999999999785, -50.00000000000044, 44.5, -50.00000000000044, 31.70000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 22.299999999999876, 39.50000000000002, 42.900000000000006, 36.900000000000034, -50.00000000000044, 38.700000000000024, 30.29999999999999, -50.00000000000044, 29.49999999999998, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 40.70000000000002, -50.00000000000044, 2.499999999999595, -50.00000000000044, 36.50000000000003, 43.50000000000001, 45.1, 42.500000000000014, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 47.3, 35.900000000000034, -50.00000000000044, 30.699999999999996, 35.500000000000036, 35.500000000000036, 33.10000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 24.299999999999905, 40.500000000000014, -50.00000000000044, 38.300000000000026, 43.50000000000001, 44.10000000000001, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, 45.7, 45.3, 12.099999999999731, -50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 37.70000000000003, 36.50000000000003, -50.00000000000044, 32.50000000000002, 20.49999999999985, 45.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 2.499999999999595, 34.70000000000004, 42.900000000000006, -50.00000000000044, 28.89999999999997, -50.00000000000044, 6.699999999999655, 10.099999999999703, 33.10000000000003, 46.3, -50.00000000000044, 35.10000000000004, 23.499999999999893, 43.30000000000001], "episode_lengths": [342, 500, 56, 500, 184, 82, 500, 500, 66, 62, 500, 278, 106, 72, 132, 500, 114, 198, 500, 206, 48, 500, 58, 500, 114, 62, 500, 72, 500, 94, 500, 476, 500, 136, 66, 50, 76, 336, 500, 500, 500, 500, 500, 130, 28, 142, 500, 194, 146, 146, 170, 500, 500, 96, 60, 500, 500, 258, 96, 500, 118, 66, 60, 500, 102, 500, 96, 44, 48, 380, 500, 84, 500, 44, 124, 136, 500, 176, 296, 48, 148, 500, 500, 352, 500, 46, 476, 154, 72, 500, 212, 500, 434, 400, 170, 38, 500, 150, 266, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40819611426434776, "mean_inference_ms": 1.3112835470404767, "mean_action_processing_ms": 0.15337859880342383, "mean_env_wait_ms": 0.09108015745750553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04088020324707031, "StateBufferConnector_ms": 0.00900721549987793, "ViewRequirementAgentConnector_ms": 0.1595325469970703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4103.315932698365, "num_env_steps_trained_throughput_per_sec": 4103.315932698365, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 4546.302, "sample_time_ms": 3949.594, "load_time_ms": 19.955, "load_throughput": 902046.124, "learn_time_ms": 530.841, "learn_throughput": 33908.463, "synch_weights_time_ms": 43.67}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4260, "training_iteration": 61, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-40", "timestamp": 1698250840, "time_this_iter_s": 4.3946874141693115, "time_total_s": 220.17222094535828, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 220.17222094535828, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 77.64999999999999, "ram_util_percent": 29.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884032e-20, "cur_lr": 0.0003, "total_loss": 6.691494496663411, "policy_loss": -0.000306697686513265, "vf_loss": 6.691859690348307, "vf_explained_var": -0.004010781976911757, "kl": 0.0012651096842773769, "entropy": 0.5850505451361339, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2768.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.186999999999834, "episode_len_mean": 263.82, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 37.70000000000003, 36.50000000000003, -50.00000000000044, 32.50000000000002, 20.49999999999985, 45.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 2.499999999999595, 34.70000000000004, 42.900000000000006, -50.00000000000044, 28.89999999999997, -50.00000000000044, 6.699999999999655, 10.099999999999703, 33.10000000000003, 46.3, -50.00000000000044, 35.10000000000004, 23.499999999999893, 43.30000000000001, 6.8999999999996575, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.5, -50.00000000000044, 11.699999999999726, 41.30000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.099999999999994, 45.3, 7.899999999999672, 33.90000000000004, 42.500000000000014, -50.00000000000044, 39.50000000000002, 40.90000000000002, 29.69999999999998, 44.7, 45.9, 41.90000000000001, -50.00000000000044, 45.7, 17.899999999999814, -50.00000000000044, 47.3, 46.099999999999994, 42.500000000000014, 13.499999999999751, -50.00000000000044, 23.499999999999893, -50.00000000000044, 34.70000000000004, -50.00000000000044, 28.89999999999997, 34.50000000000004, 34.10000000000004, -50.00000000000044, 45.5, 33.30000000000003, 43.30000000000001, 22.49999999999988, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 39.70000000000002, 40.30000000000002, 32.700000000000024, 40.500000000000014, 42.900000000000006, 7.499999999999666, 20.699999999999854, -50.00000000000044, -50.00000000000044, 33.10000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 84, 500, 44, 124, 136, 500, 176, 296, 48, 148, 500, 500, 352, 500, 46, 476, 154, 72, 500, 212, 500, 434, 400, 170, 38, 500, 150, 266, 68, 432, 46, 500, 106, 500, 146, 500, 56, 500, 384, 88, 500, 74, 500, 76, 500, 108, 500, 40, 48, 422, 162, 76, 500, 106, 92, 204, 54, 42, 82, 500, 44, 322, 500, 28, 40, 76, 366, 500, 266, 500, 154, 500, 212, 156, 160, 500, 46, 168, 68, 276, 500, 94, 500, 34, 500, 128, 104, 98, 174, 96, 72, 426, 294, 500, 500, 170, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40934038848117454, "mean_inference_ms": 1.3148745042868597, "mean_action_processing_ms": 0.15317640879468486, "mean_env_wait_ms": 0.09136573936003821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03340625762939453, "StateBufferConnector_ms": 0.012006521224975586, "ViewRequirementAgentConnector_ms": 0.15929055213928223}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.186999999999834, "episode_len_mean": 263.82, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 45.7, 37.70000000000003, 36.50000000000003, -50.00000000000044, 32.50000000000002, 20.49999999999985, 45.3, 35.30000000000004, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, 45.5, 2.499999999999595, 34.70000000000004, 42.900000000000006, -50.00000000000044, 28.89999999999997, -50.00000000000044, 6.699999999999655, 10.099999999999703, 33.10000000000003, 46.3, -50.00000000000044, 35.10000000000004, 23.499999999999893, 43.30000000000001, 6.8999999999996575, 45.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.5, -50.00000000000044, 11.699999999999726, 41.30000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.099999999999994, 45.3, 7.899999999999672, 33.90000000000004, 42.500000000000014, -50.00000000000044, 39.50000000000002, 40.90000000000002, 29.69999999999998, 44.7, 45.9, 41.90000000000001, -50.00000000000044, 45.7, 17.899999999999814, -50.00000000000044, 47.3, 46.099999999999994, 42.500000000000014, 13.499999999999751, -50.00000000000044, 23.499999999999893, -50.00000000000044, 34.70000000000004, -50.00000000000044, 28.89999999999997, 34.50000000000004, 34.10000000000004, -50.00000000000044, 45.5, 33.30000000000003, 43.30000000000001, 22.49999999999988, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 39.70000000000002, 40.30000000000002, 32.700000000000024, 40.500000000000014, 42.900000000000006, 7.499999999999666, 20.699999999999854, -50.00000000000044, -50.00000000000044, 33.10000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 84, 500, 44, 124, 136, 500, 176, 296, 48, 148, 500, 500, 352, 500, 46, 476, 154, 72, 500, 212, 500, 434, 400, 170, 38, 500, 150, 266, 68, 432, 46, 500, 106, 500, 146, 500, 56, 500, 384, 88, 500, 74, 500, 76, 500, 108, 500, 40, 48, 422, 162, 76, 500, 106, 92, 204, 54, 42, 82, 500, 44, 322, 500, 28, 40, 76, 366, 500, 266, 500, 154, 500, 212, 156, 160, 500, 46, 168, 68, 276, 500, 94, 500, 34, 500, 128, 104, 98, 174, 96, 72, 426, 294, 500, 500, 170, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40934038848117454, "mean_inference_ms": 1.3148745042868597, "mean_action_processing_ms": 0.15317640879468486, "mean_env_wait_ms": 0.09136573936003821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03340625762939453, "StateBufferConnector_ms": 0.012006521224975586, "ViewRequirementAgentConnector_ms": 0.15929055213928223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4374.374392817952, "num_env_steps_trained_throughput_per_sec": 4374.374392817952, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 4636.59, "sample_time_ms": 4011.585, "load_time_ms": 20.557, "load_throughput": 875629.454, "learn_time_ms": 558.383, "learn_throughput": 32235.947, "synch_weights_time_ms": 43.822}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4330, "training_iteration": 62, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-44", "timestamp": 1698250844, "time_this_iter_s": 4.120988845825195, "time_total_s": 224.29320979118347, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 224.29320979118347, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 71.2, "ram_util_percent": 28.950000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942016e-20, "cur_lr": 0.0003, "total_loss": 7.297186491224501, "policy_loss": -0.0007149633434083727, "vf_loss": 7.29795995288425, "vf_explained_var": -0.0016449173291524252, "kl": 0.0017733156220414356, "entropy": 0.5842624690797594, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2813.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.658999999999853, "episode_len_mean": 249.12, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.10000000000004, -50.00000000000044, 45.5, 33.30000000000003, 43.30000000000001, 22.49999999999988, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 39.70000000000002, 40.30000000000002, 32.700000000000024, 40.500000000000014, 42.900000000000006, 7.499999999999666, 20.699999999999854, -50.00000000000044, -50.00000000000044, 33.10000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 24.299999999999905, 38.10000000000002, -50.00000000000044, -50.00000000000044, 3.699999999999612, 38.300000000000026, 41.30000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 7.09999999999966, 45.7, 43.50000000000001, 39.90000000000002, 34.10000000000004, 43.7, -50.00000000000044, 30.699999999999996, 45.7, 37.10000000000003, 38.90000000000002, 31.300000000000004, 44.5, 18.29999999999982, 39.50000000000002, -50.00000000000044, 25.099999999999916, 41.70000000000002, 45.5, 30.29999999999999, -50.00000000000044, 37.50000000000003, 41.90000000000001, 42.500000000000014, -50.00000000000044, 46.5, 44.10000000000001, 40.30000000000002, -50.00000000000044, 42.30000000000001, 32.90000000000003, 12.299999999999734, 32.30000000000002, 19.899999999999842, 38.300000000000026, 39.50000000000002, 43.50000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.5, 33.90000000000004, 17.099999999999802, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.3, -50.00000000000044, 29.899999999999984, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.10000000000004, 24.69999999999991, 30.499999999999993, -50.00000000000044], "episode_lengths": [160, 500, 46, 168, 68, 276, 500, 94, 500, 34, 500, 128, 104, 98, 174, 96, 72, 426, 294, 500, 500, 170, 72, 500, 500, 500, 500, 72, 258, 120, 500, 500, 464, 118, 88, 108, 500, 500, 500, 348, 430, 44, 66, 102, 160, 64, 500, 194, 44, 130, 112, 188, 56, 318, 106, 500, 250, 84, 46, 198, 500, 126, 82, 76, 500, 36, 60, 98, 500, 78, 172, 378, 178, 302, 118, 106, 66, 148, 500, 500, 46, 162, 330, 60, 500, 48, 500, 54, 500, 50, 38, 500, 202, 140, 500, 500, 160, 254, 196, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4102818644603625, "mean_inference_ms": 1.3176575345676067, "mean_action_processing_ms": 0.1536096349204987, "mean_env_wait_ms": 0.09160161515323546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279998779296875, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.1468958854675293}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.658999999999853, "episode_len_mean": 249.12, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.10000000000004, -50.00000000000044, 45.5, 33.30000000000003, 43.30000000000001, 22.49999999999988, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 37.300000000000026, 39.70000000000002, 40.30000000000002, 32.700000000000024, 40.500000000000014, 42.900000000000006, 7.499999999999666, 20.699999999999854, -50.00000000000044, -50.00000000000044, 33.10000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 24.299999999999905, 38.10000000000002, -50.00000000000044, -50.00000000000044, 3.699999999999612, 38.300000000000026, 41.30000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 7.09999999999966, 45.7, 43.50000000000001, 39.90000000000002, 34.10000000000004, 43.7, -50.00000000000044, 30.699999999999996, 45.7, 37.10000000000003, 38.90000000000002, 31.300000000000004, 44.5, 18.29999999999982, 39.50000000000002, -50.00000000000044, 25.099999999999916, 41.70000000000002, 45.5, 30.29999999999999, -50.00000000000044, 37.50000000000003, 41.90000000000001, 42.500000000000014, -50.00000000000044, 46.5, 44.10000000000001, 40.30000000000002, -50.00000000000044, 42.30000000000001, 32.90000000000003, 12.299999999999734, 32.30000000000002, 19.899999999999842, 38.300000000000026, 39.50000000000002, 43.50000000000001, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.5, 33.90000000000004, 17.099999999999802, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.3, -50.00000000000044, 29.899999999999984, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.10000000000004, 24.69999999999991, 30.499999999999993, -50.00000000000044], "episode_lengths": [160, 500, 46, 168, 68, 276, 500, 94, 500, 34, 500, 128, 104, 98, 174, 96, 72, 426, 294, 500, 500, 170, 72, 500, 500, 500, 500, 72, 258, 120, 500, 500, 464, 118, 88, 108, 500, 500, 500, 348, 430, 44, 66, 102, 160, 64, 500, 194, 44, 130, 112, 188, 56, 318, 106, 500, 250, 84, 46, 198, 500, 126, 82, 76, 500, 36, 60, 98, 500, 78, 172, 378, 178, 302, 118, 106, 66, 148, 500, 500, 46, 162, 330, 60, 500, 48, 500, 54, 500, 50, 38, 500, 202, 140, 500, 500, 160, 254, 196, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4102818644603625, "mean_inference_ms": 1.3176575345676067, "mean_action_processing_ms": 0.1536096349204987, "mean_env_wait_ms": 0.09160161515323546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279998779296875, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.1468958854675293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4438.376748382172, "num_env_steps_trained_throughput_per_sec": 4438.376748382172, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 4708.443, "sample_time_ms": 4074.659, "load_time_ms": 19.887, "load_throughput": 905135.853, "learn_time_ms": 567.644, "learn_throughput": 31710.022, "synch_weights_time_ms": 44.01}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4405, "training_iteration": 63, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-49", "timestamp": 1698250849, "time_this_iter_s": 4.063326597213745, "time_total_s": 228.35653638839722, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.35653638839722, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 68.11666666666666, "ram_util_percent": 28.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.168404344971008e-20, "cur_lr": 0.0003, "total_loss": 7.042887327406142, "policy_loss": -0.0007861219346523285, "vf_loss": 7.043733416663276, "vf_explained_var": -0.0065583679411146375, "kl": 0.0015561324412680555, "entropy": 0.599268044365777, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2858.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.638999999999864, "episode_len_mean": 229.36, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 33.90000000000004, 17.099999999999802, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.3, -50.00000000000044, 29.899999999999984, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.10000000000004, 24.69999999999991, 30.499999999999993, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 44.900000000000006, 32.90000000000003, -50.00000000000044, 44.7, 41.70000000000002, 40.90000000000002, 44.300000000000004, 43.50000000000001, -50.00000000000044, 36.30000000000003, 36.70000000000003, -50.00000000000044, 43.7, 6.8999999999996575, 10.899999999999714, 44.7, 44.900000000000006, 45.1, 10.299999999999706, 31.900000000000013, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 47.3, 43.7, 45.9, 34.10000000000004, 43.900000000000006, 5.499999999999638, 44.7, -50.00000000000044, 41.100000000000016, 44.5, 45.3, 39.10000000000002, 47.9, 19.09999999999983, 42.70000000000001, 41.100000000000016, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.10000000000002, -50.00000000000044, 33.30000000000003, 40.500000000000014, 31.1, 24.499999999999908, 43.30000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 47.9, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 33.500000000000036, -50.00000000000044, 36.70000000000003, 40.90000000000002, 19.899999999999842, 29.49999999999998, -50.00000000000044, 44.5, 31.500000000000007, 41.500000000000014, 32.100000000000016, 45.1, 15.299999999999777, 1.4999999999995808], "episode_lengths": [500, 46, 162, 330, 60, 500, 48, 500, 54, 500, 50, 38, 500, 202, 140, 500, 500, 160, 254, 196, 500, 174, 500, 500, 52, 172, 500, 54, 84, 92, 58, 66, 500, 138, 134, 500, 64, 432, 392, 54, 52, 50, 398, 182, 246, 500, 500, 500, 174, 28, 64, 42, 160, 62, 446, 54, 500, 90, 56, 48, 110, 22, 310, 74, 90, 500, 270, 500, 100, 500, 168, 96, 190, 256, 68, 500, 70, 88, 22, 50, 100, 500, 500, 48, 62, 92, 166, 500, 134, 92, 302, 206, 500, 56, 186, 86, 180, 50, 348, 486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41060199148361265, "mean_inference_ms": 1.319559450624977, "mean_action_processing_ms": 0.15408200709187625, "mean_env_wait_ms": 0.09167722811519162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003692626953125, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.1171119213104248}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.638999999999864, "episode_len_mean": 229.36, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 33.90000000000004, 17.099999999999802, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.3, -50.00000000000044, 29.899999999999984, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.10000000000004, 24.69999999999991, 30.499999999999993, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 44.900000000000006, 32.90000000000003, -50.00000000000044, 44.7, 41.70000000000002, 40.90000000000002, 44.300000000000004, 43.50000000000001, -50.00000000000044, 36.30000000000003, 36.70000000000003, -50.00000000000044, 43.7, 6.8999999999996575, 10.899999999999714, 44.7, 44.900000000000006, 45.1, 10.299999999999706, 31.900000000000013, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 47.3, 43.7, 45.9, 34.10000000000004, 43.900000000000006, 5.499999999999638, 44.7, -50.00000000000044, 41.100000000000016, 44.5, 45.3, 39.10000000000002, 47.9, 19.09999999999983, 42.70000000000001, 41.100000000000016, -50.00000000000044, 23.099999999999888, -50.00000000000044, 40.10000000000002, -50.00000000000044, 33.30000000000003, 40.500000000000014, 31.1, 24.499999999999908, 43.30000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 47.9, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 33.500000000000036, -50.00000000000044, 36.70000000000003, 40.90000000000002, 19.899999999999842, 29.49999999999998, -50.00000000000044, 44.5, 31.500000000000007, 41.500000000000014, 32.100000000000016, 45.1, 15.299999999999777, 1.4999999999995808], "episode_lengths": [500, 46, 162, 330, 60, 500, 48, 500, 54, 500, 50, 38, 500, 202, 140, 500, 500, 160, 254, 196, 500, 174, 500, 500, 52, 172, 500, 54, 84, 92, 58, 66, 500, 138, 134, 500, 64, 432, 392, 54, 52, 50, 398, 182, 246, 500, 500, 500, 174, 28, 64, 42, 160, 62, 446, 54, 500, 90, 56, 48, 110, 22, 310, 74, 90, 500, 270, 500, 100, 500, 168, 96, 190, 256, 68, 500, 70, 88, 22, 50, 100, 500, 500, 48, 62, 92, 166, 500, 134, 92, 302, 206, 500, 56, 186, 86, 180, 50, 348, 486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41060199148361265, "mean_inference_ms": 1.319559450624977, "mean_action_processing_ms": 0.15408200709187625, "mean_env_wait_ms": 0.09167722811519162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003692626953125, "StateBufferConnector_ms": 0.006998777389526367, "ViewRequirementAgentConnector_ms": 0.1171119213104248}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4583.506328546779, "num_env_steps_trained_throughput_per_sec": 4583.506328546779, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 4682.491, "sample_time_ms": 4062.524, "load_time_ms": 20.033, "load_throughput": 898520.569, "learn_time_ms": 553.765, "learn_throughput": 32504.755, "synch_weights_time_ms": 43.925}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4484, "training_iteration": 64, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-53", "timestamp": 1698250853, "time_this_iter_s": 3.9341204166412354, "time_total_s": 232.29065680503845, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.29065680503845, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 64.34, "ram_util_percent": 28.639999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.084202172485504e-20, "cur_lr": 0.0003, "total_loss": 6.526681741078694, "policy_loss": -0.0005654849112033844, "vf_loss": 6.5273043420579695, "vf_explained_var": -0.005441517300075955, "kl": 0.0016392522338189034, "entropy": 0.5708155704869164, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2903.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.738999999999844, "episode_len_mean": 248.28, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 31.1, 24.499999999999908, 43.30000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 47.9, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 33.500000000000036, -50.00000000000044, 36.70000000000003, 40.90000000000002, 19.899999999999842, 29.49999999999998, -50.00000000000044, 44.5, 31.500000000000007, 41.500000000000014, 32.100000000000016, 45.1, 15.299999999999777, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.300000000000026, 29.69999999999998, 41.100000000000016, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.5, 30.499999999999993, -50.00000000000044, 45.5, -50.00000000000044, 17.299999999999805, 41.90000000000001, 43.10000000000001, 39.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, 30.499999999999993, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.30000000000003, 46.9, 43.900000000000006, 42.900000000000006, -50.00000000000044, 43.900000000000006, 41.500000000000014, 42.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.7, 31.300000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, 45.7, 36.10000000000004, 43.10000000000001, 31.900000000000013, 45.5, 24.299999999999905, -50.00000000000044, 40.30000000000002, 26.69999999999994, 44.300000000000004], "episode_lengths": [96, 190, 256, 68, 500, 70, 88, 22, 50, 100, 500, 500, 48, 62, 92, 166, 500, 134, 92, 302, 206, 500, 56, 186, 86, 180, 50, 348, 486, 500, 500, 500, 56, 118, 204, 90, 134, 500, 500, 56, 196, 500, 46, 500, 328, 82, 70, 102, 106, 500, 500, 196, 42, 48, 500, 500, 60, 138, 32, 62, 72, 500, 62, 86, 80, 66, 500, 500, 500, 94, 64, 188, 500, 58, 500, 500, 500, 86, 500, 118, 500, 500, 500, 500, 500, 404, 500, 76, 500, 144, 44, 140, 70, 182, 46, 258, 500, 98, 234, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4105503845814851, "mean_inference_ms": 1.319300679325865, "mean_action_processing_ms": 0.15463831749310952, "mean_env_wait_ms": 0.09179096783628532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004241943359375, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.12156891822814941}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.738999999999844, "episode_len_mean": 248.28, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 31.1, 24.499999999999908, 43.30000000000001, -50.00000000000044, 43.10000000000001, 41.30000000000001, 47.9, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 33.500000000000036, -50.00000000000044, 36.70000000000003, 40.90000000000002, 19.899999999999842, 29.49999999999998, -50.00000000000044, 44.5, 31.500000000000007, 41.500000000000014, 32.100000000000016, 45.1, 15.299999999999777, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 38.300000000000026, 29.69999999999998, 41.100000000000016, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.5, 30.499999999999993, -50.00000000000044, 45.5, -50.00000000000044, 17.299999999999805, 41.90000000000001, 43.10000000000001, 39.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, 30.499999999999993, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, 36.30000000000003, 46.9, 43.900000000000006, 42.900000000000006, -50.00000000000044, 43.900000000000006, 41.500000000000014, 42.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 43.7, 31.300000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, 45.7, 36.10000000000004, 43.10000000000001, 31.900000000000013, 45.5, 24.299999999999905, -50.00000000000044, 40.30000000000002, 26.69999999999994, 44.300000000000004], "episode_lengths": [96, 190, 256, 68, 500, 70, 88, 22, 50, 100, 500, 500, 48, 62, 92, 166, 500, 134, 92, 302, 206, 500, 56, 186, 86, 180, 50, 348, 486, 500, 500, 500, 56, 118, 204, 90, 134, 500, 500, 56, 196, 500, 46, 500, 328, 82, 70, 102, 106, 500, 500, 196, 42, 48, 500, 500, 60, 138, 32, 62, 72, 500, 62, 86, 80, 66, 500, 500, 500, 94, 64, 188, 500, 58, 500, 500, 500, 86, 500, 118, 500, 500, 500, 500, 500, 404, 500, 76, 500, 144, 44, 140, 70, 182, 46, 258, 500, 98, 234, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4105503845814851, "mean_inference_ms": 1.319300679325865, "mean_action_processing_ms": 0.15463831749310952, "mean_env_wait_ms": 0.09179096783628532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004241943359375, "StateBufferConnector_ms": 0.007994651794433594, "ViewRequirementAgentConnector_ms": 0.12156891822814941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5010.510278825319, "num_env_steps_trained_throughput_per_sec": 5010.510278825319, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 4554.731, "sample_time_ms": 3987.206, "load_time_ms": 19.233, "load_throughput": 935880.402, "learn_time_ms": 532.002, "learn_throughput": 33834.435, "synch_weights_time_ms": 14.147}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4555, "training_iteration": 65, "trial_id": "9f288_00021", "date": "2023-10-25_17-20-56", "timestamp": 1698250856, "time_this_iter_s": 3.599536180496216, "time_total_s": 235.89019298553467, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.89019298553467, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.70000000000001, "ram_util_percent": 28.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.42101086242752e-21, "cur_lr": 0.0003, "total_loss": 6.682449679904514, "policy_loss": -0.0002144499785370297, "vf_loss": 6.6827216148376465, "vf_explained_var": -0.0034174905882941352, "kl": 0.0007945545080070183, "entropy": 0.574662454922994, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2948.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.073999999999836, "episode_len_mean": 249.94, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, 45.7, 36.10000000000004, 43.10000000000001, 31.900000000000013, 45.5, 24.299999999999905, -50.00000000000044, 40.30000000000002, 26.69999999999994, 44.300000000000004, 45.7, 40.70000000000002, 43.30000000000001, 45.7, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044, 41.90000000000001, 22.899999999999885, 44.7, -50.00000000000044, -50.00000000000044, 33.70000000000004, 23.8999999999999, -50.00000000000044, 7.699999999999669, 47.1, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, 45.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 43.7, 42.900000000000006, 19.69999999999984, -50.00000000000044, 8.899999999999686, 40.10000000000002, 9.099999999999689, 45.5, 41.90000000000001, 40.10000000000002, 21.699999999999868, -50.00000000000044, 12.69999999999974, 44.7, 43.30000000000001, -50.00000000000044, 43.7, 40.500000000000014, 40.500000000000014, 42.900000000000006, 40.10000000000002, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.30000000000001, 40.90000000000002, 30.29999999999999, -50.00000000000044, 41.30000000000001, 41.70000000000002, 31.300000000000004, 42.70000000000001, 37.50000000000003, 45.5, 41.500000000000014, 26.89999999999994, 16.09999999999979, -50.00000000000044], "episode_lengths": [500, 58, 500, 500, 500, 86, 500, 118, 500, 500, 500, 500, 500, 404, 500, 76, 500, 144, 44, 140, 70, 182, 46, 258, 500, 98, 234, 58, 44, 94, 68, 44, 54, 66, 500, 500, 56, 42, 500, 82, 272, 54, 500, 500, 164, 262, 500, 424, 30, 500, 62, 42, 500, 48, 112, 500, 500, 34, 94, 64, 72, 304, 500, 412, 100, 410, 46, 82, 100, 284, 500, 374, 54, 68, 500, 64, 96, 96, 72, 100, 500, 278, 500, 500, 500, 122, 78, 92, 198, 500, 88, 84, 188, 74, 126, 46, 86, 232, 340, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41139297751450227, "mean_inference_ms": 1.3217045440661, "mean_action_processing_ms": 0.15434971302752148, "mean_env_wait_ms": 0.0917509104119312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03739047050476074, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.13950824737548828}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.073999999999836, "episode_len_mean": 249.94, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.70000000000003, 45.7, 36.10000000000004, 43.10000000000001, 31.900000000000013, 45.5, 24.299999999999905, -50.00000000000044, 40.30000000000002, 26.69999999999994, 44.300000000000004, 45.7, 40.70000000000002, 43.30000000000001, 45.7, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044, 41.90000000000001, 22.899999999999885, 44.7, -50.00000000000044, -50.00000000000044, 33.70000000000004, 23.8999999999999, -50.00000000000044, 7.699999999999669, 47.1, -50.00000000000044, 43.900000000000006, 45.9, -50.00000000000044, 45.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 43.7, 42.900000000000006, 19.69999999999984, -50.00000000000044, 8.899999999999686, 40.10000000000002, 9.099999999999689, 45.5, 41.90000000000001, 40.10000000000002, 21.699999999999868, -50.00000000000044, 12.69999999999974, 44.7, 43.30000000000001, -50.00000000000044, 43.7, 40.500000000000014, 40.500000000000014, 42.900000000000006, 40.10000000000002, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.30000000000001, 40.90000000000002, 30.29999999999999, -50.00000000000044, 41.30000000000001, 41.70000000000002, 31.300000000000004, 42.70000000000001, 37.50000000000003, 45.5, 41.500000000000014, 26.89999999999994, 16.09999999999979, -50.00000000000044], "episode_lengths": [500, 58, 500, 500, 500, 86, 500, 118, 500, 500, 500, 500, 500, 404, 500, 76, 500, 144, 44, 140, 70, 182, 46, 258, 500, 98, 234, 58, 44, 94, 68, 44, 54, 66, 500, 500, 56, 42, 500, 82, 272, 54, 500, 500, 164, 262, 500, 424, 30, 500, 62, 42, 500, 48, 112, 500, 500, 34, 94, 64, 72, 304, 500, 412, 100, 410, 46, 82, 100, 284, 500, 374, 54, 68, 500, 64, 96, 96, 72, 100, 500, 278, 500, 500, 500, 122, 78, 92, 198, 500, 88, 84, 188, 74, 126, 46, 86, 232, 340, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41139297751450227, "mean_inference_ms": 1.3217045440661, "mean_action_processing_ms": 0.15434971302752148, "mean_env_wait_ms": 0.0917509104119312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03739047050476074, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.13950824737548828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4555.066260031436, "num_env_steps_trained_throughput_per_sec": 4555.066260031436, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 4384.426, "sample_time_ms": 3814.612, "load_time_ms": 19.642, "load_throughput": 916387.153, "learn_time_ms": 534.883, "learn_throughput": 33652.221, "synch_weights_time_ms": 13.347}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4627, "training_iteration": 66, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-00", "timestamp": 1698250860, "time_this_iter_s": 3.9586434364318848, "time_total_s": 239.84883642196655, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.84883642196655, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 73.76000000000002, "ram_util_percent": 28.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.71050543121376e-21, "cur_lr": 0.0003, "total_loss": 6.677313656277127, "policy_loss": -0.00040688167015711464, "vf_loss": 6.677777067820231, "vf_explained_var": -0.00760240289900038, "kl": 0.001130543778807199, "entropy": 0.5654248058795929, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 2993.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.850999999999828, "episode_len_mean": 267.14, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 41.90000000000001, 40.10000000000002, 21.699999999999868, -50.00000000000044, 12.69999999999974, 44.7, 43.30000000000001, -50.00000000000044, 43.7, 40.500000000000014, 40.500000000000014, 42.900000000000006, 40.10000000000002, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.30000000000001, 40.90000000000002, 30.29999999999999, -50.00000000000044, 41.30000000000001, 41.70000000000002, 31.300000000000004, 42.70000000000001, 37.50000000000003, 45.5, 41.500000000000014, 26.89999999999994, 16.09999999999979, -50.00000000000044, 27.099999999999945, 36.50000000000003, 35.900000000000034, 29.099999999999973, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.900000000000034, 32.30000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 39.300000000000026, 1.4999999999995808, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 20.49999999999985, 39.300000000000026, 47.3, 43.50000000000001, 29.299999999999976, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.10000000000001, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 26.499999999999936, 30.29999999999999, 43.7, 0.09999999999956088, -50.00000000000044, 42.10000000000001, -50.00000000000044, 18.499999999999822, 35.30000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1], "episode_lengths": [46, 82, 100, 284, 500, 374, 54, 68, 500, 64, 96, 96, 72, 100, 500, 278, 500, 500, 500, 122, 78, 92, 198, 500, 88, 84, 188, 74, 126, 46, 86, 232, 340, 500, 230, 136, 142, 210, 500, 40, 500, 500, 500, 70, 142, 178, 500, 96, 500, 94, 58, 500, 108, 486, 142, 500, 500, 500, 500, 500, 500, 134, 500, 500, 102, 296, 108, 28, 66, 208, 500, 36, 500, 500, 64, 82, 500, 426, 500, 70, 52, 52, 500, 500, 156, 236, 198, 64, 500, 500, 80, 500, 316, 148, 64, 500, 500, 500, 78, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41196504385707805, "mean_inference_ms": 1.3230243791923488, "mean_action_processing_ms": 0.15461215319082386, "mean_env_wait_ms": 0.09199834568124157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027242183685302734, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.14699792861938477}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.850999999999828, "episode_len_mean": 267.14, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 41.90000000000001, 40.10000000000002, 21.699999999999868, -50.00000000000044, 12.69999999999974, 44.7, 43.30000000000001, -50.00000000000044, 43.7, 40.500000000000014, 40.500000000000014, 42.900000000000006, 40.10000000000002, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 42.30000000000001, 40.90000000000002, 30.29999999999999, -50.00000000000044, 41.30000000000001, 41.70000000000002, 31.300000000000004, 42.70000000000001, 37.50000000000003, 45.5, 41.500000000000014, 26.89999999999994, 16.09999999999979, -50.00000000000044, 27.099999999999945, 36.50000000000003, 35.900000000000034, 29.099999999999973, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 35.900000000000034, 32.30000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.70000000000002, 44.300000000000004, -50.00000000000044, 39.300000000000026, 1.4999999999995808, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 39.90000000000002, 20.49999999999985, 39.300000000000026, 47.3, 43.50000000000001, 29.299999999999976, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.10000000000001, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 26.499999999999936, 30.29999999999999, 43.7, 0.09999999999956088, -50.00000000000044, 42.10000000000001, -50.00000000000044, 18.499999999999822, 35.30000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1], "episode_lengths": [46, 82, 100, 284, 500, 374, 54, 68, 500, 64, 96, 96, 72, 100, 500, 278, 500, 500, 500, 122, 78, 92, 198, 500, 88, 84, 188, 74, 126, 46, 86, 232, 340, 500, 230, 136, 142, 210, 500, 40, 500, 500, 500, 70, 142, 178, 500, 96, 500, 94, 58, 500, 108, 486, 142, 500, 500, 500, 500, 500, 500, 134, 500, 500, 102, 296, 108, 28, 66, 208, 500, 36, 500, 500, 64, 82, 500, 426, 500, 70, 52, 52, 500, 500, 156, 236, 198, 64, 500, 500, 80, 500, 316, 148, 64, 500, 500, 500, 78, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41196504385707805, "mean_inference_ms": 1.3230243791923488, "mean_action_processing_ms": 0.15461215319082386, "mean_env_wait_ms": 0.09199834568124157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027242183685302734, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.14699792861938477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4670.05466250055, "num_env_steps_trained_throughput_per_sec": 4670.05466250055, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 4192.165, "sample_time_ms": 3641.951, "load_time_ms": 18.035, "load_throughput": 998045.774, "learn_time_ms": 517.191, "learn_throughput": 34803.412, "synch_weights_time_ms": 12.946}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4693, "training_iteration": 67, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-04", "timestamp": 1698250864, "time_this_iter_s": 3.8663458824157715, "time_total_s": 243.71518230438232, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.71518230438232, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 65.71666666666667, "ram_util_percent": 28.566666666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.35525271560688e-21, "cur_lr": 0.0003, "total_loss": 6.945528337690566, "policy_loss": -0.00013685160213046605, "vf_loss": 6.945724879370795, "vf_explained_var": 0.008286727799309624, "kl": 0.0008834185843448318, "entropy": 0.5968022227287293, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3038.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.594999999999828, "episode_len_mean": 269.74, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.49999999999985, 39.300000000000026, 47.3, 43.50000000000001, 29.299999999999976, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.10000000000001, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 26.499999999999936, 30.29999999999999, 43.7, 0.09999999999956088, -50.00000000000044, 42.10000000000001, -50.00000000000044, 18.499999999999822, 35.30000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, 43.7, 19.299999999999834, 28.699999999999967, -50.00000000000044, 29.49999999999998, -50.00000000000044, 31.500000000000007, 41.30000000000001, 44.10000000000001, 40.10000000000002, 10.299999999999706, -50.00000000000044, 32.700000000000024, 39.50000000000002, -50.00000000000044, 36.900000000000034, 7.299999999999663, -50.00000000000044, 45.7, 39.70000000000002, 45.7, 42.500000000000014, 16.09999999999979, 21.09999999999986, 39.10000000000002, 31.500000000000007, 41.100000000000016, 44.300000000000004, 40.10000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 43.7, 30.499999999999993, -50.00000000000044, 6.299999999999649, 34.50000000000004, 29.49999999999998, 36.10000000000004, 15.099999999999774, 2.699999999999598, 6.299999999999649, 45.5, 19.899999999999842, -50.00000000000044, 37.300000000000026, 45.5, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714], "episode_lengths": [296, 108, 28, 66, 208, 500, 36, 500, 500, 64, 82, 500, 426, 500, 70, 52, 52, 500, 500, 156, 236, 198, 64, 500, 500, 80, 500, 316, 148, 64, 500, 500, 500, 78, 50, 500, 64, 308, 214, 500, 206, 500, 186, 88, 60, 100, 398, 500, 174, 106, 500, 132, 428, 500, 44, 104, 44, 76, 340, 290, 110, 186, 90, 58, 100, 74, 500, 68, 500, 500, 90, 500, 500, 132, 500, 64, 196, 500, 438, 156, 206, 140, 350, 474, 438, 46, 302, 500, 128, 46, 170, 500, 62, 500, 128, 90, 500, 500, 500, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4119816230546948, "mean_inference_ms": 1.3225744922352076, "mean_action_processing_ms": 0.15432199195708882, "mean_env_wait_ms": 0.09214406622071046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028879404067993164, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.12998270988464355}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.594999999999828, "episode_len_mean": 269.74, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.49999999999985, 39.300000000000026, 47.3, 43.50000000000001, 29.299999999999976, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.10000000000001, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, 26.499999999999936, 30.29999999999999, 43.7, 0.09999999999956088, -50.00000000000044, 42.10000000000001, -50.00000000000044, 18.499999999999822, 35.30000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, 43.7, 19.299999999999834, 28.699999999999967, -50.00000000000044, 29.49999999999998, -50.00000000000044, 31.500000000000007, 41.30000000000001, 44.10000000000001, 40.10000000000002, 10.299999999999706, -50.00000000000044, 32.700000000000024, 39.50000000000002, -50.00000000000044, 36.900000000000034, 7.299999999999663, -50.00000000000044, 45.7, 39.70000000000002, 45.7, 42.500000000000014, 16.09999999999979, 21.09999999999986, 39.10000000000002, 31.500000000000007, 41.100000000000016, 44.300000000000004, 40.10000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 43.7, 30.499999999999993, -50.00000000000044, 6.299999999999649, 34.50000000000004, 29.49999999999998, 36.10000000000004, 15.099999999999774, 2.699999999999598, 6.299999999999649, 45.5, 19.899999999999842, -50.00000000000044, 37.300000000000026, 45.5, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714], "episode_lengths": [296, 108, 28, 66, 208, 500, 36, 500, 500, 64, 82, 500, 426, 500, 70, 52, 52, 500, 500, 156, 236, 198, 64, 500, 500, 80, 500, 316, 148, 64, 500, 500, 500, 78, 50, 500, 64, 308, 214, 500, 206, 500, 186, 88, 60, 100, 398, 500, 174, 106, 500, 132, 428, 500, 44, 104, 44, 76, 340, 290, 110, 186, 90, 58, 100, 74, 500, 68, 500, 500, 90, 500, 500, 132, 500, 64, 196, 500, 438, 156, 206, 140, 350, 474, 438, 46, 302, 500, 128, 46, 170, 500, 62, 500, 128, 90, 500, 500, 500, 392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4119816230546948, "mean_inference_ms": 1.3225744922352076, "mean_action_processing_ms": 0.15432199195708882, "mean_env_wait_ms": 0.09214406622071046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028879404067993164, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.12998270988464355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4895.337550337751, "num_env_steps_trained_throughput_per_sec": 4895.337550337751, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 4070.467, "sample_time_ms": 3519.059, "load_time_ms": 19.153, "load_throughput": 939811.135, "learn_time_ms": 518.378, "learn_throughput": 34723.679, "synch_weights_time_ms": 11.875}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4758, "training_iteration": 68, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-08", "timestamp": 1698250868, "time_this_iter_s": 3.6829657554626465, "time_total_s": 247.39814805984497, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.39814805984497, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 64.97999999999999, "ram_util_percent": 28.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.7762635780344e-22, "cur_lr": 0.0003, "total_loss": 6.882710435655382, "policy_loss": -0.0006119281363983949, "vf_loss": 6.883380762736002, "vf_explained_var": -0.0023489740159776474, "kl": 0.0013895456279695078, "entropy": 0.5839329573843214, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3083.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.952999999999813, "episode_len_mean": 286.1, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 43.7, 30.499999999999993, -50.00000000000044, 6.299999999999649, 34.50000000000004, 29.49999999999998, 36.10000000000004, 15.099999999999774, 2.699999999999598, 6.299999999999649, 45.5, 19.899999999999842, -50.00000000000044, 37.300000000000026, 45.5, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.5, 6.099999999999646, -50.00000000000044, -50.00000000000044, 32.90000000000003, 45.1, 44.900000000000006, 36.10000000000004, 35.10000000000004, 39.90000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.70000000000002, 23.499999999999893, 41.70000000000002, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 10.099999999999703, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.70000000000001, 32.100000000000016, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, 40.30000000000002, 38.90000000000002, 42.10000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 30.9, 33.10000000000003, 37.90000000000003, 43.50000000000001, 34.10000000000004, 37.50000000000003, 39.300000000000026, -50.00000000000044, 1.4999999999995808, 44.300000000000004, 41.100000000000016], "episode_lengths": [500, 500, 90, 500, 500, 132, 500, 64, 196, 500, 438, 156, 206, 140, 350, 474, 438, 46, 302, 500, 128, 46, 170, 500, 62, 500, 128, 90, 500, 500, 500, 392, 500, 500, 56, 440, 500, 500, 172, 50, 52, 140, 150, 102, 100, 500, 500, 500, 54, 94, 266, 84, 500, 236, 500, 500, 84, 500, 400, 220, 500, 60, 500, 500, 62, 74, 180, 500, 44, 500, 80, 98, 112, 80, 500, 310, 500, 500, 90, 178, 500, 500, 166, 84, 500, 84, 500, 500, 82, 192, 170, 122, 66, 160, 126, 108, 500, 486, 58, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122135917204959, "mean_inference_ms": 1.3236117620015693, "mean_action_processing_ms": 0.15426428021537186, "mean_env_wait_ms": 0.09204228936634566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03307533264160156, "StateBufferConnector_ms": 0.005991935729980469, "ViewRequirementAgentConnector_ms": 0.13505291938781738}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.952999999999813, "episode_len_mean": 286.1, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 43.7, 30.499999999999993, -50.00000000000044, 6.299999999999649, 34.50000000000004, 29.49999999999998, 36.10000000000004, 15.099999999999774, 2.699999999999598, 6.299999999999649, 45.5, 19.899999999999842, -50.00000000000044, 37.300000000000026, 45.5, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.300000000000026, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 44.5, 6.099999999999646, -50.00000000000044, -50.00000000000044, 32.90000000000003, 45.1, 44.900000000000006, 36.10000000000004, 35.10000000000004, 39.90000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.70000000000002, 23.499999999999893, 41.70000000000002, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 10.099999999999703, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.70000000000001, 32.100000000000016, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, 40.30000000000002, 38.90000000000002, 42.10000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 30.9, 33.10000000000003, 37.90000000000003, 43.50000000000001, 34.10000000000004, 37.50000000000003, 39.300000000000026, -50.00000000000044, 1.4999999999995808, 44.300000000000004, 41.100000000000016], "episode_lengths": [500, 500, 90, 500, 500, 132, 500, 64, 196, 500, 438, 156, 206, 140, 350, 474, 438, 46, 302, 500, 128, 46, 170, 500, 62, 500, 128, 90, 500, 500, 500, 392, 500, 500, 56, 440, 500, 500, 172, 50, 52, 140, 150, 102, 100, 500, 500, 500, 54, 94, 266, 84, 500, 236, 500, 500, 84, 500, 400, 220, 500, 60, 500, 500, 62, 74, 180, 500, 44, 500, 80, 98, 112, 80, 500, 310, 500, 500, 90, 178, 500, 500, 166, 84, 500, 84, 500, 500, 82, 192, 170, 122, 66, 160, 126, 108, 500, 486, 58, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4122135917204959, "mean_inference_ms": 1.3236117620015693, "mean_action_processing_ms": 0.15426428021537186, "mean_env_wait_ms": 0.09204228936634566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03307533264160156, "StateBufferConnector_ms": 0.005991935729980469, "ViewRequirementAgentConnector_ms": 0.13505291938781738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4769.014793410732, "num_env_steps_trained_throughput_per_sec": 4769.014793410732, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3985.572, "sample_time_ms": 3432.856, "load_time_ms": 19.106, "load_throughput": 942126.207, "learn_time_ms": 520.056, "learn_throughput": 34611.636, "synch_weights_time_ms": 11.553}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4826, "training_iteration": 69, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-12", "timestamp": 1698250872, "time_this_iter_s": 3.7813644409179688, "time_total_s": 251.17951250076294, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.17951250076294, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 67.0, "ram_util_percent": 28.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172e-22, "cur_lr": 0.0003, "total_loss": 6.875911903381348, "policy_loss": -0.00011634950836499532, "vf_loss": 6.8760867754618324, "vf_explained_var": -0.004695464505089654, "kl": 0.0006752036573920527, "entropy": 0.5848169816864861, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3128.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.363999999999852, "episode_len_mean": 247.06, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, 42.10000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 30.9, 33.10000000000003, 37.90000000000003, 43.50000000000001, 34.10000000000004, 37.50000000000003, 39.300000000000026, -50.00000000000044, 1.4999999999995808, 44.300000000000004, 41.100000000000016, 27.699999999999953, 40.10000000000002, 39.10000000000002, 21.299999999999862, 43.900000000000006, 34.900000000000034, 39.300000000000026, 41.100000000000016, 43.900000000000006, 15.299999999999777, 44.900000000000006, -50.00000000000044, 39.10000000000002, -50.00000000000044, 36.70000000000003, 21.499999999999865, -50.00000000000044, 33.30000000000003, 44.5, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 19.899999999999842, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, 42.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 25.099999999999916, 28.499999999999964, 34.70000000000004, 44.300000000000004, 39.300000000000026, 26.69999999999994, 44.300000000000004, 41.90000000000001, 44.7, -50.00000000000044, 45.7, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 29.899999999999984, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 20.299999999999848, 45.5, -50.00000000000044, 40.90000000000002, 18.499999999999822, 37.90000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 23.8999999999999, -50.00000000000044, 22.899999999999885, 41.100000000000016, 47.1], "episode_lengths": [112, 80, 500, 310, 500, 500, 90, 178, 500, 500, 166, 84, 500, 84, 500, 500, 82, 192, 170, 122, 66, 160, 126, 108, 500, 486, 58, 90, 224, 100, 110, 288, 62, 152, 108, 90, 62, 348, 52, 500, 110, 500, 134, 286, 500, 168, 56, 500, 48, 40, 500, 500, 26, 500, 500, 302, 138, 500, 500, 62, 100, 72, 28, 500, 500, 250, 216, 154, 58, 108, 234, 58, 82, 54, 500, 44, 164, 500, 44, 500, 30, 202, 56, 500, 54, 500, 298, 46, 500, 92, 316, 122, 500, 440, 500, 262, 500, 272, 90, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41266505756065863, "mean_inference_ms": 1.324254171222568, "mean_action_processing_ms": 0.15415851913441483, "mean_env_wait_ms": 0.09207085200828011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034104108810424805, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.1386864185333252}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.363999999999852, "episode_len_mean": 247.06, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, 42.10000000000001, -50.00000000000044, 19.09999999999983, -50.00000000000044, -50.00000000000044, 41.100000000000016, 32.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 30.9, 33.10000000000003, 37.90000000000003, 43.50000000000001, 34.10000000000004, 37.50000000000003, 39.300000000000026, -50.00000000000044, 1.4999999999995808, 44.300000000000004, 41.100000000000016, 27.699999999999953, 40.10000000000002, 39.10000000000002, 21.299999999999862, 43.900000000000006, 34.900000000000034, 39.300000000000026, 41.100000000000016, 43.900000000000006, 15.299999999999777, 44.900000000000006, -50.00000000000044, 39.10000000000002, -50.00000000000044, 36.70000000000003, 21.499999999999865, -50.00000000000044, 33.30000000000003, 44.5, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 19.899999999999842, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, 42.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 25.099999999999916, 28.499999999999964, 34.70000000000004, 44.300000000000004, 39.300000000000026, 26.69999999999994, 44.300000000000004, 41.90000000000001, 44.7, -50.00000000000044, 45.7, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 29.899999999999984, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 20.299999999999848, 45.5, -50.00000000000044, 40.90000000000002, 18.499999999999822, 37.90000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 23.8999999999999, -50.00000000000044, 22.899999999999885, 41.100000000000016, 47.1], "episode_lengths": [112, 80, 500, 310, 500, 500, 90, 178, 500, 500, 166, 84, 500, 84, 500, 500, 82, 192, 170, 122, 66, 160, 126, 108, 500, 486, 58, 90, 224, 100, 110, 288, 62, 152, 108, 90, 62, 348, 52, 500, 110, 500, 134, 286, 500, 168, 56, 500, 48, 40, 500, 500, 26, 500, 500, 302, 138, 500, 500, 62, 100, 72, 28, 500, 500, 250, 216, 154, 58, 108, 234, 58, 82, 54, 500, 44, 164, 500, 44, 500, 30, 202, 56, 500, 54, 500, 298, 46, 500, 92, 316, 122, 500, 440, 500, 262, 500, 272, 90, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41266505756065863, "mean_inference_ms": 1.324254171222568, "mean_action_processing_ms": 0.15415851913441483, "mean_env_wait_ms": 0.09207085200828011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034104108810424805, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.1386864185333252}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4683.87511762814, "num_env_steps_trained_throughput_per_sec": 4683.87511762814, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3917.697, "sample_time_ms": 3372.315, "load_time_ms": 19.62, "load_throughput": 917417.196, "learn_time_ms": 512.092, "learn_throughput": 35149.91, "synch_weights_time_ms": 11.469}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4898, "training_iteration": 70, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-15", "timestamp": 1698250875, "time_this_iter_s": 3.8487515449523926, "time_total_s": 255.02826404571533, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.02826404571533, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 69.94, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086e-22, "cur_lr": 0.0003, "total_loss": 6.685312875111898, "policy_loss": -0.000502598782380422, "vf_loss": 6.685874652862549, "vf_explained_var": 0.00015595356623331706, "kl": 0.0015544847538320836, "entropy": 0.5915280222892761, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3173.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.331999999999862, "episode_len_mean": 237.4, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 29.899999999999984, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 20.299999999999848, 45.5, -50.00000000000044, 40.90000000000002, 18.499999999999822, 37.90000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 23.8999999999999, -50.00000000000044, 22.899999999999885, 41.100000000000016, 47.1, -50.00000000000044, 32.50000000000002, 44.300000000000004, 22.49999999999988, 37.90000000000003, 44.5, 11.099999999999717, 30.699999999999996, 45.1, -50.00000000000044, 41.100000000000016, 39.300000000000026, -50.00000000000044, 28.699999999999967, 39.10000000000002, -50.00000000000044, 42.10000000000001, 39.300000000000026, -50.00000000000044, 31.300000000000004, 46.9, 20.699999999999854, -50.00000000000044, 43.900000000000006, 33.30000000000003, 40.70000000000002, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.5, 45.7, 12.69999999999974, -50.00000000000044, 39.70000000000002, 19.499999999999837, 42.500000000000014, 40.90000000000002, 26.69999999999994, 46.5, 39.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.30000000000003, 36.30000000000003, 43.10000000000001, 42.500000000000014, 40.30000000000002, 39.300000000000026, 37.50000000000003, 27.899999999999956, -50.00000000000044, 46.3, 44.900000000000006, 29.099999999999973, 42.30000000000001, 33.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 39.90000000000002, 35.900000000000034, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 164, 500, 44, 500, 30, 202, 56, 500, 54, 500, 298, 46, 500, 92, 316, 122, 500, 440, 500, 262, 500, 272, 90, 30, 500, 176, 58, 276, 122, 56, 390, 194, 50, 500, 90, 108, 500, 214, 110, 500, 80, 108, 500, 188, 32, 294, 500, 62, 168, 94, 320, 500, 500, 500, 150, 46, 44, 374, 500, 104, 306, 76, 92, 234, 36, 110, 100, 500, 174, 500, 138, 138, 70, 76, 98, 108, 126, 222, 500, 38, 52, 210, 78, 166, 74, 66, 500, 42, 500, 102, 142, 94, 60, 500, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41289512006555795, "mean_inference_ms": 1.3244364332447174, "mean_action_processing_ms": 0.15444930227438916, "mean_env_wait_ms": 0.0922812003575646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02512502670288086, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.14716839790344238}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.331999999999862, "episode_len_mean": 237.4, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 29.899999999999984, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 20.299999999999848, 45.5, -50.00000000000044, 40.90000000000002, 18.499999999999822, 37.90000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 23.8999999999999, -50.00000000000044, 22.899999999999885, 41.100000000000016, 47.1, -50.00000000000044, 32.50000000000002, 44.300000000000004, 22.49999999999988, 37.90000000000003, 44.5, 11.099999999999717, 30.699999999999996, 45.1, -50.00000000000044, 41.100000000000016, 39.300000000000026, -50.00000000000044, 28.699999999999967, 39.10000000000002, -50.00000000000044, 42.10000000000001, 39.300000000000026, -50.00000000000044, 31.300000000000004, 46.9, 20.699999999999854, -50.00000000000044, 43.900000000000006, 33.30000000000003, 40.70000000000002, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.5, 45.7, 12.69999999999974, -50.00000000000044, 39.70000000000002, 19.499999999999837, 42.500000000000014, 40.90000000000002, 26.69999999999994, 46.5, 39.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.30000000000003, 36.30000000000003, 43.10000000000001, 42.500000000000014, 40.30000000000002, 39.300000000000026, 37.50000000000003, 27.899999999999956, -50.00000000000044, 46.3, 44.900000000000006, 29.099999999999973, 42.30000000000001, 33.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 39.90000000000002, 35.900000000000034, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 164, 500, 44, 500, 30, 202, 56, 500, 54, 500, 298, 46, 500, 92, 316, 122, 500, 440, 500, 262, 500, 272, 90, 30, 500, 176, 58, 276, 122, 56, 390, 194, 50, 500, 90, 108, 500, 214, 110, 500, 80, 108, 500, 188, 32, 294, 500, 62, 168, 94, 320, 500, 500, 500, 150, 46, 44, 374, 500, 104, 306, 76, 92, 234, 36, 110, 100, 500, 174, 500, 138, 138, 70, 76, 98, 108, 126, 222, 500, 38, 52, 210, 78, 166, 74, 66, 500, 42, 500, 102, 142, 94, 60, 500, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41289512006555795, "mean_inference_ms": 1.3244364332447174, "mean_action_processing_ms": 0.15444930227438916, "mean_env_wait_ms": 0.0922812003575646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02512502670288086, "StateBufferConnector_ms": 0.0050013065338134766, "ViewRequirementAgentConnector_ms": 0.14716839790344238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4876.234568299927, "num_env_steps_trained_throughput_per_sec": 4876.234568299927, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3848.165, "sample_time_ms": 3307.034, "load_time_ms": 20.899, "load_throughput": 861279.916, "learn_time_ms": 507.159, "learn_throughput": 35491.817, "synch_weights_time_ms": 10.972}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4972, "training_iteration": 71, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-19", "timestamp": 1698250879, "time_this_iter_s": 3.698370933532715, "time_total_s": 258.72663497924805, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.72663497924805, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 62.83333333333334, "ram_util_percent": 28.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543e-23, "cur_lr": 0.0003, "total_loss": 6.397749402787951, "policy_loss": -0.0005300429546170765, "vf_loss": 6.398334481981066, "vf_explained_var": -0.0017155620786878797, "kl": 0.0012510668138550802, "entropy": 0.5495225952731239, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3218.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.313999999999834, "episode_len_mean": 257.5, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 39.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.30000000000003, 36.30000000000003, 43.10000000000001, 42.500000000000014, 40.30000000000002, 39.300000000000026, 37.50000000000003, 27.899999999999956, -50.00000000000044, 46.3, 44.900000000000006, 29.099999999999973, 42.30000000000001, 33.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 39.90000000000002, 35.900000000000034, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.299999999999976, -50.00000000000044, 10.899999999999714, 37.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.899999999999885, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 32.700000000000024, 43.10000000000001, 44.7, 32.90000000000003, 41.90000000000001, 43.7, 44.5, -50.00000000000044, 44.5, 40.10000000000002, 40.30000000000002, 24.899999999999913, 16.699999999999797, 39.90000000000002, 39.70000000000002, 38.300000000000026, 45.9, 26.499999999999936, 3.899999999999615, 46.699999999999996, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [36, 110, 100, 500, 174, 500, 138, 138, 70, 76, 98, 108, 126, 222, 500, 38, 52, 210, 78, 166, 74, 66, 500, 42, 500, 102, 142, 94, 60, 500, 500, 42, 500, 500, 500, 500, 36, 158, 500, 500, 64, 500, 208, 500, 392, 126, 500, 64, 500, 500, 500, 500, 210, 272, 500, 82, 500, 500, 174, 60, 500, 86, 500, 500, 500, 166, 500, 90, 500, 500, 66, 174, 70, 54, 172, 82, 64, 56, 500, 56, 100, 98, 252, 334, 102, 104, 118, 42, 236, 462, 34, 62, 500, 66, 500, 96, 100, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4135892552641304, "mean_inference_ms": 1.3264961879959813, "mean_action_processing_ms": 0.1547667219451861, "mean_env_wait_ms": 0.09260102850742591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200697898864746, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.13236308097839355}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.313999999999834, "episode_len_mean": 257.5, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 39.10000000000002, 40.10000000000002, -50.00000000000044, 32.700000000000024, -50.00000000000044, 36.30000000000003, 36.30000000000003, 43.10000000000001, 42.500000000000014, 40.30000000000002, 39.300000000000026, 37.50000000000003, 27.899999999999956, -50.00000000000044, 46.3, 44.900000000000006, 29.099999999999973, 42.30000000000001, 33.500000000000036, 42.70000000000001, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 39.90000000000002, 35.900000000000034, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 29.299999999999976, -50.00000000000044, 10.899999999999714, 37.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.899999999999885, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 32.700000000000024, 43.10000000000001, 44.7, 32.90000000000003, 41.90000000000001, 43.7, 44.5, -50.00000000000044, 44.5, 40.10000000000002, 40.30000000000002, 24.899999999999913, 16.699999999999797, 39.90000000000002, 39.70000000000002, 38.300000000000026, 45.9, 26.499999999999936, 3.899999999999615, 46.699999999999996, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [36, 110, 100, 500, 174, 500, 138, 138, 70, 76, 98, 108, 126, 222, 500, 38, 52, 210, 78, 166, 74, 66, 500, 42, 500, 102, 142, 94, 60, 500, 500, 42, 500, 500, 500, 500, 36, 158, 500, 500, 64, 500, 208, 500, 392, 126, 500, 64, 500, 500, 500, 500, 210, 272, 500, 82, 500, 500, 174, 60, 500, 86, 500, 500, 500, 166, 500, 90, 500, 500, 66, 174, 70, 54, 172, 82, 64, 56, 500, 56, 100, 98, 252, 334, 102, 104, 118, 42, 236, 462, 34, 62, 500, 66, 500, 96, 100, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4135892552641304, "mean_inference_ms": 1.3264961879959813, "mean_action_processing_ms": 0.1547667219451861, "mean_env_wait_ms": 0.09260102850742591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200697898864746, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.13236308097839355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4939.456073745474, "num_env_steps_trained_throughput_per_sec": 4939.456073745474, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3801.09, "sample_time_ms": 3286.41, "load_time_ms": 20.397, "load_throughput": 882466.407, "learn_time_ms": 481.462, "learn_throughput": 37386.1, "synch_weights_time_ms": 10.62}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 5038, "training_iteration": 72, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-23", "timestamp": 1698250883, "time_this_iter_s": 3.6499500274658203, "time_total_s": 262.37658500671387, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.37658500671387, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 71.96000000000001, "ram_util_percent": 28.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715e-23, "cur_lr": 0.0003, "total_loss": 6.531564087337918, "policy_loss": -0.0005799850086785025, "vf_loss": 6.53220076031155, "vf_explained_var": -0.00698343382941352, "kl": 0.0013717163340645458, "entropy": 0.5668020460340711, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3263.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.33099999999984, "episode_len_mean": 252.36, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 32.700000000000024, 43.10000000000001, 44.7, 32.90000000000003, 41.90000000000001, 43.7, 44.5, -50.00000000000044, 44.5, 40.10000000000002, 40.30000000000002, 24.899999999999913, 16.699999999999797, 39.90000000000002, 39.70000000000002, 38.300000000000026, 45.9, 26.499999999999936, 3.899999999999615, 46.699999999999996, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 31.900000000000013, 44.300000000000004, 34.900000000000034, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 25.099999999999916, 34.10000000000004, 37.90000000000003, 24.499999999999908, 46.099999999999994, 39.50000000000002, 42.500000000000014, -50.00000000000044, 10.699999999999712, 40.30000000000002, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 10.099999999999703, -50.00000000000044, 15.899999999999785, 46.5, 42.30000000000001, 27.699999999999953, 30.29999999999999, 45.5, 42.70000000000001, -50.00000000000044, 40.10000000000002, 46.9, -50.00000000000044, 12.69999999999974, 36.900000000000034, 43.10000000000001, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.30000000000003, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 38.50000000000003, 35.500000000000036, 38.90000000000002, -50.00000000000044, 32.90000000000003], "episode_lengths": [500, 90, 500, 500, 66, 174, 70, 54, 172, 82, 64, 56, 500, 56, 100, 98, 252, 334, 102, 104, 118, 42, 236, 462, 34, 62, 500, 66, 500, 96, 100, 500, 500, 500, 500, 500, 500, 500, 94, 182, 58, 152, 42, 500, 40, 500, 500, 86, 500, 50, 500, 500, 250, 160, 122, 256, 40, 106, 76, 500, 394, 98, 70, 500, 42, 500, 500, 272, 500, 400, 500, 342, 36, 78, 224, 198, 46, 74, 500, 100, 32, 500, 374, 132, 70, 500, 86, 76, 500, 500, 138, 58, 500, 46, 500, 116, 146, 112, 500, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41326122370168844, "mean_inference_ms": 1.325697842585558, "mean_action_processing_ms": 0.15512999606014402, "mean_env_wait_ms": 0.09257444436834529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800750732421875, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.13658356666564941}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.33099999999984, "episode_len_mean": 252.36, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 43.50000000000001, 32.700000000000024, 43.10000000000001, 44.7, 32.90000000000003, 41.90000000000001, 43.7, 44.5, -50.00000000000044, 44.5, 40.10000000000002, 40.30000000000002, 24.899999999999913, 16.699999999999797, 39.90000000000002, 39.70000000000002, 38.300000000000026, 45.9, 26.499999999999936, 3.899999999999615, 46.699999999999996, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 31.900000000000013, 44.300000000000004, 34.900000000000034, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 25.099999999999916, 34.10000000000004, 37.90000000000003, 24.499999999999908, 46.099999999999994, 39.50000000000002, 42.500000000000014, -50.00000000000044, 10.699999999999712, 40.30000000000002, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 10.099999999999703, -50.00000000000044, 15.899999999999785, 46.5, 42.30000000000001, 27.699999999999953, 30.29999999999999, 45.5, 42.70000000000001, -50.00000000000044, 40.10000000000002, 46.9, -50.00000000000044, 12.69999999999974, 36.900000000000034, 43.10000000000001, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.30000000000003, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 38.50000000000003, 35.500000000000036, 38.90000000000002, -50.00000000000044, 32.90000000000003], "episode_lengths": [500, 90, 500, 500, 66, 174, 70, 54, 172, 82, 64, 56, 500, 56, 100, 98, 252, 334, 102, 104, 118, 42, 236, 462, 34, 62, 500, 66, 500, 96, 100, 500, 500, 500, 500, 500, 500, 500, 94, 182, 58, 152, 42, 500, 40, 500, 500, 86, 500, 50, 500, 500, 250, 160, 122, 256, 40, 106, 76, 500, 394, 98, 70, 500, 42, 500, 500, 272, 500, 400, 500, 342, 36, 78, 224, 198, 46, 74, 500, 100, 32, 500, 374, 132, 70, 500, 86, 76, 500, 500, 138, 58, 500, 46, 500, 116, 146, 112, 500, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41326122370168844, "mean_inference_ms": 1.325697842585558, "mean_action_processing_ms": 0.15512999606014402, "mean_env_wait_ms": 0.09257444436834529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800750732421875, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.13658356666564941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5032.649792171268, "num_env_steps_trained_throughput_per_sec": 5032.649792171268, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3753.201, "sample_time_ms": 3244.198, "load_time_ms": 20.668, "load_throughput": 870926.374, "learn_time_ms": 475.6, "learn_throughput": 37846.896, "synch_weights_time_ms": 10.535}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5104, "training_iteration": 73, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-26", "timestamp": 1698250886, "time_this_iter_s": 3.5826427936553955, "time_total_s": 265.95922780036926, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.95922780036926, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 62.620000000000005, "ram_util_percent": 28.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.11758236813575e-23, "cur_lr": 0.0003, "total_loss": 7.284323247273763, "policy_loss": -0.0002698607535825835, "vf_loss": 7.284646076626248, "vf_explained_var": -0.003671476576063368, "kl": 0.0012133620194371513, "entropy": 0.5283986230691274, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.432999999999856, "episode_len_mean": 241.36, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 12.69999999999974, 36.900000000000034, 43.10000000000001, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.30000000000003, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 38.50000000000003, 35.500000000000036, 38.90000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 28.29999999999996, -50.00000000000044, 34.70000000000004, 43.7, 44.300000000000004, -50.00000000000044, 46.099999999999994, 30.9, 38.700000000000024, 42.10000000000001, 33.500000000000036, 46.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.7, 33.90000000000004, 45.1, 43.900000000000006, -50.00000000000044, 44.5, 47.9, 35.30000000000004, 34.50000000000004, 29.899999999999984, 30.699999999999996, 25.499999999999922, 46.3, 43.30000000000001, 47.1, -50.00000000000044, 46.3, 35.500000000000036, 33.90000000000004, -50.00000000000044, 45.1, -50.00000000000044, 37.90000000000003, -50.00000000000044, 32.50000000000002, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 38.300000000000026, 42.10000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 29.69999999999998, -50.00000000000044, 42.30000000000001, 39.70000000000002, 41.90000000000001, 42.10000000000001, -50.00000000000044, 43.30000000000001, 24.099999999999902, -50.00000000000044, -50.00000000000044, 19.69999999999984, 40.30000000000002, 44.5, 23.29999999999989, 37.300000000000026, -50.00000000000044, 29.49999999999998, -50.00000000000044, 14.299999999999763, 43.30000000000001], "episode_lengths": [32, 500, 374, 132, 70, 500, 86, 76, 500, 500, 138, 58, 500, 46, 500, 116, 146, 112, 500, 172, 500, 218, 500, 154, 64, 58, 500, 40, 192, 114, 80, 166, 36, 500, 126, 500, 96, 500, 54, 162, 50, 62, 500, 56, 22, 148, 156, 202, 194, 246, 38, 68, 30, 500, 38, 146, 162, 500, 50, 500, 122, 500, 176, 320, 500, 500, 44, 38, 118, 80, 200, 500, 500, 76, 64, 500, 500, 500, 250, 204, 500, 78, 104, 82, 80, 500, 68, 260, 500, 500, 304, 98, 56, 268, 128, 500, 206, 500, 358, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.413363082066026, "mean_inference_ms": 1.3264882258166568, "mean_action_processing_ms": 0.15510550341415902, "mean_env_wait_ms": 0.09258534438736442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018998384475708008, "StateBufferConnector_ms": 0.008012056350708008, "ViewRequirementAgentConnector_ms": 0.14899420738220215}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.432999999999856, "episode_len_mean": 241.36, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 12.69999999999974, 36.900000000000034, 43.10000000000001, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, -50.00000000000044, 36.30000000000003, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 38.50000000000003, 35.500000000000036, 38.90000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 28.29999999999996, -50.00000000000044, 34.70000000000004, 43.7, 44.300000000000004, -50.00000000000044, 46.099999999999994, 30.9, 38.700000000000024, 42.10000000000001, 33.500000000000036, 46.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.7, 33.90000000000004, 45.1, 43.900000000000006, -50.00000000000044, 44.5, 47.9, 35.30000000000004, 34.50000000000004, 29.899999999999984, 30.699999999999996, 25.499999999999922, 46.3, 43.30000000000001, 47.1, -50.00000000000044, 46.3, 35.500000000000036, 33.90000000000004, -50.00000000000044, 45.1, -50.00000000000044, 37.90000000000003, -50.00000000000044, 32.50000000000002, 18.099999999999817, -50.00000000000044, -50.00000000000044, 45.7, 46.3, 38.300000000000026, 42.10000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 29.69999999999998, -50.00000000000044, 42.30000000000001, 39.70000000000002, 41.90000000000001, 42.10000000000001, -50.00000000000044, 43.30000000000001, 24.099999999999902, -50.00000000000044, -50.00000000000044, 19.69999999999984, 40.30000000000002, 44.5, 23.29999999999989, 37.300000000000026, -50.00000000000044, 29.49999999999998, -50.00000000000044, 14.299999999999763, 43.30000000000001], "episode_lengths": [32, 500, 374, 132, 70, 500, 86, 76, 500, 500, 138, 58, 500, 46, 500, 116, 146, 112, 500, 172, 500, 218, 500, 154, 64, 58, 500, 40, 192, 114, 80, 166, 36, 500, 126, 500, 96, 500, 54, 162, 50, 62, 500, 56, 22, 148, 156, 202, 194, 246, 38, 68, 30, 500, 38, 146, 162, 500, 50, 500, 122, 500, 176, 320, 500, 500, 44, 38, 118, 80, 200, 500, 500, 76, 64, 500, 500, 500, 250, 204, 500, 78, 104, 82, 80, 500, 68, 260, 500, 500, 304, 98, 56, 268, 128, 500, 206, 500, 358, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.413363082066026, "mean_inference_ms": 1.3264882258166568, "mean_action_processing_ms": 0.15510550341415902, "mean_env_wait_ms": 0.09258534438736442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018998384475708008, "StateBufferConnector_ms": 0.008012056350708008, "ViewRequirementAgentConnector_ms": 0.14899420738220215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4913.0917846385055, "num_env_steps_trained_throughput_per_sec": 4913.0917846385055, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3726.857, "sample_time_ms": 3230.568, "load_time_ms": 19.521, "load_throughput": 922069.364, "learn_time_ms": 463.809, "learn_throughput": 38809.118, "synch_weights_time_ms": 10.557}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5184, "training_iteration": 74, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-30", "timestamp": 1698250890, "time_this_iter_s": 3.669517755508423, "time_total_s": 269.6287455558777, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.6287455558777, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 72.55999999999999, "ram_util_percent": 28.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.058791184067875e-23, "cur_lr": 0.0003, "total_loss": 6.740351274278429, "policy_loss": -3.1176540586683486e-06, "vf_loss": 6.740404510498047, "vf_explained_var": -0.007222698794470893, "kl": 0.00021423488753195366, "entropy": 0.5010569598939684, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3353.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.100999999999846, "episode_len_mean": 244.68, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 25.099999999999916, 29.69999999999998, -50.00000000000044, 42.30000000000001, 39.70000000000002, 41.90000000000001, 42.10000000000001, -50.00000000000044, 43.30000000000001, 24.099999999999902, -50.00000000000044, -50.00000000000044, 19.69999999999984, 40.30000000000002, 44.5, 23.29999999999989, 37.300000000000026, -50.00000000000044, 29.49999999999998, -50.00000000000044, 14.299999999999763, 43.30000000000001, -50.00000000000044, -50.00000000000044, 27.299999999999947, 39.70000000000002, 44.7, 33.500000000000036, 31.300000000000004, 25.899999999999928, -50.00000000000044, 42.70000000000001, 11.29999999999972, 45.1, 39.300000000000026, -50.00000000000044, 44.300000000000004, 29.299999999999976, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 34.70000000000004, 39.300000000000026, 44.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 44.5, 44.7, 45.3, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 45.1, 44.7, 44.900000000000006, 36.30000000000003, -50.00000000000044, 43.900000000000006, 38.90000000000002, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.70000000000002, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, 26.499999999999936, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.5, 36.30000000000003, 35.900000000000034, 41.70000000000002, 46.699999999999996, 22.699999999999882, 29.299999999999976, -50.00000000000044, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 1.4999999999995808, 40.500000000000014], "episode_lengths": [500, 500, 250, 204, 500, 78, 104, 82, 80, 500, 68, 260, 500, 500, 304, 98, 56, 268, 128, 500, 206, 500, 358, 68, 500, 500, 228, 104, 54, 166, 188, 242, 500, 74, 388, 50, 108, 500, 58, 208, 500, 58, 44, 500, 154, 108, 54, 72, 500, 500, 64, 56, 54, 48, 108, 500, 500, 48, 142, 42, 500, 500, 500, 48, 500, 82, 50, 54, 52, 138, 500, 62, 112, 96, 500, 58, 94, 500, 74, 76, 500, 236, 500, 470, 500, 36, 138, 142, 84, 34, 274, 208, 500, 118, 74, 500, 500, 44, 486, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4133037794873436, "mean_inference_ms": 1.3266015497739787, "mean_action_processing_ms": 0.15497777653145042, "mean_env_wait_ms": 0.09266556285449598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000572204589844, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11498880386352539}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.100999999999846, "episode_len_mean": 244.68, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 25.099999999999916, 29.69999999999998, -50.00000000000044, 42.30000000000001, 39.70000000000002, 41.90000000000001, 42.10000000000001, -50.00000000000044, 43.30000000000001, 24.099999999999902, -50.00000000000044, -50.00000000000044, 19.69999999999984, 40.30000000000002, 44.5, 23.29999999999989, 37.300000000000026, -50.00000000000044, 29.49999999999998, -50.00000000000044, 14.299999999999763, 43.30000000000001, -50.00000000000044, -50.00000000000044, 27.299999999999947, 39.70000000000002, 44.7, 33.500000000000036, 31.300000000000004, 25.899999999999928, -50.00000000000044, 42.70000000000001, 11.29999999999972, 45.1, 39.300000000000026, -50.00000000000044, 44.300000000000004, 29.299999999999976, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 34.70000000000004, 39.300000000000026, 44.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 44.5, 44.7, 45.3, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.3, 35.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 45.1, 44.7, 44.900000000000006, 36.30000000000003, -50.00000000000044, 43.900000000000006, 38.90000000000002, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.70000000000002, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, 26.499999999999936, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.5, 36.30000000000003, 35.900000000000034, 41.70000000000002, 46.699999999999996, 22.699999999999882, 29.299999999999976, -50.00000000000044, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 1.4999999999995808, 40.500000000000014], "episode_lengths": [500, 500, 250, 204, 500, 78, 104, 82, 80, 500, 68, 260, 500, 500, 304, 98, 56, 268, 128, 500, 206, 500, 358, 68, 500, 500, 228, 104, 54, 166, 188, 242, 500, 74, 388, 50, 108, 500, 58, 208, 500, 58, 44, 500, 154, 108, 54, 72, 500, 500, 64, 56, 54, 48, 108, 500, 500, 48, 142, 42, 500, 500, 500, 48, 500, 82, 50, 54, 52, 138, 500, 62, 112, 96, 500, 58, 94, 500, 74, 76, 500, 236, 500, 470, 500, 36, 138, 142, 84, 34, 274, 208, 500, 118, 74, 500, 500, 44, 486, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4133037794873436, "mean_inference_ms": 1.3266015497739787, "mean_action_processing_ms": 0.15497777653145042, "mean_env_wait_ms": 0.09266556285449598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000572204589844, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11498880386352539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5104.263101594734, "num_env_steps_trained_throughput_per_sec": 5104.263101594734, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3720.258, "sample_time_ms": 3220.6, "load_time_ms": 19.321, "load_throughput": 931620.148, "learn_time_ms": 467.956, "learn_throughput": 38465.183, "synch_weights_time_ms": 9.878}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5260, "training_iteration": 75, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-34", "timestamp": 1698250894, "time_this_iter_s": 3.5324370861053467, "time_total_s": 273.16118264198303, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.16118264198303, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 60.720000000000006, "ram_util_percent": 28.580000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339375e-24, "cur_lr": 0.0003, "total_loss": 6.301918464236789, "policy_loss": -0.00028803712791866724, "vf_loss": 6.302253161536322, "vf_explained_var": -0.0011222693655225965, "kl": 0.0007679450720388559, "entropy": 0.4668226255310906, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3398.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.39899999999981, "episode_len_mean": 271.6, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 45.1, 44.7, 44.900000000000006, 36.30000000000003, -50.00000000000044, 43.900000000000006, 38.90000000000002, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.70000000000002, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, 26.499999999999936, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.5, 36.30000000000003, 35.900000000000034, 41.70000000000002, 46.699999999999996, 22.699999999999882, 29.299999999999976, -50.00000000000044, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 1.4999999999995808, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 41.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 30.9, 44.900000000000006, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 35.500000000000036, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 46.699999999999996, 41.100000000000016, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.500000000000014, 35.70000000000003, -50.00000000000044, 44.5, 45.9, 46.3, 37.70000000000003, -50.00000000000044, 17.499999999999808, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 48, 500, 82, 50, 54, 52, 138, 500, 62, 112, 96, 500, 58, 94, 500, 74, 76, 500, 236, 500, 470, 500, 36, 138, 142, 84, 34, 274, 208, 500, 118, 74, 500, 500, 44, 486, 96, 500, 500, 44, 28, 88, 500, 64, 500, 192, 52, 500, 178, 500, 500, 272, 500, 68, 500, 500, 500, 48, 96, 500, 500, 158, 500, 256, 500, 500, 500, 134, 36, 146, 500, 76, 36, 500, 34, 90, 500, 84, 500, 500, 140, 500, 500, 32, 500, 76, 144, 500, 56, 42, 38, 124, 500, 326, 26, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41407961523778825, "mean_inference_ms": 1.3277673227588271, "mean_action_processing_ms": 0.15454936671615, "mean_env_wait_ms": 0.0925364856946476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12345170974731445}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.39899999999981, "episode_len_mean": 271.6, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 41.90000000000001, 45.1, 44.7, 44.900000000000006, 36.30000000000003, -50.00000000000044, 43.900000000000006, 38.90000000000002, 40.500000000000014, -50.00000000000044, 44.300000000000004, 40.70000000000002, -50.00000000000044, 42.70000000000001, 42.500000000000014, -50.00000000000044, 26.499999999999936, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.5, 36.30000000000003, 35.900000000000034, 41.70000000000002, 46.699999999999996, 22.699999999999882, 29.299999999999976, -50.00000000000044, 38.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.7, 1.4999999999995808, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 41.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 30.9, 44.900000000000006, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.5, 35.500000000000036, -50.00000000000044, 42.500000000000014, 46.5, -50.00000000000044, 46.699999999999996, 41.100000000000016, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.500000000000014, 35.70000000000003, -50.00000000000044, 44.5, 45.9, 46.3, 37.70000000000003, -50.00000000000044, 17.499999999999808, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 48, 500, 82, 50, 54, 52, 138, 500, 62, 112, 96, 500, 58, 94, 500, 74, 76, 500, 236, 500, 470, 500, 36, 138, 142, 84, 34, 274, 208, 500, 118, 74, 500, 500, 44, 486, 96, 500, 500, 44, 28, 88, 500, 64, 500, 192, 52, 500, 178, 500, 500, 272, 500, 68, 500, 500, 500, 48, 96, 500, 500, 158, 500, 256, 500, 500, 500, 134, 36, 146, 500, 76, 36, 500, 34, 90, 500, 84, 500, 500, 140, 500, 500, 32, 500, 76, 144, 500, 56, 42, 38, 124, 500, 326, 26, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41407961523778825, "mean_inference_ms": 1.3277673227588271, "mean_action_processing_ms": 0.15454936671615, "mean_env_wait_ms": 0.0925364856946476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12345170974731445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4713.760689902892, "num_env_steps_trained_throughput_per_sec": 4713.760689902892, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3706.855, "sample_time_ms": 3211.06, "load_time_ms": 18.865, "load_throughput": 954147.229, "learn_time_ms": 464.348, "learn_throughput": 38764.05, "synch_weights_time_ms": 9.978}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5322, "training_iteration": 76, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-38", "timestamp": 1698250898, "time_this_iter_s": 3.8256053924560547, "time_total_s": 276.9867880344391, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.9867880344391, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 67.14000000000001, "ram_util_percent": 28.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696876e-24, "cur_lr": 0.0003, "total_loss": 6.689919842614068, "policy_loss": -0.00028024340669314065, "vf_loss": 6.690249972873264, "vf_explained_var": -0.007379349072774251, "kl": 0.0009655375205486255, "entropy": 0.4984151807096269, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3443.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.323999999999827, "episode_len_mean": 247.38, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.500000000000014, 35.70000000000003, -50.00000000000044, 44.5, 45.9, 46.3, 37.70000000000003, -50.00000000000044, 17.499999999999808, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 43.7, 39.90000000000002, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 46.099999999999994, 41.70000000000002, 46.5, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 46.099999999999994, 46.099999999999994, 47.3, 29.49999999999998, -50.00000000000044, 30.499999999999993, 45.5, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.70000000000001, -50.00000000000044, 6.499999999999652, 45.1, 38.10000000000002, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.10000000000002, 45.3, 45.1, 42.500000000000014, 43.50000000000001, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 47.1, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 47.3, 19.69999999999984, 38.90000000000002, 47.5, 42.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 35.10000000000004], "episode_lengths": [84, 500, 500, 140, 500, 500, 32, 500, 76, 144, 500, 56, 42, 38, 124, 500, 326, 26, 500, 500, 40, 500, 50, 500, 34, 64, 102, 500, 52, 44, 500, 40, 84, 36, 500, 52, 80, 500, 152, 500, 60, 500, 500, 40, 212, 500, 40, 40, 28, 206, 500, 196, 46, 500, 500, 138, 500, 40, 500, 500, 206, 500, 74, 500, 436, 50, 120, 48, 52, 500, 500, 82, 500, 500, 68, 120, 48, 50, 76, 66, 500, 24, 52, 500, 500, 146, 30, 500, 38, 500, 122, 28, 304, 112, 26, 72, 500, 174, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.414166295401664, "mean_inference_ms": 1.3281311050860714, "mean_action_processing_ms": 0.1554751808898031, "mean_env_wait_ms": 0.09286077583747497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04500246047973633, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.14021992683410645}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.323999999999827, "episode_len_mean": 247.38, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 42.500000000000014, 35.70000000000003, -50.00000000000044, 44.5, 45.9, 46.3, 37.70000000000003, -50.00000000000044, 17.499999999999808, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 43.7, 39.90000000000002, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 46.099999999999994, 41.70000000000002, 46.5, -50.00000000000044, 44.900000000000006, 42.10000000000001, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 28.89999999999997, -50.00000000000044, 46.099999999999994, 46.099999999999994, 47.3, 29.49999999999998, -50.00000000000044, 30.499999999999993, 45.5, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 42.70000000000001, -50.00000000000044, 6.499999999999652, 45.1, 38.10000000000002, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.10000000000002, 45.3, 45.1, 42.500000000000014, 43.50000000000001, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 47.1, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 47.3, 19.69999999999984, 38.90000000000002, 47.5, 42.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 35.10000000000004], "episode_lengths": [84, 500, 500, 140, 500, 500, 32, 500, 76, 144, 500, 56, 42, 38, 124, 500, 326, 26, 500, 500, 40, 500, 50, 500, 34, 64, 102, 500, 52, 44, 500, 40, 84, 36, 500, 52, 80, 500, 152, 500, 60, 500, 500, 40, 212, 500, 40, 40, 28, 206, 500, 196, 46, 500, 500, 138, 500, 40, 500, 500, 206, 500, 74, 500, 436, 50, 120, 48, 52, 500, 500, 82, 500, 500, 68, 120, 48, 50, 76, 66, 500, 24, 52, 500, 500, 146, 30, 500, 38, 500, 122, 28, 304, 112, 26, 72, 500, 174, 500, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.414166295401664, "mean_inference_ms": 1.3281311050860714, "mean_action_processing_ms": 0.1554751808898031, "mean_env_wait_ms": 0.09286077583747497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04500246047973633, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.14021992683410645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4757.864603906798, "num_env_steps_trained_throughput_per_sec": 4757.864603906798, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3699.741, "sample_time_ms": 3196.054, "load_time_ms": 18.913, "load_throughput": 951715.187, "learn_time_ms": 472.191, "learn_throughput": 38120.189, "synch_weights_time_ms": 9.978}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5400, "training_iteration": 77, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-41", "timestamp": 1698250901, "time_this_iter_s": 3.789205312728882, "time_total_s": 280.77599334716797, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 280.77599334716797, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 59.86666666666667, "ram_util_percent": 28.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848438e-24, "cur_lr": 0.0003, "total_loss": 6.160860337151421, "policy_loss": -0.00029727410939004687, "vf_loss": 6.161206234825982, "vf_explained_var": -0.00401837428410848, "kl": 0.0008191122168581286, "entropy": 0.4870240681701236, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3488.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.716999999999822, "episode_len_mean": 258.44, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, 6.499999999999652, 45.1, 38.10000000000002, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.10000000000002, 45.3, 45.1, 42.500000000000014, 43.50000000000001, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 47.1, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 47.3, 19.69999999999984, 38.90000000000002, 47.5, 42.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 14.699999999999768, 46.699999999999996, -50.00000000000044, 28.499999999999964, -50.00000000000044, 42.10000000000001, 45.9, 37.70000000000003, 47.1, 45.5, 19.09999999999983, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.900000000000006, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.7, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.300000000000004, 43.30000000000001, 45.7, 24.299999999999905, -50.00000000000044, -50.00000000000044, 26.09999999999993, 47.3, -50.00000000000044, 31.900000000000013, 47.1, 35.70000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 29.099999999999973, 45.7, -50.00000000000044, 45.9, 38.90000000000002], "episode_lengths": [500, 74, 500, 436, 50, 120, 48, 52, 500, 500, 82, 500, 500, 68, 120, 48, 50, 76, 66, 500, 24, 52, 500, 500, 146, 30, 500, 38, 500, 122, 28, 304, 112, 26, 72, 500, 174, 500, 150, 500, 500, 500, 500, 500, 500, 38, 500, 500, 80, 354, 34, 500, 216, 500, 80, 42, 124, 30, 46, 310, 500, 500, 106, 72, 108, 500, 76, 500, 54, 36, 500, 88, 500, 66, 500, 72, 500, 500, 150, 58, 68, 44, 258, 500, 500, 240, 28, 500, 182, 30, 144, 500, 134, 500, 500, 210, 44, 500, 42, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149064264581455, "mean_inference_ms": 1.3297808373898514, "mean_action_processing_ms": 0.15546052471419125, "mean_env_wait_ms": 0.0930468687637592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036986589431762695, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.15408587455749512}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.716999999999822, "episode_len_mean": 258.44, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, -50.00000000000044, 6.499999999999652, 45.1, 38.10000000000002, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.10000000000002, 45.3, 45.1, 42.500000000000014, 43.50000000000001, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 47.1, -50.00000000000044, 46.3, -50.00000000000044, 37.90000000000003, 47.3, 19.69999999999984, 38.90000000000002, 47.5, 42.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 14.699999999999768, 46.699999999999996, -50.00000000000044, 28.499999999999964, -50.00000000000044, 42.10000000000001, 45.9, 37.70000000000003, 47.1, 45.5, 19.09999999999983, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.900000000000006, 39.300000000000026, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.7, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.300000000000004, 43.30000000000001, 45.7, 24.299999999999905, -50.00000000000044, -50.00000000000044, 26.09999999999993, 47.3, -50.00000000000044, 31.900000000000013, 47.1, 35.70000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 29.099999999999973, 45.7, -50.00000000000044, 45.9, 38.90000000000002], "episode_lengths": [500, 74, 500, 436, 50, 120, 48, 52, 500, 500, 82, 500, 500, 68, 120, 48, 50, 76, 66, 500, 24, 52, 500, 500, 146, 30, 500, 38, 500, 122, 28, 304, 112, 26, 72, 500, 174, 500, 150, 500, 500, 500, 500, 500, 500, 38, 500, 500, 80, 354, 34, 500, 216, 500, 80, 42, 124, 30, 46, 310, 500, 500, 106, 72, 108, 500, 76, 500, 54, 36, 500, 88, 500, 66, 500, 72, 500, 500, 150, 58, 68, 44, 258, 500, 500, 240, 28, 500, 182, 30, 144, 500, 134, 500, 500, 210, 44, 500, 42, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149064264581455, "mean_inference_ms": 1.3297808373898514, "mean_action_processing_ms": 0.15546052471419125, "mean_env_wait_ms": 0.0930468687637592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036986589431762695, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.15408587455749512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4301.786281127102, "num_env_steps_trained_throughput_per_sec": 4301.786281127102, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3750.475, "sample_time_ms": 3249.017, "load_time_ms": 17.376, "load_throughput": 1035926.19, "learn_time_ms": 471.293, "learn_throughput": 38192.782, "synch_weights_time_ms": 10.079}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5461, "training_iteration": 78, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-46", "timestamp": 1698250906, "time_this_iter_s": 4.189302444458008, "time_total_s": 284.965295791626, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 284.965295791626, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 77.62, "ram_util_percent": 28.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424219e-25, "cur_lr": 0.0003, "total_loss": 6.49573344124688, "policy_loss": -0.0001373324129316542, "vf_loss": 6.4959143850538466, "vf_explained_var": -0.0036023365126715765, "kl": 0.00041240099627025807, "entropy": 0.43679100738631355, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.692999999999823, "episode_len_mean": 258.68, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.300000000000004, 43.30000000000001, 45.7, 24.299999999999905, -50.00000000000044, -50.00000000000044, 26.09999999999993, 47.3, -50.00000000000044, 31.900000000000013, 47.1, 35.70000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 29.099999999999973, 45.7, -50.00000000000044, 45.9, 38.90000000000002, 18.699999999999825, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.10000000000001, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.300000000000026, 25.29999999999992, 35.900000000000034, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 44.5, 46.3, 47.3, -50.00000000000044, 37.50000000000003, 45.1, 44.300000000000004, 42.70000000000001, 45.9, 40.90000000000002, 45.1, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 45.9, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 19.899999999999842, -50.00000000000044, 6.699999999999655, -50.00000000000044, 29.099999999999973, 40.90000000000002], "episode_lengths": [500, 66, 500, 72, 500, 500, 150, 58, 68, 44, 258, 500, 500, 240, 28, 500, 182, 30, 144, 500, 134, 500, 500, 210, 44, 500, 42, 112, 314, 150, 500, 500, 500, 56, 500, 34, 500, 500, 80, 80, 44, 500, 44, 500, 40, 500, 500, 166, 54, 500, 172, 500, 500, 66, 52, 500, 34, 500, 500, 500, 500, 122, 108, 248, 142, 82, 54, 500, 500, 54, 500, 32, 56, 38, 28, 500, 126, 50, 58, 74, 42, 92, 50, 66, 500, 44, 500, 214, 42, 68, 132, 500, 500, 40, 302, 500, 434, 500, 210, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149459769352219, "mean_inference_ms": 1.3293863346965795, "mean_action_processing_ms": 0.15540443029019552, "mean_env_wait_ms": 0.09298051665811397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042510986328125, "StateBufferConnector_ms": 0.010004281997680664, "ViewRequirementAgentConnector_ms": 0.1612718105316162}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.692999999999823, "episode_len_mean": 258.68, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.300000000000004, 43.30000000000001, 45.7, 24.299999999999905, -50.00000000000044, -50.00000000000044, 26.09999999999993, 47.3, -50.00000000000044, 31.900000000000013, 47.1, 35.70000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 29.099999999999973, 45.7, -50.00000000000044, 45.9, 38.90000000000002, 18.699999999999825, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.10000000000001, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.300000000000026, 25.29999999999992, 35.900000000000034, 41.90000000000001, 44.7, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 44.5, 46.3, 47.3, -50.00000000000044, 37.50000000000003, 45.1, 44.300000000000004, 42.70000000000001, 45.9, 40.90000000000002, 45.1, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 45.9, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 19.899999999999842, -50.00000000000044, 6.699999999999655, -50.00000000000044, 29.099999999999973, 40.90000000000002], "episode_lengths": [500, 66, 500, 72, 500, 500, 150, 58, 68, 44, 258, 500, 500, 240, 28, 500, 182, 30, 144, 500, 134, 500, 500, 210, 44, 500, 42, 112, 314, 150, 500, 500, 500, 56, 500, 34, 500, 500, 80, 80, 44, 500, 44, 500, 40, 500, 500, 166, 54, 500, 172, 500, 500, 66, 52, 500, 34, 500, 500, 500, 500, 122, 108, 248, 142, 82, 54, 500, 500, 54, 500, 32, 56, 38, 28, 500, 126, 50, 58, 74, 42, 92, 50, 66, 500, 44, 500, 214, 42, 68, 132, 500, 500, 40, 302, 500, 434, 500, 210, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149459769352219, "mean_inference_ms": 1.3293863346965795, "mean_action_processing_ms": 0.15540443029019552, "mean_env_wait_ms": 0.09298051665811397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042510986328125, "StateBufferConnector_ms": 0.010004281997680664, "ViewRequirementAgentConnector_ms": 0.1612718105316162}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5014.4845080117875, "num_env_steps_trained_throughput_per_sec": 5014.4845080117875, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3731.999, "sample_time_ms": 3242.909, "load_time_ms": 20.756, "load_throughput": 867215.868, "learn_time_ms": 455.483, "learn_throughput": 39518.517, "synch_weights_time_ms": 9.981}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5533, "training_iteration": 79, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-49", "timestamp": 1698250909, "time_this_iter_s": 3.5955753326416016, "time_total_s": 288.5608711242676, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 288.5608711242676, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 62.28000000000001, "ram_util_percent": 28.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121095e-25, "cur_lr": 0.0003, "total_loss": 6.529961511823866, "policy_loss": -0.0003637164831161499, "vf_loss": 6.530373520321316, "vf_explained_var": -0.000883936882019043, "kl": 0.0005944779073833691, "entropy": 0.4820855889055464, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3578.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.509999999999825, "episode_len_mean": 255.54, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 44.5, 46.3, 47.3, -50.00000000000044, 37.50000000000003, 45.1, 44.300000000000004, 42.70000000000001, 45.9, 40.90000000000002, 45.1, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 45.9, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 19.899999999999842, -50.00000000000044, 6.699999999999655, -50.00000000000044, 29.099999999999973, 40.90000000000002, 20.099999999999845, -50.00000000000044, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, 44.300000000000004, 44.300000000000004, 43.7, 42.900000000000006, -50.00000000000044, 45.7, 0.8999999999995723, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 29.49999999999998, 28.699999999999967, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, 32.700000000000024, 29.299999999999976, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, 34.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 34.30000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 24.499999999999908, 45.7, 23.099999999999888, 40.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 46.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.70000000000002, 46.5, 46.9, 46.5], "episode_lengths": [500, 500, 54, 500, 32, 56, 38, 28, 500, 126, 50, 58, 74, 42, 92, 50, 66, 500, 44, 500, 214, 42, 68, 132, 500, 500, 40, 302, 500, 434, 500, 210, 92, 300, 500, 64, 500, 72, 500, 90, 58, 58, 64, 72, 500, 44, 492, 500, 52, 30, 500, 24, 500, 500, 206, 214, 500, 54, 500, 62, 174, 208, 500, 88, 500, 500, 216, 500, 500, 348, 500, 152, 48, 500, 500, 158, 142, 500, 500, 40, 500, 256, 44, 270, 96, 500, 50, 500, 58, 48, 358, 500, 38, 500, 274, 500, 84, 36, 32, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41484217755652, "mean_inference_ms": 1.329780495958442, "mean_action_processing_ms": 0.15559415208260943, "mean_env_wait_ms": 0.09291470386082573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042522430419921875, "StateBufferConnector_ms": 0.007994413375854492, "ViewRequirementAgentConnector_ms": 0.14716339111328125}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.509999999999825, "episode_len_mean": 255.54, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 44.5, 46.3, 47.3, -50.00000000000044, 37.50000000000003, 45.1, 44.300000000000004, 42.70000000000001, 45.9, 40.90000000000002, 45.1, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 45.9, 43.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, 19.899999999999842, -50.00000000000044, 6.699999999999655, -50.00000000000044, 29.099999999999973, 40.90000000000002, 20.099999999999845, -50.00000000000044, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, 44.300000000000004, 44.300000000000004, 43.7, 42.900000000000006, -50.00000000000044, 45.7, 0.8999999999995723, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 29.49999999999998, 28.699999999999967, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, 32.700000000000024, 29.299999999999976, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, 34.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 34.30000000000004, 35.900000000000034, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 24.499999999999908, 45.7, 23.099999999999888, 40.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 46.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.70000000000002, 46.5, 46.9, 46.5], "episode_lengths": [500, 500, 54, 500, 32, 56, 38, 28, 500, 126, 50, 58, 74, 42, 92, 50, 66, 500, 44, 500, 214, 42, 68, 132, 500, 500, 40, 302, 500, 434, 500, 210, 92, 300, 500, 64, 500, 72, 500, 90, 58, 58, 64, 72, 500, 44, 492, 500, 52, 30, 500, 24, 500, 500, 206, 214, 500, 54, 500, 62, 174, 208, 500, 88, 500, 500, 216, 500, 500, 348, 500, 152, 48, 500, 500, 158, 142, 500, 500, 40, 500, 256, 44, 270, 96, 500, 50, 500, 58, 48, 358, 500, 38, 500, 274, 500, 84, 36, 32, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41484217755652, "mean_inference_ms": 1.329780495958442, "mean_action_processing_ms": 0.15559415208260943, "mean_env_wait_ms": 0.09291470386082573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042522430419921875, "StateBufferConnector_ms": 0.007994413375854492, "ViewRequirementAgentConnector_ms": 0.14716339111328125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4812.655042005049, "num_env_steps_trained_throughput_per_sec": 4812.655042005049, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3721.716, "sample_time_ms": 3235.459, "load_time_ms": 20.079, "load_throughput": 896450.791, "learn_time_ms": 453.627, "learn_throughput": 39680.193, "synch_weights_time_ms": 9.88}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5600, "training_iteration": 80, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-53", "timestamp": 1698250913, "time_this_iter_s": 3.7471370697021484, "time_total_s": 292.3080081939697, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 292.3080081939697, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 28.416666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060548e-25, "cur_lr": 0.0003, "total_loss": 6.752034049563938, "policy_loss": -0.0005640140838093228, "vf_loss": 6.752651182810466, "vf_explained_var": -0.003419196605682373, "kl": 0.0012727352661209403, "entropy": 0.5313479860623678, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3623.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.221999999999856, "episode_len_mean": 218.48, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 46.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.70000000000002, 46.5, 46.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 46.099999999999994, 43.10000000000001, 43.7, -50.00000000000044, 42.500000000000014, 42.500000000000014, 42.30000000000001, 46.5, 45.1, 40.90000000000002, 47.1, 4.299999999999621, 45.1, 43.900000000000006, 45.9, -50.00000000000044, 35.10000000000004, 44.300000000000004, 35.70000000000003, 36.50000000000003, 46.099999999999994, 44.7, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 44.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 8.299999999999677, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 24.69999999999991, 46.099999999999994, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.7, 36.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 45.9, 43.900000000000006, -50.00000000000044, 44.7, 45.3, 47.7, 43.900000000000006, 44.10000000000001, 45.9, 27.299999999999947, -50.00000000000044, 44.10000000000001, 8.899999999999686, 45.1, 46.699999999999996, 45.1, 44.300000000000004, -50.00000000000044, 35.10000000000004, 42.70000000000001, -50.00000000000044, 46.5, 42.500000000000014, 35.900000000000034, 41.30000000000001, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [96, 500, 50, 500, 58, 48, 358, 500, 38, 500, 274, 500, 84, 36, 32, 36, 500, 500, 500, 128, 500, 40, 70, 64, 500, 76, 76, 78, 36, 50, 92, 30, 458, 50, 62, 42, 500, 150, 58, 144, 136, 40, 54, 500, 92, 54, 500, 56, 102, 500, 500, 418, 34, 500, 500, 70, 500, 500, 500, 52, 254, 40, 500, 500, 112, 44, 136, 500, 50, 500, 34, 42, 62, 500, 54, 48, 24, 62, 60, 42, 228, 500, 60, 412, 50, 34, 50, 58, 500, 150, 74, 500, 36, 76, 142, 88, 366, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41516162109030874, "mean_inference_ms": 1.3309792938592029, "mean_action_processing_ms": 0.1558271213931928, "mean_env_wait_ms": 0.09279790695574103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026994943618774414, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13700437545776367}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.221999999999856, "episode_len_mean": 218.48, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 46.3, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.70000000000002, 46.5, 46.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 46.099999999999994, 43.10000000000001, 43.7, -50.00000000000044, 42.500000000000014, 42.500000000000014, 42.30000000000001, 46.5, 45.1, 40.90000000000002, 47.1, 4.299999999999621, 45.1, 43.900000000000006, 45.9, -50.00000000000044, 35.10000000000004, 44.300000000000004, 35.70000000000003, 36.50000000000003, 46.099999999999994, 44.7, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 44.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 8.299999999999677, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 24.69999999999991, 46.099999999999994, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.7, 36.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 45.9, 43.900000000000006, -50.00000000000044, 44.7, 45.3, 47.7, 43.900000000000006, 44.10000000000001, 45.9, 27.299999999999947, -50.00000000000044, 44.10000000000001, 8.899999999999686, 45.1, 46.699999999999996, 45.1, 44.300000000000004, -50.00000000000044, 35.10000000000004, 42.70000000000001, -50.00000000000044, 46.5, 42.500000000000014, 35.900000000000034, 41.30000000000001, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [96, 500, 50, 500, 58, 48, 358, 500, 38, 500, 274, 500, 84, 36, 32, 36, 500, 500, 500, 128, 500, 40, 70, 64, 500, 76, 76, 78, 36, 50, 92, 30, 458, 50, 62, 42, 500, 150, 58, 144, 136, 40, 54, 500, 92, 54, 500, 56, 102, 500, 500, 418, 34, 500, 500, 70, 500, 500, 500, 52, 254, 40, 500, 500, 112, 44, 136, 500, 50, 500, 34, 42, 62, 500, 54, 48, 24, 62, 60, 42, 228, 500, 60, 412, 50, 34, 50, 58, 500, 150, 74, 500, 36, 76, 142, 88, 366, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41516162109030874, "mean_inference_ms": 1.3309792938592029, "mean_action_processing_ms": 0.1558271213931928, "mean_env_wait_ms": 0.09279790695574103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026994943618774414, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13700437545776367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4524.7741477752015, "num_env_steps_trained_throughput_per_sec": 4524.7741477752015, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3750.288, "sample_time_ms": 3255.338, "load_time_ms": 19.395, "load_throughput": 928066.558, "learn_time_ms": 463.005, "learn_throughput": 38876.48, "synch_weights_time_ms": 9.88}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5684, "training_iteration": 81, "trial_id": "9f288_00021", "date": "2023-10-25_17-21-57", "timestamp": 1698250917, "time_this_iter_s": 3.9839465618133545, "time_total_s": 296.2919547557831, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 296.2919547557831, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 73.58, "ram_util_percent": 28.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530274e-26, "cur_lr": 0.0003, "total_loss": 6.516020033094618, "policy_loss": -0.00045284455021222435, "vf_loss": 6.516524993048774, "vf_explained_var": -0.006915028889973958, "kl": 0.0014360936495601587, "entropy": 0.521623969078064, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3668.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.859999999999854, "episode_len_mean": 222.12, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 45.3, 47.7, 43.900000000000006, 44.10000000000001, 45.9, 27.299999999999947, -50.00000000000044, 44.10000000000001, 8.899999999999686, 45.1, 46.699999999999996, 45.1, 44.300000000000004, -50.00000000000044, 35.10000000000004, 42.70000000000001, -50.00000000000044, 46.5, 42.500000000000014, 35.900000000000034, 41.30000000000001, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.3, 23.099999999999888, 44.7, 43.900000000000006, 40.10000000000002, 0.6999999999995694, 20.49999999999985, 34.70000000000004, 45.7, 43.10000000000001, 45.9, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 43.10000000000001, -50.00000000000044, 44.7, 47.1, 30.499999999999993, 38.10000000000002, 44.900000000000006, 47.3, 44.5, 41.90000000000001, 29.099999999999973, 43.7, -50.00000000000044, -50.00000000000044, 19.899999999999842, 44.10000000000001, 38.10000000000002, 43.900000000000006, 40.90000000000002, -50.00000000000044, 42.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.10000000000002, 45.7, 46.9, 44.7, -50.00000000000044, 46.099999999999994, 39.50000000000002, 47.1, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 45.7, 28.29999999999996, -50.00000000000044, 44.5], "episode_lengths": [54, 48, 24, 62, 60, 42, 228, 500, 60, 412, 50, 34, 50, 58, 500, 150, 74, 500, 36, 76, 142, 88, 366, 500, 500, 38, 270, 54, 62, 100, 494, 296, 154, 44, 70, 42, 56, 500, 500, 500, 446, 70, 500, 54, 30, 196, 120, 52, 28, 56, 82, 210, 64, 500, 500, 302, 60, 120, 62, 92, 500, 78, 102, 500, 500, 500, 356, 500, 98, 500, 80, 500, 110, 44, 32, 54, 500, 40, 106, 30, 54, 40, 500, 500, 500, 120, 66, 500, 500, 274, 500, 90, 500, 214, 68, 500, 44, 218, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41536916456134504, "mean_inference_ms": 1.3318635529898666, "mean_action_processing_ms": 0.15605531243383058, "mean_env_wait_ms": 0.09318430597290332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03191065788269043, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.15889286994934082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.859999999999854, "episode_len_mean": 222.12, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 45.3, 47.7, 43.900000000000006, 44.10000000000001, 45.9, 27.299999999999947, -50.00000000000044, 44.10000000000001, 8.899999999999686, 45.1, 46.699999999999996, 45.1, 44.300000000000004, -50.00000000000044, 35.10000000000004, 42.70000000000001, -50.00000000000044, 46.5, 42.500000000000014, 35.900000000000034, 41.30000000000001, 13.499999999999751, -50.00000000000044, -50.00000000000044, 46.3, 23.099999999999888, 44.7, 43.900000000000006, 40.10000000000002, 0.6999999999995694, 20.49999999999985, 34.70000000000004, 45.7, 43.10000000000001, 45.9, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.499999999999638, 43.10000000000001, -50.00000000000044, 44.7, 47.1, 30.499999999999993, 38.10000000000002, 44.900000000000006, 47.3, 44.5, 41.90000000000001, 29.099999999999973, 43.7, -50.00000000000044, -50.00000000000044, 19.899999999999842, 44.10000000000001, 38.10000000000002, 43.900000000000006, 40.90000000000002, -50.00000000000044, 42.30000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 39.10000000000002, 45.7, 46.9, 44.7, -50.00000000000044, 46.099999999999994, 39.50000000000002, 47.1, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 45.7, 28.29999999999996, -50.00000000000044, 44.5], "episode_lengths": [54, 48, 24, 62, 60, 42, 228, 500, 60, 412, 50, 34, 50, 58, 500, 150, 74, 500, 36, 76, 142, 88, 366, 500, 500, 38, 270, 54, 62, 100, 494, 296, 154, 44, 70, 42, 56, 500, 500, 500, 446, 70, 500, 54, 30, 196, 120, 52, 28, 56, 82, 210, 64, 500, 500, 302, 60, 120, 62, 92, 500, 78, 102, 500, 500, 500, 356, 500, 98, 500, 80, 500, 110, 44, 32, 54, 500, 40, 106, 30, 54, 40, 500, 500, 500, 120, 66, 500, 500, 274, 500, 90, 500, 214, 68, 500, 44, 218, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41536916456134504, "mean_inference_ms": 1.3318635529898666, "mean_action_processing_ms": 0.15605531243383058, "mean_env_wait_ms": 0.09318430597290332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03191065788269043, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.15889286994934082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4722.265627516606, "num_env_steps_trained_throughput_per_sec": 4722.265627516606, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3766.946, "sample_time_ms": 3251.061, "load_time_ms": 20.595, "load_throughput": 873995.416, "learn_time_ms": 482.636, "learn_throughput": 37295.178, "synch_weights_time_ms": 10.082}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5758, "training_iteration": 82, "trial_id": "9f288_00021", "date": "2023-10-25_17-22-01", "timestamp": 1698250921, "time_this_iter_s": 3.8166399002075195, "time_total_s": 300.1085946559906, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 300.1085946559906, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 61.71666666666667, "ram_util_percent": 28.516666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765137e-26, "cur_lr": 0.0003, "total_loss": 6.335456371307373, "policy_loss": -0.0002545693889260292, "vf_loss": 6.33576291402181, "vf_explained_var": 0.00331801176071167, "kl": 0.000566803031754009, "entropy": 0.5188373221291436, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3713.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.534999999999821, "episode_len_mean": 250.26, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 45.7, 46.9, 44.7, -50.00000000000044, 46.099999999999994, 39.50000000000002, 47.1, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 45.7, 28.29999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.5, 10.499999999999709, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, 43.50000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 39.70000000000002, 46.3, 42.500000000000014, 46.5, -50.00000000000044, 45.5, 34.50000000000004, 42.10000000000001, 44.300000000000004, 43.10000000000001, 46.5, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 46.3, 40.30000000000002, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 43.10000000000001, 16.29999999999979, 44.300000000000004, 46.9, 45.3, 46.099999999999994, 39.70000000000002, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 45.7, 45.9, -50.00000000000044], "episode_lengths": [500, 110, 44, 32, 54, 500, 40, 106, 30, 54, 40, 500, 500, 500, 120, 66, 500, 500, 274, 500, 90, 500, 214, 68, 500, 44, 218, 500, 56, 500, 500, 500, 500, 500, 500, 500, 40, 56, 396, 500, 500, 32, 500, 500, 500, 46, 142, 66, 164, 500, 500, 500, 202, 52, 500, 36, 500, 104, 38, 76, 36, 500, 46, 156, 80, 58, 70, 36, 500, 72, 36, 500, 92, 42, 500, 38, 98, 38, 40, 500, 500, 468, 70, 338, 58, 32, 48, 40, 104, 500, 68, 76, 500, 500, 500, 44, 46, 44, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41573930755992694, "mean_inference_ms": 1.332684818597743, "mean_action_processing_ms": 0.15563676460523101, "mean_env_wait_ms": 0.09294511015699111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03290534019470215, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11891508102416992}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.534999999999821, "episode_len_mean": 250.26, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.10000000000002, 45.7, 46.9, 44.7, -50.00000000000044, 46.099999999999994, 39.50000000000002, 47.1, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 45.7, 28.29999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.5, 10.499999999999709, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, 43.50000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 39.70000000000002, 46.3, 42.500000000000014, 46.5, -50.00000000000044, 45.5, 34.50000000000004, 42.10000000000001, 44.300000000000004, 43.10000000000001, 46.5, -50.00000000000044, 42.900000000000006, 46.5, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, 46.3, 40.30000000000002, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 43.10000000000001, 16.29999999999979, 44.300000000000004, 46.9, 45.3, 46.099999999999994, 39.70000000000002, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 45.7, 45.9, -50.00000000000044], "episode_lengths": [500, 110, 44, 32, 54, 500, 40, 106, 30, 54, 40, 500, 500, 500, 120, 66, 500, 500, 274, 500, 90, 500, 214, 68, 500, 44, 218, 500, 56, 500, 500, 500, 500, 500, 500, 500, 40, 56, 396, 500, 500, 32, 500, 500, 500, 46, 142, 66, 164, 500, 500, 500, 202, 52, 500, 36, 500, 104, 38, 76, 36, 500, 46, 156, 80, 58, 70, 36, 500, 72, 36, 500, 92, 42, 500, 38, 98, 38, 40, 500, 500, 468, 70, 338, 58, 32, 48, 40, 104, 500, 68, 76, 500, 500, 500, 44, 46, 44, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41573930755992694, "mean_inference_ms": 1.332684818597743, "mean_action_processing_ms": 0.15563676460523101, "mean_env_wait_ms": 0.09294511015699111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03290534019470215, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.11891508102416992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5167.7774794132465, "num_env_steps_trained_throughput_per_sec": 5167.7774794132465, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3757.593, "sample_time_ms": 3242.248, "load_time_ms": 21.695, "load_throughput": 829676.284, "learn_time_ms": 481.1, "learn_throughput": 37414.249, "synch_weights_time_ms": 9.979}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5829, "training_iteration": 83, "trial_id": "9f288_00021", "date": "2023-10-25_17-22-04", "timestamp": 1698250924, "time_this_iter_s": 3.4931297302246094, "time_total_s": 303.6017243862152, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 303.6017243862152, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 59.42, "ram_util_percent": 28.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825684e-26, "cur_lr": 0.0003, "total_loss": 6.49361793729994, "policy_loss": -0.00010802379498879115, "vf_loss": 6.4937743504842125, "vf_explained_var": 0.00165938933690389, "kl": 0.0005824650375637298, "entropy": 0.48402754995557995, "entropy_coeff": 0.00010000000000000003}, "model": {}, "num_grad_updates_lifetime": 3758.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.903999999999836, "episode_len_mean": 241.62, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 40.30000000000002, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 43.10000000000001, 16.29999999999979, 44.300000000000004, 46.9, 45.3, 46.099999999999994, 39.70000000000002, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 20.899999999999856, 43.10000000000001, 44.900000000000006, 45.5, 20.49999999999985, -50.00000000000044, -50.00000000000044, 47.9, 46.5, -50.00000000000044, 18.499999999999822, 43.30000000000001, 41.100000000000016, 45.1, 42.500000000000014, 37.10000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 40.500000000000014, 31.1, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 5.499999999999638, 46.9, 38.50000000000003, 31.900000000000013, 43.10000000000001, -50.00000000000044, 25.099999999999916, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 32.700000000000024, 28.09999999999996, 44.5, 45.9, -50.00000000000044, 45.3, 45.5, 45.7, 25.29999999999992, 28.29999999999996, 42.900000000000006, -50.00000000000044, 41.70000000000002, 45.5, 29.49999999999998], "episode_lengths": [500, 38, 98, 38, 40, 500, 500, 468, 70, 338, 58, 32, 48, 40, 104, 500, 68, 76, 500, 500, 500, 44, 46, 44, 42, 500, 500, 292, 70, 52, 46, 296, 500, 500, 22, 36, 500, 316, 68, 90, 50, 76, 130, 500, 34, 500, 500, 500, 64, 500, 32, 500, 500, 500, 50, 96, 190, 78, 58, 500, 500, 500, 36, 446, 32, 116, 182, 70, 500, 250, 64, 500, 68, 500, 114, 500, 52, 236, 500, 500, 36, 500, 500, 500, 118, 174, 220, 56, 42, 500, 48, 46, 44, 248, 218, 72, 500, 84, 46, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158078616475764, "mean_inference_ms": 1.3338628025641497, "mean_action_processing_ms": 0.15674800235295663, "mean_env_wait_ms": 0.09323893686112232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.13399958610534668}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.903999999999836, "episode_len_mean": 241.62, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 40.30000000000002, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 43.10000000000001, 16.29999999999979, 44.300000000000004, 46.9, 45.3, 46.099999999999994, 39.70000000000002, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.5, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 20.899999999999856, 43.10000000000001, 44.900000000000006, 45.5, 20.49999999999985, -50.00000000000044, -50.00000000000044, 47.9, 46.5, -50.00000000000044, 18.499999999999822, 43.30000000000001, 41.100000000000016, 45.1, 42.500000000000014, 37.10000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 40.500000000000014, 31.1, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 5.499999999999638, 46.9, 38.50000000000003, 31.900000000000013, 43.10000000000001, -50.00000000000044, 25.099999999999916, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 32.700000000000024, 28.09999999999996, 44.5, 45.9, -50.00000000000044, 45.3, 45.5, 45.7, 25.29999999999992, 28.29999999999996, 42.900000000000006, -50.00000000000044, 41.70000000000002, 45.5, 29.49999999999998], "episode_lengths": [500, 38, 98, 38, 40, 500, 500, 468, 70, 338, 58, 32, 48, 40, 104, 500, 68, 76, 500, 500, 500, 44, 46, 44, 42, 500, 500, 292, 70, 52, 46, 296, 500, 500, 22, 36, 500, 316, 68, 90, 50, 76, 130, 500, 34, 500, 500, 500, 64, 500, 32, 500, 500, 500, 50, 96, 190, 78, 58, 500, 500, 500, 36, 446, 32, 116, 182, 70, 500, 250, 64, 500, 68, 500, 114, 500, 52, 236, 500, 500, 36, 500, 500, 500, 118, 174, 220, 56, 42, 500, 48, 46, 44, 248, 218, 72, 500, 84, 46, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158078616475764, "mean_inference_ms": 1.3338628025641497, "mean_action_processing_ms": 0.15674800235295663, "mean_env_wait_ms": 0.09323893686112232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.13399958610534668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4655.683531185953, "num_env_steps_trained_throughput_per_sec": 4655.683531185953, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3777.85, "sample_time_ms": 3241.652, "load_time_ms": 22.098, "load_throughput": 814550.1, "learn_time_ms": 501.469, "learn_throughput": 35894.527, "synch_weights_time_ms": 10.06}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5903, "training_iteration": 84, "trial_id": "9f288_00021", "date": "2023-10-25_17-22-08", "timestamp": 1698250928, "time_this_iter_s": 3.8732357025146484, "time_total_s": 307.47496008872986, "pid": 2612, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 307.47496008872986, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 70.78, "ram_util_percent": 28.579999999999995}}
