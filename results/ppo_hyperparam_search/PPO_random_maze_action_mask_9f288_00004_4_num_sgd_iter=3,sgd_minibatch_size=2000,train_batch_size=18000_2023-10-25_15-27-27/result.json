{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.283610591182002, "policy_loss": -0.0018427601704994838, "vf_loss": 9.28486442565918, "vf_explained_var": 0.00023672095051518194, "kl": 0.0032875146272716067, "entropy": 0.685186971116949, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 35.500000000000036, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -28.897368421052978, "episode_len_mean": 434.0, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.699999999999953, 22.49999999999988, -50.00000000000044, 21.299999999999862, -50.00000000000044, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 13.099999999999746, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [224, 276, 500, 288, 500, 190, 146, 500, 500, 500, 500, 500, 500, 500, 204, 500, 370, 500, 354, 500, 500, 500, 268, 500, 500, 500, 300, 500, 500, 500, 500, 500, 500, 372, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4185703502237565, "mean_inference_ms": 1.3644374634533305, "mean_action_processing_ms": 0.16594572226769372, "mean_env_wait_ms": 0.09656172739372222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0394808618645919, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1578807830810547}}, "episode_reward_max": 35.500000000000036, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -28.897368421052978, "episode_len_mean": 434.0, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.699999999999953, 22.49999999999988, -50.00000000000044, 21.299999999999862, -50.00000000000044, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 13.099999999999746, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [224, 276, 500, 288, 500, 190, 146, 500, 500, 500, 500, 500, 500, 500, 204, 500, 370, 500, 354, 500, 500, 500, 268, 500, 500, 500, 300, 500, 500, 500, 500, 500, 500, 372, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4185703502237565, "mean_inference_ms": 1.3644374634533305, "mean_action_processing_ms": 0.16594572226769372, "mean_env_wait_ms": 0.09656172739372222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0394808618645919, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1578807830810547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5246.279516261544, "num_env_steps_trained_throughput_per_sec": 5246.279516261544, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3431.003, "sample_time_ms": 3204.001, "load_time_ms": 9.0, "load_throughput": 2000091.981, "learn_time_ms": 204.999, "learn_throughput": 87805.319, "synch_weights_time_ms": 12.002}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 38, "training_iteration": 1, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-32", "timestamp": 1698245312, "time_this_iter_s": 3.436999559402466, "time_total_s": 3.436999559402466, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.436999559402466, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 70.47999999999999, "ram_util_percent": 26.979999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.035951579058612, "policy_loss": -0.0022190192162438675, "vf_loss": 9.037849108378092, "vf_explained_var": 2.200956697817202e-05, "kl": 0.003942435368070242, "entropy": 0.7275022400750054, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 38.10000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.98072289156657, "episode_len_mean": 405.03614457831327, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.699999999999953, 22.49999999999988, -50.00000000000044, 21.299999999999862, -50.00000000000044, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 13.099999999999746, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.499999999999922, 8.49999999999968, 24.299999999999905, 13.699999999999754, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.70000000000004, -50.00000000000044, 38.10000000000002, 24.899999999999913, 17.69999999999981, 35.500000000000036, 19.09999999999983, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 29.299999999999976, 28.89999999999997, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 36.50000000000003], "episode_lengths": [224, 276, 500, 288, 500, 190, 146, 500, 500, 500, 500, 500, 500, 500, 204, 500, 370, 500, 354, 500, 500, 500, 268, 500, 500, 500, 300, 500, 500, 500, 500, 500, 500, 372, 500, 500, 500, 500, 356, 396, 500, 500, 500, 500, 194, 500, 500, 274, 246, 416, 258, 364, 202, 500, 500, 500, 172, 500, 500, 500, 422, 500, 256, 500, 154, 500, 120, 252, 324, 146, 310, 500, 494, 500, 500, 208, 212, 500, 500, 214, 500, 500, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4098734928865227, "mean_inference_ms": 1.3332808091966104, "mean_action_processing_ms": 0.15968164904611862, "mean_env_wait_ms": 0.09543130427775744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03012978886983481, "StateBufferConnector_ms": 0.0036187918789415473, "ViewRequirementAgentConnector_ms": 0.14641284942626953}}, "episode_reward_max": 38.10000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.98072289156657, "episode_len_mean": 405.03614457831327, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.699999999999953, 22.49999999999988, -50.00000000000044, 21.299999999999862, -50.00000000000044, 31.1, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 13.099999999999746, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.499999999999922, 8.49999999999968, 24.299999999999905, 13.699999999999754, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.70000000000004, -50.00000000000044, 38.10000000000002, 24.899999999999913, 17.69999999999981, 35.500000000000036, 19.09999999999983, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 29.299999999999976, 28.89999999999997, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 36.50000000000003], "episode_lengths": [224, 276, 500, 288, 500, 190, 146, 500, 500, 500, 500, 500, 500, 500, 204, 500, 370, 500, 354, 500, 500, 500, 268, 500, 500, 500, 300, 500, 500, 500, 500, 500, 500, 372, 500, 500, 500, 500, 356, 396, 500, 500, 500, 500, 194, 500, 500, 274, 246, 416, 258, 364, 202, 500, 500, 500, 172, 500, 500, 500, 422, 500, 256, 500, 154, 500, 120, 252, 324, 146, 310, 500, 494, 500, 500, 208, 212, 500, 500, 214, 500, 500, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4098734928865227, "mean_inference_ms": 1.3332808091966104, "mean_action_processing_ms": 0.15968164904611862, "mean_env_wait_ms": 0.09543130427775744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03012978886983481, "StateBufferConnector_ms": 0.0036187918789415473, "ViewRequirementAgentConnector_ms": 0.14641284942626953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5550.08368409689, "num_env_steps_trained_throughput_per_sec": 5550.08368409689, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3337.099, "sample_time_ms": 3065.728, "load_time_ms": 12.0, "load_throughput": 1499959.708, "learn_time_ms": 247.868, "learn_throughput": 72619.245, "synch_weights_time_ms": 10.501}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 83, "training_iteration": 2, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-35", "timestamp": 1698245315, "time_this_iter_s": 3.2481913566589355, "time_total_s": 6.685190916061401, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.685190916061401, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 65.82000000000001, "ram_util_percent": 27.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 8.807742330763075, "policy_loss": -0.0001682564616203308, "vf_loss": 8.807890962671351, "vf_explained_var": 6.353413617169416e-06, "kl": 0.0017944952755476185, "entropy": 0.701309773657057, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.5580000000002485, "episode_len_mean": 356.18, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.499999999999922, 8.49999999999968, 24.299999999999905, 13.699999999999754, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.70000000000004, -50.00000000000044, 38.10000000000002, 24.899999999999913, 17.69999999999981, 35.500000000000036, 19.09999999999983, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 29.299999999999976, 28.89999999999997, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 35.30000000000004, 34.900000000000034, 18.099999999999817, 41.30000000000001, 28.699999999999967, 10.699999999999712, 27.899999999999956, 39.10000000000002, -50.00000000000044, 10.699999999999712, 10.299999999999706, 17.69999999999981, 31.1, 38.300000000000026, 6.299999999999649, -50.00000000000044, 40.500000000000014, 15.49999999999978, 9.299999999999692, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 17.099999999999802, 25.499999999999922, 40.500000000000014, 44.300000000000004, 24.499999999999908, 9.699999999999697, 15.099999999999774, 0.49999999999956657, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 3.499999999999609, 8.899999999999686, -50.00000000000044, 37.70000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 26.09999999999993], "episode_lengths": [396, 500, 500, 500, 500, 194, 500, 500, 274, 246, 416, 258, 364, 202, 500, 500, 500, 172, 500, 500, 500, 422, 500, 256, 500, 154, 500, 120, 252, 324, 146, 310, 500, 494, 500, 500, 208, 212, 500, 500, 214, 500, 500, 136, 500, 148, 152, 320, 88, 214, 394, 222, 110, 500, 394, 398, 324, 190, 118, 438, 500, 96, 346, 408, 500, 500, 204, 500, 500, 500, 204, 326, 330, 246, 96, 58, 256, 404, 350, 496, 86, 500, 500, 500, 500, 250, 466, 412, 500, 124, 492, 500, 500, 144, 240, 500, 500, 500, 64, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3974730625520985, "mean_inference_ms": 1.2857693021242769, "mean_action_processing_ms": 0.15183325461460837, "mean_env_wait_ms": 0.09256463814339093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017000675201416016, "StateBufferConnector_ms": 0.0030035972595214844, "ViewRequirementAgentConnector_ms": 0.14152216911315918}}, "episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.5580000000002485, "episode_len_mean": 356.18, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.499999999999922, 8.49999999999968, 24.299999999999905, 13.699999999999754, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 24.499999999999908, -50.00000000000044, 34.70000000000004, -50.00000000000044, 38.10000000000002, 24.899999999999913, 17.69999999999981, 35.500000000000036, 19.09999999999983, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 29.299999999999976, 28.89999999999997, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 35.30000000000004, 34.900000000000034, 18.099999999999817, 41.30000000000001, 28.699999999999967, 10.699999999999712, 27.899999999999956, 39.10000000000002, -50.00000000000044, 10.699999999999712, 10.299999999999706, 17.69999999999981, 31.1, 38.300000000000026, 6.299999999999649, -50.00000000000044, 40.500000000000014, 15.49999999999978, 9.299999999999692, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 17.099999999999802, 25.499999999999922, 40.500000000000014, 44.300000000000004, 24.499999999999908, 9.699999999999697, 15.099999999999774, 0.49999999999956657, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 3.499999999999609, 8.899999999999686, -50.00000000000044, 37.70000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 26.09999999999993], "episode_lengths": [396, 500, 500, 500, 500, 194, 500, 500, 274, 246, 416, 258, 364, 202, 500, 500, 500, 172, 500, 500, 500, 422, 500, 256, 500, 154, 500, 120, 252, 324, 146, 310, 500, 494, 500, 500, 208, 212, 500, 500, 214, 500, 500, 136, 500, 148, 152, 320, 88, 214, 394, 222, 110, 500, 394, 398, 324, 190, 118, 438, 500, 96, 346, 408, 500, 500, 204, 500, 500, 500, 204, 326, 330, 246, 96, 58, 256, 404, 350, 496, 86, 500, 500, 500, 500, 250, 466, 412, 500, 124, 492, 500, 500, 144, 240, 500, 500, 500, 64, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3974730625520985, "mean_inference_ms": 1.2857693021242769, "mean_action_processing_ms": 0.15183325461460837, "mean_env_wait_ms": 0.09256463814339093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017000675201416016, "StateBufferConnector_ms": 0.0030035972595214844, "ViewRequirementAgentConnector_ms": 0.14152216911315918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5604.068437542311, "num_env_steps_trained_throughput_per_sec": 5604.068437542311, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3295.383, "sample_time_ms": 2978.802, "load_time_ms": 16.0, "load_throughput": 1124975.369, "learn_time_ms": 289.246, "learn_throughput": 62230.731, "synch_weights_time_ms": 10.0}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 139, "training_iteration": 3, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-39", "timestamp": 1698245319, "time_this_iter_s": 3.2169504165649414, "time_total_s": 9.902141332626343, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.902141332626343, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 62.224999999999994, "ram_util_percent": 27.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 8.970999682391131, "policy_loss": -0.0001532736199873465, "vf_loss": 8.971192077354148, "vf_explained_var": 5.783858122649016e-06, "kl": 0.0011788274389946058, "entropy": 0.6854684595708493, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3399999999997947, "episode_len_mean": 317.26, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 15.49999999999978, 9.299999999999692, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 17.099999999999802, 25.499999999999922, 40.500000000000014, 44.300000000000004, 24.499999999999908, 9.699999999999697, 15.099999999999774, 0.49999999999956657, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 3.499999999999609, 8.899999999999686, -50.00000000000044, 37.70000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 26.09999999999993, 31.70000000000001, 38.10000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, 23.8999999999999, 29.899999999999984, -50.00000000000044, 27.299999999999947, 37.70000000000003, -50.00000000000044, 39.90000000000002, 5.899999999999643, 31.1, -50.00000000000044, 30.9, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.5, 32.100000000000016, -50.00000000000044, 41.30000000000001, 43.10000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 35.500000000000036, -50.00000000000044, 25.499999999999922, 7.299999999999663, 17.69999999999981, 39.90000000000002, 38.700000000000024, 31.900000000000013, 0.8999999999995723, 39.300000000000026, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.50000000000001, 11.099999999999717, 37.300000000000026, 33.70000000000004, 2.499999999999595, 39.300000000000026, 30.699999999999996, 39.10000000000002, 31.500000000000007, 33.10000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 31.300000000000004, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024], "episode_lengths": [96, 346, 408, 500, 500, 204, 500, 500, 500, 204, 326, 330, 246, 96, 58, 256, 404, 350, 496, 86, 500, 500, 500, 500, 250, 466, 412, 500, 124, 492, 500, 500, 144, 240, 500, 500, 500, 64, 240, 184, 120, 500, 168, 500, 76, 262, 202, 500, 228, 124, 500, 102, 442, 190, 500, 192, 238, 500, 500, 56, 180, 500, 88, 70, 500, 206, 500, 146, 500, 246, 428, 324, 102, 114, 182, 492, 108, 500, 500, 322, 66, 390, 128, 164, 476, 108, 194, 110, 186, 170, 500, 500, 200, 500, 188, 242, 500, 500, 500, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39210219462941387, "mean_inference_ms": 1.2617795888142214, "mean_action_processing_ms": 0.14948823409009718, "mean_env_wait_ms": 0.08996216089074688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599930763244629, "StateBufferConnector_ms": 0.0019998550415039062, "ViewRequirementAgentConnector_ms": 0.12899208068847656}}, "episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3399999999997947, "episode_len_mean": 317.26, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 15.49999999999978, 9.299999999999692, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 17.499999999999808, 17.099999999999802, 25.499999999999922, 40.500000000000014, 44.300000000000004, 24.499999999999908, 9.699999999999697, 15.099999999999774, 0.49999999999956657, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 3.499999999999609, 8.899999999999686, -50.00000000000044, 37.70000000000003, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 26.09999999999993, 31.70000000000001, 38.10000000000002, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, 23.8999999999999, 29.899999999999984, -50.00000000000044, 27.299999999999947, 37.70000000000003, -50.00000000000044, 39.90000000000002, 5.899999999999643, 31.1, -50.00000000000044, 30.9, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.5, 32.100000000000016, -50.00000000000044, 41.30000000000001, 43.10000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 35.500000000000036, -50.00000000000044, 25.499999999999922, 7.299999999999663, 17.69999999999981, 39.90000000000002, 38.700000000000024, 31.900000000000013, 0.8999999999995723, 39.300000000000026, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.50000000000001, 11.099999999999717, 37.300000000000026, 33.70000000000004, 2.499999999999595, 39.300000000000026, 30.699999999999996, 39.10000000000002, 31.500000000000007, 33.10000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 31.300000000000004, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024], "episode_lengths": [96, 346, 408, 500, 500, 204, 500, 500, 500, 204, 326, 330, 246, 96, 58, 256, 404, 350, 496, 86, 500, 500, 500, 500, 250, 466, 412, 500, 124, 492, 500, 500, 144, 240, 500, 500, 500, 64, 240, 184, 120, 500, 168, 500, 76, 262, 202, 500, 228, 124, 500, 102, 442, 190, 500, 192, 238, 500, 500, 56, 180, 500, 88, 70, 500, 206, 500, 146, 500, 246, 428, 324, 102, 114, 182, 492, 108, 500, 500, 322, 66, 390, 128, 164, 476, 108, 194, 110, 186, 170, 500, 500, 200, 500, 188, 242, 500, 500, 500, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39210219462941387, "mean_inference_ms": 1.2617795888142214, "mean_action_processing_ms": 0.14948823409009718, "mean_env_wait_ms": 0.08996216089074688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599930763244629, "StateBufferConnector_ms": 0.0019998550415039062, "ViewRequirementAgentConnector_ms": 0.12899208068847656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5603.983994485792, "num_env_steps_trained_throughput_per_sec": 5603.983994485792, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3274.538, "sample_time_ms": 2946.602, "load_time_ms": 17.0, "load_throughput": 1058818.599, "learn_time_ms": 299.442, "learn_throughput": 60111.761, "synch_weights_time_ms": 10.243}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 200, "training_iteration": 4, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-42", "timestamp": 1698245322, "time_this_iter_s": 3.2170002460479736, "time_total_s": 13.119141578674316, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.119141578674316, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.86, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.847131799768519, "policy_loss": -0.0010058337098194493, "vf_loss": 8.848170810275608, "vf_explained_var": -1.512854187576859e-05, "kl": 0.002493798704335859, "entropy": 0.6454890259989986, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.241999999999857, "episode_len_mean": 258.32, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 38.700000000000024, 31.900000000000013, 0.8999999999995723, 39.300000000000026, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.50000000000001, 11.099999999999717, 37.300000000000026, 33.70000000000004, 2.499999999999595, 39.300000000000026, 30.699999999999996, 39.10000000000002, 31.500000000000007, 33.10000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 31.300000000000004, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 37.90000000000003, 32.700000000000024, 37.10000000000003, 43.7, 35.500000000000036, 28.499999999999964, 27.49999999999995, 19.499999999999837, 39.90000000000002, 27.299999999999947, 44.900000000000006, 13.099999999999746, 43.7, 35.70000000000003, -50.00000000000044, 16.699999999999797, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.7, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 32.90000000000003, 21.09999999999986, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.30000000000001, 43.10000000000001, 33.90000000000004, 40.10000000000002, 46.099999999999994, 37.50000000000003, 42.70000000000001, 40.10000000000002, 41.500000000000014, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.300000000000026, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, 32.50000000000002, 37.10000000000003, 26.299999999999933, 43.10000000000001, -50.00000000000044, 35.70000000000003, 25.499999999999922, -50.00000000000044, 41.90000000000001, -50.00000000000044, 17.499999999999808, 22.299999999999876, -50.00000000000044, 20.099999999999845, 35.900000000000034, -50.00000000000044, 1.299999999999578, 39.300000000000026, 33.90000000000004, 44.7, 44.10000000000001, -50.00000000000044], "episode_lengths": [102, 114, 182, 492, 108, 500, 500, 322, 66, 390, 128, 164, 476, 108, 194, 110, 186, 170, 500, 500, 200, 500, 188, 242, 500, 500, 500, 174, 122, 174, 130, 64, 146, 216, 226, 306, 102, 228, 52, 370, 64, 144, 500, 334, 500, 144, 500, 500, 182, 44, 396, 500, 500, 500, 500, 350, 172, 290, 500, 82, 500, 78, 70, 162, 100, 40, 126, 74, 100, 86, 88, 92, 108, 108, 500, 82, 60, 500, 176, 130, 238, 70, 500, 144, 246, 500, 82, 500, 326, 278, 500, 300, 142, 500, 488, 108, 162, 54, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38820216256511564, "mean_inference_ms": 1.2460530013614193, "mean_action_processing_ms": 0.14802381900392728, "mean_env_wait_ms": 0.08803661237763942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899862289428711, "StateBufferConnector_ms": 0.008997201919555664, "ViewRequirementAgentConnector_ms": 0.11797165870666504}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.241999999999857, "episode_len_mean": 258.32, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 38.700000000000024, 31.900000000000013, 0.8999999999995723, 39.300000000000026, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.50000000000001, 11.099999999999717, 37.300000000000026, 33.70000000000004, 2.499999999999595, 39.300000000000026, 30.699999999999996, 39.10000000000002, 31.500000000000007, 33.10000000000003, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 31.300000000000004, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 37.90000000000003, 32.700000000000024, 37.10000000000003, 43.7, 35.500000000000036, 28.499999999999964, 27.49999999999995, 19.499999999999837, 39.90000000000002, 27.299999999999947, 44.900000000000006, 13.099999999999746, 43.7, 35.70000000000003, -50.00000000000044, 16.699999999999797, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.7, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 32.90000000000003, 21.09999999999986, -50.00000000000044, 41.90000000000001, -50.00000000000044, 42.30000000000001, 43.10000000000001, 33.90000000000004, 40.10000000000002, 46.099999999999994, 37.50000000000003, 42.70000000000001, 40.10000000000002, 41.500000000000014, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.300000000000026, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, 32.50000000000002, 37.10000000000003, 26.299999999999933, 43.10000000000001, -50.00000000000044, 35.70000000000003, 25.499999999999922, -50.00000000000044, 41.90000000000001, -50.00000000000044, 17.499999999999808, 22.299999999999876, -50.00000000000044, 20.099999999999845, 35.900000000000034, -50.00000000000044, 1.299999999999578, 39.300000000000026, 33.90000000000004, 44.7, 44.10000000000001, -50.00000000000044], "episode_lengths": [102, 114, 182, 492, 108, 500, 500, 322, 66, 390, 128, 164, 476, 108, 194, 110, 186, 170, 500, 500, 200, 500, 188, 242, 500, 500, 500, 174, 122, 174, 130, 64, 146, 216, 226, 306, 102, 228, 52, 370, 64, 144, 500, 334, 500, 144, 500, 500, 182, 44, 396, 500, 500, 500, 500, 350, 172, 290, 500, 82, 500, 78, 70, 162, 100, 40, 126, 74, 100, 86, 88, 92, 108, 108, 500, 82, 60, 500, 176, 130, 238, 70, 500, 144, 246, 500, 82, 500, 326, 278, 500, 300, 142, 500, 488, 108, 162, 54, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38820216256511564, "mean_inference_ms": 1.2460530013614193, "mean_action_processing_ms": 0.14802381900392728, "mean_env_wait_ms": 0.08803661237763942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899862289428711, "StateBufferConnector_ms": 0.008997201919555664, "ViewRequirementAgentConnector_ms": 0.11797165870666504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5782.078494765053, "num_env_steps_trained_throughput_per_sec": 5782.078494765053, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3242.243, "sample_time_ms": 2910.295, "load_time_ms": 18.406, "load_throughput": 977936.394, "learn_time_ms": 302.348, "learn_throughput": 59533.982, "synch_weights_time_ms": 9.994}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 272, "training_iteration": 5, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-45", "timestamp": 1698245325, "time_this_iter_s": 3.118067741394043, "time_total_s": 16.23720932006836, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.23720932006836, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 62.14999999999999, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.490733570522732, "policy_loss": -0.00022555059856838651, "vf_loss": 8.491014145038745, "vf_explained_var": -1.931632006609881e-06, "kl": 0.0006894278516803617, "entropy": 0.5938289651164302, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.911999999999843, "episode_len_mean": 261.6, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, 46.099999999999994, 37.50000000000003, 42.70000000000001, 40.10000000000002, 41.500000000000014, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.300000000000026, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, 32.50000000000002, 37.10000000000003, 26.299999999999933, 43.10000000000001, -50.00000000000044, 35.70000000000003, 25.499999999999922, -50.00000000000044, 41.90000000000001, -50.00000000000044, 17.499999999999808, 22.299999999999876, -50.00000000000044, 20.099999999999845, 35.900000000000034, -50.00000000000044, 1.299999999999578, 39.300000000000026, 33.90000000000004, 44.7, 44.10000000000001, -50.00000000000044, 36.30000000000003, 4.299999999999621, 38.300000000000026, -50.00000000000044, 20.299999999999848, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 10.899999999999714, 35.500000000000036, 30.499999999999993, 36.900000000000034, 14.299999999999763, 45.7, 42.70000000000001, 8.299999999999677, -50.00000000000044, 12.899999999999743, 36.900000000000034, -50.00000000000044, 37.70000000000003, 39.70000000000002, 42.70000000000001, -50.00000000000044, 31.1, 41.30000000000001, 34.50000000000004, 39.90000000000002, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 13.299999999999748, 4.299999999999621, 39.10000000000002, 35.10000000000004, 29.69999999999998, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.49999999999985, 0.49999999999956657, -50.00000000000044, 31.900000000000013, 36.70000000000003, -50.00000000000044, 43.50000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.5, 26.09999999999993], "episode_lengths": [100, 40, 126, 74, 100, 86, 88, 92, 108, 108, 500, 82, 60, 500, 176, 130, 238, 70, 500, 144, 246, 500, 82, 500, 326, 278, 500, 300, 142, 500, 488, 108, 162, 54, 60, 500, 138, 458, 118, 500, 298, 90, 500, 500, 500, 500, 48, 500, 500, 392, 146, 196, 132, 358, 44, 74, 418, 500, 372, 132, 500, 124, 104, 74, 500, 190, 88, 156, 102, 100, 64, 500, 500, 138, 48, 500, 368, 458, 110, 150, 204, 82, 74, 500, 500, 500, 88, 296, 496, 500, 182, 134, 500, 66, 330, 500, 500, 166, 46, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38522218354056825, "mean_inference_ms": 1.233976587769121, "mean_action_processing_ms": 0.1465520038076189, "mean_env_wait_ms": 0.08668698326830468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997379302978516, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.10498571395874023}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.911999999999843, "episode_len_mean": 261.6, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, 46.099999999999994, 37.50000000000003, 42.70000000000001, 40.10000000000002, 41.500000000000014, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.300000000000026, -50.00000000000044, 41.90000000000001, 44.10000000000001, -50.00000000000044, 32.50000000000002, 37.10000000000003, 26.299999999999933, 43.10000000000001, -50.00000000000044, 35.70000000000003, 25.499999999999922, -50.00000000000044, 41.90000000000001, -50.00000000000044, 17.499999999999808, 22.299999999999876, -50.00000000000044, 20.099999999999845, 35.900000000000034, -50.00000000000044, 1.299999999999578, 39.300000000000026, 33.90000000000004, 44.7, 44.10000000000001, -50.00000000000044, 36.30000000000003, 4.299999999999621, 38.300000000000026, -50.00000000000044, 20.299999999999848, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 10.899999999999714, 35.500000000000036, 30.499999999999993, 36.900000000000034, 14.299999999999763, 45.7, 42.70000000000001, 8.299999999999677, -50.00000000000044, 12.899999999999743, 36.900000000000034, -50.00000000000044, 37.70000000000003, 39.70000000000002, 42.70000000000001, -50.00000000000044, 31.1, 41.30000000000001, 34.50000000000004, 39.90000000000002, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 13.299999999999748, 4.299999999999621, 39.10000000000002, 35.10000000000004, 29.69999999999998, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.49999999999985, 0.49999999999956657, -50.00000000000044, 31.900000000000013, 36.70000000000003, -50.00000000000044, 43.50000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.5, 26.09999999999993], "episode_lengths": [100, 40, 126, 74, 100, 86, 88, 92, 108, 108, 500, 82, 60, 500, 176, 130, 238, 70, 500, 144, 246, 500, 82, 500, 326, 278, 500, 300, 142, 500, 488, 108, 162, 54, 60, 500, 138, 458, 118, 500, 298, 90, 500, 500, 500, 500, 48, 500, 500, 392, 146, 196, 132, 358, 44, 74, 418, 500, 372, 132, 500, 124, 104, 74, 500, 190, 88, 156, 102, 100, 64, 500, 500, 138, 48, 500, 368, 458, 110, 150, 204, 82, 74, 500, 500, 500, 88, 296, 496, 500, 182, 134, 500, 66, 330, 500, 500, 166, 46, 240]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38522218354056825, "mean_inference_ms": 1.233976587769121, "mean_action_processing_ms": 0.1465520038076189, "mean_env_wait_ms": 0.08668698326830468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997379302978516, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.10498571395874023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5825.243329718733, "num_env_steps_trained_throughput_per_sec": 5825.243329718733, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3216.87, "sample_time_ms": 2883.913, "load_time_ms": 17.51, "load_throughput": 1027994.69, "learn_time_ms": 304.452, "learn_throughput": 59122.554, "synch_weights_time_ms": 9.828}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 336, "training_iteration": 6, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-48", "timestamp": 1698245328, "time_this_iter_s": 3.095029830932617, "time_total_s": 19.332239151000977, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.332239151000977, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.64, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 7.889631589253743, "policy_loss": -0.00016150789128409492, "vf_loss": 7.889850033654107, "vf_explained_var": 1.6755527920193142e-06, "kl": 0.0017967919445393615, "entropy": 0.6243216549908673, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.309999999999843, "episode_len_mean": 267.58, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 34.50000000000004, 39.90000000000002, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 13.299999999999748, 4.299999999999621, 39.10000000000002, 35.10000000000004, 29.69999999999998, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.49999999999985, 0.49999999999956657, -50.00000000000044, 31.900000000000013, 36.70000000000003, -50.00000000000044, 43.50000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.5, 26.09999999999993, 41.30000000000001, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, 34.50000000000004, 41.90000000000001, -50.00000000000044, 27.299999999999947, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.30000000000004, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.900000000000006, 38.300000000000026, 40.30000000000002, 45.5, 40.70000000000002, -50.00000000000044, 7.899999999999672, 30.699999999999996, 36.30000000000003, -50.00000000000044, 33.10000000000003, 41.500000000000014, 34.10000000000004, 36.70000000000003, 43.10000000000001, 33.30000000000003, 44.7, -50.00000000000044, 35.70000000000003, 39.10000000000002, 16.29999999999979, 38.700000000000024, 37.70000000000003, 40.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 28.89999999999997, 26.09999999999993, 41.70000000000002, 25.699999999999925, -50.00000000000044, 33.10000000000003, 29.49999999999998, 45.1, 27.699999999999953], "episode_lengths": [88, 156, 102, 100, 64, 500, 500, 138, 48, 500, 368, 458, 110, 150, 204, 82, 74, 500, 500, 500, 88, 296, 496, 500, 182, 134, 500, 66, 330, 500, 500, 166, 46, 240, 88, 98, 500, 94, 500, 500, 84, 500, 500, 192, 500, 500, 500, 316, 500, 156, 82, 500, 228, 116, 500, 500, 52, 158, 500, 500, 216, 500, 62, 118, 98, 46, 94, 500, 422, 194, 138, 500, 170, 86, 160, 134, 70, 168, 54, 500, 144, 110, 338, 114, 124, 96, 106, 500, 500, 500, 216, 212, 240, 84, 244, 500, 170, 206, 50, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814113349802527, "mean_inference_ms": 1.2179947894937961, "mean_action_processing_ms": 0.14483859833061988, "mean_env_wait_ms": 0.08581714074553946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988080978393555, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.11703109741210938}}, "episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.309999999999843, "episode_len_mean": 267.58, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 34.50000000000004, 39.90000000000002, 40.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 45.3, -50.00000000000044, 13.299999999999748, 4.299999999999621, 39.10000000000002, 35.10000000000004, 29.69999999999998, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 20.49999999999985, 0.49999999999956657, -50.00000000000044, 31.900000000000013, 36.70000000000003, -50.00000000000044, 43.50000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.5, 26.09999999999993, 41.30000000000001, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, 34.50000000000004, 41.90000000000001, -50.00000000000044, 27.299999999999947, 38.50000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.30000000000004, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.900000000000006, 38.300000000000026, 40.30000000000002, 45.5, 40.70000000000002, -50.00000000000044, 7.899999999999672, 30.699999999999996, 36.30000000000003, -50.00000000000044, 33.10000000000003, 41.500000000000014, 34.10000000000004, 36.70000000000003, 43.10000000000001, 33.30000000000003, 44.7, -50.00000000000044, 35.70000000000003, 39.10000000000002, 16.29999999999979, 38.700000000000024, 37.70000000000003, 40.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 28.89999999999997, 26.09999999999993, 41.70000000000002, 25.699999999999925, -50.00000000000044, 33.10000000000003, 29.49999999999998, 45.1, 27.699999999999953], "episode_lengths": [88, 156, 102, 100, 64, 500, 500, 138, 48, 500, 368, 458, 110, 150, 204, 82, 74, 500, 500, 500, 88, 296, 496, 500, 182, 134, 500, 66, 330, 500, 500, 166, 46, 240, 88, 98, 500, 94, 500, 500, 84, 500, 500, 192, 500, 500, 500, 316, 500, 156, 82, 500, 228, 116, 500, 500, 52, 158, 500, 500, 216, 500, 62, 118, 98, 46, 94, 500, 422, 194, 138, 500, 170, 86, 160, 134, 70, 168, 54, 500, 144, 110, 338, 114, 124, 96, 106, 500, 500, 500, 216, 212, 240, 84, 244, 500, 170, 206, 50, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3814113349802527, "mean_inference_ms": 1.2179947894937961, "mean_action_processing_ms": 0.14483859833061988, "mean_env_wait_ms": 0.08581714074553946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022988080978393555, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.11703109741210938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5853.717902137136, "num_env_steps_trained_throughput_per_sec": 5853.717902137136, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3196.598, "sample_time_ms": 2860.921, "load_time_ms": 17.865, "load_throughput": 1007536.865, "learn_time_ms": 306.964, "learn_throughput": 58638.859, "synch_weights_time_ms": 9.563}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 402, "training_iteration": 7, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-51", "timestamp": 1698245331, "time_this_iter_s": 3.079967498779297, "time_total_s": 22.412206649780273, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.412206649780273, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 60.525, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 7.553502118145978, "policy_loss": -0.0010759797361161974, "vf_loss": 7.554638103202537, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.0026805452286124717, "entropy": 0.6419081687927246, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.287999999999876, "episode_len_mean": 237.9, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 33.30000000000003, 44.7, -50.00000000000044, 35.70000000000003, 39.10000000000002, 16.29999999999979, 38.700000000000024, 37.70000000000003, 40.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 28.89999999999997, 26.09999999999993, 41.70000000000002, 25.699999999999925, -50.00000000000044, 33.10000000000003, 29.49999999999998, 45.1, 27.699999999999953, -50.00000000000044, 39.50000000000002, 41.30000000000001, 32.30000000000002, -50.00000000000044, 39.50000000000002, 45.9, 31.300000000000004, 3.2999999999996064, 28.699999999999967, 16.09999999999979, 35.10000000000004, 33.90000000000004, 44.10000000000001, 9.299999999999692, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.50000000000003, 37.70000000000003, 23.29999999999989, 40.500000000000014, 35.30000000000004, 34.50000000000004, 29.099999999999973, 43.900000000000006, 34.30000000000004, 8.699999999999683, 46.099999999999994, 43.10000000000001, 41.100000000000016, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 19.09999999999983, 42.900000000000006, 46.099999999999994, 45.9, 25.499999999999922, 4.299999999999621, 40.500000000000014, 42.70000000000001, 23.099999999999888, 37.70000000000003, -50.00000000000044, 35.70000000000003, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 30.9, 37.70000000000003, 36.30000000000003, 8.299999999999677, 16.499999999999794, -50.00000000000044, 21.09999999999986, 43.30000000000001, 44.10000000000001, 10.499999999999709, 38.700000000000024, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044], "episode_lengths": [70, 168, 54, 500, 144, 110, 338, 114, 124, 96, 106, 500, 500, 500, 216, 212, 240, 84, 244, 500, 170, 206, 50, 224, 500, 106, 88, 178, 500, 106, 42, 188, 468, 214, 340, 150, 162, 60, 408, 78, 500, 500, 100, 116, 124, 268, 96, 148, 156, 210, 62, 158, 414, 40, 70, 90, 500, 66, 500, 160, 500, 500, 78, 500, 310, 72, 40, 42, 246, 458, 96, 74, 270, 124, 500, 144, 54, 66, 500, 500, 70, 192, 124, 138, 418, 336, 500, 290, 68, 60, 396, 114, 500, 500, 134, 136, 270, 500, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37883844597535843, "mean_inference_ms": 1.2089763020226263, "mean_action_processing_ms": 0.14404059271010375, "mean_env_wait_ms": 0.08575460224987279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03197884559631348, "StateBufferConnector_ms": 0.002017498016357422, "ViewRequirementAgentConnector_ms": 0.11398148536682129}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.287999999999876, "episode_len_mean": 237.9, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 33.30000000000003, 44.7, -50.00000000000044, 35.70000000000003, 39.10000000000002, 16.29999999999979, 38.700000000000024, 37.70000000000003, 40.500000000000014, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 28.89999999999997, 26.09999999999993, 41.70000000000002, 25.699999999999925, -50.00000000000044, 33.10000000000003, 29.49999999999998, 45.1, 27.699999999999953, -50.00000000000044, 39.50000000000002, 41.30000000000001, 32.30000000000002, -50.00000000000044, 39.50000000000002, 45.9, 31.300000000000004, 3.2999999999996064, 28.699999999999967, 16.09999999999979, 35.10000000000004, 33.90000000000004, 44.10000000000001, 9.299999999999692, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 38.50000000000003, 37.70000000000003, 23.29999999999989, 40.500000000000014, 35.30000000000004, 34.50000000000004, 29.099999999999973, 43.900000000000006, 34.30000000000004, 8.699999999999683, 46.099999999999994, 43.10000000000001, 41.100000000000016, -50.00000000000044, 43.50000000000001, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 19.09999999999983, 42.900000000000006, 46.099999999999994, 45.9, 25.499999999999922, 4.299999999999621, 40.500000000000014, 42.70000000000001, 23.099999999999888, 37.70000000000003, -50.00000000000044, 35.70000000000003, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 30.9, 37.70000000000003, 36.30000000000003, 8.299999999999677, 16.499999999999794, -50.00000000000044, 21.09999999999986, 43.30000000000001, 44.10000000000001, 10.499999999999709, 38.700000000000024, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044], "episode_lengths": [70, 168, 54, 500, 144, 110, 338, 114, 124, 96, 106, 500, 500, 500, 216, 212, 240, 84, 244, 500, 170, 206, 50, 224, 500, 106, 88, 178, 500, 106, 42, 188, 468, 214, 340, 150, 162, 60, 408, 78, 500, 500, 100, 116, 124, 268, 96, 148, 156, 210, 62, 158, 414, 40, 70, 90, 500, 66, 500, 160, 500, 500, 78, 500, 310, 72, 40, 42, 246, 458, 96, 74, 270, 124, 500, 144, 54, 66, 500, 500, 70, 192, 124, 138, 418, 336, 500, 290, 68, 60, 396, 114, 500, 500, 134, 136, 270, 500, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37883844597535843, "mean_inference_ms": 1.2089763020226263, "mean_action_processing_ms": 0.14404059271010375, "mean_env_wait_ms": 0.08575460224987279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03197884559631348, "StateBufferConnector_ms": 0.002017498016357422, "ViewRequirementAgentConnector_ms": 0.11398148536682129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5696.255239409929, "num_env_steps_trained_throughput_per_sec": 5696.255239409929, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3192.02, "sample_time_ms": 2851.052, "load_time_ms": 18.382, "load_throughput": 979219.704, "learn_time_ms": 311.847, "learn_throughput": 57720.563, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 478, "training_iteration": 8, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-54", "timestamp": 1698245334, "time_this_iter_s": 3.164971113204956, "time_total_s": 25.57717776298523, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.57717776298523, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.58, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 7.877919338367604, "policy_loss": -0.0002482398585588844, "vf_loss": 7.878230253855388, "vf_explained_var": -1.567381399649161e-06, "kl": 0.0009273688116793353, "entropy": 0.6317005521721311, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.592999999999869, "episode_len_mean": 239.84, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 30.9, 37.70000000000003, 36.30000000000003, 8.299999999999677, 16.499999999999794, -50.00000000000044, 21.09999999999986, 43.30000000000001, 44.10000000000001, 10.499999999999709, 38.700000000000024, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 24.69999999999991, 14.899999999999771, 42.10000000000001, -50.00000000000044, 43.7, 44.300000000000004, 40.10000000000002, 43.900000000000006, -50.00000000000044, 2.299999999999592, 39.300000000000026, 38.50000000000003, 19.299999999999834, 38.50000000000003, -50.00000000000044, 38.50000000000003, 37.300000000000026, 13.099999999999746, 45.7, -50.00000000000044, 38.10000000000002, 34.50000000000004, 42.10000000000001, 14.899999999999771, 45.1, 6.699999999999655, 36.50000000000003, 42.500000000000014, -50.00000000000044, 42.70000000000001, 42.30000000000001, 33.70000000000004, 41.30000000000001, -50.00000000000044, 38.700000000000024, 37.70000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.30000000000001, -50.00000000000044, 41.70000000000002, 32.700000000000024, 41.500000000000014, 28.499999999999964, 17.69999999999981, -50.00000000000044, 36.30000000000003, 14.499999999999766, 36.900000000000034, 45.5, 34.30000000000004, 42.10000000000001, 26.09999999999993, 35.30000000000004, -50.00000000000044, 45.7, 43.7, 43.7, 43.10000000000001, -50.00000000000044, 2.0999999999995893, 4.899999999999629, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 42.70000000000001, 25.899999999999928, 38.90000000000002, 43.50000000000001, 28.89999999999997, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 70, 192, 124, 138, 418, 336, 500, 290, 68, 60, 396, 114, 500, 500, 134, 136, 270, 500, 134, 500, 254, 352, 80, 500, 64, 58, 100, 62, 500, 478, 108, 116, 308, 116, 500, 116, 128, 370, 44, 500, 120, 156, 80, 352, 50, 434, 136, 76, 500, 74, 78, 164, 88, 500, 114, 124, 90, 500, 500, 206, 78, 500, 84, 174, 86, 216, 324, 500, 138, 356, 132, 46, 158, 80, 240, 148, 500, 44, 64, 64, 70, 500, 480, 452, 500, 32, 500, 54, 74, 242, 112, 66, 212, 76, 500, 122, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781966399804928, "mean_inference_ms": 1.2054196343598174, "mean_action_processing_ms": 0.14249732233124354, "mean_env_wait_ms": 0.08558338468197435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.0999913215637207}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.592999999999869, "episode_len_mean": 239.84, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 30.9, 37.70000000000003, 36.30000000000003, 8.299999999999677, 16.499999999999794, -50.00000000000044, 21.09999999999986, 43.30000000000001, 44.10000000000001, 10.499999999999709, 38.700000000000024, -50.00000000000044, -50.00000000000044, 36.70000000000003, 36.50000000000003, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 24.69999999999991, 14.899999999999771, 42.10000000000001, -50.00000000000044, 43.7, 44.300000000000004, 40.10000000000002, 43.900000000000006, -50.00000000000044, 2.299999999999592, 39.300000000000026, 38.50000000000003, 19.299999999999834, 38.50000000000003, -50.00000000000044, 38.50000000000003, 37.300000000000026, 13.099999999999746, 45.7, -50.00000000000044, 38.10000000000002, 34.50000000000004, 42.10000000000001, 14.899999999999771, 45.1, 6.699999999999655, 36.50000000000003, 42.500000000000014, -50.00000000000044, 42.70000000000001, 42.30000000000001, 33.70000000000004, 41.30000000000001, -50.00000000000044, 38.700000000000024, 37.70000000000003, 41.100000000000016, -50.00000000000044, -50.00000000000044, 29.49999999999998, 42.30000000000001, -50.00000000000044, 41.70000000000002, 32.700000000000024, 41.500000000000014, 28.499999999999964, 17.69999999999981, -50.00000000000044, 36.30000000000003, 14.499999999999766, 36.900000000000034, 45.5, 34.30000000000004, 42.10000000000001, 26.09999999999993, 35.30000000000004, -50.00000000000044, 45.7, 43.7, 43.7, 43.10000000000001, -50.00000000000044, 2.0999999999995893, 4.899999999999629, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 42.70000000000001, 25.899999999999928, 38.90000000000002, 43.50000000000001, 28.89999999999997, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 70, 192, 124, 138, 418, 336, 500, 290, 68, 60, 396, 114, 500, 500, 134, 136, 270, 500, 134, 500, 254, 352, 80, 500, 64, 58, 100, 62, 500, 478, 108, 116, 308, 116, 500, 116, 128, 370, 44, 500, 120, 156, 80, 352, 50, 434, 136, 76, 500, 74, 78, 164, 88, 500, 114, 124, 90, 500, 500, 206, 78, 500, 84, 174, 86, 216, 324, 500, 138, 356, 132, 46, 158, 80, 240, 148, 500, 44, 64, 64, 70, 500, 480, 452, 500, 32, 500, 54, 74, 242, 112, 66, 212, 76, 500, 122, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781966399804928, "mean_inference_ms": 1.2054196343598174, "mean_action_processing_ms": 0.14249732233124354, "mean_env_wait_ms": 0.08558338468197435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699875831604004, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.0999913215637207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5815.887487542606, "num_env_steps_trained_throughput_per_sec": 5815.887487542606, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3181.236, "sample_time_ms": 2839.821, "load_time_ms": 17.562, "load_throughput": 1024959.231, "learn_time_ms": 313.198, "learn_throughput": 57471.698, "synch_weights_time_ms": 9.434}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 557, "training_iteration": 9, "trial_id": "9f288_00004", "date": "2023-10-25_15-48-58", "timestamp": 1698245338, "time_this_iter_s": 3.100970506668091, "time_total_s": 28.67814826965332, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.67814826965332, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 65.075, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 7.337645848592122, "policy_loss": -2.3577914193824484e-05, "vf_loss": 7.3377291538097245, "vf_explained_var": -2.9007593790690103e-06, "kl": 0.0002457125719788396, "entropy": 0.5972637666596307, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.691999999999862, "episode_len_mean": 233.82, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 43.10000000000001, -50.00000000000044, 2.0999999999995893, 4.899999999999629, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 42.70000000000001, 25.899999999999928, 38.90000000000002, 43.50000000000001, 28.89999999999997, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.70000000000001, 37.10000000000003, 36.10000000000004, 35.30000000000004, 7.499999999999666, -50.00000000000044, 12.899999999999743, -50.00000000000044, 41.90000000000001, 38.90000000000002, 40.70000000000002, 41.30000000000001, 44.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 35.900000000000034, -50.00000000000044, 38.10000000000002, 42.900000000000006, 39.90000000000002, 6.099999999999646, 45.3, 35.30000000000004, 9.499999999999694, 46.3, 41.70000000000002, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 39.50000000000002, -50.00000000000044, 44.900000000000006, 45.7, 42.500000000000014, 39.70000000000002, 41.100000000000016, 43.50000000000001, -50.00000000000044, 38.300000000000026, 29.69999999999998, 39.90000000000002, 39.90000000000002, -50.00000000000044, 37.50000000000003, 36.900000000000034, 37.90000000000003, 41.100000000000016, 45.7, -50.00000000000044, 16.29999999999979, 33.30000000000003, 28.89999999999997, 41.70000000000002, -50.00000000000044, 22.899999999999885, 20.099999999999845, 33.10000000000003, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 12.899999999999743, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, 38.300000000000026, 17.299999999999805, -50.00000000000044, 42.500000000000014, 43.10000000000001], "episode_lengths": [64, 70, 500, 480, 452, 500, 32, 500, 54, 74, 242, 112, 66, 212, 76, 500, 122, 500, 500, 84, 74, 130, 140, 148, 426, 500, 372, 500, 82, 112, 94, 88, 52, 500, 62, 500, 500, 500, 140, 142, 500, 120, 72, 102, 440, 48, 148, 406, 38, 84, 30, 102, 500, 500, 52, 60, 106, 500, 52, 44, 76, 104, 90, 66, 500, 118, 204, 102, 102, 500, 126, 132, 122, 90, 44, 500, 338, 168, 212, 84, 500, 272, 300, 170, 500, 56, 58, 500, 372, 500, 108, 500, 66, 500, 104, 118, 328, 500, 76, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37990119254549176, "mean_inference_ms": 1.2071743008912106, "mean_action_processing_ms": 0.14292389570063357, "mean_env_wait_ms": 0.08577473194165659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600264549255371, "StateBufferConnector_ms": 0.005005359649658203, "ViewRequirementAgentConnector_ms": 0.10898566246032715}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.691999999999862, "episode_len_mean": 233.82, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 43.10000000000001, -50.00000000000044, 2.0999999999995893, 4.899999999999629, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 42.70000000000001, 25.899999999999928, 38.90000000000002, 43.50000000000001, 28.89999999999997, 42.500000000000014, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, 42.70000000000001, 37.10000000000003, 36.10000000000004, 35.30000000000004, 7.499999999999666, -50.00000000000044, 12.899999999999743, -50.00000000000044, 41.90000000000001, 38.90000000000002, 40.70000000000002, 41.30000000000001, 44.900000000000006, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 35.900000000000034, -50.00000000000044, 38.10000000000002, 42.900000000000006, 39.90000000000002, 6.099999999999646, 45.3, 35.30000000000004, 9.499999999999694, 46.3, 41.70000000000002, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 39.50000000000002, -50.00000000000044, 44.900000000000006, 45.7, 42.500000000000014, 39.70000000000002, 41.100000000000016, 43.50000000000001, -50.00000000000044, 38.300000000000026, 29.69999999999998, 39.90000000000002, 39.90000000000002, -50.00000000000044, 37.50000000000003, 36.900000000000034, 37.90000000000003, 41.100000000000016, 45.7, -50.00000000000044, 16.29999999999979, 33.30000000000003, 28.89999999999997, 41.70000000000002, -50.00000000000044, 22.899999999999885, 20.099999999999845, 33.10000000000003, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 12.899999999999743, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, 38.300000000000026, 17.299999999999805, -50.00000000000044, 42.500000000000014, 43.10000000000001], "episode_lengths": [64, 70, 500, 480, 452, 500, 32, 500, 54, 74, 242, 112, 66, 212, 76, 500, 122, 500, 500, 84, 74, 130, 140, 148, 426, 500, 372, 500, 82, 112, 94, 88, 52, 500, 62, 500, 500, 500, 140, 142, 500, 120, 72, 102, 440, 48, 148, 406, 38, 84, 30, 102, 500, 500, 52, 60, 106, 500, 52, 44, 76, 104, 90, 66, 500, 118, 204, 102, 102, 500, 126, 132, 122, 90, 44, 500, 338, 168, 212, 84, 500, 272, 300, 170, 500, 56, 58, 500, 372, 500, 108, 500, 66, 500, 104, 118, 328, 500, 76, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37990119254549176, "mean_inference_ms": 1.2071743008912106, "mean_action_processing_ms": 0.14292389570063357, "mean_env_wait_ms": 0.08577473194165659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600264549255371, "StateBufferConnector_ms": 0.005005359649658203, "ViewRequirementAgentConnector_ms": 0.10898566246032715}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5476.117742069554, "num_env_steps_trained_throughput_per_sec": 5476.117742069554, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3191.813, "sample_time_ms": 2848.339, "load_time_ms": 18.005, "load_throughput": 999696.4, "learn_time_ms": 314.981, "learn_throughput": 57146.251, "synch_weights_time_ms": 9.288}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 637, "training_iteration": 10, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-01", "timestamp": 1698245341, "time_this_iter_s": 3.2940025329589844, "time_total_s": 31.972150802612305, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 31.972150802612305, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 57.9, "ram_util_percent": 27.380000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 7.651318285200331, "policy_loss": -0.00010963432766773083, "vf_loss": 7.651489664007117, "vf_explained_var": -9.779576902036314e-07, "kl": 0.0009752040993918046, "entropy": 0.6173197306968548, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 284.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.897999999999879, "episode_len_mean": 231.78, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.899999999999885, 20.099999999999845, 33.10000000000003, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 12.899999999999743, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, 38.300000000000026, 17.299999999999805, -50.00000000000044, 42.500000000000014, 43.10000000000001, -50.00000000000044, 22.49999999999988, 37.300000000000026, 35.30000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 45.9, 36.900000000000034, 42.30000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 26.299999999999933, 41.70000000000002, 36.50000000000003, 39.90000000000002, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 2.299999999999592, 31.500000000000007, 41.90000000000001, 27.299999999999947, 15.099999999999774, 39.70000000000002, 38.50000000000003, 17.69999999999981, 30.499999999999993, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 41.30000000000001, 29.099999999999973, 41.500000000000014, 43.30000000000001, -50.00000000000044, 38.50000000000003, 42.30000000000001, 1.299999999999578, -50.00000000000044, 39.90000000000002, 37.300000000000026, 43.10000000000001, 45.3, 25.699999999999925, 33.30000000000003, -50.00000000000044, 40.500000000000014, 46.699999999999996, 42.10000000000001, 37.50000000000003, 45.5, -50.00000000000044, 45.1, 34.50000000000004, 37.70000000000003, 41.70000000000002, 42.900000000000006, 41.70000000000002, 39.50000000000002, 19.299999999999834, 44.5, -50.00000000000044, 40.30000000000002, 32.50000000000002, 35.70000000000003, 35.500000000000036, 45.5, 40.70000000000002, 41.90000000000001, 21.299999999999862, 44.7], "episode_lengths": [500, 272, 300, 170, 500, 56, 58, 500, 372, 500, 108, 500, 66, 500, 104, 118, 328, 500, 76, 70, 500, 276, 128, 148, 62, 500, 500, 54, 42, 132, 78, 158, 500, 500, 500, 296, 238, 84, 136, 102, 318, 500, 500, 500, 148, 478, 186, 82, 228, 350, 104, 116, 324, 196, 76, 500, 500, 500, 96, 88, 210, 86, 68, 500, 116, 78, 488, 500, 102, 128, 70, 48, 244, 168, 500, 96, 34, 80, 126, 46, 500, 50, 156, 124, 84, 72, 84, 106, 308, 56, 500, 98, 176, 144, 146, 46, 94, 82, 288, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794416291101821, "mean_inference_ms": 1.2060406127077337, "mean_action_processing_ms": 0.1424238366499687, "mean_env_wait_ms": 0.08534291709458884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701019287109375, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.09900593757629395}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.897999999999879, "episode_len_mean": 231.78, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 22.899999999999885, 20.099999999999845, 33.10000000000003, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 12.899999999999743, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, -50.00000000000044, 39.70000000000002, 38.300000000000026, 17.299999999999805, -50.00000000000044, 42.500000000000014, 43.10000000000001, -50.00000000000044, 22.49999999999988, 37.300000000000026, 35.30000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 45.9, 36.900000000000034, 42.30000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 26.299999999999933, 41.70000000000002, 36.50000000000003, 39.90000000000002, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 2.299999999999592, 31.500000000000007, 41.90000000000001, 27.299999999999947, 15.099999999999774, 39.70000000000002, 38.50000000000003, 17.69999999999981, 30.499999999999993, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 41.30000000000001, 29.099999999999973, 41.500000000000014, 43.30000000000001, -50.00000000000044, 38.50000000000003, 42.30000000000001, 1.299999999999578, -50.00000000000044, 39.90000000000002, 37.300000000000026, 43.10000000000001, 45.3, 25.699999999999925, 33.30000000000003, -50.00000000000044, 40.500000000000014, 46.699999999999996, 42.10000000000001, 37.50000000000003, 45.5, -50.00000000000044, 45.1, 34.50000000000004, 37.70000000000003, 41.70000000000002, 42.900000000000006, 41.70000000000002, 39.50000000000002, 19.299999999999834, 44.5, -50.00000000000044, 40.30000000000002, 32.50000000000002, 35.70000000000003, 35.500000000000036, 45.5, 40.70000000000002, 41.90000000000001, 21.299999999999862, 44.7], "episode_lengths": [500, 272, 300, 170, 500, 56, 58, 500, 372, 500, 108, 500, 66, 500, 104, 118, 328, 500, 76, 70, 500, 276, 128, 148, 62, 500, 500, 54, 42, 132, 78, 158, 500, 500, 500, 296, 238, 84, 136, 102, 318, 500, 500, 500, 148, 478, 186, 82, 228, 350, 104, 116, 324, 196, 76, 500, 500, 500, 96, 88, 210, 86, 68, 500, 116, 78, 488, 500, 102, 128, 70, 48, 244, 168, 500, 96, 34, 80, 126, 46, 500, 50, 156, 124, 84, 72, 84, 106, 308, 56, 500, 98, 176, 144, 146, 46, 94, 82, 288, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794416291101821, "mean_inference_ms": 1.2060406127077337, "mean_action_processing_ms": 0.1424238366499687, "mean_env_wait_ms": 0.08534291709458884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701019287109375, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.09900593757629395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5626.755215133333, "num_env_steps_trained_throughput_per_sec": 5626.755215133333, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3168.613, "sample_time_ms": 2810.439, "load_time_ms": 19.005, "load_throughput": 947100.733, "learn_time_ms": 328.781, "learn_throughput": 54747.624, "synch_weights_time_ms": 9.088}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 717, "training_iteration": 11, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-04", "timestamp": 1698245344, "time_this_iter_s": 3.204000473022461, "time_total_s": 35.176151275634766, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.176151275634766, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 66.375, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 7.204043635615596, "policy_loss": -0.0006157659270145275, "vf_loss": 7.204721274199309, "vf_explained_var": 5.739706533926505e-07, "kl": 0.0013005192392347821, "entropy": 0.6195667761343496, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.485999999999875, "episode_len_mean": 225.9, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 25.699999999999925, 33.30000000000003, -50.00000000000044, 40.500000000000014, 46.699999999999996, 42.10000000000001, 37.50000000000003, 45.5, -50.00000000000044, 45.1, 34.50000000000004, 37.70000000000003, 41.70000000000002, 42.900000000000006, 41.70000000000002, 39.50000000000002, 19.299999999999834, 44.5, -50.00000000000044, 40.30000000000002, 32.50000000000002, 35.70000000000003, 35.500000000000036, 45.5, 40.70000000000002, 41.90000000000001, 21.299999999999862, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.5, 41.70000000000002, 37.300000000000026, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.9, 33.500000000000036, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 40.90000000000002, 35.30000000000004, 31.500000000000007, 41.30000000000001, 28.699999999999967, -50.00000000000044, 44.10000000000001, 41.100000000000016, 43.30000000000001, 44.7, 33.70000000000004, 43.900000000000006, 6.299999999999649, 33.30000000000003, 29.899999999999984, 41.70000000000002, -50.00000000000044, 28.89999999999997, 45.7, 39.10000000000002, -50.00000000000044, 39.50000000000002, 36.10000000000004, 44.10000000000001, 10.499999999999709, 44.900000000000006, 39.50000000000002, 42.70000000000001, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 17.499999999999808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 18.699999999999825, 44.5, 44.7, 44.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.50000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 9.699999999999697, 37.90000000000003, 8.099999999999675], "episode_lengths": [48, 244, 168, 500, 96, 34, 80, 126, 46, 500, 50, 156, 124, 84, 72, 84, 106, 308, 56, 500, 98, 176, 144, 146, 46, 94, 82, 288, 54, 66, 500, 500, 132, 56, 84, 128, 384, 500, 500, 42, 166, 500, 500, 148, 500, 92, 148, 186, 88, 214, 500, 60, 90, 68, 54, 164, 62, 438, 168, 202, 84, 500, 212, 44, 110, 500, 106, 140, 60, 396, 52, 106, 74, 500, 472, 500, 500, 326, 60, 500, 500, 314, 56, 54, 56, 142, 500, 500, 130, 106, 134, 500, 500, 60, 500, 100, 500, 404, 122, 420]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795281159867553, "mean_inference_ms": 1.2034275175197913, "mean_action_processing_ms": 0.14179455543805392, "mean_env_wait_ms": 0.08499032262894769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501368522644043, "StateBufferConnector_ms": 0.010004281997680664, "ViewRequirementAgentConnector_ms": 0.1119835376739502}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.485999999999875, "episode_len_mean": 225.9, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 25.699999999999925, 33.30000000000003, -50.00000000000044, 40.500000000000014, 46.699999999999996, 42.10000000000001, 37.50000000000003, 45.5, -50.00000000000044, 45.1, 34.50000000000004, 37.70000000000003, 41.70000000000002, 42.900000000000006, 41.70000000000002, 39.50000000000002, 19.299999999999834, 44.5, -50.00000000000044, 40.30000000000002, 32.50000000000002, 35.70000000000003, 35.500000000000036, 45.5, 40.70000000000002, 41.90000000000001, 21.299999999999862, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.5, 41.70000000000002, 37.300000000000026, 11.699999999999726, -50.00000000000044, -50.00000000000044, 45.9, 33.500000000000036, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 40.90000000000002, 35.30000000000004, 31.500000000000007, 41.30000000000001, 28.699999999999967, -50.00000000000044, 44.10000000000001, 41.100000000000016, 43.30000000000001, 44.7, 33.70000000000004, 43.900000000000006, 6.299999999999649, 33.30000000000003, 29.899999999999984, 41.70000000000002, -50.00000000000044, 28.89999999999997, 45.7, 39.10000000000002, -50.00000000000044, 39.50000000000002, 36.10000000000004, 44.10000000000001, 10.499999999999709, 44.900000000000006, 39.50000000000002, 42.70000000000001, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 17.499999999999808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 18.699999999999825, 44.5, 44.7, 44.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.50000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 9.699999999999697, 37.90000000000003, 8.099999999999675], "episode_lengths": [48, 244, 168, 500, 96, 34, 80, 126, 46, 500, 50, 156, 124, 84, 72, 84, 106, 308, 56, 500, 98, 176, 144, 146, 46, 94, 82, 288, 54, 66, 500, 500, 132, 56, 84, 128, 384, 500, 500, 42, 166, 500, 500, 148, 500, 92, 148, 186, 88, 214, 500, 60, 90, 68, 54, 164, 62, 438, 168, 202, 84, 500, 212, 44, 110, 500, 106, 140, 60, 396, 52, 106, 74, 500, 472, 500, 500, 326, 60, 500, 500, 314, 56, 54, 56, 142, 500, 500, 130, 106, 134, 500, 500, 60, 500, 100, 500, 404, 122, 420]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3795281159867553, "mean_inference_ms": 1.2034275175197913, "mean_action_processing_ms": 0.14179455543805392, "mean_env_wait_ms": 0.08499032262894769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501368522644043, "StateBufferConnector_ms": 0.010004281997680664, "ViewRequirementAgentConnector_ms": 0.1119835376739502}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5462.819169565796, "num_env_steps_trained_throughput_per_sec": 5462.819169565796, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3173.793, "sample_time_ms": 2804.493, "load_time_ms": 19.508, "load_throughput": 922688.033, "learn_time_ms": 339.305, "learn_throughput": 53049.654, "synch_weights_time_ms": 9.088}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 788, "training_iteration": 12, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-07", "timestamp": 1698245347, "time_this_iter_s": 3.2999987602233887, "time_total_s": 38.476150035858154, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.476150035858154, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 54.52, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.59838017710933, "policy_loss": -0.0003813230605037124, "vf_loss": 6.598818990919325, "vf_explained_var": 1.4437569512261284e-06, "kl": 0.0010425839293806878, "entropy": 0.5757260134926548, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.774999999999813, "episode_len_mean": 277.88, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 39.50000000000002, 36.10000000000004, 44.10000000000001, 10.499999999999709, 44.900000000000006, 39.50000000000002, 42.70000000000001, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 17.499999999999808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 18.699999999999825, 44.5, 44.7, 44.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.50000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 9.699999999999697, 37.90000000000003, 8.099999999999675, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.5, 23.699999999999896, 41.500000000000014, 43.7, 37.300000000000026, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 32.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, 39.10000000000002, 41.500000000000014, 41.500000000000014, 19.69999999999984, -50.00000000000044, -50.00000000000044, 38.90000000000002, 39.90000000000002, 31.900000000000013, -50.00000000000044, 42.30000000000001, 42.900000000000006, 42.900000000000006, 19.499999999999837, 30.099999999999987, 33.500000000000036, -50.00000000000044, 46.3, 6.299999999999649, -50.00000000000044, 1.299999999999578, 44.300000000000004, 39.90000000000002, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 36.900000000000034, 35.30000000000004, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [110, 500, 106, 140, 60, 396, 52, 106, 74, 500, 472, 500, 500, 326, 60, 500, 500, 314, 56, 54, 56, 142, 500, 500, 130, 106, 134, 500, 500, 60, 500, 100, 500, 404, 122, 420, 500, 500, 114, 56, 264, 86, 64, 128, 70, 500, 80, 500, 500, 500, 68, 174, 500, 72, 500, 64, 110, 86, 86, 304, 500, 500, 112, 102, 182, 500, 78, 72, 72, 306, 200, 166, 500, 38, 438, 500, 488, 58, 102, 500, 56, 110, 500, 132, 148, 500, 318, 500, 500, 500, 500, 500, 80, 500, 82, 58, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801211215184007, "mean_inference_ms": 1.2026770510055613, "mean_action_processing_ms": 0.14108496990532363, "mean_env_wait_ms": 0.08439329289762715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299952507019043, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11599516868591309}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.774999999999813, "episode_len_mean": 277.88, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, 39.50000000000002, 36.10000000000004, 44.10000000000001, 10.499999999999709, 44.900000000000006, 39.50000000000002, 42.70000000000001, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 17.499999999999808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 18.699999999999825, 44.5, 44.7, 44.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.50000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, 9.699999999999697, 37.90000000000003, 8.099999999999675, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.5, 23.699999999999896, 41.500000000000014, 43.7, 37.300000000000026, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 32.700000000000024, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, 39.10000000000002, 41.500000000000014, 41.500000000000014, 19.69999999999984, -50.00000000000044, -50.00000000000044, 38.90000000000002, 39.90000000000002, 31.900000000000013, -50.00000000000044, 42.30000000000001, 42.900000000000006, 42.900000000000006, 19.499999999999837, 30.099999999999987, 33.500000000000036, -50.00000000000044, 46.3, 6.299999999999649, -50.00000000000044, 1.299999999999578, 44.300000000000004, 39.90000000000002, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 36.900000000000034, 35.30000000000004, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [110, 500, 106, 140, 60, 396, 52, 106, 74, 500, 472, 500, 500, 326, 60, 500, 500, 314, 56, 54, 56, 142, 500, 500, 130, 106, 134, 500, 500, 60, 500, 100, 500, 404, 122, 420, 500, 500, 114, 56, 264, 86, 64, 128, 70, 500, 80, 500, 500, 500, 68, 174, 500, 72, 500, 64, 110, 86, 86, 304, 500, 500, 112, 102, 182, 500, 78, 72, 72, 306, 200, 166, 500, 38, 438, 500, 488, 58, 102, 500, 56, 110, 500, 132, 148, 500, 318, 500, 500, 500, 500, 500, 80, 500, 82, 58, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801211215184007, "mean_inference_ms": 1.2026770510055613, "mean_action_processing_ms": 0.14108496990532363, "mean_env_wait_ms": 0.08439329289762715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299952507019043, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11599516868591309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5635.567518785543, "num_env_steps_trained_throughput_per_sec": 5635.567518785543, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3171.998, "sample_time_ms": 2804.698, "load_time_ms": 19.808, "load_throughput": 908721.272, "learn_time_ms": 337.105, "learn_throughput": 53395.896, "synch_weights_time_ms": 9.088}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 852, "training_iteration": 13, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-11", "timestamp": 1698245351, "time_this_iter_s": 3.1989994049072266, "time_total_s": 41.67514944076538, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 41.67514944076538, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 63.55, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 7.078014885937726, "policy_loss": -0.00048551160014337965, "vf_loss": 7.078559575257478, "vf_explained_var": -4.172325134277344e-07, "kl": 0.0018120873738022663, "entropy": 0.5922172466913859, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9429999999998047, "episode_len_mean": 286.2, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 31.900000000000013, -50.00000000000044, 42.30000000000001, 42.900000000000006, 42.900000000000006, 19.499999999999837, 30.099999999999987, 33.500000000000036, -50.00000000000044, 46.3, 6.299999999999649, -50.00000000000044, 1.299999999999578, 44.300000000000004, 39.90000000000002, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 36.900000000000034, 35.30000000000004, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.899999999999885, 46.9, 29.899999999999984, 1.4999999999995808, 45.3, 43.7, -50.00000000000044, 17.899999999999814, 44.7, 18.499999999999822, 41.70000000000002, 44.900000000000006, 39.70000000000002, -50.00000000000044, 44.5, 45.3, 4.099999999999618, 32.90000000000003, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 21.09999999999986, 43.30000000000001, 24.099999999999902, -50.00000000000044, 38.90000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 0.2999999999995637, -50.00000000000044, 42.10000000000001, 18.699999999999825, 36.50000000000003, 36.900000000000034, 46.3, 43.30000000000001, 46.099999999999994, 33.500000000000036, -50.00000000000044, 45.1, 35.70000000000003, 5.899999999999643, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 16.8999999999998, -50.00000000000044], "episode_lengths": [102, 182, 500, 78, 72, 72, 306, 200, 166, 500, 38, 438, 500, 488, 58, 102, 500, 56, 110, 500, 132, 148, 500, 318, 500, 500, 500, 500, 500, 80, 500, 82, 58, 500, 64, 500, 500, 500, 96, 500, 272, 32, 202, 486, 48, 64, 500, 322, 54, 316, 84, 52, 104, 500, 56, 48, 460, 172, 500, 130, 500, 500, 290, 68, 260, 500, 112, 80, 500, 500, 500, 40, 498, 500, 80, 314, 136, 132, 38, 68, 40, 166, 500, 50, 144, 442, 500, 500, 180, 500, 500, 500, 96, 96, 500, 500, 500, 110, 332, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38109008162650215, "mean_inference_ms": 1.2040330426782009, "mean_action_processing_ms": 0.14123798810912672, "mean_env_wait_ms": 0.08454207380193669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029986858367919922, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.13700318336486816}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9429999999998047, "episode_len_mean": 286.2, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 31.900000000000013, -50.00000000000044, 42.30000000000001, 42.900000000000006, 42.900000000000006, 19.499999999999837, 30.099999999999987, 33.500000000000036, -50.00000000000044, 46.3, 6.299999999999649, -50.00000000000044, 1.299999999999578, 44.300000000000004, 39.90000000000002, -50.00000000000044, 44.5, 39.10000000000002, -50.00000000000044, 36.900000000000034, 35.30000000000004, -50.00000000000044, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.899999999999885, 46.9, 29.899999999999984, 1.4999999999995808, 45.3, 43.7, -50.00000000000044, 17.899999999999814, 44.7, 18.499999999999822, 41.70000000000002, 44.900000000000006, 39.70000000000002, -50.00000000000044, 44.5, 45.3, 4.099999999999618, 32.90000000000003, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 21.09999999999986, 43.30000000000001, 24.099999999999902, -50.00000000000044, 38.90000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 0.2999999999995637, -50.00000000000044, 42.10000000000001, 18.699999999999825, 36.50000000000003, 36.900000000000034, 46.3, 43.30000000000001, 46.099999999999994, 33.500000000000036, -50.00000000000044, 45.1, 35.70000000000003, 5.899999999999643, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 16.8999999999998, -50.00000000000044], "episode_lengths": [102, 182, 500, 78, 72, 72, 306, 200, 166, 500, 38, 438, 500, 488, 58, 102, 500, 56, 110, 500, 132, 148, 500, 318, 500, 500, 500, 500, 500, 80, 500, 82, 58, 500, 64, 500, 500, 500, 96, 500, 272, 32, 202, 486, 48, 64, 500, 322, 54, 316, 84, 52, 104, 500, 56, 48, 460, 172, 500, 130, 500, 500, 290, 68, 260, 500, 112, 80, 500, 500, 500, 40, 498, 500, 80, 314, 136, 132, 38, 68, 40, 166, 500, 50, 144, 442, 500, 500, 180, 500, 500, 500, 96, 96, 500, 500, 500, 110, 332, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38109008162650215, "mean_inference_ms": 1.2040330426782009, "mean_action_processing_ms": 0.14123798810912672, "mean_env_wait_ms": 0.08454207380193669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029986858367919922, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.13700318336486816}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5459.509152721613, "num_env_steps_trained_throughput_per_sec": 5459.509152721613, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3180.498, "sample_time_ms": 2813.498, "load_time_ms": 19.108, "load_throughput": 942000.427, "learn_time_ms": 337.601, "learn_throughput": 53317.318, "synch_weights_time_ms": 8.991}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 915, "training_iteration": 14, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-14", "timestamp": 1698245354, "time_this_iter_s": 3.3019986152648926, "time_total_s": 44.97714805603027, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.97714805603027, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 59.94, "ram_util_percent": 27.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.980590537742332, "policy_loss": -0.0009144925408893161, "vf_loss": 6.98156213760376, "vf_explained_var": -3.3820116961443866e-06, "kl": 0.0018270236549529659, "entropy": 0.5709657073020935, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 392.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.973999999999847, "episode_len_mean": 250.94, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 36.900000000000034, 46.3, 43.30000000000001, 46.099999999999994, 33.500000000000036, -50.00000000000044, 45.1, 35.70000000000003, 5.899999999999643, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 41.70000000000002, 26.89999999999994, 45.9, 45.3, -50.00000000000044, 44.300000000000004, 40.500000000000014, 40.10000000000002, -50.00000000000044, 40.90000000000002, 37.70000000000003, 36.10000000000004, 45.7, 23.699999999999896, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 45.9, 39.10000000000002, -50.00000000000044, 33.90000000000004, 22.099999999999874, 43.7, -50.00000000000044, 44.7, 42.30000000000001, 34.30000000000004, -50.00000000000044, 14.299999999999763, 38.10000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, 19.69999999999984, 45.9, 40.30000000000002, 23.699999999999896, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 25.699999999999925, 3.699999999999612, 44.7, 33.10000000000003, 45.1, 43.7, 43.7, 31.900000000000013, 40.90000000000002, 34.70000000000004, 41.500000000000014, 36.30000000000003, 38.700000000000024, 34.50000000000004, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, 37.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014], "episode_lengths": [136, 132, 38, 68, 40, 166, 500, 50, 144, 442, 500, 500, 180, 500, 500, 500, 96, 96, 500, 500, 500, 110, 332, 500, 500, 84, 232, 42, 48, 500, 58, 96, 100, 500, 92, 124, 140, 44, 264, 500, 282, 500, 500, 500, 224, 42, 110, 500, 162, 280, 64, 500, 54, 78, 158, 500, 358, 120, 164, 500, 500, 304, 42, 98, 264, 500, 74, 500, 48, 244, 464, 54, 170, 50, 64, 64, 182, 92, 154, 86, 138, 114, 156, 94, 84, 500, 500, 500, 98, 500, 76, 126, 500, 48, 500, 90, 500, 70, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3803765604478009, "mean_inference_ms": 1.2046144676980757, "mean_action_processing_ms": 0.14121049000278713, "mean_env_wait_ms": 0.0846756288734255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025966405868530273, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12400150299072266}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.973999999999847, "episode_len_mean": 250.94, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 36.900000000000034, 46.3, 43.30000000000001, 46.099999999999994, 33.500000000000036, -50.00000000000044, 45.1, 35.70000000000003, 5.899999999999643, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 41.70000000000002, 26.89999999999994, 45.9, 45.3, -50.00000000000044, 44.300000000000004, 40.500000000000014, 40.10000000000002, -50.00000000000044, 40.90000000000002, 37.70000000000003, 36.10000000000004, 45.7, 23.699999999999896, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 45.9, 39.10000000000002, -50.00000000000044, 33.90000000000004, 22.099999999999874, 43.7, -50.00000000000044, 44.7, 42.30000000000001, 34.30000000000004, -50.00000000000044, 14.299999999999763, 38.10000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, 19.69999999999984, 45.9, 40.30000000000002, 23.699999999999896, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 25.699999999999925, 3.699999999999612, 44.7, 33.10000000000003, 45.1, 43.7, 43.7, 31.900000000000013, 40.90000000000002, 34.70000000000004, 41.500000000000014, 36.30000000000003, 38.700000000000024, 34.50000000000004, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, 37.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014], "episode_lengths": [136, 132, 38, 68, 40, 166, 500, 50, 144, 442, 500, 500, 180, 500, 500, 500, 96, 96, 500, 500, 500, 110, 332, 500, 500, 84, 232, 42, 48, 500, 58, 96, 100, 500, 92, 124, 140, 44, 264, 500, 282, 500, 500, 500, 224, 42, 110, 500, 162, 280, 64, 500, 54, 78, 158, 500, 358, 120, 164, 500, 500, 304, 42, 98, 264, 500, 74, 500, 48, 244, 464, 54, 170, 50, 64, 64, 182, 92, 154, 86, 138, 114, 156, 94, 84, 500, 500, 500, 98, 500, 76, 126, 500, 48, 500, 90, 500, 70, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3803765604478009, "mean_inference_ms": 1.2046144676980757, "mean_action_processing_ms": 0.14121049000278713, "mean_env_wait_ms": 0.0846756288734255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025966405868530273, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12400150299072266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5590.057509179478, "num_env_steps_trained_throughput_per_sec": 5590.057509179478, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3191.092, "sample_time_ms": 2817.191, "load_time_ms": 19.005, "load_throughput": 947110.239, "learn_time_ms": 344.604, "learn_throughput": 52233.862, "synch_weights_time_ms": 8.992}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 991, "training_iteration": 15, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-17", "timestamp": 1698245357, "time_this_iter_s": 3.2250008583068848, "time_total_s": 48.20214891433716, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 48.20214891433716, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 61.925000000000004, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.6721025219670045, "policy_loss": -2.2460741025430184e-05, "vf_loss": 6.67217856866342, "vf_explained_var": -2.3886009498878763e-06, "kl": 5.205341027350288e-05, "entropy": 0.5352027361039762, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.560999999999829, "episode_len_mean": 260.04, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.69999999999984, 45.9, 40.30000000000002, 23.699999999999896, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 25.699999999999925, 3.699999999999612, 44.7, 33.10000000000003, 45.1, 43.7, 43.7, 31.900000000000013, 40.90000000000002, 34.70000000000004, 41.500000000000014, 36.30000000000003, 38.700000000000024, 34.50000000000004, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, 37.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 29.69999999999998, 34.900000000000034, 40.10000000000002, 36.900000000000034, -50.00000000000044, 43.7, 27.49999999999995, 23.699999999999896, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, 44.900000000000006, 46.699999999999996, -50.00000000000044, 21.499999999999865, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.099999999999994, -50.00000000000044, 42.30000000000001, 40.70000000000002, 44.7, 41.500000000000014, 44.7, -50.00000000000044, 44.10000000000001, 44.7, 42.500000000000014, 39.90000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 37.50000000000003, 0.09999999999956088, 44.900000000000006, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 8.699999999999683], "episode_lengths": [304, 42, 98, 264, 500, 74, 500, 48, 244, 464, 54, 170, 50, 64, 64, 182, 92, 154, 86, 138, 114, 156, 94, 84, 500, 500, 500, 98, 500, 76, 126, 500, 48, 500, 90, 500, 70, 500, 96, 500, 500, 500, 132, 500, 204, 152, 100, 132, 500, 64, 226, 264, 112, 500, 500, 500, 500, 278, 52, 34, 500, 286, 500, 82, 500, 500, 106, 40, 500, 78, 94, 54, 86, 54, 500, 60, 54, 76, 102, 82, 500, 500, 426, 500, 126, 500, 52, 500, 50, 76, 500, 500, 500, 64, 106, 500, 500, 500, 42, 414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3804924320142862, "mean_inference_ms": 1.204170507541717, "mean_action_processing_ms": 0.14059009041871293, "mean_env_wait_ms": 0.08405278185148038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024983882904052734, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11499571800231934}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.560999999999829, "episode_len_mean": 260.04, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.69999999999984, 45.9, 40.30000000000002, 23.699999999999896, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 25.699999999999925, 3.699999999999612, 44.7, 33.10000000000003, 45.1, 43.7, 43.7, 31.900000000000013, 40.90000000000002, 34.70000000000004, 41.500000000000014, 36.30000000000003, 38.700000000000024, 34.50000000000004, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, 37.50000000000003, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 29.69999999999998, 34.900000000000034, 40.10000000000002, 36.900000000000034, -50.00000000000044, 43.7, 27.49999999999995, 23.699999999999896, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, 44.900000000000006, 46.699999999999996, -50.00000000000044, 21.499999999999865, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 46.099999999999994, -50.00000000000044, 42.30000000000001, 40.70000000000002, 44.7, 41.500000000000014, 44.7, -50.00000000000044, 44.10000000000001, 44.7, 42.500000000000014, 39.90000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 37.50000000000003, 0.09999999999956088, 44.900000000000006, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 8.699999999999683], "episode_lengths": [304, 42, 98, 264, 500, 74, 500, 48, 244, 464, 54, 170, 50, 64, 64, 182, 92, 154, 86, 138, 114, 156, 94, 84, 500, 500, 500, 98, 500, 76, 126, 500, 48, 500, 90, 500, 70, 500, 96, 500, 500, 500, 132, 500, 204, 152, 100, 132, 500, 64, 226, 264, 112, 500, 500, 500, 500, 278, 52, 34, 500, 286, 500, 82, 500, 500, 106, 40, 500, 78, 94, 54, 86, 54, 500, 60, 54, 76, 102, 82, 500, 500, 426, 500, 126, 500, 52, 500, 50, 76, 500, 500, 500, 64, 106, 500, 500, 500, 42, 414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3804924320142862, "mean_inference_ms": 1.204170507541717, "mean_action_processing_ms": 0.14059009041871293, "mean_env_wait_ms": 0.08405278185148038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024983882904052734, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.11499571800231934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5494.505056241963, "num_env_steps_trained_throughput_per_sec": 5494.505056241963, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3209.692, "sample_time_ms": 2835.591, "load_time_ms": 19.002, "load_throughput": 947250.46, "learn_time_ms": 344.807, "learn_throughput": 52203.13, "synch_weights_time_ms": 8.992}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1052, "training_iteration": 16, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-21", "timestamp": 1698245361, "time_this_iter_s": 3.2820005416870117, "time_total_s": 51.48414945602417, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.48414945602417, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 59.56, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 7.129020514311613, "policy_loss": -2.1696918540530736e-05, "vf_loss": 7.129098680284288, "vf_explained_var": -7.218784756130642e-07, "kl": 0.0001657680816067484, "entropy": 0.5650566474155143, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.47999999999987, "episode_len_mean": 215.94, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 8.699999999999683, 12.099999999999731, -50.00000000000044, 39.70000000000002, 25.899999999999928, 42.500000000000014, 28.89999999999997, -50.00000000000044, 43.30000000000001, 44.7, 43.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 12.899999999999743, 17.099999999999802, 45.7, 42.500000000000014, 37.90000000000003, -50.00000000000044, 43.10000000000001, 42.70000000000001, 40.90000000000002, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 45.5, -50.00000000000044, 34.10000000000004, 44.5, 43.50000000000001, -50.00000000000044, 43.10000000000001, 40.10000000000002, 39.90000000000002, 43.900000000000006, 45.1, 45.5, 44.900000000000006, 45.1, 45.5, 35.500000000000036, 4.699999999999626, 46.3, 43.30000000000001, -50.00000000000044, 35.70000000000003, 21.499999999999865, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.9, 45.5, -50.00000000000044, 39.90000000000002, 46.099999999999994, 45.1, -50.00000000000044, 38.700000000000024, 43.30000000000001, 45.1, 41.70000000000002, 46.099999999999994, 44.300000000000004, 34.50000000000004, 37.300000000000026, -50.00000000000044, 19.09999999999983, 41.30000000000001, 45.5, 44.900000000000006, 39.10000000000002, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, 34.70000000000004, 21.09999999999986, 37.300000000000026, 43.900000000000006, 44.5], "episode_lengths": [500, 500, 64, 106, 500, 500, 500, 42, 414, 380, 500, 104, 242, 76, 212, 500, 68, 54, 70, 500, 72, 500, 500, 58, 372, 330, 44, 76, 122, 500, 70, 74, 92, 164, 500, 42, 500, 38, 56, 500, 500, 500, 488, 46, 500, 160, 56, 66, 500, 70, 100, 102, 62, 50, 46, 52, 50, 46, 146, 454, 38, 68, 500, 144, 286, 500, 500, 108, 42, 46, 500, 102, 40, 50, 500, 114, 68, 50, 84, 40, 58, 156, 128, 500, 310, 88, 46, 52, 110, 42, 66, 500, 500, 50, 82, 154, 290, 128, 62, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3810792603168524, "mean_inference_ms": 1.206516342792384, "mean_action_processing_ms": 0.14123075480540795, "mean_env_wait_ms": 0.08435460907453624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998218536376953, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.12893438339233398}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.47999999999987, "episode_len_mean": 215.94, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 8.699999999999683, 12.099999999999731, -50.00000000000044, 39.70000000000002, 25.899999999999928, 42.500000000000014, 28.89999999999997, -50.00000000000044, 43.30000000000001, 44.7, 43.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 12.899999999999743, 17.099999999999802, 45.7, 42.500000000000014, 37.90000000000003, -50.00000000000044, 43.10000000000001, 42.70000000000001, 40.90000000000002, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 45.5, -50.00000000000044, 34.10000000000004, 44.5, 43.50000000000001, -50.00000000000044, 43.10000000000001, 40.10000000000002, 39.90000000000002, 43.900000000000006, 45.1, 45.5, 44.900000000000006, 45.1, 45.5, 35.500000000000036, 4.699999999999626, 46.3, 43.30000000000001, -50.00000000000044, 35.70000000000003, 21.499999999999865, -50.00000000000044, -50.00000000000044, 39.300000000000026, 45.9, 45.5, -50.00000000000044, 39.90000000000002, 46.099999999999994, 45.1, -50.00000000000044, 38.700000000000024, 43.30000000000001, 45.1, 41.70000000000002, 46.099999999999994, 44.300000000000004, 34.50000000000004, 37.300000000000026, -50.00000000000044, 19.09999999999983, 41.30000000000001, 45.5, 44.900000000000006, 39.10000000000002, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, 34.70000000000004, 21.09999999999986, 37.300000000000026, 43.900000000000006, 44.5], "episode_lengths": [500, 500, 64, 106, 500, 500, 500, 42, 414, 380, 500, 104, 242, 76, 212, 500, 68, 54, 70, 500, 72, 500, 500, 58, 372, 330, 44, 76, 122, 500, 70, 74, 92, 164, 500, 42, 500, 38, 56, 500, 500, 500, 488, 46, 500, 160, 56, 66, 500, 70, 100, 102, 62, 50, 46, 52, 50, 46, 146, 454, 38, 68, 500, 144, 286, 500, 500, 108, 42, 46, 500, 102, 40, 50, 500, 114, 68, 50, 84, 40, 58, 156, 128, 500, 310, 88, 46, 52, 110, 42, 66, 500, 500, 50, 82, 154, 290, 128, 62, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3810792603168524, "mean_inference_ms": 1.206516342792384, "mean_action_processing_ms": 0.14123075480540795, "mean_env_wait_ms": 0.08435460907453624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998218536376953, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.12893438339233398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5502.902459136301, "num_env_steps_trained_throughput_per_sec": 5502.902459136301, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3229.295, "sample_time_ms": 2855.294, "load_time_ms": 19.302, "load_throughput": 932529.215, "learn_time_ms": 344.304, "learn_throughput": 52279.401, "synch_weights_time_ms": 9.195}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1143, "training_iteration": 17, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-24", "timestamp": 1698245364, "time_this_iter_s": 3.277000665664673, "time_total_s": 54.76115012168884, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.76115012168884, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.80000000000001, "ram_util_percent": 27.419999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 7.2149972209224, "policy_loss": -0.00033848567141426937, "vf_loss": 7.2153885629442005, "vf_explained_var": -2.198749118381076e-06, "kl": 0.000787301607212393, "entropy": 0.5291401214069791, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.784999999999862, "episode_len_mean": 227.88, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 38.700000000000024, 43.30000000000001, 45.1, 41.70000000000002, 46.099999999999994, 44.300000000000004, 34.50000000000004, 37.300000000000026, -50.00000000000044, 19.09999999999983, 41.30000000000001, 45.5, 44.900000000000006, 39.10000000000002, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, 34.70000000000004, 21.09999999999986, 37.300000000000026, 43.900000000000006, 44.5, -50.00000000000044, 47.9, 36.70000000000003, 46.5, 38.90000000000002, 40.10000000000002, -50.00000000000044, 37.70000000000003, 31.1, 22.099999999999874, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 16.8999999999998, -50.00000000000044, 16.8999999999998, 44.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 29.69999999999998, -50.00000000000044, 43.7, 45.5, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.900000000000006, 31.1, 42.70000000000001, 46.5, 42.70000000000001, 3.899999999999615, -50.00000000000044, 45.9, -50.00000000000044, 45.5, 31.500000000000007, 38.90000000000002, 29.099999999999973, 40.70000000000002, -50.00000000000044, 12.099999999999731, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, -50.00000000000044, 44.900000000000006, 46.3, 30.699999999999996, 45.5, 20.099999999999845, 46.3, 37.90000000000003, 18.099999999999817, 36.50000000000003], "episode_lengths": [50, 500, 114, 68, 50, 84, 40, 58, 156, 128, 500, 310, 88, 46, 52, 110, 42, 66, 500, 500, 50, 82, 154, 290, 128, 62, 56, 500, 22, 134, 36, 112, 100, 500, 124, 190, 280, 500, 190, 500, 500, 450, 500, 50, 500, 32, 500, 54, 332, 500, 332, 60, 106, 500, 500, 98, 500, 500, 44, 50, 204, 500, 64, 46, 500, 282, 500, 52, 190, 74, 36, 74, 462, 500, 42, 500, 46, 186, 112, 210, 94, 500, 380, 38, 40, 500, 500, 500, 38, 292, 500, 52, 38, 194, 46, 300, 38, 122, 320, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815833453253976, "mean_inference_ms": 1.2103498357768918, "mean_action_processing_ms": 0.14237822194251015, "mean_env_wait_ms": 0.08502105961764228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020021915435791016, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.13593482971191406}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.784999999999862, "episode_len_mean": 227.88, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 38.700000000000024, 43.30000000000001, 45.1, 41.70000000000002, 46.099999999999994, 44.300000000000004, 34.50000000000004, 37.300000000000026, -50.00000000000044, 19.09999999999983, 41.30000000000001, 45.5, 44.900000000000006, 39.10000000000002, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.1, 41.90000000000001, 34.70000000000004, 21.09999999999986, 37.300000000000026, 43.900000000000006, 44.5, -50.00000000000044, 47.9, 36.70000000000003, 46.5, 38.90000000000002, 40.10000000000002, -50.00000000000044, 37.70000000000003, 31.1, 22.099999999999874, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 45.1, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 16.8999999999998, -50.00000000000044, 16.8999999999998, 44.10000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 29.69999999999998, -50.00000000000044, 43.7, 45.5, -50.00000000000044, 21.89999999999987, -50.00000000000044, 44.900000000000006, 31.1, 42.70000000000001, 46.5, 42.70000000000001, 3.899999999999615, -50.00000000000044, 45.9, -50.00000000000044, 45.5, 31.500000000000007, 38.90000000000002, 29.099999999999973, 40.70000000000002, -50.00000000000044, 12.099999999999731, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, -50.00000000000044, 44.900000000000006, 46.3, 30.699999999999996, 45.5, 20.099999999999845, 46.3, 37.90000000000003, 18.099999999999817, 36.50000000000003], "episode_lengths": [50, 500, 114, 68, 50, 84, 40, 58, 156, 128, 500, 310, 88, 46, 52, 110, 42, 66, 500, 500, 50, 82, 154, 290, 128, 62, 56, 500, 22, 134, 36, 112, 100, 500, 124, 190, 280, 500, 190, 500, 500, 450, 500, 50, 500, 32, 500, 54, 332, 500, 332, 60, 106, 500, 500, 98, 500, 500, 44, 50, 204, 500, 64, 46, 500, 282, 500, 52, 190, 74, 36, 74, 462, 500, 42, 500, 46, 186, 112, 210, 94, 500, 380, 38, 40, 500, 500, 500, 38, 292, 500, 52, 38, 194, 46, 300, 38, 122, 320, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815833453253976, "mean_inference_ms": 1.2103498357768918, "mean_action_processing_ms": 0.14237822194251015, "mean_env_wait_ms": 0.08502105961764228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020021915435791016, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.13593482971191406}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5241.699161661081, "num_env_steps_trained_throughput_per_sec": 5241.699161661081, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3256.698, "sample_time_ms": 2886.897, "load_time_ms": 18.302, "load_throughput": 983475.393, "learn_time_ms": 340.901, "learn_throughput": 52801.31, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1216, "training_iteration": 18, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-27", "timestamp": 1698245367, "time_this_iter_s": 3.439000368118286, "time_total_s": 58.20015048980713, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.20015048980713, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 63.78000000000001, "ram_util_percent": 27.360000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.920923409638582, "policy_loss": -9.779576902036314e-07, "vf_loss": 6.9209727887754084, "vf_explained_var": 9.338061014811198e-07, "kl": 0.00021679092522904116, "entropy": 0.4835236966609955, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.704999999999856, "episode_len_mean": 228.66, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.500000000000007, 38.90000000000002, 29.099999999999973, 40.70000000000002, -50.00000000000044, 12.099999999999731, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, -50.00000000000044, 44.900000000000006, 46.3, 30.699999999999996, 45.5, 20.099999999999845, 46.3, 37.90000000000003, 18.099999999999817, 36.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.3, 45.3, 45.9, 44.7, 45.5, 43.10000000000001, 45.1, 41.500000000000014, 46.5, 22.899999999999885, 40.500000000000014, 35.500000000000036, 44.7, 43.7, 44.900000000000006, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.90000000000001, -50.00000000000044, 46.5, 26.499999999999936, 43.10000000000001, 39.50000000000002, -50.00000000000044, 2.699999999999598, 38.10000000000002, 43.10000000000001, 36.70000000000003, 47.5, 37.10000000000003, 32.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, 35.30000000000004, 38.700000000000024, 28.29999999999996, 27.099999999999945, 42.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 32.90000000000003, 9.099999999999689, 28.09999999999996, 44.10000000000001, 35.500000000000036, 41.70000000000002, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 21.699999999999868], "episode_lengths": [186, 112, 210, 94, 500, 380, 38, 40, 500, 500, 500, 38, 292, 500, 52, 38, 194, 46, 300, 38, 122, 320, 136, 500, 58, 500, 140, 500, 38, 48, 42, 54, 46, 70, 50, 86, 36, 272, 96, 146, 54, 64, 52, 500, 48, 40, 500, 500, 500, 46, 500, 500, 66, 82, 500, 36, 236, 70, 106, 500, 474, 120, 70, 134, 26, 130, 176, 500, 52, 500, 26, 500, 148, 114, 218, 230, 72, 32, 500, 500, 500, 500, 500, 500, 500, 24, 172, 410, 220, 60, 146, 84, 500, 80, 54, 500, 52, 40, 500, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821636848113694, "mean_inference_ms": 1.2134161947336457, "mean_action_processing_ms": 0.14257315360498254, "mean_env_wait_ms": 0.08491523798570441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260009765625, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.11698007583618164}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.704999999999856, "episode_len_mean": 228.66, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.500000000000007, 38.90000000000002, 29.099999999999973, 40.70000000000002, -50.00000000000044, 12.099999999999731, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 20.899999999999856, -50.00000000000044, 44.900000000000006, 46.3, 30.699999999999996, 45.5, 20.099999999999845, 46.3, 37.90000000000003, 18.099999999999817, 36.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.3, 45.3, 45.9, 44.7, 45.5, 43.10000000000001, 45.1, 41.500000000000014, 46.5, 22.899999999999885, 40.500000000000014, 35.500000000000036, 44.7, 43.7, 44.900000000000006, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.90000000000001, -50.00000000000044, 46.5, 26.499999999999936, 43.10000000000001, 39.50000000000002, -50.00000000000044, 2.699999999999598, 38.10000000000002, 43.10000000000001, 36.70000000000003, 47.5, 37.10000000000003, 32.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, -50.00000000000044, 35.30000000000004, 38.700000000000024, 28.29999999999996, 27.099999999999945, 42.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 32.90000000000003, 9.099999999999689, 28.09999999999996, 44.10000000000001, 35.500000000000036, 41.70000000000002, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 21.699999999999868], "episode_lengths": [186, 112, 210, 94, 500, 380, 38, 40, 500, 500, 500, 38, 292, 500, 52, 38, 194, 46, 300, 38, 122, 320, 136, 500, 58, 500, 140, 500, 38, 48, 42, 54, 46, 70, 50, 86, 36, 272, 96, 146, 54, 64, 52, 500, 48, 40, 500, 500, 500, 46, 500, 500, 66, 82, 500, 36, 236, 70, 106, 500, 474, 120, 70, 134, 26, 130, 176, 500, 52, 500, 26, 500, 148, 114, 218, 230, 72, 32, 500, 500, 500, 500, 500, 500, 500, 24, 172, 410, 220, 60, 146, 84, 500, 80, 54, 500, 52, 40, 500, 284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821636848113694, "mean_inference_ms": 1.2134161947336457, "mean_action_processing_ms": 0.14257315360498254, "mean_env_wait_ms": 0.08491523798570441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260009765625, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.11698007583618164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5477.784518217799, "num_env_steps_trained_throughput_per_sec": 5477.784518217799, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3275.801, "sample_time_ms": 2897.7, "load_time_ms": 19.102, "load_throughput": 942287.301, "learn_time_ms": 348.301, "learn_throughput": 51679.48, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1293, "training_iteration": 19, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-31", "timestamp": 1698245371, "time_this_iter_s": 3.2910008430480957, "time_total_s": 61.491151332855225, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.491151332855225, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 67.125, "ram_util_percent": 27.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.621841695573595, "policy_loss": -0.00022456781179816635, "vf_loss": 6.622113157201697, "vf_explained_var": -1.6115329883716725e-06, "kl": 0.0005338996537559303, "entropy": 0.4693940425360644, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.3659999999998265, "episode_len_mean": 256.98, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.30000000000004, 38.700000000000024, 28.29999999999996, 27.099999999999945, 42.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 32.90000000000003, 9.099999999999689, 28.09999999999996, 44.10000000000001, 35.500000000000036, 41.70000000000002, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.50000000000003, 12.899999999999743, -50.00000000000044, 43.7, -50.00000000000044, 35.900000000000034, -50.00000000000044, 26.09999999999993, 40.500000000000014, 46.699999999999996, 40.500000000000014, 9.099999999999689, 35.900000000000034, -50.00000000000044, 45.7, 40.90000000000002, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 46.099999999999994, 42.500000000000014, 23.099999999999888, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 41.30000000000001, 28.89999999999997, 24.69999999999991, 45.3, 46.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 10.699999999999712, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 27.099999999999945, 44.5, -50.00000000000044, 24.69999999999991, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.300000000000004, 46.5, 46.699999999999996, 39.50000000000002, 44.10000000000001, -50.00000000000044], "episode_lengths": [500, 148, 114, 218, 230, 72, 32, 500, 500, 500, 500, 500, 500, 500, 24, 172, 410, 220, 60, 146, 84, 500, 80, 54, 500, 52, 40, 500, 284, 500, 52, 500, 26, 72, 500, 126, 372, 500, 64, 500, 142, 500, 240, 96, 34, 96, 410, 142, 500, 44, 92, 30, 40, 500, 500, 500, 202, 40, 76, 270, 68, 500, 500, 38, 500, 500, 88, 212, 254, 48, 38, 94, 40, 500, 74, 104, 500, 500, 394, 102, 500, 40, 500, 230, 56, 500, 254, 70, 500, 500, 500, 54, 40, 500, 58, 36, 34, 106, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825359695668057, "mean_inference_ms": 1.213556688907686, "mean_action_processing_ms": 0.14242663444781134, "mean_env_wait_ms": 0.08504585027256288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.11600208282470703}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.3659999999998265, "episode_len_mean": 256.98, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.30000000000004, 38.700000000000024, 28.29999999999996, 27.099999999999945, 42.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 32.90000000000003, 9.099999999999689, 28.09999999999996, 44.10000000000001, 35.500000000000036, 41.70000000000002, -50.00000000000044, 42.10000000000001, 44.7, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.900000000000006, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 37.50000000000003, 12.899999999999743, -50.00000000000044, 43.7, -50.00000000000044, 35.900000000000034, -50.00000000000044, 26.09999999999993, 40.500000000000014, 46.699999999999996, 40.500000000000014, 9.099999999999689, 35.900000000000034, -50.00000000000044, 45.7, 40.90000000000002, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, 46.099999999999994, 42.500000000000014, 23.099999999999888, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 41.30000000000001, 28.89999999999997, 24.69999999999991, 45.3, 46.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 10.699999999999712, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 27.099999999999945, 44.5, -50.00000000000044, 24.69999999999991, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.300000000000004, 46.5, 46.699999999999996, 39.50000000000002, 44.10000000000001, -50.00000000000044], "episode_lengths": [500, 148, 114, 218, 230, 72, 32, 500, 500, 500, 500, 500, 500, 500, 24, 172, 410, 220, 60, 146, 84, 500, 80, 54, 500, 52, 40, 500, 284, 500, 52, 500, 26, 72, 500, 126, 372, 500, 64, 500, 142, 500, 240, 96, 34, 96, 410, 142, 500, 44, 92, 30, 40, 500, 500, 500, 202, 40, 76, 270, 68, 500, 500, 38, 500, 500, 88, 212, 254, 48, 38, 94, 40, 500, 74, 104, 500, 500, 394, 102, 500, 40, 500, 230, 56, 500, 254, 70, 500, 500, 500, 54, 40, 500, 58, 36, 34, 106, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825359695668057, "mean_inference_ms": 1.213556688907686, "mean_action_processing_ms": 0.14242663444781134, "mean_env_wait_ms": 0.08504585027256288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.11600208282470703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5600.493275325611, "num_env_steps_trained_throughput_per_sec": 5600.493275325611, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3268.501, "sample_time_ms": 2894.5, "load_time_ms": 18.403, "load_throughput": 978127.71, "learn_time_ms": 344.497, "learn_throughput": 52250.036, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1364, "training_iteration": 20, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-34", "timestamp": 1698245374, "time_this_iter_s": 3.220000982284546, "time_total_s": 64.71115231513977, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.71115231513977, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.48, "ram_util_percent": 27.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.393750508626302, "policy_loss": -0.0008614962851559674, "vf_loss": 6.394657576525653, "vf_explained_var": -9.625046341507524e-07, "kl": 0.0008925527045499217, "entropy": 0.45700290909519903, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.008999999999815, "episode_len_mean": 255.5, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 10.699999999999712, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 27.099999999999945, 44.5, -50.00000000000044, 24.69999999999991, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.300000000000004, 46.5, 46.699999999999996, 39.50000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.30000000000001, -50.00000000000044, 42.70000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.90000000000003, 45.1, -50.00000000000044, 46.3, 43.900000000000006, 18.499999999999822, -50.00000000000044, -50.00000000000044, 47.5, 47.9, 46.3, 46.099999999999994, -50.00000000000044, 43.900000000000006, 45.9, 42.70000000000001, 34.10000000000004, 46.9, -50.00000000000044, 43.30000000000001, 47.3, 39.50000000000002, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 43.10000000000001, 39.300000000000026, 46.9, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 46.9, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 32.700000000000024, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [38, 94, 40, 500, 74, 104, 500, 500, 394, 102, 500, 40, 500, 230, 56, 500, 254, 70, 500, 500, 500, 54, 40, 500, 58, 36, 34, 106, 60, 500, 500, 50, 500, 500, 500, 38, 500, 500, 74, 68, 500, 74, 150, 500, 500, 500, 34, 172, 50, 500, 38, 62, 316, 500, 500, 26, 22, 38, 40, 500, 62, 42, 74, 160, 32, 500, 68, 28, 106, 500, 36, 38, 500, 70, 108, 32, 66, 500, 106, 500, 76, 500, 500, 50, 32, 56, 500, 62, 500, 500, 58, 174, 328, 500, 500, 500, 500, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38380096553109666, "mean_inference_ms": 1.2155685801194627, "mean_action_processing_ms": 0.14274398672114674, "mean_env_wait_ms": 0.08476884470202747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000020980834961, "StateBufferConnector_ms": 0.006000041961669922, "ViewRequirementAgentConnector_ms": 0.14699625968933105}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.008999999999815, "episode_len_mean": 255.5, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 40.70000000000002, 46.099999999999994, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, 10.699999999999712, 39.90000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 27.099999999999945, 44.5, -50.00000000000044, 24.69999999999991, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, 44.300000000000004, 46.5, 46.699999999999996, 39.50000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.30000000000001, -50.00000000000044, 42.70000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.90000000000003, 45.1, -50.00000000000044, 46.3, 43.900000000000006, 18.499999999999822, -50.00000000000044, -50.00000000000044, 47.5, 47.9, 46.3, 46.099999999999994, -50.00000000000044, 43.900000000000006, 45.9, 42.70000000000001, 34.10000000000004, 46.9, -50.00000000000044, 43.30000000000001, 47.3, 39.50000000000002, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 43.10000000000001, 39.300000000000026, 46.9, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 46.9, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 32.700000000000024, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [38, 94, 40, 500, 74, 104, 500, 500, 394, 102, 500, 40, 500, 230, 56, 500, 254, 70, 500, 500, 500, 54, 40, 500, 58, 36, 34, 106, 60, 500, 500, 50, 500, 500, 500, 38, 500, 500, 74, 68, 500, 74, 150, 500, 500, 500, 34, 172, 50, 500, 38, 62, 316, 500, 500, 26, 22, 38, 40, 500, 62, 42, 74, 160, 32, 500, 68, 28, 106, 500, 36, 38, 500, 70, 108, 32, 66, 500, 106, 500, 76, 500, 500, 50, 32, 56, 500, 62, 500, 500, 58, 174, 328, 500, 500, 500, 500, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38380096553109666, "mean_inference_ms": 1.2155685801194627, "mean_action_processing_ms": 0.14274398672114674, "mean_env_wait_ms": 0.08476884470202747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000020980834961, "StateBufferConnector_ms": 0.006000041961669922, "ViewRequirementAgentConnector_ms": 0.14699625968933105}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5416.84109957377, "num_env_steps_trained_throughput_per_sec": 5416.84109957377, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3280.898, "sample_time_ms": 2907.497, "load_time_ms": 18.702, "load_throughput": 962441.496, "learn_time_ms": 343.897, "learn_throughput": 52341.194, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1434, "training_iteration": 21, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-37", "timestamp": 1698245377, "time_this_iter_s": 3.328969955444336, "time_total_s": 68.0401222705841, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.0401222705841, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 66.825, "ram_util_percent": 27.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.633540118182147, "policy_loss": -0.00017321415038572418, "vf_loss": 6.633760787822582, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.0004789790240269869, "entropy": 0.4745430239924678, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2969999999998003, "episode_len_mean": 272.62, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 43.30000000000001, 47.3, 39.50000000000002, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 43.10000000000001, 39.300000000000026, 46.9, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 46.9, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 32.700000000000024, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.09999999999979, 37.90000000000003, 45.5, 25.499999999999922, 4.899999999999629, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.300000000000026, 42.900000000000006, -50.00000000000044, 21.499999999999865, -50.00000000000044, 33.30000000000003, 45.3, -50.00000000000044, 23.29999999999989, 46.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 47.3, 42.30000000000001, 23.8999999999999, 1.4999999999995808, 46.5, 46.3, 26.89999999999994, 41.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, 39.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.30000000000001, 47.3], "episode_lengths": [32, 500, 68, 28, 106, 500, 36, 38, 500, 70, 108, 32, 66, 500, 106, 500, 76, 500, 500, 50, 32, 56, 500, 62, 500, 500, 58, 174, 328, 500, 500, 500, 500, 500, 500, 50, 484, 500, 500, 72, 340, 122, 46, 246, 452, 500, 500, 238, 500, 500, 128, 72, 500, 286, 500, 168, 48, 500, 268, 36, 500, 54, 500, 500, 58, 500, 70, 500, 500, 50, 46, 28, 500, 500, 38, 500, 56, 28, 78, 262, 486, 36, 38, 232, 84, 500, 40, 500, 36, 500, 48, 500, 104, 104, 500, 500, 108, 500, 68, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844066431678478, "mean_inference_ms": 1.216857005514187, "mean_action_processing_ms": 0.1425817395210755, "mean_env_wait_ms": 0.0847339372131788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200484275817871, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.14497590065002441}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2969999999998003, "episode_len_mean": 272.62, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 43.30000000000001, 47.3, 39.50000000000002, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 43.10000000000001, 39.300000000000026, 46.9, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 46.9, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 32.700000000000024, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 42.900000000000006, 16.09999999999979, 37.90000000000003, 45.5, 25.499999999999922, 4.899999999999629, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 37.300000000000026, 42.900000000000006, -50.00000000000044, 21.499999999999865, -50.00000000000044, 33.30000000000003, 45.3, -50.00000000000044, 23.29999999999989, 46.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.5, 47.3, 42.30000000000001, 23.8999999999999, 1.4999999999995808, 46.5, 46.3, 26.89999999999994, 41.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, 39.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.30000000000001, 47.3], "episode_lengths": [32, 500, 68, 28, 106, 500, 36, 38, 500, 70, 108, 32, 66, 500, 106, 500, 76, 500, 500, 50, 32, 56, 500, 62, 500, 500, 58, 174, 328, 500, 500, 500, 500, 500, 500, 50, 484, 500, 500, 72, 340, 122, 46, 246, 452, 500, 500, 238, 500, 500, 128, 72, 500, 286, 500, 168, 48, 500, 268, 36, 500, 54, 500, 500, 58, 500, 70, 500, 500, 50, 46, 28, 500, 500, 38, 500, 56, 28, 78, 262, 486, 36, 38, 232, 84, 500, 40, 500, 36, 500, 48, 500, 104, 104, 500, 500, 108, 500, 68, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3844066431678478, "mean_inference_ms": 1.216857005514187, "mean_action_processing_ms": 0.1425817395210755, "mean_env_wait_ms": 0.0847339372131788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200484275817871, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.14497590065002441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5518.086921184462, "num_env_steps_trained_throughput_per_sec": 5518.086921184462, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3277.598, "sample_time_ms": 2914.097, "load_time_ms": 18.1, "load_throughput": 994501.369, "learn_time_ms": 334.6, "learn_throughput": 53795.528, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1498, "training_iteration": 22, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-41", "timestamp": 1698245381, "time_this_iter_s": 3.267000436782837, "time_total_s": 71.30712270736694, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.30712270736694, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 63.65999999999999, "ram_util_percent": 27.420000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.188804078985144, "policy_loss": -0.0007288625670803918, "vf_loss": 6.189577226285581, "vf_explained_var": -2.128106576425058e-06, "kl": 0.0014773046237511129, "entropy": 0.44245704015096027, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.533999999999828, "episode_len_mean": 235.3, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 47.3, 42.30000000000001, 23.8999999999999, 1.4999999999995808, 46.5, 46.3, 26.89999999999994, 41.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, 39.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.30000000000001, 47.3, 45.5, 44.300000000000004, 47.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 40.90000000000002, 48.1, 42.70000000000001, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.499999999999595, 46.699999999999996, 44.5, -50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 47.7, 46.099999999999994, 45.9, -50.00000000000044, 44.5, 46.099999999999994, 30.9, 47.9, 46.3, 42.900000000000006, 45.7, 26.499999999999936, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 44.900000000000006, 45.7, -50.00000000000044, 47.1, 47.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.499999999999822, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 47.9, -50.00000000000044, -50.00000000000044, 48.1, 41.70000000000002, 45.1, 39.50000000000002, -50.00000000000044], "episode_lengths": [56, 28, 78, 262, 486, 36, 38, 232, 84, 500, 40, 500, 36, 500, 48, 500, 104, 104, 500, 500, 108, 500, 68, 28, 46, 58, 28, 500, 88, 500, 50, 48, 500, 92, 20, 74, 40, 500, 70, 500, 500, 500, 500, 500, 476, 34, 56, 500, 32, 314, 500, 24, 40, 42, 500, 56, 40, 192, 22, 38, 72, 44, 236, 500, 82, 42, 500, 500, 500, 60, 500, 500, 32, 28, 52, 44, 500, 30, 22, 500, 182, 500, 500, 62, 316, 500, 500, 44, 52, 500, 500, 32, 22, 500, 500, 20, 84, 50, 106, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836418588669241, "mean_inference_ms": 1.2155407208958742, "mean_action_processing_ms": 0.14250053989482997, "mean_env_wait_ms": 0.08477959049023014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500558853149414, "StateBufferConnector_ms": 0.009001731872558594, "ViewRequirementAgentConnector_ms": 0.12296390533447266}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.533999999999828, "episode_len_mean": 235.3, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 47.3, 42.30000000000001, 23.8999999999999, 1.4999999999995808, 46.5, 46.3, 26.89999999999994, 41.70000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 45.3, -50.00000000000044, 39.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.30000000000001, 47.3, 45.5, 44.300000000000004, 47.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 40.90000000000002, 48.1, 42.70000000000001, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.499999999999595, 46.699999999999996, 44.5, -50.00000000000044, 46.9, 18.699999999999825, -50.00000000000044, 47.7, 46.099999999999994, 45.9, -50.00000000000044, 44.5, 46.099999999999994, 30.9, 47.9, 46.3, 42.900000000000006, 45.7, 26.499999999999936, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 44.900000000000006, 45.7, -50.00000000000044, 47.1, 47.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.499999999999822, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 47.9, -50.00000000000044, -50.00000000000044, 48.1, 41.70000000000002, 45.1, 39.50000000000002, -50.00000000000044], "episode_lengths": [56, 28, 78, 262, 486, 36, 38, 232, 84, 500, 40, 500, 36, 500, 48, 500, 104, 104, 500, 500, 108, 500, 68, 28, 46, 58, 28, 500, 88, 500, 50, 48, 500, 92, 20, 74, 40, 500, 70, 500, 500, 500, 500, 500, 476, 34, 56, 500, 32, 314, 500, 24, 40, 42, 500, 56, 40, 192, 22, 38, 72, 44, 236, 500, 82, 42, 500, 500, 500, 60, 500, 500, 32, 28, 52, 44, 500, 30, 22, 500, 182, 500, 500, 62, 316, 500, 500, 44, 52, 500, 500, 32, 22, 500, 500, 20, 84, 50, 106, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836418588669241, "mean_inference_ms": 1.2155407208958742, "mean_action_processing_ms": 0.14250053989482997, "mean_env_wait_ms": 0.08477959049023014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500558853149414, "StateBufferConnector_ms": 0.009001731872558594, "ViewRequirementAgentConnector_ms": 0.12296390533447266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5772.929985472375, "num_env_steps_trained_throughput_per_sec": 5772.929985472375, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3269.998, "sample_time_ms": 2907.697, "load_time_ms": 17.599, "load_throughput": 1022762.608, "learn_time_ms": 333.9, "learn_throughput": 53908.298, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1574, "training_iteration": 23, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-44", "timestamp": 1698245384, "time_this_iter_s": 3.123000383377075, "time_total_s": 74.43012309074402, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.43012309074402, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 59.525000000000006, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.3002876352380826, "policy_loss": -0.00013697174964127717, "vf_loss": 6.300469045285825, "vf_explained_var": 3.9736429850260414e-08, "kl": 0.0005377964163330728, "entropy": 0.4444409321855616, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.6490000000002185, "episode_len_mean": 282.0, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 44.900000000000006, 45.7, -50.00000000000044, 47.1, 47.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.499999999999822, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 47.9, -50.00000000000044, -50.00000000000044, 48.1, 41.70000000000002, 45.1, 39.50000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 31.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 22.299999999999876, -50.00000000000044, 35.500000000000036, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 47.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.50000000000003, 43.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, 41.500000000000014, 41.90000000000001, 44.300000000000004, 42.70000000000001], "episode_lengths": [500, 82, 42, 500, 500, 500, 60, 500, 500, 32, 28, 52, 44, 500, 30, 22, 500, 182, 500, 500, 62, 316, 500, 500, 44, 52, 500, 500, 32, 22, 500, 500, 20, 84, 50, 106, 500, 500, 36, 500, 28, 500, 188, 30, 500, 500, 80, 278, 500, 146, 46, 500, 500, 500, 36, 500, 500, 66, 34, 22, 34, 500, 500, 500, 500, 40, 500, 500, 46, 54, 500, 500, 98, 500, 500, 500, 84, 500, 500, 500, 500, 500, 200, 500, 76, 22, 500, 32, 500, 500, 76, 116, 70, 62, 500, 38, 86, 82, 58, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38277598724534473, "mean_inference_ms": 1.2142055369492453, "mean_action_processing_ms": 0.142135681115566, "mean_env_wait_ms": 0.08474990075746154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020002365112304688, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.1300044059753418}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.6490000000002185, "episode_len_mean": 282.0, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 44.900000000000006, 45.7, -50.00000000000044, 47.1, 47.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 43.900000000000006, 18.499999999999822, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, 47.9, -50.00000000000044, -50.00000000000044, 48.1, 41.70000000000002, 45.1, 39.50000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 31.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, 42.10000000000001, 22.299999999999876, -50.00000000000044, 35.500000000000036, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 47.9, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, -50.00000000000044, 42.500000000000014, 47.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.50000000000003, 43.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, 41.500000000000014, 41.90000000000001, 44.300000000000004, 42.70000000000001], "episode_lengths": [500, 82, 42, 500, 500, 500, 60, 500, 500, 32, 28, 52, 44, 500, 30, 22, 500, 182, 500, 500, 62, 316, 500, 500, 44, 52, 500, 500, 32, 22, 500, 500, 20, 84, 50, 106, 500, 500, 36, 500, 28, 500, 188, 30, 500, 500, 80, 278, 500, 146, 46, 500, 500, 500, 36, 500, 500, 66, 34, 22, 34, 500, 500, 500, 500, 40, 500, 500, 46, 54, 500, 500, 98, 500, 500, 500, 84, 500, 500, 500, 500, 500, 200, 500, 76, 22, 500, 32, 500, 500, 76, 116, 70, 62, 500, 38, 86, 82, 58, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38277598724534473, "mean_inference_ms": 1.2142055369492453, "mean_action_processing_ms": 0.142135681115566, "mean_env_wait_ms": 0.08474990075746154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020002365112304688, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.1300044059753418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5703.419219882106, "num_env_steps_trained_throughput_per_sec": 5703.419219882106, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3255.898, "sample_time_ms": 2893.997, "load_time_ms": 17.499, "load_throughput": 1028620.757, "learn_time_ms": 333.6, "learn_throughput": 53956.754, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1637, "training_iteration": 24, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-47", "timestamp": 1698245387, "time_this_iter_s": 3.161000967025757, "time_total_s": 77.59112405776978, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.59112405776978, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 56.54, "ram_util_percent": 27.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.528486393116139, "policy_loss": -0.000248935901456409, "vf_loss": 6.528778923882379, "vf_explained_var": -9.448439986617476e-07, "kl": 0.0006665590990672223, "entropy": 0.4364750197640172, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.623999999999867, "episode_len_mean": 204.46, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 47.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.50000000000003, 43.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, 41.500000000000014, 41.90000000000001, 44.300000000000004, 42.70000000000001, -50.00000000000044, 45.7, 46.699999999999996, 37.300000000000026, -50.00000000000044, 45.7, 45.3, 43.50000000000001, -50.00000000000044, 46.3, 47.1, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 48.1, 20.49999999999985, 46.5, 41.90000000000001, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 47.7, 42.500000000000014, 47.3, 38.90000000000002, 46.9, 15.899999999999785, -50.00000000000044, 44.5, 42.70000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 29.299999999999976, 46.9, 46.9, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, 28.09999999999996, 40.70000000000002, 46.099999999999994, 47.7, 46.9, -50.00000000000044, 28.89999999999997, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 47.9, 32.100000000000016, 47.5, 45.9, -50.00000000000044, 33.90000000000004, 47.3, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, -50.00000000000044, 24.099999999999902, -50.00000000000044, 41.90000000000001, 46.9, 47.3], "episode_lengths": [76, 22, 500, 32, 500, 500, 76, 116, 70, 62, 500, 38, 86, 82, 58, 74, 500, 44, 34, 128, 500, 44, 48, 66, 500, 38, 30, 162, 44, 500, 500, 44, 500, 20, 296, 36, 82, 142, 500, 500, 50, 500, 34, 24, 76, 28, 112, 32, 342, 500, 56, 74, 500, 110, 500, 500, 208, 32, 32, 30, 40, 500, 500, 34, 36, 220, 94, 40, 24, 32, 500, 212, 56, 500, 500, 500, 128, 500, 500, 30, 38, 22, 180, 26, 42, 500, 162, 28, 84, 48, 500, 500, 36, 142, 500, 260, 500, 82, 32, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821085762149529, "mean_inference_ms": 1.212006754095536, "mean_action_processing_ms": 0.14185862921511147, "mean_env_wait_ms": 0.0846154338926516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005123138427734, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.12899017333984375}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.623999999999867, "episode_len_mean": 204.46, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 47.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.50000000000003, 43.10000000000001, 43.900000000000006, -50.00000000000044, 46.3, 41.500000000000014, 41.90000000000001, 44.300000000000004, 42.70000000000001, -50.00000000000044, 45.7, 46.699999999999996, 37.300000000000026, -50.00000000000044, 45.7, 45.3, 43.50000000000001, -50.00000000000044, 46.3, 47.1, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 48.1, 20.49999999999985, 46.5, 41.90000000000001, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, 47.7, 42.500000000000014, 47.3, 38.90000000000002, 46.9, 15.899999999999785, -50.00000000000044, 44.5, 42.70000000000001, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 29.299999999999976, 46.9, 46.9, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, 28.09999999999996, 40.70000000000002, 46.099999999999994, 47.7, 46.9, -50.00000000000044, 28.89999999999997, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 47.9, 32.100000000000016, 47.5, 45.9, -50.00000000000044, 33.90000000000004, 47.3, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, -50.00000000000044, 24.099999999999902, -50.00000000000044, 41.90000000000001, 46.9, 47.3], "episode_lengths": [76, 22, 500, 32, 500, 500, 76, 116, 70, 62, 500, 38, 86, 82, 58, 74, 500, 44, 34, 128, 500, 44, 48, 66, 500, 38, 30, 162, 44, 500, 500, 44, 500, 20, 296, 36, 82, 142, 500, 500, 50, 500, 34, 24, 76, 28, 112, 32, 342, 500, 56, 74, 500, 110, 500, 500, 208, 32, 32, 30, 40, 500, 500, 34, 36, 220, 94, 40, 24, 32, 500, 212, 56, 500, 500, 500, 128, 500, 500, 30, 38, 22, 180, 26, 42, 500, 162, 28, 84, 48, 500, 500, 36, 142, 500, 260, 500, 82, 32, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3821085762149529, "mean_inference_ms": 1.212006754095536, "mean_action_processing_ms": 0.14185862921511147, "mean_env_wait_ms": 0.0846154338926516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005123138427734, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.12899017333984375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5586.332782697327, "num_env_steps_trained_throughput_per_sec": 5586.332782697327, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3256.213, "sample_time_ms": 2895.697, "load_time_ms": 18.199, "load_throughput": 989047.692, "learn_time_ms": 331.415, "learn_throughput": 54312.501, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1721, "training_iteration": 25, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-50", "timestamp": 1698245390, "time_this_iter_s": 3.227149486541748, "time_total_s": 80.81827354431152, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.81827354431152, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 62.65, "ram_util_percent": 27.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.051141385678892, "policy_loss": -0.0004930238894842289, "vf_loss": 6.051679469920971, "vf_explained_var": 1.2119611104329426e-06, "kl": 0.0005218842410565012, "entropy": 0.45071268964696815, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0979999999998018, "episode_len_mean": 269.58, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.299999999999976, 46.9, 46.9, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, 28.09999999999996, 40.70000000000002, 46.099999999999994, 47.7, 46.9, -50.00000000000044, 28.89999999999997, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 47.9, 32.100000000000016, 47.5, 45.9, -50.00000000000044, 33.90000000000004, 47.3, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, -50.00000000000044, 24.099999999999902, -50.00000000000044, 41.90000000000001, 46.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 47.3, 41.90000000000001, 33.10000000000003, 32.100000000000016, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 32.90000000000003, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 26.499999999999936, -50.00000000000044, 47.5, 47.5, 44.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044], "episode_lengths": [208, 32, 32, 30, 40, 500, 500, 34, 36, 220, 94, 40, 24, 32, 500, 212, 56, 500, 500, 500, 128, 500, 500, 30, 38, 22, 180, 26, 42, 500, 162, 28, 84, 48, 500, 500, 36, 142, 500, 260, 500, 82, 32, 28, 500, 500, 500, 40, 500, 500, 500, 500, 500, 500, 104, 500, 64, 500, 28, 82, 170, 180, 500, 500, 386, 500, 172, 500, 136, 500, 500, 92, 500, 500, 500, 32, 500, 38, 38, 500, 30, 500, 500, 30, 100, 236, 500, 26, 26, 52, 500, 298, 500, 42, 500, 500, 500, 56, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822784129738317, "mean_inference_ms": 1.211913841364575, "mean_action_processing_ms": 0.14132514107688085, "mean_env_wait_ms": 0.08425419949014579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599620819091797, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12100338935852051}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0979999999998018, "episode_len_mean": 269.58, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.299999999999976, 46.9, 46.9, 47.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, 28.09999999999996, 40.70000000000002, 46.099999999999994, 47.7, 46.9, -50.00000000000044, 28.89999999999997, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, 46.3, 47.9, 32.100000000000016, 47.5, 45.9, -50.00000000000044, 33.90000000000004, 47.3, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, -50.00000000000044, 24.099999999999902, -50.00000000000044, 41.90000000000001, 46.9, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 47.3, 41.90000000000001, 33.10000000000003, 32.100000000000016, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 32.90000000000003, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 26.499999999999936, -50.00000000000044, 47.5, 47.5, 44.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044], "episode_lengths": [208, 32, 32, 30, 40, 500, 500, 34, 36, 220, 94, 40, 24, 32, 500, 212, 56, 500, 500, 500, 128, 500, 500, 30, 38, 22, 180, 26, 42, 500, 162, 28, 84, 48, 500, 500, 36, 142, 500, 260, 500, 82, 32, 28, 500, 500, 500, 40, 500, 500, 500, 500, 500, 500, 104, 500, 64, 500, 28, 82, 170, 180, 500, 500, 386, 500, 172, 500, 136, 500, 500, 92, 500, 500, 500, 32, 500, 38, 38, 500, 30, 500, 500, 30, 100, 236, 500, 26, 26, 52, 500, 298, 500, 42, 500, 500, 500, 56, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822784129738317, "mean_inference_ms": 1.211913841364575, "mean_action_processing_ms": 0.14132514107688085, "mean_env_wait_ms": 0.08425419949014579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599620819091797, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12100338935852051}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5535.057626278137, "num_env_steps_trained_throughput_per_sec": 5535.057626278137, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3253.813, "sample_time_ms": 2885.797, "load_time_ms": 18.999, "load_throughput": 947402.612, "learn_time_ms": 338.015, "learn_throughput": 53252.025, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1777, "training_iteration": 26, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-53", "timestamp": 1698245393, "time_this_iter_s": 3.256998300552368, "time_total_s": 84.07527184486389, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.07527184486389, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 58.6, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.466538658848515, "policy_loss": -0.0004488683512641324, "vf_loss": 6.467033174302843, "vf_explained_var": -7.329163727936921e-07, "kl": 0.0005508864049533562, "entropy": 0.4551777210500505, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.1909999999997936, "episode_len_mean": 273.64, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 26.499999999999936, -50.00000000000044, 47.5, 47.5, 44.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 42.70000000000001, 0.2999999999995637, 40.90000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 47.9, 45.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.3, -50.00000000000044, 46.9, 45.9, 36.50000000000003, -50.00000000000044, 46.9, 46.9, 20.699999999999854, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.3, 45.5, 46.9, 33.70000000000004, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 45.9, 40.10000000000002, 43.30000000000001, 44.7, -50.00000000000044, 40.500000000000014], "episode_lengths": [136, 500, 500, 92, 500, 500, 500, 32, 500, 38, 38, 500, 30, 500, 500, 30, 100, 236, 500, 26, 26, 52, 500, 298, 500, 42, 500, 500, 500, 56, 42, 500, 500, 50, 500, 500, 446, 500, 74, 498, 92, 500, 500, 136, 42, 500, 500, 500, 148, 500, 22, 50, 66, 500, 500, 34, 50, 500, 500, 102, 38, 500, 32, 42, 136, 500, 32, 32, 294, 500, 44, 60, 500, 36, 500, 500, 500, 500, 142, 500, 38, 46, 32, 164, 500, 500, 38, 80, 500, 40, 500, 500, 40, 54, 42, 100, 68, 54, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813570352328714, "mean_inference_ms": 1.211796748140874, "mean_action_processing_ms": 0.14147082749035994, "mean_env_wait_ms": 0.08441313897208401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000499725341797, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.11300420761108398}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.1909999999997936, "episode_len_mean": 273.64, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 46.3, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 26.499999999999936, -50.00000000000044, 47.5, 47.5, 44.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 5.499999999999638, -50.00000000000044, 42.70000000000001, 0.2999999999995637, 40.90000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 47.9, 45.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.3, -50.00000000000044, 46.9, 45.9, 36.50000000000003, -50.00000000000044, 46.9, 46.9, 20.699999999999854, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.3, 45.5, 46.9, 33.70000000000004, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 45.9, 40.10000000000002, 43.30000000000001, 44.7, -50.00000000000044, 40.500000000000014], "episode_lengths": [136, 500, 500, 92, 500, 500, 500, 32, 500, 38, 38, 500, 30, 500, 500, 30, 100, 236, 500, 26, 26, 52, 500, 298, 500, 42, 500, 500, 500, 56, 42, 500, 500, 50, 500, 500, 446, 500, 74, 498, 92, 500, 500, 136, 42, 500, 500, 500, 148, 500, 22, 50, 66, 500, 500, 34, 50, 500, 500, 102, 38, 500, 32, 42, 136, 500, 32, 32, 294, 500, 44, 60, 500, 36, 500, 500, 500, 500, 142, 500, 38, 46, 32, 164, 500, 500, 38, 80, 500, 40, 500, 500, 40, 54, 42, 100, 68, 54, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813570352328714, "mean_inference_ms": 1.211796748140874, "mean_action_processing_ms": 0.14147082749035994, "mean_env_wait_ms": 0.08441313897208401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000499725341797, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.11300420761108398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5827.127646231648, "num_env_steps_trained_throughput_per_sec": 5827.127646231648, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3235.612, "sample_time_ms": 2872.197, "load_time_ms": 18.0, "load_throughput": 1000023.472, "learn_time_ms": 334.415, "learn_throughput": 53825.317, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1845, "training_iteration": 27, "trial_id": "9f288_00004", "date": "2023-10-25_15-49-57", "timestamp": 1698245397, "time_this_iter_s": 3.0939974784851074, "time_total_s": 87.169269323349, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.169269323349, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.95, "ram_util_percent": 27.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 7.034127182430691, "policy_loss": -0.00019947191079457602, "vf_loss": 7.034373212743689, "vf_explained_var": -3.1943674440737125e-06, "kl": 0.0004961730469024891, "entropy": 0.46612406991146227, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.339999999999818, "episode_len_mean": 257.24, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 20.699999999999854, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.3, 45.5, 46.9, 33.70000000000004, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 45.9, 40.10000000000002, 43.30000000000001, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 45.9, 46.099999999999994, 45.9, 15.099999999999774, 27.299999999999947, 45.7, 47.5, 28.499999999999964, 43.30000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.7, 35.30000000000004, -50.00000000000044, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 9.699999999999697, 44.900000000000006, 45.5, 34.70000000000004, -50.00000000000044, 2.8999999999996007, 46.699999999999996, -50.00000000000044, 45.3, 46.3, 47.5, 35.10000000000004, -50.00000000000044, 18.29999999999982, 37.50000000000003, -50.00000000000044, 11.499999999999723, -50.00000000000044, 44.7, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.29999999999989, 16.29999999999979, 45.1, 31.500000000000007, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994], "episode_lengths": [32, 294, 500, 44, 60, 500, 36, 500, 500, 500, 500, 142, 500, 38, 46, 32, 164, 500, 500, 38, 80, 500, 40, 500, 500, 40, 54, 42, 100, 68, 54, 500, 96, 500, 64, 500, 500, 44, 100, 500, 500, 500, 54, 500, 472, 500, 42, 40, 42, 350, 228, 44, 26, 216, 68, 500, 500, 168, 44, 148, 500, 46, 46, 500, 500, 500, 368, 404, 52, 46, 154, 500, 472, 34, 500, 48, 38, 26, 150, 500, 318, 126, 500, 386, 500, 54, 26, 500, 40, 500, 176, 500, 268, 338, 50, 186, 136, 46, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38133181376468933, "mean_inference_ms": 1.211554037064576, "mean_action_processing_ms": 0.14161492013435947, "mean_env_wait_ms": 0.08461832219322972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027988433837890625, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.11399507522583008}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.339999999999818, "episode_len_mean": 257.24, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 20.699999999999854, -50.00000000000044, 45.7, 44.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 46.3, 45.5, 46.9, 33.70000000000004, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 45.9, 40.10000000000002, 43.30000000000001, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 45.9, 46.099999999999994, 45.9, 15.099999999999774, 27.299999999999947, 45.7, 47.5, 28.499999999999964, 43.30000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.7, 35.30000000000004, -50.00000000000044, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.299999999999748, 9.699999999999697, 44.900000000000006, 45.5, 34.70000000000004, -50.00000000000044, 2.8999999999996007, 46.699999999999996, -50.00000000000044, 45.3, 46.3, 47.5, 35.10000000000004, -50.00000000000044, 18.29999999999982, 37.50000000000003, -50.00000000000044, 11.499999999999723, -50.00000000000044, 44.7, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.29999999999989, 16.29999999999979, 45.1, 31.500000000000007, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994], "episode_lengths": [32, 294, 500, 44, 60, 500, 36, 500, 500, 500, 500, 142, 500, 38, 46, 32, 164, 500, 500, 38, 80, 500, 40, 500, 500, 40, 54, 42, 100, 68, 54, 500, 96, 500, 64, 500, 500, 44, 100, 500, 500, 500, 54, 500, 472, 500, 42, 40, 42, 350, 228, 44, 26, 216, 68, 500, 500, 168, 44, 148, 500, 46, 46, 500, 500, 500, 368, 404, 52, 46, 154, 500, 472, 34, 500, 48, 38, 26, 150, 500, 318, 126, 500, 386, 500, 54, 26, 500, 40, 500, 176, 500, 268, 338, 50, 186, 136, 46, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38133181376468933, "mean_inference_ms": 1.211554037064576, "mean_action_processing_ms": 0.14161492013435947, "mean_env_wait_ms": 0.08461832219322972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027988433837890625, "StateBufferConnector_ms": 0.0029981136322021484, "ViewRequirementAgentConnector_ms": 0.11399507522583008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5523.166508854883, "num_env_steps_trained_throughput_per_sec": 5523.166508854883, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3218.112, "sample_time_ms": 2847.897, "load_time_ms": 18.9, "load_throughput": 952397.119, "learn_time_ms": 340.215, "learn_throughput": 52907.695, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1912, "training_iteration": 28, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-00", "timestamp": 1698245400, "time_this_iter_s": 3.2639994621276855, "time_total_s": 90.43326878547668, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.43326878547668, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 59.879999999999995, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.69224269301803, "policy_loss": -2.6566010934335214e-05, "vf_loss": 6.6923153312117964, "vf_explained_var": -9.161454659921152e-07, "kl": 0.00027518569685474963, "entropy": 0.4611587601679343, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.402999999999826, "episode_len_mean": 261.6, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.8999999999996007, 46.699999999999996, -50.00000000000044, 45.3, 46.3, 47.5, 35.10000000000004, -50.00000000000044, 18.29999999999982, 37.50000000000003, -50.00000000000044, 11.499999999999723, -50.00000000000044, 44.7, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.29999999999989, 16.29999999999979, 45.1, 31.500000000000007, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 40.10000000000002, 38.700000000000024, -50.00000000000044, 47.1, 40.90000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, 46.099999999999994, 45.1, -50.00000000000044, 12.499999999999737, -50.00000000000044, 38.90000000000002, 45.3, 40.30000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 29.899999999999984, 44.900000000000006, 41.70000000000002, -50.00000000000044, 45.1, 36.900000000000034, 44.900000000000006, 44.900000000000006, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 43.900000000000006, 46.099999999999994, 31.70000000000001, 33.30000000000003, -50.00000000000044, 38.700000000000024, 37.300000000000026, 32.700000000000024, 39.70000000000002], "episode_lengths": [500, 472, 34, 500, 48, 38, 26, 150, 500, 318, 126, 500, 386, 500, 54, 26, 500, 40, 500, 176, 500, 268, 338, 50, 186, 136, 46, 500, 40, 500, 236, 500, 500, 140, 500, 500, 28, 118, 500, 500, 68, 70, 100, 114, 500, 30, 92, 500, 76, 500, 500, 130, 500, 80, 500, 500, 500, 196, 40, 50, 500, 376, 500, 112, 48, 98, 162, 500, 500, 46, 500, 202, 52, 84, 500, 50, 132, 52, 52, 38, 500, 48, 500, 500, 264, 118, 500, 500, 500, 120, 106, 62, 40, 184, 168, 500, 114, 128, 174, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38088871861859686, "mean_inference_ms": 1.2113641351345803, "mean_action_processing_ms": 0.14108864616160766, "mean_env_wait_ms": 0.08429675654028765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0359950065612793, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.09901070594787598}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.402999999999826, "episode_len_mean": 261.6, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 2.8999999999996007, 46.699999999999996, -50.00000000000044, 45.3, 46.3, 47.5, 35.10000000000004, -50.00000000000044, 18.29999999999982, 37.50000000000003, -50.00000000000044, 11.499999999999723, -50.00000000000044, 44.7, 47.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.50000000000002, -50.00000000000044, 23.29999999999989, 16.29999999999979, 45.1, 31.500000000000007, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.10000000000001, 40.10000000000002, 38.700000000000024, -50.00000000000044, 47.1, 40.90000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, 46.099999999999994, 45.1, -50.00000000000044, 12.499999999999737, -50.00000000000044, 38.90000000000002, 45.3, 40.30000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 29.899999999999984, 44.900000000000006, 41.70000000000002, -50.00000000000044, 45.1, 36.900000000000034, 44.900000000000006, 44.900000000000006, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 43.900000000000006, 46.099999999999994, 31.70000000000001, 33.30000000000003, -50.00000000000044, 38.700000000000024, 37.300000000000026, 32.700000000000024, 39.70000000000002], "episode_lengths": [500, 472, 34, 500, 48, 38, 26, 150, 500, 318, 126, 500, 386, 500, 54, 26, 500, 40, 500, 176, 500, 268, 338, 50, 186, 136, 46, 500, 40, 500, 236, 500, 500, 140, 500, 500, 28, 118, 500, 500, 68, 70, 100, 114, 500, 30, 92, 500, 76, 500, 500, 130, 500, 80, 500, 500, 500, 196, 40, 50, 500, 376, 500, 112, 48, 98, 162, 500, 500, 46, 500, 202, 52, 84, 500, 50, 132, 52, 52, 38, 500, 48, 500, 500, 264, 118, 500, 500, 500, 120, 106, 62, 40, 184, 168, 500, 114, 128, 174, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38088871861859686, "mean_inference_ms": 1.2113641351345803, "mean_action_processing_ms": 0.14108864616160766, "mean_env_wait_ms": 0.08429675654028765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0359950065612793, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.09901070594787598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5741.626375070499, "num_env_steps_trained_throughput_per_sec": 5741.626375070499, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3203.012, "sample_time_ms": 2838.997, "load_time_ms": 18.2, "load_throughput": 989026.961, "learn_time_ms": 334.716, "learn_throughput": 53776.916, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 1983, "training_iteration": 29, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-03", "timestamp": 1698245403, "time_this_iter_s": 3.140000104904175, "time_total_s": 93.57326889038086, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.57326889038086, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.975, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.516069588837801, "policy_loss": -9.081983524892066e-05, "vf_loss": 6.51620919616134, "vf_explained_var": -7.483694288465712e-07, "kl": 0.00036033550705909603, "entropy": 0.487636829967852, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.357999999999857, "episode_len_mean": 227.1, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 36.900000000000034, 44.900000000000006, 44.900000000000006, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 43.900000000000006, 46.099999999999994, 31.70000000000001, 33.30000000000003, -50.00000000000044, 38.700000000000024, 37.300000000000026, 32.700000000000024, 39.70000000000002, -50.00000000000044, 43.30000000000001, 42.70000000000001, 39.90000000000002, -50.00000000000044, 20.299999999999848, 39.300000000000026, 45.1, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 15.299999999999777, -50.00000000000044, 21.699999999999868, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 46.3, 35.70000000000003, 45.9, 32.100000000000016, -50.00000000000044, 45.1, 45.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.70000000000002, 36.70000000000003, 41.90000000000001, -50.00000000000044, 20.899999999999856, 44.900000000000006, 46.9, 44.7, -50.00000000000044, 24.69999999999991, 33.70000000000004, 44.5, 45.1, 47.5, 46.099999999999994, 45.3, 46.099999999999994, 46.099999999999994, 46.099999999999994, 41.90000000000001, 27.899999999999956, 41.500000000000014, 32.50000000000002, 44.5, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.099999999999994, 39.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [500, 50, 132, 52, 52, 38, 500, 48, 500, 500, 264, 118, 500, 500, 500, 120, 106, 62, 40, 184, 168, 500, 114, 128, 174, 104, 500, 68, 74, 102, 500, 298, 108, 50, 36, 500, 500, 500, 500, 500, 102, 348, 500, 284, 500, 76, 500, 500, 62, 58, 38, 144, 42, 180, 500, 50, 44, 500, 500, 34, 500, 500, 38, 34, 500, 500, 84, 134, 82, 500, 292, 52, 32, 54, 500, 254, 164, 56, 50, 26, 40, 48, 40, 40, 40, 82, 222, 86, 176, 56, 80, 500, 60, 40, 110, 34, 500, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3797428750406125, "mean_inference_ms": 1.2087836420314795, "mean_action_processing_ms": 0.14105038636080752, "mean_env_wait_ms": 0.08431334637050447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398371696472168, "StateBufferConnector_ms": 0.004992008209228516, "ViewRequirementAgentConnector_ms": 0.0910038948059082}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.357999999999857, "episode_len_mean": 227.1, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 36.900000000000034, 44.900000000000006, 44.900000000000006, 46.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 43.900000000000006, 46.099999999999994, 31.70000000000001, 33.30000000000003, -50.00000000000044, 38.700000000000024, 37.300000000000026, 32.700000000000024, 39.70000000000002, -50.00000000000044, 43.30000000000001, 42.70000000000001, 39.90000000000002, -50.00000000000044, 20.299999999999848, 39.300000000000026, 45.1, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 15.299999999999777, -50.00000000000044, 21.699999999999868, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 46.3, 35.70000000000003, 45.9, 32.100000000000016, -50.00000000000044, 45.1, 45.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.70000000000002, 36.70000000000003, 41.90000000000001, -50.00000000000044, 20.899999999999856, 44.900000000000006, 46.9, 44.7, -50.00000000000044, 24.69999999999991, 33.70000000000004, 44.5, 45.1, 47.5, 46.099999999999994, 45.3, 46.099999999999994, 46.099999999999994, 46.099999999999994, 41.90000000000001, 27.899999999999956, 41.500000000000014, 32.50000000000002, 44.5, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.099999999999994, 39.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006], "episode_lengths": [500, 50, 132, 52, 52, 38, 500, 48, 500, 500, 264, 118, 500, 500, 500, 120, 106, 62, 40, 184, 168, 500, 114, 128, 174, 104, 500, 68, 74, 102, 500, 298, 108, 50, 36, 500, 500, 500, 500, 500, 102, 348, 500, 284, 500, 76, 500, 500, 62, 58, 38, 144, 42, 180, 500, 50, 44, 500, 500, 34, 500, 500, 38, 34, 500, 500, 84, 134, 82, 500, 292, 52, 32, 54, 500, 254, 164, 56, 50, 26, 40, 48, 40, 40, 40, 82, 222, 86, 176, 56, 80, 500, 60, 40, 110, 34, 500, 500, 500, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3797428750406125, "mean_inference_ms": 1.2087836420314795, "mean_action_processing_ms": 0.14105038636080752, "mean_env_wait_ms": 0.08431334637050447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398371696472168, "StateBufferConnector_ms": 0.004992008209228516, "ViewRequirementAgentConnector_ms": 0.0910038948059082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5744.581422847307, "num_env_steps_trained_throughput_per_sec": 5744.581422847307, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3194.951, "sample_time_ms": 2826.297, "load_time_ms": 19.1, "load_throughput": 942426.098, "learn_time_ms": 338.555, "learn_throughput": 53167.196, "synch_weights_time_ms": 9.2}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2057, "training_iteration": 30, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-06", "timestamp": 1698245406, "time_this_iter_s": 3.1383841037750244, "time_total_s": 96.71165299415588, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.71165299415588, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 55.75999999999999, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.922688749101427, "policy_loss": 3.411482881616663e-05, "vf_loss": 6.92270349573206, "vf_explained_var": -8.145968119303385e-07, "kl": 0.00025864244468907805, "entropy": 0.4882783967035788, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 824.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.553999999999862, "episode_len_mean": 215.16, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 45.3, 46.099999999999994, 46.099999999999994, 46.099999999999994, 41.90000000000001, 27.899999999999956, 41.500000000000014, 32.50000000000002, 44.5, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.099999999999994, 39.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 37.50000000000003, 15.49999999999978, 40.70000000000002, 47.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.300000000000026, 40.10000000000002, 44.900000000000006, 42.30000000000001, 42.10000000000001, 45.1, 15.299999999999777, -50.00000000000044, 41.500000000000014, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, 4.699999999999626, 42.30000000000001, -50.00000000000044, 43.7, 41.30000000000001, 40.500000000000014, 40.90000000000002, 44.300000000000004, 46.699999999999996, 45.1, 42.900000000000006, -50.00000000000044, 46.9, 22.299999999999876, 44.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 31.1, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.500000000000036, 44.10000000000001, 45.9, 36.10000000000004, 46.9, -50.00000000000044, 43.10000000000001, 27.299999999999947, 44.10000000000001, 44.10000000000001], "episode_lengths": [40, 48, 40, 40, 40, 82, 222, 86, 176, 56, 80, 500, 60, 40, 110, 34, 500, 500, 500, 52, 500, 150, 500, 500, 36, 62, 126, 346, 94, 28, 500, 66, 500, 118, 100, 52, 78, 80, 50, 348, 500, 86, 120, 500, 500, 500, 146, 58, 500, 500, 500, 52, 68, 454, 78, 500, 64, 88, 96, 92, 58, 34, 50, 72, 500, 32, 278, 60, 66, 500, 500, 500, 34, 50, 500, 84, 500, 56, 190, 500, 52, 28, 500, 32, 120, 500, 500, 500, 40, 500, 146, 60, 42, 140, 32, 500, 70, 228, 60, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37999382242478985, "mean_inference_ms": 1.2108077470898682, "mean_action_processing_ms": 0.14102987301583003, "mean_env_wait_ms": 0.08434510539008486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030998945236206055, "StateBufferConnector_ms": 0.007993936538696289, "ViewRequirementAgentConnector_ms": 0.11999344825744629}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.553999999999862, "episode_len_mean": 215.16, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 45.3, 46.099999999999994, 46.099999999999994, 46.099999999999994, 41.90000000000001, 27.899999999999956, 41.500000000000014, 32.50000000000002, 44.5, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.099999999999994, 39.10000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 37.50000000000003, 15.49999999999978, 40.70000000000002, 47.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.300000000000026, 40.10000000000002, 44.900000000000006, 42.30000000000001, 42.10000000000001, 45.1, 15.299999999999777, -50.00000000000044, 41.500000000000014, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.30000000000001, 4.699999999999626, 42.30000000000001, -50.00000000000044, 43.7, 41.30000000000001, 40.500000000000014, 40.90000000000002, 44.300000000000004, 46.699999999999996, 45.1, 42.900000000000006, -50.00000000000044, 46.9, 22.299999999999876, 44.10000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 31.1, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.500000000000036, 44.10000000000001, 45.9, 36.10000000000004, 46.9, -50.00000000000044, 43.10000000000001, 27.299999999999947, 44.10000000000001, 44.10000000000001], "episode_lengths": [40, 48, 40, 40, 40, 82, 222, 86, 176, 56, 80, 500, 60, 40, 110, 34, 500, 500, 500, 52, 500, 150, 500, 500, 36, 62, 126, 346, 94, 28, 500, 66, 500, 118, 100, 52, 78, 80, 50, 348, 500, 86, 120, 500, 500, 500, 146, 58, 500, 500, 500, 52, 68, 454, 78, 500, 64, 88, 96, 92, 58, 34, 50, 72, 500, 32, 278, 60, 66, 500, 500, 500, 34, 50, 500, 84, 500, 56, 190, 500, 52, 28, 500, 32, 120, 500, 500, 500, 40, 500, 146, 60, 42, 140, 32, 500, 70, 228, 60, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37999382242478985, "mean_inference_ms": 1.2108077470898682, "mean_action_processing_ms": 0.14102987301583003, "mean_env_wait_ms": 0.08434510539008486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030998945236206055, "StateBufferConnector_ms": 0.007993936538696289, "ViewRequirementAgentConnector_ms": 0.11999344825744629}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5501.215955168033, "num_env_steps_trained_throughput_per_sec": 5501.215955168033, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3189.854, "sample_time_ms": 2838.5, "load_time_ms": 17.8, "load_throughput": 1011249.652, "learn_time_ms": 322.355, "learn_throughput": 55839.128, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2137, "training_iteration": 31, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-09", "timestamp": 1698245409, "time_this_iter_s": 3.2769994735717773, "time_total_s": 99.98865246772766, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 99.98865246772766, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 70.325, "ram_util_percent": 27.075000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.804876451139097, "policy_loss": -0.00025821697932702526, "vf_loss": 6.8051816445809825, "vf_explained_var": -3.234103873923973e-06, "kl": 0.0003679371229820929, "entropy": 0.46887358360820347, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.064999999999841, "episode_len_mean": 245.0, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 31.1, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.500000000000036, 44.10000000000001, 45.9, 36.10000000000004, 46.9, -50.00000000000044, 43.10000000000001, 27.299999999999947, 44.10000000000001, 44.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 23.699999999999896, 21.699999999999868, 23.499999999999893, -50.00000000000044, 46.099999999999994, 31.900000000000013, 46.099999999999994, 42.70000000000001, 43.900000000000006, 44.10000000000001, 46.5, -50.00000000000044, 43.7, 38.300000000000026, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.500000000000036, 46.3, 44.10000000000001, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 15.699999999999783, 46.5, 45.7, 21.499999999999865, 15.299999999999777, 44.900000000000006, 28.09999999999996, -50.00000000000044, 36.70000000000003, 41.70000000000002, 45.9, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 46.699999999999996, 42.500000000000014, -50.00000000000044, 37.70000000000003, 38.300000000000026, 39.10000000000002, -50.00000000000044], "episode_lengths": [500, 84, 500, 56, 190, 500, 52, 28, 500, 32, 120, 500, 500, 500, 40, 500, 146, 60, 42, 140, 32, 500, 70, 228, 60, 60, 500, 56, 500, 90, 500, 264, 284, 266, 500, 40, 182, 40, 74, 62, 60, 36, 500, 64, 118, 86, 42, 500, 500, 106, 146, 38, 60, 60, 500, 80, 500, 46, 500, 344, 36, 44, 286, 348, 52, 220, 500, 134, 84, 42, 500, 58, 76, 500, 176, 500, 500, 500, 62, 72, 500, 198, 500, 50, 250, 500, 500, 500, 500, 68, 500, 198, 500, 34, 76, 500, 124, 118, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806357027772503, "mean_inference_ms": 1.2118699852759611, "mean_action_processing_ms": 0.14172932061012594, "mean_env_wait_ms": 0.08450333672092945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.1349952220916748}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.064999999999841, "episode_len_mean": 245.0, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 31.1, -50.00000000000044, 44.900000000000006, 47.3, -50.00000000000044, 46.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 35.500000000000036, 44.10000000000001, 45.9, 36.10000000000004, 46.9, -50.00000000000044, 43.10000000000001, 27.299999999999947, 44.10000000000001, 44.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 23.699999999999896, 21.699999999999868, 23.499999999999893, -50.00000000000044, 46.099999999999994, 31.900000000000013, 46.099999999999994, 42.70000000000001, 43.900000000000006, 44.10000000000001, 46.5, -50.00000000000044, 43.7, 38.300000000000026, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.500000000000036, 46.3, 44.10000000000001, 44.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 15.699999999999783, 46.5, 45.7, 21.499999999999865, 15.299999999999777, 44.900000000000006, 28.09999999999996, -50.00000000000044, 36.70000000000003, 41.70000000000002, 45.9, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 46.699999999999996, 42.500000000000014, -50.00000000000044, 37.70000000000003, 38.300000000000026, 39.10000000000002, -50.00000000000044], "episode_lengths": [500, 84, 500, 56, 190, 500, 52, 28, 500, 32, 120, 500, 500, 500, 40, 500, 146, 60, 42, 140, 32, 500, 70, 228, 60, 60, 500, 56, 500, 90, 500, 264, 284, 266, 500, 40, 182, 40, 74, 62, 60, 36, 500, 64, 118, 86, 42, 500, 500, 106, 146, 38, 60, 60, 500, 80, 500, 46, 500, 344, 36, 44, 286, 348, 52, 220, 500, 134, 84, 42, 500, 58, 76, 500, 176, 500, 500, 500, 62, 72, 500, 198, 500, 50, 250, 500, 500, 500, 500, 68, 500, 198, 500, 34, 76, 500, 124, 118, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3806357027772503, "mean_inference_ms": 1.2118699852759611, "mean_action_processing_ms": 0.14172932061012594, "mean_env_wait_ms": 0.08450333672092945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199697494506836, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.1349952220916748}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5053.342459551492, "num_env_steps_trained_throughput_per_sec": 5053.342459551492, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3219.854, "sample_time_ms": 2856.899, "load_time_ms": 18.9, "load_throughput": 952395.917, "learn_time_ms": 332.655, "learn_throughput": 54110.172, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2211, "training_iteration": 32, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-13", "timestamp": 1698245413, "time_this_iter_s": 3.567998170852661, "time_total_s": 103.55665063858032, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 103.55665063858032, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 63.19999999999999, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.359269583666766, "policy_loss": -0.0007173842233088282, "vf_loss": 6.360034218540898, "vf_explained_var": 3.245141771104601e-07, "kl": 0.0013534515623250501, "entropy": 0.47188829603018584, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6690000000002123, "episode_len_mean": 292.24, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 15.699999999999783, 46.5, 45.7, 21.499999999999865, 15.299999999999777, 44.900000000000006, 28.09999999999996, -50.00000000000044, 36.70000000000003, 41.70000000000002, 45.9, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 46.699999999999996, 42.500000000000014, -50.00000000000044, 37.70000000000003, 38.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 29.299999999999976, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.300000000000004, -50.00000000000044, 33.90000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.3, 27.49999999999995, -50.00000000000044, 9.099999999999689, 6.099999999999646, 41.100000000000016, 32.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 36.10000000000004, 42.70000000000001, 43.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 5.299999999999635, 39.300000000000026], "episode_lengths": [46, 500, 344, 36, 44, 286, 348, 52, 220, 500, 134, 84, 42, 500, 58, 76, 500, 176, 500, 500, 500, 62, 72, 500, 198, 500, 50, 250, 500, 500, 500, 500, 68, 500, 198, 500, 34, 76, 500, 124, 118, 110, 500, 500, 500, 56, 208, 50, 500, 500, 30, 500, 500, 34, 58, 500, 162, 500, 58, 500, 500, 500, 76, 500, 28, 226, 500, 410, 440, 90, 172, 500, 500, 48, 36, 500, 500, 108, 140, 74, 62, 500, 24, 500, 50, 500, 500, 500, 500, 34, 90, 500, 500, 500, 500, 40, 500, 58, 448, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815791867296276, "mean_inference_ms": 1.2128398468001194, "mean_action_processing_ms": 0.141472354290477, "mean_env_wait_ms": 0.08433657429006214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997835159301758, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.134033203125}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6690000000002123, "episode_len_mean": 292.24, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 15.699999999999783, 46.5, 45.7, 21.499999999999865, 15.299999999999777, 44.900000000000006, 28.09999999999996, -50.00000000000044, 36.70000000000003, 41.70000000000002, 45.9, -50.00000000000044, 44.300000000000004, 42.500000000000014, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, 46.699999999999996, 42.500000000000014, -50.00000000000044, 37.70000000000003, 38.300000000000026, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 29.299999999999976, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.300000000000004, -50.00000000000044, 33.90000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.3, 27.49999999999995, -50.00000000000044, 9.099999999999689, 6.099999999999646, 41.100000000000016, 32.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, 39.300000000000026, 36.10000000000004, 42.70000000000001, 43.900000000000006, -50.00000000000044, 47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 5.299999999999635, 39.300000000000026], "episode_lengths": [46, 500, 344, 36, 44, 286, 348, 52, 220, 500, 134, 84, 42, 500, 58, 76, 500, 176, 500, 500, 500, 62, 72, 500, 198, 500, 50, 250, 500, 500, 500, 500, 68, 500, 198, 500, 34, 76, 500, 124, 118, 110, 500, 500, 500, 56, 208, 50, 500, 500, 30, 500, 500, 34, 58, 500, 162, 500, 58, 500, 500, 500, 76, 500, 28, 226, 500, 410, 440, 90, 172, 500, 500, 48, 36, 500, 500, 108, 140, 74, 62, 500, 24, 500, 50, 500, 500, 500, 500, 34, 90, 500, 500, 500, 500, 40, 500, 58, 448, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3815791867296276, "mean_inference_ms": 1.2128398468001194, "mean_action_processing_ms": 0.141472354290477, "mean_env_wait_ms": 0.08433657429006214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997835159301758, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.134033203125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5272.406207038053, "num_env_steps_trained_throughput_per_sec": 5272.406207038053, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3249.454, "sample_time_ms": 2882.399, "load_time_ms": 18.9, "load_throughput": 952388.709, "learn_time_ms": 336.755, "learn_throughput": 53451.377, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2268, "training_iteration": 33, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-16", "timestamp": 1698245416, "time_this_iter_s": 3.418999433517456, "time_total_s": 106.97565007209778, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.97565007209778, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 61.6, "ram_util_percent": 27.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.8045549392700195, "policy_loss": 4.841994356226038e-05, "vf_loss": 6.804553650043629, "vf_explained_var": 2.604943734628183e-07, "kl": 0.0006121556983139777, "entropy": 0.4701188306013743, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.389999999999823, "episode_len_mean": 246.72, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 5.299999999999635, 39.300000000000026, -50.00000000000044, 42.30000000000001, 45.3, 1.8999999999995865, 44.900000000000006, -50.00000000000044, 37.10000000000003, 45.5, 44.7, 40.30000000000002, 39.300000000000026, 26.299999999999933, 44.5, 46.699999999999996, 46.9, 35.500000000000036, 42.30000000000001, 43.900000000000006, 45.7, -50.00000000000044, 44.10000000000001, 36.70000000000003, 45.7, 46.9, -50.00000000000044, 44.7, 45.9, 47.1, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 41.70000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 47.9, -50.00000000000044, 47.7, -50.00000000000044, 46.699999999999996, 40.90000000000002, 36.10000000000004, 46.5, 47.7, 27.099999999999945, 45.3, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.099999999999994, 43.7, 44.7, 46.099999999999994, -50.00000000000044, 16.499999999999794, 44.10000000000001], "episode_lengths": [24, 500, 50, 500, 500, 500, 500, 34, 90, 500, 500, 500, 500, 40, 500, 58, 448, 108, 500, 78, 48, 482, 52, 500, 130, 46, 54, 98, 108, 238, 56, 34, 32, 146, 78, 62, 44, 500, 60, 134, 44, 32, 500, 54, 42, 30, 500, 500, 312, 500, 36, 500, 500, 500, 500, 500, 54, 26, 500, 500, 500, 42, 500, 500, 500, 24, 84, 76, 500, 500, 54, 500, 34, 36, 62, 500, 500, 500, 286, 22, 500, 24, 500, 34, 92, 140, 36, 24, 230, 48, 168, 500, 100, 40, 64, 54, 40, 500, 336, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.381404213165784, "mean_inference_ms": 1.2143626519251263, "mean_action_processing_ms": 0.14180774272170166, "mean_env_wait_ms": 0.08448776236726382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02060842514038086, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12401080131530762}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.389999999999823, "episode_len_mean": 246.72, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.7, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 5.299999999999635, 39.300000000000026, -50.00000000000044, 42.30000000000001, 45.3, 1.8999999999995865, 44.900000000000006, -50.00000000000044, 37.10000000000003, 45.5, 44.7, 40.30000000000002, 39.300000000000026, 26.299999999999933, 44.5, 46.699999999999996, 46.9, 35.500000000000036, 42.30000000000001, 43.900000000000006, 45.7, -50.00000000000044, 44.10000000000001, 36.70000000000003, 45.7, 46.9, -50.00000000000044, 44.7, 45.9, 47.1, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 41.70000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 47.9, -50.00000000000044, 47.7, -50.00000000000044, 46.699999999999996, 40.90000000000002, 36.10000000000004, 46.5, 47.7, 27.099999999999945, 45.3, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.099999999999994, 43.7, 44.7, 46.099999999999994, -50.00000000000044, 16.499999999999794, 44.10000000000001], "episode_lengths": [24, 500, 50, 500, 500, 500, 500, 34, 90, 500, 500, 500, 500, 40, 500, 58, 448, 108, 500, 78, 48, 482, 52, 500, 130, 46, 54, 98, 108, 238, 56, 34, 32, 146, 78, 62, 44, 500, 60, 134, 44, 32, 500, 54, 42, 30, 500, 500, 312, 500, 36, 500, 500, 500, 500, 500, 54, 26, 500, 500, 500, 42, 500, 500, 500, 24, 84, 76, 500, 500, 54, 500, 34, 36, 62, 500, 500, 500, 286, 22, 500, 24, 500, 34, 92, 140, 36, 24, 230, 48, 168, 500, 100, 40, 64, 54, 40, 500, 336, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.381404213165784, "mean_inference_ms": 1.2143626519251263, "mean_action_processing_ms": 0.14180774272170166, "mean_env_wait_ms": 0.08448776236726382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02060842514038086, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.12401080131530762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5591.796448831127, "num_env_steps_trained_throughput_per_sec": 5591.796448831127, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3255.754, "sample_time_ms": 2886.499, "load_time_ms": 19.8, "load_throughput": 909107.54, "learn_time_ms": 337.955, "learn_throughput": 53261.578, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2350, "training_iteration": 34, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-20", "timestamp": 1698245420, "time_this_iter_s": 3.2240006923675537, "time_total_s": 110.19965076446533, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 110.19965076446533, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.760000000000005, "ram_util_percent": 27.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.406062373408565, "policy_loss": -0.00015015769060011262, "vf_loss": 6.406254839014124, "vf_explained_var": -2.876476005271629e-06, "kl": 0.0004773845017527694, "entropy": 0.4229229854212867, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.506999999999837, "episode_len_mean": 240.56, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 47.9, -50.00000000000044, 47.7, -50.00000000000044, 46.699999999999996, 40.90000000000002, 36.10000000000004, 46.5, 47.7, 27.099999999999945, 45.3, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.099999999999994, 43.7, 44.7, 46.099999999999994, -50.00000000000044, 16.499999999999794, 44.10000000000001, -50.00000000000044, 33.30000000000003, 46.099999999999994, 45.3, 45.5, 44.900000000000006, -50.00000000000044, 32.50000000000002, 45.9, -50.00000000000044, 33.90000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, 35.500000000000036, 33.10000000000003, 41.500000000000014, 46.9, 42.30000000000001, 46.9, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 47.5, 40.500000000000014, -50.00000000000044, 45.7, 44.10000000000001, 41.70000000000002, 42.70000000000001, -50.00000000000044, 44.300000000000004, 27.099999999999945, -50.00000000000044, 44.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, 46.099999999999994, 41.500000000000014, 47.1], "episode_lengths": [500, 54, 500, 34, 36, 62, 500, 500, 500, 286, 22, 500, 24, 500, 34, 92, 140, 36, 24, 230, 48, 168, 500, 100, 40, 64, 54, 40, 500, 336, 60, 500, 168, 40, 48, 46, 52, 500, 176, 42, 500, 162, 36, 500, 500, 500, 500, 500, 46, 500, 500, 64, 500, 52, 42, 500, 500, 158, 146, 170, 86, 32, 78, 32, 500, 146, 500, 54, 500, 76, 26, 96, 500, 44, 60, 84, 74, 500, 58, 230, 500, 56, 500, 154, 500, 500, 130, 500, 282, 500, 500, 50, 500, 500, 500, 80, 40, 40, 86, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3818964721006833, "mean_inference_ms": 1.2140499270624325, "mean_action_processing_ms": 0.1417054858241924, "mean_env_wait_ms": 0.0844699046263019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.12601232528686523}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.506999999999837, "episode_len_mean": 240.56, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 46.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 47.9, -50.00000000000044, 47.7, -50.00000000000044, 46.699999999999996, 40.90000000000002, 36.10000000000004, 46.5, 47.7, 27.099999999999945, 45.3, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.099999999999994, 43.7, 44.7, 46.099999999999994, -50.00000000000044, 16.499999999999794, 44.10000000000001, -50.00000000000044, 33.30000000000003, 46.099999999999994, 45.3, 45.5, 44.900000000000006, -50.00000000000044, 32.50000000000002, 45.9, -50.00000000000044, 33.90000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 34.30000000000004, 35.500000000000036, 33.10000000000003, 41.500000000000014, 46.9, 42.30000000000001, 46.9, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 47.5, 40.500000000000014, -50.00000000000044, 45.7, 44.10000000000001, 41.70000000000002, 42.70000000000001, -50.00000000000044, 44.300000000000004, 27.099999999999945, -50.00000000000044, 44.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, 46.099999999999994, 41.500000000000014, 47.1], "episode_lengths": [500, 54, 500, 34, 36, 62, 500, 500, 500, 286, 22, 500, 24, 500, 34, 92, 140, 36, 24, 230, 48, 168, 500, 100, 40, 64, 54, 40, 500, 336, 60, 500, 168, 40, 48, 46, 52, 500, 176, 42, 500, 162, 36, 500, 500, 500, 500, 500, 46, 500, 500, 64, 500, 52, 42, 500, 500, 158, 146, 170, 86, 32, 78, 32, 500, 146, 500, 54, 500, 76, 26, 96, 500, 44, 60, 84, 74, 500, 58, 230, 500, 56, 500, 154, 500, 500, 130, 500, 282, 500, 500, 50, 500, 500, 500, 80, 40, 40, 86, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3818964721006833, "mean_inference_ms": 1.2140499270624325, "mean_action_processing_ms": 0.1417054858241924, "mean_env_wait_ms": 0.0844699046263019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799701690673828, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.12601232528686523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5395.683508766814, "num_env_steps_trained_throughput_per_sec": 5395.683508766814, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3267.139, "sample_time_ms": 2901.7, "load_time_ms": 18.899, "load_throughput": 952406.73, "learn_time_ms": 335.14, "learn_throughput": 53708.93, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2419, "training_iteration": 35, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-23", "timestamp": 1698245423, "time_this_iter_s": 3.3409993648529053, "time_total_s": 113.54065012931824, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.54065012931824, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 68.6, "ram_util_percent": 27.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.274024733790645, "policy_loss": -4.1660318082129515e-05, "vf_loss": 6.2741095401622635, "vf_explained_var": 6.843496251989294e-08, "kl": 0.0003121679743131662, "entropy": 0.43188959470501653, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.008999999999801, "episode_len_mean": 275.5, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, 33.10000000000003, 41.500000000000014, 46.9, 42.30000000000001, 46.9, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 47.5, 40.500000000000014, -50.00000000000044, 45.7, 44.10000000000001, 41.70000000000002, 42.70000000000001, -50.00000000000044, 44.300000000000004, 27.099999999999945, -50.00000000000044, 44.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, 46.099999999999994, 41.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, 47.7, 12.69999999999974, 19.299999999999834, 16.499999999999794, 43.7, 46.3, -50.00000000000044, 35.900000000000034, 45.5, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 35.900000000000034, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 27.299999999999947, 45.7, 46.9, 47.1, -50.00000000000044, 43.900000000000006, 44.5, 15.099999999999774, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.1, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [146, 170, 86, 32, 78, 32, 500, 146, 500, 54, 500, 76, 26, 96, 500, 44, 60, 84, 74, 500, 58, 230, 500, 56, 500, 154, 500, 500, 130, 500, 282, 500, 500, 50, 500, 500, 500, 80, 40, 40, 86, 30, 500, 500, 24, 374, 308, 336, 64, 38, 500, 142, 46, 500, 472, 500, 500, 56, 34, 142, 500, 58, 500, 84, 132, 500, 500, 500, 56, 62, 228, 44, 32, 30, 500, 62, 56, 350, 500, 266, 500, 500, 66, 68, 500, 500, 66, 500, 500, 500, 500, 500, 402, 50, 500, 422, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3827232856193358, "mean_inference_ms": 1.2144425723040932, "mean_action_processing_ms": 0.14145372674896112, "mean_env_wait_ms": 0.08407394705419485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996395111083984, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.13599824905395508}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.008999999999801, "episode_len_mean": 275.5, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, 33.10000000000003, 41.500000000000014, 46.9, 42.30000000000001, 46.9, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 47.5, 40.500000000000014, -50.00000000000044, 45.7, 44.10000000000001, 41.70000000000002, 42.70000000000001, -50.00000000000044, 44.300000000000004, 27.099999999999945, -50.00000000000044, 44.5, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, 46.099999999999994, 41.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, 47.7, 12.69999999999974, 19.299999999999834, 16.499999999999794, 43.7, 46.3, -50.00000000000044, 35.900000000000034, 45.5, -50.00000000000044, 2.8999999999996007, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 35.900000000000034, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 27.299999999999947, 45.7, 46.9, 47.1, -50.00000000000044, 43.900000000000006, 44.5, 15.099999999999774, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.1, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [146, 170, 86, 32, 78, 32, 500, 146, 500, 54, 500, 76, 26, 96, 500, 44, 60, 84, 74, 500, 58, 230, 500, 56, 500, 154, 500, 500, 130, 500, 282, 500, 500, 50, 500, 500, 500, 80, 40, 40, 86, 30, 500, 500, 24, 374, 308, 336, 64, 38, 500, 142, 46, 500, 472, 500, 500, 56, 34, 142, 500, 58, 500, 84, 132, 500, 500, 500, 56, 62, 228, 44, 32, 30, 500, 62, 56, 350, 500, 266, 500, 500, 66, 68, 500, 500, 66, 500, 500, 500, 500, 500, 402, 50, 500, 422, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3827232856193358, "mean_inference_ms": 1.2144425723040932, "mean_action_processing_ms": 0.14145372674896112, "mean_env_wait_ms": 0.08407394705419485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996395111083984, "StateBufferConnector_ms": 0.00799703598022461, "ViewRequirementAgentConnector_ms": 0.13599824905395508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5449.588571158815, "num_env_steps_trained_throughput_per_sec": 5449.588571158815, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3272.239, "sample_time_ms": 2913.0, "load_time_ms": 18.999, "load_throughput": 947403.801, "learn_time_ms": 328.94, "learn_throughput": 54721.26, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2477, "training_iteration": 36, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-26", "timestamp": 1698245426, "time_this_iter_s": 3.3079993724823, "time_total_s": 116.84864950180054, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.84864950180054, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 64.08, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 5.959437794155544, "policy_loss": -0.0001426220492080406, "vf_loss": 5.95962252440276, "vf_explained_var": -1.5011540165653936e-07, "kl": 0.00045501826899133584, "entropy": 0.42022131107471605, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.783000000000235, "episode_len_mean": 303.32, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 46.699999999999996, 35.900000000000034, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 27.299999999999947, 45.7, 46.9, 47.1, -50.00000000000044, 43.900000000000006, 44.5, 15.099999999999774, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.1, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.10000000000003, 46.5, 47.9, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.90000000000003, 47.3, 45.9, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 42.30000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 45.9], "episode_lengths": [56, 34, 142, 500, 58, 500, 84, 132, 500, 500, 500, 56, 62, 228, 44, 32, 30, 500, 62, 56, 350, 500, 266, 500, 500, 66, 68, 500, 500, 66, 500, 500, 500, 500, 500, 402, 50, 500, 422, 500, 500, 40, 500, 500, 500, 84, 100, 500, 500, 500, 500, 58, 170, 36, 22, 48, 500, 500, 74, 122, 28, 42, 500, 186, 500, 500, 500, 500, 36, 42, 500, 500, 500, 500, 318, 78, 500, 24, 500, 500, 72, 38, 500, 70, 500, 500, 44, 58, 500, 500, 500, 500, 500, 38, 500, 160, 500, 36, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828646156426124, "mean_inference_ms": 1.2153025885089725, "mean_action_processing_ms": 0.14166817235275114, "mean_env_wait_ms": 0.08418145947496546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299832344055176, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1399843692779541}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.783000000000235, "episode_len_mean": 303.32, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 46.699999999999996, 35.900000000000034, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, 27.299999999999947, 45.7, 46.9, 47.1, -50.00000000000044, 43.900000000000006, 44.5, 15.099999999999774, -50.00000000000044, 23.499999999999893, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.8999999999997, 45.1, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.10000000000003, 46.5, 47.9, 45.3, -50.00000000000044, -50.00000000000044, 42.70000000000001, 37.90000000000003, 47.3, 45.9, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 42.30000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 45.9], "episode_lengths": [56, 34, 142, 500, 58, 500, 84, 132, 500, 500, 500, 56, 62, 228, 44, 32, 30, 500, 62, 56, 350, 500, 266, 500, 500, 66, 68, 500, 500, 66, 500, 500, 500, 500, 500, 402, 50, 500, 422, 500, 500, 40, 500, 500, 500, 84, 100, 500, 500, 500, 500, 58, 170, 36, 22, 48, 500, 500, 74, 122, 28, 42, 500, 186, 500, 500, 500, 500, 36, 42, 500, 500, 500, 500, 318, 78, 500, 24, 500, 500, 72, 38, 500, 70, 500, 500, 44, 58, 500, 500, 500, 500, 500, 38, 500, 160, 500, 36, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828646156426124, "mean_inference_ms": 1.2153025885089725, "mean_action_processing_ms": 0.14166817235275114, "mean_env_wait_ms": 0.08418145947496546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299832344055176, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1399843692779541}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5558.981442688664, "num_env_steps_trained_throughput_per_sec": 5558.981442688664, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3287.14, "sample_time_ms": 2925.5, "load_time_ms": 19.099, "load_throughput": 942446.098, "learn_time_ms": 331.24, "learn_throughput": 54341.281, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2534, "training_iteration": 37, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-30", "timestamp": 1698245430, "time_this_iter_s": 3.243999481201172, "time_total_s": 120.09264898300171, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.09264898300171, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 59.660000000000004, "ram_util_percent": 27.240000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.71849086549547, "policy_loss": -0.0002011865101478718, "vf_loss": 6.718735659563983, "vf_explained_var": -9.602970547146267e-07, "kl": 0.0004244443993579923, "entropy": 0.43572485557308904, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8340000000002092, "episode_len_mean": 278.88, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.29999999999982, 42.30000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 43.900000000000006, 34.50000000000004, -50.00000000000044, 15.299999999999777, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 45.7, 32.100000000000016, -50.00000000000044, 46.3, 30.29999999999999, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.699999999999996, 41.70000000000002, 44.900000000000006, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.899999999999928, 42.30000000000001, 18.29999999999982, 45.7, 27.699999999999953, 44.5, 23.8999999999999, 46.699999999999996, 40.70000000000002], "episode_lengths": [500, 318, 78, 500, 24, 500, 500, 72, 38, 500, 70, 500, 500, 44, 58, 500, 500, 500, 500, 500, 38, 500, 160, 500, 36, 500, 42, 500, 500, 38, 92, 500, 500, 500, 500, 44, 40, 500, 500, 500, 24, 62, 156, 500, 348, 32, 500, 66, 500, 500, 54, 34, 500, 44, 180, 500, 38, 198, 128, 500, 500, 60, 24, 34, 500, 34, 500, 500, 154, 36, 48, 500, 500, 500, 500, 174, 34, 84, 52, 44, 32, 500, 500, 54, 38, 500, 500, 500, 78, 500, 500, 242, 78, 318, 44, 224, 56, 262, 34, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820288760940226, "mean_inference_ms": 1.2165303010747237, "mean_action_processing_ms": 0.14174470327961747, "mean_env_wait_ms": 0.08439510029631364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032996416091918945, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.12102150917053223}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8340000000002092, "episode_len_mean": 278.88, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.29999999999982, 42.30000000000001, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 34.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 43.900000000000006, 34.50000000000004, -50.00000000000044, 15.299999999999777, 46.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 45.7, 32.100000000000016, -50.00000000000044, 46.3, 30.29999999999999, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.699999999999996, 41.70000000000002, 44.900000000000006, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.899999999999928, 42.30000000000001, 18.29999999999982, 45.7, 27.699999999999953, 44.5, 23.8999999999999, 46.699999999999996, 40.70000000000002], "episode_lengths": [500, 318, 78, 500, 24, 500, 500, 72, 38, 500, 70, 500, 500, 44, 58, 500, 500, 500, 500, 500, 38, 500, 160, 500, 36, 500, 42, 500, 500, 38, 92, 500, 500, 500, 500, 44, 40, 500, 500, 500, 24, 62, 156, 500, 348, 32, 500, 66, 500, 500, 54, 34, 500, 44, 180, 500, 38, 198, 128, 500, 500, 60, 24, 34, 500, 34, 500, 500, 154, 36, 48, 500, 500, 500, 500, 174, 34, 84, 52, 44, 32, 500, 500, 54, 38, 500, 500, 500, 78, 500, 500, 242, 78, 318, 44, 224, 56, 262, 34, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820288760940226, "mean_inference_ms": 1.2165303010747237, "mean_action_processing_ms": 0.14174470327961747, "mean_env_wait_ms": 0.08439510029631364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032996416091918945, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.12102150917053223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5681.817357396849, "num_env_steps_trained_throughput_per_sec": 5681.817357396849, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3278.04, "sample_time_ms": 2921.8, "load_time_ms": 18.999, "load_throughput": 947403.801, "learn_time_ms": 326.24, "learn_throughput": 55174.139, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2607, "training_iteration": 38, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-33", "timestamp": 1698245433, "time_this_iter_s": 3.1730008125305176, "time_total_s": 123.26564979553223, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.26564979553223, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 66.025, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 5.883011641325774, "policy_loss": -0.00020729198499962135, "vf_loss": 5.883264047128183, "vf_explained_var": -1.5541359230324073e-06, "kl": 0.000619860087416176, "entropy": 0.45092514046916254, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.296000000000226, "episode_len_mean": 293.46, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 45.7, 32.100000000000016, -50.00000000000044, 46.3, 30.29999999999999, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.699999999999996, 41.70000000000002, 44.900000000000006, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.899999999999928, 42.30000000000001, 18.29999999999982, 45.7, 27.699999999999953, 44.5, 23.8999999999999, 46.699999999999996, 40.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 43.30000000000001, 46.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 9.499999999999694, -50.00000000000044], "episode_lengths": [500, 54, 34, 500, 44, 180, 500, 38, 198, 128, 500, 500, 60, 24, 34, 500, 34, 500, 500, 154, 36, 48, 500, 500, 500, 500, 174, 34, 84, 52, 44, 32, 500, 500, 54, 38, 500, 500, 500, 78, 500, 500, 242, 78, 318, 44, 224, 56, 262, 34, 94, 500, 38, 500, 78, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 64, 38, 68, 38, 46, 500, 500, 500, 500, 500, 500, 104, 500, 500, 78, 500, 42, 500, 52, 500, 500, 48, 500, 54, 500, 36, 500, 500, 22, 500, 500, 40, 86, 406, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3819822513525432, "mean_inference_ms": 1.2156681113984402, "mean_action_processing_ms": 0.1417757183561161, "mean_env_wait_ms": 0.08424764039013714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1210012435913086}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.296000000000226, "episode_len_mean": 293.46, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 45.7, 32.100000000000016, -50.00000000000044, 46.3, 30.29999999999999, 37.300000000000026, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 46.699999999999996, 41.70000000000002, 44.900000000000006, 45.7, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.899999999999928, 42.30000000000001, 18.29999999999982, 45.7, 27.699999999999953, 44.5, 23.8999999999999, 46.699999999999996, 40.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.3, 43.30000000000001, 46.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 9.499999999999694, -50.00000000000044], "episode_lengths": [500, 54, 34, 500, 44, 180, 500, 38, 198, 128, 500, 500, 60, 24, 34, 500, 34, 500, 500, 154, 36, 48, 500, 500, 500, 500, 174, 34, 84, 52, 44, 32, 500, 500, 54, 38, 500, 500, 500, 78, 500, 500, 242, 78, 318, 44, 224, 56, 262, 34, 94, 500, 38, 500, 78, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 64, 38, 68, 38, 46, 500, 500, 500, 500, 500, 500, 104, 500, 500, 78, 500, 42, 500, 52, 500, 500, 48, 500, 54, 500, 36, 500, 500, 22, 500, 500, 40, 86, 406, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3819822513525432, "mean_inference_ms": 1.2156681113984402, "mean_action_processing_ms": 0.1417757183561161, "mean_env_wait_ms": 0.08424764039013714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1210012435913086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5624.998239800885, "num_env_steps_trained_throughput_per_sec": 5624.998239800885, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3284.54, "sample_time_ms": 2930.6, "load_time_ms": 18.999, "load_throughput": 947402.612, "learn_time_ms": 323.839, "learn_throughput": 55583.225, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2656, "training_iteration": 39, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-36", "timestamp": 1698245436, "time_this_iter_s": 3.2049999237060547, "time_total_s": 126.47064971923828, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.47064971923828, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 27.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.728160134068242, "policy_loss": -8.347942666323097e-05, "vf_loss": 6.728290134006077, "vf_explained_var": -1.3245476616753472e-06, "kl": 0.00025206089745105837, "entropy": 0.46569144505041615, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.585999999999817, "episode_len_mean": 244.76, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 9.499999999999694, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 44.10000000000001, 44.10000000000001, 24.899999999999913, 45.7, 44.900000000000006, -50.00000000000044, 47.1, 47.9, -50.00000000000044, 35.30000000000004, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 43.7, 44.7, 46.699999999999996, 19.09999999999983, 40.500000000000014, 43.10000000000001, 43.900000000000006, 45.9, 47.1, 47.9, 45.7, 43.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.09999999999986, 46.9, 46.3, 44.7, 44.7, -50.00000000000044, 43.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 45.3, 46.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, 47.1, 47.3, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001], "episode_lengths": [52, 500, 500, 48, 500, 54, 500, 36, 500, 500, 22, 500, 500, 40, 86, 406, 500, 500, 430, 500, 60, 60, 252, 44, 52, 500, 30, 22, 500, 148, 54, 52, 500, 500, 38, 64, 54, 34, 310, 96, 70, 62, 42, 30, 22, 44, 68, 500, 38, 500, 500, 60, 500, 500, 290, 32, 38, 54, 54, 500, 64, 70, 500, 500, 500, 56, 48, 82, 500, 500, 200, 62, 500, 500, 500, 322, 500, 44, 42, 500, 500, 36, 54, 28, 500, 500, 354, 500, 48, 38, 34, 204, 500, 30, 28, 44, 500, 80, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38234698896233416, "mean_inference_ms": 1.216439520794014, "mean_action_processing_ms": 0.14212898235440405, "mean_env_wait_ms": 0.08418575747903378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900029182434082, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.14696359634399414}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.585999999999817, "episode_len_mean": 244.76, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 9.499999999999694, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 44.10000000000001, 44.10000000000001, 24.899999999999913, 45.7, 44.900000000000006, -50.00000000000044, 47.1, 47.9, -50.00000000000044, 35.30000000000004, 44.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 43.7, 44.7, 46.699999999999996, 19.09999999999983, 40.500000000000014, 43.10000000000001, 43.900000000000006, 45.9, 47.1, 47.9, 45.7, 43.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 21.09999999999986, 46.9, 46.3, 44.7, 44.7, -50.00000000000044, 43.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 41.90000000000001, -50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 45.3, 46.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, 47.1, 47.3, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001], "episode_lengths": [52, 500, 500, 48, 500, 54, 500, 36, 500, 500, 22, 500, 500, 40, 86, 406, 500, 500, 430, 500, 60, 60, 252, 44, 52, 500, 30, 22, 500, 148, 54, 52, 500, 500, 38, 64, 54, 34, 310, 96, 70, 62, 42, 30, 22, 44, 68, 500, 38, 500, 500, 60, 500, 500, 290, 32, 38, 54, 54, 500, 64, 70, 500, 500, 500, 56, 48, 82, 500, 500, 200, 62, 500, 500, 500, 322, 500, 44, 42, 500, 500, 36, 54, 28, 500, 500, 354, 500, 48, 38, 34, 204, 500, 30, 28, 44, 500, 80, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38234698896233416, "mean_inference_ms": 1.216439520794014, "mean_action_processing_ms": 0.14212898235440405, "mean_env_wait_ms": 0.08418575747903378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900029182434082, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.14696359634399414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5372.151116911173, "num_env_steps_trained_throughput_per_sec": 5372.151116911173, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3306.262, "sample_time_ms": 2951.1, "load_time_ms": 18.599, "load_throughput": 967777.345, "learn_time_ms": 325.562, "learn_throughput": 55289.089, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2739, "training_iteration": 40, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-39", "timestamp": 1698245439, "time_this_iter_s": 3.355611801147461, "time_total_s": 129.82626152038574, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.82626152038574, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 70.8, "ram_util_percent": 27.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.525638545000994, "policy_loss": -0.00012114699240084048, "vf_loss": 6.525805490988272, "vf_explained_var": 2.472488968460648e-07, "kl": 0.0003262329154744045, "entropy": 0.4585145976808336, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.318999999999807, "episode_len_mean": 262.4, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 45.3, 46.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, 47.1, 47.3, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.3, 42.10000000000001, 38.50000000000003, 46.3, 26.69999999999994, 17.899999999999814, 34.900000000000034, 46.9, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.30000000000002, 42.70000000000001, -50.00000000000044, 47.3, 40.500000000000014, 41.90000000000001, -50.00000000000044, 46.5, 46.5, 41.70000000000002, 44.10000000000001, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, 45.5, 37.70000000000003, 46.3, 46.099999999999994, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 37.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 500, 200, 62, 500, 500, 500, 322, 500, 44, 42, 500, 500, 36, 54, 28, 500, 500, 354, 500, 48, 38, 34, 204, 500, 30, 28, 44, 500, 80, 500, 60, 500, 46, 74, 500, 500, 500, 44, 78, 500, 500, 500, 48, 28, 80, 116, 38, 234, 322, 152, 32, 72, 56, 100, 500, 500, 136, 98, 74, 500, 28, 96, 82, 500, 36, 36, 84, 60, 500, 116, 54, 500, 500, 500, 500, 32, 500, 30, 500, 474, 500, 500, 500, 464, 500, 46, 124, 38, 40, 500, 48, 56, 500, 122, 68, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820195978647426, "mean_inference_ms": 1.2177291509406065, "mean_action_processing_ms": 0.14223597774962507, "mean_env_wait_ms": 0.08435377380920427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997451782226562, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.13100457191467285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.318999999999807, "episode_len_mean": 262.4, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 30.099999999999987, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.7, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 44.7, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 45.3, 46.3, 46.699999999999996, 29.69999999999998, -50.00000000000044, 47.1, 47.3, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 47.3, 42.10000000000001, 38.50000000000003, 46.3, 26.69999999999994, 17.899999999999814, 34.900000000000034, 46.9, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.30000000000002, 42.70000000000001, -50.00000000000044, 47.3, 40.500000000000014, 41.90000000000001, -50.00000000000044, 46.5, 46.5, 41.70000000000002, 44.10000000000001, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, 45.5, 37.70000000000003, 46.3, 46.099999999999994, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 37.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [500, 500, 200, 62, 500, 500, 500, 322, 500, 44, 42, 500, 500, 36, 54, 28, 500, 500, 354, 500, 48, 38, 34, 204, 500, 30, 28, 44, 500, 80, 500, 60, 500, 46, 74, 500, 500, 500, 44, 78, 500, 500, 500, 48, 28, 80, 116, 38, 234, 322, 152, 32, 72, 56, 100, 500, 500, 136, 98, 74, 500, 28, 96, 82, 500, 36, 36, 84, 60, 500, 116, 54, 500, 500, 500, 500, 32, 500, 30, 500, 474, 500, 500, 500, 464, 500, 46, 124, 38, 40, 500, 48, 56, 500, 122, 68, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3820195978647426, "mean_inference_ms": 1.2177291509406065, "mean_action_processing_ms": 0.14223597774962507, "mean_env_wait_ms": 0.08435377380920427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021997451782226562, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.13100457191467285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5612.71588120211, "num_env_steps_trained_throughput_per_sec": 5612.71588120211, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3299.762, "sample_time_ms": 2930.4, "load_time_ms": 18.999, "load_throughput": 947397.856, "learn_time_ms": 339.462, "learn_throughput": 53025.153, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2807, "training_iteration": 41, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-43", "timestamp": 1698245443, "time_this_iter_s": 3.213000774383545, "time_total_s": 133.0392622947693, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 133.0392622947693, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 60.42, "ram_util_percent": 27.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.281331397868969, "policy_loss": -0.0003488287329673767, "vf_loss": 6.281725812841345, "vf_explained_var": -1.3333779794198495e-06, "kl": 0.0010681575454369791, "entropy": 0.45527094823342784, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.233000000000223, "episode_len_mean": 297.86, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 40.30000000000002, 42.70000000000001, -50.00000000000044, 47.3, 40.500000000000014, 41.90000000000001, -50.00000000000044, 46.5, 46.5, 41.70000000000002, 44.10000000000001, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, 45.5, 37.70000000000003, 46.3, 46.099999999999994, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 37.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.90000000000002, 42.900000000000006, 42.10000000000001, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 46.9, 43.30000000000001, 36.10000000000004, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.69999999999994, 39.90000000000002, -50.00000000000044, 43.10000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 16.8999999999998, 29.299999999999976, 4.899999999999629, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.1, 46.5, -50.00000000000044], "episode_lengths": [500, 136, 98, 74, 500, 28, 96, 82, 500, 36, 36, 84, 60, 500, 116, 54, 500, 500, 500, 500, 32, 500, 30, 500, 474, 500, 500, 500, 464, 500, 46, 124, 38, 40, 500, 48, 56, 500, 122, 68, 500, 500, 500, 70, 74, 52, 500, 500, 500, 500, 500, 500, 52, 112, 72, 80, 500, 158, 500, 500, 500, 500, 326, 500, 32, 68, 140, 286, 500, 500, 60, 500, 500, 44, 500, 234, 102, 500, 70, 326, 500, 500, 332, 208, 452, 500, 500, 34, 68, 500, 500, 54, 500, 118, 500, 134, 500, 50, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38224153599059546, "mean_inference_ms": 1.2189260088148133, "mean_action_processing_ms": 0.14232974684133928, "mean_env_wait_ms": 0.08436533839817041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249936580657959, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.13202524185180664}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.233000000000223, "episode_len_mean": 297.86, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 40.30000000000002, 42.70000000000001, -50.00000000000044, 47.3, 40.500000000000014, 41.90000000000001, -50.00000000000044, 46.5, 46.5, 41.70000000000002, 44.10000000000001, -50.00000000000044, 38.50000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 47.1, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, -50.00000000000044, 45.5, 37.70000000000003, 46.3, 46.099999999999994, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 37.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.90000000000002, 42.900000000000006, 42.10000000000001, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 46.9, 43.30000000000001, 36.10000000000004, 21.499999999999865, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.69999999999994, 39.90000000000002, -50.00000000000044, 43.10000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 16.8999999999998, 29.299999999999976, 4.899999999999629, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.1, 46.5, -50.00000000000044], "episode_lengths": [500, 136, 98, 74, 500, 28, 96, 82, 500, 36, 36, 84, 60, 500, 116, 54, 500, 500, 500, 500, 32, 500, 30, 500, 474, 500, 500, 500, 464, 500, 46, 124, 38, 40, 500, 48, 56, 500, 122, 68, 500, 500, 500, 70, 74, 52, 500, 500, 500, 500, 500, 500, 52, 112, 72, 80, 500, 158, 500, 500, 500, 500, 326, 500, 32, 68, 140, 286, 500, 500, 60, 500, 500, 44, 500, 234, 102, 500, 70, 326, 500, 500, 332, 208, 452, 500, 500, 34, 68, 500, 500, 54, 500, 118, 500, 134, 500, 50, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38224153599059546, "mean_inference_ms": 1.2189260088148133, "mean_action_processing_ms": 0.14232974684133928, "mean_env_wait_ms": 0.08436533839817041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249936580657959, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.13202524185180664}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5450.849989245943, "num_env_steps_trained_throughput_per_sec": 5450.849989245943, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3273.786, "sample_time_ms": 2926.3, "load_time_ms": 17.299, "load_throughput": 1040494.824, "learn_time_ms": 319.385, "learn_throughput": 56358.305, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2863, "training_iteration": 42, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-46", "timestamp": 1698245446, "time_this_iter_s": 3.3072359561920166, "time_total_s": 136.3464982509613, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.3464982509613, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 64.16, "ram_util_percent": 27.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.387987260465269, "policy_loss": -4.864953182361744e-07, "vf_loss": 6.38803047604031, "vf_explained_var": -2.0618791933412907e-06, "kl": 0.0005846268484914516, "entropy": 0.42613680605535154, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1148.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.611000000000217, "episode_len_mean": 291.64, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.69999999999994, 39.90000000000002, -50.00000000000044, 43.10000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 16.8999999999998, 29.299999999999976, 4.899999999999629, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 44.5, 24.899999999999913, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.7, 38.90000000000002, 39.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 34.70000000000004, -50.00000000000044, 46.3, 45.5, 43.900000000000006, 47.9, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 40.30000000000002, 46.099999999999994, 45.3, 27.49999999999995, 36.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 500, 60, 500, 500, 44, 500, 234, 102, 500, 70, 326, 500, 500, 332, 208, 452, 500, 500, 34, 68, 500, 500, 54, 500, 118, 500, 134, 500, 50, 36, 500, 500, 178, 500, 500, 26, 42, 500, 500, 56, 252, 56, 500, 500, 500, 52, 24, 112, 108, 28, 500, 500, 62, 72, 500, 500, 48, 500, 72, 500, 76, 500, 38, 154, 500, 38, 46, 62, 22, 56, 500, 36, 500, 74, 272, 500, 500, 86, 500, 500, 500, 500, 500, 346, 98, 40, 48, 226, 138, 146, 500, 500, 500, 500, 34, 500, 84, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3830785786621797, "mean_inference_ms": 1.219731745496545, "mean_action_processing_ms": 0.14240868777700144, "mean_env_wait_ms": 0.08415289579473201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028735637664794922, "StateBufferConnector_ms": 0.003005504608154297, "ViewRequirementAgentConnector_ms": 0.1540076732635498}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.611000000000217, "episode_len_mean": 291.64, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 26.69999999999994, 39.90000000000002, -50.00000000000044, 43.10000000000001, 17.499999999999808, -50.00000000000044, -50.00000000000044, 16.8999999999998, 29.299999999999976, 4.899999999999629, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.1, 46.5, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 44.5, 24.899999999999913, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.7, 38.90000000000002, 39.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 34.70000000000004, -50.00000000000044, 46.3, 45.5, 43.900000000000006, 47.9, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 40.30000000000002, 46.099999999999994, 45.3, 27.49999999999995, 36.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996], "episode_lengths": [500, 500, 60, 500, 500, 44, 500, 234, 102, 500, 70, 326, 500, 500, 332, 208, 452, 500, 500, 34, 68, 500, 500, 54, 500, 118, 500, 134, 500, 50, 36, 500, 500, 178, 500, 500, 26, 42, 500, 500, 56, 252, 56, 500, 500, 500, 52, 24, 112, 108, 28, 500, 500, 62, 72, 500, 500, 48, 500, 72, 500, 76, 500, 38, 154, 500, 38, 46, 62, 22, 56, 500, 36, 500, 74, 272, 500, 500, 86, 500, 500, 500, 500, 500, 346, 98, 40, 48, 226, 138, 146, 500, 500, 500, 500, 34, 500, 84, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3830785786621797, "mean_inference_ms": 1.219731745496545, "mean_action_processing_ms": 0.14240868777700144, "mean_env_wait_ms": 0.08415289579473201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028735637664794922, "StateBufferConnector_ms": 0.003005504608154297, "ViewRequirementAgentConnector_ms": 0.1540076732635498}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5545.8795122841675, "num_env_steps_trained_throughput_per_sec": 5545.8795122841675, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3256.951, "sample_time_ms": 2928.285, "load_time_ms": 15.8, "load_throughput": 1139269.787, "learn_time_ms": 301.969, "learn_throughput": 59608.866, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2931, "training_iteration": 43, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-49", "timestamp": 1698245449, "time_this_iter_s": 3.250652551651001, "time_total_s": 139.5971508026123, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.5971508026123, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 69.625, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.4190413686964245, "policy_loss": -6.51186263119733e-05, "vf_loss": 6.419145707730894, "vf_explained_var": 1.2141686898690684e-07, "kl": 0.00045337276602531854, "entropy": 0.3918577465746138, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1175.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.0190000000002226, "episode_len_mean": 295.72, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 34.70000000000004, -50.00000000000044, 46.3, 45.5, 43.900000000000006, 47.9, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 40.30000000000002, 46.099999999999994, 45.3, 27.49999999999995, 36.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 31.300000000000004, 45.3, 43.10000000000001, 39.50000000000002, 41.30000000000001, 46.099999999999994, -50.00000000000044, 27.099999999999945, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, 37.90000000000003, 14.699999999999768, 29.299999999999976, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 13.099999999999746, 47.1, 45.3, -50.00000000000044, 45.7, 47.3], "episode_lengths": [48, 500, 72, 500, 76, 500, 38, 154, 500, 38, 46, 62, 22, 56, 500, 36, 500, 74, 272, 500, 500, 86, 500, 500, 500, 500, 500, 346, 98, 40, 48, 226, 138, 146, 500, 500, 500, 500, 34, 500, 84, 500, 34, 500, 500, 500, 216, 188, 48, 70, 106, 88, 40, 500, 230, 500, 460, 500, 48, 122, 354, 208, 500, 138, 500, 38, 44, 500, 500, 488, 500, 500, 114, 30, 500, 70, 500, 500, 500, 22, 500, 500, 500, 500, 500, 500, 500, 500, 32, 500, 500, 48, 500, 76, 370, 30, 48, 500, 44, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831263236678973, "mean_inference_ms": 1.2208891443012022, "mean_action_processing_ms": 0.14257348754815563, "mean_env_wait_ms": 0.08424458152135643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.12872004508972168}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.0190000000002226, "episode_len_mean": 295.72, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.500000000000014, -50.00000000000044, 46.3, 34.70000000000004, -50.00000000000044, 46.3, 45.5, 43.900000000000006, 47.9, 44.5, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.49999999999978, 40.30000000000002, 46.099999999999994, 45.3, 27.49999999999995, 36.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, 31.300000000000004, 45.3, 43.10000000000001, 39.50000000000002, 41.30000000000001, 46.099999999999994, -50.00000000000044, 27.099999999999945, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, 37.90000000000003, 14.699999999999768, 29.299999999999976, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 13.099999999999746, 47.1, 45.3, -50.00000000000044, 45.7, 47.3], "episode_lengths": [48, 500, 72, 500, 76, 500, 38, 154, 500, 38, 46, 62, 22, 56, 500, 36, 500, 74, 272, 500, 500, 86, 500, 500, 500, 500, 500, 346, 98, 40, 48, 226, 138, 146, 500, 500, 500, 500, 34, 500, 84, 500, 34, 500, 500, 500, 216, 188, 48, 70, 106, 88, 40, 500, 230, 500, 460, 500, 48, 122, 354, 208, 500, 138, 500, 38, 44, 500, 500, 488, 500, 500, 114, 30, 500, 70, 500, 500, 500, 22, 500, 500, 500, 500, 500, 500, 500, 500, 32, 500, 500, 48, 500, 76, 370, 30, 48, 500, 44, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831263236678973, "mean_inference_ms": 1.2208891443012022, "mean_action_processing_ms": 0.14257348754815563, "mean_env_wait_ms": 0.08424458152135643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.12872004508972168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5495.864969282909, "num_env_steps_trained_throughput_per_sec": 5495.864969282909, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3262.57, "sample_time_ms": 2938.67, "load_time_ms": 14.5, "load_throughput": 1241381.515, "learn_time_ms": 298.702, "learn_throughput": 60260.771, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2988, "training_iteration": 44, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-53", "timestamp": 1698245453, "time_this_iter_s": 3.2809691429138184, "time_total_s": 142.87811994552612, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.87811994552612, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 60.720000000000006, "ram_util_percent": 27.679999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.19617674085829, "policy_loss": -0.00040221155655604824, "vf_loss": 6.196620058130335, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.000526553449752235, "entropy": 0.41074271003405255, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1202.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2850000000002244, "episode_len_mean": 288.38, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 13.099999999999746, 47.1, 45.3, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 40.500000000000014, 20.899999999999856, -50.00000000000044, 45.3, 30.099999999999987, 36.900000000000034, 45.9, 47.7, 44.900000000000006, -50.00000000000044, 12.299999999999734, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.5, 46.099999999999994, 47.3, 41.90000000000001, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, 11.899999999999729, 46.3, -50.00000000000044, 46.699999999999996, 44.5, 46.9, 47.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, 42.900000000000006, 39.90000000000002, -50.00000000000044, 47.1, 43.7, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, 43.900000000000006, 46.099999999999994], "episode_lengths": [44, 500, 500, 488, 500, 500, 114, 30, 500, 70, 500, 500, 500, 22, 500, 500, 500, 500, 500, 500, 500, 500, 32, 500, 500, 48, 500, 76, 370, 30, 48, 500, 44, 28, 500, 500, 500, 486, 96, 292, 500, 48, 200, 132, 42, 24, 52, 500, 378, 500, 500, 74, 26, 40, 28, 82, 38, 60, 500, 500, 500, 500, 500, 500, 52, 144, 500, 382, 38, 500, 34, 56, 32, 30, 182, 500, 500, 500, 70, 50, 80, 500, 500, 500, 26, 500, 500, 182, 72, 102, 500, 30, 64, 500, 500, 28, 40, 500, 62, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831689579368818, "mean_inference_ms": 1.2209998116397436, "mean_action_processing_ms": 0.14264329692766392, "mean_env_wait_ms": 0.0845312259745252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027225494384765625, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.12424039840698242}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2850000000002244, "episode_len_mean": 288.38, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, -50.00000000000044, 38.700000000000024, 47.1, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 13.099999999999746, 47.1, 45.3, -50.00000000000044, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.4999999999995808, 40.500000000000014, 20.899999999999856, -50.00000000000044, 45.3, 30.099999999999987, 36.900000000000034, 45.9, 47.7, 44.900000000000006, -50.00000000000044, 12.299999999999734, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.5, 46.099999999999994, 47.3, 41.90000000000001, 46.3, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.70000000000003, -50.00000000000044, 11.899999999999729, 46.3, -50.00000000000044, 46.699999999999996, 44.5, 46.9, 47.1, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, 42.900000000000006, 39.90000000000002, -50.00000000000044, 47.1, 43.7, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, 43.900000000000006, 46.099999999999994], "episode_lengths": [44, 500, 500, 488, 500, 500, 114, 30, 500, 70, 500, 500, 500, 22, 500, 500, 500, 500, 500, 500, 500, 500, 32, 500, 500, 48, 500, 76, 370, 30, 48, 500, 44, 28, 500, 500, 500, 486, 96, 292, 500, 48, 200, 132, 42, 24, 52, 500, 378, 500, 500, 74, 26, 40, 28, 82, 38, 60, 500, 500, 500, 500, 500, 500, 52, 144, 500, 382, 38, 500, 34, 56, 32, 30, 182, 500, 500, 500, 70, 50, 80, 500, 500, 500, 26, 500, 500, 182, 72, 102, 500, 30, 64, 500, 500, 28, 40, 500, 62, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3831689579368818, "mean_inference_ms": 1.2209998116397436, "mean_action_processing_ms": 0.14264329692766392, "mean_env_wait_ms": 0.0845312259745252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027225494384765625, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.12424039840698242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5453.876073095078, "num_env_steps_trained_throughput_per_sec": 5453.876073095078, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3259.011, "sample_time_ms": 2949.17, "load_time_ms": 13.2, "load_throughput": 1363661.309, "learn_time_ms": 285.842, "learn_throughput": 62971.812, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3054, "training_iteration": 45, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-56", "timestamp": 1698245456, "time_this_iter_s": 3.305082321166992, "time_total_s": 146.18320226669312, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.18320226669312, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 65.575, "ram_util_percent": 27.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.518242553428367, "policy_loss": -7.005674005658538e-05, "vf_loss": 6.518355422549778, "vf_explained_var": -1.0000334845648872e-06, "kl": 0.00041086626944196203, "entropy": 0.4285835833461196, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1229.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.469999999999814, "episode_len_mean": 255.9, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, 42.900000000000006, 39.90000000000002, -50.00000000000044, 47.1, 43.7, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, 43.900000000000006, 46.099999999999994, 9.699999999999697, 46.5, -50.00000000000044, 45.3, 35.10000000000004, 17.499999999999808, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 9.699999999999697, 45.9, 28.89999999999997, -50.00000000000044, 32.90000000000003, -50.00000000000044, 27.899999999999956, 46.5, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 30.29999999999999, 26.69999999999994, 46.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, 44.10000000000001, 36.70000000000003, 37.70000000000003, 13.899999999999757, -50.00000000000044, 39.300000000000026, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 47.3, 47.1, 47.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.3, 42.10000000000001, 47.7, -50.00000000000044], "episode_lengths": [182, 500, 500, 500, 70, 50, 80, 500, 500, 500, 26, 500, 500, 182, 72, 102, 500, 30, 64, 500, 500, 28, 40, 500, 62, 40, 404, 36, 500, 48, 150, 326, 46, 500, 500, 500, 50, 404, 42, 212, 500, 172, 500, 222, 36, 500, 44, 34, 500, 58, 500, 24, 500, 500, 500, 500, 500, 44, 500, 38, 500, 44, 198, 234, 36, 52, 52, 500, 60, 134, 124, 362, 500, 108, 34, 500, 500, 36, 500, 46, 500, 60, 500, 42, 28, 30, 28, 34, 500, 98, 500, 54, 500, 500, 60, 86, 28, 80, 24, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832091374610641, "mean_inference_ms": 1.2222078849493718, "mean_action_processing_ms": 0.1428469598064009, "mean_env_wait_ms": 0.08506336569319595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.006510019302368164, "ViewRequirementAgentConnector_ms": 0.11773800849914551}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.469999999999814, "episode_len_mean": 255.9, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 31.900000000000013, 42.900000000000006, 39.90000000000002, -50.00000000000044, 47.1, 43.7, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, 43.900000000000006, 46.099999999999994, 9.699999999999697, 46.5, -50.00000000000044, 45.3, 35.10000000000004, 17.499999999999808, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 9.699999999999697, 45.9, 28.89999999999997, -50.00000000000044, 32.90000000000003, -50.00000000000044, 27.899999999999956, 46.5, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 30.29999999999999, 26.69999999999994, 46.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, 44.10000000000001, 36.70000000000003, 37.70000000000003, 13.899999999999757, -50.00000000000044, 39.300000000000026, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 47.3, 47.1, 47.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.3, 42.10000000000001, 47.7, -50.00000000000044], "episode_lengths": [182, 500, 500, 500, 70, 50, 80, 500, 500, 500, 26, 500, 500, 182, 72, 102, 500, 30, 64, 500, 500, 28, 40, 500, 62, 40, 404, 36, 500, 48, 150, 326, 46, 500, 500, 500, 50, 404, 42, 212, 500, 172, 500, 222, 36, 500, 44, 34, 500, 58, 500, 24, 500, 500, 500, 500, 500, 44, 500, 38, 500, 44, 198, 234, 36, 52, 52, 500, 60, 134, 124, 362, 500, 108, 34, 500, 500, 36, 500, 46, 500, 60, 500, 42, 28, 30, 28, 34, 500, 98, 500, 54, 500, 500, 60, 86, 28, 80, 24, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3832091374610641, "mean_inference_ms": 1.2222078849493718, "mean_action_processing_ms": 0.1428469598064009, "mean_env_wait_ms": 0.08506336569319595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.006510019302368164, "ViewRequirementAgentConnector_ms": 0.11773800849914551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5543.833956099295, "num_env_steps_trained_throughput_per_sec": 5543.833956099295, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3253.396, "sample_time_ms": 2956.317, "load_time_ms": 11.849, "load_throughput": 1519069.936, "learn_time_ms": 274.431, "learn_throughput": 65590.232, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3128, "training_iteration": 46, "trial_id": "9f288_00004", "date": "2023-10-25_15-50-59", "timestamp": 1698245459, "time_this_iter_s": 3.251850128173828, "time_total_s": 149.43505239486694, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.43505239486694, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 63.620000000000005, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.524454787925437, "policy_loss": -0.0003243639237350888, "vf_loss": 6.524822941532841, "vf_explained_var": -1.026524437798394e-06, "kl": 0.0006635897791120726, "entropy": 0.4376763778704184, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1256.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.571999999999816, "episode_len_mean": 254.88, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 36.70000000000003, 37.70000000000003, 13.899999999999757, -50.00000000000044, 39.300000000000026, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 47.3, 47.1, 47.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.3, 42.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.7, -50.00000000000044, 41.100000000000016, 36.900000000000034, -50.00000000000044, -50.00000000000044, 47.1, 41.70000000000002, 44.900000000000006, 41.70000000000002, 42.10000000000001, 44.5, 46.699999999999996, 42.30000000000001, -50.00000000000044, 44.5, 19.899999999999842, 25.499999999999922, -50.00000000000044, 42.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 47.1, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 37.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 13.499999999999751, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 60, 134, 124, 362, 500, 108, 34, 500, 500, 36, 500, 46, 500, 60, 500, 42, 28, 30, 28, 34, 500, 98, 500, 54, 500, 500, 60, 86, 28, 80, 24, 500, 500, 144, 54, 500, 90, 132, 500, 500, 30, 84, 52, 84, 80, 56, 34, 78, 500, 56, 302, 246, 500, 76, 254, 500, 500, 132, 500, 50, 30, 500, 184, 500, 54, 500, 500, 364, 500, 46, 500, 42, 500, 46, 500, 40, 50, 500, 500, 34, 122, 50, 500, 500, 48, 120, 500, 500, 500, 44, 36, 500, 88, 500, 500, 62, 366, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836948113565443, "mean_inference_ms": 1.2246738295757635, "mean_action_processing_ms": 0.14306902588653797, "mean_env_wait_ms": 0.0852142858423012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813817024230957, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.14798736572265625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.571999999999816, "episode_len_mean": 254.88, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 36.70000000000003, 37.70000000000003, 13.899999999999757, -50.00000000000044, 39.300000000000026, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 47.3, 47.1, 47.3, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.500000000000014, 47.3, 42.10000000000001, 47.7, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.7, -50.00000000000044, 41.100000000000016, 36.900000000000034, -50.00000000000044, -50.00000000000044, 47.1, 41.70000000000002, 44.900000000000006, 41.70000000000002, 42.10000000000001, 44.5, 46.699999999999996, 42.30000000000001, -50.00000000000044, 44.5, 19.899999999999842, 25.499999999999922, -50.00000000000044, 42.500000000000014, 24.69999999999991, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 45.1, 47.1, -50.00000000000044, 31.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 37.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 13.499999999999751, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 60, 134, 124, 362, 500, 108, 34, 500, 500, 36, 500, 46, 500, 60, 500, 42, 28, 30, 28, 34, 500, 98, 500, 54, 500, 500, 60, 86, 28, 80, 24, 500, 500, 144, 54, 500, 90, 132, 500, 500, 30, 84, 52, 84, 80, 56, 34, 78, 500, 56, 302, 246, 500, 76, 254, 500, 500, 132, 500, 50, 30, 500, 184, 500, 54, 500, 500, 364, 500, 46, 500, 42, 500, 46, 500, 40, 50, 500, 500, 34, 122, 50, 500, 500, 48, 120, 500, 500, 500, 44, 36, 500, 88, 500, 500, 62, 366, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836948113565443, "mean_inference_ms": 1.2246738295757635, "mean_action_processing_ms": 0.14306902588653797, "mean_env_wait_ms": 0.0852142858423012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01813817024230957, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.14798736572265625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5307.637974911537, "num_env_steps_trained_throughput_per_sec": 5307.637974911537, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3268.729, "sample_time_ms": 2980.649, "load_time_ms": 11.349, "load_throughput": 1586004.71, "learn_time_ms": 265.966, "learn_throughput": 67677.906, "synch_weights_time_ms": 9.095}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3195, "training_iteration": 47, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-03", "timestamp": 1698245463, "time_this_iter_s": 3.397063970565796, "time_total_s": 152.83211636543274, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.83211636543274, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.56, "ram_util_percent": 27.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.26892269982232, "policy_loss": -2.2057857778337267e-05, "vf_loss": 6.26898952766701, "vf_explained_var": -1.0088638023093896e-06, "kl": 0.00023869999595852413, "entropy": 0.44808035205911706, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1283.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8420000000002186, "episode_len_mean": 288.94, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 37.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 13.499999999999751, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 34.30000000000004, 12.299999999999734, 34.50000000000004, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, 45.1, 37.70000000000003, -50.00000000000044, 37.50000000000003, 43.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 39.50000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 47.5, 22.699999999999882, 30.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 45.1, 46.699999999999996, 42.10000000000001, 28.29999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.900000000000006], "episode_lengths": [184, 500, 54, 500, 500, 364, 500, 46, 500, 42, 500, 46, 500, 40, 50, 500, 500, 34, 122, 50, 500, 500, 48, 120, 500, 500, 500, 44, 36, 500, 88, 500, 500, 62, 366, 72, 500, 500, 500, 26, 72, 500, 102, 500, 500, 68, 42, 158, 378, 156, 34, 44, 500, 500, 500, 500, 500, 46, 36, 50, 124, 500, 126, 70, 500, 28, 500, 106, 52, 500, 500, 500, 500, 26, 500, 500, 26, 274, 194, 62, 500, 500, 500, 500, 42, 500, 500, 500, 500, 92, 54, 500, 50, 34, 80, 218, 500, 94, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417646659918675, "mean_inference_ms": 1.226151775119759, "mean_action_processing_ms": 0.14315897640142736, "mean_env_wait_ms": 0.08515726400512212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02413153648376465, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.13454723358154297}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8420000000002186, "episode_len_mean": 288.94, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 13.699999999999754, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 37.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 46.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 13.499999999999751, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 34.30000000000004, 12.299999999999734, 34.50000000000004, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, 45.1, 37.70000000000003, -50.00000000000044, 37.50000000000003, 43.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 39.50000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 47.5, 22.699999999999882, 30.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 45.1, 46.699999999999996, 42.10000000000001, 28.29999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.900000000000006], "episode_lengths": [184, 500, 54, 500, 500, 364, 500, 46, 500, 42, 500, 46, 500, 40, 50, 500, 500, 34, 122, 50, 500, 500, 48, 120, 500, 500, 500, 44, 36, 500, 88, 500, 500, 62, 366, 72, 500, 500, 500, 26, 72, 500, 102, 500, 500, 68, 42, 158, 378, 156, 34, 44, 500, 500, 500, 500, 500, 46, 36, 50, 124, 500, 126, 70, 500, 28, 500, 106, 52, 500, 500, 500, 500, 26, 500, 500, 26, 274, 194, 62, 500, 500, 500, 500, 42, 500, 500, 500, 500, 92, 54, 500, 50, 34, 80, 218, 500, 94, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417646659918675, "mean_inference_ms": 1.226151775119759, "mean_action_processing_ms": 0.14315897640142736, "mean_env_wait_ms": 0.08515726400512212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02413153648376465, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.13454723358154297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5530.201220362165, "num_env_steps_trained_throughput_per_sec": 5530.201220362165, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3277.415, "sample_time_ms": 3001.02, "load_time_ms": 10.4, "load_throughput": 1730783.578, "learn_time_ms": 255.05, "learn_throughput": 70574.353, "synch_weights_time_ms": 9.374}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3258, "training_iteration": 48, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-06", "timestamp": 1698245466, "time_this_iter_s": 3.2598540782928467, "time_total_s": 156.0919704437256, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.0919704437256, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.968156779253924, "policy_loss": -0.0005498458890037404, "vf_loss": 6.9687568876478405, "vf_explained_var": -3.156838593659578e-07, "kl": 0.0007822773901369617, "entropy": 0.5024893361109274, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1310.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.105999999999807, "episode_len_mean": 269.56, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 47.5, 22.699999999999882, 30.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 45.1, 46.699999999999996, 42.10000000000001, 28.29999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, 21.09999999999986, 11.699999999999726, 43.900000000000006, -50.00000000000044, 47.3, 42.30000000000001, -50.00000000000044, 30.699999999999996, 45.9, 40.90000000000002, 44.10000000000001, -50.00000000000044, 45.5, 40.10000000000002, 42.10000000000001, 43.50000000000001, 14.499999999999766, 45.1, 23.29999999999989, -50.00000000000044, 17.499999999999808, 32.50000000000002, 37.90000000000003, 45.9, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 37.50000000000003, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 15.49999999999978, 39.50000000000002, 5.899999999999643, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 45.9, 45.1, 8.099999999999675, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 7.09999999999966, -50.00000000000044, 35.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 45.3, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044], "episode_lengths": [500, 500, 26, 500, 500, 26, 274, 194, 62, 500, 500, 500, 500, 42, 500, 500, 500, 500, 92, 54, 500, 50, 34, 80, 218, 500, 94, 500, 62, 118, 500, 500, 26, 68, 290, 384, 62, 500, 28, 78, 500, 194, 42, 92, 60, 500, 46, 100, 80, 66, 356, 50, 268, 500, 326, 176, 122, 42, 34, 500, 62, 500, 74, 126, 38, 42, 500, 500, 500, 62, 36, 500, 346, 106, 442, 500, 78, 94, 500, 42, 50, 420, 98, 500, 500, 158, 430, 500, 144, 60, 500, 500, 500, 496, 48, 56, 500, 500, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869686783058516, "mean_inference_ms": 1.2336470874296048, "mean_action_processing_ms": 0.1441319334120938, "mean_env_wait_ms": 0.08565140593164684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.011003494262695312, "ViewRequirementAgentConnector_ms": 0.15554285049438477}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.105999999999807, "episode_len_mean": 269.56, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 47.5, 22.699999999999882, 30.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 45.1, 46.699999999999996, 42.10000000000001, 28.29999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.900000000000006, 38.300000000000026, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, 21.09999999999986, 11.699999999999726, 43.900000000000006, -50.00000000000044, 47.3, 42.30000000000001, -50.00000000000044, 30.699999999999996, 45.9, 40.90000000000002, 44.10000000000001, -50.00000000000044, 45.5, 40.10000000000002, 42.10000000000001, 43.50000000000001, 14.499999999999766, 45.1, 23.29999999999989, -50.00000000000044, 17.499999999999808, 32.50000000000002, 37.90000000000003, 45.9, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 37.50000000000003, 46.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, -50.00000000000044, 15.49999999999978, 39.50000000000002, 5.899999999999643, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 45.9, 45.1, 8.099999999999675, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 7.09999999999966, -50.00000000000044, 35.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 45.3, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044], "episode_lengths": [500, 500, 26, 500, 500, 26, 274, 194, 62, 500, 500, 500, 500, 42, 500, 500, 500, 500, 92, 54, 500, 50, 34, 80, 218, 500, 94, 500, 62, 118, 500, 500, 26, 68, 290, 384, 62, 500, 28, 78, 500, 194, 42, 92, 60, 500, 46, 100, 80, 66, 356, 50, 268, 500, 326, 176, 122, 42, 34, 500, 62, 500, 74, 126, 38, 42, 500, 500, 500, 62, 36, 500, 346, 106, 442, 500, 78, 94, 500, 42, 50, 420, 98, 500, 500, 158, 430, 500, 144, 60, 500, 500, 500, 496, 48, 56, 500, 500, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869686783058516, "mean_inference_ms": 1.2336470874296048, "mean_action_processing_ms": 0.1441319334120938, "mean_env_wait_ms": 0.08565140593164684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.011003494262695312, "ViewRequirementAgentConnector_ms": 0.15554285049438477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4074.33541991264, "num_env_steps_trained_throughput_per_sec": 4074.33541991264, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3399.204, "sample_time_ms": 3128.71, "load_time_ms": 10.3, "load_throughput": 1747570.032, "learn_time_ms": 249.25, "learn_throughput": 72216.627, "synch_weights_time_ms": 9.374}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3329, "training_iteration": 49, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-10", "timestamp": 1698245470, "time_this_iter_s": 4.4238975048065186, "time_total_s": 160.5158679485321, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.5158679485321, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 83.37142857142858, "ram_util_percent": 27.914285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.64719855343854, "policy_loss": -0.00023629405984172114, "vf_loss": 6.647486156887478, "vf_explained_var": -1.152356465657552e-06, "kl": 0.0009050507308285416, "entropy": 0.5141685373253293, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1337.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.81099999999981, "episode_len_mean": 267.5, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 5.899999999999643, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 45.9, 45.1, 8.099999999999675, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 7.09999999999966, -50.00000000000044, 35.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 45.3, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, 45.7, 41.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, 15.49999999999978, -50.00000000000044, 27.49999999999995, 43.30000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 33.500000000000036, 43.7, 29.299999999999976, 40.90000000000002, 43.30000000000001, 15.699999999999783, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 45.3, 30.099999999999987, 42.70000000000001, 46.099999999999994, 46.3, 41.90000000000001, -50.00000000000044, 45.3, 32.50000000000002, 45.3, 44.300000000000004, 46.699999999999996, 43.50000000000001, 40.500000000000014, 21.09999999999986, -50.00000000000044, 44.10000000000001, 42.900000000000006, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001], "episode_lengths": [106, 442, 500, 78, 94, 500, 42, 50, 420, 98, 500, 500, 158, 430, 500, 144, 60, 500, 500, 500, 496, 48, 56, 500, 500, 32, 500, 68, 44, 88, 44, 500, 500, 500, 500, 500, 500, 500, 62, 500, 46, 346, 500, 226, 68, 94, 500, 500, 118, 500, 500, 500, 94, 38, 500, 500, 52, 38, 166, 64, 208, 92, 68, 344, 500, 234, 500, 500, 54, 38, 500, 500, 40, 58, 48, 200, 74, 40, 38, 82, 500, 48, 176, 48, 58, 34, 66, 96, 290, 500, 60, 72, 100, 500, 100, 500, 500, 500, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3912119220714558, "mean_inference_ms": 1.2446495421759984, "mean_action_processing_ms": 0.1454213771586307, "mean_env_wait_ms": 0.08623689982537401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.18387556076049805}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.81099999999981, "episode_len_mean": 267.5, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 5.899999999999643, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 45.9, 45.1, 8.099999999999675, 40.30000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 7.09999999999966, -50.00000000000044, 35.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 45.3, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, 45.7, 41.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.5, 15.49999999999978, -50.00000000000044, 27.49999999999995, 43.30000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 33.500000000000036, 43.7, 29.299999999999976, 40.90000000000002, 43.30000000000001, 15.699999999999783, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 45.3, 30.099999999999987, 42.70000000000001, 46.099999999999994, 46.3, 41.90000000000001, -50.00000000000044, 45.3, 32.50000000000002, 45.3, 44.300000000000004, 46.699999999999996, 43.50000000000001, 40.500000000000014, 21.09999999999986, -50.00000000000044, 44.10000000000001, 42.900000000000006, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001], "episode_lengths": [106, 442, 500, 78, 94, 500, 42, 50, 420, 98, 500, 500, 158, 430, 500, 144, 60, 500, 500, 500, 496, 48, 56, 500, 500, 32, 500, 68, 44, 88, 44, 500, 500, 500, 500, 500, 500, 500, 62, 500, 46, 346, 500, 226, 68, 94, 500, 500, 118, 500, 500, 500, 94, 38, 500, 500, 52, 38, 166, 64, 208, 92, 68, 344, 500, 234, 500, 500, 54, 38, 500, 500, 40, 58, 48, 200, 74, 40, 38, 82, 500, 48, 176, 48, 58, 34, 66, 96, 290, 500, 60, 72, 100, 500, 100, 500, 500, 500, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3912119220714558, "mean_inference_ms": 1.2446495421759984, "mean_action_processing_ms": 0.1454213771586307, "mean_env_wait_ms": 0.08623689982537401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998374938964844, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.18387556076049805}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3735.4422713832782, "num_env_steps_trained_throughput_per_sec": 3735.4422713832782, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3546.014, "sample_time_ms": 3265.58, "load_time_ms": 9.7, "load_throughput": 1855699.696, "learn_time_ms": 259.489, "learn_throughput": 69367.182, "synch_weights_time_ms": 9.774}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3402, "training_iteration": 50, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-15", "timestamp": 1698245475, "time_this_iter_s": 4.8247058391571045, "time_total_s": 165.3405737876892, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.3405737876892, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 94.25, "ram_util_percent": 28.083333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 7.0187428792317705, "policy_loss": -6.0210073435748064e-05, "vf_loss": 7.018854724036323, "vf_explained_var": -8.609559800889757e-07, "kl": 0.00033183995583385695, "entropy": 0.5166659244784603, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1364.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.235999999999855, "episode_len_mean": 228.36, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 44.300000000000004, 45.3, 30.099999999999987, 42.70000000000001, 46.099999999999994, 46.3, 41.90000000000001, -50.00000000000044, 45.3, 32.50000000000002, 45.3, 44.300000000000004, 46.699999999999996, 43.50000000000001, 40.500000000000014, 21.09999999999986, -50.00000000000044, 44.10000000000001, 42.900000000000006, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 31.1, 45.1, 37.70000000000003, 44.300000000000004, -50.00000000000044, 34.70000000000004, 41.30000000000001, 6.699999999999655, 44.900000000000006, 44.300000000000004, 31.500000000000007, 45.7, 37.10000000000003, 44.300000000000004, 45.5, 43.30000000000001, 43.7, 46.5, 44.5, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 34.900000000000034, 9.299999999999692, 25.699999999999925, 41.90000000000001, -50.00000000000044, 11.099999999999717, 35.30000000000004, 44.300000000000004, 9.499999999999694, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.10000000000001, 42.70000000000001, 39.300000000000026, 43.30000000000001, -50.00000000000044, 29.899999999999984, 45.1, 46.3, 8.099999999999675, -50.00000000000044, 42.30000000000001, 10.499999999999709, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, 43.10000000000001, -50.00000000000044, 44.10000000000001, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 15.099999999999774, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 40, 58, 48, 200, 74, 40, 38, 82, 500, 48, 176, 48, 58, 34, 66, 96, 290, 500, 60, 72, 100, 500, 100, 500, 500, 500, 500, 74, 500, 190, 50, 124, 58, 500, 154, 88, 434, 52, 58, 186, 44, 130, 58, 46, 68, 64, 36, 56, 432, 500, 500, 500, 500, 158, 152, 408, 244, 82, 500, 390, 148, 58, 406, 500, 34, 500, 70, 74, 108, 68, 500, 202, 50, 38, 420, 500, 78, 396, 88, 50, 500, 76, 86, 70, 500, 60, 78, 50, 500, 500, 500, 70, 500, 500, 96, 350, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3948510380816343, "mean_inference_ms": 1.2561044221452624, "mean_action_processing_ms": 0.1470564709741048, "mean_env_wait_ms": 0.08697395557797022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499746322631836, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.19603633880615234}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.235999999999855, "episode_len_mean": 228.36, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 44.300000000000004, 45.3, 30.099999999999987, 42.70000000000001, 46.099999999999994, 46.3, 41.90000000000001, -50.00000000000044, 45.3, 32.50000000000002, 45.3, 44.300000000000004, 46.699999999999996, 43.50000000000001, 40.500000000000014, 21.09999999999986, -50.00000000000044, 44.10000000000001, 42.900000000000006, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 31.1, 45.1, 37.70000000000003, 44.300000000000004, -50.00000000000044, 34.70000000000004, 41.30000000000001, 6.699999999999655, 44.900000000000006, 44.300000000000004, 31.500000000000007, 45.7, 37.10000000000003, 44.300000000000004, 45.5, 43.30000000000001, 43.7, 46.5, 44.5, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 34.900000000000034, 9.299999999999692, 25.699999999999925, 41.90000000000001, -50.00000000000044, 11.099999999999717, 35.30000000000004, 44.300000000000004, 9.499999999999694, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.10000000000001, 42.70000000000001, 39.300000000000026, 43.30000000000001, -50.00000000000044, 29.899999999999984, 45.1, 46.3, 8.099999999999675, -50.00000000000044, 42.30000000000001, 10.499999999999709, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, 43.10000000000001, -50.00000000000044, 44.10000000000001, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 15.099999999999774, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 40, 58, 48, 200, 74, 40, 38, 82, 500, 48, 176, 48, 58, 34, 66, 96, 290, 500, 60, 72, 100, 500, 100, 500, 500, 500, 500, 74, 500, 190, 50, 124, 58, 500, 154, 88, 434, 52, 58, 186, 44, 130, 58, 46, 68, 64, 36, 56, 432, 500, 500, 500, 500, 158, 152, 408, 244, 82, 500, 390, 148, 58, 406, 500, 34, 500, 70, 74, 108, 68, 500, 202, 50, 38, 420, 500, 78, 396, 88, 50, 500, 76, 86, 70, 500, 60, 78, 50, 500, 500, 500, 70, 500, 500, 96, 350, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3948510380816343, "mean_inference_ms": 1.2561044221452624, "mean_action_processing_ms": 0.1470564709741048, "mean_env_wait_ms": 0.08697395557797022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499746322631836, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.19603633880615234}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3758.3288725536877, "num_env_steps_trained_throughput_per_sec": 3758.3288725536877, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3704.25, "sample_time_ms": 3408.017, "load_time_ms": 11.1, "load_throughput": 1621666.012, "learn_time_ms": 273.389, "learn_throughput": 65840.271, "synch_weights_time_ms": 10.174}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3473, "training_iteration": 51, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-20", "timestamp": 1698245480, "time_this_iter_s": 4.799363613128662, "time_total_s": 170.13993740081787, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.13993740081787, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 86.78571428571426, "ram_util_percent": 28.057142857142853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.021908548143175, "policy_loss": -0.0005156362808688924, "vf_loss": 6.022475313257288, "vf_explained_var": -6.777268868905527e-07, "kl": 0.0011588753093292326, "entropy": 0.5109415871125681, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1391.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1759999999998065, "episode_len_mean": 268.82, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 43.10000000000001, 42.70000000000001, 39.300000000000026, 43.30000000000001, -50.00000000000044, 29.899999999999984, 45.1, 46.3, 8.099999999999675, -50.00000000000044, 42.30000000000001, 10.499999999999709, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, 43.10000000000001, -50.00000000000044, 44.10000000000001, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 15.099999999999774, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 39.70000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 46.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 35.10000000000004, 44.300000000000004, 39.50000000000002, -50.00000000000044, 44.300000000000004, 46.9, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 43.7, 33.500000000000036, -50.00000000000044, 47.1, 46.099999999999994, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.10000000000002, 44.900000000000006, 37.70000000000003, 45.9, 29.899999999999984, 42.900000000000006, 35.10000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 34, 500, 70, 74, 108, 68, 500, 202, 50, 38, 420, 500, 78, 396, 88, 50, 500, 76, 86, 70, 500, 60, 78, 50, 500, 500, 500, 70, 500, 500, 96, 350, 48, 500, 500, 500, 500, 30, 40, 104, 500, 276, 500, 500, 238, 500, 36, 500, 116, 500, 98, 500, 150, 58, 106, 500, 58, 32, 88, 500, 48, 500, 500, 46, 42, 64, 166, 500, 30, 40, 62, 36, 500, 500, 500, 500, 500, 500, 32, 36, 500, 102, 500, 500, 500, 500, 66, 100, 52, 124, 42, 202, 72, 150, 500, 500, 280, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39792096487719525, "mean_inference_ms": 1.2652647005372963, "mean_action_processing_ms": 0.14816750775274481, "mean_env_wait_ms": 0.08734323344674698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0369718074798584, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.18779683113098145}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1759999999998065, "episode_len_mean": 268.82, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 43.10000000000001, 42.70000000000001, 39.300000000000026, 43.30000000000001, -50.00000000000044, 29.899999999999984, 45.1, 46.3, 8.099999999999675, -50.00000000000044, 42.30000000000001, 10.499999999999709, 41.30000000000001, 45.1, -50.00000000000044, 42.500000000000014, 41.500000000000014, 43.10000000000001, -50.00000000000044, 44.10000000000001, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 15.099999999999774, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 39.70000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, 26.299999999999933, -50.00000000000044, 46.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 35.10000000000004, 44.300000000000004, 39.50000000000002, -50.00000000000044, 44.300000000000004, 46.9, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.5, 45.9, 43.7, 33.500000000000036, -50.00000000000044, 47.1, 46.099999999999994, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.10000000000002, 44.900000000000006, 37.70000000000003, 45.9, 29.899999999999984, 42.900000000000006, 35.10000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 34, 500, 70, 74, 108, 68, 500, 202, 50, 38, 420, 500, 78, 396, 88, 50, 500, 76, 86, 70, 500, 60, 78, 50, 500, 500, 500, 70, 500, 500, 96, 350, 48, 500, 500, 500, 500, 30, 40, 104, 500, 276, 500, 500, 238, 500, 36, 500, 116, 500, 98, 500, 150, 58, 106, 500, 58, 32, 88, 500, 48, 500, 500, 46, 42, 64, 166, 500, 30, 40, 62, 36, 500, 500, 500, 500, 500, 500, 32, 36, 500, 102, 500, 500, 500, 500, 66, 100, 52, 124, 42, 202, 72, 150, 500, 500, 280, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39792096487719525, "mean_inference_ms": 1.2652647005372963, "mean_action_processing_ms": 0.14816750775274481, "mean_env_wait_ms": 0.08734323344674698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0369718074798584, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.18779683113098145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3926.702292844435, "num_env_steps_trained_throughput_per_sec": 3926.702292844435, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3832.426, "sample_time_ms": 3520.716, "load_time_ms": 12.8, "load_throughput": 1406270.725, "learn_time_ms": 287.065, "learn_throughput": 62703.531, "synch_weights_time_ms": 10.274}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3537, "training_iteration": 52, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-25", "timestamp": 1698245485, "time_this_iter_s": 4.589999437332153, "time_total_s": 174.72993683815002, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.72993683815002, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 88.31666666666666, "ram_util_percent": 28.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.608968487492314, "policy_loss": -0.0002904383948555699, "vf_loss": 6.609307094856545, "vf_explained_var": -5.364418029785156e-07, "kl": 0.0007100337836871202, "entropy": 0.48132815184416594, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0779999999998047, "episode_len_mean": 279.8, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 33.500000000000036, -50.00000000000044, 47.1, 46.099999999999994, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.10000000000002, 44.900000000000006, 37.70000000000003, 45.9, 29.899999999999984, 42.900000000000006, 35.10000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 46.5, 43.50000000000001, 38.10000000000002, 45.9, 34.10000000000004, 39.10000000000002, 41.100000000000016, 42.70000000000001, 38.300000000000026, -50.00000000000044, 41.100000000000016, 45.3, 7.899999999999672, 30.699999999999996, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.30000000000001, 42.500000000000014, -50.00000000000044, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, 28.89999999999997, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.5, 42.30000000000001, 15.899999999999785, 30.9, 35.70000000000003, 33.70000000000004, 13.499999999999751, 43.30000000000001, -50.00000000000044], "episode_lengths": [64, 166, 500, 30, 40, 62, 36, 500, 500, 500, 500, 500, 500, 32, 36, 500, 102, 500, 500, 500, 500, 66, 100, 52, 124, 42, 202, 72, 150, 500, 500, 280, 500, 500, 500, 500, 334, 102, 500, 500, 64, 82, 74, 500, 500, 500, 126, 36, 66, 120, 42, 160, 110, 90, 74, 118, 500, 90, 48, 422, 194, 46, 500, 86, 500, 62, 500, 500, 26, 500, 500, 500, 104, 78, 76, 500, 366, 42, 500, 40, 212, 112, 500, 500, 500, 500, 500, 500, 500, 322, 500, 46, 78, 342, 192, 144, 164, 366, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40035273972432717, "mean_inference_ms": 1.2736409123708625, "mean_action_processing_ms": 0.14938563444914854, "mean_env_wait_ms": 0.08807335354209168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03796029090881348, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.15403437614440918}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0779999999998047, "episode_len_mean": 279.8, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 33.500000000000036, -50.00000000000044, 47.1, 46.099999999999994, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.10000000000002, 44.900000000000006, 37.70000000000003, 45.9, 29.899999999999984, 42.900000000000006, 35.10000000000004, -50.00000000000044, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.699999999999797, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 46.5, 43.50000000000001, 38.10000000000002, 45.9, 34.10000000000004, 39.10000000000002, 41.100000000000016, 42.70000000000001, 38.300000000000026, -50.00000000000044, 41.100000000000016, 45.3, 7.899999999999672, 30.699999999999996, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.30000000000001, 42.500000000000014, -50.00000000000044, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, 28.89999999999997, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.5, 42.30000000000001, 15.899999999999785, 30.9, 35.70000000000003, 33.70000000000004, 13.499999999999751, 43.30000000000001, -50.00000000000044], "episode_lengths": [64, 166, 500, 30, 40, 62, 36, 500, 500, 500, 500, 500, 500, 32, 36, 500, 102, 500, 500, 500, 500, 66, 100, 52, 124, 42, 202, 72, 150, 500, 500, 280, 500, 500, 500, 500, 334, 102, 500, 500, 64, 82, 74, 500, 500, 500, 126, 36, 66, 120, 42, 160, 110, 90, 74, 118, 500, 90, 48, 422, 194, 46, 500, 86, 500, 62, 500, 500, 26, 500, 500, 500, 104, 78, 76, 500, 366, 42, 500, 40, 212, 112, 500, 500, 500, 500, 500, 500, 500, 322, 500, 46, 78, 342, 192, 144, 164, 366, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40035273972432717, "mean_inference_ms": 1.2736409123708625, "mean_action_processing_ms": 0.14938563444914854, "mean_env_wait_ms": 0.08807335354209168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03796029090881348, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.15403437614440918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4353.481053333197, "num_env_steps_trained_throughput_per_sec": 4353.481053333197, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3921.323, "sample_time_ms": 3594.594, "load_time_ms": 14.2, "load_throughput": 1267627.275, "learn_time_ms": 300.682, "learn_throughput": 59863.977, "synch_weights_time_ms": 10.373}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3603, "training_iteration": 53, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-29", "timestamp": 1698245489, "time_this_iter_s": 4.144620418548584, "time_total_s": 178.8745572566986, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.8745572566986, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 83.51666666666667, "ram_util_percent": 27.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.268425464630127, "policy_loss": -0.0003200971555930597, "vf_loss": 6.268792293689869, "vf_explained_var": -1.346623456036603e-06, "kl": 0.000658504574303983, "entropy": 0.46736721970416883, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1445.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.61800000000022, "episode_len_mean": 296.72, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.699999999999996, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.30000000000001, 42.500000000000014, -50.00000000000044, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, 28.89999999999997, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.5, 42.30000000000001, 15.899999999999785, 30.9, 35.70000000000003, 33.70000000000004, 13.499999999999751, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.9, 13.899999999999757, 46.9, 40.30000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 47.1, 38.700000000000024, 24.099999999999902, -50.00000000000044, 43.7, -50.00000000000044, 45.7, 43.7, 42.500000000000014, 45.3, 44.900000000000006, 41.90000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 45.1, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044], "episode_lengths": [194, 46, 500, 86, 500, 62, 500, 500, 26, 500, 500, 500, 104, 78, 76, 500, 366, 42, 500, 40, 212, 112, 500, 500, 500, 500, 500, 500, 500, 322, 500, 46, 78, 342, 192, 144, 164, 366, 68, 500, 500, 500, 500, 500, 72, 500, 42, 362, 32, 98, 40, 500, 500, 500, 234, 500, 500, 30, 114, 260, 500, 64, 500, 44, 64, 76, 48, 52, 82, 102, 500, 500, 46, 500, 500, 394, 40, 500, 500, 500, 500, 312, 52, 500, 500, 118, 500, 352, 500, 500, 48, 46, 50, 500, 60, 36, 500, 100, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4022691688737605, "mean_inference_ms": 1.281376398393386, "mean_action_processing_ms": 0.1505699738598592, "mean_env_wait_ms": 0.08893267477910462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03195810317993164, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.1640005111694336}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.61800000000022, "episode_len_mean": 296.72, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.699999999999996, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.30000000000001, 42.500000000000014, -50.00000000000044, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, 28.89999999999997, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 45.5, 42.30000000000001, 15.899999999999785, 30.9, 35.70000000000003, 33.70000000000004, 13.499999999999751, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.9, 13.899999999999757, 46.9, 40.30000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, 47.1, 38.700000000000024, 24.099999999999902, -50.00000000000044, 43.7, -50.00000000000044, 45.7, 43.7, 42.500000000000014, 45.3, 44.900000000000006, 41.90000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 45.1, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044], "episode_lengths": [194, 46, 500, 86, 500, 62, 500, 500, 26, 500, 500, 500, 104, 78, 76, 500, 366, 42, 500, 40, 212, 112, 500, 500, 500, 500, 500, 500, 500, 322, 500, 46, 78, 342, 192, 144, 164, 366, 68, 500, 500, 500, 500, 500, 72, 500, 42, 362, 32, 98, 40, 500, 500, 500, 234, 500, 500, 30, 114, 260, 500, 64, 500, 44, 64, 76, 48, 52, 82, 102, 500, 500, 46, 500, 500, 394, 40, 500, 500, 500, 500, 312, 52, 500, 500, 118, 500, 352, 500, 500, 48, 46, 50, 500, 60, 36, 500, 100, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4022691688737605, "mean_inference_ms": 1.281376398393386, "mean_action_processing_ms": 0.1505699738598592, "mean_env_wait_ms": 0.08893267477910462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03195810317993164, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.1640005111694336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3937.483806229673, "num_env_steps_trained_throughput_per_sec": 3937.483806229673, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 4050.849, "sample_time_ms": 3707.008, "load_time_ms": 15.6, "load_throughput": 1153871.59, "learn_time_ms": 316.393, "learn_throughput": 56891.238, "synch_weights_time_ms": 10.373}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3663, "training_iteration": 54, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-33", "timestamp": 1698245493, "time_this_iter_s": 4.576447010040283, "time_total_s": 183.4510042667389, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.4510042667389, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 79.65714285714286, "ram_util_percent": 28.185714285714283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.829729786625615, "policy_loss": -0.0002528445588217841, "vf_loss": 6.8300319071169255, "vf_explained_var": -2.273806819209346e-07, "kl": 0.0006708420625677212, "entropy": 0.49175683105433426, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1472.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8220000000002108, "episode_len_mean": 288.78, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 43.7, 42.500000000000014, 45.3, 44.900000000000006, 41.90000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 45.1, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044, 7.899999999999672, 21.699999999999868, -50.00000000000044, 43.7, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, 21.499999999999865, 41.70000000000002, 45.7, 38.50000000000003, 10.499999999999709, -50.00000000000044, 44.7, 40.70000000000002, 31.500000000000007, 45.3, 45.9, 47.5, 32.30000000000002, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.500000000000036, 41.500000000000014, 32.90000000000003, 42.900000000000006, 33.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.7, 32.700000000000024, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.3, 40.500000000000014], "episode_lengths": [44, 64, 76, 48, 52, 82, 102, 500, 500, 46, 500, 500, 394, 40, 500, 500, 500, 500, 312, 52, 500, 500, 118, 500, 352, 500, 500, 48, 46, 50, 500, 60, 36, 500, 100, 36, 500, 422, 284, 500, 64, 500, 56, 500, 92, 46, 500, 286, 84, 44, 116, 396, 500, 54, 94, 186, 48, 42, 26, 178, 496, 500, 500, 86, 166, 86, 172, 72, 170, 500, 500, 50, 500, 54, 174, 500, 500, 218, 500, 500, 500, 500, 500, 500, 500, 500, 500, 88, 500, 500, 500, 50, 500, 64, 500, 500, 500, 112, 48, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40302002828903793, "mean_inference_ms": 1.2839624061325399, "mean_action_processing_ms": 0.15090170177596454, "mean_env_wait_ms": 0.08890876096801234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024001359939575195, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.1490159034729004}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.8220000000002108, "episode_len_mean": 288.78, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 43.7, 42.500000000000014, 45.3, 44.900000000000006, 41.90000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 10.699999999999712, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 45.1, -50.00000000000044, 44.10000000000001, 46.5, -50.00000000000044, 40.10000000000002, 46.5, -50.00000000000044, 7.899999999999672, 21.699999999999868, -50.00000000000044, 43.7, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, 21.499999999999865, 41.70000000000002, 45.7, 38.50000000000003, 10.499999999999709, -50.00000000000044, 44.7, 40.70000000000002, 31.500000000000007, 45.3, 45.9, 47.5, 32.30000000000002, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.500000000000036, 41.500000000000014, 32.90000000000003, 42.900000000000006, 33.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.7, 32.700000000000024, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.3, 40.500000000000014], "episode_lengths": [44, 64, 76, 48, 52, 82, 102, 500, 500, 46, 500, 500, 394, 40, 500, 500, 500, 500, 312, 52, 500, 500, 118, 500, 352, 500, 500, 48, 46, 50, 500, 60, 36, 500, 100, 36, 500, 422, 284, 500, 64, 500, 56, 500, 92, 46, 500, 286, 84, 44, 116, 396, 500, 54, 94, 186, 48, 42, 26, 178, 496, 500, 500, 86, 166, 86, 172, 72, 170, 500, 500, 50, 500, 54, 174, 500, 500, 218, 500, 500, 500, 500, 500, 500, 500, 500, 500, 88, 500, 500, 500, 50, 500, 64, 500, 500, 500, 112, 48, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40302002828903793, "mean_inference_ms": 1.2839624061325399, "mean_action_processing_ms": 0.15090170177596454, "mean_env_wait_ms": 0.08890876096801234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024001359939575195, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.1490159034729004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5663.939207317544, "num_env_steps_trained_throughput_per_sec": 5663.939207317544, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 4038.608, "sample_time_ms": 3688.708, "load_time_ms": 15.7, "load_throughput": 1146499.824, "learn_time_ms": 322.356, "learn_throughput": 55838.938, "synch_weights_time_ms": 10.27}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3726, "training_iteration": 55, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-37", "timestamp": 1698245497, "time_this_iter_s": 3.1829981803894043, "time_total_s": 186.6340024471283, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.6340024471283, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 69.175, "ram_util_percent": 28.150000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.590977191925049, "policy_loss": -0.00041184167343157307, "vf_loss": 6.591443291416875, "vf_explained_var": -1.2561126991554542e-06, "kl": 0.0009393873418385691, "entropy": 0.5407024919986725, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1499.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.765999999999826, "episode_len_mean": 252.96, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.3, 40.500000000000014, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, 45.9, 46.5, 43.900000000000006, 2.499999999999595, 39.10000000000002, -50.00000000000044, 44.900000000000006, 45.5, 42.30000000000001, 45.9, 45.9, 43.50000000000001, 43.30000000000001, -50.00000000000044, 21.89999999999987, -50.00000000000044, 12.099999999999731, -50.00000000000044, 37.300000000000026, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 27.49999999999995, -50.00000000000044, 38.300000000000026, 36.30000000000003, 39.50000000000002, 46.099999999999994, 45.5, 42.500000000000014, 35.70000000000003, 31.1, -50.00000000000044, 31.1, 44.300000000000004, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 44.7, 45.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 43.30000000000001, 44.7, 41.70000000000002, 19.69999999999984, 37.10000000000003, 47.3, 46.099999999999994, 45.7, 46.5, 45.3, 45.1, 36.70000000000003, 26.299999999999933, 38.700000000000024, 37.10000000000003, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 88, 500, 500, 500, 50, 500, 64, 500, 500, 500, 112, 48, 96, 500, 62, 40, 500, 42, 36, 62, 476, 110, 500, 52, 46, 78, 42, 42, 66, 68, 500, 282, 500, 380, 500, 128, 50, 500, 500, 62, 226, 500, 118, 138, 106, 40, 46, 76, 144, 190, 500, 190, 58, 38, 76, 500, 500, 180, 500, 500, 100, 500, 500, 54, 500, 36, 54, 50, 500, 46, 54, 500, 68, 54, 84, 304, 130, 28, 40, 44, 36, 48, 50, 134, 238, 114, 130, 500, 500, 192, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021586442602771, "mean_inference_ms": 1.2829896499743625, "mean_action_processing_ms": 0.15090179124051883, "mean_env_wait_ms": 0.08900028988289911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996871948242188, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.13350510597229004}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.765999999999826, "episode_len_mean": 252.96, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.3, 40.500000000000014, -50.00000000000044, 43.900000000000006, 46.099999999999994, -50.00000000000044, 45.9, 46.5, 43.900000000000006, 2.499999999999595, 39.10000000000002, -50.00000000000044, 44.900000000000006, 45.5, 42.30000000000001, 45.9, 45.9, 43.50000000000001, 43.30000000000001, -50.00000000000044, 21.89999999999987, -50.00000000000044, 12.099999999999731, -50.00000000000044, 37.300000000000026, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 27.49999999999995, -50.00000000000044, 38.300000000000026, 36.30000000000003, 39.50000000000002, 46.099999999999994, 45.5, 42.500000000000014, 35.70000000000003, 31.1, -50.00000000000044, 31.1, 44.300000000000004, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 44.7, 45.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 43.30000000000001, 44.7, 41.70000000000002, 19.69999999999984, 37.10000000000003, 47.3, 46.099999999999994, 45.7, 46.5, 45.3, 45.1, 36.70000000000003, 26.299999999999933, 38.700000000000024, 37.10000000000003, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 88, 500, 500, 500, 50, 500, 64, 500, 500, 500, 112, 48, 96, 500, 62, 40, 500, 42, 36, 62, 476, 110, 500, 52, 46, 78, 42, 42, 66, 68, 500, 282, 500, 380, 500, 128, 50, 500, 500, 62, 226, 500, 118, 138, 106, 40, 46, 76, 144, 190, 500, 190, 58, 38, 76, 500, 500, 180, 500, 500, 100, 500, 500, 54, 500, 36, 54, 50, 500, 46, 54, 500, 68, 54, 84, 304, 130, 28, 40, 44, 36, 48, 50, 134, 238, 114, 130, 500, 500, 192, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021586442602771, "mean_inference_ms": 1.2829896499743625, "mean_action_processing_ms": 0.15090179124051883, "mean_env_wait_ms": 0.08900028988289911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996871948242188, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.13350510597229004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5389.077822245702, "num_env_steps_trained_throughput_per_sec": 5389.077822245702, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 4047.932, "sample_time_ms": 3678.07, "load_time_ms": 17.151, "load_throughput": 1049522.027, "learn_time_ms": 340.767, "learn_throughput": 52822.082, "synch_weights_time_ms": 10.371}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3804, "training_iteration": 56, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-40", "timestamp": 1698245500, "time_this_iter_s": 3.34609055519104, "time_total_s": 189.98009300231934, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.98009300231934, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 59.56, "ram_util_percent": 28.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.853856528246844, "policy_loss": -0.00021371124657215896, "vf_loss": 6.854122797648112, "vf_explained_var": -1.0353547555428964e-06, "kl": 0.000498410832590863, "entropy": 0.5250957685488241, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1526.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.6069999999998235, "episode_len_mean": 259.56, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.100000000000016, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 44.7, 45.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 43.30000000000001, 44.7, 41.70000000000002, 19.69999999999984, 37.10000000000003, 47.3, 46.099999999999994, 45.7, 46.5, 45.3, 45.1, 36.70000000000003, 26.299999999999933, 38.700000000000024, 37.10000000000003, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, 42.70000000000001, 33.10000000000003, 39.50000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.29999999999996, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 47.1, 13.099999999999746, -50.00000000000044, 39.50000000000002, 41.500000000000014, 43.900000000000006, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 44.10000000000001, 45.7, 28.499999999999964, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 16.8999999999998, 14.09999999999976, 8.699999999999683, 6.299999999999649, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.899999999999885, 43.30000000000001, 40.30000000000002, -50.00000000000044, 41.100000000000016, 33.70000000000004], "episode_lengths": [180, 500, 500, 100, 500, 500, 54, 500, 36, 54, 50, 500, 46, 54, 500, 68, 54, 84, 304, 130, 28, 40, 44, 36, 48, 50, 134, 238, 114, 130, 500, 500, 192, 500, 176, 500, 500, 500, 70, 500, 96, 74, 170, 106, 34, 500, 500, 218, 262, 500, 500, 500, 500, 500, 48, 46, 54, 500, 500, 32, 42, 30, 370, 500, 106, 86, 62, 500, 36, 78, 500, 60, 44, 216, 500, 500, 138, 500, 500, 44, 40, 500, 36, 500, 332, 360, 414, 438, 500, 108, 500, 500, 500, 70, 272, 68, 98, 500, 90, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40302822009967115, "mean_inference_ms": 1.2848932274463214, "mean_action_processing_ms": 0.15092186718841355, "mean_env_wait_ms": 0.08907983624682878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299990177154541, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.11799836158752441}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.6069999999998235, "episode_len_mean": 259.56, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.100000000000016, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 44.7, 45.1, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 43.30000000000001, 44.7, 41.70000000000002, 19.69999999999984, 37.10000000000003, 47.3, 46.099999999999994, 45.7, 46.5, 45.3, 45.1, 36.70000000000003, 26.299999999999933, 38.700000000000024, 37.10000000000003, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.500000000000014, 42.70000000000001, 33.10000000000003, 39.50000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.29999999999996, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 46.9, 45.9, 47.1, 13.099999999999746, -50.00000000000044, 39.50000000000002, 41.500000000000014, 43.900000000000006, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 44.10000000000001, 45.7, 28.499999999999964, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 16.8999999999998, 14.09999999999976, 8.699999999999683, 6.299999999999649, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.899999999999885, 43.30000000000001, 40.30000000000002, -50.00000000000044, 41.100000000000016, 33.70000000000004], "episode_lengths": [180, 500, 500, 100, 500, 500, 54, 500, 36, 54, 50, 500, 46, 54, 500, 68, 54, 84, 304, 130, 28, 40, 44, 36, 48, 50, 134, 238, 114, 130, 500, 500, 192, 500, 176, 500, 500, 500, 70, 500, 96, 74, 170, 106, 34, 500, 500, 218, 262, 500, 500, 500, 500, 500, 48, 46, 54, 500, 500, 32, 42, 30, 370, 500, 106, 86, 62, 500, 36, 78, 500, 60, 44, 216, 500, 500, 138, 500, 500, 44, 40, 500, 36, 500, 332, 360, 414, 438, 500, 108, 500, 500, 500, 70, 272, 68, 98, 500, 90, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40302822009967115, "mean_inference_ms": 1.2848932274463214, "mean_action_processing_ms": 0.15092186718841355, "mean_env_wait_ms": 0.08907983624682878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299990177154541, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.11799836158752441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4691.16452023687, "num_env_steps_trained_throughput_per_sec": 4691.16452023687, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 4092.498, "sample_time_ms": 3711.638, "load_time_ms": 17.651, "load_throughput": 1019789.606, "learn_time_ms": 351.232, "learn_throughput": 51248.184, "synch_weights_time_ms": 10.477}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3870, "training_iteration": 57, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-44", "timestamp": 1698245504, "time_this_iter_s": 3.8420000076293945, "time_total_s": 193.82209300994873, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.82209300994873, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 77.92, "ram_util_percent": 28.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.6200947761535645, "policy_loss": -0.0007794587700455277, "vf_loss": 6.620927951954029, "vf_explained_var": -1.3377931382921006e-06, "kl": 0.001121119276006168, "entropy": 0.5374191800753275, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6719999999998185, "episode_len_mean": 273.9, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 45.7, 28.499999999999964, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 16.8999999999998, 14.09999999999976, 8.699999999999683, 6.299999999999649, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.899999999999885, 43.30000000000001, 40.30000000000002, -50.00000000000044, 41.100000000000016, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 41.500000000000014, 47.3, -50.00000000000044, 33.90000000000004, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.10000000000001, 38.300000000000026, 45.3, 35.30000000000004, 46.3, -50.00000000000044, 46.099999999999994, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, 38.10000000000002, 46.9, -50.00000000000044, 36.70000000000003, 36.50000000000003, 16.8999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 46.9, 39.10000000000002, -50.00000000000044, 16.499999999999794, 40.70000000000002, 40.10000000000002, 45.1, 39.300000000000026, 38.700000000000024, 35.500000000000036, -50.00000000000044, 44.5, 14.899999999999771, 39.10000000000002, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 40.500000000000014, 28.29999999999996, 21.89999999999987, 26.299999999999933, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 60, 44, 216, 500, 500, 138, 500, 500, 44, 40, 500, 36, 500, 332, 360, 414, 438, 500, 108, 500, 500, 500, 70, 272, 68, 98, 500, 90, 164, 500, 500, 500, 198, 86, 28, 500, 162, 500, 176, 500, 80, 118, 48, 148, 38, 500, 40, 94, 500, 500, 500, 30, 102, 120, 32, 500, 134, 136, 332, 500, 40, 500, 500, 500, 108, 116, 500, 500, 500, 76, 104, 32, 110, 500, 336, 94, 100, 50, 108, 114, 146, 500, 56, 352, 110, 170, 500, 500, 52, 500, 500, 118, 70, 96, 218, 282, 238, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034960583914399, "mean_inference_ms": 1.2861818621876138, "mean_action_processing_ms": 0.15101901319370678, "mean_env_wait_ms": 0.08925386497354529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027984142303466797, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.11796975135803223}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6719999999998185, "episode_len_mean": 273.9, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 45.7, 28.499999999999964, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 16.8999999999998, 14.09999999999976, 8.699999999999683, 6.299999999999649, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.899999999999885, 43.30000000000001, 40.30000000000002, -50.00000000000044, 41.100000000000016, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 41.500000000000014, 47.3, -50.00000000000044, 33.90000000000004, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.10000000000001, 38.300000000000026, 45.3, 35.30000000000004, 46.3, -50.00000000000044, 46.099999999999994, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, 38.10000000000002, 46.9, -50.00000000000044, 36.70000000000003, 36.50000000000003, 16.8999999999998, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 46.9, 39.10000000000002, -50.00000000000044, 16.499999999999794, 40.70000000000002, 40.10000000000002, 45.1, 39.300000000000026, 38.700000000000024, 35.500000000000036, -50.00000000000044, 44.5, 14.899999999999771, 39.10000000000002, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 40.500000000000014, 28.29999999999996, 21.89999999999987, 26.299999999999933, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 60, 44, 216, 500, 500, 138, 500, 500, 44, 40, 500, 36, 500, 332, 360, 414, 438, 500, 108, 500, 500, 500, 70, 272, 68, 98, 500, 90, 164, 500, 500, 500, 198, 86, 28, 500, 162, 500, 176, 500, 80, 118, 48, 148, 38, 500, 40, 94, 500, 500, 500, 30, 102, 120, 32, 500, 134, 136, 332, 500, 40, 500, 500, 500, 108, 116, 500, 500, 500, 76, 104, 32, 110, 500, 336, 94, 100, 50, 108, 114, 146, 500, 56, 352, 110, 170, 500, 500, 52, 500, 500, 118, 70, 96, 218, 282, 238, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034960583914399, "mean_inference_ms": 1.2861818621876138, "mean_action_processing_ms": 0.15101901319370678, "mean_env_wait_ms": 0.08925386497354529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027984142303466797, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.11796975135803223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5373.133334106711, "num_env_steps_trained_throughput_per_sec": 5373.133334106711, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 4102.013, "sample_time_ms": 3706.768, "load_time_ms": 19.1, "load_throughput": 942424.922, "learn_time_ms": 363.948, "learn_throughput": 49457.555, "synch_weights_time_ms": 10.597}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3940, "training_iteration": 58, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-47", "timestamp": 1698245507, "time_this_iter_s": 3.356003522872925, "time_total_s": 197.17809653282166, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.17809653282166, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 60.14, "ram_util_percent": 28.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.783953348795573, "policy_loss": -0.000287032444719915, "vf_loss": 6.7842976958663375, "vf_explained_var": -2.8036258838794847e-07, "kl": 0.0011112536643801613, "entropy": 0.5733080031695189, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1580.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.776999999999857, "episode_len_mean": 237.94, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 39.10000000000002, -50.00000000000044, 16.499999999999794, 40.70000000000002, 40.10000000000002, 45.1, 39.300000000000026, 38.700000000000024, 35.500000000000036, -50.00000000000044, 44.5, 14.899999999999771, 39.10000000000002, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 40.500000000000014, 28.29999999999996, 21.89999999999987, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 47.9, 40.90000000000002, 32.700000000000024, 37.70000000000003, 41.70000000000002, 42.30000000000001, 41.500000000000014, 36.50000000000003, -50.00000000000044, 41.100000000000016, 42.70000000000001, 24.499999999999908, 41.500000000000014, 23.8999999999999, 38.700000000000024, 30.9, 11.899999999999729, -50.00000000000044, 45.1, -50.00000000000044, 43.900000000000006, 46.099999999999994, 47.7, 43.900000000000006, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 39.10000000000002, 45.3, 25.699999999999925, 43.7, 38.90000000000002, 46.9, -50.00000000000044, 26.299999999999933, 25.899999999999928, 41.70000000000002, -50.00000000000044, 39.10000000000002, 43.30000000000001, -50.00000000000044, 43.7, 44.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 30.099999999999987, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.499999999999993, 8.299999999999677, 45.7, 18.499999999999822, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, 45.3], "episode_lengths": [32, 110, 500, 336, 94, 100, 50, 108, 114, 146, 500, 56, 352, 110, 170, 500, 500, 52, 500, 500, 118, 70, 96, 218, 282, 238, 500, 500, 500, 500, 134, 500, 90, 500, 22, 92, 174, 124, 84, 78, 86, 136, 500, 90, 74, 256, 86, 262, 114, 192, 382, 500, 50, 500, 62, 40, 24, 62, 46, 500, 32, 500, 110, 48, 244, 64, 112, 32, 500, 238, 242, 84, 500, 110, 68, 500, 64, 54, 500, 204, 500, 200, 182, 108, 500, 196, 418, 44, 316, 234, 500, 500, 500, 500, 76, 500, 80, 74, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40624489993613094, "mean_inference_ms": 1.292524448357395, "mean_action_processing_ms": 0.1519193556726222, "mean_env_wait_ms": 0.08938826444956327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199887275695801, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.17801213264465332}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.776999999999857, "episode_len_mean": 237.94, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 39.10000000000002, -50.00000000000044, 16.499999999999794, 40.70000000000002, 40.10000000000002, 45.1, 39.300000000000026, 38.700000000000024, 35.500000000000036, -50.00000000000044, 44.5, 14.899999999999771, 39.10000000000002, 33.10000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 40.500000000000014, 28.29999999999996, 21.89999999999987, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.100000000000016, -50.00000000000044, 47.9, 40.90000000000002, 32.700000000000024, 37.70000000000003, 41.70000000000002, 42.30000000000001, 41.500000000000014, 36.50000000000003, -50.00000000000044, 41.100000000000016, 42.70000000000001, 24.499999999999908, 41.500000000000014, 23.8999999999999, 38.700000000000024, 30.9, 11.899999999999729, -50.00000000000044, 45.1, -50.00000000000044, 43.900000000000006, 46.099999999999994, 47.7, 43.900000000000006, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 39.10000000000002, 45.3, 25.699999999999925, 43.7, 38.90000000000002, 46.9, -50.00000000000044, 26.299999999999933, 25.899999999999928, 41.70000000000002, -50.00000000000044, 39.10000000000002, 43.30000000000001, -50.00000000000044, 43.7, 44.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 30.099999999999987, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.499999999999993, 8.299999999999677, 45.7, 18.499999999999822, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, 45.3], "episode_lengths": [32, 110, 500, 336, 94, 100, 50, 108, 114, 146, 500, 56, 352, 110, 170, 500, 500, 52, 500, 500, 118, 70, 96, 218, 282, 238, 500, 500, 500, 500, 134, 500, 90, 500, 22, 92, 174, 124, 84, 78, 86, 136, 500, 90, 74, 256, 86, 262, 114, 192, 382, 500, 50, 500, 62, 40, 24, 62, 46, 500, 32, 500, 110, 48, 244, 64, 112, 32, 500, 238, 242, 84, 500, 110, 68, 500, 64, 54, 500, 204, 500, 200, 182, 108, 500, 196, 418, 44, 316, 234, 500, 500, 500, 500, 76, 500, 80, 74, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40624489993613094, "mean_inference_ms": 1.292524448357395, "mean_action_processing_ms": 0.1519193556726222, "mean_env_wait_ms": 0.08938826444956327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199887275695801, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.17801213264465332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3819.222410632262, "num_env_steps_trained_throughput_per_sec": 3819.222410632262, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 4131.523, "sample_time_ms": 3722.478, "load_time_ms": 19.599, "load_throughput": 918392.577, "learn_time_ms": 377.249, "learn_throughput": 47713.907, "synch_weights_time_ms": 10.697}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4012, "training_iteration": 59, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-52", "timestamp": 1698245512, "time_this_iter_s": 4.719001531600952, "time_total_s": 201.8970980644226, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.8970980644226, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 91.13333333333334, "ram_util_percent": 28.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 7.148353735605876, "policy_loss": 1.955708419835126e-05, "vf_loss": 7.148393489696361, "vf_explained_var": -8.918620921947338e-07, "kl": 0.0007196096828855152, "entropy": 0.5942315172266077, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1607.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3999999999998245, "episode_len_mean": 266.68, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 39.10000000000002, 43.30000000000001, -50.00000000000044, 43.7, 44.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 30.099999999999987, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.499999999999993, 8.299999999999677, 45.7, 18.499999999999822, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, 45.3, 6.499999999999652, 2.499999999999595, 31.1, 15.899999999999785, -50.00000000000044, 40.30000000000002, -50.00000000000044, 29.899999999999984, 45.7, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 39.70000000000002, 20.099999999999845, 44.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 7.699999999999669, 7.09999999999966, -50.00000000000044, 42.10000000000001, 35.500000000000036, 42.900000000000006, 40.500000000000014, 45.1, 24.899999999999913, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 24.299999999999905, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.30000000000001, 39.70000000000002, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 44.7, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.300000000000004, 36.50000000000003, 41.90000000000001, 45.7, 15.299999999999777, 6.8999999999996575, 43.30000000000001, 44.5, 41.30000000000001, 43.900000000000006, 43.7, 41.100000000000016, -50.00000000000044, 42.500000000000014, 42.500000000000014], "episode_lengths": [84, 500, 110, 68, 500, 64, 54, 500, 204, 500, 200, 182, 108, 500, 196, 418, 44, 316, 234, 500, 500, 500, 500, 76, 500, 80, 74, 500, 48, 436, 476, 190, 342, 500, 98, 500, 202, 44, 498, 500, 500, 104, 300, 56, 500, 90, 500, 500, 424, 430, 500, 80, 146, 72, 96, 50, 252, 500, 180, 500, 500, 494, 258, 500, 108, 500, 500, 156, 78, 104, 500, 76, 116, 500, 500, 76, 54, 54, 54, 76, 500, 500, 500, 78, 80, 58, 136, 82, 44, 348, 432, 68, 56, 88, 62, 64, 90, 500, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4084126096126823, "mean_inference_ms": 1.2994052802653542, "mean_action_processing_ms": 0.15266876823088213, "mean_env_wait_ms": 0.08996035303013268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023005962371826172, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.18701744079589844}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3999999999998245, "episode_len_mean": 266.68, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 39.10000000000002, 43.30000000000001, -50.00000000000044, 43.7, 44.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 30.099999999999987, 31.900000000000013, 39.300000000000026, -50.00000000000044, 30.499999999999993, 8.299999999999677, 45.7, 18.499999999999822, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.10000000000001, 42.70000000000001, -50.00000000000044, 45.3, 6.499999999999652, 2.499999999999595, 31.1, 15.899999999999785, -50.00000000000044, 40.30000000000002, -50.00000000000044, 29.899999999999984, 45.7, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 39.70000000000002, 20.099999999999845, 44.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 7.699999999999669, 7.09999999999966, -50.00000000000044, 42.10000000000001, 35.500000000000036, 42.900000000000006, 40.500000000000014, 45.1, 24.899999999999913, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 24.299999999999905, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.30000000000001, 39.70000000000002, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 44.7, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.300000000000004, 36.50000000000003, 41.90000000000001, 45.7, 15.299999999999777, 6.8999999999996575, 43.30000000000001, 44.5, 41.30000000000001, 43.900000000000006, 43.7, 41.100000000000016, -50.00000000000044, 42.500000000000014, 42.500000000000014], "episode_lengths": [84, 500, 110, 68, 500, 64, 54, 500, 204, 500, 200, 182, 108, 500, 196, 418, 44, 316, 234, 500, 500, 500, 500, 76, 500, 80, 74, 500, 48, 436, 476, 190, 342, 500, 98, 500, 202, 44, 498, 500, 500, 104, 300, 56, 500, 90, 500, 500, 424, 430, 500, 80, 146, 72, 96, 50, 252, 500, 180, 500, 500, 494, 258, 500, 108, 500, 500, 156, 78, 104, 500, 76, 116, 500, 500, 76, 54, 54, 54, 76, 500, 500, 500, 78, 80, 58, 136, 82, 44, 348, 432, 68, 56, 88, 62, 64, 90, 500, 76, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4084126096126823, "mean_inference_ms": 1.2994052802653542, "mean_action_processing_ms": 0.15266876823088213, "mean_env_wait_ms": 0.08996035303013268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023005962371826172, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.18701744079589844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3890.1766864055517, "num_env_steps_trained_throughput_per_sec": 3890.1766864055517, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 4112.357, "sample_time_ms": 3704.907, "load_time_ms": 21.0, "load_throughput": 857145.621, "learn_time_ms": 374.152, "learn_throughput": 48108.751, "synch_weights_time_ms": 10.697}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4083, "training_iteration": 60, "trial_id": "9f288_00004", "date": "2023-10-25_15-51-57", "timestamp": 1698245517, "time_this_iter_s": 4.634038925170898, "time_total_s": 206.5311369895935, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.5311369895935, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 90.31666666666666, "ram_util_percent": 28.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.7164345847235785, "policy_loss": 1.0251447006508156e-05, "vf_loss": 6.71648285124037, "vf_explained_var": -1.3664916709617333e-06, "kl": 0.0003546479377500115, "entropy": 0.5848174006850632, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1634.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.396999999999824, "episode_len_mean": 261.66, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.299999999999905, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.30000000000001, 39.70000000000002, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 44.7, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.300000000000004, 36.50000000000003, 41.90000000000001, 45.7, 15.299999999999777, 6.8999999999996575, 43.30000000000001, 44.5, 41.30000000000001, 43.900000000000006, 43.7, 41.100000000000016, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 42.900000000000006, 31.70000000000001, -50.00000000000044, 44.5, 44.10000000000001, 44.10000000000001, 40.90000000000002, 36.900000000000034, -50.00000000000044, 42.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.10000000000001, 44.900000000000006, 24.899999999999913, 44.7, -50.00000000000044, 34.900000000000034, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.300000000000026, 36.70000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 36.10000000000004, 45.1, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 4.499999999999623, 41.90000000000001, 36.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [258, 500, 108, 500, 500, 156, 78, 104, 500, 76, 116, 500, 500, 76, 54, 54, 54, 76, 500, 500, 500, 78, 80, 58, 136, 82, 44, 348, 432, 68, 56, 88, 62, 64, 90, 500, 76, 76, 500, 72, 184, 500, 56, 60, 60, 92, 132, 500, 78, 318, 500, 500, 90, 500, 500, 500, 500, 500, 112, 80, 52, 252, 54, 500, 152, 92, 500, 500, 500, 32, 78, 342, 500, 500, 118, 134, 140, 500, 500, 500, 44, 84, 98, 500, 172, 500, 140, 50, 500, 482, 500, 456, 82, 134, 500, 40, 500, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109531411481362, "mean_inference_ms": 1.307895467874303, "mean_action_processing_ms": 0.15386969915311052, "mean_env_wait_ms": 0.0906473673544748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029013633728027344, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.17799901962280273}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.396999999999824, "episode_len_mean": 261.66, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.299999999999905, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 34.50000000000004, 42.30000000000001, 39.70000000000002, -50.00000000000044, 42.500000000000014, 38.50000000000003, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, 44.7, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 42.10000000000001, 44.300000000000004, 36.50000000000003, 41.90000000000001, 45.7, 15.299999999999777, 6.8999999999996575, 43.30000000000001, 44.5, 41.30000000000001, 43.900000000000006, 43.7, 41.100000000000016, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 42.900000000000006, 31.70000000000001, -50.00000000000044, 44.5, 44.10000000000001, 44.10000000000001, 40.90000000000002, 36.900000000000034, -50.00000000000044, 42.30000000000001, 18.29999999999982, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.10000000000001, 44.900000000000006, 24.899999999999913, 44.7, -50.00000000000044, 34.900000000000034, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.300000000000026, 36.70000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 36.10000000000004, 45.1, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 4.499999999999623, 41.90000000000001, 36.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [258, 500, 108, 500, 500, 156, 78, 104, 500, 76, 116, 500, 500, 76, 54, 54, 54, 76, 500, 500, 500, 78, 80, 58, 136, 82, 44, 348, 432, 68, 56, 88, 62, 64, 90, 500, 76, 76, 500, 72, 184, 500, 56, 60, 60, 92, 132, 500, 78, 318, 500, 500, 90, 500, 500, 500, 500, 500, 112, 80, 52, 252, 54, 500, 152, 92, 500, 500, 500, 32, 78, 342, 500, 500, 118, 134, 140, 500, 500, 500, 44, 84, 98, 500, 172, 500, 140, 50, 500, 482, 500, 456, 82, 134, 500, 40, 500, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109531411481362, "mean_inference_ms": 1.307895467874303, "mean_action_processing_ms": 0.15386969915311052, "mean_env_wait_ms": 0.0906473673544748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029013633728027344, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.17799901962280273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3630.474560268689, "num_env_steps_trained_throughput_per_sec": 3630.474560268689, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 4129.123, "sample_time_ms": 3729.373, "load_time_ms": 20.6, "load_throughput": 873786.028, "learn_time_ms": 366.952, "learn_throughput": 49052.723, "synch_weights_time_ms": 10.598}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4145, "training_iteration": 61, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-02", "timestamp": 1698245522, "time_this_iter_s": 4.964029550552368, "time_total_s": 211.49516654014587, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.49516654014587, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 88.5, "ram_util_percent": 28.728571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.537607087029351, "policy_loss": -0.00028888508677482605, "vf_loss": 6.537953641679552, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0008607524106702053, "entropy": 0.5763798830685792, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1661.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.228999999999809, "episode_len_mean": 283.3, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.900000000000034, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.300000000000026, 36.70000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 36.10000000000004, 45.1, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 4.499999999999623, 41.90000000000001, 36.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 39.10000000000002, 46.099999999999994, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.30000000000002, 15.099999999999774, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 29.099999999999973, 44.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 46.3, 38.300000000000026, -50.00000000000044, 41.90000000000001, 42.900000000000006, 45.5, 35.500000000000036, 31.70000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, 37.50000000000003, 46.099999999999994, 32.50000000000002, 37.90000000000003, 37.50000000000003, 40.90000000000002, -50.00000000000044, 44.900000000000006, 23.499999999999893, 44.7, 35.70000000000003, 28.29999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 4.299999999999621, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.900000000000006, -50.00000000000044], "episode_lengths": [152, 92, 500, 500, 500, 32, 78, 342, 500, 500, 118, 134, 140, 500, 500, 500, 44, 84, 98, 500, 172, 500, 140, 50, 500, 482, 500, 456, 82, 134, 500, 40, 500, 500, 56, 500, 500, 500, 198, 110, 40, 500, 118, 500, 98, 350, 70, 500, 500, 500, 500, 84, 210, 56, 102, 500, 500, 78, 94, 500, 38, 118, 500, 82, 72, 46, 146, 184, 500, 138, 500, 500, 500, 500, 42, 500, 76, 126, 40, 176, 122, 126, 92, 500, 52, 266, 54, 144, 218, 218, 500, 500, 500, 40, 458, 500, 500, 150, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142228996065464, "mean_inference_ms": 1.3182638765383072, "mean_action_processing_ms": 0.1549967863021048, "mean_env_wait_ms": 0.09122111125112937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03295493125915527, "StateBufferConnector_ms": 0.014039993286132812, "ViewRequirementAgentConnector_ms": 0.19202423095703125}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.228999999999809, "episode_len_mean": 283.3, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.900000000000034, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.30000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.300000000000026, 36.70000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 41.70000000000002, 40.30000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 36.10000000000004, 45.1, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 4.499999999999623, 41.90000000000001, 36.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, 39.10000000000002, 46.099999999999994, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.30000000000002, 15.099999999999774, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 29.099999999999973, 44.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.70000000000002, -50.00000000000044, 46.3, 38.300000000000026, -50.00000000000044, 41.90000000000001, 42.900000000000006, 45.5, 35.500000000000036, 31.70000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, 37.50000000000003, 46.099999999999994, 32.50000000000002, 37.90000000000003, 37.50000000000003, 40.90000000000002, -50.00000000000044, 44.900000000000006, 23.499999999999893, 44.7, 35.70000000000003, 28.29999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 4.299999999999621, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.900000000000006, -50.00000000000044], "episode_lengths": [152, 92, 500, 500, 500, 32, 78, 342, 500, 500, 118, 134, 140, 500, 500, 500, 44, 84, 98, 500, 172, 500, 140, 50, 500, 482, 500, 456, 82, 134, 500, 40, 500, 500, 56, 500, 500, 500, 198, 110, 40, 500, 118, 500, 98, 350, 70, 500, 500, 500, 500, 84, 210, 56, 102, 500, 500, 78, 94, 500, 38, 118, 500, 82, 72, 46, 146, 184, 500, 138, 500, 500, 500, 500, 42, 500, 76, 126, 40, 176, 122, 126, 92, 500, 52, 266, 54, 144, 218, 218, 500, 500, 500, 40, 458, 500, 500, 150, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142228996065464, "mean_inference_ms": 1.3182638765383072, "mean_action_processing_ms": 0.1549967863021048, "mean_env_wait_ms": 0.09122111125112937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03295493125915527, "StateBufferConnector_ms": 0.014039993286132812, "ViewRequirementAgentConnector_ms": 0.19202423095703125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3624.7512641203193, "num_env_steps_trained_throughput_per_sec": 3624.7512641203193, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 4167.309, "sample_time_ms": 3759.059, "load_time_ms": 20.9, "load_throughput": 861245.528, "learn_time_ms": 374.852, "learn_throughput": 48018.907, "synch_weights_time_ms": 10.897}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4209, "training_iteration": 62, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-07", "timestamp": 1698245527, "time_this_iter_s": 4.971861362457275, "time_total_s": 216.46702790260315, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 216.46702790260315, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 86.22857142857143, "ram_util_percent": 28.814285714285717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 7.2717050269798, "policy_loss": -0.0006497229139010111, "vf_loss": 7.272412953553377, "vf_explained_var": -1.1700171011465567e-06, "kl": 0.0013908962544527876, "entropy": 0.5822775253543148, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1688.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.12699999999985, "episode_len_mean": 244.44, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 46.099999999999994, 32.50000000000002, 37.90000000000003, 37.50000000000003, 40.90000000000002, -50.00000000000044, 44.900000000000006, 23.499999999999893, 44.7, 35.70000000000003, 28.29999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 4.299999999999621, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 44.7, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, 39.300000000000026, 45.7, 36.900000000000034, -50.00000000000044, 11.699999999999726, 42.70000000000001, -50.00000000000044, 33.90000000000004, 17.499999999999808, 47.1, 43.50000000000001, 44.5, 46.5, 46.3, -50.00000000000044, 16.699999999999797, 36.70000000000003, 41.500000000000014, -50.00000000000044, 24.69999999999991, 39.50000000000002, 24.299999999999905, 41.100000000000016, 46.3, 39.50000000000002, 40.70000000000002, 37.10000000000003, 45.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.10000000000001, 38.700000000000024, -50.00000000000044, 41.90000000000001, 15.699999999999783, 45.7, -50.00000000000044, 31.500000000000007, 29.69999999999998, 42.70000000000001, -50.00000000000044, 38.50000000000003, 41.90000000000001, 6.299999999999649, 45.5, 35.70000000000003, -50.00000000000044, 18.29999999999982, 33.500000000000036, 42.10000000000001, -50.00000000000044, 33.90000000000004, 18.29999999999982, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.099999999999689, 30.9, -50.00000000000044, 43.30000000000001, 44.7, 45.9, 45.1, -50.00000000000044, 30.499999999999993], "episode_lengths": [126, 40, 176, 122, 126, 92, 500, 52, 266, 54, 144, 218, 218, 500, 500, 500, 40, 458, 500, 500, 150, 72, 500, 500, 500, 500, 108, 54, 500, 106, 500, 52, 108, 44, 132, 500, 384, 74, 500, 162, 326, 30, 66, 56, 36, 38, 500, 334, 134, 86, 500, 254, 106, 258, 90, 38, 106, 94, 130, 46, 500, 500, 52, 500, 80, 114, 500, 82, 344, 44, 500, 186, 204, 74, 500, 116, 82, 438, 46, 144, 500, 318, 166, 80, 500, 162, 318, 500, 76, 500, 500, 410, 192, 500, 68, 54, 42, 50, 500, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4179264260432072, "mean_inference_ms": 1.3290531429795431, "mean_action_processing_ms": 0.15625240087434786, "mean_env_wait_ms": 0.09220618028425502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499675750732422, "StateBufferConnector_ms": 0.015996217727661133, "ViewRequirementAgentConnector_ms": 0.2290046215057373}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.12699999999985, "episode_len_mean": 244.44, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 46.099999999999994, 32.50000000000002, 37.90000000000003, 37.50000000000003, 40.90000000000002, -50.00000000000044, 44.900000000000006, 23.499999999999893, 44.7, 35.70000000000003, 28.29999999999996, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 4.299999999999621, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 44.7, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, 39.300000000000026, 45.7, 36.900000000000034, -50.00000000000044, 11.699999999999726, 42.70000000000001, -50.00000000000044, 33.90000000000004, 17.499999999999808, 47.1, 43.50000000000001, 44.5, 46.5, 46.3, -50.00000000000044, 16.699999999999797, 36.70000000000003, 41.500000000000014, -50.00000000000044, 24.69999999999991, 39.50000000000002, 24.299999999999905, 41.100000000000016, 46.3, 39.50000000000002, 40.70000000000002, 37.10000000000003, 45.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.10000000000001, 38.700000000000024, -50.00000000000044, 41.90000000000001, 15.699999999999783, 45.7, -50.00000000000044, 31.500000000000007, 29.69999999999998, 42.70000000000001, -50.00000000000044, 38.50000000000003, 41.90000000000001, 6.299999999999649, 45.5, 35.70000000000003, -50.00000000000044, 18.29999999999982, 33.500000000000036, 42.10000000000001, -50.00000000000044, 33.90000000000004, 18.29999999999982, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.099999999999689, 30.9, -50.00000000000044, 43.30000000000001, 44.7, 45.9, 45.1, -50.00000000000044, 30.499999999999993], "episode_lengths": [126, 40, 176, 122, 126, 92, 500, 52, 266, 54, 144, 218, 218, 500, 500, 500, 40, 458, 500, 500, 150, 72, 500, 500, 500, 500, 108, 54, 500, 106, 500, 52, 108, 44, 132, 500, 384, 74, 500, 162, 326, 30, 66, 56, 36, 38, 500, 334, 134, 86, 500, 254, 106, 258, 90, 38, 106, 94, 130, 46, 500, 500, 52, 500, 80, 114, 500, 82, 344, 44, 500, 186, 204, 74, 500, 116, 82, 438, 46, 144, 500, 318, 166, 80, 500, 162, 318, 500, 76, 500, 500, 410, 192, 500, 68, 54, 42, 50, 500, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4179264260432072, "mean_inference_ms": 1.3290531429795431, "mean_action_processing_ms": 0.15625240087434786, "mean_env_wait_ms": 0.09220618028425502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499675750732422, "StateBufferConnector_ms": 0.015996217727661133, "ViewRequirementAgentConnector_ms": 0.2290046215057373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3641.520921768781, "num_env_steps_trained_throughput_per_sec": 3641.520921768781, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 4248.145, "sample_time_ms": 3825.896, "load_time_ms": 21.0, "load_throughput": 857142.701, "learn_time_ms": 388.652, "learn_throughput": 46313.89, "synch_weights_time_ms": 10.998}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4286, "training_iteration": 63, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-12", "timestamp": 1698245532, "time_this_iter_s": 4.948989629745483, "time_total_s": 221.41601753234863, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.41601753234863, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 86.91428571428571, "ram_util_percent": 28.842857142857138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.900292838061297, "policy_loss": -6.197874123851459e-05, "vf_loss": 6.900410034038402, "vf_explained_var": -1.4128508391203703e-06, "kl": 0.0002476119054201128, "entropy": 0.5550611957355782, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1715.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.402999999999855, "episode_len_mean": 241.68, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 41.90000000000001, 6.299999999999649, 45.5, 35.70000000000003, -50.00000000000044, 18.29999999999982, 33.500000000000036, 42.10000000000001, -50.00000000000044, 33.90000000000004, 18.29999999999982, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.099999999999689, 30.9, -50.00000000000044, 43.30000000000001, 44.7, 45.9, 45.1, -50.00000000000044, 30.499999999999993, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.5, 11.699999999999726, 44.7, 39.300000000000026, 43.30000000000001, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 40.70000000000002, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.7, 25.899999999999928, 42.500000000000014, -50.00000000000044, 46.099999999999994, 14.09999999999976, 35.70000000000003, 43.10000000000001, 46.099999999999994, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 34.10000000000004, 5.299999999999635, 38.50000000000003, 31.900000000000013, 30.099999999999987, 31.1, 34.50000000000004, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 26.69999999999994, 28.29999999999996, -50.00000000000044, 39.70000000000002, 42.500000000000014, 36.10000000000004, 40.500000000000014, 17.69999999999981, 46.9, -50.00000000000044, 25.499999999999922, 46.5, -50.00000000000044, 31.500000000000007, 41.90000000000001, 42.10000000000001, 41.30000000000001, 44.7], "episode_lengths": [116, 82, 438, 46, 144, 500, 318, 166, 80, 500, 162, 318, 500, 76, 500, 500, 410, 192, 500, 68, 54, 42, 50, 500, 196, 120, 500, 58, 500, 106, 500, 46, 384, 54, 108, 68, 46, 116, 500, 500, 30, 94, 54, 50, 500, 500, 128, 44, 242, 76, 500, 40, 360, 144, 70, 40, 128, 500, 58, 500, 160, 448, 116, 182, 200, 190, 156, 500, 218, 500, 162, 500, 46, 500, 62, 500, 500, 500, 500, 72, 38, 500, 234, 218, 500, 104, 76, 140, 96, 324, 32, 500, 246, 36, 500, 186, 82, 80, 88, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41981902935410775, "mean_inference_ms": 1.3344572087058868, "mean_action_processing_ms": 0.15696091890361658, "mean_env_wait_ms": 0.0926338740639523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.016998291015625, "ViewRequirementAgentConnector_ms": 0.17701935768127441}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.402999999999855, "episode_len_mean": 241.68, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 41.90000000000001, 6.299999999999649, 45.5, 35.70000000000003, -50.00000000000044, 18.29999999999982, 33.500000000000036, 42.10000000000001, -50.00000000000044, 33.90000000000004, 18.29999999999982, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 9.099999999999689, 30.9, -50.00000000000044, 43.30000000000001, 44.7, 45.9, 45.1, -50.00000000000044, 30.499999999999993, 38.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.50000000000002, -50.00000000000044, 45.5, 11.699999999999726, 44.7, 39.300000000000026, 43.30000000000001, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 40.70000000000002, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.7, 25.899999999999928, 42.500000000000014, -50.00000000000044, 46.099999999999994, 14.09999999999976, 35.70000000000003, 43.10000000000001, 46.099999999999994, 37.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 34.10000000000004, 5.299999999999635, 38.50000000000003, 31.900000000000013, 30.099999999999987, 31.1, 34.50000000000004, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 26.69999999999994, 28.29999999999996, -50.00000000000044, 39.70000000000002, 42.500000000000014, 36.10000000000004, 40.500000000000014, 17.69999999999981, 46.9, -50.00000000000044, 25.499999999999922, 46.5, -50.00000000000044, 31.500000000000007, 41.90000000000001, 42.10000000000001, 41.30000000000001, 44.7], "episode_lengths": [116, 82, 438, 46, 144, 500, 318, 166, 80, 500, 162, 318, 500, 76, 500, 500, 410, 192, 500, 68, 54, 42, 50, 500, 196, 120, 500, 58, 500, 106, 500, 46, 384, 54, 108, 68, 46, 116, 500, 500, 30, 94, 54, 50, 500, 500, 128, 44, 242, 76, 500, 40, 360, 144, 70, 40, 128, 500, 58, 500, 160, 448, 116, 182, 200, 190, 156, 500, 218, 500, 162, 500, 46, 500, 62, 500, 500, 500, 500, 72, 38, 500, 234, 218, 500, 104, 76, 140, 96, 324, 32, 500, 246, 36, 500, 186, 82, 80, 88, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41981902935410775, "mean_inference_ms": 1.3344572087058868, "mean_action_processing_ms": 0.15696091890361658, "mean_env_wait_ms": 0.0926338740639523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.016998291015625, "ViewRequirementAgentConnector_ms": 0.17701935768127441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3985.4725453246547, "num_env_steps_trained_throughput_per_sec": 3985.4725453246547, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 4242.741, "sample_time_ms": 3820.796, "load_time_ms": 21.2, "load_throughput": 849055.122, "learn_time_ms": 387.247, "learn_throughput": 46481.902, "synch_weights_time_ms": 11.698}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4361, "training_iteration": 64, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-16", "timestamp": 1698245536, "time_this_iter_s": 4.523401975631714, "time_total_s": 225.93941950798035, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.93941950798035, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 85.0142857142857, "ram_util_percent": 28.814285714285717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.84946295067116, "policy_loss": -0.00012661478723640794, "vf_loss": 6.849644078148736, "vf_explained_var": -1.1302806712962962e-06, "kl": 0.000604268617292047, "entropy": 0.5456152701819384, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1742.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.362999999999817, "episode_len_mean": 271.98, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 26.69999999999994, 28.29999999999996, -50.00000000000044, 39.70000000000002, 42.500000000000014, 36.10000000000004, 40.500000000000014, 17.69999999999981, 46.9, -50.00000000000044, 25.499999999999922, 46.5, -50.00000000000044, 31.500000000000007, 41.90000000000001, 42.10000000000001, 41.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, 35.500000000000036, 31.70000000000001, 10.899999999999714, -50.00000000000044, 26.09999999999993, 43.10000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 35.30000000000004, -50.00000000000044, 39.300000000000026, 46.099999999999994, 20.899999999999856, -50.00000000000044, 41.70000000000002, 37.10000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, 34.10000000000004, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, 44.10000000000001, 44.300000000000004, 17.69999999999981, -50.00000000000044, -50.00000000000044, 21.89999999999987, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, 33.500000000000036, 44.7, 43.10000000000001, -50.00000000000044, 45.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.9, 40.90000000000002, 17.899999999999814, 43.50000000000001, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 218, 500, 162, 500, 46, 500, 62, 500, 500, 500, 500, 72, 38, 500, 234, 218, 500, 104, 76, 140, 96, 324, 32, 500, 246, 36, 500, 186, 82, 80, 88, 54, 500, 500, 80, 500, 70, 146, 184, 392, 500, 240, 70, 116, 500, 500, 70, 500, 500, 500, 206, 148, 500, 108, 40, 292, 500, 84, 130, 72, 500, 500, 124, 500, 500, 72, 500, 68, 160, 500, 42, 500, 90, 38, 500, 60, 58, 324, 500, 500, 282, 138, 500, 500, 42, 166, 54, 70, 500, 50, 66, 500, 500, 192, 92, 322, 66, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42075348232618576, "mean_inference_ms": 1.3382740790536791, "mean_action_processing_ms": 0.15778567838875251, "mean_env_wait_ms": 0.09302876860809418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019992828369140625, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.1309802532196045}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.362999999999817, "episode_len_mean": 271.98, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, -50.00000000000044, 26.69999999999994, 28.29999999999996, -50.00000000000044, 39.70000000000002, 42.500000000000014, 36.10000000000004, 40.500000000000014, 17.69999999999981, 46.9, -50.00000000000044, 25.499999999999922, 46.5, -50.00000000000044, 31.500000000000007, 41.90000000000001, 42.10000000000001, 41.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, 35.500000000000036, 31.70000000000001, 10.899999999999714, -50.00000000000044, 26.09999999999993, 43.10000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.49999999999998, 35.30000000000004, -50.00000000000044, 39.300000000000026, 46.099999999999994, 20.899999999999856, -50.00000000000044, 41.70000000000002, 37.10000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.30000000000001, 34.10000000000004, -50.00000000000044, 45.9, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, 44.10000000000001, 44.300000000000004, 17.69999999999981, -50.00000000000044, -50.00000000000044, 21.89999999999987, 36.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, 33.500000000000036, 44.7, 43.10000000000001, -50.00000000000044, 45.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.9, 40.90000000000002, 17.899999999999814, 43.50000000000001, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 218, 500, 162, 500, 46, 500, 62, 500, 500, 500, 500, 72, 38, 500, 234, 218, 500, 104, 76, 140, 96, 324, 32, 500, 246, 36, 500, 186, 82, 80, 88, 54, 500, 500, 80, 500, 70, 146, 184, 392, 500, 240, 70, 116, 500, 500, 70, 500, 500, 500, 206, 148, 500, 108, 40, 292, 500, 84, 130, 72, 500, 500, 124, 500, 500, 72, 500, 68, 160, 500, 42, 500, 90, 38, 500, 60, 58, 324, 500, 500, 282, 138, 500, 500, 42, 166, 54, 70, 500, 50, 66, 500, 500, 192, 92, 322, 66, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42075348232618576, "mean_inference_ms": 1.3382740790536791, "mean_action_processing_ms": 0.15778567838875251, "mean_env_wait_ms": 0.09302876860809418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019992828369140625, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.1309802532196045}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3733.649627730304, "num_env_steps_trained_throughput_per_sec": 3733.649627730304, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 4407.043, "sample_time_ms": 3957.796, "load_time_ms": 23.6, "load_throughput": 762703.962, "learn_time_ms": 411.946, "learn_throughput": 43695.051, "synch_weights_time_ms": 11.901}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4428, "training_iteration": 65, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-21", "timestamp": 1698245541, "time_this_iter_s": 4.830016374588013, "time_total_s": 230.76943588256836, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.76943588256836, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 89.61666666666666, "ram_util_percent": 28.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 7.047827261465567, "policy_loss": -0.0002757513688670264, "vf_loss": 7.048152058212845, "vf_explained_var": -1.2539051197193288e-06, "kl": 0.0006484922480284851, "entropy": 0.4898817075623406, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1769.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.599999999999858, "episode_len_mean": 224.7, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, 33.500000000000036, 44.7, 43.10000000000001, -50.00000000000044, 45.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.9, 40.90000000000002, 17.899999999999814, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.90000000000002, 34.900000000000034, 41.90000000000001, 46.099999999999994, 26.69999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.30000000000001, 41.90000000000001, 40.500000000000014, 37.10000000000003, 41.90000000000001, -50.00000000000044, 45.5, 41.90000000000001, 44.5, 5.899999999999643, 44.5, 44.300000000000004, 26.89999999999994, 42.10000000000001, -50.00000000000044, 29.299999999999976, 45.5, 44.900000000000006, 23.099999999999888, -50.00000000000044, 1.099999999999575, 43.900000000000006, 41.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.5, 46.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.90000000000002, 46.5, -50.00000000000044, 41.90000000000001, 35.500000000000036, 43.30000000000001, 40.70000000000002, -50.00000000000044, 44.900000000000006, 48.1, 45.9, -50.00000000000044, 45.9, 45.1, 43.50000000000001, 32.700000000000024, 36.900000000000034], "episode_lengths": [138, 500, 500, 42, 166, 54, 70, 500, 50, 66, 500, 500, 192, 92, 322, 66, 500, 80, 500, 92, 152, 82, 40, 234, 346, 500, 500, 140, 68, 82, 96, 130, 82, 500, 46, 82, 56, 442, 56, 58, 232, 80, 500, 208, 46, 52, 270, 500, 490, 62, 88, 62, 52, 500, 56, 38, 30, 500, 500, 500, 54, 500, 56, 500, 70, 54, 500, 500, 100, 500, 72, 126, 28, 500, 500, 62, 64, 500, 226, 500, 500, 500, 64, 102, 36, 500, 82, 146, 68, 94, 500, 52, 20, 42, 500, 42, 50, 66, 174, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4240680799025267, "mean_inference_ms": 1.347485984773721, "mean_action_processing_ms": 0.1590208429195355, "mean_env_wait_ms": 0.0936007598581541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035979270935058594, "StateBufferConnector_ms": 0.0099945068359375, "ViewRequirementAgentConnector_ms": 0.14200305938720703}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.599999999999858, "episode_len_mean": 224.7, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, -50.00000000000044, 45.9, 33.500000000000036, 44.7, 43.10000000000001, -50.00000000000044, 45.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.9, 40.90000000000002, 17.899999999999814, 43.50000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 40.90000000000002, 34.900000000000034, 41.90000000000001, 46.099999999999994, 26.69999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 36.10000000000004, 43.30000000000001, 41.90000000000001, 40.500000000000014, 37.10000000000003, 41.90000000000001, -50.00000000000044, 45.5, 41.90000000000001, 44.5, 5.899999999999643, 44.5, 44.300000000000004, 26.89999999999994, 42.10000000000001, -50.00000000000044, 29.299999999999976, 45.5, 44.900000000000006, 23.099999999999888, -50.00000000000044, 1.099999999999575, 43.900000000000006, 41.30000000000001, 43.900000000000006, 44.900000000000006, -50.00000000000044, 44.5, 46.3, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.90000000000002, 46.5, -50.00000000000044, 41.90000000000001, 35.500000000000036, 43.30000000000001, 40.70000000000002, -50.00000000000044, 44.900000000000006, 48.1, 45.9, -50.00000000000044, 45.9, 45.1, 43.50000000000001, 32.700000000000024, 36.900000000000034], "episode_lengths": [138, 500, 500, 42, 166, 54, 70, 500, 50, 66, 500, 500, 192, 92, 322, 66, 500, 80, 500, 92, 152, 82, 40, 234, 346, 500, 500, 140, 68, 82, 96, 130, 82, 500, 46, 82, 56, 442, 56, 58, 232, 80, 500, 208, 46, 52, 270, 500, 490, 62, 88, 62, 52, 500, 56, 38, 30, 500, 500, 500, 54, 500, 56, 500, 70, 54, 500, 500, 100, 500, 72, 126, 28, 500, 500, 62, 64, 500, 226, 500, 500, 500, 64, 102, 36, 500, 82, 146, 68, 94, 500, 52, 20, 42, 500, 42, 50, 66, 174, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4240680799025267, "mean_inference_ms": 1.347485984773721, "mean_action_processing_ms": 0.1590208429195355, "mean_env_wait_ms": 0.0936007598581541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035979270935058594, "StateBufferConnector_ms": 0.0099945068359375, "ViewRequirementAgentConnector_ms": 0.14200305938720703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3669.716943553246, "num_env_steps_trained_throughput_per_sec": 3669.716943553246, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 4563.535, "sample_time_ms": 4117.488, "load_time_ms": 23.4, "load_throughput": 769223.822, "learn_time_ms": 408.746, "learn_throughput": 44037.105, "synch_weights_time_ms": 12.001}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4510, "training_iteration": 66, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-26", "timestamp": 1698245546, "time_this_iter_s": 4.912007808685303, "time_total_s": 235.68144369125366, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.68144369125366, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 86.62857142857145, "ram_util_percent": 28.914285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.302307164227521, "policy_loss": -0.0004693874744353471, "vf_loss": 6.30282610434073, "vf_explained_var": -1.011071381745515e-06, "kl": 0.0005281442729988663, "entropy": 0.4955732954872979, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1796.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.264999999999822, "episode_len_mean": 262.94, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.90000000000002, 46.5, -50.00000000000044, 41.90000000000001, 35.500000000000036, 43.30000000000001, 40.70000000000002, -50.00000000000044, 44.900000000000006, 48.1, 45.9, -50.00000000000044, 45.9, 45.1, 43.50000000000001, 32.700000000000024, 36.900000000000034, 23.699999999999896, 37.70000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 39.90000000000002, 45.3, 34.50000000000004, 36.70000000000003, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.900000000000006, 28.09999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, 38.90000000000002, 46.5, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 47.9, 47.5, -50.00000000000044, 45.9, 36.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 39.70000000000002, 33.70000000000004, 42.30000000000001, 45.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [56, 500, 70, 54, 500, 500, 100, 500, 72, 126, 28, 500, 500, 62, 64, 500, 226, 500, 500, 500, 64, 102, 36, 500, 82, 146, 68, 94, 500, 52, 20, 42, 500, 42, 50, 66, 174, 132, 264, 124, 112, 500, 500, 500, 500, 146, 102, 48, 156, 134, 500, 500, 250, 500, 62, 220, 500, 94, 500, 258, 500, 112, 36, 500, 50, 52, 500, 48, 500, 22, 26, 500, 42, 140, 154, 500, 500, 500, 26, 500, 500, 36, 112, 500, 500, 164, 500, 104, 164, 78, 44, 168, 500, 500, 500, 500, 174, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42536266791077254, "mean_inference_ms": 1.3529163144555678, "mean_action_processing_ms": 0.1593581325783308, "mean_env_wait_ms": 0.09396521454123309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04595613479614258, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.153031587600708}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.264999999999822, "episode_len_mean": 262.94, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.900000000000006, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.7, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.90000000000002, 46.5, -50.00000000000044, 41.90000000000001, 35.500000000000036, 43.30000000000001, 40.70000000000002, -50.00000000000044, 44.900000000000006, 48.1, 45.9, -50.00000000000044, 45.9, 45.1, 43.50000000000001, 32.700000000000024, 36.900000000000034, 23.699999999999896, 37.70000000000003, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 39.90000000000002, 45.3, 34.50000000000004, 36.70000000000003, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.900000000000006, 28.09999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, 38.90000000000002, 46.5, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 47.9, 47.5, -50.00000000000044, 45.9, 36.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 39.70000000000002, 33.70000000000004, 42.30000000000001, 45.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [56, 500, 70, 54, 500, 500, 100, 500, 72, 126, 28, 500, 500, 62, 64, 500, 226, 500, 500, 500, 64, 102, 36, 500, 82, 146, 68, 94, 500, 52, 20, 42, 500, 42, 50, 66, 174, 132, 264, 124, 112, 500, 500, 500, 500, 146, 102, 48, 156, 134, 500, 500, 250, 500, 62, 220, 500, 94, 500, 258, 500, 112, 36, 500, 50, 52, 500, 48, 500, 22, 26, 500, 42, 140, 154, 500, 500, 500, 26, 500, 500, 36, 112, 500, 500, 164, 500, 104, 164, 78, 44, 168, 500, 500, 500, 500, 174, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42536266791077254, "mean_inference_ms": 1.3529163144555678, "mean_action_processing_ms": 0.1593581325783308, "mean_env_wait_ms": 0.09396521454123309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04595613479614258, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.153031587600708}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3884.3325371642745, "num_env_steps_trained_throughput_per_sec": 3884.3325371642745, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 4643.235, "sample_time_ms": 4192.588, "load_time_ms": 24.7, "load_throughput": 728731.636, "learn_time_ms": 411.646, "learn_throughput": 43726.903, "synch_weights_time_ms": 12.201}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4572, "training_iteration": 67, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-31", "timestamp": 1698245551, "time_this_iter_s": 4.641000509262085, "time_total_s": 240.32244420051575, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.32244420051575, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 90.5, "ram_util_percent": 28.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.092006948259142, "policy_loss": -9.55203065165767e-05, "vf_loss": 6.092152101022226, "vf_explained_var": -1.1214503535517939e-06, "kl": 0.0007108227167754598, "entropy": 0.4959847706335562, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1823.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.737000000000226, "episode_len_mean": 302.86, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.09999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, 38.90000000000002, 46.5, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 47.9, 47.5, -50.00000000000044, 45.9, 36.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 39.70000000000002, 33.70000000000004, 42.30000000000001, 45.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.10000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 40.30000000000002, 41.70000000000002, 44.10000000000001, 40.90000000000002, 16.09999999999979, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 28.699999999999967, -50.00000000000044], "episode_lengths": [220, 500, 94, 500, 258, 500, 112, 36, 500, 50, 52, 500, 48, 500, 22, 26, 500, 42, 140, 154, 500, 500, 500, 26, 500, 500, 36, 112, 500, 500, 164, 500, 104, 164, 78, 44, 168, 500, 500, 500, 500, 174, 500, 44, 500, 500, 500, 500, 58, 500, 70, 500, 500, 500, 40, 500, 500, 80, 150, 500, 40, 500, 500, 500, 500, 500, 32, 212, 40, 100, 500, 46, 500, 98, 84, 60, 92, 340, 500, 44, 500, 182, 500, 500, 114, 500, 74, 500, 500, 80, 500, 500, 60, 500, 500, 36, 500, 72, 214, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4266971058307749, "mean_inference_ms": 1.3561829651742414, "mean_action_processing_ms": 0.15944104768875939, "mean_env_wait_ms": 0.09417930011787702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043987274169921875, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.14302682876586914}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.737000000000226, "episode_len_mean": 302.86, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.09999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 24.299999999999905, -50.00000000000044, 38.90000000000002, 46.5, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 47.9, 47.5, -50.00000000000044, 45.9, 36.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 39.70000000000002, 33.70000000000004, 42.30000000000001, 45.7, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.10000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 40.30000000000002, 41.70000000000002, 44.10000000000001, 40.90000000000002, 16.09999999999979, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 28.699999999999967, -50.00000000000044], "episode_lengths": [220, 500, 94, 500, 258, 500, 112, 36, 500, 50, 52, 500, 48, 500, 22, 26, 500, 42, 140, 154, 500, 500, 500, 26, 500, 500, 36, 112, 500, 500, 164, 500, 104, 164, 78, 44, 168, 500, 500, 500, 500, 174, 500, 44, 500, 500, 500, 500, 58, 500, 70, 500, 500, 500, 40, 500, 500, 80, 150, 500, 40, 500, 500, 500, 500, 500, 32, 212, 40, 100, 500, 46, 500, 98, 84, 60, 92, 340, 500, 44, 500, 182, 500, 500, 114, 500, 74, 500, 500, 80, 500, 500, 60, 500, 500, 36, 500, 72, 214, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4266971058307749, "mean_inference_ms": 1.3561829651742414, "mean_action_processing_ms": 0.15944104768875939, "mean_env_wait_ms": 0.09417930011787702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043987274169921875, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.14302682876586914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4665.628081619214, "num_env_steps_trained_throughput_per_sec": 4665.628081619214, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 4694.035, "sample_time_ms": 4245.588, "load_time_ms": 24.201, "load_throughput": 743780.819, "learn_time_ms": 410.245, "learn_throughput": 43876.237, "synch_weights_time_ms": 12.002}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4627, "training_iteration": 68, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-35", "timestamp": 1698245555, "time_this_iter_s": 3.863999843597412, "time_total_s": 244.18644404411316, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.18644404411316, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 72.89999999999999, "ram_util_percent": 29.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.381792439354791, "policy_loss": -0.0006242683502259078, "vf_loss": 6.382467110951741, "vf_explained_var": -4.635916815863715e-07, "kl": 0.000909319684061066, "entropy": 0.5034221090652324, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1850.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.3240000000002152, "episode_len_mean": 293.76, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 40.30000000000002, 41.70000000000002, 44.10000000000001, 40.90000000000002, 16.09999999999979, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 28.699999999999967, -50.00000000000044, 36.10000000000004, 41.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.1, 20.699999999999854, 38.10000000000002, 45.1, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.700000000000024, 33.70000000000004, 39.10000000000002, -50.00000000000044, 46.699999999999996, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 42.900000000000006, 47.1, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 32, 212, 40, 100, 500, 46, 500, 98, 84, 60, 92, 340, 500, 44, 500, 182, 500, 500, 114, 500, 74, 500, 500, 80, 500, 500, 60, 500, 500, 36, 500, 72, 214, 500, 140, 88, 280, 500, 500, 84, 500, 500, 500, 500, 114, 500, 100, 500, 50, 294, 120, 50, 500, 36, 60, 500, 64, 500, 90, 500, 40, 500, 174, 164, 110, 500, 34, 292, 500, 500, 500, 500, 120, 500, 500, 68, 500, 54, 500, 500, 246, 70, 66, 50, 500, 500, 50, 60, 500, 72, 30, 66, 60, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4278677448570915, "mean_inference_ms": 1.3618308613724088, "mean_action_processing_ms": 0.16017445028220811, "mean_env_wait_ms": 0.0946791656982468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300905227661133, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1270310878753662}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.3240000000002152, "episode_len_mean": 293.76, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, 46.099999999999994, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 40.30000000000002, 41.70000000000002, 44.10000000000001, 40.90000000000002, 16.09999999999979, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 28.699999999999967, -50.00000000000044, 36.10000000000004, 41.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.1, 20.699999999999854, 38.10000000000002, 45.1, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 43.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, -50.00000000000044, 32.700000000000024, 33.70000000000004, 39.10000000000002, -50.00000000000044, 46.699999999999996, 20.899999999999856, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 42.900000000000006, 47.1, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 32, 212, 40, 100, 500, 46, 500, 98, 84, 60, 92, 340, 500, 44, 500, 182, 500, 500, 114, 500, 74, 500, 500, 80, 500, 500, 60, 500, 500, 36, 500, 72, 214, 500, 140, 88, 280, 500, 500, 84, 500, 500, 500, 500, 114, 500, 100, 500, 50, 294, 120, 50, 500, 36, 60, 500, 64, 500, 90, 500, 40, 500, 174, 164, 110, 500, 34, 292, 500, 500, 500, 500, 120, 500, 500, 68, 500, 54, 500, 500, 246, 70, 66, 50, 500, 500, 50, 60, 500, 72, 30, 66, 60, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4278677448570915, "mean_inference_ms": 1.3618308613724088, "mean_action_processing_ms": 0.16017445028220811, "mean_env_wait_ms": 0.0946791656982468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300905227661133, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1270310878753662}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3751.5641937730397, "num_env_steps_trained_throughput_per_sec": 3751.5641937730397, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 4702.535, "sample_time_ms": 4248.788, "load_time_ms": 24.801, "load_throughput": 725782.304, "learn_time_ms": 415.045, "learn_throughput": 43368.809, "synch_weights_time_ms": 11.901}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4690, "training_iteration": 69, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-39", "timestamp": 1698245559, "time_this_iter_s": 4.802998304367065, "time_total_s": 248.98944234848022, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.98944234848022, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 86.21666666666665, "ram_util_percent": 29.083333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.36082324275264, "policy_loss": -1.3965699407789442e-05, "vf_loss": 6.3608874215020075, "vf_explained_var": -8.477105034722222e-07, "kl": 0.0003434262679271769, "entropy": 0.5021295922773855, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1877.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.950999999999832, "episode_len_mean": 246.1, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 42.900000000000006, 47.1, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 45.9, 41.100000000000016, 44.5, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.900000000000006, 37.50000000000003, 42.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 42.500000000000014, 47.3, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, 35.500000000000036, 47.5, 44.900000000000006, 44.7, 42.70000000000001, -50.00000000000044, 46.699999999999996, 45.3, 40.10000000000002, 39.50000000000002, 40.70000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 38.10000000000002, 44.300000000000004, 37.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 45.3, 44.900000000000006, 32.50000000000002, -50.00000000000044], "episode_lengths": [500, 120, 500, 500, 68, 500, 54, 500, 500, 246, 70, 66, 50, 500, 500, 50, 60, 500, 72, 30, 66, 60, 500, 500, 500, 500, 176, 86, 42, 90, 56, 160, 500, 500, 106, 72, 126, 76, 68, 500, 500, 68, 500, 500, 142, 76, 28, 26, 500, 500, 60, 500, 66, 146, 26, 52, 54, 74, 500, 34, 48, 100, 106, 94, 154, 500, 500, 500, 82, 500, 216, 500, 34, 500, 500, 90, 500, 500, 56, 40, 52, 500, 54, 500, 52, 120, 58, 126, 62, 500, 500, 228, 500, 500, 88, 52, 48, 52, 176, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42975619470754695, "mean_inference_ms": 1.369555351491951, "mean_action_processing_ms": 0.16112294700816815, "mean_env_wait_ms": 0.09513920353149484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299236297607422, "StateBufferConnector_ms": 0.05999279022216797, "ViewRequirementAgentConnector_ms": 0.14201712608337402}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.950999999999832, "episode_len_mean": 246.1, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 25.499999999999922, 43.10000000000001, 43.50000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.1, 44.10000000000001, -50.00000000000044, 42.900000000000006, 47.1, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 41.500000000000014, 45.9, 41.100000000000016, 44.5, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.900000000000006, 37.50000000000003, 42.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 42.500000000000014, 47.3, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.50000000000001, 35.500000000000036, 47.5, 44.900000000000006, 44.7, 42.70000000000001, -50.00000000000044, 46.699999999999996, 45.3, 40.10000000000002, 39.50000000000002, 40.70000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 44.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 38.10000000000002, 44.300000000000004, 37.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 45.3, 44.900000000000006, 32.50000000000002, -50.00000000000044], "episode_lengths": [500, 120, 500, 500, 68, 500, 54, 500, 500, 246, 70, 66, 50, 500, 500, 50, 60, 500, 72, 30, 66, 60, 500, 500, 500, 500, 176, 86, 42, 90, 56, 160, 500, 500, 106, 72, 126, 76, 68, 500, 500, 68, 500, 500, 142, 76, 28, 26, 500, 500, 60, 500, 66, 146, 26, 52, 54, 74, 500, 34, 48, 100, 106, 94, 154, 500, 500, 500, 82, 500, 216, 500, 34, 500, 500, 90, 500, 500, 56, 40, 52, 500, 54, 500, 52, 120, 58, 126, 62, 500, 500, 228, 500, 500, 88, 52, 48, 52, 176, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42975619470754695, "mean_inference_ms": 1.369555351491951, "mean_action_processing_ms": 0.16112294700816815, "mean_env_wait_ms": 0.09513920353149484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299236297607422, "StateBufferConnector_ms": 0.05999279022216797, "ViewRequirementAgentConnector_ms": 0.14201712608337402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3753.1262973264566, "num_env_steps_trained_throughput_per_sec": 3753.1262973264566, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 4719.431, "sample_time_ms": 4264.388, "load_time_ms": 25.101, "load_throughput": 717114.652, "learn_time_ms": 416.341, "learn_throughput": 43233.767, "synch_weights_time_ms": 11.801}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4764, "training_iteration": 70, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-44", "timestamp": 1698245564, "time_this_iter_s": 4.80400013923645, "time_total_s": 253.79344248771667, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.79344248771667, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 87.97142857142858, "ram_util_percent": 29.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.558723785259105, "policy_loss": -0.00019178097998654402, "vf_loss": 6.558963510725233, "vf_explained_var": -1.4614175867151331e-06, "kl": 0.00045859628743595814, "entropy": 0.4774799578719669, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1904.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.383999999999839, "episode_len_mean": 236.8, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 38.10000000000002, 44.300000000000004, 37.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 45.3, 44.900000000000006, 32.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.50000000000002, 44.10000000000001, 43.10000000000001, 43.7, -50.00000000000044, 44.7, 34.900000000000034, 45.5, 46.3, 46.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.500000000000007, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 45.9, 38.700000000000024, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 12.099999999999731, 44.7, 44.10000000000001, 46.699999999999996, 47.3, 41.90000000000001, 45.7, 44.300000000000004, 2.699999999999598, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 39.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 47.1, 29.899999999999984, 42.500000000000014, 42.30000000000001, -50.00000000000044, 46.5, 33.10000000000003, 44.5, 44.10000000000001, 44.900000000000006, 37.90000000000003, -50.00000000000044], "episode_lengths": [500, 56, 40, 52, 500, 54, 500, 52, 120, 58, 126, 62, 500, 500, 228, 500, 500, 88, 52, 48, 52, 176, 500, 500, 102, 500, 92, 40, 500, 500, 176, 60, 70, 64, 500, 54, 152, 46, 38, 36, 500, 52, 500, 32, 102, 500, 500, 500, 62, 186, 52, 500, 50, 500, 500, 500, 500, 70, 500, 36, 42, 114, 46, 500, 500, 500, 500, 44, 380, 54, 60, 34, 28, 82, 44, 58, 474, 132, 500, 500, 500, 500, 42, 30, 108, 500, 500, 190, 30, 202, 76, 78, 500, 36, 170, 56, 60, 52, 122, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4322764482131264, "mean_inference_ms": 1.3770278080513847, "mean_action_processing_ms": 0.16224619410024302, "mean_env_wait_ms": 0.0955307267881609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.06099843978881836, "ViewRequirementAgentConnector_ms": 0.15899991989135742}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.383999999999839, "episode_len_mean": 236.8, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, 44.900000000000006, 38.10000000000002, 44.300000000000004, 37.50000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.900000000000006, 45.3, 44.900000000000006, 32.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 32.50000000000002, 44.10000000000001, 43.10000000000001, 43.7, -50.00000000000044, 44.7, 34.900000000000034, 45.5, 46.3, 46.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 31.500000000000007, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.5, 45.9, 38.700000000000024, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 12.099999999999731, 44.7, 44.10000000000001, 46.699999999999996, 47.3, 41.90000000000001, 45.7, 44.300000000000004, 2.699999999999598, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 39.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 47.1, 29.899999999999984, 42.500000000000014, 42.30000000000001, -50.00000000000044, 46.5, 33.10000000000003, 44.5, 44.10000000000001, 44.900000000000006, 37.90000000000003, -50.00000000000044], "episode_lengths": [500, 56, 40, 52, 500, 54, 500, 52, 120, 58, 126, 62, 500, 500, 228, 500, 500, 88, 52, 48, 52, 176, 500, 500, 102, 500, 92, 40, 500, 500, 176, 60, 70, 64, 500, 54, 152, 46, 38, 36, 500, 52, 500, 32, 102, 500, 500, 500, 62, 186, 52, 500, 50, 500, 500, 500, 500, 70, 500, 36, 42, 114, 46, 500, 500, 500, 500, 44, 380, 54, 60, 34, 28, 82, 44, 58, 474, 132, 500, 500, 500, 500, 42, 30, 108, 500, 500, 190, 30, 202, 76, 78, 500, 36, 170, 56, 60, 52, 122, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4322764482131264, "mean_inference_ms": 1.3770278080513847, "mean_action_processing_ms": 0.16224619410024302, "mean_env_wait_ms": 0.0955307267881609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.06099843978881836, "ViewRequirementAgentConnector_ms": 0.15899991989135742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3641.5103831619413, "num_env_steps_trained_throughput_per_sec": 3641.5103831619413, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 4718.029, "sample_time_ms": 4252.785, "load_time_ms": 25.801, "load_throughput": 697651.488, "learn_time_ms": 425.741, "learn_throughput": 42279.226, "synch_weights_time_ms": 11.901}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4841, "training_iteration": 71, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-49", "timestamp": 1698245569, "time_this_iter_s": 4.951005458831787, "time_total_s": 258.74444794654846, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.74444794654846, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 84.82857142857144, "ram_util_percent": 28.914285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.678929752773708, "policy_loss": -0.00045605514336515354, "vf_loss": 6.679434423093443, "vf_explained_var": -1.5453056052879052e-06, "kl": 0.0009972004875306892, "entropy": 0.4853364140899093, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1931.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.274999999999828, "episode_len_mean": 242.9, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 44.300000000000004, 2.699999999999598, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 39.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 47.1, 29.899999999999984, 42.500000000000014, 42.30000000000001, -50.00000000000044, 46.5, 33.10000000000003, 44.5, 44.10000000000001, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 32.90000000000003, 46.5, 35.70000000000003, 46.5, 45.3, 44.5, 43.30000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.699999999999996, -50.00000000000044, 27.49999999999995, 32.90000000000003, 41.30000000000001, 0.49999999999956657, 43.30000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.5, 46.3, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.9, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 47.7, 45.7, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 43.10000000000001, 43.7, 25.29999999999992, 44.7, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 41.90000000000001, -50.00000000000044, 10.899999999999714, 45.1], "episode_lengths": [44, 58, 474, 132, 500, 500, 500, 500, 42, 30, 108, 500, 500, 190, 30, 202, 76, 78, 500, 36, 170, 56, 60, 52, 122, 500, 500, 86, 500, 172, 36, 144, 36, 48, 56, 68, 500, 62, 52, 46, 500, 500, 40, 34, 500, 226, 172, 88, 496, 68, 390, 500, 500, 86, 56, 38, 38, 76, 500, 500, 22, 48, 40, 500, 500, 438, 500, 500, 500, 210, 500, 38, 500, 54, 500, 94, 500, 500, 500, 42, 500, 500, 24, 44, 500, 46, 26, 500, 70, 64, 248, 54, 34, 500, 46, 50, 82, 500, 392, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43393197447026227, "mean_inference_ms": 1.3829013559365362, "mean_action_processing_ms": 0.16308300168139983, "mean_env_wait_ms": 0.09620549340534154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051007747650146484, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.1730363368988037}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.274999999999828, "episode_len_mean": 242.9, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 44.300000000000004, 2.699999999999598, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 39.300000000000026, -50.00000000000044, -50.00000000000044, 31.1, 47.1, 29.899999999999984, 42.500000000000014, 42.30000000000001, -50.00000000000044, 46.5, 33.10000000000003, 44.5, 44.10000000000001, 44.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 32.90000000000003, 46.5, 35.70000000000003, 46.5, 45.3, 44.5, 43.30000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.699999999999996, -50.00000000000044, 27.49999999999995, 32.90000000000003, 41.30000000000001, 0.49999999999956657, 43.30000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.5, 46.3, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.9, 45.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 47.7, 45.7, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 43.10000000000001, 43.7, 25.29999999999992, 44.7, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 41.90000000000001, -50.00000000000044, 10.899999999999714, 45.1], "episode_lengths": [44, 58, 474, 132, 500, 500, 500, 500, 42, 30, 108, 500, 500, 190, 30, 202, 76, 78, 500, 36, 170, 56, 60, 52, 122, 500, 500, 86, 500, 172, 36, 144, 36, 48, 56, 68, 500, 62, 52, 46, 500, 500, 40, 34, 500, 226, 172, 88, 496, 68, 390, 500, 500, 86, 56, 38, 38, 76, 500, 500, 22, 48, 40, 500, 500, 438, 500, 500, 500, 210, 500, 38, 500, 54, 500, 94, 500, 500, 500, 42, 500, 500, 24, 44, 500, 46, 26, 500, 70, 64, 248, 54, 34, 500, 46, 50, 82, 500, 392, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43393197447026227, "mean_inference_ms": 1.3829013559365362, "mean_action_processing_ms": 0.16308300168139983, "mean_env_wait_ms": 0.09620549340534154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051007747650146484, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.1730363368988037}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3598.5673695102673, "num_env_steps_trained_throughput_per_sec": 3598.5673695102673, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 4721.642, "sample_time_ms": 4262.199, "load_time_ms": 25.601, "load_throughput": 703107.859, "learn_time_ms": 420.441, "learn_throughput": 42812.204, "synch_weights_time_ms": 11.602}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4915, "training_iteration": 72, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-54", "timestamp": 1698245574, "time_this_iter_s": 5.0079896450042725, "time_total_s": 263.75243759155273, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.75243759155273, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 88.08571428571429, "ram_util_percent": 29.014285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.705873436397976, "policy_loss": -0.0006211039230779365, "vf_loss": 6.7065394896048085, "vf_explained_var": -9.249757837366175e-07, "kl": 0.000684653745978452, "entropy": 0.45010412070486283, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1958.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.857999999999812, "episode_len_mean": 252.02, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 47.7, 45.7, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 43.10000000000001, 43.7, 25.29999999999992, 44.7, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 41.90000000000001, -50.00000000000044, 10.899999999999714, 45.1, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 35.900000000000034, 11.29999999999972, -50.00000000000044, 46.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.50000000000002, -50.00000000000044, 48.1, -50.00000000000044, 44.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.9, 46.9, 45.9, -50.00000000000044, 47.5, 45.3, 47.7, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 31.500000000000007, 45.1, 42.500000000000014, 42.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 47.3, 42.500000000000014, 44.300000000000004, 47.3, 4.699999999999626, 45.9, 47.5, 46.3, 45.3], "episode_lengths": [500, 94, 500, 500, 500, 42, 500, 500, 24, 44, 500, 46, 26, 500, 70, 64, 248, 54, 34, 500, 46, 50, 82, 500, 392, 50, 46, 116, 500, 500, 500, 500, 500, 60, 500, 100, 72, 500, 142, 388, 500, 36, 500, 52, 500, 500, 40, 500, 38, 66, 500, 500, 42, 82, 500, 500, 50, 500, 500, 76, 106, 500, 20, 500, 54, 96, 500, 500, 148, 500, 500, 32, 32, 42, 500, 26, 48, 24, 176, 500, 500, 84, 186, 50, 76, 78, 32, 500, 500, 322, 500, 28, 76, 58, 28, 454, 42, 26, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4357648677010593, "mean_inference_ms": 1.3883689014993945, "mean_action_processing_ms": 0.16331672718058754, "mean_env_wait_ms": 0.09663048500046134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298734664916992, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.19799208641052246}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.857999999999812, "episode_len_mean": 252.02, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 47.7, 45.7, -50.00000000000044, 45.5, 47.5, -50.00000000000044, 43.10000000000001, 43.7, 25.29999999999992, 44.7, 46.699999999999996, -50.00000000000044, 45.5, 45.1, 41.90000000000001, -50.00000000000044, 10.899999999999714, 45.1, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 35.900000000000034, 11.29999999999972, -50.00000000000044, 46.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.50000000000002, -50.00000000000044, 48.1, -50.00000000000044, 44.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.9, 46.9, 45.9, -50.00000000000044, 47.5, 45.3, 47.7, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 31.500000000000007, 45.1, 42.500000000000014, 42.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 47.3, 42.500000000000014, 44.300000000000004, 47.3, 4.699999999999626, 45.9, 47.5, 46.3, 45.3], "episode_lengths": [500, 94, 500, 500, 500, 42, 500, 500, 24, 44, 500, 46, 26, 500, 70, 64, 248, 54, 34, 500, 46, 50, 82, 500, 392, 50, 46, 116, 500, 500, 500, 500, 500, 60, 500, 100, 72, 500, 142, 388, 500, 36, 500, 52, 500, 500, 40, 500, 38, 66, 500, 500, 42, 82, 500, 500, 50, 500, 500, 76, 106, 500, 20, 500, 54, 96, 500, 500, 148, 500, 500, 32, 32, 42, 500, 26, 48, 24, 176, 500, 500, 84, 186, 50, 76, 78, 32, 500, 500, 322, 500, 28, 76, 58, 28, 454, 42, 26, 38, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4357648677010593, "mean_inference_ms": 1.3883689014993945, "mean_action_processing_ms": 0.16331672718058754, "mean_env_wait_ms": 0.09663048500046134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298734664916992, "StateBufferConnector_ms": 0.011002540588378906, "ViewRequirementAgentConnector_ms": 0.19799208641052246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3779.130601666247, "num_env_steps_trained_throughput_per_sec": 3779.130601666247, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 4703.643, "sample_time_ms": 4249.8, "load_time_ms": 26.501, "load_throughput": 679229.126, "learn_time_ms": 413.941, "learn_throughput": 43484.475, "synch_weights_time_ms": 11.601}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 4989, "training_iteration": 73, "trial_id": "9f288_00004", "date": "2023-10-25_15-52-59", "timestamp": 1698245579, "time_this_iter_s": 4.768999338150024, "time_total_s": 268.52143692970276, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.52143692970276, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 91.60000000000001, "ram_util_percent": 29.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.639026959737142, "policy_loss": -0.0003146142526357262, "vf_loss": 6.63939165185999, "vf_explained_var": -8.609559800889757e-07, "kl": 0.0006142183566642719, "entropy": 0.5008615288469527, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 1985.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.229999999999832, "episode_len_mean": 238.36, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 46.9, 45.9, -50.00000000000044, 47.5, 45.3, 47.7, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 31.500000000000007, 45.1, 42.500000000000014, 42.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 47.3, 42.500000000000014, 44.300000000000004, 47.3, 4.699999999999626, 45.9, 47.5, 46.3, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.29999999999992, 15.099999999999774, -50.00000000000044, 47.1, 43.7, 26.69999999999994, 47.1, 46.3, -50.00000000000044, 40.500000000000014, 42.30000000000001, 45.7, 44.300000000000004, 45.9, 41.30000000000001, -50.00000000000044, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 32.700000000000024, 45.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 14.299999999999763, -50.00000000000044, 42.10000000000001, 46.9, 43.10000000000001, 45.9, 46.3, 43.10000000000001, -50.00000000000044, 46.099999999999994, 17.499999999999808, 0.6999999999995694, 42.10000000000001, 32.50000000000002, 46.099999999999994, -50.00000000000044, 42.30000000000001, 25.699999999999925, 39.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 32, 32, 42, 500, 26, 48, 24, 176, 500, 500, 84, 186, 50, 76, 78, 32, 500, 500, 322, 500, 28, 76, 58, 28, 454, 42, 26, 38, 48, 500, 62, 500, 248, 350, 500, 30, 64, 234, 30, 38, 500, 96, 78, 44, 58, 42, 88, 500, 56, 140, 500, 500, 40, 500, 500, 500, 258, 500, 174, 46, 500, 500, 84, 500, 56, 500, 40, 500, 500, 56, 500, 358, 500, 80, 32, 70, 42, 38, 70, 500, 40, 326, 494, 80, 176, 40, 500, 78, 244, 110, 500, 58, 500, 500, 500, 42, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4375598538772414, "mean_inference_ms": 1.392662497256928, "mean_action_processing_ms": 0.16348904953501925, "mean_env_wait_ms": 0.0967612610025428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023952484130859375, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.16000795364379883}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.229999999999832, "episode_len_mean": 238.36, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 46.9, 45.9, -50.00000000000044, 47.5, 45.3, 47.7, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 31.500000000000007, 45.1, 42.500000000000014, 42.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 47.3, 42.500000000000014, 44.300000000000004, 47.3, 4.699999999999626, 45.9, 47.5, 46.3, 45.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 25.29999999999992, 15.099999999999774, -50.00000000000044, 47.1, 43.7, 26.69999999999994, 47.1, 46.3, -50.00000000000044, 40.500000000000014, 42.30000000000001, 45.7, 44.300000000000004, 45.9, 41.30000000000001, -50.00000000000044, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, -50.00000000000044, 32.700000000000024, 45.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 14.299999999999763, -50.00000000000044, 42.10000000000001, 46.9, 43.10000000000001, 45.9, 46.3, 43.10000000000001, -50.00000000000044, 46.099999999999994, 17.499999999999808, 0.6999999999995694, 42.10000000000001, 32.50000000000002, 46.099999999999994, -50.00000000000044, 42.30000000000001, 25.699999999999925, 39.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 32, 32, 42, 500, 26, 48, 24, 176, 500, 500, 84, 186, 50, 76, 78, 32, 500, 500, 322, 500, 28, 76, 58, 28, 454, 42, 26, 38, 48, 500, 62, 500, 248, 350, 500, 30, 64, 234, 30, 38, 500, 96, 78, 44, 58, 42, 88, 500, 56, 140, 500, 500, 40, 500, 500, 500, 258, 500, 174, 46, 500, 500, 84, 500, 56, 500, 40, 500, 500, 56, 500, 358, 500, 80, 32, 70, 42, 38, 70, 500, 40, 326, 494, 80, 176, 40, 500, 78, 244, 110, 500, 58, 500, 500, 500, 42, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4375598538772414, "mean_inference_ms": 1.392662497256928, "mean_action_processing_ms": 0.16348904953501925, "mean_env_wait_ms": 0.0967612610025428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023952484130859375, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.16000795364379883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4111.466403320695, "num_env_steps_trained_throughput_per_sec": 4111.466403320695, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 4689.803, "sample_time_ms": 4247.1, "load_time_ms": 27.001, "load_throughput": 666653.174, "learn_time_ms": 403.101, "learn_throughput": 44653.833, "synch_weights_time_ms": 10.901}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5059, "training_iteration": 74, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-03", "timestamp": 1698245583, "time_this_iter_s": 4.3899993896484375, "time_total_s": 272.9114363193512, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.9114363193512, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 88.26666666666667, "ram_util_percent": 29.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.37370330316049, "policy_loss": -0.00023251216582677984, "vf_loss": 6.373986526771828, "vf_explained_var": -9.360136809172454e-07, "kl": 0.0005987900053170321, "entropy": 0.5062145292758942, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2012.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.102999999999815, "episode_len_mean": 264.58, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 14.299999999999763, -50.00000000000044, 42.10000000000001, 46.9, 43.10000000000001, 45.9, 46.3, 43.10000000000001, -50.00000000000044, 46.099999999999994, 17.499999999999808, 0.6999999999995694, 42.10000000000001, 32.50000000000002, 46.099999999999994, -50.00000000000044, 42.30000000000001, 25.699999999999925, 39.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 10.099999999999703, -50.00000000000044, 35.10000000000004, 41.70000000000002, -50.00000000000044, 44.5, 40.90000000000002, 35.10000000000004, 40.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.30000000000002, 29.69999999999998, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 30.699999999999996, 30.29999999999999, 46.9, 44.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, 38.700000000000024, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 47.1, 16.499999999999794, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.9, -50.00000000000044, 38.700000000000024, 39.10000000000002, 41.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, 45.5, 44.300000000000004], "episode_lengths": [56, 500, 40, 500, 500, 56, 500, 358, 500, 80, 32, 70, 42, 38, 70, 500, 40, 326, 494, 80, 176, 40, 500, 78, 244, 110, 500, 58, 500, 500, 500, 42, 500, 40, 500, 400, 500, 150, 84, 500, 56, 92, 150, 98, 66, 500, 500, 500, 84, 500, 178, 204, 500, 88, 500, 62, 500, 322, 500, 500, 500, 500, 44, 500, 500, 194, 198, 32, 60, 72, 50, 500, 114, 76, 500, 500, 116, 34, 68, 500, 500, 60, 54, 30, 336, 500, 500, 222, 500, 32, 500, 114, 110, 84, 500, 120, 500, 30, 46, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4383771182215582, "mean_inference_ms": 1.3962702280868888, "mean_action_processing_ms": 0.16422375661098726, "mean_env_wait_ms": 0.09687235105022575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018990755081176758, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.14001679420471191}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.102999999999815, "episode_len_mean": 264.58, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 14.299999999999763, -50.00000000000044, 42.10000000000001, 46.9, 43.10000000000001, 45.9, 46.3, 43.10000000000001, -50.00000000000044, 46.099999999999994, 17.499999999999808, 0.6999999999995694, 42.10000000000001, 32.50000000000002, 46.099999999999994, -50.00000000000044, 42.30000000000001, 25.699999999999925, 39.10000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 10.099999999999703, -50.00000000000044, 35.10000000000004, 41.70000000000002, -50.00000000000044, 44.5, 40.90000000000002, 35.10000000000004, 40.30000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.30000000000002, 29.69999999999998, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 17.899999999999814, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 30.699999999999996, 30.29999999999999, 46.9, 44.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, 38.700000000000024, 42.500000000000014, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.7, 47.1, 16.499999999999794, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.9, -50.00000000000044, 38.700000000000024, 39.10000000000002, 41.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, 45.5, 44.300000000000004], "episode_lengths": [56, 500, 40, 500, 500, 56, 500, 358, 500, 80, 32, 70, 42, 38, 70, 500, 40, 326, 494, 80, 176, 40, 500, 78, 244, 110, 500, 58, 500, 500, 500, 42, 500, 40, 500, 400, 500, 150, 84, 500, 56, 92, 150, 98, 66, 500, 500, 500, 84, 500, 178, 204, 500, 88, 500, 62, 500, 322, 500, 500, 500, 500, 44, 500, 500, 194, 198, 32, 60, 72, 50, 500, 114, 76, 500, 500, 116, 34, 68, 500, 500, 60, 54, 30, 336, 500, 500, 222, 500, 32, 500, 114, 110, 84, 500, 120, 500, 30, 46, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4383771182215582, "mean_inference_ms": 1.3962702280868888, "mean_action_processing_ms": 0.16422375661098726, "mean_env_wait_ms": 0.09687235105022575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018990755081176758, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.14001679420471191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3852.7386029879676, "num_env_steps_trained_throughput_per_sec": 3852.7386029879676, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 4674.901, "sample_time_ms": 4242.4, "load_time_ms": 25.5, "load_throughput": 705871.477, "learn_time_ms": 394.6, "learn_throughput": 45615.867, "synch_weights_time_ms": 10.701}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5124, "training_iteration": 75, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-08", "timestamp": 1698245588, "time_this_iter_s": 4.68199896812439, "time_total_s": 277.5934352874756, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 277.5934352874756, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 88.85714285714288, "ram_util_percent": 28.914285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.864722834693061, "policy_loss": -0.00011644615895218319, "vf_loss": 6.864892782988371, "vf_explained_var": -1.4967388576931423e-06, "kl": 0.0011386700380250482, "entropy": 0.535575247473187, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2039.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.917999999999859, "episode_len_mean": 221.52, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.9, -50.00000000000044, 38.700000000000024, 39.10000000000002, 41.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, 45.5, 44.300000000000004, 35.70000000000003, -50.00000000000044, 47.3, 32.30000000000002, 44.5, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.7, 43.50000000000001, 47.5, 47.9, 41.70000000000002, -50.00000000000044, 44.10000000000001, 44.10000000000001, 44.5, 0.6999999999995694, -50.00000000000044, 22.099999999999874, 36.50000000000003, -50.00000000000044, 44.300000000000004, 24.299999999999905, 46.9, -50.00000000000044, 45.9, 43.30000000000001, 40.10000000000002, -50.00000000000044, 41.70000000000002, 11.899999999999729, -50.00000000000044, 29.49999999999998, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.90000000000002, 44.900000000000006, 27.899999999999956, -50.00000000000044, 43.10000000000001, 46.699999999999996, 42.30000000000001, 40.90000000000002, 44.5, 40.70000000000002, 45.5, 35.900000000000034, 18.699999999999825, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 36.30000000000003, 43.50000000000001, 40.10000000000002, 43.7, 44.900000000000006, 24.499999999999908, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, 46.099999999999994, 24.099999999999902], "episode_lengths": [500, 500, 222, 500, 32, 500, 114, 110, 84, 500, 120, 500, 30, 46, 58, 144, 500, 28, 178, 56, 500, 52, 56, 500, 64, 66, 26, 22, 84, 500, 60, 60, 56, 494, 500, 280, 136, 500, 58, 258, 32, 500, 42, 68, 100, 500, 84, 382, 500, 206, 34, 500, 46, 500, 500, 46, 52, 500, 500, 170, 112, 52, 222, 500, 70, 34, 78, 92, 56, 94, 46, 142, 314, 500, 66, 500, 74, 500, 36, 138, 66, 100, 64, 52, 256, 500, 148, 500, 500, 34, 50, 34, 88, 500, 500, 500, 32, 46, 40, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4400630675084891, "mean_inference_ms": 1.4017372440614173, "mean_action_processing_ms": 0.16529228749436875, "mean_env_wait_ms": 0.09715598793520623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028986454010009766, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.1460130214691162}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.917999999999859, "episode_len_mean": 221.52, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 46.9, -50.00000000000044, 38.700000000000024, 39.10000000000002, 41.70000000000002, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.1, 45.5, 44.300000000000004, 35.70000000000003, -50.00000000000044, 47.3, 32.30000000000002, 44.5, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.7, 43.50000000000001, 47.5, 47.9, 41.70000000000002, -50.00000000000044, 44.10000000000001, 44.10000000000001, 44.5, 0.6999999999995694, -50.00000000000044, 22.099999999999874, 36.50000000000003, -50.00000000000044, 44.300000000000004, 24.299999999999905, 46.9, -50.00000000000044, 45.9, 43.30000000000001, 40.10000000000002, -50.00000000000044, 41.70000000000002, 11.899999999999729, -50.00000000000044, 29.49999999999998, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 38.90000000000002, 44.900000000000006, 27.899999999999956, -50.00000000000044, 43.10000000000001, 46.699999999999996, 42.30000000000001, 40.90000000000002, 44.5, 40.70000000000002, 45.5, 35.900000000000034, 18.699999999999825, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 36.30000000000003, 43.50000000000001, 40.10000000000002, 43.7, 44.900000000000006, 24.499999999999908, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, 46.099999999999994, 24.099999999999902], "episode_lengths": [500, 500, 222, 500, 32, 500, 114, 110, 84, 500, 120, 500, 30, 46, 58, 144, 500, 28, 178, 56, 500, 52, 56, 500, 64, 66, 26, 22, 84, 500, 60, 60, 56, 494, 500, 280, 136, 500, 58, 258, 32, 500, 42, 68, 100, 500, 84, 382, 500, 206, 34, 500, 46, 500, 500, 46, 52, 500, 500, 170, 112, 52, 222, 500, 70, 34, 78, 92, 56, 94, 46, 142, 314, 500, 66, 500, 74, 500, 36, 138, 66, 100, 64, 52, 256, 500, 148, 500, 500, 34, 50, 34, 88, 500, 500, 500, 32, 46, 40, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4400630675084891, "mean_inference_ms": 1.4017372440614173, "mean_action_processing_ms": 0.16529228749436875, "mean_env_wait_ms": 0.09715598793520623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028986454010009766, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.1460130214691162}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4138.855068833657, "num_env_steps_trained_throughput_per_sec": 4138.855068833657, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 4619.303, "sample_time_ms": 4184.102, "load_time_ms": 26.1, "load_throughput": 689647.199, "learn_time_ms": 396.899, "learn_throughput": 45351.538, "synch_weights_time_ms": 10.602}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5209, "training_iteration": 76, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-13", "timestamp": 1698245593, "time_this_iter_s": 4.355027198791504, "time_total_s": 281.9484624862671, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 281.9484624862671, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 88.63333333333333, "ram_util_percent": 28.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.438692428447582, "policy_loss": -0.0005983205305205451, "vf_loss": 6.439338277887415, "vf_explained_var": -8.013513353135851e-07, "kl": 0.001192014610660829, "entropy": 0.4752345990251612, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2066.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.346999999999845, "episode_len_mean": 232.2, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 35.900000000000034, 18.699999999999825, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 36.30000000000003, 43.50000000000001, 40.10000000000002, 43.7, 44.900000000000006, 24.499999999999908, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, 46.099999999999994, 24.099999999999902, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, 39.70000000000002, 45.1, 37.70000000000003, 42.30000000000001, 44.7, -50.00000000000044, 28.699999999999967, 45.5, 45.7, 6.8999999999996575, 9.499999999999694, 47.7, 32.90000000000003, 44.300000000000004, 44.5, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 41.70000000000002, 45.1, -50.00000000000044, 42.500000000000014, 26.69999999999994, 45.3, 45.9, -50.00000000000044, 45.5, 46.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.3, 25.699999999999925, 26.499999999999936, 38.50000000000003], "episode_lengths": [46, 142, 314, 500, 66, 500, 74, 500, 36, 138, 66, 100, 64, 52, 256, 500, 148, 500, 500, 34, 50, 34, 88, 500, 500, 500, 32, 46, 40, 260, 500, 40, 500, 50, 142, 500, 500, 74, 36, 500, 500, 500, 500, 54, 92, 104, 50, 124, 78, 54, 500, 214, 46, 44, 432, 406, 24, 172, 58, 56, 56, 62, 500, 500, 50, 84, 50, 500, 76, 234, 48, 42, 500, 46, 32, 84, 500, 500, 122, 34, 500, 74, 500, 216, 500, 500, 46, 34, 500, 500, 500, 70, 500, 44, 500, 156, 28, 244, 236, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4415209282750241, "mean_inference_ms": 1.4050495722268743, "mean_action_processing_ms": 0.1653696155702834, "mean_env_wait_ms": 0.0975865612746843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027995824813842773, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.18699193000793457}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.346999999999845, "episode_len_mean": 232.2, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 35.900000000000034, 18.699999999999825, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, 36.30000000000003, 43.50000000000001, 40.10000000000002, 43.7, 44.900000000000006, 24.499999999999908, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.1, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.5, 46.099999999999994, 24.099999999999902, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 40.90000000000002, 39.70000000000002, 45.1, 37.70000000000003, 42.30000000000001, 44.7, -50.00000000000044, 28.699999999999967, 45.5, 45.7, 6.8999999999996575, 9.499999999999694, 47.7, 32.90000000000003, 44.300000000000004, 44.5, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, 41.70000000000002, 45.1, -50.00000000000044, 42.500000000000014, 26.69999999999994, 45.3, 45.9, -50.00000000000044, 45.5, 46.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.3, 25.699999999999925, 26.499999999999936, 38.50000000000003], "episode_lengths": [46, 142, 314, 500, 66, 500, 74, 500, 36, 138, 66, 100, 64, 52, 256, 500, 148, 500, 500, 34, 50, 34, 88, 500, 500, 500, 32, 46, 40, 260, 500, 40, 500, 50, 142, 500, 500, 74, 36, 500, 500, 500, 500, 54, 92, 104, 50, 124, 78, 54, 500, 214, 46, 44, 432, 406, 24, 172, 58, 56, 56, 62, 500, 500, 50, 84, 50, 500, 76, 234, 48, 42, 500, 46, 32, 84, 500, 500, 122, 34, 500, 74, 500, 216, 500, 500, 46, 34, 500, 500, 500, 70, 500, 44, 500, 156, 28, 244, 236, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4415209282750241, "mean_inference_ms": 1.4050495722268743, "mean_action_processing_ms": 0.1653696155702834, "mean_env_wait_ms": 0.0975865612746843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027995824813842773, "StateBufferConnector_ms": 0.007999181747436523, "ViewRequirementAgentConnector_ms": 0.18699193000793457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3929.250717281413, "num_env_steps_trained_throughput_per_sec": 3929.250717281413, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 4614.005, "sample_time_ms": 4182.304, "load_time_ms": 25.7, "load_throughput": 700388.538, "learn_time_ms": 394.3, "learn_throughput": 45650.541, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5279, "training_iteration": 77, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-17", "timestamp": 1698245597, "time_this_iter_s": 4.587024927139282, "time_total_s": 286.5354874134064, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 286.5354874134064, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 90.46666666666665, "ram_util_percent": 28.149999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.3847363966482655, "policy_loss": -0.0001897303111575268, "vf_loss": 6.384974762245461, "vf_explained_var": -7.4395426997432e-07, "kl": 0.0004814051940755875, "entropy": 0.4866596504493996, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2093.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7309999999998054, "episode_len_mean": 268.28, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 42.500000000000014, 26.69999999999994, 45.3, 45.9, -50.00000000000044, 45.5, 46.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.3, 25.699999999999925, 26.499999999999936, 38.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, 37.300000000000026, 8.099999999999675, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.9, 45.5, 37.90000000000003, -50.00000000000044, 43.50000000000001, 46.5, 40.70000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, 44.7, 43.10000000000001, 45.5, 44.300000000000004, -50.00000000000044, 4.099999999999618, -50.00000000000044, 36.900000000000034, 34.70000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, 4.699999999999626, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 42.70000000000001, 47.1, -50.00000000000044, 45.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 2.8999999999996007], "episode_lengths": [50, 500, 76, 234, 48, 42, 500, 46, 32, 84, 500, 500, 122, 34, 500, 74, 500, 216, 500, 500, 46, 34, 500, 500, 500, 70, 500, 44, 500, 156, 28, 244, 236, 116, 500, 32, 500, 128, 420, 120, 500, 500, 46, 40, 500, 42, 46, 122, 500, 66, 36, 94, 40, 62, 500, 54, 70, 46, 58, 500, 460, 500, 132, 154, 500, 58, 500, 54, 454, 500, 500, 70, 500, 500, 500, 500, 500, 176, 46, 500, 500, 60, 68, 74, 30, 500, 42, 198, 500, 500, 500, 500, 500, 36, 38, 500, 82, 500, 70, 472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4415490081684919, "mean_inference_ms": 1.4048660266167792, "mean_action_processing_ms": 0.16504457378260035, "mean_env_wait_ms": 0.09713857160925325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029998779296875, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.15699148178100586}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7309999999998054, "episode_len_mean": 268.28, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 42.500000000000014, 26.69999999999994, 45.3, 45.9, -50.00000000000044, 45.5, 46.9, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, 46.699999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 34.50000000000004, 47.3, 25.699999999999925, 26.499999999999936, 38.50000000000003, -50.00000000000044, 46.9, -50.00000000000044, 37.300000000000026, 8.099999999999675, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, -50.00000000000044, 45.9, 45.5, 37.90000000000003, -50.00000000000044, 43.50000000000001, 46.5, 40.70000000000002, 46.099999999999994, 43.900000000000006, -50.00000000000044, 44.7, 43.10000000000001, 45.5, 44.300000000000004, -50.00000000000044, 4.099999999999618, -50.00000000000044, 36.900000000000034, 34.70000000000004, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, 4.699999999999626, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 42.70000000000001, 47.1, -50.00000000000044, 45.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 2.8999999999996007], "episode_lengths": [50, 500, 76, 234, 48, 42, 500, 46, 32, 84, 500, 500, 122, 34, 500, 74, 500, 216, 500, 500, 46, 34, 500, 500, 500, 70, 500, 44, 500, 156, 28, 244, 236, 116, 500, 32, 500, 128, 420, 120, 500, 500, 46, 40, 500, 42, 46, 122, 500, 66, 36, 94, 40, 62, 500, 54, 70, 46, 58, 500, 460, 500, 132, 154, 500, 58, 500, 54, 454, 500, 500, 70, 500, 500, 500, 500, 500, 176, 46, 500, 500, 60, 68, 74, 30, 500, 42, 198, 500, 500, 500, 500, 500, 36, 38, 500, 82, 500, 70, 472]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4415490081684919, "mean_inference_ms": 1.4048660266167792, "mean_action_processing_ms": 0.16504457378260035, "mean_env_wait_ms": 0.09713857160925325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029998779296875, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.15699148178100586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5678.233301824977, "num_env_steps_trained_throughput_per_sec": 5678.233301824977, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 4545.205, "sample_time_ms": 4118.204, "load_time_ms": 24.9, "load_throughput": 722887.203, "learn_time_ms": 390.403, "learn_throughput": 46106.222, "synch_weights_time_ms": 10.299}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5345, "training_iteration": 78, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-20", "timestamp": 1698245600, "time_this_iter_s": 3.1750001907348633, "time_total_s": 289.71048760414124, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 289.71048760414124, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.42, "ram_util_percent": 27.619999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.548943042755127, "policy_loss": -0.0005674284917336923, "vf_loss": 6.549554983774821, "vf_explained_var": -1.2229990076135706e-06, "kl": 0.000740844935686861, "entropy": 0.44459659413055136, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2120.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.0690000000002255, "episode_len_mean": 296.22, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 4.699999999999626, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 42.70000000000001, 47.1, -50.00000000000044, 45.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 2.8999999999996007, -50.00000000000044, 6.8999999999996575, 45.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 21.299999999999862, 42.900000000000006, 45.5, 33.90000000000004, 1.4999999999995808, 45.9, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, 45.7, 42.500000000000014, 43.10000000000001, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, 39.70000000000002, 46.5, 45.5, 45.3, 41.90000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.1, -50.00000000000044, 29.69999999999998, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.50000000000002, 45.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 54, 454, 500, 500, 70, 500, 500, 500, 500, 500, 176, 46, 500, 500, 60, 68, 74, 30, 500, 42, 198, 500, 500, 500, 500, 500, 36, 38, 500, 82, 500, 70, 472, 500, 432, 48, 32, 500, 500, 500, 500, 54, 44, 288, 72, 46, 162, 486, 42, 500, 500, 80, 500, 54, 44, 76, 70, 500, 500, 500, 500, 500, 144, 500, 500, 176, 500, 104, 36, 46, 48, 82, 72, 62, 500, 500, 94, 50, 500, 204, 500, 46, 500, 88, 500, 58, 500, 70, 500, 500, 54, 500, 106, 44, 38, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4403971348870157, "mean_inference_ms": 1.402389614172488, "mean_action_processing_ms": 0.16478120471936486, "mean_env_wait_ms": 0.09710946779809328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018999099731445312, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.13401484489440918}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.0690000000002255, "episode_len_mean": 296.22, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 4.699999999999626, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 45.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 42.70000000000001, 47.1, -50.00000000000044, 45.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 2.8999999999996007, -50.00000000000044, 6.8999999999996575, 45.3, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 21.299999999999862, 42.900000000000006, 45.5, 33.90000000000004, 1.4999999999995808, 45.9, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, 45.7, 42.500000000000014, 43.10000000000001, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, 39.70000000000002, 46.5, 45.5, 45.3, 41.90000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.1, -50.00000000000044, 29.69999999999998, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.50000000000002, 45.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 54, 454, 500, 500, 70, 500, 500, 500, 500, 500, 176, 46, 500, 500, 60, 68, 74, 30, 500, 42, 198, 500, 500, 500, 500, 500, 36, 38, 500, 82, 500, 70, 472, 500, 432, 48, 32, 500, 500, 500, 500, 54, 44, 288, 72, 46, 162, 486, 42, 500, 500, 80, 500, 54, 44, 76, 70, 500, 500, 500, 500, 500, 144, 500, 500, 176, 500, 104, 36, 46, 48, 82, 72, 62, 500, 500, 94, 50, 500, 204, 500, 46, 500, 88, 500, 58, 500, 70, 500, 500, 54, 500, 106, 44, 38, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4403971348870157, "mean_inference_ms": 1.402389614172488, "mean_action_processing_ms": 0.16478120471936486, "mean_env_wait_ms": 0.09710946779809328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018999099731445312, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.13401484489440918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5424.953104919591, "num_env_steps_trained_throughput_per_sec": 5424.953104919591, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 4397.205, "sample_time_ms": 3976.704, "load_time_ms": 24.8, "load_throughput": 725801.841, "learn_time_ms": 384.103, "learn_throughput": 46862.449, "synch_weights_time_ms": 10.099}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5411, "training_iteration": 79, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-24", "timestamp": 1698245604, "time_this_iter_s": 3.3229994773864746, "time_total_s": 293.0334870815277, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 293.0334870815277, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 68.95, "ram_util_percent": 27.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.551343105457447, "policy_loss": 6.541818449342693e-05, "vf_loss": 6.551324544129549, "vf_explained_var": -1.1611867834020544e-06, "kl": 9.370126947403521e-05, "entropy": 0.4692911571926541, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2147.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.963999999999814, "episode_len_mean": 260.96, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 46.5, 45.5, 45.3, 41.90000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.1, -50.00000000000044, 29.69999999999998, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.50000000000002, 45.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, 46.3, -50.00000000000044, 42.500000000000014, 45.1, 39.300000000000026, 39.90000000000002, 45.5, -50.00000000000044, 29.69999999999998, -50.00000000000044, 26.299999999999933, 25.699999999999925, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.7, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 42.70000000000001, 46.5, 43.30000000000001, 26.69999999999994, 40.70000000000002, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 29.899999999999984, 46.699999999999996, -50.00000000000044, 47.1, 45.9, 34.900000000000034, 19.899999999999842, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, 6.099999999999646, 5.899999999999643, 33.70000000000004, 45.1, 45.7], "episode_lengths": [500, 104, 36, 46, 48, 82, 72, 62, 500, 500, 94, 50, 500, 204, 500, 46, 500, 88, 500, 58, 500, 70, 500, 500, 54, 500, 106, 44, 38, 500, 500, 500, 500, 500, 500, 500, 500, 60, 30, 38, 500, 76, 50, 108, 102, 46, 500, 204, 500, 238, 244, 36, 500, 500, 500, 42, 500, 64, 44, 76, 500, 500, 80, 28, 500, 74, 36, 68, 234, 94, 500, 172, 58, 500, 500, 34, 500, 42, 202, 34, 500, 30, 42, 152, 302, 500, 500, 78, 50, 500, 500, 322, 64, 500, 500, 440, 442, 164, 50, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43969891638616004, "mean_inference_ms": 1.4002606795061843, "mean_action_processing_ms": 0.16459683311093837, "mean_env_wait_ms": 0.09716936471334847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001100540161133, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.12801861763000488}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.963999999999814, "episode_len_mean": 260.96, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.70000000000002, 46.5, 45.5, 45.3, 41.90000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.1, -50.00000000000044, 29.69999999999998, -50.00000000000044, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.50000000000002, 45.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, 46.3, -50.00000000000044, 42.500000000000014, 45.1, 39.300000000000026, 39.90000000000002, 45.5, -50.00000000000044, 29.69999999999998, -50.00000000000044, 26.299999999999933, 25.699999999999925, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 43.7, 45.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 42.70000000000001, 46.5, 43.30000000000001, 26.69999999999994, 40.70000000000002, -50.00000000000044, 32.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 29.899999999999984, 46.699999999999996, -50.00000000000044, 47.1, 45.9, 34.900000000000034, 19.899999999999842, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, 6.099999999999646, 5.899999999999643, 33.70000000000004, 45.1, 45.7], "episode_lengths": [500, 104, 36, 46, 48, 82, 72, 62, 500, 500, 94, 50, 500, 204, 500, 46, 500, 88, 500, 58, 500, 70, 500, 500, 54, 500, 106, 44, 38, 500, 500, 500, 500, 500, 500, 500, 500, 60, 30, 38, 500, 76, 50, 108, 102, 46, 500, 204, 500, 238, 244, 36, 500, 500, 500, 42, 500, 64, 44, 76, 500, 500, 80, 28, 500, 74, 36, 68, 234, 94, 500, 172, 58, 500, 500, 34, 500, 42, 202, 34, 500, 30, 42, 152, 302, 500, 500, 78, 50, 500, 500, 322, 64, 500, 500, 440, 442, 164, 50, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43969891638616004, "mean_inference_ms": 1.4002606795061843, "mean_action_processing_ms": 0.16459683311093837, "mean_env_wait_ms": 0.09716936471334847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001100540161133, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.12801861763000488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5528.250194575295, "num_env_steps_trained_throughput_per_sec": 5528.250194575295, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 4243.206, "sample_time_ms": 3834.204, "load_time_ms": 22.8, "load_throughput": 789471.465, "learn_time_ms": 374.303, "learn_throughput": 48089.406, "synch_weights_time_ms": 10.299}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5478, "training_iteration": 80, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-27", "timestamp": 1698245607, "time_this_iter_s": 3.261000871658325, "time_total_s": 296.29448795318604, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 296.29448795318604, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 59.220000000000006, "ram_util_percent": 27.740000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.999182206613046, "policy_loss": -0.00015268392033047147, "vf_loss": 6.999380023391159, "vf_explained_var": -9.051075688114873e-07, "kl": 0.0003787787834426126, "entropy": 0.4526892160927808, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2174.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.277999999999839, "episode_len_mean": 237.9, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.899999999999842, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, 6.099999999999646, 5.899999999999643, 33.70000000000004, 45.1, 45.7, -50.00000000000044, 45.9, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.90000000000004, 46.699999999999996, -50.00000000000044, 39.50000000000002, 38.700000000000024, 47.3, 44.5, 12.499999999999737, -50.00000000000044, 41.100000000000016, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 35.30000000000004, 46.5, 37.300000000000026, 7.499999999999666, 45.5, 46.699999999999996, 46.9, 21.299999999999862, 35.30000000000004, 44.10000000000001, 20.299999999999848, 44.10000000000001, 44.900000000000006, 22.699999999999882, 47.1, 34.900000000000034, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 44.900000000000006, 41.70000000000002, 47.5, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 46.5, 45.5, 41.500000000000014, 33.90000000000004, 41.100000000000016, -50.00000000000044, 20.699999999999854, 46.5, 46.099999999999994, 44.900000000000006], "episode_lengths": [302, 500, 500, 78, 50, 500, 500, 322, 64, 500, 500, 440, 442, 164, 50, 44, 500, 42, 34, 500, 40, 500, 162, 34, 500, 106, 114, 28, 56, 376, 500, 90, 82, 500, 500, 500, 24, 148, 36, 128, 426, 46, 34, 32, 288, 148, 60, 298, 60, 52, 274, 30, 152, 52, 500, 38, 500, 38, 34, 500, 48, 72, 500, 52, 84, 26, 170, 500, 500, 500, 54, 38, 500, 500, 386, 500, 500, 74, 500, 36, 500, 132, 500, 104, 60, 500, 500, 52, 500, 42, 36, 46, 86, 162, 90, 500, 294, 36, 40, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.439839063322822, "mean_inference_ms": 1.3982381946571116, "mean_action_processing_ms": 0.1645736409310776, "mean_env_wait_ms": 0.09700946607545441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034000396728515625, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.12199258804321289}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.277999999999839, "episode_len_mean": 237.9, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.899999999999842, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, 6.099999999999646, 5.899999999999643, 33.70000000000004, 45.1, 45.7, -50.00000000000044, 45.9, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.90000000000004, 46.699999999999996, -50.00000000000044, 39.50000000000002, 38.700000000000024, 47.3, 44.5, 12.499999999999737, -50.00000000000044, 41.100000000000016, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 35.30000000000004, 46.5, 37.300000000000026, 7.499999999999666, 45.5, 46.699999999999996, 46.9, 21.299999999999862, 35.30000000000004, 44.10000000000001, 20.299999999999848, 44.10000000000001, 44.900000000000006, 22.699999999999882, 47.1, 34.900000000000034, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 44.900000000000006, 41.70000000000002, 47.5, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 46.5, 45.5, 41.500000000000014, 33.90000000000004, 41.100000000000016, -50.00000000000044, 20.699999999999854, 46.5, 46.099999999999994, 44.900000000000006], "episode_lengths": [302, 500, 500, 78, 50, 500, 500, 322, 64, 500, 500, 440, 442, 164, 50, 44, 500, 42, 34, 500, 40, 500, 162, 34, 500, 106, 114, 28, 56, 376, 500, 90, 82, 500, 500, 500, 24, 148, 36, 128, 426, 46, 34, 32, 288, 148, 60, 298, 60, 52, 274, 30, 152, 52, 500, 38, 500, 38, 34, 500, 48, 72, 500, 52, 84, 26, 170, 500, 500, 500, 54, 38, 500, 500, 386, 500, 500, 74, 500, 36, 500, 132, 500, 104, 60, 500, 500, 52, 500, 42, 36, 46, 86, 162, 90, 500, 294, 36, 40, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.439839063322822, "mean_inference_ms": 1.3982381946571116, "mean_action_processing_ms": 0.1645736409310776, "mean_env_wait_ms": 0.09700946607545441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034000396728515625, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.12199258804321289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5428.169042438918, "num_env_steps_trained_throughput_per_sec": 5428.169042438918, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 4080.509, "sample_time_ms": 3680.908, "load_time_ms": 22.2, "load_throughput": 810814.719, "learn_time_ms": 365.803, "learn_throughput": 49206.819, "synch_weights_time_ms": 9.999}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5562, "training_iteration": 81, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-30", "timestamp": 1698245610, "time_this_iter_s": 3.3210346698760986, "time_total_s": 299.61552262306213, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 299.61552262306213, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 58.160000000000004, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.339822557237413, "policy_loss": -0.0002224657822538305, "vf_loss": 6.340085841991283, "vf_explained_var": -8.388801857277199e-07, "kl": 0.0006351143507004053, "entropy": 0.40805581653559647, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2201.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.51899999999983, "episode_len_mean": 240.44, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 46.5, 45.5, 41.500000000000014, 33.90000000000004, 41.100000000000016, -50.00000000000044, 20.699999999999854, 46.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 46.9, 46.3, 46.099999999999994, 48.1, -50.00000000000044, 25.099999999999916, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.7, 46.5, 44.900000000000006, -50.00000000000044, 46.9, 45.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 28.89999999999997, 45.1, 1.4999999999995808, -50.00000000000044, 42.900000000000006, 46.699999999999996, -50.00000000000044, 46.699999999999996, 42.30000000000001, 47.3, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, 46.699999999999996, 47.3, -50.00000000000044, 43.7, 39.70000000000002, 47.1, 38.50000000000003, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 33.500000000000036, 45.3, 45.1, 46.3, -50.00000000000044, 26.69999999999994, 39.300000000000026, -50.00000000000044, 24.499999999999908, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 386, 500, 500, 74, 500, 36, 500, 132, 500, 104, 60, 500, 500, 52, 500, 42, 36, 46, 86, 162, 90, 500, 294, 36, 40, 52, 500, 500, 90, 54, 32, 38, 40, 20, 500, 250, 76, 500, 500, 500, 500, 500, 500, 500, 500, 34, 76, 44, 36, 52, 500, 32, 48, 500, 96, 500, 500, 44, 68, 212, 50, 486, 500, 72, 34, 500, 34, 78, 28, 500, 54, 500, 40, 34, 28, 500, 64, 104, 30, 116, 68, 56, 500, 500, 32, 112, 166, 48, 50, 38, 500, 234, 108, 500, 256, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4387519962747815, "mean_inference_ms": 1.3955128992747314, "mean_action_processing_ms": 0.16396582455151948, "mean_env_wait_ms": 0.09710518339372454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034996986389160156, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.13697099685668945}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.51899999999983, "episode_len_mean": 240.44, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.5, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 46.5, 45.5, 41.500000000000014, 33.90000000000004, 41.100000000000016, -50.00000000000044, 20.699999999999854, 46.5, 46.099999999999994, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 46.9, 46.3, 46.099999999999994, 48.1, -50.00000000000044, 25.099999999999916, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.7, 46.5, 44.900000000000006, -50.00000000000044, 46.9, 45.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 28.89999999999997, 45.1, 1.4999999999995808, -50.00000000000044, 42.900000000000006, 46.699999999999996, -50.00000000000044, 46.699999999999996, 42.30000000000001, 47.3, -50.00000000000044, 44.7, -50.00000000000044, 46.099999999999994, 46.699999999999996, 47.3, -50.00000000000044, 43.7, 39.70000000000002, 47.1, 38.50000000000003, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 33.500000000000036, 45.3, 45.1, 46.3, -50.00000000000044, 26.69999999999994, 39.300000000000026, -50.00000000000044, 24.499999999999908, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 386, 500, 500, 74, 500, 36, 500, 132, 500, 104, 60, 500, 500, 52, 500, 42, 36, 46, 86, 162, 90, 500, 294, 36, 40, 52, 500, 500, 90, 54, 32, 38, 40, 20, 500, 250, 76, 500, 500, 500, 500, 500, 500, 500, 500, 34, 76, 44, 36, 52, 500, 32, 48, 500, 96, 500, 500, 44, 68, 212, 50, 486, 500, 72, 34, 500, 34, 78, 28, 500, 54, 500, 40, 34, 28, 500, 64, 104, 30, 116, 68, 56, 500, 500, 32, 112, 166, 48, 50, 38, 500, 234, 108, 500, 256, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4387519962747815, "mean_inference_ms": 1.3955128992747314, "mean_action_processing_ms": 0.16396582455151948, "mean_env_wait_ms": 0.09710518339372454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034996986389160156, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.13697099685668945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5655.04098618828, "num_env_steps_trained_throughput_per_sec": 5655.04098618828, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3898.61, "sample_time_ms": 3509.608, "load_time_ms": 20.8, "load_throughput": 865385.837, "learn_time_ms": 356.903, "learn_throughput": 50433.84, "synch_weights_time_ms": 9.798}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5634, "training_iteration": 82, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-34", "timestamp": 1698245614, "time_this_iter_s": 3.188000202178955, "time_total_s": 302.8035228252411, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 302.8035228252411, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 69.82499999999999, "ram_util_percent": 27.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.290834780092593, "policy_loss": -1.7096598943074543e-05, "vf_loss": 6.290893484044958, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0001325672920479014, "entropy": 0.4156554838021596, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2228.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.459999999999835, "episode_len_mean": 236.02, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 46.099999999999994, 46.699999999999996, 47.3, -50.00000000000044, 43.7, 39.70000000000002, 47.1, 38.50000000000003, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 33.500000000000036, 45.3, 45.1, 46.3, -50.00000000000044, 26.69999999999994, 39.300000000000026, -50.00000000000044, 24.499999999999908, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 36.900000000000034, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 45.7, 47.1, 34.50000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 36.70000000000003, 38.50000000000003, -50.00000000000044, 40.500000000000014, 47.7, 45.1, 46.3, -50.00000000000044, 46.3, 38.90000000000002, 47.5, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.9, 45.9, 37.300000000000026, -50.00000000000044, 44.5, 47.7, 43.50000000000001, 32.100000000000016, 46.699999999999996, 46.9, 32.100000000000016, -50.00000000000044, 46.699999999999996, 46.5], "episode_lengths": [54, 500, 40, 34, 28, 500, 64, 104, 30, 116, 68, 56, 500, 500, 32, 112, 166, 48, 50, 38, 500, 234, 108, 500, 256, 54, 500, 500, 500, 72, 132, 38, 500, 500, 58, 36, 500, 44, 30, 156, 112, 500, 500, 500, 34, 500, 500, 500, 500, 500, 68, 500, 44, 500, 36, 500, 500, 52, 88, 500, 48, 500, 46, 500, 500, 500, 500, 32, 134, 116, 500, 96, 24, 50, 38, 500, 38, 112, 26, 218, 500, 500, 500, 32, 56, 500, 32, 42, 128, 500, 56, 24, 66, 180, 34, 32, 180, 500, 34, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4380270320367277, "mean_inference_ms": 1.3936816938288852, "mean_action_processing_ms": 0.16362502625913816, "mean_env_wait_ms": 0.0968610476576674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.12291097640991211}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.459999999999835, "episode_len_mean": 236.02, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 46.099999999999994, 46.699999999999996, 47.3, -50.00000000000044, 43.7, 39.70000000000002, 47.1, 38.50000000000003, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 38.90000000000002, 33.500000000000036, 45.3, 45.1, 46.3, -50.00000000000044, 26.69999999999994, 39.300000000000026, -50.00000000000044, 24.499999999999908, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 36.900000000000034, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 45.7, 47.1, 34.50000000000004, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 36.70000000000003, 38.50000000000003, -50.00000000000044, 40.500000000000014, 47.7, 45.1, 46.3, -50.00000000000044, 46.3, 38.90000000000002, 47.5, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.9, 45.9, 37.300000000000026, -50.00000000000044, 44.5, 47.7, 43.50000000000001, 32.100000000000016, 46.699999999999996, 46.9, 32.100000000000016, -50.00000000000044, 46.699999999999996, 46.5], "episode_lengths": [54, 500, 40, 34, 28, 500, 64, 104, 30, 116, 68, 56, 500, 500, 32, 112, 166, 48, 50, 38, 500, 234, 108, 500, 256, 54, 500, 500, 500, 72, 132, 38, 500, 500, 58, 36, 500, 44, 30, 156, 112, 500, 500, 500, 34, 500, 500, 500, 500, 500, 68, 500, 44, 500, 36, 500, 500, 52, 88, 500, 48, 500, 46, 500, 500, 500, 500, 32, 134, 116, 500, 96, 24, 50, 38, 500, 38, 112, 26, 218, 500, 500, 500, 32, 56, 500, 32, 42, 128, 500, 56, 24, 66, 180, 34, 32, 180, 500, 34, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4380270320367277, "mean_inference_ms": 1.3936816938288852, "mean_action_processing_ms": 0.16362502625913816, "mean_env_wait_ms": 0.0968610476576674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.12291097640991211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5265.79902457397, "num_env_steps_trained_throughput_per_sec": 5265.79902457397, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3764.038, "sample_time_ms": 3364.614, "load_time_ms": 19.9, "load_throughput": 904522.067, "learn_time_ms": 368.375, "learn_throughput": 48863.208, "synch_weights_time_ms": 9.549}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5706, "training_iteration": 83, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-37", "timestamp": 1698245617, "time_this_iter_s": 3.423471689224243, "time_total_s": 306.22699451446533, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 306.22699451446533, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 58.2, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.529948464146367, "policy_loss": -0.00023617250499901948, "vf_loss": 6.530224076023808, "vf_explained_var": -1.0287320172345197e-06, "kl": 0.0005102559222644197, "entropy": 0.39315531651179, "entropy_coeff": 9.999999999999999e-05}, "model": {}, "num_grad_updates_lifetime": 2255.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.22399999999983, "episode_len_mean": 238.4, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 36.70000000000003, 38.50000000000003, -50.00000000000044, 40.500000000000014, 47.7, 45.1, 46.3, -50.00000000000044, 46.3, 38.90000000000002, 47.5, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.9, 45.9, 37.300000000000026, -50.00000000000044, 44.5, 47.7, 43.50000000000001, 32.100000000000016, 46.699999999999996, 46.9, 32.100000000000016, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, 46.699999999999996, 41.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 10.899999999999714, -50.00000000000044, 7.299999999999663, 20.299999999999848, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.3, 46.099999999999994, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, 42.500000000000014, 31.70000000000001, -50.00000000000044, 41.30000000000001, 43.900000000000006, 46.699999999999996, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.3, 13.099999999999746, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, 47.9, 43.900000000000006, -50.00000000000044, 46.5, 46.5, 33.30000000000003, 0.6999999999995694, -50.00000000000044, 46.5, -50.00000000000044], "episode_lengths": [32, 134, 116, 500, 96, 24, 50, 38, 500, 38, 112, 26, 218, 500, 500, 500, 32, 56, 500, 32, 42, 128, 500, 56, 24, 66, 180, 34, 32, 180, 500, 34, 36, 500, 34, 86, 30, 500, 500, 500, 46, 74, 392, 500, 428, 298, 42, 500, 60, 500, 500, 100, 500, 56, 500, 28, 40, 32, 500, 62, 500, 500, 500, 500, 500, 32, 26, 76, 184, 500, 88, 62, 34, 36, 42, 500, 500, 96, 500, 46, 500, 500, 500, 150, 38, 370, 500, 34, 500, 48, 22, 62, 500, 36, 36, 168, 494, 500, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43702942474603745, "mean_inference_ms": 1.3924376458059198, "mean_action_processing_ms": 0.16374040782199573, "mean_env_wait_ms": 0.09674410400131213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024530649185180664, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.1429452896118164}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.22399999999983, "episode_len_mean": 238.4, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 36.70000000000003, 38.50000000000003, -50.00000000000044, 40.500000000000014, 47.7, 45.1, 46.3, -50.00000000000044, 46.3, 38.90000000000002, 47.5, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.9, 45.9, 37.300000000000026, -50.00000000000044, 44.5, 47.7, 43.50000000000001, 32.100000000000016, 46.699999999999996, 46.9, 32.100000000000016, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, 46.699999999999996, 41.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.70000000000001, 10.899999999999714, -50.00000000000044, 7.299999999999663, 20.299999999999848, 45.9, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.3, 46.099999999999994, 46.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, 42.500000000000014, 31.70000000000001, -50.00000000000044, 41.30000000000001, 43.900000000000006, 46.699999999999996, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 46.3, 13.099999999999746, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, 47.9, 43.900000000000006, -50.00000000000044, 46.5, 46.5, 33.30000000000003, 0.6999999999995694, -50.00000000000044, 46.5, -50.00000000000044], "episode_lengths": [32, 134, 116, 500, 96, 24, 50, 38, 500, 38, 112, 26, 218, 500, 500, 500, 32, 56, 500, 32, 42, 128, 500, 56, 24, 66, 180, 34, 32, 180, 500, 34, 36, 500, 34, 86, 30, 500, 500, 500, 46, 74, 392, 500, 428, 298, 42, 500, 60, 500, 500, 100, 500, 56, 500, 28, 40, 32, 500, 62, 500, 500, 500, 500, 500, 32, 26, 76, 184, 500, 88, 62, 34, 36, 42, 500, 500, 96, 500, 46, 500, 500, 500, 150, 38, 370, 500, 34, 500, 48, 22, 62, 500, 36, 36, 168, 494, 500, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43702942474603745, "mean_inference_ms": 1.3924376458059198, "mean_action_processing_ms": 0.16374040782199573, "mean_env_wait_ms": 0.09674410400131213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024530649185180664, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.1429452896118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5706.908319114089, "num_env_steps_trained_throughput_per_sec": 5706.908319114089, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3641.645, "sample_time_ms": 3258.869, "load_time_ms": 17.9, "load_throughput": 1005585.81, "learn_time_ms": 353.765, "learn_throughput": 50881.23, "synch_weights_time_ms": 9.511}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5773, "training_iteration": 84, "trial_id": "9f288_00004", "date": "2023-10-25_15-53-40", "timestamp": 1698245620, "time_this_iter_s": 3.1590707302093506, "time_total_s": 309.3860652446747, "pid": 26372, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 309.3860652446747, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 67.5, "ram_util_percent": 27.8}}
