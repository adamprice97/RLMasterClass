{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.250973796844482, "policy_loss": -0.01198083758354187, "vf_loss": 9.262382173538208, "vf_explained_var": 1.6421079635620118e-06, "kl": 0.0032132910864594577, "entropy": 0.702463549375534, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 10.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 40.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.418918918919257, "episode_len_mean": 424.3783783783784, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.500000000000014, 5.299999999999635, 19.09999999999983, 26.89999999999994, 34.70000000000004, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 1.6999999999995836, 6.099999999999646, 16.499999999999794, 5.299999999999635, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 414, 368, 500, 500, 500, 464, 96, 448, 310, 232, 154, 500, 466, 500, 500, 452, 500, 484, 440, 336, 448, 500, 286, 500, 500, 500, 500, 500, 500, 134, 170, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5685860726423666, "mean_inference_ms": 1.8502613803407364, "mean_action_processing_ms": 0.21949934341653482, "mean_env_wait_ms": 0.1327177367091988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043196291536898225, "StateBufferConnector_ms": 0.008116541682062921, "ViewRequirementAgentConnector_ms": 0.19235804274275498}}, "episode_reward_max": 40.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -19.418918918919257, "episode_len_mean": 424.3783783783784, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.500000000000014, 5.299999999999635, 19.09999999999983, 26.89999999999994, 34.70000000000004, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 1.6999999999995836, 6.099999999999646, 16.499999999999794, 5.299999999999635, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 414, 368, 500, 500, 500, 464, 96, 448, 310, 232, 154, 500, 466, 500, 500, 452, 500, 484, 440, 336, 448, 500, 286, 500, 500, 500, 500, 500, 500, 134, 170, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5685860726423666, "mean_inference_ms": 1.8502613803407364, "mean_action_processing_ms": 0.21949934341653482, "mean_env_wait_ms": 0.1327177367091988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043196291536898225, "StateBufferConnector_ms": 0.008116541682062921, "ViewRequirementAgentConnector_ms": 0.19235804274275498}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3954.2256086424773, "num_env_steps_trained_throughput_per_sec": 3954.2256086424773, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 4552.092, "sample_time_ms": 4300.19, "load_time_ms": 16.799, "load_throughput": 1071478.861, "learn_time_ms": 217.324, "learn_throughput": 82825.727, "synch_weights_time_ms": 15.778}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 37, "training_iteration": 1, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-01", "timestamp": 1698246301, "time_this_iter_s": 4.5580902099609375, "time_total_s": 4.5580902099609375, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.5580902099609375, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 87.48571428571428, "ram_util_percent": 30.75714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.058896493911742, "policy_loss": 0.017757802829146387, "vf_loss": 9.04092960357666, "vf_explained_var": -3.714561462402344e-05, "kl": 0.0027936773225064825, "entropy": 0.6997533470392228, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 30.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 40.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -16.997590361446107, "episode_len_mean": 411.421686746988, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.500000000000014, 5.299999999999635, 19.09999999999983, 26.89999999999994, 34.70000000000004, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 1.6999999999995836, 6.099999999999646, 16.499999999999794, 5.299999999999635, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 25.499999999999922, -50.00000000000044, 11.29999999999972, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 36.900000000000034, 14.699999999999768, 15.899999999999785, 15.099999999999774, 15.49999999999978, 19.899999999999842, 8.099999999999675, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 35.900000000000034, -50.00000000000044, -50.00000000000044, 11.899999999999729, 33.90000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, 30.099999999999987, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, 2.299999999999592], "episode_lengths": [500, 500, 500, 500, 414, 368, 500, 500, 500, 464, 96, 448, 310, 232, 154, 500, 466, 500, 500, 452, 500, 484, 440, 336, 448, 500, 286, 500, 500, 500, 500, 500, 500, 134, 170, 500, 500, 500, 252, 246, 500, 388, 156, 500, 500, 500, 500, 500, 500, 316, 500, 500, 132, 354, 342, 350, 346, 302, 420, 500, 500, 478, 500, 500, 494, 142, 500, 500, 382, 162, 500, 500, 136, 200, 486, 500, 500, 500, 500, 500, 144, 240, 478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5461662995220659, "mean_inference_ms": 1.767229113471746, "mean_action_processing_ms": 0.2087256199764237, "mean_env_wait_ms": 0.1264336048392018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048164861748017464, "StateBufferConnector_ms": 0.0072387327630835845, "ViewRequirementAgentConnector_ms": 0.1628272504691618}}, "episode_reward_max": 40.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -16.997590361446107, "episode_len_mean": 411.421686746988, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.699999999999683, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.699999999999612, 40.500000000000014, 5.299999999999635, 19.09999999999983, 26.89999999999994, 34.70000000000004, -50.00000000000044, 3.499999999999609, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 1.6999999999995836, 6.099999999999646, 16.499999999999794, 5.299999999999635, -50.00000000000044, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 25.499999999999922, -50.00000000000044, 11.29999999999972, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 36.900000000000034, 14.699999999999768, 15.899999999999785, 15.099999999999774, 15.49999999999978, 19.899999999999842, 8.099999999999675, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 35.900000000000034, -50.00000000000044, -50.00000000000044, 11.899999999999729, 33.90000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, 30.099999999999987, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, 2.299999999999592], "episode_lengths": [500, 500, 500, 500, 414, 368, 500, 500, 500, 464, 96, 448, 310, 232, 154, 500, 466, 500, 500, 452, 500, 484, 440, 336, 448, 500, 286, 500, 500, 500, 500, 500, 500, 134, 170, 500, 500, 500, 252, 246, 500, 388, 156, 500, 500, 500, 500, 500, 500, 316, 500, 500, 132, 354, 342, 350, 346, 302, 420, 500, 500, 478, 500, 500, 494, 142, 500, 500, 382, 162, 500, 500, 136, 200, 486, 500, 500, 500, 500, 500, 144, 240, 478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5461662995220659, "mean_inference_ms": 1.767229113471746, "mean_action_processing_ms": 0.2087256199764237, "mean_env_wait_ms": 0.1264336048392018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048164861748017464, "StateBufferConnector_ms": 0.0072387327630835845, "ViewRequirementAgentConnector_ms": 0.1628272504691618}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4688.818879270174, "num_env_steps_trained_throughput_per_sec": 4688.818879270174, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 4195.506, "sample_time_ms": 3951.816, "load_time_ms": 19.752, "load_throughput": 911320.941, "learn_time_ms": 209.608, "learn_throughput": 85874.602, "synch_weights_time_ms": 12.828}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 83, "training_iteration": 2, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-05", "timestamp": 1698246305, "time_this_iter_s": 3.8449225425720215, "time_total_s": 8.403012752532959, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.403012752532959, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 81.24, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 8.964815998077393, "policy_loss": -0.06979132890701294, "vf_loss": 9.034504652023315, "vf_explained_var": 1.1324882507324218e-07, "kl": 0.00341473385591371, "entropy": 0.6804992496967316, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 50.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.93000000000023, "episode_len_mean": 339.92, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 36.900000000000034, 14.699999999999768, 15.899999999999785, 15.099999999999774, 15.49999999999978, 19.899999999999842, 8.099999999999675, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 35.900000000000034, -50.00000000000044, -50.00000000000044, 11.899999999999729, 33.90000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, 30.099999999999987, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, 2.299999999999592, 43.30000000000001, 29.099999999999973, 28.29999999999996, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 18.699999999999825, 40.90000000000002, 33.10000000000003, 20.899999999999856, 43.30000000000001, 38.700000000000024, 22.299999999999876, 32.90000000000003, 26.09999999999993, 14.899999999999771, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 14.699999999999768, 7.899999999999672, 30.699999999999996, -50.00000000000044, 26.69999999999994, 16.699999999999797, -50.00000000000044, 33.90000000000004, 42.70000000000001, 45.5, 34.900000000000034, 35.70000000000003, 32.700000000000024, -50.00000000000044, 24.299999999999905, 12.099999999999731, 36.70000000000003, 22.899999999999885, 25.699999999999925, 25.899999999999928, 31.70000000000001, 36.30000000000003, 40.30000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.700000000000024, -50.00000000000044, 29.49999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [156, 500, 500, 500, 500, 500, 500, 316, 500, 500, 132, 354, 342, 350, 346, 302, 420, 500, 500, 478, 500, 500, 494, 142, 500, 500, 382, 162, 500, 500, 136, 200, 486, 500, 500, 500, 500, 500, 144, 240, 478, 68, 210, 218, 500, 348, 500, 500, 66, 500, 500, 266, 314, 92, 170, 292, 68, 114, 278, 172, 240, 352, 500, 404, 500, 500, 354, 422, 194, 500, 234, 334, 500, 162, 74, 46, 152, 144, 174, 500, 258, 380, 134, 272, 244, 242, 184, 138, 98, 408, 500, 500, 88, 114, 500, 206, 204, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5145857748915715, "mean_inference_ms": 1.6487245283202396, "mean_action_processing_ms": 0.19381704059702515, "mean_env_wait_ms": 0.11759571965266842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0394132137298584, "StateBufferConnector_ms": 0.010004997253417969, "ViewRequirementAgentConnector_ms": 0.13696932792663574}}, "episode_reward_max": 45.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.93000000000023, "episode_len_mean": 339.92, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.499999999999822, -50.00000000000044, -50.00000000000044, 36.900000000000034, 14.699999999999768, 15.899999999999785, 15.099999999999774, 15.49999999999978, 19.899999999999842, 8.099999999999675, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 35.900000000000034, -50.00000000000044, -50.00000000000044, 11.899999999999729, 33.90000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, 30.099999999999987, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 26.09999999999993, 2.299999999999592, 43.30000000000001, 29.099999999999973, 28.29999999999996, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 23.499999999999893, 18.699999999999825, 40.90000000000002, 33.10000000000003, 20.899999999999856, 43.30000000000001, 38.700000000000024, 22.299999999999876, 32.90000000000003, 26.09999999999993, 14.899999999999771, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 14.699999999999768, 7.899999999999672, 30.699999999999996, -50.00000000000044, 26.69999999999994, 16.699999999999797, -50.00000000000044, 33.90000000000004, 42.70000000000001, 45.5, 34.900000000000034, 35.70000000000003, 32.700000000000024, -50.00000000000044, 24.299999999999905, 12.099999999999731, 36.70000000000003, 22.899999999999885, 25.699999999999925, 25.899999999999928, 31.70000000000001, 36.30000000000003, 40.30000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.700000000000024, -50.00000000000044, 29.49999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [156, 500, 500, 500, 500, 500, 500, 316, 500, 500, 132, 354, 342, 350, 346, 302, 420, 500, 500, 478, 500, 500, 494, 142, 500, 500, 382, 162, 500, 500, 136, 200, 486, 500, 500, 500, 500, 500, 144, 240, 478, 68, 210, 218, 500, 348, 500, 500, 66, 500, 500, 266, 314, 92, 170, 292, 68, 114, 278, 172, 240, 352, 500, 404, 500, 500, 354, 422, 194, 500, 234, 334, 500, 162, 74, 46, 152, 144, 174, 500, 258, 380, 134, 272, 244, 242, 184, 138, 98, 408, 500, 500, 88, 114, 500, 206, 204, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5145857748915715, "mean_inference_ms": 1.6487245283202396, "mean_action_processing_ms": 0.19381704059702515, "mean_env_wait_ms": 0.11759571965266842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0394132137298584, "StateBufferConnector_ms": 0.010004997253417969, "ViewRequirementAgentConnector_ms": 0.13696932792663574}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4915.438731594646, "num_env_steps_trained_throughput_per_sec": 4915.438731594646, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 4017.648, "sample_time_ms": 3766.938, "load_time_ms": 16.818, "load_throughput": 1070268.762, "learn_time_ms": 218.071, "learn_throughput": 82541.84, "synch_weights_time_ms": 14.152}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 142, "training_iteration": 3, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-08", "timestamp": 1698246308, "time_this_iter_s": 3.66672945022583, "time_total_s": 12.069742202758789, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.069742202758789, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.4, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 8.956248712539672, "policy_loss": -0.01684784370008856, "vf_loss": 8.973139905929566, "vf_explained_var": 1.5753507614135743e-05, "kl": 0.0008730779263032673, "entropy": 0.6496901094913483, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 70.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.032999999999814, "episode_len_mean": 305.32, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.09999999999993, 14.899999999999771, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 14.699999999999768, 7.899999999999672, 30.699999999999996, -50.00000000000044, 26.69999999999994, 16.699999999999797, -50.00000000000044, 33.90000000000004, 42.70000000000001, 45.5, 34.900000000000034, 35.70000000000003, 32.700000000000024, -50.00000000000044, 24.299999999999905, 12.099999999999731, 36.70000000000003, 22.899999999999885, 25.699999999999925, 25.899999999999928, 31.70000000000001, 36.30000000000003, 40.30000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.700000000000024, -50.00000000000044, 29.49999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 44.300000000000004, 34.50000000000004, -50.00000000000044, 31.1, -50.00000000000044, 21.699999999999868, 32.100000000000016, 46.099999999999994, 0.09999999999956088, 34.900000000000034, 35.70000000000003, 26.499999999999936, -50.00000000000044, 23.29999999999989, 38.10000000000002, 33.10000000000003, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 26.69999999999994, 28.89999999999997, 33.10000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.10000000000001, 36.10000000000004, 17.499999999999808, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 25.099999999999916, 19.499999999999837, 33.90000000000004, -50.00000000000044, 27.299999999999947, 42.30000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, 39.50000000000002], "episode_lengths": [240, 352, 500, 404, 500, 500, 354, 422, 194, 500, 234, 334, 500, 162, 74, 46, 152, 144, 174, 500, 258, 380, 134, 272, 244, 242, 184, 138, 98, 408, 500, 500, 88, 114, 500, 206, 204, 500, 500, 500, 500, 500, 500, 358, 500, 500, 58, 156, 500, 190, 500, 284, 180, 40, 500, 152, 144, 236, 500, 268, 120, 170, 500, 232, 500, 500, 154, 234, 212, 170, 500, 500, 86, 80, 140, 326, 130, 48, 500, 500, 152, 168, 500, 500, 158, 500, 500, 146, 250, 306, 162, 500, 228, 78, 158, 500, 500, 500, 196, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49759390595607017, "mean_inference_ms": 1.5897911195055634, "mean_action_processing_ms": 0.1871927528765378, "mean_env_wait_ms": 0.11362140049143502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03942584991455078, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.14794421195983887}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.032999999999814, "episode_len_mean": 305.32, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.09999999999993, 14.899999999999771, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 14.699999999999768, 7.899999999999672, 30.699999999999996, -50.00000000000044, 26.69999999999994, 16.699999999999797, -50.00000000000044, 33.90000000000004, 42.70000000000001, 45.5, 34.900000000000034, 35.70000000000003, 32.700000000000024, -50.00000000000044, 24.299999999999905, 12.099999999999731, 36.70000000000003, 22.899999999999885, 25.699999999999925, 25.899999999999928, 31.70000000000001, 36.30000000000003, 40.30000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.30000000000001, 38.700000000000024, -50.00000000000044, 29.49999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, -50.00000000000044, 44.300000000000004, 34.50000000000004, -50.00000000000044, 31.1, -50.00000000000044, 21.699999999999868, 32.100000000000016, 46.099999999999994, 0.09999999999956088, 34.900000000000034, 35.70000000000003, 26.499999999999936, -50.00000000000044, 23.29999999999989, 38.10000000000002, 33.10000000000003, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 26.69999999999994, 28.89999999999997, 33.10000000000003, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.10000000000001, 36.10000000000004, 17.499999999999808, 37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 25.099999999999916, 19.499999999999837, 33.90000000000004, -50.00000000000044, 27.299999999999947, 42.30000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, 39.50000000000002], "episode_lengths": [240, 352, 500, 404, 500, 500, 354, 422, 194, 500, 234, 334, 500, 162, 74, 46, 152, 144, 174, 500, 258, 380, 134, 272, 244, 242, 184, 138, 98, 408, 500, 500, 88, 114, 500, 206, 204, 500, 500, 500, 500, 500, 500, 358, 500, 500, 58, 156, 500, 190, 500, 284, 180, 40, 500, 152, 144, 236, 500, 268, 120, 170, 500, 232, 500, 500, 154, 234, 212, 170, 500, 500, 86, 80, 140, 326, 130, 48, 500, 500, 152, 168, 500, 500, 158, 500, 500, 146, 250, 306, 162, 500, 228, 78, 158, 500, 500, 500, 196, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49759390595607017, "mean_inference_ms": 1.5897911195055634, "mean_action_processing_ms": 0.1871927528765378, "mean_env_wait_ms": 0.11362140049143502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03942584991455078, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.14794421195983887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4888.687147347116, "num_env_steps_trained_throughput_per_sec": 4888.687147347116, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3933.728, "sample_time_ms": 3679.271, "load_time_ms": 17.613, "load_throughput": 1021948.562, "learn_time_ms": 221.595, "learn_throughput": 81229.121, "synch_weights_time_ms": 13.249}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 202, "training_iteration": 4, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-12", "timestamp": 1698246312, "time_this_iter_s": 3.68696928024292, "time_total_s": 15.756711483001709, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.756711483001709, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 30.900000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 9.060332822799683, "policy_loss": 0.007839982584118842, "vf_loss": 9.052537202835083, "vf_explained_var": 1.519322395324707e-05, "kl": 0.0011769548757342818, "entropy": 0.5908495426177979, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.412999999999865, "episode_len_mean": 251.58, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 25.099999999999916, 19.499999999999837, 33.90000000000004, -50.00000000000044, 27.299999999999947, 42.30000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, 39.50000000000002, 29.099999999999973, 42.900000000000006, 39.90000000000002, 32.30000000000002, 32.700000000000024, 46.099999999999994, -50.00000000000044, 41.90000000000001, 21.09999999999986, 33.10000000000003, 45.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.900000000000034, 36.900000000000034, 31.1, 38.10000000000002, 40.500000000000014, 42.900000000000006, 43.50000000000001, 21.699999999999868, 20.299999999999848, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 35.500000000000036, 30.499999999999993, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.900000000000006, 24.299999999999905, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.30000000000001, -50.00000000000044, 42.10000000000001, 42.70000000000001, 34.10000000000004, 42.900000000000006, 40.10000000000002, 41.70000000000002, 32.100000000000016, 28.09999999999996, 42.900000000000006, 33.500000000000036, 27.699999999999953, 21.699999999999868, 40.70000000000002, 32.50000000000002, -50.00000000000044, 21.299999999999862, 30.699999999999996, -50.00000000000044, 39.50000000000002, 33.90000000000004, 44.900000000000006, 32.100000000000016, 25.099999999999916, -50.00000000000044, 44.300000000000004, 38.10000000000002, 39.10000000000002], "episode_lengths": [130, 48, 500, 500, 152, 168, 500, 500, 158, 500, 500, 146, 250, 306, 162, 500, 228, 78, 158, 500, 500, 500, 196, 106, 210, 72, 102, 178, 174, 40, 500, 82, 290, 170, 44, 500, 500, 94, 500, 142, 132, 190, 120, 96, 72, 66, 284, 298, 310, 500, 500, 500, 44, 146, 196, 152, 500, 500, 90, 72, 258, 500, 70, 54, 500, 238, 500, 500, 500, 500, 312, 68, 500, 80, 74, 160, 72, 100, 84, 180, 220, 72, 166, 224, 284, 94, 176, 500, 288, 194, 500, 106, 162, 52, 180, 250, 500, 58, 120, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48756195806216746, "mean_inference_ms": 1.5657465086186095, "mean_action_processing_ms": 0.18418071929919144, "mean_env_wait_ms": 0.11033218605072218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300309181213379, "StateBufferConnector_ms": 0.01000523567199707, "ViewRequirementAgentConnector_ms": 0.14997434616088867}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.412999999999865, "episode_len_mean": 251.58, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 25.099999999999916, 19.499999999999837, 33.90000000000004, -50.00000000000044, 27.299999999999947, 42.30000000000001, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, 39.50000000000002, 29.099999999999973, 42.900000000000006, 39.90000000000002, 32.30000000000002, 32.700000000000024, 46.099999999999994, -50.00000000000044, 41.90000000000001, 21.09999999999986, 33.10000000000003, 45.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 35.900000000000034, 36.900000000000034, 31.1, 38.10000000000002, 40.500000000000014, 42.900000000000006, 43.50000000000001, 21.699999999999868, 20.299999999999848, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 35.500000000000036, 30.499999999999993, 34.900000000000034, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.900000000000006, 24.299999999999905, -50.00000000000044, 43.10000000000001, 44.7, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 43.30000000000001, -50.00000000000044, 42.10000000000001, 42.70000000000001, 34.10000000000004, 42.900000000000006, 40.10000000000002, 41.70000000000002, 32.100000000000016, 28.09999999999996, 42.900000000000006, 33.500000000000036, 27.699999999999953, 21.699999999999868, 40.70000000000002, 32.50000000000002, -50.00000000000044, 21.299999999999862, 30.699999999999996, -50.00000000000044, 39.50000000000002, 33.90000000000004, 44.900000000000006, 32.100000000000016, 25.099999999999916, -50.00000000000044, 44.300000000000004, 38.10000000000002, 39.10000000000002], "episode_lengths": [130, 48, 500, 500, 152, 168, 500, 500, 158, 500, 500, 146, 250, 306, 162, 500, 228, 78, 158, 500, 500, 500, 196, 106, 210, 72, 102, 178, 174, 40, 500, 82, 290, 170, 44, 500, 500, 94, 500, 142, 132, 190, 120, 96, 72, 66, 284, 298, 310, 500, 500, 500, 44, 146, 196, 152, 500, 500, 90, 72, 258, 500, 70, 54, 500, 238, 500, 500, 500, 500, 312, 68, 500, 80, 74, 160, 72, 100, 84, 180, 220, 72, 166, 224, 284, 94, 176, 500, 288, 194, 500, 106, 162, 52, 180, 250, 500, 58, 120, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48756195806216746, "mean_inference_ms": 1.5657465086186095, "mean_action_processing_ms": 0.18418071929919144, "mean_env_wait_ms": 0.11033218605072218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300309181213379, "StateBufferConnector_ms": 0.01000523567199707, "ViewRequirementAgentConnector_ms": 0.14997434616088867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4894.800853707787, "num_env_steps_trained_throughput_per_sec": 4894.800853707787, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3882.457, "sample_time_ms": 3632.84, "load_time_ms": 15.844, "load_throughput": 1136079.357, "learn_time_ms": 219.252, "learn_throughput": 82097.254, "synch_weights_time_ms": 12.721}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 278, "training_iteration": 5, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-16", "timestamp": 1698246316, "time_this_iter_s": 3.6821415424346924, "time_total_s": 19.4388530254364, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.4388530254364, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 81.61999999999999, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.678736448287964, "policy_loss": 0.025488503836095334, "vf_loss": 8.6532968044281, "vf_explained_var": -8.934736251831055e-06, "kl": 0.0007301401661891305, "entropy": 0.5331571906805038, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 110.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.672999999999849, "episode_len_mean": 248.98, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, 43.30000000000001, -50.00000000000044, 42.10000000000001, 42.70000000000001, 34.10000000000004, 42.900000000000006, 40.10000000000002, 41.70000000000002, 32.100000000000016, 28.09999999999996, 42.900000000000006, 33.500000000000036, 27.699999999999953, 21.699999999999868, 40.70000000000002, 32.50000000000002, -50.00000000000044, 21.299999999999862, 30.699999999999996, -50.00000000000044, 39.50000000000002, 33.90000000000004, 44.900000000000006, 32.100000000000016, 25.099999999999916, -50.00000000000044, 44.300000000000004, 38.10000000000002, 39.10000000000002, 31.500000000000007, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 27.299999999999947, 44.7, -50.00000000000044, 41.500000000000014, 45.3, 46.3, 30.699999999999996, -50.00000000000044, 44.5, 43.50000000000001, 41.500000000000014, -50.00000000000044, 24.099999999999902, 41.500000000000014, -50.00000000000044, 44.300000000000004, 37.90000000000003, 45.9, 43.10000000000001, -50.00000000000044, 13.699999999999754, 43.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 24.899999999999913, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.5, 20.099999999999845, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 33.10000000000003, 8.299999999999677, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, 6.299999999999649, 45.1, 43.7, 30.9, 39.300000000000026, -50.00000000000044, 46.3], "episode_lengths": [500, 312, 68, 500, 80, 74, 160, 72, 100, 84, 180, 220, 72, 166, 224, 284, 94, 176, 500, 288, 194, 500, 106, 162, 52, 180, 250, 500, 58, 120, 110, 186, 500, 308, 500, 500, 260, 500, 228, 54, 500, 86, 48, 38, 194, 500, 56, 66, 86, 500, 260, 86, 500, 58, 122, 42, 70, 500, 364, 70, 500, 88, 500, 48, 52, 500, 500, 500, 500, 500, 60, 82, 252, 500, 100, 70, 500, 500, 70, 46, 300, 154, 500, 500, 76, 58, 170, 418, 350, 500, 500, 58, 488, 438, 50, 64, 192, 108, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48159222587986716, "mean_inference_ms": 1.5463149068447077, "mean_action_processing_ms": 0.18201692722337504, "mean_env_wait_ms": 0.10913968259629496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028934478759765625, "StateBufferConnector_ms": 0.011010885238647461, "ViewRequirementAgentConnector_ms": 0.15404725074768066}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.672999999999849, "episode_len_mean": 248.98, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.899999999999828, 43.30000000000001, -50.00000000000044, 42.10000000000001, 42.70000000000001, 34.10000000000004, 42.900000000000006, 40.10000000000002, 41.70000000000002, 32.100000000000016, 28.09999999999996, 42.900000000000006, 33.500000000000036, 27.699999999999953, 21.699999999999868, 40.70000000000002, 32.50000000000002, -50.00000000000044, 21.299999999999862, 30.699999999999996, -50.00000000000044, 39.50000000000002, 33.90000000000004, 44.900000000000006, 32.100000000000016, 25.099999999999916, -50.00000000000044, 44.300000000000004, 38.10000000000002, 39.10000000000002, 31.500000000000007, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 27.299999999999947, 44.7, -50.00000000000044, 41.500000000000014, 45.3, 46.3, 30.699999999999996, -50.00000000000044, 44.5, 43.50000000000001, 41.500000000000014, -50.00000000000044, 24.099999999999902, 41.500000000000014, -50.00000000000044, 44.300000000000004, 37.90000000000003, 45.9, 43.10000000000001, -50.00000000000044, 13.699999999999754, 43.10000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 24.899999999999913, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.5, 20.099999999999845, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 33.10000000000003, 8.299999999999677, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, 6.299999999999649, 45.1, 43.7, 30.9, 39.300000000000026, -50.00000000000044, 46.3], "episode_lengths": [500, 312, 68, 500, 80, 74, 160, 72, 100, 84, 180, 220, 72, 166, 224, 284, 94, 176, 500, 288, 194, 500, 106, 162, 52, 180, 250, 500, 58, 120, 110, 186, 500, 308, 500, 500, 260, 500, 228, 54, 500, 86, 48, 38, 194, 500, 56, 66, 86, 500, 260, 86, 500, 58, 122, 42, 70, 500, 364, 70, 500, 88, 500, 48, 52, 500, 500, 500, 500, 500, 60, 82, 252, 500, 100, 70, 500, 500, 70, 46, 300, 154, 500, 500, 76, 58, 170, 418, 350, 500, 500, 58, 488, 438, 50, 64, 192, 108, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48159222587986716, "mean_inference_ms": 1.5463149068447077, "mean_action_processing_ms": 0.18201692722337504, "mean_env_wait_ms": 0.10913968259629496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028934478759765625, "StateBufferConnector_ms": 0.011010885238647461, "ViewRequirementAgentConnector_ms": 0.15404725074768066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4957.976100835608, "num_env_steps_trained_throughput_per_sec": 4957.976100835608, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3840.466, "sample_time_ms": 3587.69, "load_time_ms": 16.536, "load_throughput": 1088515.969, "learn_time_ms": 221.885, "learn_throughput": 81123.044, "synch_weights_time_ms": 12.593}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 347, "training_iteration": 6, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-19", "timestamp": 1698246319, "time_this_iter_s": 3.6375083923339844, "time_total_s": 23.076361417770386, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.076361417770386, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 78.96, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.228682112693786, "policy_loss": -0.06453988403081894, "vf_loss": 8.293277025222778, "vf_explained_var": 2.682209014892578e-06, "kl": 0.00011446769335634598, "entropy": 0.5533557295799255, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 130.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.847999999999819, "episode_len_mean": 262.16, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 24.899999999999913, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.5, 20.099999999999845, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 33.10000000000003, 8.299999999999677, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, 6.299999999999649, 45.1, 43.7, 30.9, 39.300000000000026, -50.00000000000044, 46.3, 32.700000000000024, 33.30000000000003, 0.6999999999995694, 38.300000000000026, 46.699999999999996, 45.5, 33.70000000000004, 40.10000000000002, 45.5, 43.50000000000001, -50.00000000000044, 43.7, -50.00000000000044, 8.299999999999677, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.29999999999999, 42.10000000000001, -50.00000000000044, 35.10000000000004, 46.699999999999996, -50.00000000000044, 46.099999999999994, 42.70000000000001, -50.00000000000044, 43.7, 42.900000000000006, -50.00000000000044, 44.10000000000001, 41.500000000000014, 45.1, 44.900000000000006, 27.49999999999995, 46.099999999999994, 44.5, 46.5, 45.5, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 25.899999999999928, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 60, 82, 252, 500, 100, 70, 500, 500, 70, 46, 300, 154, 500, 500, 76, 58, 170, 418, 350, 500, 500, 58, 488, 438, 50, 64, 192, 108, 500, 38, 174, 168, 494, 118, 34, 46, 164, 100, 46, 66, 500, 64, 500, 418, 78, 500, 500, 198, 80, 500, 150, 34, 500, 40, 74, 500, 64, 72, 500, 60, 86, 50, 52, 226, 40, 56, 36, 46, 500, 52, 56, 500, 62, 500, 344, 500, 500, 500, 500, 82, 70, 500, 500, 74, 66, 500, 242, 32, 500, 500, 54, 106, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4787603677851901, "mean_inference_ms": 1.530217537300296, "mean_action_processing_ms": 0.18080290424783377, "mean_env_wait_ms": 0.10765891445930043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04193425178527832, "StateBufferConnector_ms": 0.007005214691162109, "ViewRequirementAgentConnector_ms": 0.14112591743469238}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.847999999999819, "episode_len_mean": 262.16, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, 41.90000000000001, 24.899999999999913, -50.00000000000044, 40.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.5, 20.099999999999845, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 33.10000000000003, 8.299999999999677, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.300000000000004, 1.299999999999578, 6.299999999999649, 45.1, 43.7, 30.9, 39.300000000000026, -50.00000000000044, 46.3, 32.700000000000024, 33.30000000000003, 0.6999999999995694, 38.300000000000026, 46.699999999999996, 45.5, 33.70000000000004, 40.10000000000002, 45.5, 43.50000000000001, -50.00000000000044, 43.7, -50.00000000000044, 8.299999999999677, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.29999999999999, 42.10000000000001, -50.00000000000044, 35.10000000000004, 46.699999999999996, -50.00000000000044, 46.099999999999994, 42.70000000000001, -50.00000000000044, 43.7, 42.900000000000006, -50.00000000000044, 44.10000000000001, 41.500000000000014, 45.1, 44.900000000000006, 27.49999999999995, 46.099999999999994, 44.5, 46.5, 45.5, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 25.899999999999928, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 60, 82, 252, 500, 100, 70, 500, 500, 70, 46, 300, 154, 500, 500, 76, 58, 170, 418, 350, 500, 500, 58, 488, 438, 50, 64, 192, 108, 500, 38, 174, 168, 494, 118, 34, 46, 164, 100, 46, 66, 500, 64, 500, 418, 78, 500, 500, 198, 80, 500, 150, 34, 500, 40, 74, 500, 64, 72, 500, 60, 86, 50, 52, 226, 40, 56, 36, 46, 500, 52, 56, 500, 62, 500, 344, 500, 500, 500, 500, 82, 70, 500, 500, 74, 66, 500, 242, 32, 500, 500, 54, 106, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4787603677851901, "mean_inference_ms": 1.530217537300296, "mean_action_processing_ms": 0.18080290424783377, "mean_env_wait_ms": 0.10765891445930043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04193425178527832, "StateBufferConnector_ms": 0.007005214691162109, "ViewRequirementAgentConnector_ms": 0.14112591743469238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4921.28945490755, "num_env_steps_trained_throughput_per_sec": 4921.28945490755, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3814.34, "sample_time_ms": 3556.679, "load_time_ms": 16.888, "load_throughput": 1065836.632, "learn_time_ms": 225.469, "learn_throughput": 79833.6, "synch_weights_time_ms": 13.508}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 415, "training_iteration": 7, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-23", "timestamp": 1698246323, "time_this_iter_s": 3.6655805110931396, "time_total_s": 26.741941928863525, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.741941928863525, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 78.12, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 7.976260375976563, "policy_loss": -0.027241253200918435, "vf_loss": 8.003550720214843, "vf_explained_var": 3.0249357223510742e-06, "kl": 0.0007109557838017255, "entropy": 0.5019394069910049, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 150.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.42200000000020893, "episode_len_mean": 284.78, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 25.899999999999928, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 43.7, -50.00000000000044, 45.7, 39.10000000000002, 39.70000000000002, -50.00000000000044, 39.70000000000002, 40.90000000000002, -50.00000000000044, 44.300000000000004, 8.099999999999675, -50.00000000000044, -50.00000000000044, 45.1, 42.30000000000001, 46.3, 16.499999999999794, -50.00000000000044, 42.30000000000001, 46.3, 37.300000000000026, 43.10000000000001, 32.90000000000003, 5.099999999999632, 46.5, 34.10000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 13.299999999999748, 46.9, -50.00000000000044, 39.70000000000002, 46.099999999999994, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 46.3, 41.70000000000002, 30.699999999999996, -50.00000000000044, 37.50000000000003, 46.3, -50.00000000000044, 45.7, 45.9, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, 45.9, 46.3], "episode_lengths": [500, 52, 56, 500, 62, 500, 344, 500, 500, 500, 500, 82, 70, 500, 500, 74, 66, 500, 242, 32, 500, 500, 54, 106, 500, 500, 500, 500, 500, 500, 500, 238, 64, 500, 44, 110, 104, 500, 104, 92, 500, 58, 420, 500, 500, 50, 78, 38, 336, 500, 78, 38, 128, 70, 172, 450, 36, 160, 500, 40, 500, 500, 54, 368, 32, 500, 104, 40, 500, 382, 86, 500, 38, 84, 194, 500, 126, 38, 500, 44, 42, 50, 102, 500, 500, 500, 500, 88, 500, 500, 500, 500, 216, 500, 500, 62, 100, 500, 42, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4756815146986662, "mean_inference_ms": 1.5163357324742992, "mean_action_processing_ms": 0.17898441695571987, "mean_env_wait_ms": 0.10727999712792824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03280758857727051, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1492147445678711}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.42200000000020893, "episode_len_mean": 284.78, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.50000000000001, -50.00000000000044, 25.899999999999928, 46.9, -50.00000000000044, -50.00000000000044, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 43.7, -50.00000000000044, 45.7, 39.10000000000002, 39.70000000000002, -50.00000000000044, 39.70000000000002, 40.90000000000002, -50.00000000000044, 44.300000000000004, 8.099999999999675, -50.00000000000044, -50.00000000000044, 45.1, 42.30000000000001, 46.3, 16.499999999999794, -50.00000000000044, 42.30000000000001, 46.3, 37.300000000000026, 43.10000000000001, 32.90000000000003, 5.099999999999632, 46.5, 34.10000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 13.299999999999748, 46.9, -50.00000000000044, 39.70000000000002, 46.099999999999994, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 46.3, 41.70000000000002, 30.699999999999996, -50.00000000000044, 37.50000000000003, 46.3, -50.00000000000044, 45.7, 45.9, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, 45.9, 46.3], "episode_lengths": [500, 52, 56, 500, 62, 500, 344, 500, 500, 500, 500, 82, 70, 500, 500, 74, 66, 500, 242, 32, 500, 500, 54, 106, 500, 500, 500, 500, 500, 500, 500, 238, 64, 500, 44, 110, 104, 500, 104, 92, 500, 58, 420, 500, 500, 50, 78, 38, 336, 500, 78, 38, 128, 70, 172, 450, 36, 160, 500, 40, 500, 500, 54, 368, 32, 500, 104, 40, 500, 382, 86, 500, 38, 84, 194, 500, 126, 38, 500, 44, 42, 50, 102, 500, 500, 500, 500, 88, 500, 500, 500, 500, 216, 500, 500, 62, 100, 500, 42, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4756815146986662, "mean_inference_ms": 1.5163357324742992, "mean_action_processing_ms": 0.17898441695571987, "mean_env_wait_ms": 0.10727999712792824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03280758857727051, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1492147445678711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5041.690971658538, "num_env_steps_trained_throughput_per_sec": 5041.690971658538, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3783.826, "sample_time_ms": 3530.797, "load_time_ms": 15.797, "load_throughput": 1139479.135, "learn_time_ms": 222.434, "learn_throughput": 80923.038, "synch_weights_time_ms": 12.977}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 485, "training_iteration": 8, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-27", "timestamp": 1698246327, "time_this_iter_s": 3.5752296447753906, "time_total_s": 30.317171573638916, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.317171573638916, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 78.8, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 6.6918790102005, "policy_loss": 0.012701756879687309, "vf_loss": 6.679232978820801, "vf_explained_var": 6.645917892456055e-07, "kl": 0.00029544574215378816, "entropy": 0.5595494151115418, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 170.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.3300000000002155, "episode_len_mean": 293.84, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 13.299999999999748, 46.9, -50.00000000000044, 39.70000000000002, 46.099999999999994, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 46.3, 41.70000000000002, 30.699999999999996, -50.00000000000044, 37.50000000000003, 46.3, -50.00000000000044, 45.7, 45.9, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, 45.9, 46.3, 38.700000000000024, 26.499999999999936, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.7, 45.3, 43.7, 43.7, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.099999999999717, 0.09999999999956088, 43.900000000000006, 44.5, 42.10000000000001, 46.099999999999994, -50.00000000000044, 42.900000000000006, 28.499999999999964, 38.90000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 3.899999999999615, 33.70000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [40, 500, 500, 54, 368, 32, 500, 104, 40, 500, 382, 86, 500, 38, 84, 194, 500, 126, 38, 500, 44, 42, 50, 102, 500, 500, 500, 500, 88, 500, 500, 500, 500, 216, 500, 500, 62, 100, 500, 42, 38, 114, 236, 500, 72, 500, 500, 500, 162, 500, 64, 48, 64, 64, 148, 500, 500, 500, 78, 500, 500, 500, 500, 500, 80, 42, 500, 500, 46, 500, 94, 84, 500, 500, 500, 500, 500, 136, 390, 500, 62, 56, 80, 40, 500, 72, 216, 112, 500, 128, 500, 500, 80, 500, 58, 462, 164, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47157668609254744, "mean_inference_ms": 1.5055081636317516, "mean_action_processing_ms": 0.17786008223228236, "mean_env_wait_ms": 0.10677108062314514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600407600402832, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13651061058044434}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.3300000000002155, "episode_len_mean": 293.84, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 13.299999999999748, 46.9, -50.00000000000044, 39.70000000000002, 46.099999999999994, -50.00000000000044, 11.899999999999729, 41.500000000000014, -50.00000000000044, 46.3, 41.70000000000002, 30.699999999999996, -50.00000000000044, 37.50000000000003, 46.3, -50.00000000000044, 45.7, 45.9, 45.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, 45.9, 46.3, 38.700000000000024, 26.499999999999936, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 43.7, 45.3, 43.7, 43.7, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.099999999999717, 0.09999999999956088, 43.900000000000006, 44.5, 42.10000000000001, 46.099999999999994, -50.00000000000044, 42.900000000000006, 28.499999999999964, 38.90000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 3.899999999999615, 33.70000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [40, 500, 500, 54, 368, 32, 500, 104, 40, 500, 382, 86, 500, 38, 84, 194, 500, 126, 38, 500, 44, 42, 50, 102, 500, 500, 500, 500, 88, 500, 500, 500, 500, 216, 500, 500, 62, 100, 500, 42, 38, 114, 236, 500, 72, 500, 500, 500, 162, 500, 64, 48, 64, 64, 148, 500, 500, 500, 78, 500, 500, 500, 500, 500, 80, 42, 500, 500, 46, 500, 94, 84, 500, 500, 500, 500, 500, 136, 390, 500, 62, 56, 80, 40, 500, 72, 216, 112, 500, 128, 500, 500, 80, 500, 58, 462, 164, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47157668609254744, "mean_inference_ms": 1.5055081636317516, "mean_action_processing_ms": 0.17786008223228236, "mean_env_wait_ms": 0.10677108062314514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600407600402832, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13651061058044434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5158.279910894734, "num_env_steps_trained_throughput_per_sec": 5158.279910894734, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3751.127, "sample_time_ms": 3499.475, "load_time_ms": 15.041, "load_throughput": 1196692.559, "learn_time_ms": 221.454, "learn_throughput": 81281.169, "synch_weights_time_ms": 13.427}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 544, "training_iteration": 9, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-30", "timestamp": 1698246330, "time_this_iter_s": 3.494302988052368, "time_total_s": 33.811474561691284, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.811474561691284, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 75.84, "ram_util_percent": 31.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 6.315169763565064, "policy_loss": -0.05027414970099926, "vf_loss": 6.3654975414276125, "vf_explained_var": -2.115964889526367e-07, "kl": 0.0004919857766978453, "entropy": 0.5378631144762039, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 190.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.141000000000207, "episode_len_mean": 296.96, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.099999999999717, 0.09999999999956088, 43.900000000000006, 44.5, 42.10000000000001, 46.099999999999994, -50.00000000000044, 42.900000000000006, 28.499999999999964, 38.90000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 3.899999999999615, 33.70000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.10000000000004, 43.7, 33.500000000000036, 37.10000000000003, 41.90000000000001, 41.70000000000002, 44.300000000000004, 35.30000000000004, 43.50000000000001, 39.90000000000002, -50.00000000000044, 34.70000000000004, 13.299999999999748, 38.300000000000026, 45.3, -50.00000000000044, 35.900000000000034, 42.500000000000014, 37.70000000000003, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.90000000000002, -50.00000000000044, 31.500000000000007, 39.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.300000000000026, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 27.299999999999947, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 80, 42, 500, 500, 46, 500, 94, 84, 500, 500, 500, 500, 500, 136, 390, 500, 62, 56, 80, 40, 500, 72, 216, 112, 500, 128, 500, 500, 80, 500, 58, 462, 164, 500, 62, 500, 500, 62, 150, 64, 166, 130, 82, 84, 58, 148, 66, 102, 500, 154, 368, 118, 48, 500, 142, 76, 124, 500, 200, 500, 500, 92, 500, 500, 500, 500, 500, 82, 92, 500, 186, 104, 500, 72, 500, 60, 500, 62, 500, 500, 86, 500, 128, 278, 500, 500, 500, 68, 228, 128, 500, 500, 224, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46803335743547825, "mean_inference_ms": 1.497330412849406, "mean_action_processing_ms": 0.17649097017621546, "mean_env_wait_ms": 0.10602355214650241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026980161666870117, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.14989089965820312}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.141000000000207, "episode_len_mean": 296.96, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.099999999999717, 0.09999999999956088, 43.900000000000006, 44.5, 42.10000000000001, 46.099999999999994, -50.00000000000044, 42.900000000000006, 28.499999999999964, 38.90000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 3.899999999999615, 33.70000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.10000000000004, 43.7, 33.500000000000036, 37.10000000000003, 41.90000000000001, 41.70000000000002, 44.300000000000004, 35.30000000000004, 43.50000000000001, 39.90000000000002, -50.00000000000044, 34.70000000000004, 13.299999999999748, 38.300000000000026, 45.3, -50.00000000000044, 35.900000000000034, 42.500000000000014, 37.70000000000003, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.90000000000002, -50.00000000000044, 31.500000000000007, 39.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.300000000000026, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 27.299999999999947, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 80, 42, 500, 500, 46, 500, 94, 84, 500, 500, 500, 500, 500, 136, 390, 500, 62, 56, 80, 40, 500, 72, 216, 112, 500, 128, 500, 500, 80, 500, 58, 462, 164, 500, 62, 500, 500, 62, 150, 64, 166, 130, 82, 84, 58, 148, 66, 102, 500, 154, 368, 118, 48, 500, 142, 76, 124, 500, 200, 500, 500, 92, 500, 500, 500, 500, 500, 82, 92, 500, 186, 104, 500, 72, 500, 60, 500, 62, 500, 500, 86, 500, 128, 278, 500, 500, 500, 68, 228, 128, 500, 500, 224, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46803335743547825, "mean_inference_ms": 1.497330412849406, "mean_action_processing_ms": 0.17649097017621546, "mean_env_wait_ms": 0.10602355214650241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026980161666870117, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.14989089965820312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5057.064148025961, "num_env_steps_trained_throughput_per_sec": 5057.064148025961, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3731.852, "sample_time_ms": 3479.819, "load_time_ms": 14.389, "load_throughput": 1250970.935, "learn_time_ms": 222.721, "learn_throughput": 80818.679, "synch_weights_time_ms": 13.267}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 603, "training_iteration": 10, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-34", "timestamp": 1698246334, "time_this_iter_s": 3.564121723175049, "time_total_s": 37.37559628486633, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 37.37559628486633, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.44000000000001, "ram_util_percent": 31.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 6.9154164552688595, "policy_loss": -0.02619042284786701, "vf_loss": 6.941665434837342, "vf_explained_var": 9.834766387939453e-08, "kl": 0.0005571141555378745, "entropy": 0.5855770647525788, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 210.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1720000000002115, "episode_len_mean": 302.28, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.90000000000002, -50.00000000000044, 31.500000000000007, 39.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.300000000000026, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 27.299999999999947, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 9.8999999999997, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, 11.099999999999717, 38.90000000000002, 43.10000000000001, 41.90000000000001, 43.10000000000001, -50.00000000000044, 43.7, 39.300000000000026, 45.7, 14.299999999999763, 0.2999999999995637, -50.00000000000044, 34.50000000000004, 37.90000000000003, 43.7, 16.499999999999794, 29.299999999999976, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 29.69999999999998, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.5, 23.8999999999999, -50.00000000000044, 44.900000000000006, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.7, 35.900000000000034, 36.30000000000003, 31.70000000000001, 35.30000000000004, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.3, 30.9, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 82, 92, 500, 186, 104, 500, 72, 500, 60, 500, 62, 500, 500, 86, 500, 128, 278, 500, 500, 500, 68, 228, 128, 500, 500, 224, 500, 500, 500, 500, 80, 402, 500, 72, 500, 78, 390, 112, 70, 82, 70, 500, 64, 108, 44, 358, 498, 500, 156, 122, 64, 336, 208, 500, 500, 94, 500, 118, 500, 62, 500, 226, 500, 500, 204, 252, 500, 500, 56, 262, 500, 52, 500, 138, 500, 500, 72, 78, 44, 142, 138, 184, 148, 58, 500, 456, 500, 500, 38, 192, 500, 50, 52, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46583310153015245, "mean_inference_ms": 1.486393013005425, "mean_action_processing_ms": 0.17530493659653232, "mean_env_wait_ms": 0.10522120404783313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04097104072570801, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12607145309448242}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1720000000002115, "episode_len_mean": 302.28, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.90000000000002, -50.00000000000044, 31.500000000000007, 39.70000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.300000000000026, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 27.299999999999947, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 9.8999999999997, -50.00000000000044, 42.900000000000006, -50.00000000000044, 42.30000000000001, 11.099999999999717, 38.90000000000002, 43.10000000000001, 41.90000000000001, 43.10000000000001, -50.00000000000044, 43.7, 39.300000000000026, 45.7, 14.299999999999763, 0.2999999999995637, -50.00000000000044, 34.50000000000004, 37.90000000000003, 43.7, 16.499999999999794, 29.299999999999976, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, 29.69999999999998, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.5, 23.8999999999999, -50.00000000000044, 44.900000000000006, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.7, 35.900000000000034, 36.30000000000003, 31.70000000000001, 35.30000000000004, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.3, 30.9, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 82, 92, 500, 186, 104, 500, 72, 500, 60, 500, 62, 500, 500, 86, 500, 128, 278, 500, 500, 500, 68, 228, 128, 500, 500, 224, 500, 500, 500, 500, 80, 402, 500, 72, 500, 78, 390, 112, 70, 82, 70, 500, 64, 108, 44, 358, 498, 500, 156, 122, 64, 336, 208, 500, 500, 94, 500, 118, 500, 62, 500, 226, 500, 500, 204, 252, 500, 500, 56, 262, 500, 52, 500, 138, 500, 500, 72, 78, 44, 142, 138, 184, 148, 58, 500, 456, 500, 500, 38, 192, 500, 50, 52, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46583310153015245, "mean_inference_ms": 1.486393013005425, "mean_action_processing_ms": 0.17530493659653232, "mean_env_wait_ms": 0.10522120404783313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04097104072570801, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12607145309448242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5236.056037246458, "num_env_steps_trained_throughput_per_sec": 5236.056037246458, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3620.413, "sample_time_ms": 3371.063, "load_time_ms": 13.509, "load_throughput": 1332448.628, "learn_time_ms": 221.424, "learn_throughput": 81291.954, "synch_weights_time_ms": 12.672}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 670, "training_iteration": 11, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-37", "timestamp": 1698246337, "time_this_iter_s": 3.4427008628845215, "time_total_s": 40.818297147750854, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.818297147750854, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 75.96, "ram_util_percent": 31.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 7.247898864746094, "policy_loss": 0.03771542124450207, "vf_loss": 7.21023576259613, "vf_explained_var": -1.290440559387207e-06, "kl": 0.0004471242753538718, "entropy": 0.5229288786649704, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 230.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.302999999999841, "episode_len_mean": 252.66, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.8999999999999, -50.00000000000044, 44.900000000000006, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.7, 35.900000000000034, 36.30000000000003, 31.70000000000001, 35.30000000000004, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.3, 30.9, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.90000000000002, 6.099999999999646, -50.00000000000044, -50.00000000000044, 38.50000000000003, 42.30000000000001, -50.00000000000044, 46.099999999999994, 45.1, 44.900000000000006, 9.699999999999697, 45.7, 39.10000000000002, -50.00000000000044, 1.4999999999995808, 45.3, 44.900000000000006, 43.10000000000001, 42.70000000000001, 15.099999999999774, 41.500000000000014, -50.00000000000044, 8.49999999999968, -50.00000000000044, 33.10000000000003, -50.00000000000044, 17.099999999999802, -50.00000000000044, 45.5, 35.900000000000034, 46.3, 39.10000000000002, 10.499999999999709, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 18.099999999999817, 33.90000000000004, 35.70000000000003, 30.29999999999999, -50.00000000000044, 42.900000000000006, 38.50000000000003, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.30000000000001, 43.900000000000006, 38.700000000000024, 21.89999999999987, 40.70000000000002, -50.00000000000044, 37.10000000000003, 41.90000000000001, 38.90000000000002, -50.00000000000044, 35.10000000000004, 45.3, 37.90000000000003, 36.900000000000034, -50.00000000000044, 38.90000000000002, 38.300000000000026], "episode_lengths": [262, 500, 52, 500, 138, 500, 500, 72, 78, 44, 142, 138, 184, 148, 58, 500, 456, 500, 500, 38, 192, 500, 50, 52, 500, 500, 500, 60, 92, 440, 500, 500, 116, 78, 500, 40, 50, 52, 404, 44, 110, 500, 486, 48, 52, 70, 74, 350, 86, 500, 416, 500, 170, 500, 330, 500, 46, 142, 38, 110, 396, 500, 80, 52, 500, 500, 500, 90, 320, 162, 144, 198, 500, 72, 116, 40, 500, 84, 500, 292, 500, 86, 500, 68, 62, 114, 282, 94, 500, 130, 82, 112, 500, 150, 48, 122, 132, 500, 112, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4618479576789069, "mean_inference_ms": 1.4750619391477482, "mean_action_processing_ms": 0.1743209312591332, "mean_env_wait_ms": 0.10364587340411056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500509262084961, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.14031362533569336}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.302999999999841, "episode_len_mean": 252.66, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.8999999999999, -50.00000000000044, 44.900000000000006, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.30000000000001, 45.7, 35.900000000000034, 36.30000000000003, 31.70000000000001, 35.30000000000004, 44.300000000000004, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.3, 30.9, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.90000000000002, 6.099999999999646, -50.00000000000044, -50.00000000000044, 38.50000000000003, 42.30000000000001, -50.00000000000044, 46.099999999999994, 45.1, 44.900000000000006, 9.699999999999697, 45.7, 39.10000000000002, -50.00000000000044, 1.4999999999995808, 45.3, 44.900000000000006, 43.10000000000001, 42.70000000000001, 15.099999999999774, 41.500000000000014, -50.00000000000044, 8.49999999999968, -50.00000000000044, 33.10000000000003, -50.00000000000044, 17.099999999999802, -50.00000000000044, 45.5, 35.900000000000034, 46.3, 39.10000000000002, 10.499999999999709, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 18.099999999999817, 33.90000000000004, 35.70000000000003, 30.29999999999999, -50.00000000000044, 42.900000000000006, 38.50000000000003, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.30000000000001, 43.900000000000006, 38.700000000000024, 21.89999999999987, 40.70000000000002, -50.00000000000044, 37.10000000000003, 41.90000000000001, 38.90000000000002, -50.00000000000044, 35.10000000000004, 45.3, 37.90000000000003, 36.900000000000034, -50.00000000000044, 38.90000000000002, 38.300000000000026], "episode_lengths": [262, 500, 52, 500, 138, 500, 500, 72, 78, 44, 142, 138, 184, 148, 58, 500, 456, 500, 500, 38, 192, 500, 50, 52, 500, 500, 500, 60, 92, 440, 500, 500, 116, 78, 500, 40, 50, 52, 404, 44, 110, 500, 486, 48, 52, 70, 74, 350, 86, 500, 416, 500, 170, 500, 330, 500, 46, 142, 38, 110, 396, 500, 80, 52, 500, 500, 500, 90, 320, 162, 144, 198, 500, 72, 116, 40, 500, 84, 500, 292, 500, 86, 500, 68, 62, 114, 282, 94, 500, 130, 82, 112, 500, 150, 48, 122, 132, 500, 112, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4618479576789069, "mean_inference_ms": 1.4750619391477482, "mean_action_processing_ms": 0.1743209312591332, "mean_env_wait_ms": 0.10364587340411056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500509262084961, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.14031362533569336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5301.710206400734, "num_env_steps_trained_throughput_per_sec": 5301.710206400734, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3576.034, "sample_time_ms": 3321.516, "load_time_ms": 13.01, "load_throughput": 1383563.666, "learn_time_ms": 226.875, "learn_throughput": 79338.795, "synch_weights_time_ms": 12.76}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 744, "training_iteration": 12, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-41", "timestamp": 1698246341, "time_this_iter_s": 3.400984764099121, "time_total_s": 44.219281911849976, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.219281911849976, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 31.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.636481261253357, "policy_loss": 0.009972728416323661, "vf_loss": 6.626561069488526, "vf_explained_var": -7.987022399902344e-07, "kl": 0.00042285320749329, "entropy": 0.524741941690445, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 250.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.998999999999851, "episode_len_mean": 245.7, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 18.099999999999817, 33.90000000000004, 35.70000000000003, 30.29999999999999, -50.00000000000044, 42.900000000000006, 38.50000000000003, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.30000000000001, 43.900000000000006, 38.700000000000024, 21.89999999999987, 40.70000000000002, -50.00000000000044, 37.10000000000003, 41.90000000000001, 38.90000000000002, -50.00000000000044, 35.10000000000004, 45.3, 37.90000000000003, 36.900000000000034, -50.00000000000044, 38.90000000000002, 38.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 2.8999999999996007, -50.00000000000044, 47.3, 42.70000000000001, 40.30000000000002, 37.300000000000026, 4.299999999999621, 35.900000000000034, 44.10000000000001, 24.099999999999902, -50.00000000000044, 33.10000000000003, 34.10000000000004, 41.100000000000016, -50.00000000000044, 40.500000000000014, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.900000000000006, 31.300000000000004, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 36.50000000000003, 45.9, 26.69999999999994, -50.00000000000044, 47.5, 39.90000000000002, 42.500000000000014, 30.499999999999993, -50.00000000000044, 44.300000000000004, 24.099999999999902, 46.099999999999994, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, 38.90000000000002, 47.3, 21.299999999999862, -50.00000000000044, 34.900000000000034, 44.900000000000006], "episode_lengths": [90, 320, 162, 144, 198, 500, 72, 116, 40, 500, 84, 500, 292, 500, 86, 500, 68, 62, 114, 282, 94, 500, 130, 82, 112, 500, 150, 48, 122, 132, 500, 112, 118, 500, 56, 500, 500, 68, 42, 472, 500, 28, 74, 98, 128, 458, 142, 60, 260, 500, 170, 160, 90, 500, 96, 86, 96, 500, 500, 500, 136, 62, 188, 82, 70, 500, 500, 500, 500, 88, 500, 98, 500, 132, 500, 500, 294, 136, 42, 234, 500, 26, 102, 76, 196, 500, 58, 260, 40, 500, 42, 262, 500, 500, 112, 28, 288, 500, 152, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46015071891846593, "mean_inference_ms": 1.4705039407031626, "mean_action_processing_ms": 0.17355394895638143, "mean_env_wait_ms": 0.10315067603719427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.01201009750366211, "ViewRequirementAgentConnector_ms": 0.15111541748046875}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.998999999999851, "episode_len_mean": 245.7, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 18.099999999999817, 33.90000000000004, 35.70000000000003, 30.29999999999999, -50.00000000000044, 42.900000000000006, 38.50000000000003, 46.099999999999994, -50.00000000000044, 41.70000000000002, -50.00000000000044, 20.899999999999856, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.30000000000001, 43.900000000000006, 38.700000000000024, 21.89999999999987, 40.70000000000002, -50.00000000000044, 37.10000000000003, 41.90000000000001, 38.90000000000002, -50.00000000000044, 35.10000000000004, 45.3, 37.90000000000003, 36.900000000000034, -50.00000000000044, 38.90000000000002, 38.300000000000026, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 2.8999999999996007, -50.00000000000044, 47.3, 42.70000000000001, 40.30000000000002, 37.300000000000026, 4.299999999999621, 35.900000000000034, 44.10000000000001, 24.099999999999902, -50.00000000000044, 33.10000000000003, 34.10000000000004, 41.100000000000016, -50.00000000000044, 40.500000000000014, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.900000000000006, 31.300000000000004, 41.90000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 36.50000000000003, 45.9, 26.69999999999994, -50.00000000000044, 47.5, 39.90000000000002, 42.500000000000014, 30.499999999999993, -50.00000000000044, 44.300000000000004, 24.099999999999902, 46.099999999999994, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, 38.90000000000002, 47.3, 21.299999999999862, -50.00000000000044, 34.900000000000034, 44.900000000000006], "episode_lengths": [90, 320, 162, 144, 198, 500, 72, 116, 40, 500, 84, 500, 292, 500, 86, 500, 68, 62, 114, 282, 94, 500, 130, 82, 112, 500, 150, 48, 122, 132, 500, 112, 118, 500, 56, 500, 500, 68, 42, 472, 500, 28, 74, 98, 128, 458, 142, 60, 260, 500, 170, 160, 90, 500, 96, 86, 96, 500, 500, 500, 136, 62, 188, 82, 70, 500, 500, 500, 500, 88, 500, 98, 500, 132, 500, 500, 294, 136, 42, 234, 500, 26, 102, 76, 196, 500, 58, 260, 40, 500, 42, 262, 500, 500, 112, 28, 288, 500, 152, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46015071891846593, "mean_inference_ms": 1.4705039407031626, "mean_action_processing_ms": 0.17355394895638143, "mean_env_wait_ms": 0.10315067603719427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029003143310546875, "StateBufferConnector_ms": 0.01201009750366211, "ViewRequirementAgentConnector_ms": 0.15111541748046875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5036.623953331148, "num_env_steps_trained_throughput_per_sec": 5036.623953331148, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3567.224, "sample_time_ms": 3316.822, "load_time_ms": 12.815, "load_throughput": 1404643.33, "learn_time_ms": 223.616, "learn_throughput": 80495.288, "synch_weights_time_ms": 12.144}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 811, "training_iteration": 13, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-44", "timestamp": 1698246344, "time_this_iter_s": 3.5797438621520996, "time_total_s": 47.799025774002075, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.799025774002075, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 78.38, "ram_util_percent": 31.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.520078372955322, "policy_loss": 0.05557880848646164, "vf_loss": 6.4645479917526245, "vf_explained_var": -1.6629695892333984e-06, "kl": 0.00013000684833457398, "entropy": 0.4830427020788193, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 270.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.955999999999824, "episode_len_mean": 261.06, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 36.50000000000003, 45.9, 26.69999999999994, -50.00000000000044, 47.5, 39.90000000000002, 42.500000000000014, 30.499999999999993, -50.00000000000044, 44.300000000000004, 24.099999999999902, 46.099999999999994, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, 38.90000000000002, 47.3, 21.299999999999862, -50.00000000000044, 34.900000000000034, 44.900000000000006, 35.10000000000004, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.099999999999994, 39.50000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, 42.900000000000006, 44.7, 28.89999999999997, 30.699999999999996, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.5, -50.00000000000044, 44.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 38.300000000000026, -50.00000000000044, 14.09999999999976, 40.70000000000002, 42.70000000000001, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.699999999999683, 31.500000000000007, -50.00000000000044, 39.10000000000002, 38.90000000000002, 21.699999999999868, 43.900000000000006], "episode_lengths": [88, 500, 98, 500, 132, 500, 500, 294, 136, 42, 234, 500, 26, 102, 76, 196, 500, 58, 260, 40, 500, 42, 262, 500, 500, 112, 28, 288, 500, 152, 52, 150, 500, 500, 112, 40, 106, 68, 500, 500, 218, 500, 62, 500, 500, 34, 68, 72, 54, 212, 194, 148, 500, 48, 500, 50, 500, 60, 500, 500, 500, 54, 46, 500, 56, 60, 500, 500, 500, 50, 72, 500, 46, 500, 52, 100, 500, 500, 500, 68, 500, 500, 130, 118, 500, 360, 94, 74, 40, 52, 500, 52, 500, 414, 186, 500, 110, 112, 284, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4593676368806653, "mean_inference_ms": 1.4655212753671256, "mean_action_processing_ms": 0.1722708292025492, "mean_env_wait_ms": 0.10276556769921086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.12698984146118164}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.955999999999824, "episode_len_mean": 261.06, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 20.699999999999854, 36.50000000000003, 45.9, 26.69999999999994, -50.00000000000044, 47.5, 39.90000000000002, 42.500000000000014, 30.499999999999993, -50.00000000000044, 44.300000000000004, 24.099999999999902, 46.099999999999994, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, 38.90000000000002, 47.3, 21.299999999999862, -50.00000000000044, 34.900000000000034, 44.900000000000006, 35.10000000000004, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.099999999999994, 39.50000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.30000000000001, 42.900000000000006, 44.7, 28.89999999999997, 30.699999999999996, 35.30000000000004, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.5, -50.00000000000044, 44.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 38.300000000000026, -50.00000000000044, 14.09999999999976, 40.70000000000002, 42.70000000000001, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.699999999999683, 31.500000000000007, -50.00000000000044, 39.10000000000002, 38.90000000000002, 21.699999999999868, 43.900000000000006], "episode_lengths": [88, 500, 98, 500, 132, 500, 500, 294, 136, 42, 234, 500, 26, 102, 76, 196, 500, 58, 260, 40, 500, 42, 262, 500, 500, 112, 28, 288, 500, 152, 52, 150, 500, 500, 112, 40, 106, 68, 500, 500, 218, 500, 62, 500, 500, 34, 68, 72, 54, 212, 194, 148, 500, 48, 500, 50, 500, 60, 500, 500, 500, 54, 46, 500, 56, 60, 500, 500, 500, 50, 72, 500, 46, 500, 52, 100, 500, 500, 500, 68, 500, 500, 130, 118, 500, 360, 94, 74, 40, 52, 500, 52, 500, 414, 186, 500, 110, 112, 284, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4593676368806653, "mean_inference_ms": 1.4655212753671256, "mean_action_processing_ms": 0.1722708292025492, "mean_env_wait_ms": 0.10276556769921086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.12698984146118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5141.642487652153, "num_env_steps_trained_throughput_per_sec": 5141.642487652153, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3549.109, "sample_time_ms": 3297.638, "load_time_ms": 13.615, "load_throughput": 1322100.161, "learn_time_ms": 224.039, "learn_throughput": 80343.272, "synch_weights_time_ms": 12.19}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 880, "training_iteration": 14, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-48", "timestamp": 1698246348, "time_this_iter_s": 3.5076794624328613, "time_total_s": 51.30670523643494, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.30670523643494, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 74.24000000000001, "ram_util_percent": 31.080000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.517329978942871, "policy_loss": -0.008882040530443192, "vf_loss": 6.526261401176453, "vf_explained_var": -1.0848045349121093e-06, "kl": 0.00039434784689493794, "entropy": 0.49366341084241866, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 290.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.957999999999847, "episode_len_mean": 241.08, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 38.300000000000026, -50.00000000000044, 14.09999999999976, 40.70000000000002, 42.70000000000001, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.699999999999683, 31.500000000000007, -50.00000000000044, 39.10000000000002, 38.90000000000002, 21.699999999999868, 43.900000000000006, 32.700000000000024, 45.3, 46.3, 35.10000000000004, 45.1, 46.9, 41.70000000000002, -50.00000000000044, 44.10000000000001, 40.90000000000002, 36.70000000000003, 22.699999999999882, -50.00000000000044, -50.00000000000044, 33.70000000000004, 42.10000000000001, 45.5, -50.00000000000044, 40.500000000000014, 35.10000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, -50.00000000000044, 35.70000000000003, 47.1, -50.00000000000044, 37.10000000000003, 43.50000000000001, 45.7, -50.00000000000044, 34.70000000000004, 32.700000000000024, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, 46.099999999999994, 45.1, -50.00000000000044, 12.499999999999737, 42.500000000000014, 46.099999999999994, 45.1, 44.5, 34.900000000000034, -50.00000000000044, 40.10000000000002, 45.7, 43.50000000000001, -50.00000000000044, 33.70000000000004], "episode_lengths": [72, 500, 46, 500, 52, 100, 500, 500, 500, 68, 500, 500, 130, 118, 500, 360, 94, 74, 40, 52, 500, 52, 500, 414, 186, 500, 110, 112, 284, 62, 174, 48, 38, 150, 50, 32, 84, 500, 60, 92, 134, 274, 500, 500, 164, 80, 46, 500, 96, 150, 246, 500, 500, 94, 34, 500, 50, 500, 500, 130, 500, 68, 46, 500, 500, 500, 500, 68, 38, 500, 144, 30, 500, 130, 66, 44, 500, 154, 174, 500, 110, 500, 78, 500, 92, 40, 50, 500, 376, 76, 40, 50, 56, 152, 500, 100, 44, 66, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4587165339729141, "mean_inference_ms": 1.4589957986398168, "mean_action_processing_ms": 0.17150546483413087, "mean_env_wait_ms": 0.10248900579385271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004812240600586, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.13302016258239746}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.957999999999847, "episode_len_mean": 241.08, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 44.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 38.300000000000026, -50.00000000000044, 14.09999999999976, 40.70000000000002, 42.70000000000001, 46.099999999999994, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 8.699999999999683, 31.500000000000007, -50.00000000000044, 39.10000000000002, 38.90000000000002, 21.699999999999868, 43.900000000000006, 32.700000000000024, 45.3, 46.3, 35.10000000000004, 45.1, 46.9, 41.70000000000002, -50.00000000000044, 44.10000000000001, 40.90000000000002, 36.70000000000003, 22.699999999999882, -50.00000000000044, -50.00000000000044, 33.70000000000004, 42.10000000000001, 45.5, -50.00000000000044, 40.500000000000014, 35.10000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 43.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, -50.00000000000044, 35.70000000000003, 47.1, -50.00000000000044, 37.10000000000003, 43.50000000000001, 45.7, -50.00000000000044, 34.70000000000004, 32.700000000000024, -50.00000000000044, 39.10000000000002, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, 46.099999999999994, 45.1, -50.00000000000044, 12.499999999999737, 42.500000000000014, 46.099999999999994, 45.1, 44.5, 34.900000000000034, -50.00000000000044, 40.10000000000002, 45.7, 43.50000000000001, -50.00000000000044, 33.70000000000004], "episode_lengths": [72, 500, 46, 500, 52, 100, 500, 500, 500, 68, 500, 500, 130, 118, 500, 360, 94, 74, 40, 52, 500, 52, 500, 414, 186, 500, 110, 112, 284, 62, 174, 48, 38, 150, 50, 32, 84, 500, 60, 92, 134, 274, 500, 500, 164, 80, 46, 500, 96, 150, 246, 500, 500, 94, 34, 500, 50, 500, 500, 130, 500, 68, 46, 500, 500, 500, 500, 68, 38, 500, 144, 30, 500, 130, 66, 44, 500, 154, 174, 500, 110, 500, 78, 500, 92, 40, 50, 500, 376, 76, 40, 50, 56, 152, 500, 100, 44, 66, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4587165339729141, "mean_inference_ms": 1.4589957986398168, "mean_action_processing_ms": 0.17150546483413087, "mean_env_wait_ms": 0.10248900579385271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004812240600586, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.13302016258239746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4686.887258211375, "num_env_steps_trained_throughput_per_sec": 4686.887258211375, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3565.422, "sample_time_ms": 3274.002, "load_time_ms": 15.638, "load_throughput": 1151044.543, "learn_time_ms": 260.966, "learn_throughput": 68974.454, "synch_weights_time_ms": 13.189}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 950, "training_iteration": 15, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-52", "timestamp": 1698246352, "time_this_iter_s": 3.848052501678467, "time_total_s": 55.1547577381134, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.1547577381134, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 74.4, "ram_util_percent": 31.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.803668093681336, "policy_loss": -0.009107542783021927, "vf_loss": 6.812824249267578, "vf_explained_var": -4.291534423828125e-07, "kl": 0.00016482011486118608, "entropy": 0.486924347281456, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 310.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.314999999999854, "episode_len_mean": 222.52, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.499999999999737, 42.500000000000014, 46.099999999999994, 45.1, 44.5, 34.900000000000034, -50.00000000000044, 40.10000000000002, 45.7, 43.50000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 46.5, 37.90000000000003, 44.5, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 37.90000000000003, 46.099999999999994, -50.00000000000044, 39.70000000000002, 17.899999999999814, 46.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 41.100000000000016, 32.100000000000016, -50.00000000000044, 44.900000000000006, 46.3, 42.30000000000001, 27.099999999999945, 44.5, 43.50000000000001, 44.300000000000004, -50.00000000000044, 43.900000000000006, 36.10000000000004, 47.3, 30.499999999999993, -50.00000000000044, 45.9, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.50000000000001, 45.5, 44.7, 44.300000000000004, 42.900000000000006, 40.70000000000002, -50.00000000000044, 44.10000000000001, 40.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.3, 38.90000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 45.1, 40.500000000000014, -50.00000000000044, 45.5, 45.5], "episode_lengths": [500, 376, 76, 40, 50, 56, 152, 500, 100, 44, 66, 500, 164, 500, 36, 122, 56, 60, 500, 62, 500, 500, 48, 500, 46, 122, 40, 500, 104, 322, 32, 500, 500, 58, 500, 80, 500, 36, 500, 40, 90, 180, 500, 52, 38, 78, 230, 56, 66, 58, 500, 62, 140, 28, 196, 500, 42, 54, 44, 500, 500, 66, 66, 46, 54, 58, 72, 94, 500, 60, 94, 500, 62, 500, 52, 500, 500, 66, 500, 500, 198, 500, 48, 112, 58, 58, 500, 500, 500, 124, 124, 500, 500, 94, 106, 50, 96, 500, 46, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4638929508110246, "mean_inference_ms": 1.4769995661653703, "mean_action_processing_ms": 0.17511197349841087, "mean_env_wait_ms": 0.10342487809543234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353391170501709, "StateBufferConnector_ms": 0.007992267608642578, "ViewRequirementAgentConnector_ms": 0.19858813285827637}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.314999999999854, "episode_len_mean": 222.52, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.499999999999737, 42.500000000000014, 46.099999999999994, 45.1, 44.5, 34.900000000000034, -50.00000000000044, 40.10000000000002, 45.7, 43.50000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, 46.5, 37.90000000000003, 44.5, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 37.90000000000003, 46.099999999999994, -50.00000000000044, 39.70000000000002, 17.899999999999814, 46.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 41.100000000000016, 32.100000000000016, -50.00000000000044, 44.900000000000006, 46.3, 42.30000000000001, 27.099999999999945, 44.5, 43.50000000000001, 44.300000000000004, -50.00000000000044, 43.900000000000006, 36.10000000000004, 47.3, 30.499999999999993, -50.00000000000044, 45.9, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.50000000000001, 45.5, 44.7, 44.300000000000004, 42.900000000000006, 40.70000000000002, -50.00000000000044, 44.10000000000001, 40.70000000000002, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.3, 38.90000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 45.1, 40.500000000000014, -50.00000000000044, 45.5, 45.5], "episode_lengths": [500, 376, 76, 40, 50, 56, 152, 500, 100, 44, 66, 500, 164, 500, 36, 122, 56, 60, 500, 62, 500, 500, 48, 500, 46, 122, 40, 500, 104, 322, 32, 500, 500, 58, 500, 80, 500, 36, 500, 40, 90, 180, 500, 52, 38, 78, 230, 56, 66, 58, 500, 62, 140, 28, 196, 500, 42, 54, 44, 500, 500, 66, 66, 46, 54, 58, 72, 94, 500, 60, 94, 500, 62, 500, 52, 500, 500, 66, 500, 500, 198, 500, 48, 112, 58, 58, 500, 500, 500, 124, 124, 500, 500, 94, 106, 50, 96, 500, 46, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4638929508110246, "mean_inference_ms": 1.4769995661653703, "mean_action_processing_ms": 0.17511197349841087, "mean_env_wait_ms": 0.10342487809543234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353391170501709, "StateBufferConnector_ms": 0.007992267608642578, "ViewRequirementAgentConnector_ms": 0.19858813285827637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3678.5062990804695, "num_env_steps_trained_throughput_per_sec": 3678.5062990804695, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3691.6, "sample_time_ms": 3364.842, "load_time_ms": 17.49, "load_throughput": 1029177.435, "learn_time_ms": 293.892, "learn_throughput": 61247.073, "synch_weights_time_ms": 13.808}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1037, "training_iteration": 16, "trial_id": "9f288_00007", "date": "2023-10-25_16-05-57", "timestamp": 1698246357, "time_this_iter_s": 4.89923095703125, "time_total_s": 60.05398869514465, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.05398869514465, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 86.91428571428573, "ram_util_percent": 30.928571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.787461137771606, "policy_loss": 0.00932268677279353, "vf_loss": 6.778189015388489, "vf_explained_var": -5.573034286499023e-07, "kl": 0.00018176321127345575, "entropy": 0.5043068826198578, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 330.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.773999999999833, "episode_len_mean": 242.9, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.3, 38.90000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 45.1, 40.500000000000014, -50.00000000000044, 45.5, 45.5, 30.9, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 20.299999999999848, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 37.10000000000003, 41.30000000000001, -50.00000000000044, 43.50000000000001, 39.300000000000026, 29.899999999999984, -50.00000000000044, 44.5, 37.90000000000003, 46.699999999999996, 45.5, 46.5, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 3.699999999999612, 46.5, 38.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 46.9, 33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 24.69999999999991, 44.7, -50.00000000000044, 40.500000000000014, 32.50000000000002, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.90000000000002, 45.7, 45.7, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 41.30000000000001], "episode_lengths": [500, 66, 500, 500, 198, 500, 48, 112, 58, 58, 500, 500, 500, 124, 124, 500, 500, 94, 106, 50, 96, 500, 46, 46, 192, 30, 60, 500, 500, 500, 46, 298, 500, 58, 44, 500, 130, 88, 500, 66, 108, 202, 500, 56, 122, 34, 46, 36, 78, 68, 500, 500, 48, 500, 50, 500, 58, 464, 36, 112, 66, 500, 500, 414, 500, 32, 166, 36, 500, 500, 48, 34, 500, 500, 88, 500, 500, 66, 56, 254, 54, 500, 96, 176, 42, 38, 500, 500, 62, 112, 44, 44, 40, 380, 500, 500, 500, 52, 46, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46851260132850164, "mean_inference_ms": 1.497433483359286, "mean_action_processing_ms": 0.17672681066987705, "mean_env_wait_ms": 0.10521607351240807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04393410682678223, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.1974811553955078}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.773999999999833, "episode_len_mean": 242.9, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.3, 38.90000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 45.1, 40.500000000000014, -50.00000000000044, 45.5, 45.5, 30.9, 47.1, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 20.299999999999848, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 37.10000000000003, 41.30000000000001, -50.00000000000044, 43.50000000000001, 39.300000000000026, 29.899999999999984, -50.00000000000044, 44.5, 37.90000000000003, 46.699999999999996, 45.5, 46.5, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 3.699999999999612, 46.5, 38.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 46.9, 33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 24.69999999999991, 44.7, -50.00000000000044, 40.500000000000014, 32.50000000000002, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.90000000000002, 45.7, 45.7, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 41.30000000000001], "episode_lengths": [500, 66, 500, 500, 198, 500, 48, 112, 58, 58, 500, 500, 500, 124, 124, 500, 500, 94, 106, 50, 96, 500, 46, 46, 192, 30, 60, 500, 500, 500, 46, 298, 500, 58, 44, 500, 130, 88, 500, 66, 108, 202, 500, 56, 122, 34, 46, 36, 78, 68, 500, 500, 48, 500, 50, 500, 58, 464, 36, 112, 66, 500, 500, 414, 500, 32, 166, 36, 500, 500, 48, 34, 500, 500, 88, 500, 500, 66, 56, 254, 54, 500, 96, 176, 42, 38, 500, 500, 62, 112, 44, 44, 40, 380, 500, 500, 500, 52, 46, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46851260132850164, "mean_inference_ms": 1.497433483359286, "mean_action_processing_ms": 0.17672681066987705, "mean_env_wait_ms": 0.10521607351240807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04393410682678223, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.1974811553955078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3600.627531701487, "num_env_steps_trained_throughput_per_sec": 3600.627531701487, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3825.755, "sample_time_ms": 3454.357, "load_time_ms": 19.609, "load_throughput": 917939.224, "learn_time_ms": 336.995, "learn_throughput": 53413.194, "synch_weights_time_ms": 13.324}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1113, "training_iteration": 17, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-02", "timestamp": 1698246362, "time_this_iter_s": 5.007035732269287, "time_total_s": 65.06102442741394, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.06102442741394, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 83.6, "ram_util_percent": 30.914285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.352949905395508, "policy_loss": -0.02233007997274399, "vf_loss": 6.37533164024353, "vf_explained_var": -1.9609928131103515e-06, "kl": 0.0001307117581120565, "entropy": 0.517678314447403, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 350.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.06099999999982, "episode_len_mean": 255.02, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 24.69999999999991, 44.7, -50.00000000000044, 40.500000000000014, 32.50000000000002, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.90000000000002, 45.7, 45.7, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 41.30000000000001, 9.299999999999692, -50.00000000000044, 21.09999999999986, 43.900000000000006, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.7, 44.900000000000006, 2.8999999999996007, 27.099999999999945, 45.1, 45.1, 46.099999999999994, -50.00000000000044, 45.5, 47.3, 23.099999999999888, -50.00000000000044, 33.70000000000004, -50.00000000000044, 46.699999999999996, 45.7, 37.300000000000026, 44.5, 44.900000000000006, 32.30000000000002, 42.10000000000001, 42.900000000000006, 45.3, 13.699999999999754, -50.00000000000044, 43.900000000000006, 10.899999999999714, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 34.50000000000004, -50.00000000000044], "episode_lengths": [166, 36, 500, 500, 48, 34, 500, 500, 88, 500, 500, 66, 56, 254, 54, 500, 96, 176, 42, 38, 500, 500, 62, 112, 44, 44, 40, 380, 500, 500, 500, 52, 46, 88, 408, 500, 290, 62, 40, 500, 62, 500, 86, 500, 500, 124, 500, 500, 58, 500, 86, 500, 500, 36, 500, 500, 52, 64, 52, 472, 230, 50, 50, 40, 500, 46, 28, 270, 500, 164, 500, 34, 44, 128, 56, 52, 178, 80, 72, 48, 364, 500, 62, 392, 72, 500, 500, 500, 60, 500, 500, 52, 500, 224, 500, 500, 82, 54, 156, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47153994176183617, "mean_inference_ms": 1.5016362560067242, "mean_action_processing_ms": 0.17692362046534907, "mean_env_wait_ms": 0.10616234778798794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03305387496948242, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.19396424293518066}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.06099999999982, "episode_len_mean": 255.02, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.5, 24.69999999999991, 44.7, -50.00000000000044, 40.500000000000014, 32.50000000000002, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, 38.90000000000002, 45.7, 45.7, 46.099999999999994, 12.099999999999731, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.5, 41.30000000000001, 9.299999999999692, -50.00000000000044, 21.09999999999986, 43.900000000000006, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.7, 44.900000000000006, 2.8999999999996007, 27.099999999999945, 45.1, 45.1, 46.099999999999994, -50.00000000000044, 45.5, 47.3, 23.099999999999888, -50.00000000000044, 33.70000000000004, -50.00000000000044, 46.699999999999996, 45.7, 37.300000000000026, 44.5, 44.900000000000006, 32.30000000000002, 42.10000000000001, 42.900000000000006, 45.3, 13.699999999999754, -50.00000000000044, 43.900000000000006, 10.899999999999714, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 34.50000000000004, -50.00000000000044], "episode_lengths": [166, 36, 500, 500, 48, 34, 500, 500, 88, 500, 500, 66, 56, 254, 54, 500, 96, 176, 42, 38, 500, 500, 62, 112, 44, 44, 40, 380, 500, 500, 500, 52, 46, 88, 408, 500, 290, 62, 40, 500, 62, 500, 86, 500, 500, 124, 500, 500, 58, 500, 86, 500, 500, 36, 500, 500, 52, 64, 52, 472, 230, 50, 50, 40, 500, 46, 28, 270, 500, 164, 500, 34, 44, 128, 56, 52, 178, 80, 72, 48, 364, 500, 62, 392, 72, 500, 500, 500, 60, 500, 500, 52, 500, 224, 500, 500, 82, 54, 156, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47153994176183617, "mean_inference_ms": 1.5016362560067242, "mean_action_processing_ms": 0.17692362046534907, "mean_env_wait_ms": 0.10616234778798794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03305387496948242, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.19396424293518066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4601.034700703031, "num_env_steps_trained_throughput_per_sec": 4601.034700703031, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3859.948, "sample_time_ms": 3474.861, "load_time_ms": 21.093, "load_throughput": 853347.801, "learn_time_ms": 348.827, "learn_throughput": 51601.57, "synch_weights_time_ms": 13.698}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1179, "training_iteration": 18, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-06", "timestamp": 1698246366, "time_this_iter_s": 3.9184463024139404, "time_total_s": 68.97947072982788, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.97947072982788, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 72.58333333333333, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.895106863975525, "policy_loss": -0.06533385887742042, "vf_loss": 6.96049177646637, "vf_explained_var": -4.0829181671142576e-07, "kl": 0.00038906314265716444, "entropy": 0.5114094451069832, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 370.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.100999999999824, "episode_len_mean": 254.62, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 45.7, 37.300000000000026, 44.5, 44.900000000000006, 32.30000000000002, 42.10000000000001, 42.900000000000006, 45.3, 13.699999999999754, -50.00000000000044, 43.900000000000006, 10.899999999999714, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.70000000000002, 27.099999999999945, 37.90000000000003, 46.699999999999996, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 41.70000000000002, 42.10000000000001, 32.50000000000002, -50.00000000000044, 30.699999999999996, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.70000000000003, -50.00000000000044, 46.699999999999996, 43.900000000000006, 42.900000000000006, 40.90000000000002, 44.10000000000001, 45.1, 16.09999999999979, 44.900000000000006, 32.50000000000002, 45.9, 42.900000000000006, 40.30000000000002, -50.00000000000044, 46.099999999999994, 44.900000000000006, 43.10000000000001, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 36.70000000000003, -50.00000000000044, 23.099999999999888, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [34, 44, 128, 56, 52, 178, 80, 72, 48, 364, 500, 62, 392, 72, 500, 500, 500, 60, 500, 500, 52, 500, 224, 500, 500, 82, 54, 156, 500, 500, 500, 500, 500, 58, 84, 230, 122, 34, 38, 78, 500, 500, 36, 500, 156, 500, 48, 500, 98, 500, 44, 70, 500, 500, 30, 84, 80, 176, 500, 194, 56, 74, 500, 500, 500, 64, 144, 500, 34, 62, 72, 92, 60, 50, 340, 52, 176, 42, 72, 98, 500, 40, 52, 70, 466, 500, 500, 500, 56, 500, 444, 134, 500, 270, 500, 34, 500, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47131519900065866, "mean_inference_ms": 1.497962078531333, "mean_action_processing_ms": 0.17661159254546432, "mean_env_wait_ms": 0.10600691565686787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995317459106445, "StateBufferConnector_ms": 0.011003732681274414, "ViewRequirementAgentConnector_ms": 0.15486931800842285}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.100999999999824, "episode_len_mean": 254.62, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 45.7, 37.300000000000026, 44.5, 44.900000000000006, 32.30000000000002, 42.10000000000001, 42.900000000000006, 45.3, 13.699999999999754, -50.00000000000044, 43.900000000000006, 10.899999999999714, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.7, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.70000000000002, 27.099999999999945, 37.90000000000003, 46.699999999999996, 46.3, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.3, -50.00000000000044, 40.30000000000002, -50.00000000000044, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 41.70000000000002, 42.10000000000001, 32.50000000000002, -50.00000000000044, 30.699999999999996, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 35.70000000000003, -50.00000000000044, 46.699999999999996, 43.900000000000006, 42.900000000000006, 40.90000000000002, 44.10000000000001, 45.1, 16.09999999999979, 44.900000000000006, 32.50000000000002, 45.9, 42.900000000000006, 40.30000000000002, -50.00000000000044, 46.099999999999994, 44.900000000000006, 43.10000000000001, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 36.70000000000003, -50.00000000000044, 23.099999999999888, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [34, 44, 128, 56, 52, 178, 80, 72, 48, 364, 500, 62, 392, 72, 500, 500, 500, 60, 500, 500, 52, 500, 224, 500, 500, 82, 54, 156, 500, 500, 500, 500, 500, 58, 84, 230, 122, 34, 38, 78, 500, 500, 36, 500, 156, 500, 48, 500, 98, 500, 44, 70, 500, 500, 30, 84, 80, 176, 500, 194, 56, 74, 500, 500, 500, 64, 144, 500, 34, 62, 72, 92, 60, 50, 340, 52, 176, 42, 72, 98, 500, 40, 52, 70, 466, 500, 500, 500, 56, 500, 444, 134, 500, 270, 500, 34, 500, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47131519900065866, "mean_inference_ms": 1.497962078531333, "mean_action_processing_ms": 0.17661159254546432, "mean_env_wait_ms": 0.10600691565686787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995317459106445, "StateBufferConnector_ms": 0.011003732681274414, "ViewRequirementAgentConnector_ms": 0.15486931800842285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4743.6440737869325, "num_env_steps_trained_throughput_per_sec": 4743.6440737869325, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3890.45, "sample_time_ms": 3478.978, "load_time_ms": 23.293, "load_throughput": 772753.459, "learn_time_ms": 373.024, "learn_throughput": 48254.248, "synch_weights_time_ms": 13.685}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1250, "training_iteration": 19, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-09", "timestamp": 1698246369, "time_this_iter_s": 3.800549268722534, "time_total_s": 72.78001999855042, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.78001999855042, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 73.2, "ram_util_percent": 30.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.549436950683594, "policy_loss": -0.04796892590820789, "vf_loss": 6.597456216812134, "vf_explained_var": 5.21540641784668e-07, "kl": 0.00017415963226596887, "entropy": 0.5032240107655526, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 390.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.122999999999811, "episode_len_mean": 264.38, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 35.70000000000003, -50.00000000000044, 46.699999999999996, 43.900000000000006, 42.900000000000006, 40.90000000000002, 44.10000000000001, 45.1, 16.09999999999979, 44.900000000000006, 32.50000000000002, 45.9, 42.900000000000006, 40.30000000000002, -50.00000000000044, 46.099999999999994, 44.900000000000006, 43.10000000000001, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 36.70000000000003, -50.00000000000044, 23.099999999999888, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, 46.3, 40.10000000000002, 40.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 37.90000000000003, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 42.30000000000001, 33.10000000000003, -50.00000000000044, 17.69999999999981, -50.00000000000044, 19.499999999999837, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 45.5, 6.299999999999649, -50.00000000000044, 46.3, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 43.7, 43.10000000000001, 40.70000000000002, 45.3, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 144, 500, 34, 62, 72, 92, 60, 50, 340, 52, 176, 42, 72, 98, 500, 40, 52, 70, 466, 500, 500, 500, 56, 500, 444, 134, 500, 270, 500, 34, 500, 38, 500, 500, 500, 500, 148, 500, 500, 500, 46, 66, 38, 100, 94, 500, 82, 500, 40, 122, 38, 500, 146, 500, 500, 78, 170, 500, 324, 500, 306, 68, 40, 500, 500, 78, 56, 46, 438, 500, 38, 268, 62, 500, 500, 500, 66, 34, 500, 80, 500, 500, 500, 66, 88, 64, 70, 94, 48, 500, 26, 82, 500, 308, 500, 58, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47021099954565576, "mean_inference_ms": 1.4983245580978204, "mean_action_processing_ms": 0.17586519806576922, "mean_env_wait_ms": 0.1058545163989355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699994087219238, "StateBufferConnector_ms": 0.013998985290527344, "ViewRequirementAgentConnector_ms": 0.14414000511169434}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.122999999999811, "episode_len_mean": 264.38, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 35.70000000000003, -50.00000000000044, 46.699999999999996, 43.900000000000006, 42.900000000000006, 40.90000000000002, 44.10000000000001, 45.1, 16.09999999999979, 44.900000000000006, 32.50000000000002, 45.9, 42.900000000000006, 40.30000000000002, -50.00000000000044, 46.099999999999994, 44.900000000000006, 43.10000000000001, 3.499999999999609, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 36.70000000000003, -50.00000000000044, 23.099999999999888, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, 46.3, 40.10000000000002, 40.70000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 37.90000000000003, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 42.30000000000001, 33.10000000000003, -50.00000000000044, 17.69999999999981, -50.00000000000044, 19.499999999999837, 43.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 45.5, 6.299999999999649, -50.00000000000044, 46.3, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 43.7, 43.10000000000001, 40.70000000000002, 45.3, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 144, 500, 34, 62, 72, 92, 60, 50, 340, 52, 176, 42, 72, 98, 500, 40, 52, 70, 466, 500, 500, 500, 56, 500, 444, 134, 500, 270, 500, 34, 500, 38, 500, 500, 500, 500, 148, 500, 500, 500, 46, 66, 38, 100, 94, 500, 82, 500, 40, 122, 38, 500, 146, 500, 500, 78, 170, 500, 324, 500, 306, 68, 40, 500, 500, 78, 56, 46, 438, 500, 38, 268, 62, 500, 500, 500, 66, 34, 500, 80, 500, 500, 500, 66, 88, 64, 70, 94, 48, 500, 26, 82, 500, 308, 500, 58, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47021099954565576, "mean_inference_ms": 1.4983245580978204, "mean_action_processing_ms": 0.17586519806576922, "mean_env_wait_ms": 0.1058545163989355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699994087219238, "StateBufferConnector_ms": 0.013998985290527344, "ViewRequirementAgentConnector_ms": 0.14414000511169434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4493.481228374398, "num_env_steps_trained_throughput_per_sec": 4493.481228374398, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3935.192, "sample_time_ms": 3496.593, "load_time_ms": 26.131, "load_throughput": 688829.835, "learn_time_ms": 396.784, "learn_throughput": 45364.752, "synch_weights_time_ms": 14.114}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1315, "training_iteration": 20, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-13", "timestamp": 1698246373, "time_this_iter_s": 4.011801242828369, "time_total_s": 76.79182124137878, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.79182124137878, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 70.18333333333334, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.395077800750732, "policy_loss": 0.014309585932642222, "vf_loss": 6.380821967124939, "vf_explained_var": -9.119510650634766e-07, "kl": 0.0004764416232092117, "entropy": 0.5362197116017342, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 410.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.760999999999811, "episode_len_mean": 267.98, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 6.299999999999649, -50.00000000000044, 46.3, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 43.7, 43.10000000000001, 40.70000000000002, 45.3, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 21.299999999999862, -50.00000000000044, 45.5, 30.29999999999999, 32.30000000000002, 47.1, -50.00000000000044, 28.89999999999997, -50.00000000000044, 46.5, 44.900000000000006, 44.300000000000004, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.70000000000004, 39.50000000000002, 42.500000000000014, 46.5, 44.300000000000004, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, 43.50000000000001, 34.50000000000004, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, 29.099999999999973, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 47.5, -50.00000000000044, 40.30000000000002, 44.5, 44.7, 46.9, -50.00000000000044, 44.5], "episode_lengths": [46, 438, 500, 38, 268, 62, 500, 500, 500, 66, 34, 500, 80, 500, 500, 500, 66, 88, 64, 70, 94, 48, 500, 26, 82, 500, 308, 500, 58, 500, 500, 500, 500, 500, 154, 288, 500, 46, 198, 178, 30, 500, 212, 500, 36, 52, 58, 500, 188, 500, 500, 52, 154, 106, 76, 36, 58, 84, 500, 38, 500, 500, 42, 98, 500, 66, 156, 482, 500, 500, 168, 64, 500, 500, 126, 210, 64, 500, 500, 500, 500, 74, 46, 500, 500, 30, 104, 174, 500, 500, 500, 92, 26, 500, 98, 56, 54, 32, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4691588019123573, "mean_inference_ms": 1.49671677259272, "mean_action_processing_ms": 0.1762260575348451, "mean_env_wait_ms": 0.10563751574367242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045000314712524414, "StateBufferConnector_ms": 0.010006189346313477, "ViewRequirementAgentConnector_ms": 0.13856792449951172}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.760999999999811, "episode_len_mean": 267.98, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 6.299999999999649, -50.00000000000044, 46.3, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.30000000000001, 43.7, 43.10000000000001, 40.70000000000002, 45.3, -50.00000000000044, 47.5, 41.90000000000001, -50.00000000000044, 19.299999999999834, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 21.299999999999862, -50.00000000000044, 45.5, 30.29999999999999, 32.30000000000002, 47.1, -50.00000000000044, 28.89999999999997, -50.00000000000044, 46.5, 44.900000000000006, 44.300000000000004, -50.00000000000044, 31.300000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.70000000000004, 39.50000000000002, 42.500000000000014, 46.5, 44.300000000000004, 41.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, 43.50000000000001, 34.50000000000004, 1.8999999999995865, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, 29.099999999999973, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 47.5, -50.00000000000044, 40.30000000000002, 44.5, 44.7, 46.9, -50.00000000000044, 44.5], "episode_lengths": [46, 438, 500, 38, 268, 62, 500, 500, 500, 66, 34, 500, 80, 500, 500, 500, 66, 88, 64, 70, 94, 48, 500, 26, 82, 500, 308, 500, 58, 500, 500, 500, 500, 500, 154, 288, 500, 46, 198, 178, 30, 500, 212, 500, 36, 52, 58, 500, 188, 500, 500, 52, 154, 106, 76, 36, 58, 84, 500, 38, 500, 500, 42, 98, 500, 66, 156, 482, 500, 500, 168, 64, 500, 500, 126, 210, 64, 500, 500, 500, 500, 74, 46, 500, 500, 30, 104, 174, 500, 500, 500, 92, 26, 500, 98, 56, 54, 32, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4691588019123573, "mean_inference_ms": 1.49671677259272, "mean_action_processing_ms": 0.1762260575348451, "mean_env_wait_ms": 0.10563751574367242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045000314712524414, "StateBufferConnector_ms": 0.010006189346313477, "ViewRequirementAgentConnector_ms": 0.13856792449951172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4616.403578902635, "num_env_steps_trained_throughput_per_sec": 4616.403578902635, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3981.336, "sample_time_ms": 3509.702, "load_time_ms": 29.182, "load_throughput": 616828.562, "learn_time_ms": 426.54, "learn_throughput": 42199.998, "synch_weights_time_ms": 14.531}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1383, "training_iteration": 21, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-17", "timestamp": 1698246377, "time_this_iter_s": 3.905139446258545, "time_total_s": 80.69696068763733, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.69696068763733, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 75.25999999999999, "ram_util_percent": 30.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.501699018478393, "policy_loss": -0.05434262957423926, "vf_loss": 6.5560918092727665, "vf_explained_var": -4.470348358154297e-07, "kl": 0.000514377783792952, "entropy": 0.5019718304276466, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 430.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.287999999999827, "episode_len_mean": 247.72, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 47.5, -50.00000000000044, 40.30000000000002, 44.5, 44.7, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 38.10000000000002, 43.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 44.7, 37.50000000000003, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.7, -50.00000000000044, 44.900000000000006, 36.50000000000003, 43.900000000000006, 43.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.3, 45.5, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.7, 45.9, 44.5, 33.500000000000036, -50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 38.700000000000024, 45.7, 42.10000000000001, -50.00000000000044, 27.699999999999953, 40.70000000000002, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 46.9, 44.5, 47.3, 26.499999999999936, -50.00000000000044, 37.10000000000003, 43.10000000000001, 46.9, 41.500000000000014, -50.00000000000044, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 74, 46, 500, 500, 30, 104, 174, 500, 500, 500, 92, 26, 500, 98, 56, 54, 32, 500, 56, 500, 120, 62, 500, 74, 500, 500, 500, 74, 108, 500, 34, 500, 52, 48, 500, 500, 500, 42, 42, 54, 126, 500, 120, 500, 64, 500, 52, 136, 62, 64, 500, 96, 500, 48, 46, 48, 500, 94, 500, 500, 32, 64, 42, 56, 166, 500, 112, 50, 500, 114, 44, 80, 500, 224, 94, 60, 500, 28, 500, 32, 56, 28, 236, 500, 130, 70, 32, 86, 500, 42, 266, 500, 500, 120, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46792977105833927, "mean_inference_ms": 1.4943837110752534, "mean_action_processing_ms": 0.17596579950046362, "mean_env_wait_ms": 0.10498750419187435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699493408203125, "StateBufferConnector_ms": 0.011003971099853516, "ViewRequirementAgentConnector_ms": 0.16682982444763184}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.287999999999827, "episode_len_mean": 247.72, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 32.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 47.5, -50.00000000000044, 40.30000000000002, 44.5, 44.7, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 38.10000000000002, 43.900000000000006, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.900000000000006, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 44.7, 37.50000000000003, -50.00000000000044, 38.10000000000002, -50.00000000000044, 43.7, -50.00000000000044, 44.900000000000006, 36.50000000000003, 43.900000000000006, 43.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.3, 45.5, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 46.9, 43.7, 45.9, 44.5, 33.500000000000036, -50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 38.700000000000024, 45.7, 42.10000000000001, -50.00000000000044, 27.699999999999953, 40.70000000000002, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 46.9, 44.5, 47.3, 26.499999999999936, -50.00000000000044, 37.10000000000003, 43.10000000000001, 46.9, 41.500000000000014, -50.00000000000044, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 74, 46, 500, 500, 30, 104, 174, 500, 500, 500, 92, 26, 500, 98, 56, 54, 32, 500, 56, 500, 120, 62, 500, 74, 500, 500, 500, 74, 108, 500, 34, 500, 52, 48, 500, 500, 500, 42, 42, 54, 126, 500, 120, 500, 64, 500, 52, 136, 62, 64, 500, 96, 500, 48, 46, 48, 500, 94, 500, 500, 32, 64, 42, 56, 166, 500, 112, 50, 500, 114, 44, 80, 500, 224, 94, 60, 500, 28, 500, 32, 56, 28, 236, 500, 130, 70, 32, 86, 500, 42, 266, 500, 500, 120, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46792977105833927, "mean_inference_ms": 1.4943837110752534, "mean_action_processing_ms": 0.17596579950046362, "mean_env_wait_ms": 0.10498750419187435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699493408203125, "StateBufferConnector_ms": 0.011003971099853516, "ViewRequirementAgentConnector_ms": 0.16682982444763184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4638.899476106318, "num_env_steps_trained_throughput_per_sec": 4638.899476106318, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 4029.846, "sample_time_ms": 3537.046, "load_time_ms": 30.808, "load_throughput": 584263.003, "learn_time_ms": 445.884, "learn_throughput": 40369.226, "synch_weights_time_ms": 14.855}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1460, "training_iteration": 22, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-21", "timestamp": 1698246381, "time_this_iter_s": 3.886021375656128, "time_total_s": 84.58298206329346, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.58298206329346, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 68.23333333333333, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.611700057983398, "policy_loss": -0.00012153526768088341, "vf_loss": 6.6118697166442875, "vf_explained_var": 6.556510925292969e-08, "kl": 9.21702770142474e-05, "entropy": 0.4797359868884087, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 450.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.800999999999829, "episode_len_mean": 247.62, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 38.700000000000024, 45.7, 42.10000000000001, -50.00000000000044, 27.699999999999953, 40.70000000000002, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 46.9, 44.5, 47.3, 26.499999999999936, -50.00000000000044, 37.10000000000003, 43.10000000000001, 46.9, 41.500000000000014, -50.00000000000044, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 44.900000000000006, 47.7, 41.30000000000001, 46.699999999999996, 46.3, 18.29999999999982, 47.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.30000000000001, 7.09999999999966, 42.70000000000001, 44.5, 42.900000000000006, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 37.300000000000026, 36.30000000000003, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 1.099999999999575, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 34.70000000000004, 43.900000000000006, 42.70000000000001, -50.00000000000044, 31.300000000000004, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 46.5, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.50000000000003, 35.500000000000036, 47.5, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 112, 50, 500, 114, 44, 80, 500, 224, 94, 60, 500, 28, 500, 32, 56, 28, 236, 500, 130, 70, 32, 86, 500, 42, 266, 500, 500, 120, 500, 500, 500, 56, 100, 500, 500, 108, 52, 24, 88, 34, 38, 318, 24, 500, 70, 500, 68, 430, 74, 56, 72, 500, 134, 500, 30, 500, 52, 128, 138, 500, 500, 304, 500, 34, 500, 36, 490, 500, 88, 500, 48, 500, 154, 62, 74, 500, 188, 40, 500, 148, 500, 500, 500, 46, 38, 36, 500, 54, 48, 500, 500, 500, 34, 116, 146, 26, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4677787849567027, "mean_inference_ms": 1.4941465050789418, "mean_action_processing_ms": 0.17567211255357568, "mean_env_wait_ms": 0.10528372735854025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038001298904418945, "StateBufferConnector_ms": 0.010004043579101562, "ViewRequirementAgentConnector_ms": 0.16507506370544434}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.800999999999829, "episode_len_mean": 247.62, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.90000000000002, 45.1, -50.00000000000044, 38.700000000000024, 45.7, 42.10000000000001, -50.00000000000044, 27.699999999999953, 40.70000000000002, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 46.9, 44.5, 47.3, 26.499999999999936, -50.00000000000044, 37.10000000000003, 43.10000000000001, 46.9, 41.500000000000014, -50.00000000000044, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 44.900000000000006, 47.7, 41.30000000000001, 46.699999999999996, 46.3, 18.29999999999982, 47.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 43.30000000000001, 7.09999999999966, 42.70000000000001, 44.5, 42.900000000000006, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.1, -50.00000000000044, 44.900000000000006, 37.300000000000026, 36.30000000000003, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, 1.099999999999575, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 34.70000000000004, 43.900000000000006, 42.70000000000001, -50.00000000000044, 31.300000000000004, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 46.5, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.50000000000003, 35.500000000000036, 47.5, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 112, 50, 500, 114, 44, 80, 500, 224, 94, 60, 500, 28, 500, 32, 56, 28, 236, 500, 130, 70, 32, 86, 500, 42, 266, 500, 500, 120, 500, 500, 500, 56, 100, 500, 500, 108, 52, 24, 88, 34, 38, 318, 24, 500, 70, 500, 68, 430, 74, 56, 72, 500, 134, 500, 30, 500, 52, 128, 138, 500, 500, 304, 500, 34, 500, 36, 490, 500, 88, 500, 48, 500, 154, 62, 74, 500, 188, 40, 500, 148, 500, 500, 500, 46, 38, 36, 500, 54, 48, 500, 500, 500, 34, 116, 146, 26, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4677787849567027, "mean_inference_ms": 1.4941465050789418, "mean_action_processing_ms": 0.17567211255357568, "mean_env_wait_ms": 0.10528372735854025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038001298904418945, "StateBufferConnector_ms": 0.010004043579101562, "ViewRequirementAgentConnector_ms": 0.16507506370544434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4486.250489121667, "num_env_steps_trained_throughput_per_sec": 4486.250489121667, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 4073.69, "sample_time_ms": 3550.766, "load_time_ms": 33.144, "load_throughput": 543076.563, "learn_time_ms": 472.839, "learn_throughput": 38067.959, "synch_weights_time_ms": 15.66}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1529, "training_iteration": 23, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-25", "timestamp": 1698246385, "time_this_iter_s": 4.019258499145508, "time_total_s": 88.60224056243896, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.60224056243896, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 80.17999999999999, "ram_util_percent": 30.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.986316728591919, "policy_loss": -0.02510759383440018, "vf_loss": 7.011473059654236, "vf_explained_var": -2.652406692504883e-06, "kl": 9.750104237582491e-05, "entropy": 0.487003855407238, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 470.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.435999999999824, "episode_len_mean": 256.26, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 42.70000000000001, -50.00000000000044, 31.300000000000004, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 46.5, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.50000000000003, 35.500000000000036, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 21.299999999999862, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 45.1, 46.5, -50.00000000000044, 31.70000000000001, 31.70000000000001, 17.299999999999805, -50.00000000000044, 38.10000000000002, 47.7, 39.70000000000002, 45.3, -50.00000000000044, 36.30000000000003, 45.5, -50.00000000000044, 43.900000000000006, 29.899999999999984, 27.899999999999956, 45.1, 46.9, 46.099999999999994, 41.30000000000001, -50.00000000000044, 39.50000000000002, 39.90000000000002, 40.70000000000002, 26.69999999999994, 37.70000000000003, 46.5, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 46.5, 16.699999999999797, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 30.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 17.899999999999814, 35.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.9], "episode_lengths": [62, 74, 500, 188, 40, 500, 148, 500, 500, 500, 46, 38, 36, 500, 54, 48, 500, 500, 500, 34, 116, 146, 26, 54, 500, 500, 500, 500, 44, 500, 500, 32, 288, 500, 364, 500, 500, 30, 52, 50, 36, 500, 184, 184, 328, 500, 120, 24, 104, 48, 500, 138, 46, 500, 62, 202, 222, 50, 32, 40, 88, 500, 106, 102, 94, 234, 124, 36, 500, 40, 112, 500, 36, 334, 500, 118, 500, 500, 40, 46, 194, 110, 500, 500, 500, 500, 140, 500, 500, 144, 500, 62, 500, 322, 144, 82, 500, 500, 96, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4668217796734268, "mean_inference_ms": 1.492519629910242, "mean_action_processing_ms": 0.1757744124234624, "mean_env_wait_ms": 0.1045683319094995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698683738708496, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.15421199798583984}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.435999999999824, "episode_len_mean": 256.26, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 42.70000000000001, -50.00000000000044, 31.300000000000004, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.3, 46.5, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.50000000000003, 35.500000000000036, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 21.299999999999862, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 47.1, 44.900000000000006, 45.1, 46.5, -50.00000000000044, 31.70000000000001, 31.70000000000001, 17.299999999999805, -50.00000000000044, 38.10000000000002, 47.7, 39.70000000000002, 45.3, -50.00000000000044, 36.30000000000003, 45.5, -50.00000000000044, 43.900000000000006, 29.899999999999984, 27.899999999999956, 45.1, 46.9, 46.099999999999994, 41.30000000000001, -50.00000000000044, 39.50000000000002, 39.90000000000002, 40.70000000000002, 26.69999999999994, 37.70000000000003, 46.5, -50.00000000000044, 46.099999999999994, 38.90000000000002, -50.00000000000044, 46.5, 16.699999999999797, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 30.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 17.899999999999814, 35.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.9], "episode_lengths": [62, 74, 500, 188, 40, 500, 148, 500, 500, 500, 46, 38, 36, 500, 54, 48, 500, 500, 500, 34, 116, 146, 26, 54, 500, 500, 500, 500, 44, 500, 500, 32, 288, 500, 364, 500, 500, 30, 52, 50, 36, 500, 184, 184, 328, 500, 120, 24, 104, 48, 500, 138, 46, 500, 62, 202, 222, 50, 32, 40, 88, 500, 106, 102, 94, 234, 124, 36, 500, 40, 112, 500, 36, 334, 500, 118, 500, 500, 40, 46, 194, 110, 500, 500, 500, 500, 140, 500, 500, 144, 500, 62, 500, 322, 144, 82, 500, 500, 96, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4668217796734268, "mean_inference_ms": 1.492519629910242, "mean_action_processing_ms": 0.1757744124234624, "mean_env_wait_ms": 0.1045683319094995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02698683738708496, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.15421199798583984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4613.250162507942, "num_env_steps_trained_throughput_per_sec": 4613.250162507942, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 4113.787, "sample_time_ms": 3560.994, "load_time_ms": 33.979, "load_throughput": 529735.074, "learn_time_ms": 501.286, "learn_throughput": 35907.637, "synch_weights_time_ms": 16.146}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1603, "training_iteration": 24, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-29", "timestamp": 1698246389, "time_this_iter_s": 3.909803867340088, "time_total_s": 92.51204442977905, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.51204442977905, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 64.39999999999999, "ram_util_percent": 30.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.630692720413208, "policy_loss": 0.043698045145720246, "vf_loss": 6.5870414733886715, "vf_explained_var": -1.71661376953125e-06, "kl": 0.00027930627592134274, "entropy": 0.46925908625125884, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 490.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.036999999999811, "episode_len_mean": 265.24, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 38.90000000000002, -50.00000000000044, 46.5, 16.699999999999797, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 30.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 17.899999999999814, 35.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.9, -50.00000000000044, 46.099999999999994, 47.3, 46.3, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, 5.899999999999643, 6.8999999999996575, 42.500000000000014, 31.1, 46.3, 45.9, -50.00000000000044, 40.30000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.9, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 45.9, 46.5, -50.00000000000044, 21.699999999999868, 16.29999999999979, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.300000000000004, 17.099999999999802, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 45.5, 45.1, 28.89999999999997, 45.3, 0.49999999999956657, 42.70000000000001], "episode_lengths": [40, 112, 500, 36, 334, 500, 118, 500, 500, 40, 46, 194, 110, 500, 500, 500, 500, 140, 500, 500, 144, 500, 62, 500, 322, 144, 82, 500, 500, 96, 32, 500, 40, 28, 38, 500, 42, 120, 500, 500, 442, 432, 76, 190, 38, 42, 500, 98, 84, 500, 500, 122, 500, 46, 500, 500, 42, 500, 500, 56, 30, 90, 72, 500, 500, 168, 42, 500, 50, 56, 500, 62, 42, 36, 500, 284, 338, 500, 500, 68, 500, 40, 50, 500, 500, 500, 106, 84, 58, 330, 500, 32, 72, 500, 46, 50, 212, 48, 496, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4670273664437177, "mean_inference_ms": 1.4906087554278469, "mean_action_processing_ms": 0.17534409565949283, "mean_env_wait_ms": 0.10469869872753586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036978721618652344, "StateBufferConnector_ms": 0.004004716873168945, "ViewRequirementAgentConnector_ms": 0.15304136276245117}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.036999999999811, "episode_len_mean": 265.24, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 38.90000000000002, -50.00000000000044, 46.5, 16.699999999999797, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.5, 30.699999999999996, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 17.899999999999814, 35.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.9, -50.00000000000044, 46.099999999999994, 47.3, 46.3, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, -50.00000000000044, 5.899999999999643, 6.8999999999996575, 42.500000000000014, 31.1, 46.3, 45.9, -50.00000000000044, 40.30000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.5, 47.1, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044, 33.30000000000003, 45.9, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 45.9, 46.5, -50.00000000000044, 21.699999999999868, 16.29999999999979, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.300000000000004, 17.099999999999802, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 45.5, 45.1, 28.89999999999997, 45.3, 0.49999999999956657, 42.70000000000001], "episode_lengths": [40, 112, 500, 36, 334, 500, 118, 500, 500, 40, 46, 194, 110, 500, 500, 500, 500, 140, 500, 500, 144, 500, 62, 500, 322, 144, 82, 500, 500, 96, 32, 500, 40, 28, 38, 500, 42, 120, 500, 500, 442, 432, 76, 190, 38, 42, 500, 98, 84, 500, 500, 122, 500, 46, 500, 500, 42, 500, 500, 56, 30, 90, 72, 500, 500, 168, 42, 500, 50, 56, 500, 62, 42, 36, 500, 284, 338, 500, 500, 68, 500, 40, 50, 500, 500, 500, 106, 84, 58, 330, 500, 32, 72, 500, 46, 50, 212, 48, 496, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4670273664437177, "mean_inference_ms": 1.4906087554278469, "mean_action_processing_ms": 0.17534409565949283, "mean_env_wait_ms": 0.10469869872753586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036978721618652344, "StateBufferConnector_ms": 0.004004716873168945, "ViewRequirementAgentConnector_ms": 0.15304136276245117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4606.192552983208, "num_env_steps_trained_throughput_per_sec": 4606.192552983208, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 4120.515, "sample_time_ms": 3579.428, "load_time_ms": 34.379, "load_throughput": 523569.546, "learn_time_ms": 490.102, "learn_throughput": 36727.018, "synch_weights_time_ms": 15.187}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1672, "training_iteration": 25, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-33", "timestamp": 1698246393, "time_this_iter_s": 3.913773775100708, "time_total_s": 96.42581820487976, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.42581820487976, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 77.83999999999999, "ram_util_percent": 30.939999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.396649265289307, "policy_loss": -0.012572828866541385, "vf_loss": 6.40926730632782, "vf_explained_var": -1.5199184417724608e-07, "kl": 0.00019721738743072592, "entropy": 0.45185168981552126, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.578999999999797, "episode_len_mean": 269.8, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 45.9, 46.5, -50.00000000000044, 21.699999999999868, 16.29999999999979, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.300000000000004, 17.099999999999802, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 45.5, 45.1, 28.89999999999997, 45.3, 0.49999999999956657, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 12.099999999999731, 45.9, -50.00000000000044, 46.3, 47.3, 46.3, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.7, 40.30000000000002, 47.1, 38.50000000000003, 47.7, 1.8999999999995865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 16.29999999999979, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 29.49999999999998, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.5], "episode_lengths": [42, 500, 50, 56, 500, 62, 42, 36, 500, 284, 338, 500, 500, 68, 500, 40, 50, 500, 500, 500, 106, 84, 58, 330, 500, 32, 72, 500, 46, 50, 212, 48, 496, 74, 500, 44, 500, 500, 500, 60, 32, 500, 500, 48, 44, 380, 42, 500, 38, 28, 38, 34, 500, 38, 500, 144, 500, 54, 98, 30, 116, 24, 482, 500, 500, 500, 174, 500, 38, 28, 500, 500, 500, 416, 280, 500, 500, 500, 44, 500, 338, 40, 500, 500, 42, 82, 206, 500, 122, 500, 34, 500, 500, 500, 26, 72, 500, 32, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46587028386410156, "mean_inference_ms": 1.4907149023016961, "mean_action_processing_ms": 0.17538445349251996, "mean_env_wait_ms": 0.10492391421834911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04598522186279297, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.15198326110839844}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.578999999999797, "episode_len_mean": 269.8, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 45.9, 46.5, -50.00000000000044, 21.699999999999868, 16.29999999999979, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 41.70000000000002, 44.300000000000004, 17.099999999999802, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 45.5, 45.1, 28.89999999999997, 45.3, 0.49999999999956657, 42.70000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.9, -50.00000000000044, -50.00000000000044, 45.3, 45.7, 12.099999999999731, 45.9, -50.00000000000044, 46.3, 47.3, 46.3, 46.699999999999996, -50.00000000000044, 46.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.7, 40.30000000000002, 47.1, 38.50000000000003, 47.7, 1.8999999999995865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 16.29999999999979, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 29.49999999999998, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.5], "episode_lengths": [42, 500, 50, 56, 500, 62, 42, 36, 500, 284, 338, 500, 500, 68, 500, 40, 50, 500, 500, 500, 106, 84, 58, 330, 500, 32, 72, 500, 46, 50, 212, 48, 496, 74, 500, 44, 500, 500, 500, 60, 32, 500, 500, 48, 44, 380, 42, 500, 38, 28, 38, 34, 500, 38, 500, 144, 500, 54, 98, 30, 116, 24, 482, 500, 500, 500, 174, 500, 38, 28, 500, 500, 500, 416, 280, 500, 500, 500, 44, 500, 338, 40, 500, 500, 42, 82, 206, 500, 122, 500, 34, 500, 500, 500, 26, 72, 500, 32, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46587028386410156, "mean_inference_ms": 1.4907149023016961, "mean_action_processing_ms": 0.17538445349251996, "mean_env_wait_ms": 0.10492391421834911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04598522186279297, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.15198326110839844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4518.628024380101, "num_env_steps_trained_throughput_per_sec": 4518.628024380101, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 4029.637, "sample_time_ms": 3498.813, "load_time_ms": 34.991, "load_throughput": 514411.653, "learn_time_ms": 479.373, "learn_throughput": 37549.074, "synch_weights_time_ms": 15.042}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1738, "training_iteration": 26, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-37", "timestamp": 1698246397, "time_this_iter_s": 3.989896297454834, "time_total_s": 100.4157145023346, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.4157145023346, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 69.98333333333333, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.4759913921356205, "policy_loss": 0.0008153737522661686, "vf_loss": 6.475223970413208, "vf_explained_var": -7.987022399902344e-07, "kl": 0.0004908852899760064, "entropy": 0.4784697234630585, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 530.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6489999999998055, "episode_len_mean": 269.1, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 16.29999999999979, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 29.49999999999998, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 18.899999999999828, 40.90000000000002, 43.7, 47.5, 46.699999999999996, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 42.70000000000001, 45.3, 42.10000000000001, 20.49999999999985, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 16.699999999999797, 43.7, 45.1, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 23.699999999999896, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 14.899999999999771, 45.5, 35.500000000000036, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, 45.3, 24.899999999999913, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004], "episode_lengths": [28, 500, 500, 500, 416, 280, 500, 500, 500, 44, 500, 338, 40, 500, 500, 42, 82, 206, 500, 122, 500, 34, 500, 500, 500, 26, 72, 500, 32, 500, 56, 500, 500, 58, 54, 78, 500, 500, 90, 312, 92, 64, 26, 34, 500, 44, 74, 500, 74, 48, 80, 296, 114, 500, 500, 44, 500, 58, 500, 42, 196, 66, 50, 56, 500, 334, 64, 50, 500, 44, 66, 500, 74, 50, 500, 500, 54, 62, 264, 46, 500, 500, 500, 500, 80, 500, 352, 46, 146, 500, 500, 238, 36, 500, 48, 252, 500, 96, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46558814085857103, "mean_inference_ms": 1.4889815044589665, "mean_action_processing_ms": 0.17517383218697902, "mean_env_wait_ms": 0.1044853953466691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0339961051940918, "StateBufferConnector_ms": 0.006005525588989258, "ViewRequirementAgentConnector_ms": 0.1459662914276123}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6489999999998055, "episode_len_mean": 269.1, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 16.29999999999979, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, 29.49999999999998, -50.00000000000044, 37.90000000000003, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 18.899999999999828, 40.90000000000002, 43.7, 47.5, 46.699999999999996, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 42.70000000000001, 45.3, 42.10000000000001, 20.49999999999985, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, 30.499999999999993, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 16.699999999999797, 43.7, 45.1, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 23.699999999999896, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 14.899999999999771, 45.5, 35.500000000000036, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, 45.3, 24.899999999999913, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004], "episode_lengths": [28, 500, 500, 500, 416, 280, 500, 500, 500, 44, 500, 338, 40, 500, 500, 42, 82, 206, 500, 122, 500, 34, 500, 500, 500, 26, 72, 500, 32, 500, 56, 500, 500, 58, 54, 78, 500, 500, 90, 312, 92, 64, 26, 34, 500, 44, 74, 500, 74, 48, 80, 296, 114, 500, 500, 44, 500, 58, 500, 42, 196, 66, 50, 56, 500, 334, 64, 50, 500, 44, 66, 500, 74, 50, 500, 500, 54, 62, 264, 46, 500, 500, 500, 500, 80, 500, 352, 46, 146, 500, 500, 238, 36, 500, 48, 252, 500, 96, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46558814085857103, "mean_inference_ms": 1.4889815044589665, "mean_action_processing_ms": 0.17517383218697902, "mean_env_wait_ms": 0.1044853953466691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0339961051940918, "StateBufferConnector_ms": 0.006005525588989258, "ViewRequirementAgentConnector_ms": 0.1459662914276123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4716.608076727726, "num_env_steps_trained_throughput_per_sec": 4716.608076727726, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3911.355, "sample_time_ms": 3399.74, "load_time_ms": 35.079, "load_throughput": 513133.057, "learn_time_ms": 459.591, "learn_throughput": 39165.3, "synch_weights_time_ms": 15.326}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1807, "training_iteration": 27, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-41", "timestamp": 1698246401, "time_this_iter_s": 3.822300672531128, "time_total_s": 104.23801517486572, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.23801517486572, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.233354330062866, "policy_loss": -6.121741607785225e-05, "vf_loss": 6.233460760116577, "vf_explained_var": -1.1920928955078125e-06, "kl": 4.7837782194193323e-05, "entropy": 0.45053197890520097, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 550.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3949999999998073, "episode_len_mean": 271.62, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 23.699999999999896, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 14.899999999999771, 45.5, 35.500000000000036, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, 45.3, 24.899999999999913, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 44.7, 39.50000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.9, 29.49999999999998, 45.1, 28.29999999999996, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, 37.50000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.300000000000004, 41.30000000000001, 41.70000000000002, -50.00000000000044, 40.10000000000002, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.5, 45.1, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.300000000000004, 46.699999999999996, 45.3, 38.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 66, 500, 74, 50, 500, 500, 54, 62, 264, 46, 500, 500, 500, 500, 80, 500, 352, 46, 146, 500, 500, 238, 36, 500, 48, 252, 500, 96, 500, 140, 500, 36, 500, 40, 54, 106, 500, 136, 500, 500, 218, 500, 500, 156, 500, 500, 98, 32, 206, 50, 218, 500, 108, 500, 500, 34, 126, 500, 38, 500, 500, 126, 58, 88, 84, 500, 100, 38, 80, 500, 500, 90, 54, 500, 500, 102, 40, 500, 68, 500, 40, 500, 54, 500, 500, 500, 136, 56, 50, 500, 320, 70, 58, 34, 48, 118, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4654994103829009, "mean_inference_ms": 1.4868350914906971, "mean_action_processing_ms": 0.1750686848520074, "mean_env_wait_ms": 0.10407413095525135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038512468338012695, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.15645289421081543}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3949999999998073, "episode_len_mean": 271.62, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 23.699999999999896, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 14.899999999999771, 45.5, 35.500000000000036, -50.00000000000044, -50.00000000000044, 26.299999999999933, 46.5, -50.00000000000044, 45.3, 24.899999999999913, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, 44.7, 39.50000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 46.9, 29.49999999999998, 45.1, 28.29999999999996, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, 37.50000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.300000000000004, 41.30000000000001, 41.70000000000002, -50.00000000000044, 40.10000000000002, 46.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.5, 45.1, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.300000000000004, 46.699999999999996, 45.3, 38.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 44, 66, 500, 74, 50, 500, 500, 54, 62, 264, 46, 500, 500, 500, 500, 80, 500, 352, 46, 146, 500, 500, 238, 36, 500, 48, 252, 500, 96, 500, 140, 500, 36, 500, 40, 54, 106, 500, 136, 500, 500, 218, 500, 500, 156, 500, 500, 98, 32, 206, 50, 218, 500, 108, 500, 500, 34, 126, 500, 38, 500, 500, 126, 58, 88, 84, 500, 100, 38, 80, 500, 500, 90, 54, 500, 500, 102, 40, 500, 68, 500, 40, 500, 54, 500, 500, 500, 136, 56, 50, 500, 320, 70, 58, 34, 48, 118, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4654994103829009, "mean_inference_ms": 1.4868350914906971, "mean_action_processing_ms": 0.1750686848520074, "mean_env_wait_ms": 0.10407413095525135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038512468338012695, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.15645289421081543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4583.437319122704, "num_env_steps_trained_throughput_per_sec": 4583.437319122704, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3912.857, "sample_time_ms": 3388.111, "load_time_ms": 37.096, "load_throughput": 485228.769, "learn_time_ms": 470.328, "learn_throughput": 38271.193, "synch_weights_time_ms": 15.802}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1875, "training_iteration": 28, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-45", "timestamp": 1698246405, "time_this_iter_s": 3.9331812858581543, "time_total_s": 108.17119646072388, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.17119646072388, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 67.66666666666667, "ram_util_percent": 30.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 7.076240062713623, "policy_loss": -0.07017134828492999, "vf_loss": 7.146460056304932, "vf_explained_var": -1.329183578491211e-06, "kl": 0.0004970794068782425, "entropy": 0.4861116766929626, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.31999999999982, "episode_len_mean": 257.42, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.5, 45.1, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.300000000000004, 46.699999999999996, 45.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, 35.30000000000004, 43.7, -50.00000000000044, 23.699999999999896, 42.10000000000001, 47.3, 44.5, 42.900000000000006, -50.00000000000044, 41.100000000000016, 46.099999999999994, 25.099999999999916, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 33.90000000000004, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.7, 25.29999999999992, 24.69999999999991, -50.00000000000044, 14.699999999999768, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.90000000000002, 46.699999999999996, 23.499999999999893, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, 42.10000000000001, 38.300000000000026, 45.3, 26.499999999999936, -50.00000000000044, 22.699999999999882, 46.3, 46.5, 45.3, 16.499999999999794, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.5, 47.5, 37.50000000000003, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 90, 54, 500, 500, 102, 40, 500, 68, 500, 40, 500, 54, 500, 500, 500, 136, 56, 50, 500, 320, 70, 58, 34, 48, 118, 500, 500, 500, 500, 500, 44, 500, 40, 148, 64, 500, 264, 80, 28, 56, 72, 500, 90, 40, 250, 130, 500, 500, 40, 162, 500, 500, 124, 64, 248, 254, 500, 354, 302, 500, 500, 62, 500, 112, 34, 266, 62, 110, 500, 500, 146, 80, 118, 48, 236, 500, 274, 38, 36, 48, 336, 48, 500, 500, 500, 50, 36, 500, 46, 26, 126, 500, 60, 72, 80, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46482318422197394, "mean_inference_ms": 1.4867033508571572, "mean_action_processing_ms": 0.1750756664069563, "mean_env_wait_ms": 0.10470610668350484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03250527381896973, "StateBufferConnector_ms": 0.004995107650756836, "ViewRequirementAgentConnector_ms": 0.14055776596069336}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.31999999999982, "episode_len_mean": 257.42, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.100000000000016, 44.7, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.5, 45.1, -50.00000000000044, 18.099999999999817, 43.10000000000001, 44.300000000000004, 46.699999999999996, 45.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.099999999999994, 35.30000000000004, 43.7, -50.00000000000044, 23.699999999999896, 42.10000000000001, 47.3, 44.5, 42.900000000000006, -50.00000000000044, 41.100000000000016, 46.099999999999994, 25.099999999999916, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 33.90000000000004, -50.00000000000044, -50.00000000000044, 37.70000000000003, 43.7, 25.29999999999992, 24.69999999999991, -50.00000000000044, 14.699999999999768, 19.899999999999842, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 38.90000000000002, 46.699999999999996, 23.499999999999893, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, 42.10000000000001, 38.300000000000026, 45.3, 26.499999999999936, -50.00000000000044, 22.699999999999882, 46.3, 46.5, 45.3, 16.499999999999794, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.5, 47.5, 37.50000000000003, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 90, 54, 500, 500, 102, 40, 500, 68, 500, 40, 500, 54, 500, 500, 500, 136, 56, 50, 500, 320, 70, 58, 34, 48, 118, 500, 500, 500, 500, 500, 44, 500, 40, 148, 64, 500, 264, 80, 28, 56, 72, 500, 90, 40, 250, 130, 500, 500, 40, 162, 500, 500, 124, 64, 248, 254, 500, 354, 302, 500, 500, 62, 500, 112, 34, 266, 62, 110, 500, 500, 146, 80, 118, 48, 236, 500, 274, 38, 36, 48, 336, 48, 500, 500, 500, 50, 36, 500, 46, 26, 126, 500, 60, 72, 80, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46482318422197394, "mean_inference_ms": 1.4867033508571572, "mean_action_processing_ms": 0.1750756664069563, "mean_env_wait_ms": 0.10470610668350484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03250527381896973, "StateBufferConnector_ms": 0.004995107650756836, "ViewRequirementAgentConnector_ms": 0.14055776596069336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4625.013806587943, "num_env_steps_trained_throughput_per_sec": 4625.013806587943, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3922.589, "sample_time_ms": 3397.789, "load_time_ms": 38.526, "load_throughput": 467219.419, "learn_time_ms": 468.767, "learn_throughput": 38398.607, "synch_weights_time_ms": 15.988}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 1947, "training_iteration": 29, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-49", "timestamp": 1698246409, "time_this_iter_s": 3.8978776931762695, "time_total_s": 112.06907415390015, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.06907415390015, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 75.16, "ram_util_percent": 30.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.630474019050598, "policy_loss": -0.006347946892492473, "vf_loss": 6.636872887611389, "vf_explained_var": -1.049041748046875e-06, "kl": 0.0008205812163225801, "entropy": 0.508652287721634, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 590.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.127999999999837, "episode_len_mean": 239.36, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 26.499999999999936, -50.00000000000044, 22.699999999999882, 46.3, 46.5, 45.3, 16.499999999999794, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.5, 47.5, 37.50000000000003, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 38.90000000000002, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 41.90000000000001, 42.30000000000001, -50.00000000000044, 40.30000000000002, 44.300000000000004, 46.699999999999996, 45.3, 43.900000000000006, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 45.5, 36.70000000000003, 44.300000000000004, 43.30000000000001, 31.500000000000007, 45.9, -50.00000000000044, 44.5, 39.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 39.90000000000002, 22.299999999999876, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 33.30000000000003, 46.9, 38.90000000000002, 42.70000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.099999999999994, 40.90000000000002, -50.00000000000044, 43.10000000000001, 43.30000000000001], "episode_lengths": [48, 236, 500, 274, 38, 36, 48, 336, 48, 500, 500, 500, 50, 36, 500, 46, 26, 126, 500, 60, 72, 80, 500, 500, 500, 500, 500, 500, 40, 500, 500, 58, 52, 112, 72, 500, 54, 500, 500, 118, 500, 82, 78, 500, 98, 58, 34, 48, 62, 90, 38, 500, 500, 500, 500, 500, 234, 146, 38, 500, 500, 152, 46, 134, 58, 68, 186, 42, 500, 56, 108, 500, 58, 500, 40, 500, 134, 102, 278, 44, 500, 500, 46, 54, 168, 32, 112, 74, 418, 500, 500, 38, 500, 86, 60, 40, 92, 500, 70, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4636985502747412, "mean_inference_ms": 1.4848082893681913, "mean_action_processing_ms": 0.17463187362429292, "mean_env_wait_ms": 0.10434427197117113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03251934051513672, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.14504170417785645}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.127999999999837, "episode_len_mean": 239.36, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 26.499999999999936, -50.00000000000044, 22.699999999999882, 46.3, 46.5, 45.3, 16.499999999999794, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.5, -50.00000000000044, 45.5, 47.5, 37.50000000000003, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 38.90000000000002, 42.900000000000006, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 41.90000000000001, 42.30000000000001, -50.00000000000044, 40.30000000000002, 44.300000000000004, 46.699999999999996, 45.3, 43.900000000000006, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.500000000000036, 46.3, -50.00000000000044, -50.00000000000044, 34.900000000000034, 45.5, 36.70000000000003, 44.300000000000004, 43.30000000000001, 31.500000000000007, 45.9, -50.00000000000044, 44.5, 39.300000000000026, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 39.90000000000002, 22.299999999999876, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 33.30000000000003, 46.9, 38.90000000000002, 42.70000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.099999999999994, 40.90000000000002, -50.00000000000044, 43.10000000000001, 43.30000000000001], "episode_lengths": [48, 236, 500, 274, 38, 36, 48, 336, 48, 500, 500, 500, 50, 36, 500, 46, 26, 126, 500, 60, 72, 80, 500, 500, 500, 500, 500, 500, 40, 500, 500, 58, 52, 112, 72, 500, 54, 500, 500, 118, 500, 82, 78, 500, 98, 58, 34, 48, 62, 90, 38, 500, 500, 500, 500, 500, 234, 146, 38, 500, 500, 152, 46, 134, 58, 68, 186, 42, 500, 56, 108, 500, 58, 500, 40, 500, 134, 102, 278, 44, 500, 500, 46, 54, 168, 32, 112, 74, 418, 500, 500, 38, 500, 86, 60, 40, 92, 500, 70, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4636985502747412, "mean_inference_ms": 1.4848082893681913, "mean_action_processing_ms": 0.17463187362429292, "mean_env_wait_ms": 0.10434427197117113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03251934051513672, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.14504170417785645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4713.215105292693, "num_env_steps_trained_throughput_per_sec": 4713.215105292693, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3903.914, "sample_time_ms": 3377.202, "load_time_ms": 38.436, "load_throughput": 468306.8, "learn_time_ms": 470.738, "learn_throughput": 38237.865, "synch_weights_time_ms": 16.018}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2021, "training_iteration": 30, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-53", "timestamp": 1698246413, "time_this_iter_s": 3.8250463008880615, "time_total_s": 115.89412045478821, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.89412045478821, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 64.24999999999999, "ram_util_percent": 30.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.422763347625732, "policy_loss": 0.024683207925409078, "vf_loss": 6.398131728172302, "vf_explained_var": 2.0563602447509767e-07, "kl": 0.00035801006091560337, "entropy": 0.5154970958828926, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 610.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.125999999999854, "episode_len_mean": 229.42, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, 39.90000000000002, 22.299999999999876, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 33.30000000000003, 46.9, 38.90000000000002, 42.70000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.099999999999994, 40.90000000000002, -50.00000000000044, 43.10000000000001, 43.30000000000001, 36.10000000000004, -50.00000000000044, 46.3, -50.00000000000044, 43.50000000000001, 41.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, 42.10000000000001, -50.00000000000044, 40.10000000000002, 36.10000000000004, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.10000000000001, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 42.70000000000001, 31.70000000000001, -50.00000000000044, 43.50000000000001, 30.29999999999999, -50.00000000000044, 45.3, 45.1, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.3, 12.299999999999734, -50.00000000000044, 45.9, 45.3, 45.3, 40.90000000000002, 43.900000000000006, 27.299999999999947, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.9, 29.299999999999976, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 9.699999999999697, 32.50000000000002, 43.900000000000006, 44.5, 41.70000000000002], "episode_lengths": [134, 102, 278, 44, 500, 500, 46, 54, 168, 32, 112, 74, 418, 500, 500, 38, 500, 86, 60, 40, 92, 500, 70, 68, 140, 500, 38, 500, 66, 86, 154, 500, 500, 282, 80, 500, 100, 140, 38, 116, 500, 500, 500, 124, 500, 500, 46, 500, 500, 136, 70, 500, 56, 50, 500, 74, 184, 500, 66, 198, 500, 48, 50, 56, 500, 40, 500, 44, 48, 378, 500, 42, 48, 48, 92, 62, 228, 64, 500, 500, 58, 500, 54, 50, 72, 500, 500, 36, 116, 42, 208, 48, 500, 500, 68, 404, 176, 62, 56, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4639040875148137, "mean_inference_ms": 1.4850465904423091, "mean_action_processing_ms": 0.17493122649268814, "mean_env_wait_ms": 0.10428293521328279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028329849243164062, "StateBufferConnector_ms": 0.004019021987915039, "ViewRequirementAgentConnector_ms": 0.1591343879699707}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.125999999999854, "episode_len_mean": 229.42, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, 39.90000000000002, 22.299999999999876, 45.7, -50.00000000000044, -50.00000000000044, 45.5, 44.7, 33.30000000000003, 46.9, 38.90000000000002, 42.70000000000001, 8.299999999999677, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.500000000000014, 44.10000000000001, 46.099999999999994, 40.90000000000002, -50.00000000000044, 43.10000000000001, 43.30000000000001, 36.10000000000004, -50.00000000000044, 46.3, -50.00000000000044, 43.50000000000001, 41.500000000000014, 34.70000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, 42.10000000000001, -50.00000000000044, 40.10000000000002, 36.10000000000004, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.10000000000001, -50.00000000000044, 44.5, 45.1, -50.00000000000044, 42.70000000000001, 31.70000000000001, -50.00000000000044, 43.50000000000001, 30.29999999999999, -50.00000000000044, 45.3, 45.1, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, 45.3, 12.299999999999734, -50.00000000000044, 45.9, 45.3, 45.3, 40.90000000000002, 43.900000000000006, 27.299999999999947, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.9, 29.299999999999976, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 9.699999999999697, 32.50000000000002, 43.900000000000006, 44.5, 41.70000000000002], "episode_lengths": [134, 102, 278, 44, 500, 500, 46, 54, 168, 32, 112, 74, 418, 500, 500, 38, 500, 86, 60, 40, 92, 500, 70, 68, 140, 500, 38, 500, 66, 86, 154, 500, 500, 282, 80, 500, 100, 140, 38, 116, 500, 500, 500, 124, 500, 500, 46, 500, 500, 136, 70, 500, 56, 50, 500, 74, 184, 500, 66, 198, 500, 48, 50, 56, 500, 40, 500, 44, 48, 378, 500, 42, 48, 48, 92, 62, 228, 64, 500, 500, 58, 500, 54, 50, 72, 500, 500, 36, 116, 42, 208, 48, 500, 500, 68, 404, 176, 62, 56, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4639040875148137, "mean_inference_ms": 1.4850465904423091, "mean_action_processing_ms": 0.17493122649268814, "mean_env_wait_ms": 0.10428293521328279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028329849243164062, "StateBufferConnector_ms": 0.004019021987915039, "ViewRequirementAgentConnector_ms": 0.1591343879699707}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4529.393568885684, "num_env_steps_trained_throughput_per_sec": 4529.393568885684, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3911.404, "sample_time_ms": 3394.444, "load_time_ms": 38.035, "load_throughput": 473251.15, "learn_time_ms": 461.049, "learn_throughput": 39041.397, "synch_weights_time_ms": 16.356}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2097, "training_iteration": 31, "trial_id": "9f288_00007", "date": "2023-10-25_16-06-57", "timestamp": 1698246417, "time_this_iter_s": 3.9797792434692383, "time_total_s": 119.87389969825745, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 119.87389969825745, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 77.7, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.808670520782471, "policy_loss": 0.01695171054452658, "vf_loss": 6.791769409179688, "vf_explained_var": -7.390975952148438e-07, "kl": 0.0002787336261533824, "entropy": 0.5059013515710831, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 630.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.961999999999831, "episode_len_mean": 251.04, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 12.299999999999734, -50.00000000000044, 45.9, 45.3, 45.3, 40.90000000000002, 43.900000000000006, 27.299999999999947, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.9, 29.299999999999976, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 9.699999999999697, 32.50000000000002, 43.900000000000006, 44.5, 41.70000000000002, -50.00000000000044, 45.5, 39.50000000000002, 45.1, -50.00000000000044, 35.500000000000036, 45.3, 40.90000000000002, 35.70000000000003, -50.00000000000044, 14.699999999999768, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 21.89999999999987, 33.30000000000003, -50.00000000000044, 45.7, 8.099999999999675, 39.300000000000026, 45.7, 43.50000000000001, -50.00000000000044, 22.299999999999876, 0.8999999999995723, 12.499999999999737, 38.50000000000003, 45.5, -50.00000000000044, 16.29999999999979, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 42.70000000000001, 44.5, -50.00000000000044, 36.70000000000003, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, 44.5, 33.90000000000004, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044], "episode_lengths": [48, 378, 500, 42, 48, 48, 92, 62, 228, 64, 500, 500, 58, 500, 54, 50, 72, 500, 500, 36, 116, 42, 208, 48, 500, 500, 68, 404, 176, 62, 56, 84, 500, 46, 106, 50, 500, 146, 48, 92, 144, 500, 354, 38, 500, 500, 40, 500, 46, 500, 500, 282, 168, 500, 44, 420, 108, 44, 66, 500, 278, 492, 376, 116, 46, 500, 338, 100, 500, 500, 116, 500, 66, 500, 172, 74, 32, 500, 500, 500, 500, 500, 30, 74, 56, 500, 134, 50, 228, 500, 500, 56, 162, 500, 116, 72, 54, 500, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644243338592248, "mean_inference_ms": 1.4846526761464596, "mean_action_processing_ms": 0.17506087468405201, "mean_env_wait_ms": 0.10446563259927664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029854774475097656, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.14897775650024414}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.961999999999831, "episode_len_mean": 251.04, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 12.299999999999734, -50.00000000000044, 45.9, 45.3, 45.3, 40.90000000000002, 43.900000000000006, 27.299999999999947, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, 45.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 38.50000000000003, 45.9, 29.299999999999976, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, 9.699999999999697, 32.50000000000002, 43.900000000000006, 44.5, 41.70000000000002, -50.00000000000044, 45.5, 39.50000000000002, 45.1, -50.00000000000044, 35.500000000000036, 45.3, 40.90000000000002, 35.70000000000003, -50.00000000000044, 14.699999999999768, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 21.89999999999987, 33.30000000000003, -50.00000000000044, 45.7, 8.099999999999675, 39.300000000000026, 45.7, 43.50000000000001, -50.00000000000044, 22.299999999999876, 0.8999999999995723, 12.499999999999737, 38.50000000000003, 45.5, -50.00000000000044, 16.29999999999979, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 42.70000000000001, 44.5, -50.00000000000044, 36.70000000000003, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, 44.5, 33.90000000000004, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044], "episode_lengths": [48, 378, 500, 42, 48, 48, 92, 62, 228, 64, 500, 500, 58, 500, 54, 50, 72, 500, 500, 36, 116, 42, 208, 48, 500, 500, 68, 404, 176, 62, 56, 84, 500, 46, 106, 50, 500, 146, 48, 92, 144, 500, 354, 38, 500, 500, 40, 500, 46, 500, 500, 282, 168, 500, 44, 420, 108, 44, 66, 500, 278, 492, 376, 116, 46, 500, 338, 100, 500, 500, 116, 500, 66, 500, 172, 74, 32, 500, 500, 500, 500, 500, 30, 74, 56, 500, 134, 50, 228, 500, 500, 56, 162, 500, 116, 72, 54, 500, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644243338592248, "mean_inference_ms": 1.4846526761464596, "mean_action_processing_ms": 0.17506087468405201, "mean_env_wait_ms": 0.10446563259927664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029854774475097656, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.14897775650024414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4510.751242678895, "num_env_steps_trained_throughput_per_sec": 4510.751242678895, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3922.428, "sample_time_ms": 3402.144, "load_time_ms": 38.6, "load_throughput": 466318.174, "learn_time_ms": 463.383, "learn_throughput": 38844.77, "synch_weights_time_ms": 16.715}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2165, "training_iteration": 32, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-01", "timestamp": 1698246421, "time_this_iter_s": 3.9962401390075684, "time_total_s": 123.87013983726501, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.87013983726501, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 68.36666666666667, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.570773124694824, "policy_loss": -0.04694635365158319, "vf_loss": 6.617771887779236, "vf_explained_var": -1.3917684555053712e-06, "kl": 0.0004074223108005981, "entropy": 0.5244654104113579, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 650.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.4089999999997953, "episode_len_mean": 281.48, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 45.5, -50.00000000000044, 16.29999999999979, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 42.70000000000001, 44.5, -50.00000000000044, 36.70000000000003, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, 44.5, 33.90000000000004, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 7.899999999999672, -50.00000000000044, 41.30000000000001, 42.70000000000001, 45.1, 46.9, -50.00000000000044, 41.70000000000002, 46.099999999999994, 6.499999999999652, 47.1, 43.30000000000001, 47.7, -50.00000000000044, 43.7, 44.300000000000004, 42.30000000000001, 44.7, -50.00000000000044, 44.7, 1.8999999999995865, 37.70000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, 29.69999999999998, 37.90000000000003, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 42.70000000000001, 37.90000000000003, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [116, 46, 500, 338, 100, 500, 500, 116, 500, 66, 500, 172, 74, 32, 500, 500, 500, 500, 500, 30, 74, 56, 500, 134, 50, 228, 500, 500, 56, 162, 500, 116, 72, 54, 500, 80, 500, 422, 500, 88, 74, 50, 32, 500, 84, 40, 436, 30, 68, 24, 500, 64, 58, 78, 54, 500, 54, 482, 124, 98, 500, 500, 54, 94, 500, 500, 52, 500, 500, 500, 120, 36, 500, 500, 204, 122, 500, 230, 500, 500, 500, 500, 500, 24, 500, 440, 500, 500, 42, 80, 74, 122, 322, 64, 500, 500, 500, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46468063753884387, "mean_inference_ms": 1.4819154279926392, "mean_action_processing_ms": 0.17508101677089258, "mean_env_wait_ms": 0.10454348802359201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0450136661529541, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.14313721656799316}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.4089999999997953, "episode_len_mean": 281.48, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 45.5, -50.00000000000044, 16.29999999999979, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, 42.70000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 42.70000000000001, 44.5, -50.00000000000044, 36.70000000000003, 45.1, 27.299999999999947, -50.00000000000044, -50.00000000000044, 44.5, 33.90000000000004, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 7.899999999999672, -50.00000000000044, 41.30000000000001, 42.70000000000001, 45.1, 46.9, -50.00000000000044, 41.70000000000002, 46.099999999999994, 6.499999999999652, 47.1, 43.30000000000001, 47.7, -50.00000000000044, 43.7, 44.300000000000004, 42.30000000000001, 44.7, -50.00000000000044, 44.7, 1.8999999999995865, 37.70000000000003, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, 29.69999999999998, 37.90000000000003, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 42.70000000000001, 37.90000000000003, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5], "episode_lengths": [116, 46, 500, 338, 100, 500, 500, 116, 500, 66, 500, 172, 74, 32, 500, 500, 500, 500, 500, 30, 74, 56, 500, 134, 50, 228, 500, 500, 56, 162, 500, 116, 72, 54, 500, 80, 500, 422, 500, 88, 74, 50, 32, 500, 84, 40, 436, 30, 68, 24, 500, 64, 58, 78, 54, 500, 54, 482, 124, 98, 500, 500, 54, 94, 500, 500, 52, 500, 500, 500, 120, 36, 500, 500, 204, 122, 500, 230, 500, 500, 500, 500, 500, 24, 500, 440, 500, 500, 42, 80, 74, 122, 322, 64, 500, 500, 500, 500, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46468063753884387, "mean_inference_ms": 1.4819154279926392, "mean_action_processing_ms": 0.17508101677089258, "mean_env_wait_ms": 0.10454348802359201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0450136661529541, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.14313721656799316}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4662.17012575251, "num_env_steps_trained_throughput_per_sec": 4662.17012575251, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3907.288, "sample_time_ms": 3390.836, "load_time_ms": 39.477, "load_throughput": 455961.807, "learn_time_ms": 459.603, "learn_throughput": 39164.239, "synch_weights_time_ms": 15.887}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2228, "training_iteration": 33, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-05", "timestamp": 1698246425, "time_this_iter_s": 3.866858959197998, "time_total_s": 127.73699879646301, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.73699879646301, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 74.7, "ram_util_percent": 30.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.936190795898438, "policy_loss": -0.03690474275499582, "vf_loss": 6.973149657249451, "vf_explained_var": -3.188848495483398e-07, "kl": 0.0002127383713002473, "entropy": 0.5421449363231658, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 670.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.789999999999814, "episode_len_mean": 262.72, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 42.70000000000001, 37.90000000000003, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, 42.70000000000001, 43.50000000000001, 42.900000000000006, 46.5, 47.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 39.10000000000002, 31.500000000000007, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 45.1, 21.499999999999865, 46.099999999999994, 21.299999999999862, -50.00000000000044, 43.30000000000001, 40.70000000000002, 18.099999999999817, 44.300000000000004, -50.00000000000044, 40.70000000000002, 46.9, 44.10000000000001, 10.699999999999712, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.900000000000006, -50.00000000000044, 35.10000000000004, 45.9, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 28.89999999999997, -50.00000000000044, 26.499999999999936, 36.70000000000003, 26.499999999999936, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 46.099999999999994, 43.10000000000001, -50.00000000000044, 42.10000000000001, 36.30000000000003, 36.50000000000003, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, 0.2999999999995637], "episode_lengths": [122, 500, 230, 500, 500, 500, 500, 500, 24, 500, 440, 500, 500, 42, 80, 74, 122, 322, 64, 500, 500, 500, 500, 500, 36, 500, 500, 86, 500, 48, 74, 66, 72, 36, 28, 74, 500, 500, 246, 500, 110, 186, 58, 500, 500, 42, 46, 50, 286, 40, 288, 500, 68, 94, 320, 58, 500, 94, 32, 60, 394, 40, 40, 500, 500, 60, 68, 52, 500, 150, 42, 500, 40, 92, 500, 500, 142, 212, 500, 236, 134, 236, 500, 56, 500, 30, 40, 70, 500, 80, 138, 136, 56, 500, 500, 500, 62, 500, 50, 498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644907100352221, "mean_inference_ms": 1.4823126358067844, "mean_action_processing_ms": 0.1748180406056612, "mean_env_wait_ms": 0.10428947453278785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046998023986816406, "StateBufferConnector_ms": 0.009012937545776367, "ViewRequirementAgentConnector_ms": 0.12957406044006348}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.789999999999814, "episode_len_mean": 262.72, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, 42.70000000000001, 37.90000000000003, 17.899999999999814, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, 42.70000000000001, 43.50000000000001, 42.900000000000006, 46.5, 47.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, 39.10000000000002, 31.500000000000007, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 45.1, 21.499999999999865, 46.099999999999994, 21.299999999999862, -50.00000000000044, 43.30000000000001, 40.70000000000002, 18.099999999999817, 44.300000000000004, -50.00000000000044, 40.70000000000002, 46.9, 44.10000000000001, 10.699999999999712, 46.099999999999994, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.900000000000006, -50.00000000000044, 35.10000000000004, 45.9, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 28.89999999999997, -50.00000000000044, 26.499999999999936, 36.70000000000003, 26.499999999999936, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 46.099999999999994, 43.10000000000001, -50.00000000000044, 42.10000000000001, 36.30000000000003, 36.50000000000003, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, 0.2999999999995637], "episode_lengths": [122, 500, 230, 500, 500, 500, 500, 500, 24, 500, 440, 500, 500, 42, 80, 74, 122, 322, 64, 500, 500, 500, 500, 500, 36, 500, 500, 86, 500, 48, 74, 66, 72, 36, 28, 74, 500, 500, 246, 500, 110, 186, 58, 500, 500, 42, 46, 50, 286, 40, 288, 500, 68, 94, 320, 58, 500, 94, 32, 60, 394, 40, 40, 500, 500, 60, 68, 52, 500, 150, 42, 500, 40, 92, 500, 500, 142, 212, 500, 236, 134, 236, 500, 56, 500, 30, 40, 70, 500, 80, 138, 136, 56, 500, 500, 500, 62, 500, 50, 498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4644907100352221, "mean_inference_ms": 1.4823126358067844, "mean_action_processing_ms": 0.1748180406056612, "mean_env_wait_ms": 0.10428947453278785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046998023986816406, "StateBufferConnector_ms": 0.009012937545776367, "ViewRequirementAgentConnector_ms": 0.12957406044006348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4557.128934367541, "num_env_steps_trained_throughput_per_sec": 4557.128934367541, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3912.093, "sample_time_ms": 3402.125, "load_time_ms": 38.996, "load_throughput": 461585.179, "learn_time_ms": 453.4, "learn_throughput": 39700.007, "synch_weights_time_ms": 15.986}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2303, "training_iteration": 34, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-09", "timestamp": 1698246429, "time_this_iter_s": 3.955852746963501, "time_total_s": 131.6928515434265, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.6928515434265, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 69.35, "ram_util_percent": 30.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.289445900917054, "policy_loss": 0.0580361282452941, "vf_loss": 6.231457090377807, "vf_explained_var": -1.1861324310302734e-06, "kl": 0.00037239764353103055, "entropy": 0.47221297323703765, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 690.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.696999999999814, "episode_len_mean": 268.62, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 44.900000000000006, -50.00000000000044, 35.10000000000004, 45.9, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 28.89999999999997, -50.00000000000044, 26.499999999999936, 36.70000000000003, 26.499999999999936, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 46.099999999999994, 43.10000000000001, -50.00000000000044, 42.10000000000001, 36.30000000000003, 36.50000000000003, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, 0.2999999999995637, -50.00000000000044, 45.3, 42.500000000000014, 45.9, 46.699999999999996, 37.70000000000003, 43.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.099999999999973, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 46.699999999999996, -50.00000000000044, 44.7, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.900000000000006, 46.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 36.900000000000034, 43.7, -50.00000000000044, 42.70000000000001, 30.29999999999999, 38.300000000000026], "episode_lengths": [68, 52, 500, 150, 42, 500, 40, 92, 500, 500, 142, 212, 500, 236, 134, 236, 500, 56, 500, 30, 40, 70, 500, 80, 138, 136, 56, 500, 500, 500, 62, 500, 50, 498, 500, 48, 76, 42, 34, 124, 64, 74, 500, 500, 294, 500, 500, 66, 210, 500, 42, 500, 500, 500, 80, 78, 500, 500, 82, 500, 252, 500, 500, 32, 154, 34, 500, 54, 74, 44, 500, 500, 188, 72, 36, 500, 250, 500, 216, 500, 62, 500, 500, 136, 500, 500, 500, 70, 500, 500, 38, 500, 90, 40, 132, 64, 500, 74, 198, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46482785302910157, "mean_inference_ms": 1.4827639414631582, "mean_action_processing_ms": 0.17459843963100963, "mean_env_wait_ms": 0.10436335144365749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990154266357422, "StateBufferConnector_ms": 0.007008790969848633, "ViewRequirementAgentConnector_ms": 0.14290404319763184}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.696999999999814, "episode_len_mean": 268.62, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 44.900000000000006, -50.00000000000044, 35.10000000000004, 45.9, -50.00000000000044, 46.099999999999994, 40.90000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 28.89999999999997, -50.00000000000044, 26.499999999999936, 36.70000000000003, 26.499999999999936, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 46.099999999999994, 43.10000000000001, -50.00000000000044, 42.10000000000001, 36.30000000000003, 36.50000000000003, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, 0.2999999999995637, -50.00000000000044, 45.3, 42.500000000000014, 45.9, 46.699999999999996, 37.70000000000003, 43.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 43.50000000000001, 29.099999999999973, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 46.699999999999996, -50.00000000000044, 44.7, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.900000000000006, 46.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 36.900000000000034, 43.7, -50.00000000000044, 42.70000000000001, 30.29999999999999, 38.300000000000026], "episode_lengths": [68, 52, 500, 150, 42, 500, 40, 92, 500, 500, 142, 212, 500, 236, 134, 236, 500, 56, 500, 30, 40, 70, 500, 80, 138, 136, 56, 500, 500, 500, 62, 500, 50, 498, 500, 48, 76, 42, 34, 124, 64, 74, 500, 500, 294, 500, 500, 66, 210, 500, 42, 500, 500, 500, 80, 78, 500, 500, 82, 500, 252, 500, 500, 32, 154, 34, 500, 54, 74, 44, 500, 500, 188, 72, 36, 500, 250, 500, 216, 500, 62, 500, 500, 136, 500, 500, 500, 70, 500, 500, 38, 500, 90, 40, 132, 64, 500, 74, 198, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46482785302910157, "mean_inference_ms": 1.4827639414631582, "mean_action_processing_ms": 0.17459843963100963, "mean_env_wait_ms": 0.10436335144365749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990154266357422, "StateBufferConnector_ms": 0.007008790969848633, "ViewRequirementAgentConnector_ms": 0.14290404319763184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4563.22612878351, "num_env_steps_trained_throughput_per_sec": 4563.22612878351, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3915.773, "sample_time_ms": 3405.47, "load_time_ms": 39.098, "load_throughput": 460379.915, "learn_time_ms": 452.495, "learn_throughput": 39779.468, "synch_weights_time_ms": 16.963}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2369, "training_iteration": 35, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-13", "timestamp": 1698246433, "time_this_iter_s": 3.949042797088623, "time_total_s": 135.64189434051514, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.64189434051514, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 69.1, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.374467158317566, "policy_loss": -0.04886130830273032, "vf_loss": 6.423373675346374, "vf_explained_var": -5.394220352172852e-07, "kl": 0.0005512306192002825, "entropy": 0.4534602791070938, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 710.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.952000000000212, "episode_len_mean": 290.06, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 46.699999999999996, -50.00000000000044, 44.7, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.900000000000006, 46.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 36.900000000000034, 43.7, -50.00000000000044, 42.70000000000001, 30.29999999999999, 38.300000000000026, -50.00000000000044, 46.699999999999996, 43.50000000000001, -50.00000000000044, 42.500000000000014, 44.300000000000004, 42.500000000000014, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.50000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 10.699999999999712, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 45.1, 42.500000000000014, 45.1, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.900000000000006, 32.100000000000016, 27.49999999999995, 43.900000000000006, 40.10000000000002, 20.899999999999856, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 252, 500, 500, 32, 154, 34, 500, 54, 74, 44, 500, 500, 188, 72, 36, 500, 250, 500, 216, 500, 62, 500, 500, 136, 500, 500, 500, 70, 500, 500, 38, 500, 90, 40, 132, 64, 500, 74, 198, 118, 500, 34, 66, 500, 76, 58, 76, 500, 40, 62, 500, 66, 96, 500, 500, 500, 50, 394, 500, 78, 68, 500, 500, 52, 500, 500, 500, 66, 46, 500, 500, 500, 100, 100, 500, 500, 404, 50, 76, 50, 124, 500, 500, 500, 500, 386, 500, 500, 52, 180, 226, 62, 100, 292, 48, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4642022271796668, "mean_inference_ms": 1.4808105212522016, "mean_action_processing_ms": 0.17499329319878054, "mean_env_wait_ms": 0.10428316371603405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028986454010009766, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.15187811851501465}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.952000000000212, "episode_len_mean": 290.06, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 46.9, 34.70000000000004, 46.699999999999996, -50.00000000000044, 44.7, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, 31.300000000000004, 42.900000000000006, 46.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, 28.499999999999964, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 36.900000000000034, 43.7, -50.00000000000044, 42.70000000000001, 30.29999999999999, 38.300000000000026, -50.00000000000044, 46.699999999999996, 43.50000000000001, -50.00000000000044, 42.500000000000014, 44.300000000000004, 42.500000000000014, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.50000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 10.699999999999712, -50.00000000000044, 42.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 45.1, 42.500000000000014, 45.1, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.900000000000006, 32.100000000000016, 27.49999999999995, 43.900000000000006, 40.10000000000002, 20.899999999999856, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 252, 500, 500, 32, 154, 34, 500, 54, 74, 44, 500, 500, 188, 72, 36, 500, 250, 500, 216, 500, 62, 500, 500, 136, 500, 500, 500, 70, 500, 500, 38, 500, 90, 40, 132, 64, 500, 74, 198, 118, 500, 34, 66, 500, 76, 58, 76, 500, 40, 62, 500, 66, 96, 500, 500, 500, 50, 394, 500, 78, 68, 500, 500, 52, 500, 500, 500, 66, 46, 500, 500, 500, 100, 100, 500, 500, 404, 50, 76, 50, 124, 500, 500, 500, 500, 386, 500, 500, 52, 180, 226, 62, 100, 292, 48, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4642022271796668, "mean_inference_ms": 1.4808105212522016, "mean_action_processing_ms": 0.17499329319878054, "mean_env_wait_ms": 0.10428316371603405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028986454010009766, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.15187811851501465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4673.278431924549, "num_env_steps_trained_throughput_per_sec": 4673.278431924549, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3902.59, "sample_time_ms": 3392.762, "load_time_ms": 38.635, "load_throughput": 465904.36, "learn_time_ms": 452.453, "learn_throughput": 39783.159, "synch_weights_time_ms": 16.894}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2428, "training_iteration": 36, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-16", "timestamp": 1698246436, "time_this_iter_s": 3.8566815853118896, "time_total_s": 139.49857592582703, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.49857592582703, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 74.12, "ram_util_percent": 30.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.78639600276947, "policy_loss": -0.01817648708820343, "vf_loss": 6.804625153541565, "vf_explained_var": -1.1622905731201172e-06, "kl": 0.0002391480513082911, "entropy": 0.5267829716205596, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 730.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.054999999999835, "episode_len_mean": 255.1, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 45.1, 42.500000000000014, 45.1, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.900000000000006, 32.100000000000016, 27.49999999999995, 43.900000000000006, 40.10000000000002, 20.899999999999856, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 29.49999999999998, 43.7, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.10000000000001, 35.30000000000004, -50.00000000000044, 42.900000000000006, 32.30000000000002, 42.30000000000001, 47.7, 44.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.900000000000006, 34.70000000000004, 44.900000000000006, 45.5, -50.00000000000044, 46.099999999999994, 19.09999999999983, 42.30000000000001, 42.30000000000001, 43.900000000000006, 16.29999999999979, 45.3, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, 32.100000000000016, 11.29999999999972, 34.70000000000004, -50.00000000000044, 39.10000000000002, 43.900000000000006, -50.00000000000044, 17.499999999999808, 40.30000000000002, 26.89999999999994, -50.00000000000044, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.7, 44.5, 25.899999999999928, 45.7, 39.90000000000002, 33.90000000000004, 42.70000000000001, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [100, 500, 500, 404, 50, 76, 50, 124, 500, 500, 500, 500, 386, 500, 500, 52, 180, 226, 62, 100, 292, 48, 500, 500, 500, 500, 500, 128, 206, 64, 500, 38, 46, 500, 84, 500, 500, 146, 500, 108, 500, 36, 500, 500, 148, 60, 148, 500, 72, 178, 78, 24, 54, 500, 130, 500, 72, 154, 52, 46, 500, 40, 310, 78, 78, 62, 338, 48, 500, 76, 38, 500, 180, 388, 154, 500, 110, 62, 500, 326, 98, 232, 500, 28, 500, 108, 500, 44, 56, 242, 44, 102, 162, 74, 148, 78, 500, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46389573974391646, "mean_inference_ms": 1.4809993746489085, "mean_action_processing_ms": 0.17486296253718478, "mean_env_wait_ms": 0.1044464056484389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03602719306945801, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.16346001625061035}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.054999999999835, "episode_len_mean": 255.1, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, -50.00000000000044, 9.699999999999697, 45.1, 42.500000000000014, 45.1, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.900000000000006, 32.100000000000016, 27.49999999999995, 43.900000000000006, 40.10000000000002, 20.899999999999856, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 29.49999999999998, 43.7, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.10000000000001, 35.30000000000004, -50.00000000000044, 42.900000000000006, 32.30000000000002, 42.30000000000001, 47.7, 44.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 42.900000000000006, 34.70000000000004, 44.900000000000006, 45.5, -50.00000000000044, 46.099999999999994, 19.09999999999983, 42.30000000000001, 42.30000000000001, 43.900000000000006, 16.29999999999979, 45.3, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, 32.100000000000016, 11.29999999999972, 34.70000000000004, -50.00000000000044, 39.10000000000002, 43.900000000000006, -50.00000000000044, 17.499999999999808, 40.30000000000002, 26.89999999999994, -50.00000000000044, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.7, 44.5, 25.899999999999928, 45.7, 39.90000000000002, 33.90000000000004, 42.70000000000001, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [100, 500, 500, 404, 50, 76, 50, 124, 500, 500, 500, 500, 386, 500, 500, 52, 180, 226, 62, 100, 292, 48, 500, 500, 500, 500, 500, 128, 206, 64, 500, 38, 46, 500, 84, 500, 500, 146, 500, 108, 500, 36, 500, 500, 148, 60, 148, 500, 72, 178, 78, 24, 54, 500, 130, 500, 72, 154, 52, 46, 500, 40, 310, 78, 78, 62, 338, 48, 500, 76, 38, 500, 180, 388, 154, 500, 110, 62, 500, 326, 98, 232, 500, 28, 500, 108, 500, 44, 56, 242, 44, 102, 162, 74, 148, 78, 500, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46389573974391646, "mean_inference_ms": 1.4809993746489085, "mean_action_processing_ms": 0.17486296253718478, "mean_env_wait_ms": 0.1044464056484389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03602719306945801, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.16346001625061035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4455.1795113891185, "num_env_steps_trained_throughput_per_sec": 4455.1795113891185, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3924.984, "sample_time_ms": 3412.249, "load_time_ms": 38.952, "load_throughput": 462105.878, "learn_time_ms": 455.244, "learn_throughput": 39539.276, "synch_weights_time_ms": 16.793}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2502, "training_iteration": 37, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-21", "timestamp": 1698246441, "time_this_iter_s": 4.047238111495972, "time_total_s": 143.545814037323, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 143.545814037323, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 69.11666666666667, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.881429433822632, "policy_loss": -0.04070879369974136, "vf_loss": 6.922187757492066, "vf_explained_var": -1.6629695892333984e-06, "kl": 0.0001060866006682204, "entropy": 0.4959033414721489, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 750.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2069999999998355, "episode_len_mean": 243.56, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.30000000000002, 26.89999999999994, -50.00000000000044, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.7, 44.5, 25.899999999999928, 45.7, 39.90000000000002, 33.90000000000004, 42.70000000000001, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 26.09999999999993, 43.50000000000001, 43.50000000000001, 44.900000000000006, 46.5, 29.099999999999973, 45.9, 46.3, 41.90000000000001, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 47.1, 44.900000000000006, 30.099999999999987, 39.70000000000002, -50.00000000000044, 18.899999999999828, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.900000000000006, 38.90000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.700000000000024, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.30000000000001, 45.9, -50.00000000000044, 39.300000000000026, 43.10000000000001, 22.49999999999988, 41.500000000000014, 46.699999999999996, 45.1, 45.9, 43.50000000000001, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044], "episode_lengths": [98, 232, 500, 28, 500, 108, 500, 44, 56, 242, 44, 102, 162, 74, 148, 78, 500, 500, 500, 84, 500, 60, 240, 66, 66, 52, 36, 210, 42, 38, 82, 34, 500, 42, 500, 30, 52, 200, 104, 500, 312, 500, 112, 500, 500, 124, 52, 112, 226, 500, 500, 84, 500, 500, 500, 40, 94, 52, 500, 500, 174, 104, 500, 500, 500, 58, 68, 42, 500, 108, 70, 276, 86, 34, 50, 42, 66, 500, 58, 50, 500, 38, 500, 500, 500, 500, 500, 70, 108, 500, 142, 500, 30, 500, 500, 500, 42, 42, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46377502761914385, "mean_inference_ms": 1.4808576857380076, "mean_action_processing_ms": 0.17500285857127146, "mean_env_wait_ms": 0.10462948773578179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500533103942871, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.1360151767730713}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2069999999998355, "episode_len_mean": 243.56, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.30000000000002, 26.89999999999994, -50.00000000000044, 47.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.7, 44.5, 25.899999999999928, 45.7, 39.90000000000002, 33.90000000000004, 42.70000000000001, 35.30000000000004, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.10000000000001, 26.09999999999993, 43.50000000000001, 43.50000000000001, 44.900000000000006, 46.5, 29.099999999999973, 45.9, 46.3, 41.90000000000001, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, 47.1, 44.900000000000006, 30.099999999999987, 39.70000000000002, -50.00000000000044, 18.899999999999828, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.900000000000006, 38.90000000000002, 27.49999999999995, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 32.700000000000024, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.30000000000001, 45.9, -50.00000000000044, 39.300000000000026, 43.10000000000001, 22.49999999999988, 41.500000000000014, 46.699999999999996, 45.1, 45.9, 43.50000000000001, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044], "episode_lengths": [98, 232, 500, 28, 500, 108, 500, 44, 56, 242, 44, 102, 162, 74, 148, 78, 500, 500, 500, 84, 500, 60, 240, 66, 66, 52, 36, 210, 42, 38, 82, 34, 500, 42, 500, 30, 52, 200, 104, 500, 312, 500, 112, 500, 500, 124, 52, 112, 226, 500, 500, 84, 500, 500, 500, 40, 94, 52, 500, 500, 174, 104, 500, 500, 500, 58, 68, 42, 500, 108, 70, 276, 86, 34, 50, 42, 66, 500, 58, 50, 500, 38, 500, 500, 500, 500, 500, 70, 108, 500, 142, 500, 30, 500, 500, 500, 42, 42, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46377502761914385, "mean_inference_ms": 1.4808576857380076, "mean_action_processing_ms": 0.17500285857127146, "mean_env_wait_ms": 0.10462948773578179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500533103942871, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.1360151767730713}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4566.237764643508, "num_env_steps_trained_throughput_per_sec": 4566.237764643508, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3926.464, "sample_time_ms": 3411.014, "load_time_ms": 38.535, "load_throughput": 467108.704, "learn_time_ms": 458.188, "learn_throughput": 39285.226, "synch_weights_time_ms": 16.826}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2582, "training_iteration": 38, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-25", "timestamp": 1698246445, "time_this_iter_s": 3.947974920272827, "time_total_s": 147.49378895759583, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.49378895759583, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 77.08, "ram_util_percent": 30.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.2327879667282104, "policy_loss": -0.03689841479063034, "vf_loss": 6.269734668731689, "vf_explained_var": -7.867813110351562e-07, "kl": 0.00037997967697265265, "entropy": 0.48325863033533095, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 770.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.20199999999982, "episode_len_mean": 248.6, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 43.30000000000001, 45.9, -50.00000000000044, 39.300000000000026, 43.10000000000001, 22.49999999999988, 41.500000000000014, 46.699999999999996, 45.1, 45.9, 43.50000000000001, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044, 27.699999999999953, 39.50000000000002, 45.9, 46.699999999999996, -50.00000000000044, 23.099999999999888, 44.7, 45.1, 46.099999999999994, 46.699999999999996, 21.89999999999987, 44.10000000000001, -50.00000000000044, 47.5, 9.699999999999697, -50.00000000000044, 46.3, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.7, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, 46.3, 41.500000000000014, 46.5, 25.099999999999916, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.30000000000001, 4.099999999999618, 40.500000000000014, 45.9, 45.9, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [500, 58, 68, 42, 500, 108, 70, 276, 86, 34, 50, 42, 66, 500, 58, 50, 500, 38, 500, 500, 500, 500, 500, 70, 108, 500, 142, 500, 30, 500, 500, 500, 42, 42, 36, 500, 224, 106, 42, 34, 500, 270, 54, 50, 40, 34, 282, 60, 500, 26, 404, 500, 38, 54, 500, 36, 500, 500, 32, 500, 500, 46, 500, 500, 54, 500, 54, 58, 500, 56, 500, 500, 74, 500, 74, 38, 86, 36, 250, 500, 480, 500, 500, 94, 88, 460, 96, 42, 42, 500, 46, 82, 500, 78, 88, 500, 54, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46436453037931286, "mean_inference_ms": 1.4794687355253817, "mean_action_processing_ms": 0.1748631196109955, "mean_env_wait_ms": 0.10449897837640662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031014680862426758, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.16702508926391602}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.20199999999982, "episode_len_mean": 248.6, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 43.30000000000001, 45.9, -50.00000000000044, 39.300000000000026, 43.10000000000001, 22.49999999999988, 41.500000000000014, 46.699999999999996, 45.1, 45.9, 43.50000000000001, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, 35.900000000000034, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.5, -50.00000000000044, 27.699999999999953, 39.50000000000002, 45.9, 46.699999999999996, -50.00000000000044, 23.099999999999888, 44.7, 45.1, 46.099999999999994, 46.699999999999996, 21.89999999999987, 44.10000000000001, -50.00000000000044, 47.5, 9.699999999999697, -50.00000000000044, 46.3, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 44.7, 44.300000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, 46.3, 41.500000000000014, 46.5, 25.099999999999916, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.30000000000001, 4.099999999999618, 40.500000000000014, 45.9, 45.9, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [500, 58, 68, 42, 500, 108, 70, 276, 86, 34, 50, 42, 66, 500, 58, 50, 500, 38, 500, 500, 500, 500, 500, 70, 108, 500, 142, 500, 30, 500, 500, 500, 42, 42, 36, 500, 224, 106, 42, 34, 500, 270, 54, 50, 40, 34, 282, 60, 500, 26, 404, 500, 38, 54, 500, 36, 500, 500, 32, 500, 500, 46, 500, 500, 54, 500, 54, 58, 500, 56, 500, 500, 74, 500, 74, 38, 86, 36, 250, 500, 480, 500, 500, 94, 88, 460, 96, 42, 42, 500, 46, 82, 500, 78, 88, 500, 54, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46436453037931286, "mean_inference_ms": 1.4794687355253817, "mean_action_processing_ms": 0.1748631196109955, "mean_env_wait_ms": 0.10449897837640662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031014680862426758, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.16702508926391602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4684.114865291203, "num_env_steps_trained_throughput_per_sec": 4684.114865291203, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3921.553, "sample_time_ms": 3405.211, "load_time_ms": 37.241, "load_throughput": 483337.87, "learn_time_ms": 460.303, "learn_throughput": 39104.647, "synch_weights_time_ms": 16.797}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2646, "training_iteration": 39, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-28", "timestamp": 1698246448, "time_this_iter_s": 3.847776412963867, "time_total_s": 151.3415653705597, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.3415653705597, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 64.51666666666665, "ram_util_percent": 30.916666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.894384050369263, "policy_loss": 0.0004336108453571796, "vf_loss": 6.893995332717895, "vf_explained_var": -8.225440979003907e-07, "kl": 0.0001344331690972922, "entropy": 0.4494256928563118, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 790.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.788999999999817, "episode_len_mean": 257.74, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.099999999999916, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.30000000000001, 4.099999999999618, 40.500000000000014, 45.9, 45.9, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 16.499999999999794, 46.099999999999994, 42.900000000000006, -50.00000000000044, 23.8999999999999, 45.5, 47.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 33.70000000000004, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 42.10000000000001, 36.900000000000034, 35.500000000000036, 45.9, 25.29999999999992, 25.099999999999916, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 29.899999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 44.300000000000004, 48.1, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 45.7, 43.30000000000001, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.3, 30.699999999999996, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 47.7, 43.50000000000001, 45.9, 36.900000000000034], "episode_lengths": [250, 500, 480, 500, 500, 94, 88, 460, 96, 42, 42, 500, 46, 82, 500, 78, 88, 500, 54, 500, 500, 82, 336, 40, 72, 500, 262, 46, 28, 500, 90, 500, 500, 500, 262, 500, 164, 48, 500, 42, 500, 44, 80, 132, 146, 42, 248, 250, 500, 500, 214, 40, 500, 500, 24, 202, 500, 34, 500, 50, 58, 20, 64, 500, 500, 76, 500, 56, 500, 500, 36, 62, 44, 68, 500, 414, 500, 500, 44, 28, 48, 194, 486, 500, 500, 500, 146, 140, 500, 500, 40, 26, 500, 500, 38, 44, 24, 66, 42, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46347721202209513, "mean_inference_ms": 1.4790675611151811, "mean_action_processing_ms": 0.17494728053348513, "mean_env_wait_ms": 0.10436726706589955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.001995563507080078, "ViewRequirementAgentConnector_ms": 0.14395546913146973}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.788999999999817, "episode_len_mean": 257.74, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.099999999999916, -50.00000000000044, 2.0999999999995893, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.30000000000001, 4.099999999999618, 40.500000000000014, 45.9, 45.9, -50.00000000000044, 45.5, 41.90000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 16.499999999999794, 46.099999999999994, 42.900000000000006, -50.00000000000044, 23.8999999999999, 45.5, 47.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 33.70000000000004, 45.3, -50.00000000000044, 45.9, -50.00000000000044, 45.7, 42.10000000000001, 36.900000000000034, 35.500000000000036, 45.9, 25.29999999999992, 25.099999999999916, -50.00000000000044, -50.00000000000044, 28.699999999999967, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.7, 29.899999999999984, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 44.300000000000004, 48.1, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 45.7, 43.30000000000001, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.3, 30.699999999999996, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 47.7, 43.50000000000001, 45.9, 36.900000000000034], "episode_lengths": [250, 500, 480, 500, 500, 94, 88, 460, 96, 42, 42, 500, 46, 82, 500, 78, 88, 500, 54, 500, 500, 82, 336, 40, 72, 500, 262, 46, 28, 500, 90, 500, 500, 500, 262, 500, 164, 48, 500, 42, 500, 44, 80, 132, 146, 42, 248, 250, 500, 500, 214, 40, 500, 500, 24, 202, 500, 34, 500, 50, 58, 20, 64, 500, 500, 76, 500, 56, 500, 500, 36, 62, 44, 68, 500, 414, 500, 500, 44, 28, 48, 194, 486, 500, 500, 500, 146, 140, 500, 500, 40, 26, 500, 500, 38, 44, 24, 66, 42, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46347721202209513, "mean_inference_ms": 1.4790675611151811, "mean_action_processing_ms": 0.17494728053348513, "mean_env_wait_ms": 0.10436726706589955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.001995563507080078, "ViewRequirementAgentConnector_ms": 0.14395546913146973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4612.315036919305, "num_env_steps_trained_throughput_per_sec": 4612.315036919305, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3929.908, "sample_time_ms": 3420.612, "load_time_ms": 36.717, "load_throughput": 490241.733, "learn_time_ms": 453.766, "learn_throughput": 39668.065, "synch_weights_time_ms": 16.913}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2724, "training_iteration": 40, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-32", "timestamp": 1698246452, "time_this_iter_s": 3.909191370010376, "time_total_s": 155.25075674057007, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.25075674057007, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 77.7, "ram_util_percent": 30.919999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.010893416404724, "policy_loss": -0.021054657548666, "vf_loss": 6.031987547874451, "vf_explained_var": -1.341104507446289e-06, "kl": 0.0005185436062149051, "entropy": 0.3946340441703796, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 810.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2470000000002122, "episode_len_mean": 278.0, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 44.300000000000004, 48.1, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 45.7, 43.30000000000001, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.3, 30.699999999999996, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 47.7, 43.50000000000001, 45.9, 36.900000000000034, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 40.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 47.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 45.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.5, 34.30000000000004, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 58, 20, 64, 500, 500, 76, 500, 56, 500, 500, 36, 62, 44, 68, 500, 414, 500, 500, 44, 28, 48, 194, 486, 500, 500, 500, 146, 140, 500, 500, 40, 26, 500, 500, 38, 44, 24, 66, 42, 132, 500, 40, 500, 500, 500, 28, 500, 500, 44, 500, 52, 52, 500, 500, 170, 96, 60, 500, 500, 500, 116, 500, 500, 24, 64, 500, 500, 500, 70, 500, 42, 48, 54, 34, 500, 500, 500, 500, 500, 82, 48, 500, 500, 228, 50, 34, 500, 500, 76, 56, 158, 500, 36, 28, 500, 64, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46359776371828054, "mean_inference_ms": 1.4794628213569663, "mean_action_processing_ms": 0.17469321463166484, "mean_env_wait_ms": 0.10450903611023847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279843807220459, "StateBufferConnector_ms": 0.004957437515258789, "ViewRequirementAgentConnector_ms": 0.12863636016845703}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2470000000002122, "episode_len_mean": 278.0, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 44.300000000000004, 48.1, 43.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 45.7, 43.30000000000001, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 45.7, 47.3, 45.3, 30.699999999999996, 1.4999999999995808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, 46.3, 45.7, 47.7, 43.50000000000001, 45.9, 36.900000000000034, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 40.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 47.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 45.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.5, 34.30000000000004, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 58, 20, 64, 500, 500, 76, 500, 56, 500, 500, 36, 62, 44, 68, 500, 414, 500, 500, 44, 28, 48, 194, 486, 500, 500, 500, 146, 140, 500, 500, 40, 26, 500, 500, 38, 44, 24, 66, 42, 132, 500, 40, 500, 500, 500, 28, 500, 500, 44, 500, 52, 52, 500, 500, 170, 96, 60, 500, 500, 500, 116, 500, 500, 24, 64, 500, 500, 500, 70, 500, 42, 48, 54, 34, 500, 500, 500, 500, 500, 82, 48, 500, 500, 228, 50, 34, 500, 500, 76, 56, 158, 500, 36, 28, 500, 64, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46359776371828054, "mean_inference_ms": 1.4794628213569663, "mean_action_processing_ms": 0.17469321463166484, "mean_env_wait_ms": 0.10450903611023847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279843807220459, "StateBufferConnector_ms": 0.004957437515258789, "ViewRequirementAgentConnector_ms": 0.12863636016845703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4897.118918742207, "num_env_steps_trained_throughput_per_sec": 4897.118918742207, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3900.067, "sample_time_ms": 3413.701, "load_time_ms": 35.356, "load_throughput": 509110.84, "learn_time_ms": 433.034, "learn_throughput": 41567.135, "synch_weights_time_ms": 16.075}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2783, "training_iteration": 41, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-36", "timestamp": 1698246456, "time_this_iter_s": 3.6816318035125732, "time_total_s": 158.93238854408264, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.93238854408264, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 74.2, "ram_util_percent": 30.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.467523527145386, "policy_loss": -0.0325823076069355, "vf_loss": 6.500147366523743, "vf_explained_var": -1.817941665649414e-06, "kl": 0.00022124726776837634, "entropy": 0.4157989501953125, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 830.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9689999999998065, "episode_len_mean": 265.88, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 45.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.5, 34.30000000000004, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 29.899999999999984, 43.50000000000001, 46.099999999999994, 46.9, -50.00000000000044, 46.9, 47.9, 46.699999999999996, 32.700000000000024, 28.89999999999997, -50.00000000000044, 40.10000000000002, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 26.69999999999994, -50.00000000000044, 42.10000000000001, 38.50000000000003, 46.3, -50.00000000000044, 47.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 15.49999999999978, -50.00000000000044, 47.1, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.500000000000014, 44.900000000000006, 47.1, 29.299999999999976, 45.3, 11.899999999999729, 34.900000000000034, 44.7, -50.00000000000044, 44.300000000000004, 35.500000000000036, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 70, 500, 42, 48, 54, 34, 500, 500, 500, 500, 500, 82, 48, 500, 500, 228, 50, 34, 500, 500, 76, 56, 158, 500, 36, 28, 500, 64, 500, 500, 500, 500, 198, 500, 36, 500, 500, 202, 66, 40, 32, 500, 32, 22, 34, 174, 212, 500, 100, 38, 62, 500, 500, 500, 500, 500, 500, 500, 186, 500, 234, 500, 80, 116, 38, 500, 26, 32, 500, 500, 500, 500, 46, 346, 500, 30, 52, 34, 500, 500, 70, 62, 76, 52, 30, 208, 48, 382, 152, 54, 500, 58, 146, 500, 28, 62, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628271913913833, "mean_inference_ms": 1.4782317030926229, "mean_action_processing_ms": 0.1748117230484514, "mean_env_wait_ms": 0.10431537574605361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033944129943847656, "StateBufferConnector_ms": 0.008959770202636719, "ViewRequirementAgentConnector_ms": 0.13901948928833008}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9689999999998065, "episode_len_mean": 265.88, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 45.9, 45.3, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 27.299999999999947, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.5, 34.30000000000004, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.29999999999999, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 29.899999999999984, 43.50000000000001, 46.099999999999994, 46.9, -50.00000000000044, 46.9, 47.9, 46.699999999999996, 32.700000000000024, 28.89999999999997, -50.00000000000044, 40.10000000000002, 46.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 26.69999999999994, -50.00000000000044, 42.10000000000001, 38.50000000000003, 46.3, -50.00000000000044, 47.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 15.49999999999978, -50.00000000000044, 47.1, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.500000000000014, 44.900000000000006, 47.1, 29.299999999999976, 45.3, 11.899999999999729, 34.900000000000034, 44.7, -50.00000000000044, 44.300000000000004, 35.500000000000036, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 70, 500, 42, 48, 54, 34, 500, 500, 500, 500, 500, 82, 48, 500, 500, 228, 50, 34, 500, 500, 76, 56, 158, 500, 36, 28, 500, 64, 500, 500, 500, 500, 198, 500, 36, 500, 500, 202, 66, 40, 32, 500, 32, 22, 34, 174, 212, 500, 100, 38, 62, 500, 500, 500, 500, 500, 500, 500, 186, 500, 234, 500, 80, 116, 38, 500, 26, 32, 500, 500, 500, 500, 46, 346, 500, 30, 52, 34, 500, 500, 70, 62, 76, 52, 30, 208, 48, 382, 152, 54, 500, 58, 146, 500, 28, 62, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628271913913833, "mean_inference_ms": 1.4782317030926229, "mean_action_processing_ms": 0.1748117230484514, "mean_env_wait_ms": 0.10431537574605361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033944129943847656, "StateBufferConnector_ms": 0.008959770202636719, "ViewRequirementAgentConnector_ms": 0.13901948928833008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5058.553003048567, "num_env_steps_trained_throughput_per_sec": 5058.553003048567, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3856.853, "sample_time_ms": 3399.006, "load_time_ms": 33.345, "load_throughput": 539805.149, "learn_time_ms": 407.0, "learn_throughput": 44226.024, "synch_weights_time_ms": 15.598}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2851, "training_iteration": 42, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-40", "timestamp": 1698246460, "time_this_iter_s": 3.5643134117126465, "time_total_s": 162.4967019557953, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.4967019557953, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 76.52000000000001, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.427466320991516, "policy_loss": 0.0371345579624176, "vf_loss": 6.390370202064514, "vf_explained_var": -9.685754776000977e-07, "kl": 0.00030940842455349225, "entropy": 0.38510417491197585, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 850.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.605999999999835, "episode_len_mean": 234.58, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 15.49999999999978, -50.00000000000044, 47.1, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.500000000000014, 44.900000000000006, 47.1, 29.299999999999976, 45.3, 11.899999999999729, 34.900000000000034, 44.7, -50.00000000000044, 44.300000000000004, 35.500000000000036, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.30000000000004, 45.5, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 46.699999999999996, 31.1, 47.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.1, 47.5, 46.099999999999994, 42.900000000000006, 45.1, -50.00000000000044, 32.30000000000002, 21.89999999999987, -50.00000000000044, 46.099999999999994, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.9, 45.7, -50.00000000000044, 22.49999999999988, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, 39.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, 45.9, -50.00000000000044, 47.3, 23.499999999999893, 43.10000000000001, 33.90000000000004, -50.00000000000044], "episode_lengths": [46, 346, 500, 30, 52, 34, 500, 500, 70, 62, 76, 52, 30, 208, 48, 382, 152, 54, 500, 58, 146, 500, 28, 62, 500, 84, 500, 148, 46, 500, 42, 32, 500, 34, 190, 24, 500, 500, 182, 50, 26, 40, 72, 50, 500, 178, 282, 500, 40, 48, 26, 500, 500, 54, 500, 42, 32, 44, 500, 276, 500, 98, 50, 500, 500, 30, 500, 34, 500, 88, 38, 60, 500, 24, 500, 40, 128, 500, 500, 500, 500, 500, 28, 36, 102, 62, 500, 500, 500, 500, 500, 26, 68, 42, 500, 28, 266, 70, 162, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4630148731072449, "mean_inference_ms": 1.4782233552509358, "mean_action_processing_ms": 0.17484362958353258, "mean_env_wait_ms": 0.10439617635691607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03786969184875488, "StateBufferConnector_ms": 0.009502887725830078, "ViewRequirementAgentConnector_ms": 0.16729521751403809}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.605999999999835, "episode_len_mean": 234.58, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 15.49999999999978, -50.00000000000044, 47.1, 44.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 42.500000000000014, 44.900000000000006, 47.1, 29.299999999999976, 45.3, 11.899999999999729, 34.900000000000034, 44.7, -50.00000000000044, 44.300000000000004, 35.500000000000036, -50.00000000000044, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.30000000000004, 45.5, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 46.699999999999996, 31.1, 47.7, -50.00000000000044, -50.00000000000044, 31.900000000000013, 45.1, 47.5, 46.099999999999994, 42.900000000000006, 45.1, -50.00000000000044, 32.30000000000002, 21.89999999999987, -50.00000000000044, 46.099999999999994, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.9, 45.7, -50.00000000000044, 22.49999999999988, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, 39.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, 45.9, -50.00000000000044, 47.3, 23.499999999999893, 43.10000000000001, 33.90000000000004, -50.00000000000044], "episode_lengths": [46, 346, 500, 30, 52, 34, 500, 500, 70, 62, 76, 52, 30, 208, 48, 382, 152, 54, 500, 58, 146, 500, 28, 62, 500, 84, 500, 148, 46, 500, 42, 32, 500, 34, 190, 24, 500, 500, 182, 50, 26, 40, 72, 50, 500, 178, 282, 500, 40, 48, 26, 500, 500, 54, 500, 42, 32, 44, 500, 276, 500, 98, 50, 500, 500, 30, 500, 34, 500, 88, 38, 60, 500, 24, 500, 40, 128, 500, 500, 500, 500, 500, 28, 36, 102, 62, 500, 500, 500, 500, 500, 26, 68, 42, 500, 28, 266, 70, 162, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4630148731072449, "mean_inference_ms": 1.4782233552509358, "mean_action_processing_ms": 0.17484362958353258, "mean_env_wait_ms": 0.10439617635691607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03786969184875488, "StateBufferConnector_ms": 0.009502887725830078, "ViewRequirementAgentConnector_ms": 0.16729521751403809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4873.180556481634, "num_env_steps_trained_throughput_per_sec": 4873.180556481634, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3840.135, "sample_time_ms": 3405.757, "load_time_ms": 30.489, "load_throughput": 590375.171, "learn_time_ms": 386.192, "learn_throughput": 46608.982, "synch_weights_time_ms": 15.675}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2924, "training_iteration": 43, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-43", "timestamp": 1698246463, "time_this_iter_s": 3.6995677947998047, "time_total_s": 166.1962697505951, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.1962697505951, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 76.93333333333332, "ram_util_percent": 30.950000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 5.893038964271545, "policy_loss": 0.06346932426095009, "vf_loss": 5.829609203338623, "vf_explained_var": -5.483627319335937e-07, "kl": 6.015717360696726e-06, "entropy": 0.3949362635612488, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.7600000000002267, "episode_len_mean": 288.1, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.49999999999988, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, 39.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, 45.9, -50.00000000000044, 47.3, 23.499999999999893, 43.10000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 14.299999999999763, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 13.899999999999757, 47.1, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.500000000000014, 46.099999999999994, 47.5, 45.3, 47.3, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.3, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, -50.00000000000044, 45.9], "episode_lengths": [276, 500, 98, 50, 500, 500, 30, 500, 34, 500, 88, 38, 60, 500, 24, 500, 40, 128, 500, 500, 500, 500, 500, 28, 36, 102, 62, 500, 500, 500, 500, 500, 26, 68, 42, 500, 28, 266, 70, 162, 500, 500, 500, 26, 500, 500, 82, 500, 500, 500, 500, 500, 48, 500, 358, 66, 30, 500, 500, 36, 46, 362, 30, 50, 500, 500, 500, 500, 500, 500, 40, 500, 50, 500, 500, 42, 500, 500, 500, 500, 64, 500, 96, 40, 26, 48, 28, 500, 500, 36, 46, 38, 44, 86, 500, 500, 72, 122, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633135380461331, "mean_inference_ms": 1.4767411190552153, "mean_action_processing_ms": 0.1748032798577679, "mean_env_wait_ms": 0.10425082125237867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350031852722168, "StateBufferConnector_ms": 0.010987997055053711, "ViewRequirementAgentConnector_ms": 0.1520226001739502}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.7600000000002267, "episode_len_mean": 288.1, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.49999999999988, -50.00000000000044, 40.30000000000002, 45.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, 46.3, 44.10000000000001, -50.00000000000044, 47.7, -50.00000000000044, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 46.5, 39.90000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, 45.9, -50.00000000000044, 47.3, 23.499999999999893, 43.10000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 14.299999999999763, 43.50000000000001, 47.1, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 13.899999999999757, 47.1, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.500000000000014, 46.099999999999994, 47.5, 45.3, 47.3, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.3, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, -50.00000000000044, 45.9], "episode_lengths": [276, 500, 98, 50, 500, 500, 30, 500, 34, 500, 88, 38, 60, 500, 24, 500, 40, 128, 500, 500, 500, 500, 500, 28, 36, 102, 62, 500, 500, 500, 500, 500, 26, 68, 42, 500, 28, 266, 70, 162, 500, 500, 500, 26, 500, 500, 82, 500, 500, 500, 500, 500, 48, 500, 358, 66, 30, 500, 500, 36, 46, 362, 30, 50, 500, 500, 500, 500, 500, 500, 40, 500, 50, 500, 500, 42, 500, 500, 500, 500, 64, 500, 96, 40, 26, 48, 28, 500, 500, 36, 46, 38, 44, 86, 500, 500, 72, 122, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633135380461331, "mean_inference_ms": 1.4767411190552153, "mean_action_processing_ms": 0.1748032798577679, "mean_env_wait_ms": 0.10425082125237867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350031852722168, "StateBufferConnector_ms": 0.010987997055053711, "ViewRequirementAgentConnector_ms": 0.1520226001739502}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5040.880708070486, "num_env_steps_trained_throughput_per_sec": 5040.880708070486, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3802.23, "sample_time_ms": 3394.815, "load_time_ms": 29.194, "load_throughput": 616566.613, "learn_time_ms": 361.11, "learn_throughput": 49846.351, "synch_weights_time_ms": 15.19}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2983, "training_iteration": 44, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-47", "timestamp": 1698246467, "time_this_iter_s": 3.57631778717041, "time_total_s": 169.7725875377655, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.7725875377655, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 77.74000000000001, "ram_util_percent": 31.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.317778706550598, "policy_loss": -0.037908190162852407, "vf_loss": 6.355726552009583, "vf_explained_var": -9.238719940185547e-07, "kl": 0.0003641838422408838, "entropy": 0.39580402672290804, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 890.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.2489999999997944, "episode_len_mean": 273.06, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.500000000000014, 46.099999999999994, 47.5, 45.3, 47.3, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.3, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 46.699999999999996, -50.00000000000044, 44.900000000000006, 39.300000000000026, 47.1, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 23.8999999999999, 47.3, 46.099999999999994, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.499999999999936, 31.1, 45.9, 47.1, -50.00000000000044, 46.3, 42.30000000000001, 42.500000000000014, 47.5, 17.69999999999981, -50.00000000000044, 45.5, 41.90000000000001, 47.1, 38.300000000000026, -50.00000000000044, 17.499999999999808, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 39.70000000000002, 47.3, 9.299999999999692, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 40, 500, 50, 500, 500, 42, 500, 500, 500, 500, 64, 500, 96, 40, 26, 48, 28, 500, 500, 36, 46, 38, 44, 86, 500, 500, 72, 122, 500, 42, 500, 142, 34, 500, 52, 108, 30, 500, 114, 62, 500, 52, 500, 500, 500, 500, 500, 500, 48, 262, 28, 40, 94, 500, 34, 500, 102, 500, 500, 36, 500, 40, 500, 500, 236, 190, 42, 30, 500, 38, 78, 76, 26, 324, 500, 46, 82, 30, 118, 500, 326, 500, 44, 500, 500, 500, 300, 104, 28, 408, 500, 36, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4629228177404854, "mean_inference_ms": 1.4742671144434465, "mean_action_processing_ms": 0.17473414921130506, "mean_env_wait_ms": 0.10418498580919634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042005062103271484, "StateBufferConnector_ms": 0.008996248245239258, "ViewRequirementAgentConnector_ms": 0.13297629356384277}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.2489999999997944, "episode_len_mean": 273.06, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.500000000000014, 46.099999999999994, 47.5, 45.3, 47.3, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.3, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 46.699999999999996, -50.00000000000044, 44.900000000000006, 39.300000000000026, 47.1, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 23.8999999999999, 47.3, 46.099999999999994, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 26.499999999999936, 31.1, 45.9, 47.1, -50.00000000000044, 46.3, 42.30000000000001, 42.500000000000014, 47.5, 17.69999999999981, -50.00000000000044, 45.5, 41.90000000000001, 47.1, 38.300000000000026, -50.00000000000044, 17.499999999999808, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 39.70000000000002, 47.3, 9.299999999999692, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 40, 500, 50, 500, 500, 42, 500, 500, 500, 500, 64, 500, 96, 40, 26, 48, 28, 500, 500, 36, 46, 38, 44, 86, 500, 500, 72, 122, 500, 42, 500, 142, 34, 500, 52, 108, 30, 500, 114, 62, 500, 52, 500, 500, 500, 500, 500, 500, 48, 262, 28, 40, 94, 500, 34, 500, 102, 500, 500, 36, 500, 40, 500, 500, 236, 190, 42, 30, 500, 38, 78, 76, 26, 324, 500, 46, 82, 30, 118, 500, 326, 500, 44, 500, 500, 500, 300, 104, 28, 408, 500, 36, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4629228177404854, "mean_inference_ms": 1.4742671144434465, "mean_action_processing_ms": 0.17473414921130506, "mean_env_wait_ms": 0.10418498580919634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042005062103271484, "StateBufferConnector_ms": 0.008996248245239258, "ViewRequirementAgentConnector_ms": 0.13297629356384277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5179.221611701509, "num_env_steps_trained_throughput_per_sec": 5179.221611701509, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3755.315, "sample_time_ms": 3373.863, "load_time_ms": 28.192, "load_throughput": 638483.42, "learn_time_ms": 337.045, "learn_throughput": 53405.411, "synch_weights_time_ms": 14.494}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3049, "training_iteration": 45, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-50", "timestamp": 1698246470, "time_this_iter_s": 3.4810330867767334, "time_total_s": 173.25362062454224, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 173.25362062454224, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 73.96, "ram_util_percent": 31.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.127515554428101, "policy_loss": 0.01449092999100685, "vf_loss": 6.113065075874329, "vf_explained_var": -9.596347808837891e-07, "kl": 0.0006287614504799421, "entropy": 0.40469622164964675, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 910.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5369999999997963, "episode_len_mean": 270.2, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 26.499999999999936, 31.1, 45.9, 47.1, -50.00000000000044, 46.3, 42.30000000000001, 42.500000000000014, 47.5, 17.69999999999981, -50.00000000000044, 45.5, 41.90000000000001, 47.1, 38.300000000000026, -50.00000000000044, 17.499999999999808, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 39.70000000000002, 47.3, 9.299999999999692, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 47.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, 45.7, 43.7, 47.7, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, 16.699999999999797, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 45.3, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.90000000000002, 42.70000000000001, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.10000000000001, 47.1, 35.30000000000004, 47.7, -50.00000000000044, -50.00000000000044, 47.3], "episode_lengths": [500, 500, 236, 190, 42, 30, 500, 38, 78, 76, 26, 324, 500, 46, 82, 30, 118, 500, 326, 500, 44, 500, 500, 500, 300, 104, 28, 408, 500, 36, 46, 500, 500, 500, 500, 500, 500, 62, 500, 42, 28, 38, 500, 500, 500, 500, 500, 26, 500, 500, 500, 52, 500, 46, 42, 500, 500, 500, 396, 44, 64, 24, 500, 500, 108, 500, 36, 334, 44, 500, 500, 62, 24, 68, 500, 34, 500, 38, 48, 66, 500, 40, 500, 152, 58, 500, 500, 326, 92, 74, 500, 104, 40, 70, 30, 148, 24, 500, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4623965511343748, "mean_inference_ms": 1.4733068354336616, "mean_action_processing_ms": 0.17451312098490612, "mean_env_wait_ms": 0.10390636611791176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034998416900634766, "StateBufferConnector_ms": 0.012004613876342773, "ViewRequirementAgentConnector_ms": 0.1459207534790039}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5369999999997963, "episode_len_mean": 270.2, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 26.499999999999936, 31.1, 45.9, 47.1, -50.00000000000044, 46.3, 42.30000000000001, 42.500000000000014, 47.5, 17.69999999999981, -50.00000000000044, 45.5, 41.90000000000001, 47.1, 38.300000000000026, -50.00000000000044, 17.499999999999808, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 39.70000000000002, 47.3, 9.299999999999692, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.9, 47.3, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, 45.7, 43.7, 47.7, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, 16.699999999999797, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 45.3, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.90000000000002, 42.70000000000001, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.10000000000001, 47.1, 35.30000000000004, 47.7, -50.00000000000044, -50.00000000000044, 47.3], "episode_lengths": [500, 500, 236, 190, 42, 30, 500, 38, 78, 76, 26, 324, 500, 46, 82, 30, 118, 500, 326, 500, 44, 500, 500, 500, 300, 104, 28, 408, 500, 36, 46, 500, 500, 500, 500, 500, 500, 62, 500, 42, 28, 38, 500, 500, 500, 500, 500, 26, 500, 500, 500, 52, 500, 46, 42, 500, 500, 500, 396, 44, 64, 24, 500, 500, 108, 500, 36, 334, 44, 500, 500, 62, 24, 68, 500, 34, 500, 38, 48, 66, 500, 40, 500, 152, 58, 500, 500, 326, 92, 74, 500, 104, 40, 70, 30, 148, 24, 500, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4623965511343748, "mean_inference_ms": 1.4733068354336616, "mean_action_processing_ms": 0.17451312098490612, "mean_env_wait_ms": 0.10390636611791176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034998416900634766, "StateBufferConnector_ms": 0.012004613876342773, "ViewRequirementAgentConnector_ms": 0.1459207534790039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5052.630564512842, "num_env_steps_trained_throughput_per_sec": 5052.630564512842, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3726.397, "sample_time_ms": 3368.669, "load_time_ms": 26.592, "load_throughput": 676896.715, "learn_time_ms": 315.364, "learn_throughput": 57076.91, "synch_weights_time_ms": 14.149}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3115, "training_iteration": 46, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-54", "timestamp": 1698246474, "time_this_iter_s": 3.568498134613037, "time_total_s": 176.82211875915527, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.82211875915527, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 76.33999999999999, "ram_util_percent": 30.959999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.045073413848877, "policy_loss": -0.02842984995804727, "vf_loss": 6.073540353775025, "vf_explained_var": -1.1295080184936523e-06, "kl": 8.860888704020908e-05, "entropy": 0.37099807262420653, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.02799999999979363, "episode_len_mean": 270.26, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, 16.699999999999797, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 45.3, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.90000000000002, 42.70000000000001, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.10000000000001, 47.1, 35.30000000000004, 47.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.1, 32.90000000000003, -50.00000000000044, 47.3, 47.1, 47.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 47.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.5, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.900000000000034, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 108, 500, 36, 334, 44, 500, 500, 62, 24, 68, 500, 34, 500, 38, 48, 66, 500, 40, 500, 152, 58, 500, 500, 326, 92, 74, 500, 104, 40, 70, 30, 148, 24, 500, 500, 28, 500, 34, 30, 172, 500, 28, 30, 24, 40, 500, 500, 500, 48, 500, 500, 500, 500, 500, 500, 500, 350, 36, 102, 500, 500, 44, 44, 24, 500, 500, 500, 500, 500, 38, 26, 34, 500, 56, 28, 500, 500, 144, 46, 34, 500, 78, 500, 152, 108, 500, 34, 500, 30, 82, 500, 48, 500, 500, 34, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4621187703845057, "mean_inference_ms": 1.4716477206439011, "mean_action_processing_ms": 0.1741280097363433, "mean_env_wait_ms": 0.1037319171184571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03194093704223633, "StateBufferConnector_ms": 0.007004737854003906, "ViewRequirementAgentConnector_ms": 0.1539313793182373}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.02799999999979363, "episode_len_mean": 270.26, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.5, 16.699999999999797, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 43.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.3, 45.3, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.90000000000002, 42.70000000000001, -50.00000000000044, 39.70000000000002, 46.099999999999994, 43.10000000000001, 47.1, 35.30000000000004, 47.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.1, 32.90000000000003, -50.00000000000044, 47.3, 47.1, 47.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.099999999999774, 46.5, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 47.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.5, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.900000000000034, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 108, 500, 36, 334, 44, 500, 500, 62, 24, 68, 500, 34, 500, 38, 48, 66, 500, 40, 500, 152, 58, 500, 500, 326, 92, 74, 500, 104, 40, 70, 30, 148, 24, 500, 500, 28, 500, 34, 30, 172, 500, 28, 30, 24, 40, 500, 500, 500, 48, 500, 500, 500, 500, 500, 500, 500, 350, 36, 102, 500, 500, 44, 44, 24, 500, 500, 500, 500, 500, 38, 26, 34, 500, 56, 28, 500, 500, 144, 46, 34, 500, 78, 500, 152, 108, 500, 34, 500, 30, 82, 500, 48, 500, 500, 34, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4621187703845057, "mean_inference_ms": 1.4716477206439011, "mean_action_processing_ms": 0.1741280097363433, "mean_env_wait_ms": 0.1037319171184571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03194093704223633, "StateBufferConnector_ms": 0.007004737854003906, "ViewRequirementAgentConnector_ms": 0.1539313793182373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5299.809151342978, "num_env_steps_trained_throughput_per_sec": 5299.809151342978, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3662.007, "sample_time_ms": 3338.459, "load_time_ms": 23.368, "load_throughput": 770287.26, "learn_time_ms": 285.025, "learn_throughput": 63152.445, "synch_weights_time_ms": 13.634}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3177, "training_iteration": 47, "trial_id": "9f288_00007", "date": "2023-10-25_16-07-57", "timestamp": 1698246477, "time_this_iter_s": 3.4015607833862305, "time_total_s": 180.2236795425415, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.2236795425415, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 77.75, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.295025658607483, "policy_loss": -0.022651624743593855, "vf_loss": 6.317719674110412, "vf_explained_var": -1.227855682373047e-06, "kl": 0.0002053953286697663, "entropy": 0.4248567149043083, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 950.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1599999999998074, "episode_len_mean": 258.96, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 47.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.5, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.900000000000034, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 43.50000000000001, 47.1, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 44.10000000000001, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 38.90000000000002, 27.699999999999953, 46.9, 34.30000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.3, 19.899999999999842, -50.00000000000044, 47.3, 46.9, -50.00000000000044, 45.9, 43.30000000000001, 41.30000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 47.5, 45.5], "episode_lengths": [500, 38, 26, 34, 500, 56, 28, 500, 500, 144, 46, 34, 500, 78, 500, 152, 108, 500, 34, 500, 30, 82, 500, 48, 500, 500, 34, 500, 500, 500, 500, 66, 500, 500, 106, 500, 500, 50, 500, 42, 66, 30, 500, 44, 32, 500, 46, 500, 500, 180, 500, 500, 34, 500, 36, 500, 66, 60, 48, 42, 500, 500, 500, 500, 54, 44, 120, 112, 224, 32, 158, 30, 500, 500, 500, 46, 48, 302, 500, 28, 32, 500, 42, 68, 88, 500, 136, 500, 500, 30, 162, 500, 64, 500, 500, 36, 500, 48, 26, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620489832580768, "mean_inference_ms": 1.4719178772988273, "mean_action_processing_ms": 0.1739373892886797, "mean_env_wait_ms": 0.1038699751565468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032888174057006836, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.16397547721862793}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.1599999999998074, "episode_len_mean": 258.96, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 47.5, 46.699999999999996, -50.00000000000044, 44.5, 47.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.5, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.900000000000034, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.9, 43.50000000000001, 47.1, -50.00000000000044, 45.7, 46.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 44.10000000000001, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 38.10000000000002, 38.90000000000002, 27.699999999999953, 46.9, 34.30000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.3, 19.899999999999842, -50.00000000000044, 47.3, 46.9, -50.00000000000044, 45.9, 43.30000000000001, 41.30000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 47.5, 45.5], "episode_lengths": [500, 38, 26, 34, 500, 56, 28, 500, 500, 144, 46, 34, 500, 78, 500, 152, 108, 500, 34, 500, 30, 82, 500, 48, 500, 500, 34, 500, 500, 500, 500, 66, 500, 500, 106, 500, 500, 50, 500, 42, 66, 30, 500, 44, 32, 500, 46, 500, 500, 180, 500, 500, 34, 500, 36, 500, 66, 60, 48, 42, 500, 500, 500, 500, 54, 44, 120, 112, 224, 32, 158, 30, 500, 500, 500, 46, 48, 302, 500, 28, 32, 500, 42, 68, 88, 500, 136, 500, 500, 30, 162, 500, 64, 500, 500, 36, 500, 48, 26, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620489832580768, "mean_inference_ms": 1.4719178772988273, "mean_action_processing_ms": 0.1739373892886797, "mean_env_wait_ms": 0.1038699751565468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032888174057006836, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.16397547721862793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4631.5782499446495, "num_env_steps_trained_throughput_per_sec": 4631.5782499446495, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3656.446, "sample_time_ms": 3362.637, "load_time_ms": 21.304, "load_throughput": 844928.324, "learn_time_ms": 257.813, "learn_throughput": 69817.949, "synch_weights_time_ms": 13.225}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3247, "training_iteration": 48, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-01", "timestamp": 1698246481, "time_this_iter_s": 3.8923635482788086, "time_total_s": 184.1160430908203, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.1160430908203, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 80.39999999999999, "ram_util_percent": 31.066666666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.6415358781814575, "policy_loss": -0.0020803235471248626, "vf_loss": 6.643659234046936, "vf_explained_var": -7.450580596923828e-07, "kl": 0.00034764294729541236, "entropy": 0.42906527072191236, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 970.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.777999999999835, "episode_len_mean": 232.86, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 41.30000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 47.5, 45.5, -50.00000000000044, 37.90000000000003, 1.6999999999995836, 42.10000000000001, 47.3, 21.499999999999865, 45.5, 44.10000000000001, -50.00000000000044, 21.09999999999986, 47.1, 47.9, 47.3, 47.9, -50.00000000000044, 44.300000000000004, 25.099999999999916, 33.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 46.9, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.7, 47.1, 41.90000000000001, 42.900000000000006, 30.099999999999987, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, 44.5, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 47.1, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 35.500000000000036, 36.10000000000004, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 45.7, -50.00000000000044, 47.7, 43.30000000000001, -50.00000000000044, 33.10000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 45.9, 43.900000000000006, 47.1, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [68, 88, 500, 136, 500, 500, 30, 162, 500, 64, 500, 500, 36, 500, 48, 26, 46, 500, 122, 484, 80, 28, 286, 46, 60, 500, 290, 30, 22, 28, 22, 500, 58, 250, 164, 500, 46, 500, 42, 32, 40, 34, 500, 64, 30, 82, 72, 200, 500, 48, 118, 500, 500, 96, 28, 56, 500, 52, 36, 500, 500, 500, 500, 26, 42, 30, 500, 38, 80, 500, 146, 140, 44, 34, 500, 500, 500, 72, 500, 500, 34, 34, 44, 500, 24, 68, 500, 170, 86, 500, 500, 500, 130, 42, 62, 30, 160, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4610231989774235, "mean_inference_ms": 1.4694585539242004, "mean_action_processing_ms": 0.17401512217684534, "mean_env_wait_ms": 0.10381854545006215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02948594093322754, "StateBufferConnector_ms": 0.005020856857299805, "ViewRequirementAgentConnector_ms": 0.1470479965209961}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.777999999999835, "episode_len_mean": 232.86, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 41.30000000000001, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 47.1, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 47.5, 45.5, -50.00000000000044, 37.90000000000003, 1.6999999999995836, 42.10000000000001, 47.3, 21.499999999999865, 45.5, 44.10000000000001, -50.00000000000044, 21.09999999999986, 47.1, 47.9, 47.3, 47.9, -50.00000000000044, 44.300000000000004, 25.099999999999916, 33.70000000000004, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 46.9, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.7, 47.1, 41.90000000000001, 42.900000000000006, 30.099999999999987, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, 44.5, -50.00000000000044, 44.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 47.1, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 35.500000000000036, 36.10000000000004, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 45.7, -50.00000000000044, 47.7, 43.30000000000001, -50.00000000000044, 33.10000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 45.9, 43.900000000000006, 47.1, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [68, 88, 500, 136, 500, 500, 30, 162, 500, 64, 500, 500, 36, 500, 48, 26, 46, 500, 122, 484, 80, 28, 286, 46, 60, 500, 290, 30, 22, 28, 22, 500, 58, 250, 164, 500, 46, 500, 42, 32, 40, 34, 500, 64, 30, 82, 72, 200, 500, 48, 118, 500, 500, 96, 28, 56, 500, 52, 36, 500, 500, 500, 500, 26, 42, 30, 500, 38, 80, 500, 146, 140, 44, 34, 500, 500, 500, 72, 500, 500, 34, 34, 44, 500, 24, 68, 500, 170, 86, 500, 500, 500, 130, 42, 62, 30, 160, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4610231989774235, "mean_inference_ms": 1.4694585539242004, "mean_action_processing_ms": 0.17401512217684534, "mean_env_wait_ms": 0.10381854545006215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02948594093322754, "StateBufferConnector_ms": 0.005020856857299805, "ViewRequirementAgentConnector_ms": 0.1470479965209961}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5378.829926389494, "num_env_steps_trained_throughput_per_sec": 5378.829926389494, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3606.814, "sample_time_ms": 3342.333, "load_time_ms": 18.996, "load_throughput": 947570.273, "learn_time_ms": 231.84, "learn_throughput": 77639.731, "synch_weights_time_ms": 12.278}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3330, "training_iteration": 49, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-05", "timestamp": 1698246485, "time_this_iter_s": 3.3524527549743652, "time_total_s": 187.46849584579468, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.46849584579468, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 31.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.364384913444519, "policy_loss": 0.018351859785616396, "vf_loss": 6.346076893806457, "vf_explained_var": -2.4378299713134765e-06, "kl": 0.0005866422417966533, "entropy": 0.43852232545614245, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 990.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8190000000002096, "episode_len_mean": 283.72, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 47.1, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 35.500000000000036, 36.10000000000004, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 45.7, -50.00000000000044, 47.7, 43.30000000000001, -50.00000000000044, 33.10000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 45.9, 43.900000000000006, 47.1, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.30000000000001, -50.00000000000044, 44.5, 47.7, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 40.30000000000002, 45.3, 42.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, -50.00000000000044, 47.3, 37.50000000000003, 43.50000000000001, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.500000000000014, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.9, 45.1, 45.5, 32.100000000000016], "episode_lengths": [500, 500, 500, 26, 42, 30, 500, 38, 80, 500, 146, 140, 44, 34, 500, 500, 500, 72, 500, 500, 34, 34, 44, 500, 24, 68, 500, 170, 86, 500, 500, 500, 130, 42, 62, 30, 160, 500, 500, 500, 500, 500, 116, 68, 500, 56, 24, 32, 500, 40, 500, 500, 500, 126, 158, 500, 500, 500, 94, 500, 38, 500, 500, 196, 98, 48, 78, 84, 500, 500, 500, 498, 500, 500, 180, 76, 500, 28, 126, 66, 500, 70, 34, 500, 500, 86, 354, 500, 500, 500, 74, 500, 500, 500, 500, 170, 42, 50, 46, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46180368859451676, "mean_inference_ms": 1.4691256089566624, "mean_action_processing_ms": 0.17356226430931046, "mean_env_wait_ms": 0.10366504691489684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399730682373047, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.14321279525756836}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8190000000002096, "episode_len_mean": 283.72, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.9, 47.1, -50.00000000000044, 46.3, 42.10000000000001, -50.00000000000044, 35.500000000000036, 36.10000000000004, 45.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 45.7, -50.00000000000044, 47.7, 43.30000000000001, -50.00000000000044, 33.10000000000003, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 45.9, 43.900000000000006, 47.1, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 43.30000000000001, -50.00000000000044, 44.5, 47.7, 46.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 30.499999999999993, 40.30000000000002, 45.3, 42.30000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, -50.00000000000044, 47.3, 37.50000000000003, 43.50000000000001, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.500000000000014, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.9, 45.1, 45.5, 32.100000000000016], "episode_lengths": [500, 500, 500, 26, 42, 30, 500, 38, 80, 500, 146, 140, 44, 34, 500, 500, 500, 72, 500, 500, 34, 34, 44, 500, 24, 68, 500, 170, 86, 500, 500, 500, 130, 42, 62, 30, 160, 500, 500, 500, 500, 500, 116, 68, 500, 56, 24, 32, 500, 40, 500, 500, 500, 126, 158, 500, 500, 500, 94, 500, 38, 500, 500, 196, 98, 48, 78, 84, 500, 500, 500, 498, 500, 500, 180, 76, 500, 28, 126, 66, 500, 70, 34, 500, 500, 86, 354, 500, 500, 500, 74, 500, 500, 500, 500, 170, 42, 50, 46, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46180368859451676, "mean_inference_ms": 1.4691256089566624, "mean_action_processing_ms": 0.17356226430931046, "mean_env_wait_ms": 0.10366504691489684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399730682373047, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.14321279525756836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5130.191077816528, "num_env_steps_trained_throughput_per_sec": 5130.191077816528, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3567.418, "sample_time_ms": 3328.016, "load_time_ms": 16.82, "load_throughput": 1070139.307, "learn_time_ms": 209.646, "learn_throughput": 85858.859, "synch_weights_time_ms": 11.496}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3390, "training_iteration": 50, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-08", "timestamp": 1698246488, "time_this_iter_s": 3.5146286487579346, "time_total_s": 190.9831244945526, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.9831244945526, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 74.56, "ram_util_percent": 31.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.285739731788635, "policy_loss": 0.045384739292785525, "vf_loss": 6.240398859977722, "vf_explained_var": -8.851289749145508e-07, "kl": 0.00031755031984062045, "entropy": 0.43756925910711286, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1010.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4229999999998038, "episode_len_mean": 271.36, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, -50.00000000000044, 47.3, 37.50000000000003, 43.50000000000001, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.500000000000014, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.9, 45.1, 45.5, 32.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.90000000000002, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 41.30000000000001, 40.10000000000002, 30.099999999999987, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.30000000000001, 45.5, 14.699999999999768, 24.69999999999991, 47.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 43.30000000000001, 43.50000000000001, 45.5, -50.00000000000044, 10.299999999999706, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, 27.49999999999995, 44.300000000000004, 46.9, 45.7, 44.10000000000001, -50.00000000000044, 43.900000000000006, 16.699999999999797, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 15.899999999999785, 32.700000000000024, -50.00000000000044, 44.5, 45.5, 45.3, 45.1, 45.5], "episode_lengths": [500, 500, 498, 500, 500, 180, 76, 500, 28, 126, 66, 500, 70, 34, 500, 500, 86, 354, 500, 500, 500, 74, 500, 500, 500, 500, 170, 42, 50, 46, 180, 500, 60, 500, 500, 500, 500, 500, 500, 500, 500, 60, 112, 34, 500, 36, 500, 72, 88, 100, 200, 60, 500, 500, 62, 88, 46, 354, 254, 24, 106, 500, 500, 500, 500, 48, 50, 68, 66, 46, 500, 398, 36, 64, 500, 500, 500, 254, 226, 58, 32, 44, 60, 500, 62, 334, 500, 46, 54, 500, 500, 92, 342, 174, 500, 56, 46, 48, 50, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4616485035495693, "mean_inference_ms": 1.4663523085736763, "mean_action_processing_ms": 0.17333814159573493, "mean_env_wait_ms": 0.10339009866843309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030504465103149414, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.14199233055114746}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4229999999998038, "episode_len_mean": 271.36, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.500000000000014, -50.00000000000044, 47.3, 37.50000000000003, 43.50000000000001, -50.00000000000044, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 41.500000000000014, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.9, 45.1, 45.5, 32.100000000000016, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.90000000000002, 46.699999999999996, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 41.30000000000001, 40.10000000000002, 30.099999999999987, 44.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.30000000000001, 45.5, 14.699999999999768, 24.69999999999991, 47.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.1, 43.30000000000001, 43.50000000000001, 45.5, -50.00000000000044, 10.299999999999706, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, 27.49999999999995, 44.300000000000004, 46.9, 45.7, 44.10000000000001, -50.00000000000044, 43.900000000000006, 16.699999999999797, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 15.899999999999785, 32.700000000000024, -50.00000000000044, 44.5, 45.5, 45.3, 45.1, 45.5], "episode_lengths": [500, 500, 498, 500, 500, 180, 76, 500, 28, 126, 66, 500, 70, 34, 500, 500, 86, 354, 500, 500, 500, 74, 500, 500, 500, 500, 170, 42, 50, 46, 180, 500, 60, 500, 500, 500, 500, 500, 500, 500, 500, 60, 112, 34, 500, 36, 500, 72, 88, 100, 200, 60, 500, 500, 62, 88, 46, 354, 254, 24, 106, 500, 500, 500, 500, 48, 50, 68, 66, 46, 500, 398, 36, 64, 500, 500, 500, 254, 226, 58, 32, 44, 60, 500, 62, 334, 500, 46, 54, 500, 500, 92, 342, 174, 500, 56, 46, 48, 50, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4616485035495693, "mean_inference_ms": 1.4663523085736763, "mean_action_processing_ms": 0.17333814159573493, "mean_env_wait_ms": 0.10339009866843309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030504465103149414, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.14199233055114746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5248.782328628297, "num_env_steps_trained_throughput_per_sec": 5248.782328628297, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3542.792, "sample_time_ms": 3300.96, "load_time_ms": 16.22, "load_throughput": 1109762.444, "learn_time_ms": 212.595, "learn_throughput": 84667.96, "synch_weights_time_ms": 11.477}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3459, "training_iteration": 51, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-12", "timestamp": 1698246492, "time_this_iter_s": 3.4343693256378174, "time_total_s": 194.41749382019043, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.41749382019043, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 76.75, "ram_util_percent": 31.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.099146366119385, "policy_loss": -0.019578524678945542, "vf_loss": 6.118768906593322, "vf_explained_var": -2.0265579223632812e-06, "kl": 0.00028541696836725805, "entropy": 0.43936862647533415, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1030.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.124999999999816, "episode_len_mean": 254.36, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 45.1, 43.30000000000001, 43.50000000000001, 45.5, -50.00000000000044, 10.299999999999706, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, 27.49999999999995, 44.300000000000004, 46.9, 45.7, 44.10000000000001, -50.00000000000044, 43.900000000000006, 16.699999999999797, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 15.899999999999785, 32.700000000000024, -50.00000000000044, 44.5, 45.5, 45.3, 45.1, 45.5, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.10000000000002, 31.70000000000001, 46.3, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.3, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 45.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.10000000000002, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 0.6999999999995694, -50.00000000000044, 42.500000000000014, 44.10000000000001, 37.10000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 50, 68, 66, 46, 500, 398, 36, 64, 500, 500, 500, 254, 226, 58, 32, 44, 60, 500, 62, 334, 500, 46, 54, 500, 500, 92, 342, 174, 500, 56, 46, 48, 50, 46, 52, 38, 500, 500, 500, 500, 78, 46, 78, 500, 500, 60, 100, 184, 38, 94, 500, 152, 500, 500, 94, 500, 48, 38, 500, 62, 500, 62, 48, 104, 500, 500, 500, 500, 500, 46, 270, 500, 500, 46, 500, 120, 52, 30, 500, 24, 78, 500, 500, 32, 36, 500, 500, 86, 494, 500, 76, 60, 130, 34, 500, 500, 146, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4601893700927188, "mean_inference_ms": 1.464852729034792, "mean_action_processing_ms": 0.17316248110050256, "mean_env_wait_ms": 0.10329309891738156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034386634826660156, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.1691608428955078}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.124999999999816, "episode_len_mean": 254.36, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 45.1, 43.30000000000001, 43.50000000000001, 45.5, -50.00000000000044, 10.299999999999706, 46.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.69999999999991, 27.49999999999995, 44.300000000000004, 46.9, 45.7, 44.10000000000001, -50.00000000000044, 43.900000000000006, 16.699999999999797, -50.00000000000044, 45.5, 44.7, -50.00000000000044, -50.00000000000044, 40.90000000000002, 15.899999999999785, 32.700000000000024, -50.00000000000044, 44.5, 45.5, 45.3, 45.1, 45.5, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.10000000000002, 31.70000000000001, 46.3, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.3, 46.3, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.900000000000006, 45.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.10000000000002, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 0.6999999999995694, -50.00000000000044, 42.500000000000014, 44.10000000000001, 37.10000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 50, 68, 66, 46, 500, 398, 36, 64, 500, 500, 500, 254, 226, 58, 32, 44, 60, 500, 62, 334, 500, 46, 54, 500, 500, 92, 342, 174, 500, 56, 46, 48, 50, 46, 52, 38, 500, 500, 500, 500, 78, 46, 78, 500, 500, 60, 100, 184, 38, 94, 500, 152, 500, 500, 94, 500, 48, 38, 500, 62, 500, 62, 48, 104, 500, 500, 500, 500, 500, 46, 270, 500, 500, 46, 500, 120, 52, 30, 500, 24, 78, 500, 500, 32, 36, 500, 500, 86, 494, 500, 76, 60, 130, 34, 500, 500, 146, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4601893700927188, "mean_inference_ms": 1.464852729034792, "mean_action_processing_ms": 0.17316248110050256, "mean_env_wait_ms": 0.10329309891738156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034386634826660156, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.1691608428955078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5451.712779712017, "num_env_steps_trained_throughput_per_sec": 5451.712779712017, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3517.131, "sample_time_ms": 3278.232, "load_time_ms": 15.146, "load_throughput": 1188442.474, "learn_time_ms": 211.121, "learn_throughput": 85259.15, "synch_weights_time_ms": 11.06}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3524, "training_iteration": 52, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-15", "timestamp": 1698246495, "time_this_iter_s": 3.3077139854431152, "time_total_s": 197.72520780563354, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.72520780563354, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 73.14000000000001, "ram_util_percent": 31.139999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.661523175239563, "policy_loss": -0.057626533787697554, "vf_loss": 6.719195008277893, "vf_explained_var": -9.596347808837891e-07, "kl": 0.00027330389307849144, "entropy": 0.4528682500123978, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1050.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9830000000002138, "episode_len_mean": 285.38, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.10000000000002, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 0.6999999999995694, -50.00000000000044, 42.500000000000014, 44.10000000000001, 37.10000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 46.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 46.3, 8.699999999999683, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, 45.9, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.90000000000002, 36.30000000000003, 41.30000000000001, 19.299999999999834, 33.90000000000004, 47.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.1, 21.89999999999987, 46.5, 36.70000000000003, 14.09999999999976, 43.50000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 46.099999999999994, 45.9, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 46, 270, 500, 500, 46, 500, 120, 52, 30, 500, 24, 78, 500, 500, 32, 36, 500, 500, 86, 494, 500, 76, 60, 130, 34, 500, 500, 146, 500, 500, 500, 500, 46, 500, 30, 38, 282, 500, 500, 148, 500, 500, 488, 500, 38, 414, 500, 82, 38, 500, 42, 68, 38, 500, 500, 34, 500, 500, 102, 138, 88, 308, 162, 28, 80, 500, 500, 500, 500, 54, 500, 500, 500, 102, 50, 282, 36, 134, 360, 66, 70, 500, 500, 500, 36, 68, 500, 58, 44, 500, 40, 42, 62, 82, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.459442968462425, "mean_inference_ms": 1.4626143595727257, "mean_action_processing_ms": 0.17288929184650165, "mean_env_wait_ms": 0.10296020227606481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0373687744140625, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.15709209442138672}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9830000000002138, "episode_len_mean": 285.38, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.5, 23.099999999999888, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.10000000000002, 44.900000000000006, 47.1, -50.00000000000044, 47.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, -50.00000000000044, 41.500000000000014, 0.6999999999995694, -50.00000000000044, 42.500000000000014, 44.10000000000001, 37.10000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 47.1, 46.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 1.299999999999578, -50.00000000000044, 46.3, 8.699999999999683, -50.00000000000044, 41.90000000000001, 46.3, -50.00000000000044, 45.9, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.90000000000002, 36.30000000000003, 41.30000000000001, 19.299999999999834, 33.90000000000004, 47.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.1, 21.89999999999987, 46.5, 36.70000000000003, 14.09999999999976, 43.50000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 46.099999999999994, 45.9, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 46, 270, 500, 500, 46, 500, 120, 52, 30, 500, 24, 78, 500, 500, 32, 36, 500, 500, 86, 494, 500, 76, 60, 130, 34, 500, 500, 146, 500, 500, 500, 500, 46, 500, 30, 38, 282, 500, 500, 148, 500, 500, 488, 500, 38, 414, 500, 82, 38, 500, 42, 68, 38, 500, 500, 34, 500, 500, 102, 138, 88, 308, 162, 28, 80, 500, 500, 500, 500, 54, 500, 500, 500, 102, 50, 282, 36, 134, 360, 66, 70, 500, 500, 500, 36, 68, 500, 58, 44, 500, 40, 42, 62, 82, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.459442968462425, "mean_inference_ms": 1.4626143595727257, "mean_action_processing_ms": 0.17288929184650165, "mean_env_wait_ms": 0.10296020227606481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0373687744140625, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.15709209442138672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5169.318090706289, "num_env_steps_trained_throughput_per_sec": 5169.318090706289, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3495.97, "sample_time_ms": 3259.651, "load_time_ms": 14.669, "load_throughput": 1227058.472, "learn_time_ms": 209.177, "learn_throughput": 86051.617, "synch_weights_time_ms": 11.001}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3592, "training_iteration": 53, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-19", "timestamp": 1698246499, "time_this_iter_s": 3.486922025680542, "time_total_s": 201.2121298313141, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.2121298313141, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 75.38, "ram_util_percent": 31.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.501953220367431, "policy_loss": 0.00877336822450161, "vf_loss": 6.4932249784469604, "vf_explained_var": -1.2636184692382812e-06, "kl": 0.0006365648088795695, "entropy": 0.4511959105730057, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1070.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.30899999999983, "episode_len_mean": 252.54, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.1, 21.89999999999987, 46.5, 36.70000000000003, 14.09999999999976, 43.50000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 46.099999999999994, 45.9, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 46.699999999999996, 47.5, -50.00000000000044, 19.09999999999983, 40.70000000000002, -50.00000000000044, 29.899999999999984, 35.500000000000036, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, 44.10000000000001, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 7.09999999999966, 25.29999999999992, 45.5, 45.5, 41.500000000000014, -50.00000000000044, 46.9, 37.70000000000003, 47.7, 44.10000000000001, -50.00000000000044, 27.899999999999956, 44.10000000000001, 33.10000000000003, 39.50000000000002, -50.00000000000044, 11.099999999999717, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, 32.90000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 46.699999999999996, 36.10000000000004, 44.10000000000001, 24.499999999999908, 44.10000000000001, -50.00000000000044, 45.7, 47.5, -50.00000000000044, 35.30000000000004, 46.699999999999996], "episode_lengths": [500, 54, 500, 500, 500, 102, 50, 282, 36, 134, 360, 66, 70, 500, 500, 500, 36, 68, 500, 58, 44, 500, 40, 42, 62, 82, 500, 500, 500, 500, 80, 500, 56, 34, 26, 500, 310, 94, 500, 202, 146, 180, 500, 500, 90, 500, 42, 60, 56, 500, 42, 500, 500, 430, 248, 46, 46, 86, 500, 32, 124, 24, 60, 500, 222, 60, 170, 106, 500, 390, 500, 56, 500, 500, 44, 188, 172, 500, 134, 500, 500, 500, 42, 140, 500, 500, 62, 500, 66, 34, 140, 60, 256, 60, 500, 44, 26, 500, 148, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4593345929834043, "mean_inference_ms": 1.459297893611797, "mean_action_processing_ms": 0.17284127313200018, "mean_env_wait_ms": 0.10266542146176441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.12797904014587402}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.30899999999983, "episode_len_mean": 252.54, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 45.1, 21.89999999999987, 46.5, 36.70000000000003, 14.09999999999976, 43.50000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 46.099999999999994, 45.9, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 46.699999999999996, 47.5, -50.00000000000044, 19.09999999999983, 40.70000000000002, -50.00000000000044, 29.899999999999984, 35.500000000000036, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, 44.10000000000001, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 7.09999999999966, 25.29999999999992, 45.5, 45.5, 41.500000000000014, -50.00000000000044, 46.9, 37.70000000000003, 47.7, 44.10000000000001, -50.00000000000044, 27.899999999999956, 44.10000000000001, 33.10000000000003, 39.50000000000002, -50.00000000000044, 11.099999999999717, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, 32.90000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 46.699999999999996, 36.10000000000004, 44.10000000000001, 24.499999999999908, 44.10000000000001, -50.00000000000044, 45.7, 47.5, -50.00000000000044, 35.30000000000004, 46.699999999999996], "episode_lengths": [500, 54, 500, 500, 500, 102, 50, 282, 36, 134, 360, 66, 70, 500, 500, 500, 36, 68, 500, 58, 44, 500, 40, 42, 62, 82, 500, 500, 500, 500, 80, 500, 56, 34, 26, 500, 310, 94, 500, 202, 146, 180, 500, 500, 90, 500, 42, 60, 56, 500, 42, 500, 500, 430, 248, 46, 46, 86, 500, 32, 124, 24, 60, 500, 222, 60, 170, 106, 500, 390, 500, 56, 500, 500, 44, 188, 172, 500, 134, 500, 500, 500, 42, 140, 500, 500, 62, 500, 66, 34, 140, 60, 256, 60, 500, 44, 26, 500, 148, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4593345929834043, "mean_inference_ms": 1.459297893611797, "mean_action_processing_ms": 0.17284127313200018, "mean_env_wait_ms": 0.10266542146176441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.12797904014587402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5364.804114850162, "num_env_steps_trained_throughput_per_sec": 5364.804114850162, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3474.41, "sample_time_ms": 3237.508, "load_time_ms": 13.611, "load_throughput": 1322493.869, "learn_time_ms": 211.136, "learn_throughput": 85253.008, "synch_weights_time_ms": 10.7}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3662, "training_iteration": 54, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-22", "timestamp": 1698246502, "time_this_iter_s": 3.3601949214935303, "time_total_s": 204.57232475280762, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 204.57232475280762, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 70.94000000000001, "ram_util_percent": 31.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.192099165916443, "policy_loss": -0.006178650789661333, "vf_loss": 6.198323965072632, "vf_explained_var": -1.615285873413086e-06, "kl": 0.0002870821621070663, "entropy": 0.4619498372077942, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1090.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6249999999998082, "episode_len_mean": 269.32, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.899999999999956, 44.10000000000001, 33.10000000000003, 39.50000000000002, -50.00000000000044, 11.099999999999717, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, 32.90000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 46.699999999999996, 36.10000000000004, 44.10000000000001, 24.499999999999908, 44.10000000000001, -50.00000000000044, 45.7, 47.5, -50.00000000000044, 35.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 40.500000000000014, 34.50000000000004, 37.70000000000003, 47.1, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.10000000000002, 34.900000000000034, 45.3, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 46.3, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 39.90000000000002, 43.900000000000006, 40.30000000000002, 45.1, 24.099999999999902, 43.50000000000001, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 20.699999999999854], "episode_lengths": [500, 222, 60, 170, 106, 500, 390, 500, 56, 500, 500, 44, 188, 172, 500, 134, 500, 500, 500, 42, 140, 500, 500, 62, 500, 66, 34, 140, 60, 256, 60, 500, 44, 26, 500, 148, 34, 500, 500, 62, 90, 500, 500, 500, 500, 32, 500, 500, 500, 46, 500, 90, 500, 96, 156, 124, 30, 500, 500, 32, 500, 500, 500, 90, 500, 110, 152, 48, 40, 500, 44, 500, 38, 38, 124, 500, 500, 50, 54, 52, 500, 82, 500, 500, 500, 54, 42, 500, 102, 62, 98, 50, 260, 66, 500, 34, 36, 500, 500, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45820653757113605, "mean_inference_ms": 1.4579346608002837, "mean_action_processing_ms": 0.17221933014830262, "mean_env_wait_ms": 0.10263585892618099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001670837402344, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.1207129955291748}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6249999999998082, "episode_len_mean": 269.32, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.899999999999956, 44.10000000000001, 33.10000000000003, 39.50000000000002, -50.00000000000044, 11.099999999999717, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.7, 31.300000000000004, 32.90000000000003, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.50000000000001, 46.699999999999996, 36.10000000000004, 44.10000000000001, 24.499999999999908, 44.10000000000001, -50.00000000000044, 45.7, 47.5, -50.00000000000044, 35.30000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.100000000000016, -50.00000000000044, 40.500000000000014, 34.50000000000004, 37.70000000000003, 47.1, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.10000000000002, 34.900000000000034, 45.3, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 46.3, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 39.90000000000002, 43.900000000000006, 40.30000000000002, 45.1, 24.099999999999902, 43.50000000000001, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 20.699999999999854], "episode_lengths": [500, 222, 60, 170, 106, 500, 390, 500, 56, 500, 500, 44, 188, 172, 500, 134, 500, 500, 500, 42, 140, 500, 500, 62, 500, 66, 34, 140, 60, 256, 60, 500, 44, 26, 500, 148, 34, 500, 500, 62, 90, 500, 500, 500, 500, 32, 500, 500, 500, 46, 500, 90, 500, 96, 156, 124, 30, 500, 500, 32, 500, 500, 500, 90, 500, 110, 152, 48, 40, 500, 44, 500, 38, 38, 124, 500, 500, 50, 54, 52, 500, 82, 500, 500, 500, 54, 42, 500, 102, 62, 98, 50, 260, 66, 500, 34, 36, 500, 500, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45820653757113605, "mean_inference_ms": 1.4579346608002837, "mean_action_processing_ms": 0.17221933014830262, "mean_env_wait_ms": 0.10263585892618099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001670837402344, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.1207129955291748}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5225.474452630526, "num_env_steps_trained_throughput_per_sec": 5225.474452630526, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3471.334, "sample_time_ms": 3235.995, "load_time_ms": 13.407, "load_throughput": 1342597.364, "learn_time_ms": 210.113, "learn_throughput": 85668.013, "synch_weights_time_ms": 10.264}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3725, "training_iteration": 55, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-25", "timestamp": 1698246505, "time_this_iter_s": 3.4503867626190186, "time_total_s": 208.02271151542664, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.02271151542664, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 73.02000000000001, "ram_util_percent": 31.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.396178531646728, "policy_loss": -0.013740841019898652, "vf_loss": 6.409965252876281, "vf_explained_var": 2.592802047729492e-07, "kl": 0.00033676485639149155, "entropy": 0.45888942629098894, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1110.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.011000000000219, "episode_len_mean": 285.64, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.10000000000002, 34.900000000000034, 45.3, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 46.3, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 39.90000000000002, 43.900000000000006, 40.30000000000002, 45.1, 24.099999999999902, 43.50000000000001, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 46.099999999999994, 34.30000000000004, 40.90000000000002, 40.10000000000002, -50.00000000000044, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 47.3, 19.299999999999834, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.500000000000014, -50.00000000000044, 42.500000000000014, 1.6999999999995836, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.5, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [32, 500, 500, 500, 90, 500, 110, 152, 48, 40, 500, 44, 500, 38, 38, 124, 500, 500, 50, 54, 52, 500, 82, 500, 500, 500, 54, 42, 500, 102, 62, 98, 50, 260, 66, 500, 34, 36, 500, 500, 294, 500, 40, 158, 92, 100, 500, 24, 80, 500, 500, 500, 500, 52, 42, 500, 66, 500, 40, 500, 500, 500, 500, 430, 28, 308, 500, 26, 500, 500, 82, 96, 500, 76, 484, 500, 44, 66, 500, 500, 500, 500, 500, 500, 36, 68, 500, 500, 60, 36, 338, 500, 500, 500, 38, 500, 54, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775245112324714, "mean_inference_ms": 1.4569245134691777, "mean_action_processing_ms": 0.17190722630167804, "mean_env_wait_ms": 0.1022370010238756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.010002613067626953, "ViewRequirementAgentConnector_ms": 0.12272524833679199}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.011000000000219, "episode_len_mean": 285.64, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 39.10000000000002, 34.900000000000034, 45.3, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.3, 46.3, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 44.7, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 39.90000000000002, 43.900000000000006, 40.30000000000002, 45.1, 24.099999999999902, 43.50000000000001, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, 46.099999999999994, 34.30000000000004, 40.90000000000002, 40.10000000000002, -50.00000000000044, 47.7, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 47.3, 19.299999999999834, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.500000000000014, -50.00000000000044, 42.500000000000014, 1.6999999999995836, -50.00000000000044, 45.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.5, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, -50.00000000000044], "episode_lengths": [32, 500, 500, 500, 90, 500, 110, 152, 48, 40, 500, 44, 500, 38, 38, 124, 500, 500, 50, 54, 52, 500, 82, 500, 500, 500, 54, 42, 500, 102, 62, 98, 50, 260, 66, 500, 34, 36, 500, 500, 294, 500, 40, 158, 92, 100, 500, 24, 80, 500, 500, 500, 500, 52, 42, 500, 66, 500, 40, 500, 500, 500, 500, 430, 28, 308, 500, 26, 500, 500, 82, 96, 500, 76, 484, 500, 44, 66, 500, 500, 500, 500, 500, 500, 36, 68, 500, 500, 60, 36, 338, 500, 500, 500, 38, 500, 54, 500, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45775245112324714, "mean_inference_ms": 1.4569245134691777, "mean_action_processing_ms": 0.17190722630167804, "mean_env_wait_ms": 0.1022370010238756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024002552032470703, "StateBufferConnector_ms": 0.010002613067626953, "ViewRequirementAgentConnector_ms": 0.12272524833679199}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5433.842977695955, "num_env_steps_trained_throughput_per_sec": 5433.842977695955, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3446.341, "sample_time_ms": 3214.697, "load_time_ms": 12.897, "load_throughput": 1395633.13, "learn_time_ms": 207.095, "learn_throughput": 86916.741, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3784, "training_iteration": 56, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-29", "timestamp": 1698246509, "time_this_iter_s": 3.3177707195281982, "time_total_s": 211.34048223495483, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.34048223495483, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 74.05, "ram_util_percent": 31.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.862788891792297, "policy_loss": -0.00016838163137435913, "vf_loss": 6.863001918792724, "vf_explained_var": -1.4960765838623048e-06, "kl": 0.00038398633553526906, "entropy": 0.4464718833565712, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1130.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.725999999999843, "episode_len_mean": 223.4, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 35.900000000000034, 17.299999999999805, 45.7, 45.1, 44.10000000000001, -50.00000000000044, 45.1, 35.10000000000004, 42.500000000000014, 45.9, 45.5, 41.90000000000001, -50.00000000000044, 46.699999999999996, 43.50000000000001, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 45.5, -50.00000000000044, 37.10000000000003, 47.1, 18.29999999999982, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 46.5, 47.1, 38.90000000000002, 46.3, -50.00000000000044, 45.9, 42.30000000000001, 46.699999999999996, 16.499999999999794, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 45.1, 46.5, 47.1, -50.00000000000044, 47.7, 47.5, -50.00000000000044, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 37.90000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 33.70000000000004, 23.699999999999896, -50.00000000000044, 47.3, -50.00000000000044, 35.70000000000003], "episode_lengths": [36, 338, 500, 500, 500, 38, 500, 54, 500, 48, 500, 500, 40, 54, 500, 500, 500, 96, 142, 328, 44, 50, 60, 500, 50, 150, 76, 42, 46, 82, 500, 34, 66, 58, 34, 500, 500, 36, 76, 46, 500, 130, 30, 318, 500, 82, 72, 500, 64, 500, 44, 500, 46, 36, 30, 112, 38, 500, 42, 78, 34, 336, 500, 54, 500, 44, 50, 36, 30, 500, 24, 26, 500, 54, 82, 500, 500, 30, 500, 28, 500, 42, 82, 32, 122, 500, 32, 500, 52, 40, 42, 500, 500, 222, 164, 264, 500, 28, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4570379258191312, "mean_inference_ms": 1.4553637896401637, "mean_action_processing_ms": 0.17202079481708415, "mean_env_wait_ms": 0.10215964053894129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0294954776763916, "StateBufferConnector_ms": 0.0050275325775146484, "ViewRequirementAgentConnector_ms": 0.16800594329833984}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.725999999999843, "episode_len_mean": 223.4, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 16.29999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 35.900000000000034, 17.299999999999805, 45.7, 45.1, 44.10000000000001, -50.00000000000044, 45.1, 35.10000000000004, 42.500000000000014, 45.9, 45.5, 41.90000000000001, -50.00000000000044, 46.699999999999996, 43.50000000000001, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 45.5, -50.00000000000044, 37.10000000000003, 47.1, 18.29999999999982, -50.00000000000044, 41.90000000000001, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 45.7, -50.00000000000044, 45.5, 46.5, 47.1, 38.90000000000002, 46.3, -50.00000000000044, 45.9, 42.30000000000001, 46.699999999999996, 16.499999999999794, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 45.1, 46.5, 47.1, -50.00000000000044, 47.7, 47.5, -50.00000000000044, 44.7, 41.90000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 37.90000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 33.70000000000004, 23.699999999999896, -50.00000000000044, 47.3, -50.00000000000044, 35.70000000000003], "episode_lengths": [36, 338, 500, 500, 500, 38, 500, 54, 500, 48, 500, 500, 40, 54, 500, 500, 500, 96, 142, 328, 44, 50, 60, 500, 50, 150, 76, 42, 46, 82, 500, 34, 66, 58, 34, 500, 500, 36, 76, 46, 500, 130, 30, 318, 500, 82, 72, 500, 64, 500, 44, 500, 46, 36, 30, 112, 38, 500, 42, 78, 34, 336, 500, 54, 500, 44, 50, 36, 30, 500, 24, 26, 500, 54, 82, 500, 500, 30, 500, 28, 500, 42, 82, 32, 122, 500, 32, 500, 52, 40, 42, 500, 500, 222, 164, 264, 500, 28, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4570379258191312, "mean_inference_ms": 1.4553637896401637, "mean_action_processing_ms": 0.17202079481708415, "mean_env_wait_ms": 0.10215964053894129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0294954776763916, "StateBufferConnector_ms": 0.0050275325775146484, "ViewRequirementAgentConnector_ms": 0.16800594329833984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4950.7139594808195, "num_env_steps_trained_throughput_per_sec": 4950.7139594808195, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3470.29, "sample_time_ms": 3239.612, "load_time_ms": 12.897, "load_throughput": 1395669.25, "learn_time_ms": 206.114, "learn_throughput": 87330.37, "synch_weights_time_ms": 10.013}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3873, "training_iteration": 57, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-32", "timestamp": 1698246512, "time_this_iter_s": 3.6456785202026367, "time_total_s": 214.98616075515747, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.98616075515747, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 74.10000000000001, "ram_util_percent": 31.049999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.765119838714599, "policy_loss": -0.05571353621780872, "vf_loss": 6.820874047279358, "vf_explained_var": -1.9609928131103515e-06, "kl": 0.000550786648196322, "entropy": 0.40712144672870637, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1150.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.540999999999844, "episode_len_mean": 230.26, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 37.90000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 33.70000000000004, 23.699999999999896, -50.00000000000044, 47.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.3, 42.70000000000001, 42.500000000000014, 35.10000000000004, -50.00000000000044, 28.89999999999997, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.699999999999996, 38.300000000000026, 46.5, 45.1, 39.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 6.499999999999652, 32.700000000000024, 5.6999999999996405, 43.50000000000001, -50.00000000000044, 40.30000000000002, 43.10000000000001, 46.699999999999996, -50.00000000000044, 47.5, -50.00000000000044, 8.899999999999686, 35.900000000000034, 40.70000000000002, 47.5, 45.9, 43.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, 44.5, 47.7, 47.7, 12.899999999999743, 45.1, 35.30000000000004, -50.00000000000044, 44.7, 44.300000000000004, 42.10000000000001, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.90000000000002, 45.1, 46.3, 44.7, 46.699999999999996, 37.50000000000003, 46.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [30, 500, 28, 500, 42, 82, 32, 122, 500, 32, 500, 52, 40, 42, 500, 500, 222, 164, 264, 500, 28, 500, 144, 500, 38, 74, 76, 150, 500, 212, 500, 138, 500, 34, 118, 36, 50, 110, 500, 38, 500, 500, 500, 50, 436, 174, 444, 66, 500, 98, 70, 34, 500, 26, 500, 412, 142, 94, 26, 42, 64, 152, 500, 500, 244, 500, 500, 56, 24, 24, 372, 50, 148, 500, 54, 58, 80, 26, 500, 34, 500, 500, 500, 36, 92, 50, 38, 54, 34, 126, 32, 72, 500, 500, 24, 30, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45708718198721504, "mean_inference_ms": 1.456428710410897, "mean_action_processing_ms": 0.1718280726291125, "mean_env_wait_ms": 0.10223771568387256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996726989746094, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.1547248363494873}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.540999999999844, "episode_len_mean": 230.26, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 41.90000000000001, 46.9, 37.90000000000003, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 27.899999999999956, 33.70000000000004, 23.699999999999896, -50.00000000000044, 47.3, -50.00000000000044, 35.70000000000003, -50.00000000000044, 46.3, 42.70000000000001, 42.500000000000014, 35.10000000000004, -50.00000000000044, 28.89999999999997, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.699999999999996, 38.300000000000026, 46.5, 45.1, 39.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 6.499999999999652, 32.700000000000024, 5.6999999999996405, 43.50000000000001, -50.00000000000044, 40.30000000000002, 43.10000000000001, 46.699999999999996, -50.00000000000044, 47.5, -50.00000000000044, 8.899999999999686, 35.900000000000034, 40.70000000000002, 47.5, 45.9, 43.7, 34.900000000000034, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, 44.5, 47.7, 47.7, 12.899999999999743, 45.1, 35.30000000000004, -50.00000000000044, 44.7, 44.300000000000004, 42.10000000000001, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.90000000000002, 45.1, 46.3, 44.7, 46.699999999999996, 37.50000000000003, 46.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [30, 500, 28, 500, 42, 82, 32, 122, 500, 32, 500, 52, 40, 42, 500, 500, 222, 164, 264, 500, 28, 500, 144, 500, 38, 74, 76, 150, 500, 212, 500, 138, 500, 34, 118, 36, 50, 110, 500, 38, 500, 500, 500, 50, 436, 174, 444, 66, 500, 98, 70, 34, 500, 26, 500, 412, 142, 94, 26, 42, 64, 152, 500, 500, 244, 500, 500, 56, 24, 24, 372, 50, 148, 500, 54, 58, 80, 26, 500, 34, 500, 500, 500, 36, 92, 50, 38, 54, 34, 126, 32, 72, 500, 500, 24, 30, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45708718198721504, "mean_inference_ms": 1.456428710410897, "mean_action_processing_ms": 0.1718280726291125, "mean_env_wait_ms": 0.10223771568387256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996726989746094, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.1547248363494873}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5079.250191453778, "num_env_steps_trained_throughput_per_sec": 5079.250191453778, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3435.937, "sample_time_ms": 3202.607, "load_time_ms": 12.562, "load_throughput": 1432943.079, "learn_time_ms": 209.034, "learn_throughput": 86110.211, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3950, "training_iteration": 58, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-36", "timestamp": 1698246516, "time_this_iter_s": 3.5488271713256836, "time_total_s": 218.53498792648315, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.53498792648315, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 76.76, "ram_util_percent": 31.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.341190457344055, "policy_loss": -0.0015987065620720387, "vf_loss": 6.342834067344666, "vf_explained_var": -1.3828277587890625e-06, "kl": 0.0003680967396348933, "entropy": 0.44852658957242963, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1170.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.535999999999828, "episode_len_mean": 235.26, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 44.300000000000004, 42.10000000000001, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.90000000000002, 45.1, 46.3, 44.7, 46.699999999999996, 37.50000000000003, 46.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 28.89999999999997, 46.099999999999994, 43.900000000000006, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.9, 45.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.9, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 7.299999999999663, 45.1, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, 37.90000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 38.700000000000024, 44.5, 44.300000000000004, -50.00000000000044, 43.900000000000006, 38.700000000000024, 42.30000000000001, 44.10000000000001, -50.00000000000044, 45.5, 28.09999999999996, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 45.3, 23.29999999999989, 44.5, 47.5, 45.3, 38.90000000000002, -50.00000000000044, 44.7, 47.3, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [500, 54, 58, 80, 26, 500, 34, 500, 500, 500, 36, 92, 50, 38, 54, 34, 126, 32, 72, 500, 500, 24, 30, 500, 500, 40, 500, 212, 40, 62, 500, 82, 42, 500, 500, 500, 28, 500, 192, 42, 500, 62, 500, 22, 500, 40, 30, 500, 196, 500, 500, 500, 500, 500, 54, 500, 428, 50, 500, 42, 500, 76, 500, 30, 122, 500, 28, 500, 34, 114, 56, 58, 500, 62, 114, 78, 60, 500, 46, 220, 500, 32, 38, 500, 48, 268, 56, 26, 48, 112, 500, 54, 28, 40, 500, 40, 78, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561089539472936, "mean_inference_ms": 1.4548999149448119, "mean_action_processing_ms": 0.17167961019016745, "mean_env_wait_ms": 0.10233463701279166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000261306762695, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.14501476287841797}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.535999999999828, "episode_len_mean": 235.26, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 44.300000000000004, 42.10000000000001, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 40.90000000000002, 45.1, 46.3, 44.7, 46.699999999999996, 37.50000000000003, 46.9, 42.900000000000006, -50.00000000000044, -50.00000000000044, 47.7, 47.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 28.89999999999997, 46.099999999999994, 43.900000000000006, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 30.9, 45.9, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.9, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 7.299999999999663, 45.1, -50.00000000000044, 45.9, -50.00000000000044, 42.500000000000014, -50.00000000000044, 47.1, 37.90000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 38.700000000000024, 44.5, 44.300000000000004, -50.00000000000044, 43.900000000000006, 38.700000000000024, 42.30000000000001, 44.10000000000001, -50.00000000000044, 45.5, 28.09999999999996, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 45.3, 23.29999999999989, 44.5, 47.5, 45.3, 38.90000000000002, -50.00000000000044, 44.7, 47.3, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [500, 54, 58, 80, 26, 500, 34, 500, 500, 500, 36, 92, 50, 38, 54, 34, 126, 32, 72, 500, 500, 24, 30, 500, 500, 40, 500, 212, 40, 62, 500, 82, 42, 500, 500, 500, 28, 500, 192, 42, 500, 62, 500, 22, 500, 40, 30, 500, 196, 500, 500, 500, 500, 500, 54, 500, 428, 50, 500, 42, 500, 76, 500, 30, 122, 500, 28, 500, 34, 114, 56, 58, 500, 62, 114, 78, 60, 500, 46, 220, 500, 32, 38, 500, 48, 268, 56, 26, 48, 112, 500, 54, 28, 40, 500, 40, 78, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561089539472936, "mean_inference_ms": 1.4548999149448119, "mean_action_processing_ms": 0.17167961019016745, "mean_env_wait_ms": 0.10233463701279166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026000261306762695, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.14501476287841797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5370.59957104901, "num_env_steps_trained_throughput_per_sec": 5370.59957104901, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3436.449, "sample_time_ms": 3201.152, "load_time_ms": 13.533, "load_throughput": 1330061.308, "learn_time_ms": 210.03, "learn_throughput": 85701.903, "synch_weights_time_ms": 10.179}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4023, "training_iteration": 59, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-39", "timestamp": 1698246519, "time_this_iter_s": 3.3575785160064697, "time_total_s": 221.89256644248962, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.89256644248962, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 75.8, "ram_util_percent": 31.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.2853796005249025, "policy_loss": -0.029958000965416433, "vf_loss": 6.315377235412598, "vf_explained_var": -1.2785196304321289e-06, "kl": 6.671100287185539e-05, "entropy": 0.3959899440407753, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1190.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.824999999999821, "episode_len_mean": 247.36, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 37.90000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 38.700000000000024, 44.5, 44.300000000000004, -50.00000000000044, 43.900000000000006, 38.700000000000024, 42.30000000000001, 44.10000000000001, -50.00000000000044, 45.5, 28.09999999999996, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 45.3, 23.29999999999989, 44.5, 47.5, 45.3, 38.90000000000002, -50.00000000000044, 44.7, 47.3, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 33.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 46.9, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.70000000000001, 42.500000000000014, -50.00000000000044, 47.7, 47.1, 46.5, 47.7, 46.099999999999994, 40.30000000000002, -50.00000000000044, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.5, 46.5, -50.00000000000044, 36.70000000000003, 40.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 26.09999999999993, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [30, 122, 500, 28, 500, 34, 114, 56, 58, 500, 62, 114, 78, 60, 500, 46, 220, 500, 32, 38, 500, 48, 268, 56, 26, 48, 112, 500, 54, 28, 40, 500, 40, 78, 500, 56, 500, 170, 48, 500, 500, 42, 500, 500, 500, 36, 76, 32, 126, 500, 500, 500, 36, 74, 76, 500, 24, 30, 36, 24, 40, 98, 500, 468, 500, 500, 212, 56, 36, 500, 134, 94, 500, 50, 500, 500, 100, 38, 500, 500, 62, 500, 500, 432, 500, 62, 500, 500, 64, 500, 146, 500, 240, 50, 500, 500, 40, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568012491499829, "mean_inference_ms": 1.455499703781203, "mean_action_processing_ms": 0.17200586109862115, "mean_env_wait_ms": 0.10233294157422457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299427032470703, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.18328309059143066}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.824999999999821, "episode_len_mean": 247.36, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 37.90000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 38.700000000000024, 44.5, 44.300000000000004, -50.00000000000044, 43.900000000000006, 38.700000000000024, 42.30000000000001, 44.10000000000001, -50.00000000000044, 45.5, 28.09999999999996, -50.00000000000044, 46.9, 46.3, -50.00000000000044, 45.3, 23.29999999999989, 44.5, 47.5, 45.3, 38.90000000000002, -50.00000000000044, 44.7, 47.3, 46.099999999999994, -50.00000000000044, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.5, -50.00000000000044, 33.10000000000003, 45.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.500000000000014, 46.9, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.70000000000001, 42.500000000000014, -50.00000000000044, 47.7, 47.1, 46.5, 47.7, 46.099999999999994, 40.30000000000002, -50.00000000000044, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.5, 46.5, -50.00000000000044, 36.70000000000003, 40.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 26.09999999999993, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [30, 122, 500, 28, 500, 34, 114, 56, 58, 500, 62, 114, 78, 60, 500, 46, 220, 500, 32, 38, 500, 48, 268, 56, 26, 48, 112, 500, 54, 28, 40, 500, 40, 78, 500, 56, 500, 170, 48, 500, 500, 42, 500, 500, 500, 36, 76, 32, 126, 500, 500, 500, 36, 74, 76, 500, 24, 30, 36, 24, 40, 98, 500, 468, 500, 500, 212, 56, 36, 500, 134, 94, 500, 50, 500, 500, 100, 38, 500, 500, 62, 500, 500, 432, 500, 62, 500, 500, 64, 500, 146, 500, 240, 50, 500, 500, 40, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568012491499829, "mean_inference_ms": 1.455499703781203, "mean_action_processing_ms": 0.17200586109862115, "mean_env_wait_ms": 0.10233294157422457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299427032470703, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.18328309059143066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3884.316349521768, "num_env_steps_trained_throughput_per_sec": 3884.316349521768, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3548.987, "sample_time_ms": 3270.41, "load_time_ms": 16.541, "load_throughput": 1088184.401, "learn_time_ms": 249.289, "learn_throughput": 72205.259, "synch_weights_time_ms": 11.066}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4086, "training_iteration": 60, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-44", "timestamp": 1698246524, "time_this_iter_s": 4.640020847320557, "time_total_s": 226.53258728981018, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 226.53258728981018, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 77.60000000000001, "ram_util_percent": 31.128571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.508323049545288, "policy_loss": -0.01878870353102684, "vf_loss": 6.527155661582947, "vf_explained_var": -5.3644180297851564e-08, "kl": 0.0002969331740034775, "entropy": 0.43951815366744995, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1210.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.100000000000224, "episode_len_mean": 291.52, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.89999999999997, 44.5, 46.5, -50.00000000000044, 36.70000000000003, 40.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 26.09999999999993, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 2.499999999999595, 45.1, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 16.8999999999998, 45.7, 38.10000000000002, 45.1, 16.699999999999797, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, 46.5, -50.00000000000044, 30.29999999999999, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 47.3, 45.9], "episode_lengths": [212, 56, 36, 500, 134, 94, 500, 50, 500, 500, 100, 38, 500, 500, 62, 500, 500, 432, 500, 62, 500, 500, 64, 500, 146, 500, 240, 50, 500, 500, 40, 500, 38, 500, 500, 54, 500, 500, 68, 52, 500, 500, 26, 500, 62, 500, 500, 40, 500, 44, 500, 34, 70, 500, 500, 500, 118, 476, 50, 40, 44, 500, 500, 500, 500, 96, 332, 44, 120, 50, 334, 54, 500, 46, 500, 42, 32, 500, 500, 178, 500, 52, 62, 36, 500, 198, 500, 264, 500, 500, 44, 500, 500, 500, 42, 24, 500, 500, 28, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4587499908592266, "mean_inference_ms": 1.4591626583301127, "mean_action_processing_ms": 0.1723473768481312, "mean_env_wait_ms": 0.10246921303926455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03501176834106445, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.18219685554504395}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.100000000000224, "episode_len_mean": 291.52, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.89999999999997, 44.5, 46.5, -50.00000000000044, 36.70000000000003, 40.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 26.09999999999993, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 2.499999999999595, 45.1, 46.099999999999994, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 16.8999999999998, 45.7, 38.10000000000002, 45.1, 16.699999999999797, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, 46.5, -50.00000000000044, 30.29999999999999, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 47.3, 45.9], "episode_lengths": [212, 56, 36, 500, 134, 94, 500, 50, 500, 500, 100, 38, 500, 500, 62, 500, 500, 432, 500, 62, 500, 500, 64, 500, 146, 500, 240, 50, 500, 500, 40, 500, 38, 500, 500, 54, 500, 500, 68, 52, 500, 500, 26, 500, 62, 500, 500, 40, 500, 44, 500, 34, 70, 500, 500, 500, 118, 476, 50, 40, 44, 500, 500, 500, 500, 96, 332, 44, 120, 50, 334, 54, 500, 46, 500, 42, 32, 500, 500, 178, 500, 52, 62, 36, 500, 198, 500, 264, 500, 500, 44, 500, 500, 500, 42, 24, 500, 500, 28, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4587499908592266, "mean_inference_ms": 1.4591626583301127, "mean_action_processing_ms": 0.1723473768481312, "mean_env_wait_ms": 0.10246921303926455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03501176834106445, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.18219685554504395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3921.816617194713, "num_env_steps_trained_throughput_per_sec": 3921.816617194713, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3665.022, "sample_time_ms": 3345.202, "load_time_ms": 19.033, "load_throughput": 945738.734, "learn_time_ms": 287.152, "learn_throughput": 62684.539, "synch_weights_time_ms": 12.053}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4152, "training_iteration": 61, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-49", "timestamp": 1698246529, "time_this_iter_s": 4.595234155654907, "time_total_s": 231.1278214454651, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 231.1278214454651, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 83.28333333333333, "ram_util_percent": 31.116666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.459758973121643, "policy_loss": 0.008916492015123368, "vf_loss": 6.450881600379944, "vf_explained_var": -1.3053417205810546e-06, "kl": 0.00046598895452802934, "entropy": 0.3925340503454208, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1230.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.591999999999811, "episode_len_mean": 254.68, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.699999999999797, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, 46.5, -50.00000000000044, 30.29999999999999, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 47.3, 45.9, -50.00000000000044, 23.29999999999989, 18.29999999999982, 45.7, 46.699999999999996, 44.5, 39.70000000000002, 47.5, 44.7, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.7, 46.5, 44.5, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 30.29999999999999, 38.50000000000003, 47.5, 1.299999999999578, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 14.09999999999976, 42.70000000000001, 37.50000000000003, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.699999999999996, 47.5, 46.5, 36.10000000000004, 29.69999999999998, 42.900000000000006], "episode_lengths": [334, 54, 500, 46, 500, 42, 32, 500, 500, 178, 500, 52, 62, 36, 500, 198, 500, 264, 500, 500, 44, 500, 500, 500, 42, 24, 500, 500, 28, 42, 500, 268, 318, 44, 34, 56, 104, 26, 54, 500, 44, 500, 500, 32, 500, 52, 90, 500, 500, 500, 500, 58, 500, 24, 36, 56, 98, 32, 500, 500, 198, 116, 26, 488, 32, 500, 500, 500, 84, 54, 38, 32, 500, 500, 106, 500, 52, 500, 500, 28, 66, 20, 500, 500, 500, 500, 34, 360, 74, 126, 48, 500, 70, 500, 34, 26, 36, 140, 204, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4594873807575153, "mean_inference_ms": 1.4623332005081506, "mean_action_processing_ms": 0.172646205923865, "mean_env_wait_ms": 0.10291648408784021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598427772521973, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.17466402053833008}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.591999999999811, "episode_len_mean": 254.68, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.699999999999797, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 45.9, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 44.900000000000006, 43.900000000000006, 46.5, -50.00000000000044, 30.29999999999999, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 47.3, 45.9, -50.00000000000044, 23.29999999999989, 18.29999999999982, 45.7, 46.699999999999996, 44.5, 39.70000000000002, 47.5, 44.7, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 47.7, 46.5, 44.5, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 30.29999999999999, 38.50000000000003, 47.5, 1.299999999999578, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 14.09999999999976, 42.70000000000001, 37.50000000000003, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.699999999999996, 47.5, 46.5, 36.10000000000004, 29.69999999999998, 42.900000000000006], "episode_lengths": [334, 54, 500, 46, 500, 42, 32, 500, 500, 178, 500, 52, 62, 36, 500, 198, 500, 264, 500, 500, 44, 500, 500, 500, 42, 24, 500, 500, 28, 42, 500, 268, 318, 44, 34, 56, 104, 26, 54, 500, 44, 500, 500, 32, 500, 52, 90, 500, 500, 500, 500, 58, 500, 24, 36, 56, 98, 32, 500, 500, 198, 116, 26, 488, 32, 500, 500, 500, 84, 54, 38, 32, 500, 500, 106, 500, 52, 500, 500, 28, 66, 20, 500, 500, 500, 500, 34, 360, 74, 126, 48, 500, 70, 500, 34, 26, 36, 140, 204, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4594873807575153, "mean_inference_ms": 1.4623332005081506, "mean_action_processing_ms": 0.172646205923865, "mean_env_wait_ms": 0.10291648408784021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03598427772521973, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.17466402053833008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3874.3476701484446, "num_env_steps_trained_throughput_per_sec": 3874.3476701484446, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3799.445, "sample_time_ms": 3435.213, "load_time_ms": 22.005, "load_throughput": 818004.414, "learn_time_ms": 327.656, "learn_throughput": 54935.659, "synch_weights_time_ms": 12.989}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4222, "training_iteration": 62, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-53", "timestamp": 1698246533, "time_this_iter_s": 4.652943849563599, "time_total_s": 235.7807652950287, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 235.7807652950287, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 70.45714285714286, "ram_util_percent": 31.085714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 5.789177012443543, "policy_loss": 0.061777394637465476, "vf_loss": 5.727440428733826, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0004728968073550277, "entropy": 0.40811521261930467, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1250.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7379999999997922, "episode_len_mean": 273.18, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 30.29999999999999, 38.50000000000003, 47.5, 1.299999999999578, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 14.09999999999976, 42.70000000000001, 37.50000000000003, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.699999999999996, 47.5, 46.5, 36.10000000000004, 29.69999999999998, 42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 37.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.7, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.9, 44.5, 5.6999999999996405, 23.29999999999989, -50.00000000000044], "episode_lengths": [500, 500, 198, 116, 26, 488, 32, 500, 500, 500, 84, 54, 38, 32, 500, 500, 106, 500, 52, 500, 500, 28, 66, 20, 500, 500, 500, 500, 34, 360, 74, 126, 48, 500, 70, 500, 34, 26, 36, 140, 204, 72, 500, 28, 500, 36, 74, 500, 122, 36, 500, 500, 336, 500, 500, 88, 54, 46, 38, 500, 500, 292, 500, 98, 48, 500, 26, 500, 52, 50, 500, 56, 500, 500, 22, 500, 30, 500, 32, 500, 500, 96, 500, 500, 108, 500, 500, 500, 500, 36, 66, 500, 500, 42, 42, 32, 56, 444, 268, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4602700625049331, "mean_inference_ms": 1.4653026562626927, "mean_action_processing_ms": 0.17302686577369122, "mean_env_wait_ms": 0.10307144062633618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039980173110961914, "StateBufferConnector_ms": 0.011004447937011719, "ViewRequirementAgentConnector_ms": 0.18540596961975098}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7379999999997922, "episode_len_mean": 273.18, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 30.29999999999999, 38.50000000000003, 47.5, 1.299999999999578, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.7, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, 48.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 14.09999999999976, 42.70000000000001, 37.50000000000003, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.699999999999996, 47.5, 46.5, 36.10000000000004, 29.69999999999998, 42.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 46.5, 42.70000000000001, -50.00000000000044, 37.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.30000000000001, 44.7, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.9, 44.5, 5.6999999999996405, 23.29999999999989, -50.00000000000044], "episode_lengths": [500, 500, 198, 116, 26, 488, 32, 500, 500, 500, 84, 54, 38, 32, 500, 500, 106, 500, 52, 500, 500, 28, 66, 20, 500, 500, 500, 500, 34, 360, 74, 126, 48, 500, 70, 500, 34, 26, 36, 140, 204, 72, 500, 28, 500, 36, 74, 500, 122, 36, 500, 500, 336, 500, 500, 88, 54, 46, 38, 500, 500, 292, 500, 98, 48, 500, 26, 500, 52, 50, 500, 56, 500, 500, 22, 500, 30, 500, 32, 500, 500, 96, 500, 500, 108, 500, 500, 500, 500, 36, 66, 500, 500, 42, 42, 32, 56, 444, 268, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4602700625049331, "mean_inference_ms": 1.4653026562626927, "mean_action_processing_ms": 0.17302686577369122, "mean_env_wait_ms": 0.10307144062633618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039980173110961914, "StateBufferConnector_ms": 0.011004447937011719, "ViewRequirementAgentConnector_ms": 0.18540596961975098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3961.23235074167, "num_env_steps_trained_throughput_per_sec": 3961.23235074167, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3905.64, "sample_time_ms": 3497.586, "load_time_ms": 25.124, "load_throughput": 716436.185, "learn_time_ms": 367.614, "learn_throughput": 48964.408, "synch_weights_time_ms": 13.635}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4280, "training_iteration": 63, "trial_id": "9f288_00007", "date": "2023-10-25_16-08-58", "timestamp": 1698246538, "time_this_iter_s": 4.550082445144653, "time_total_s": 240.33084774017334, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.33084774017334, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 81.40000000000002, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.186529541015625, "policy_loss": -0.008554672449827194, "vf_loss": 6.195121479034424, "vf_explained_var": -1.6510486602783203e-06, "kl": 0.0004185024334972809, "entropy": 0.37228872179985045, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1270.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.006000000000237, "episode_len_mean": 300.56, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.899999999999856, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.9, 44.5, 5.6999999999996405, 23.29999999999989, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 46.5, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 46.9, 15.299999999999777, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 47.5, -50.00000000000044, 46.9, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.10000000000001, 38.90000000000002, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [292, 500, 98, 48, 500, 26, 500, 52, 50, 500, 56, 500, 500, 22, 500, 30, 500, 32, 500, 500, 96, 500, 500, 108, 500, 500, 500, 500, 36, 66, 500, 500, 42, 42, 32, 56, 444, 268, 500, 500, 70, 136, 500, 500, 500, 34, 500, 500, 28, 500, 34, 500, 60, 500, 44, 36, 340, 500, 500, 500, 352, 32, 348, 500, 500, 38, 40, 58, 64, 500, 500, 60, 52, 500, 500, 500, 24, 26, 500, 32, 414, 500, 500, 500, 24, 500, 500, 312, 500, 500, 82, 500, 144, 500, 60, 112, 70, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46153645360363116, "mean_inference_ms": 1.4692080488200414, "mean_action_processing_ms": 0.1736676208374294, "mean_env_wait_ms": 0.1033746064984297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050028085708618164, "StateBufferConnector_ms": 0.01200413703918457, "ViewRequirementAgentConnector_ms": 0.19004535675048828}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.006000000000237, "episode_len_mean": 300.56, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.899999999999856, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 47.5, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 47.1, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 46.9, 44.5, 5.6999999999996405, 23.29999999999989, -50.00000000000044, -50.00000000000044, 43.10000000000001, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.7, 46.5, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 46.9, 15.299999999999777, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, 44.300000000000004, 43.7, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 47.5, -50.00000000000044, 46.9, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.10000000000001, 38.90000000000002, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [292, 500, 98, 48, 500, 26, 500, 52, 50, 500, 56, 500, 500, 22, 500, 30, 500, 32, 500, 500, 96, 500, 500, 108, 500, 500, 500, 500, 36, 66, 500, 500, 42, 42, 32, 56, 444, 268, 500, 500, 70, 136, 500, 500, 500, 34, 500, 500, 28, 500, 34, 500, 60, 500, 44, 36, 340, 500, 500, 500, 352, 32, 348, 500, 500, 38, 40, 58, 64, 500, 500, 60, 52, 500, 500, 500, 24, 26, 500, 32, 414, 500, 500, 500, 24, 500, 500, 312, 500, 500, 82, 500, 144, 500, 60, 112, 70, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46153645360363116, "mean_inference_ms": 1.4692080488200414, "mean_action_processing_ms": 0.1736676208374294, "mean_env_wait_ms": 0.1033746064984297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050028085708618164, "StateBufferConnector_ms": 0.01200413703918457, "ViewRequirementAgentConnector_ms": 0.19004535675048828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3795.793928446939, "num_env_steps_trained_throughput_per_sec": 3795.793928446939, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 4044.329, "sample_time_ms": 3595.067, "load_time_ms": 28.424, "load_throughput": 633263.395, "learn_time_ms": 404.675, "learn_throughput": 44480.185, "synch_weights_time_ms": 14.464}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4341, "training_iteration": 64, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-03", "timestamp": 1698246543, "time_this_iter_s": 4.74809455871582, "time_total_s": 245.07894229888916, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.07894229888916, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 77.12857142857142, "ram_util_percent": 31.014285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.307745099067688, "policy_loss": 0.019938817876391113, "vf_loss": 6.287841892242431, "vf_explained_var": -1.5020370483398437e-06, "kl": 0.0005008915434913774, "entropy": 0.355240036547184, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1290.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.06399999999979002, "episode_len_mean": 269.9, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, 47.5, -50.00000000000044, 46.9, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.10000000000001, 38.90000000000002, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.300000000000004, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 39.50000000000002, 46.099999999999994, -50.00000000000044, 46.9, 46.699999999999996, 41.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.5, 46.699999999999996, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, 41.100000000000016, 47.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.1, -50.00000000000044, 23.699999999999896, -50.00000000000044, 45.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.7, 7.699999999999669, 45.3, -50.00000000000044, 39.90000000000002, 47.7], "episode_lengths": [500, 24, 26, 500, 32, 414, 500, 500, 500, 24, 500, 500, 312, 500, 500, 82, 500, 144, 500, 60, 112, 70, 34, 500, 500, 500, 26, 500, 500, 96, 58, 500, 50, 500, 40, 24, 500, 40, 500, 500, 38, 500, 44, 26, 500, 500, 500, 500, 34, 86, 106, 40, 500, 32, 34, 86, 22, 500, 500, 500, 68, 26, 34, 500, 80, 28, 500, 26, 104, 500, 500, 72, 500, 36, 90, 30, 500, 500, 68, 500, 30, 500, 500, 30, 500, 30, 500, 264, 500, 44, 34, 58, 500, 500, 24, 424, 48, 500, 102, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4631041989441148, "mean_inference_ms": 1.4741248046237683, "mean_action_processing_ms": 0.17420894194095227, "mean_env_wait_ms": 0.10404212037955216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02794480323791504, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.17215800285339355}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.06399999999979002, "episode_len_mean": 269.9, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.7, 47.5, -50.00000000000044, 46.9, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 44.10000000000001, 38.90000000000002, 43.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 44.300000000000004, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 39.50000000000002, 46.099999999999994, -50.00000000000044, 46.9, 46.699999999999996, 41.500000000000014, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.5, 46.699999999999996, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, 41.100000000000016, 47.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.1, -50.00000000000044, 23.699999999999896, -50.00000000000044, 45.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.7, 7.699999999999669, 45.3, -50.00000000000044, 39.90000000000002, 47.7], "episode_lengths": [500, 24, 26, 500, 32, 414, 500, 500, 500, 24, 500, 500, 312, 500, 500, 82, 500, 144, 500, 60, 112, 70, 34, 500, 500, 500, 26, 500, 500, 96, 58, 500, 50, 500, 40, 24, 500, 40, 500, 500, 38, 500, 44, 26, 500, 500, 500, 500, 34, 86, 106, 40, 500, 32, 34, 86, 22, 500, 500, 500, 68, 26, 34, 500, 80, 28, 500, 26, 104, 500, 500, 72, 500, 36, 90, 30, 500, 500, 68, 500, 30, 500, 500, 30, 500, 30, 500, 264, 500, 44, 34, 58, 500, 500, 24, 424, 48, 500, 102, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4631041989441148, "mean_inference_ms": 1.4741248046237683, "mean_action_processing_ms": 0.17420894194095227, "mean_env_wait_ms": 0.10404212037955216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02794480323791504, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.17215800285339355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3845.817393457103, "num_env_steps_trained_throughput_per_sec": 3845.817393457103, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 4167.904, "sample_time_ms": 3676.426, "load_time_ms": 30.145, "load_throughput": 597116.283, "learn_time_ms": 444.213, "learn_throughput": 40521.098, "synch_weights_time_ms": 15.321}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4416, "training_iteration": 65, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-07", "timestamp": 1698246547, "time_this_iter_s": 4.686408042907715, "time_total_s": 249.76535034179688, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.76535034179688, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 84.43333333333334, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.2497039318084715, "policy_loss": 0.01947050355374813, "vf_loss": 6.230266642570496, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.0006029138196083749, "entropy": 0.33140706419944765, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1310.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8750000000002287, "episode_len_mean": 284.26, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, 46.699999999999996, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, 41.100000000000016, 47.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.1, -50.00000000000044, 23.699999999999896, -50.00000000000044, 45.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.7, 7.699999999999669, 45.3, -50.00000000000044, 39.90000000000002, 47.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 45.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.9, 47.7, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 47.7, -50.00000000000044, 46.9, 43.900000000000006, 43.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 2.699999999999598], "episode_lengths": [26, 34, 500, 80, 28, 500, 26, 104, 500, 500, 72, 500, 36, 90, 30, 500, 500, 68, 500, 30, 500, 500, 30, 500, 30, 500, 264, 500, 44, 34, 58, 500, 500, 24, 424, 48, 500, 102, 24, 500, 500, 24, 500, 500, 500, 500, 26, 52, 40, 500, 500, 470, 44, 500, 500, 26, 500, 42, 24, 102, 500, 500, 40, 58, 24, 500, 32, 62, 64, 500, 28, 500, 500, 76, 500, 500, 500, 28, 26, 500, 500, 32, 500, 500, 500, 128, 96, 64, 500, 500, 38, 500, 500, 500, 500, 32, 500, 68, 500, 474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4634993348688054, "mean_inference_ms": 1.4759684198639196, "mean_action_processing_ms": 0.17446962220169468, "mean_env_wait_ms": 0.1041121253505556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003910064697266, "StateBufferConnector_ms": 0.004002571105957031, "ViewRequirementAgentConnector_ms": 0.16985440254211426}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.8750000000002287, "episode_len_mean": 284.26, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, 46.699999999999996, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, 41.100000000000016, 47.1, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 47.1, -50.00000000000044, 23.699999999999896, -50.00000000000044, 45.7, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.7, 7.699999999999669, 45.3, -50.00000000000044, 39.90000000000002, 47.7, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 44.900000000000006, 46.099999999999994, -50.00000000000044, -50.00000000000044, 3.0999999999996035, 45.7, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.9, 47.7, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, 47.7, -50.00000000000044, 46.9, 43.900000000000006, 43.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 2.699999999999598], "episode_lengths": [26, 34, 500, 80, 28, 500, 26, 104, 500, 500, 72, 500, 36, 90, 30, 500, 500, 68, 500, 30, 500, 500, 30, 500, 30, 500, 264, 500, 44, 34, 58, 500, 500, 24, 424, 48, 500, 102, 24, 500, 500, 24, 500, 500, 500, 500, 26, 52, 40, 500, 500, 470, 44, 500, 500, 26, 500, 42, 24, 102, 500, 500, 40, 58, 24, 500, 32, 62, 64, 500, 28, 500, 500, 76, 500, 500, 500, 28, 26, 500, 500, 32, 500, 500, 500, 128, 96, 64, 500, 500, 38, 500, 500, 500, 500, 32, 500, 68, 500, 474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4634993348688054, "mean_inference_ms": 1.4759684198639196, "mean_action_processing_ms": 0.17446962220169468, "mean_env_wait_ms": 0.1041121253505556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003910064697266, "StateBufferConnector_ms": 0.004002571105957031, "ViewRequirementAgentConnector_ms": 0.16985440254211426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4174.5652639104765, "num_env_steps_trained_throughput_per_sec": 4174.5652639104765, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 4267.829, "sample_time_ms": 3750.605, "load_time_ms": 32.554, "load_throughput": 552924.497, "learn_time_ms": 467.138, "learn_throughput": 38532.544, "synch_weights_time_ms": 15.733}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4477, "training_iteration": 66, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-12", "timestamp": 1698246552, "time_this_iter_s": 4.318827152252197, "time_total_s": 254.08417749404907, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.08417749404907, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 78.73333333333333, "ram_util_percent": 31.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.122096586227417, "policy_loss": 0.06247819010168314, "vf_loss": 6.059655070304871, "vf_explained_var": -1.3828277587890625e-06, "kl": 0.0003564605691141587, "entropy": 0.3672956913709641, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1330.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7810000000002116, "episode_len_mean": 273.34, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 43.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 47.1, 44.300000000000004, 44.7, 45.9, 47.9, 9.299999999999692, 46.3, -50.00000000000044, 35.10000000000004, 40.10000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 44.7, 47.5, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 38.50000000000003, -50.00000000000044, 47.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, -50.00000000000044, 46.3, 47.7, 43.7, 47.5, 46.699999999999996, 34.50000000000004, 37.300000000000026], "episode_lengths": [62, 64, 500, 28, 500, 500, 76, 500, 500, 500, 28, 26, 500, 500, 32, 500, 500, 500, 128, 96, 64, 500, 500, 38, 500, 500, 500, 500, 32, 500, 68, 500, 474, 500, 500, 500, 42, 500, 40, 30, 58, 54, 42, 22, 408, 38, 500, 150, 100, 500, 164, 500, 54, 26, 500, 54, 500, 44, 50, 500, 500, 28, 116, 500, 22, 500, 46, 500, 500, 500, 36, 500, 500, 158, 500, 26, 500, 500, 500, 40, 30, 500, 500, 500, 44, 56, 44, 500, 500, 30, 40, 56, 500, 38, 24, 64, 26, 34, 156, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46314369592054855, "mean_inference_ms": 1.4764655142020888, "mean_action_processing_ms": 0.1748073546974412, "mean_env_wait_ms": 0.10413129675600853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701305389404297, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.1290132999420166}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7810000000002116, "episode_len_mean": 273.34, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 43.7, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 40.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 2.699999999999598, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 47.1, 44.300000000000004, 44.7, 45.9, 47.9, 9.299999999999692, 46.3, -50.00000000000044, 35.10000000000004, 40.10000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 44.7, 47.5, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 47.3, 38.50000000000003, -50.00000000000044, 47.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, -50.00000000000044, 46.3, 47.7, 43.7, 47.5, 46.699999999999996, 34.50000000000004, 37.300000000000026], "episode_lengths": [62, 64, 500, 28, 500, 500, 76, 500, 500, 500, 28, 26, 500, 500, 32, 500, 500, 500, 128, 96, 64, 500, 500, 38, 500, 500, 500, 500, 32, 500, 68, 500, 474, 500, 500, 500, 42, 500, 40, 30, 58, 54, 42, 22, 408, 38, 500, 150, 100, 500, 164, 500, 54, 26, 500, 54, 500, 44, 50, 500, 500, 28, 116, 500, 22, 500, 46, 500, 500, 500, 36, 500, 500, 158, 500, 26, 500, 500, 500, 40, 30, 500, 500, 500, 44, 56, 44, 500, 500, 30, 40, 56, 500, 38, 24, 64, 26, 34, 156, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46314369592054855, "mean_inference_ms": 1.4764655142020888, "mean_action_processing_ms": 0.1748073546974412, "mean_env_wait_ms": 0.10413129675600853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701305389404297, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.1290132999420166}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5243.724458126278, "num_env_steps_trained_throughput_per_sec": 5243.724458126278, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 4247.513, "sample_time_ms": 3731.293, "load_time_ms": 32.454, "load_throughput": 554626.452, "learn_time_ms": 466.331, "learn_throughput": 38599.182, "synch_weights_time_ms": 15.635}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4544, "training_iteration": 67, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-15", "timestamp": 1698246555, "time_this_iter_s": 3.4376726150512695, "time_total_s": 257.52185010910034, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.52185010910034, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 74.7, "ram_util_percent": 31.060000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.214044117927552, "policy_loss": 0.017075557634234427, "vf_loss": 6.197007369995117, "vf_explained_var": -2.1398067474365234e-06, "kl": 0.0005926002288788368, "entropy": 0.3872909039258957, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1350.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2620000000002203, "episode_len_mean": 283.14, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, 38.50000000000003, -50.00000000000044, 47.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, -50.00000000000044, 46.3, 47.7, 43.7, 47.5, 46.699999999999996, 34.50000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.70000000000001, 46.5, 5.899999999999643, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, 16.09999999999979, 46.3, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 37.10000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.90000000000003, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 46.3, 28.699999999999967], "episode_lengths": [500, 28, 116, 500, 22, 500, 46, 500, 500, 500, 36, 500, 500, 158, 500, 26, 500, 500, 500, 40, 30, 500, 500, 500, 44, 56, 44, 500, 500, 30, 40, 56, 500, 38, 24, 64, 26, 34, 156, 128, 500, 500, 500, 500, 500, 500, 500, 20, 500, 500, 58, 500, 500, 28, 500, 500, 34, 74, 36, 442, 62, 30, 500, 500, 28, 500, 48, 500, 36, 72, 500, 108, 26, 500, 340, 38, 316, 500, 500, 500, 38, 500, 26, 130, 500, 66, 76, 122, 62, 500, 32, 500, 50, 500, 500, 500, 422, 500, 38, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633276450607147, "mean_inference_ms": 1.476219757615706, "mean_action_processing_ms": 0.17447138933911735, "mean_env_wait_ms": 0.103895489601296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041795969009399414, "StateBufferConnector_ms": 0.005994319915771484, "ViewRequirementAgentConnector_ms": 0.1259293556213379}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2620000000002203, "episode_len_mean": 283.14, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, 38.50000000000003, -50.00000000000044, 47.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, -50.00000000000044, 46.3, 47.7, 43.7, 47.5, 46.699999999999996, 34.50000000000004, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 48.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 42.70000000000001, 46.5, 5.899999999999643, 43.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, 16.09999999999979, 46.3, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 37.10000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.90000000000003, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 46.3, 28.699999999999967], "episode_lengths": [500, 28, 116, 500, 22, 500, 46, 500, 500, 500, 36, 500, 500, 158, 500, 26, 500, 500, 500, 40, 30, 500, 500, 500, 44, 56, 44, 500, 500, 30, 40, 56, 500, 38, 24, 64, 26, 34, 156, 128, 500, 500, 500, 500, 500, 500, 500, 20, 500, 500, 58, 500, 500, 28, 500, 500, 34, 74, 36, 442, 62, 30, 500, 500, 28, 500, 48, 500, 36, 72, 500, 108, 26, 500, 340, 38, 316, 500, 500, 500, 38, 500, 26, 130, 500, 66, 76, 122, 62, 500, 32, 500, 50, 500, 500, 500, 422, 500, 38, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633276450607147, "mean_inference_ms": 1.476219757615706, "mean_action_processing_ms": 0.17447138933911735, "mean_env_wait_ms": 0.103895489601296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041795969009399414, "StateBufferConnector_ms": 0.005994319915771484, "ViewRequirementAgentConnector_ms": 0.1259293556213379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4783.031996451188, "num_env_steps_trained_throughput_per_sec": 4783.031996451188, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 4269.56, "sample_time_ms": 3735.996, "load_time_ms": 33.339, "load_throughput": 539905.131, "learn_time_ms": 483.386, "learn_throughput": 37237.291, "synch_weights_time_ms": 15.039}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4604, "training_iteration": 68, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-19", "timestamp": 1698246559, "time_this_iter_s": 3.7690589427948, "time_total_s": 261.29090905189514, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.29090905189514, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 78.72, "ram_util_percent": 31.119999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.22259783744812, "policy_loss": 0.030549536645412444, "vf_loss": 6.1920840501785275, "vf_explained_var": -1.3470649719238282e-06, "kl": 0.00013964135247519495, "entropy": 0.3564460754394531, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1370.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.401000000000221, "episode_len_mean": 289.54, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, 16.09999999999979, 46.3, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 37.10000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.90000000000003, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 46.3, 28.699999999999967, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 15.49999999999978, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, 5.099999999999632, 45.7, 47.3, 46.9, 40.90000000000002, 46.9, 45.3, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 29.899999999999984, -50.00000000000044, 46.699999999999996, 16.499999999999794, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 500, 28, 500, 48, 500, 36, 72, 500, 108, 26, 500, 340, 38, 316, 500, 500, 500, 38, 500, 26, 130, 500, 66, 76, 122, 62, 500, 32, 500, 50, 500, 500, 500, 422, 500, 38, 214, 500, 116, 500, 500, 500, 158, 500, 78, 500, 500, 500, 500, 500, 56, 76, 32, 500, 500, 500, 88, 500, 48, 500, 346, 500, 196, 500, 500, 44, 500, 500, 78, 36, 500, 28, 500, 38, 38, 500, 500, 42, 500, 166, 500, 450, 44, 28, 32, 92, 32, 48, 58, 50, 500, 500, 30, 202, 500, 34, 336, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633736807094535, "mean_inference_ms": 1.4743100299882017, "mean_action_processing_ms": 0.1743243585389015, "mean_env_wait_ms": 0.1038513008676324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028984546661376953, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.13457036018371582}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.401000000000221, "episode_len_mean": 289.54, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 39.300000000000026, 47.5, -50.00000000000044, 16.09999999999979, 46.3, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 47.5, 37.10000000000003, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.90000000000003, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, -50.00000000000044, 46.3, 28.699999999999967, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 42.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 15.49999999999978, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, 5.099999999999632, 45.7, 47.3, 46.9, 40.90000000000002, 46.9, 45.3, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 29.899999999999984, -50.00000000000044, 46.699999999999996, 16.499999999999794, -50.00000000000044, 43.50000000000001], "episode_lengths": [500, 500, 28, 500, 48, 500, 36, 72, 500, 108, 26, 500, 340, 38, 316, 500, 500, 500, 38, 500, 26, 130, 500, 66, 76, 122, 62, 500, 32, 500, 50, 500, 500, 500, 422, 500, 38, 214, 500, 116, 500, 500, 500, 158, 500, 78, 500, 500, 500, 500, 500, 56, 76, 32, 500, 500, 500, 88, 500, 48, 500, 346, 500, 196, 500, 500, 44, 500, 500, 78, 36, 500, 28, 500, 38, 38, 500, 500, 42, 500, 166, 500, 450, 44, 28, 32, 92, 32, 48, 58, 50, 500, 500, 30, 202, 500, 34, 336, 500, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4633736807094535, "mean_inference_ms": 1.4743100299882017, "mean_action_processing_ms": 0.1743243585389015, "mean_env_wait_ms": 0.1038513008676324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028984546661376953, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.13457036018371582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4972.022840723061, "num_env_steps_trained_throughput_per_sec": 4972.022840723061, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 4296.428, "sample_time_ms": 3751.069, "load_time_ms": 33.527, "load_throughput": 536880.075, "learn_time_ms": 494.904, "learn_throughput": 36370.668, "synch_weights_time_ms": 15.128}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4666, "training_iteration": 69, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-23", "timestamp": 1698246563, "time_this_iter_s": 3.6262621879577637, "time_total_s": 264.9171712398529, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.9171712398529, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 67.16666666666667, "ram_util_percent": 31.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.02423129081726, "policy_loss": -0.04656994491815567, "vf_loss": 6.070838403701782, "vf_explained_var": -1.1771917343139648e-06, "kl": 2.6111135254325292e-05, "entropy": 0.37226356714963915, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1390.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.057000000000211486, "episode_len_mean": 276.12, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.49999999999978, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, 5.099999999999632, 45.7, 47.3, 46.9, 40.90000000000002, 46.9, 45.3, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 29.899999999999984, -50.00000000000044, 46.699999999999996, 16.499999999999794, -50.00000000000044, 43.50000000000001, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.70000000000002, 47.3, 45.1, 47.5, -50.00000000000044, 47.3, 40.10000000000002, -50.00000000000044, 8.49999999999968, 47.1, -50.00000000000044, 43.30000000000001, 46.9, 29.099999999999973, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.500000000000014, 46.699999999999996, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.5, 41.70000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 346, 500, 196, 500, 500, 44, 500, 500, 78, 36, 500, 28, 500, 38, 38, 500, 500, 42, 500, 166, 500, 450, 44, 28, 32, 92, 32, 48, 58, 50, 500, 500, 30, 202, 500, 34, 336, 500, 66, 60, 500, 48, 500, 500, 500, 28, 24, 276, 500, 500, 500, 500, 32, 500, 500, 134, 104, 28, 50, 26, 500, 28, 100, 500, 416, 30, 500, 68, 32, 210, 38, 42, 500, 500, 30, 500, 500, 500, 500, 38, 76, 34, 52, 38, 500, 500, 500, 84, 26, 84, 340, 500, 500, 500, 22, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628934422683733, "mean_inference_ms": 1.4742284715406933, "mean_action_processing_ms": 0.1743010743617183, "mean_env_wait_ms": 0.10378324651493318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0288846492767334, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.15384507179260254}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.057000000000211486, "episode_len_mean": 276.12, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.49999999999978, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, -50.00000000000044, 47.3, -50.00000000000044, 46.3, 46.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, 5.099999999999632, 45.7, 47.3, 46.9, 40.90000000000002, 46.9, 45.3, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 29.899999999999984, -50.00000000000044, 46.699999999999996, 16.499999999999794, -50.00000000000044, 43.50000000000001, 44.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 47.7, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, 39.70000000000002, 47.3, 45.1, 47.5, -50.00000000000044, 47.3, 40.10000000000002, -50.00000000000044, 8.49999999999968, 47.1, -50.00000000000044, 43.30000000000001, 46.9, 29.099999999999973, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.500000000000014, 46.699999999999996, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.5, 41.70000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 346, 500, 196, 500, 500, 44, 500, 500, 78, 36, 500, 28, 500, 38, 38, 500, 500, 42, 500, 166, 500, 450, 44, 28, 32, 92, 32, 48, 58, 50, 500, 500, 30, 202, 500, 34, 336, 500, 66, 60, 500, 48, 500, 500, 500, 28, 24, 276, 500, 500, 500, 500, 32, 500, 500, 134, 104, 28, 50, 26, 500, 28, 100, 500, 416, 30, 500, 68, 32, 210, 38, 42, 500, 500, 30, 500, 500, 500, 500, 38, 76, 34, 52, 38, 500, 500, 500, 84, 26, 84, 340, 500, 500, 500, 22, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628934422683733, "mean_inference_ms": 1.4742284715406933, "mean_action_processing_ms": 0.1743010743617183, "mean_env_wait_ms": 0.10378324651493318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0288846492767334, "StateBufferConnector_ms": 0.0030040740966796875, "ViewRequirementAgentConnector_ms": 0.15384507179260254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4856.486782162292, "num_env_steps_trained_throughput_per_sec": 4856.486782162292, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 4203.664, "sample_time_ms": 3685.871, "load_time_ms": 31.719, "load_throughput": 567484.187, "learn_time_ms": 470.125, "learn_throughput": 38287.695, "synch_weights_time_ms": 14.249}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4726, "training_iteration": 70, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-26", "timestamp": 1698246566, "time_this_iter_s": 3.7113819122314453, "time_total_s": 268.62855315208435, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 268.62855315208435, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 76.6, "ram_util_percent": 31.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.366860866546631, "policy_loss": -0.033295023860409854, "vf_loss": 6.400199437141419, "vf_explained_var": -1.4901161193847656e-06, "kl": 0.0009579593344227533, "entropy": 0.43473687767982483, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.04699999999979042, "episode_len_mean": 275.08, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.500000000000014, 46.699999999999996, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.5, 41.70000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.9, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, 39.70000000000002, 47.5, 47.3, -50.00000000000044, 18.099999999999817, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.90000000000003, 33.90000000000004, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.5, 45.1, -50.00000000000044, 46.9, 42.10000000000001, 47.3, 45.5, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 45.9, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 46.9, 46.5, 34.30000000000004, -50.00000000000044, 40.500000000000014, 46.099999999999994, 41.90000000000001, 35.900000000000034, -50.00000000000044, 43.7, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 30, 500, 500, 500, 500, 38, 76, 34, 52, 38, 500, 500, 500, 84, 26, 84, 340, 500, 500, 500, 22, 500, 500, 500, 500, 500, 32, 26, 500, 470, 500, 32, 500, 36, 42, 500, 500, 48, 100, 104, 26, 28, 500, 320, 500, 254, 500, 500, 44, 62, 500, 500, 96, 500, 500, 34, 500, 500, 122, 162, 230, 500, 500, 500, 26, 36, 50, 500, 32, 80, 28, 46, 500, 32, 34, 500, 42, 64, 500, 500, 96, 140, 500, 32, 36, 158, 500, 96, 40, 82, 142, 500, 64, 30, 500, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628454355722528, "mean_inference_ms": 1.4736185099321435, "mean_action_processing_ms": 0.17408777743520212, "mean_env_wait_ms": 0.10391140294605704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0326533317565918, "StateBufferConnector_ms": 0.006372213363647461, "ViewRequirementAgentConnector_ms": 0.13386130332946777}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.04699999999979042, "episode_len_mean": 275.08, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.500000000000014, 46.699999999999996, 44.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 47.5, 41.70000000000002, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.5, -50.00000000000044, 3.0999999999996035, -50.00000000000044, 46.9, -50.00000000000044, 46.5, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, 39.70000000000002, 47.5, 47.3, -50.00000000000044, 18.099999999999817, -50.00000000000044, 24.69999999999991, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.90000000000003, 33.90000000000004, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.5, 45.1, -50.00000000000044, 46.9, 42.10000000000001, 47.3, 45.5, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 45.9, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 46.9, 46.5, 34.30000000000004, -50.00000000000044, 40.500000000000014, 46.099999999999994, 41.90000000000001, 35.900000000000034, -50.00000000000044, 43.7, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 30, 500, 500, 500, 500, 38, 76, 34, 52, 38, 500, 500, 500, 84, 26, 84, 340, 500, 500, 500, 22, 500, 500, 500, 500, 500, 32, 26, 500, 470, 500, 32, 500, 36, 42, 500, 500, 48, 100, 104, 26, 28, 500, 320, 500, 254, 500, 500, 44, 62, 500, 500, 96, 500, 500, 34, 500, 500, 122, 162, 230, 500, 500, 500, 26, 36, 50, 500, 32, 80, 28, 46, 500, 32, 34, 500, 42, 64, 500, 500, 96, 140, 500, 32, 36, 158, 500, 96, 40, 82, 142, 500, 64, 30, 500, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4628454355722528, "mean_inference_ms": 1.4736185099321435, "mean_action_processing_ms": 0.17408777743520212, "mean_env_wait_ms": 0.10391140294605704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0326533317565918, "StateBufferConnector_ms": 0.006372213363647461, "ViewRequirementAgentConnector_ms": 0.13386130332946777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4531.296250403854, "num_env_steps_trained_throughput_per_sec": 4531.296250403854, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 4141.93, "sample_time_ms": 3647.85, "load_time_ms": 30.322, "load_throughput": 593631.123, "learn_time_ms": 448.678, "learn_throughput": 40117.869, "synch_weights_time_ms": 13.38}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4799, "training_iteration": 71, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-30", "timestamp": 1698246570, "time_this_iter_s": 3.9783706665039062, "time_total_s": 272.60692381858826, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.60692381858826, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 74.62, "ram_util_percent": 31.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.200078177452087, "policy_loss": -0.00875464491546154, "vf_loss": 6.2088741064071655, "vf_explained_var": -4.678964614868164e-07, "kl": 0.00029360413184207344, "entropy": 0.4123181000351906, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1430.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8649999999998028, "episode_len_mean": 266.92, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.90000000000004, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.5, 45.1, -50.00000000000044, 46.9, 42.10000000000001, 47.3, 45.5, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 45.9, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 46.9, 46.5, 34.30000000000004, -50.00000000000044, 40.500000000000014, 46.099999999999994, 41.90000000000001, 35.900000000000034, -50.00000000000044, 43.7, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, 47.7, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 44.5, 46.3, 42.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.7, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.10000000000004, 13.099999999999746, 47.1, 47.3, 19.499999999999837, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 39.10000000000002, 46.099999999999994, -50.00000000000044], "episode_lengths": [162, 230, 500, 500, 500, 26, 36, 50, 500, 32, 80, 28, 46, 500, 32, 34, 500, 42, 64, 500, 500, 96, 140, 500, 32, 36, 158, 500, 96, 40, 82, 142, 500, 64, 30, 500, 500, 500, 30, 500, 34, 500, 500, 500, 500, 348, 500, 24, 500, 36, 500, 64, 56, 38, 72, 80, 500, 500, 42, 40, 106, 500, 38, 500, 54, 40, 54, 500, 500, 98, 56, 140, 500, 500, 500, 500, 48, 140, 370, 30, 28, 306, 500, 154, 500, 500, 500, 500, 44, 500, 500, 36, 500, 500, 158, 500, 500, 110, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4636307322011446, "mean_inference_ms": 1.473609815419075, "mean_action_processing_ms": 0.17392434406773943, "mean_env_wait_ms": 0.10394444923447244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03800606727600098, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.15839147567749023}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8649999999998028, "episode_len_mean": 266.92, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.90000000000004, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 46.5, 45.1, -50.00000000000044, 46.9, 42.10000000000001, 47.3, 45.5, -50.00000000000044, 46.9, 46.699999999999996, -50.00000000000044, 45.9, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 46.9, 46.5, 34.30000000000004, -50.00000000000044, 40.500000000000014, 46.099999999999994, 41.90000000000001, 35.900000000000034, -50.00000000000044, 43.7, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, -50.00000000000044, 47.7, -50.00000000000044, 46.5, -50.00000000000044, 43.7, 44.5, 46.3, 42.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.7, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.10000000000004, 13.099999999999746, 47.1, 47.3, 19.499999999999837, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 39.10000000000002, 46.099999999999994, -50.00000000000044], "episode_lengths": [162, 230, 500, 500, 500, 26, 36, 50, 500, 32, 80, 28, 46, 500, 32, 34, 500, 42, 64, 500, 500, 96, 140, 500, 32, 36, 158, 500, 96, 40, 82, 142, 500, 64, 30, 500, 500, 500, 30, 500, 34, 500, 500, 500, 500, 348, 500, 24, 500, 36, 500, 64, 56, 38, 72, 80, 500, 500, 42, 40, 106, 500, 38, 500, 54, 40, 54, 500, 500, 98, 56, 140, 500, 500, 500, 500, 48, 140, 370, 30, 28, 306, 500, 154, 500, 500, 500, 500, 44, 500, 500, 36, 500, 500, 158, 500, 500, 110, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4636307322011446, "mean_inference_ms": 1.473609815419075, "mean_action_processing_ms": 0.17392434406773943, "mean_env_wait_ms": 0.10394444923447244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03800606727600098, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.15839147567749023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4256.797332167326, "num_env_steps_trained_throughput_per_sec": 4256.797332167326, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 4100.189, "sample_time_ms": 3606.286, "load_time_ms": 28.771, "load_throughput": 625636.302, "learn_time_ms": 449.851, "learn_throughput": 40013.267, "synch_weights_time_ms": 13.581}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4860, "training_iteration": 72, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-35", "timestamp": 1698246575, "time_this_iter_s": 4.244531869888306, "time_total_s": 276.85145568847656, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.85145568847656, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 76.61666666666667, "ram_util_percent": 31.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.259172415733337, "policy_loss": 0.05891704428067897, "vf_loss": 6.200295853614807, "vf_explained_var": -2.2590160369873046e-06, "kl": 0.00012851938869857805, "entropy": 0.4060480803251266, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1450.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.809000000000234, "episode_len_mean": 303.6, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.7, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.10000000000004, 13.099999999999746, 47.1, 47.3, 19.499999999999837, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 39.10000000000002, 46.099999999999994, -50.00000000000044, 12.499999999999737, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.9, 45.7, 28.699999999999967, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, 43.50000000000001, 41.90000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 8.099999999999675, 45.5, 5.299999999999635, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, 47.7, 10.899999999999714, 21.299999999999862, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.30000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, 45.1, 47.3, 45.9, 41.30000000000001], "episode_lengths": [106, 500, 38, 500, 54, 40, 54, 500, 500, 98, 56, 140, 500, 500, 500, 500, 48, 140, 370, 30, 28, 306, 500, 154, 500, 500, 500, 500, 44, 500, 500, 36, 500, 500, 158, 500, 500, 110, 40, 500, 376, 500, 36, 500, 500, 500, 44, 22, 44, 214, 28, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 112, 50, 66, 82, 88, 500, 500, 66, 420, 46, 448, 500, 32, 500, 500, 500, 500, 34, 36, 500, 24, 392, 288, 500, 68, 500, 500, 500, 500, 136, 88, 500, 262, 500, 50, 28, 42, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46465342173778706, "mean_inference_ms": 1.4799594093947395, "mean_action_processing_ms": 0.1753546512255104, "mean_env_wait_ms": 0.10449851119934987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03482174873352051, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.21363401412963867}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.809000000000234, "episode_len_mean": 303.6, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, -50.00000000000044, 46.3, -50.00000000000044, 44.7, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.5, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.10000000000004, 13.099999999999746, 47.1, 47.3, 19.499999999999837, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 39.10000000000002, 46.099999999999994, -50.00000000000044, 12.499999999999737, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.9, 45.7, 28.699999999999967, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.1, 43.50000000000001, 41.90000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 8.099999999999675, 45.5, 5.299999999999635, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, 47.7, 10.899999999999714, 21.299999999999862, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.30000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, 45.1, 47.3, 45.9, 41.30000000000001], "episode_lengths": [106, 500, 38, 500, 54, 40, 54, 500, 500, 98, 56, 140, 500, 500, 500, 500, 48, 140, 370, 30, 28, 306, 500, 154, 500, 500, 500, 500, 44, 500, 500, 36, 500, 500, 158, 500, 500, 110, 40, 500, 376, 500, 36, 500, 500, 500, 44, 22, 44, 214, 28, 500, 500, 500, 500, 500, 500, 100, 500, 500, 500, 500, 112, 50, 66, 82, 88, 500, 500, 66, 420, 46, 448, 500, 32, 500, 500, 500, 500, 34, 36, 500, 24, 392, 288, 500, 68, 500, 500, 500, 500, 136, 88, 500, 262, 500, 50, 28, 42, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46465342173778706, "mean_inference_ms": 1.4799594093947395, "mean_action_processing_ms": 0.1753546512255104, "mean_env_wait_ms": 0.10449851119934987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03482174873352051, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.21363401412963867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 2977.601690671804, "num_env_steps_trained_throughput_per_sec": 2977.601690671804, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 4250.298, "sample_time_ms": 3779.018, "load_time_ms": 27.671, "load_throughput": 650501.566, "learn_time_ms": 427.934, "learn_throughput": 42062.533, "synch_weights_time_ms": 13.775}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 4920, "training_iteration": 73, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-41", "timestamp": 1698246581, "time_this_iter_s": 6.055131435394287, "time_total_s": 282.90658712387085, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 282.90658712387085, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 92.7, "ram_util_percent": 32.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.331829619407654, "policy_loss": 0.02871315311640501, "vf_loss": 6.30315854549408, "vf_explained_var": -7.450580596923828e-07, "kl": 0.0005912290546810084, "entropy": 0.4209907129406929, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1470.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.162999999999817, "episode_len_mean": 253.98, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, 47.7, 10.899999999999714, 21.299999999999862, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.30000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, 45.1, 47.3, 45.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 45.7, 36.50000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 45.1, 32.50000000000002, 46.3, 41.500000000000014, 44.7, 46.099999999999994, 46.5, 44.5, 43.10000000000001, 46.5, 45.3, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 40.500000000000014, 11.499999999999723, -50.00000000000044, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 28.499999999999964, 44.7, 31.500000000000007, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, 39.50000000000002, 39.70000000000002, 46.9, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 22.49999999999988, 3.899999999999615, 47.1, 47.1, 38.700000000000024], "episode_lengths": [500, 32, 500, 500, 500, 500, 34, 36, 500, 24, 392, 288, 500, 68, 500, 500, 500, 500, 136, 88, 500, 262, 500, 50, 28, 42, 88, 500, 500, 28, 44, 136, 102, 500, 500, 82, 102, 500, 500, 500, 72, 48, 500, 24, 500, 500, 50, 176, 38, 86, 54, 40, 36, 56, 70, 36, 48, 38, 500, 58, 500, 242, 500, 46, 96, 386, 500, 44, 36, 500, 500, 216, 54, 186, 26, 500, 500, 500, 42, 116, 48, 500, 500, 106, 104, 32, 52, 500, 70, 46, 500, 500, 500, 500, 46, 276, 462, 30, 30, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46714408239533123, "mean_inference_ms": 1.489990270785455, "mean_action_processing_ms": 0.17613924875292666, "mean_env_wait_ms": 0.10539075867603204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03272366523742676, "StateBufferConnector_ms": 0.0059926509857177734, "ViewRequirementAgentConnector_ms": 0.22316551208496094}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.162999999999817, "episode_len_mean": 253.98, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.5, -50.00000000000044, 47.7, 10.899999999999714, 21.299999999999862, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.30000000000001, -50.00000000000044, 23.8999999999999, -50.00000000000044, 45.1, 47.3, 45.9, 41.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 45.7, 36.50000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 45.1, 32.50000000000002, 46.3, 41.500000000000014, 44.7, 46.099999999999994, 46.5, 44.5, 43.10000000000001, 46.5, 45.3, 46.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.5, 40.500000000000014, 11.499999999999723, -50.00000000000044, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 28.499999999999964, 44.7, 31.500000000000007, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, 39.50000000000002, 39.70000000000002, 46.9, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 22.49999999999988, 3.899999999999615, 47.1, 47.1, 38.700000000000024], "episode_lengths": [500, 32, 500, 500, 500, 500, 34, 36, 500, 24, 392, 288, 500, 68, 500, 500, 500, 500, 136, 88, 500, 262, 500, 50, 28, 42, 88, 500, 500, 28, 44, 136, 102, 500, 500, 82, 102, 500, 500, 500, 72, 48, 500, 24, 500, 500, 50, 176, 38, 86, 54, 40, 36, 56, 70, 36, 48, 38, 500, 58, 500, 242, 500, 46, 96, 386, 500, 44, 36, 500, 500, 216, 54, 186, 26, 500, 500, 500, 42, 116, 48, 500, 500, 106, 104, 32, 52, 500, 70, 46, 500, 500, 500, 500, 46, 276, 462, 30, 30, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46714408239533123, "mean_inference_ms": 1.489990270785455, "mean_action_processing_ms": 0.17613924875292666, "mean_env_wait_ms": 0.10539075867603204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03272366523742676, "StateBufferConnector_ms": 0.0059926509857177734, "ViewRequirementAgentConnector_ms": 0.22316551208496094}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3507.954890928919, "num_env_steps_trained_throughput_per_sec": 3507.954890928919, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 4289.209, "sample_time_ms": 3833.664, "load_time_ms": 27.671, "load_throughput": 650497.083, "learn_time_ms": 411.711, "learn_throughput": 43719.96, "synch_weights_time_ms": 14.245}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 4993, "training_iteration": 74, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-46", "timestamp": 1698246586, "time_this_iter_s": 5.150031089782715, "time_total_s": 288.05661821365356, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 288.05661821365356, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 94.74285714285715, "ram_util_percent": 32.67142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 5.881485223770142, "policy_loss": 0.05922741144895553, "vf_loss": 5.822299122810364, "vf_explained_var": -3.725290298461914e-07, "kl": 0.0004653585372778934, "entropy": 0.4136955991387367, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1490.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.384000000000211, "episode_len_mean": 274.38, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 45.5, 40.500000000000014, 11.499999999999723, -50.00000000000044, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 28.499999999999964, 44.7, 31.500000000000007, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, 39.50000000000002, 39.70000000000002, 46.9, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 22.49999999999988, 3.899999999999615, 47.1, 47.1, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, 47.1, -50.00000000000044, 46.5, 47.3, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 44.5, 44.7, 43.10000000000001, 46.3, 47.1, 44.300000000000004], "episode_lengths": [242, 500, 46, 96, 386, 500, 44, 36, 500, 500, 216, 54, 186, 26, 500, 500, 500, 42, 116, 48, 500, 500, 106, 104, 32, 52, 500, 70, 46, 500, 500, 500, 500, 46, 276, 462, 30, 30, 114, 500, 500, 500, 50, 40, 500, 34, 40, 500, 148, 500, 30, 500, 36, 28, 60, 500, 30, 500, 500, 58, 500, 500, 500, 500, 500, 30, 42, 500, 500, 500, 70, 500, 500, 500, 500, 40, 500, 500, 500, 26, 28, 500, 500, 500, 76, 500, 42, 500, 106, 50, 500, 42, 120, 500, 56, 54, 70, 38, 30, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4693446134690518, "mean_inference_ms": 1.497283941353695, "mean_action_processing_ms": 0.1771718004914351, "mean_env_wait_ms": 0.1061352432964814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025979042053222656, "StateBufferConnector_ms": 0.008870363235473633, "ViewRequirementAgentConnector_ms": 0.21562695503234863}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.384000000000211, "episode_len_mean": 274.38, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.899999999999928, -50.00000000000044, 45.5, 40.500000000000014, 11.499999999999723, -50.00000000000044, 45.7, 46.5, -50.00000000000044, -50.00000000000044, 28.499999999999964, 44.7, 31.500000000000007, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 45.3, -50.00000000000044, -50.00000000000044, 39.50000000000002, 39.70000000000002, 46.9, 44.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 22.49999999999988, 3.899999999999615, 47.1, 47.1, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.099999999999994, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, 47.1, -50.00000000000044, 46.5, 47.3, 44.10000000000001, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 44.5, 44.7, 43.10000000000001, 46.3, 47.1, 44.300000000000004], "episode_lengths": [242, 500, 46, 96, 386, 500, 44, 36, 500, 500, 216, 54, 186, 26, 500, 500, 500, 42, 116, 48, 500, 500, 106, 104, 32, 52, 500, 70, 46, 500, 500, 500, 500, 46, 276, 462, 30, 30, 114, 500, 500, 500, 50, 40, 500, 34, 40, 500, 148, 500, 30, 500, 36, 28, 60, 500, 30, 500, 500, 58, 500, 500, 500, 500, 500, 30, 42, 500, 500, 500, 70, 500, 500, 500, 500, 40, 500, 500, 500, 26, 28, 500, 500, 500, 76, 500, 42, 500, 106, 50, 500, 42, 120, 500, 56, 54, 70, 38, 30, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4693446134690518, "mean_inference_ms": 1.497283941353695, "mean_action_processing_ms": 0.1771718004914351, "mean_env_wait_ms": 0.1061352432964814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025979042053222656, "StateBufferConnector_ms": 0.008870363235473633, "ViewRequirementAgentConnector_ms": 0.21562695503234863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 2933.3030797993943, "num_env_steps_trained_throughput_per_sec": 2933.3030797993943, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 4434.711, "sample_time_ms": 3987.759, "load_time_ms": 27.655, "load_throughput": 650885.726, "learn_time_ms": 403.134, "learn_throughput": 44650.122, "synch_weights_time_ms": 14.345}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5054, "training_iteration": 75, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-52", "timestamp": 1698246592, "time_this_iter_s": 6.1454267501831055, "time_total_s": 294.20204496383667, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 294.20204496383667, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 91.36666666666666, "ram_util_percent": 33.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.534103775024414, "policy_loss": -0.021058803983032705, "vf_loss": 6.5552030324935915, "vf_explained_var": -1.3589859008789063e-06, "kl": 0.0002125664516960557, "entropy": 0.404667991399765, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1510.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6039999999998145, "episode_len_mean": 254.56, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 44.5, 44.7, 43.10000000000001, 46.3, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, -50.00000000000044, 43.50000000000001, 40.10000000000002, 14.699999999999768, 44.5, 44.7, 47.5, 44.5, -50.00000000000044, 8.899999999999686, 38.90000000000002, 46.099999999999994, 41.500000000000014, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 44.300000000000004, 44.10000000000001, 34.900000000000034, -50.00000000000044, 47.3, -50.00000000000044, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.500000000000014, 3.699999999999612, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 39.50000000000002, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 45.9, 36.30000000000003, 45.1, 43.10000000000001, 43.50000000000001, 46.5, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 39.90000000000002, 46.099999999999994, 44.300000000000004, 47.7], "episode_lengths": [500, 500, 500, 26, 28, 500, 500, 500, 76, 500, 42, 500, 106, 50, 500, 42, 120, 500, 56, 54, 70, 38, 30, 58, 500, 500, 500, 500, 34, 174, 500, 66, 100, 354, 56, 54, 26, 56, 500, 412, 112, 40, 86, 500, 124, 500, 40, 500, 50, 54, 500, 58, 60, 152, 500, 28, 500, 64, 78, 500, 500, 500, 274, 500, 500, 108, 76, 464, 500, 500, 120, 500, 36, 34, 500, 106, 42, 24, 500, 500, 42, 138, 50, 70, 66, 36, 500, 404, 500, 38, 500, 500, 500, 500, 30, 500, 102, 40, 58, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47008907344743134, "mean_inference_ms": 1.5052839489371774, "mean_action_processing_ms": 0.17788472169446046, "mean_env_wait_ms": 0.1068062826228344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041015625, "StateBufferConnector_ms": 0.015870094299316406, "ViewRequirementAgentConnector_ms": 0.19504833221435547}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6039999999998145, "episode_len_mean": 254.56, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 39.50000000000002, 45.1, -50.00000000000044, 45.9, 38.10000000000002, -50.00000000000044, 44.5, 44.7, 43.10000000000001, 46.3, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, -50.00000000000044, 43.50000000000001, 40.10000000000002, 14.699999999999768, 44.5, 44.7, 47.5, 44.5, -50.00000000000044, 8.899999999999686, 38.90000000000002, 46.099999999999994, 41.500000000000014, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.1, 44.7, -50.00000000000044, 44.300000000000004, 44.10000000000001, 34.900000000000034, -50.00000000000044, 47.3, -50.00000000000044, 43.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.500000000000014, 3.699999999999612, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 39.50000000000002, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 45.9, 36.30000000000003, 45.1, 43.10000000000001, 43.50000000000001, 46.5, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 39.90000000000002, 46.099999999999994, 44.300000000000004, 47.7], "episode_lengths": [500, 500, 500, 26, 28, 500, 500, 500, 76, 500, 42, 500, 106, 50, 500, 42, 120, 500, 56, 54, 70, 38, 30, 58, 500, 500, 500, 500, 34, 174, 500, 66, 100, 354, 56, 54, 26, 56, 500, 412, 112, 40, 86, 500, 124, 500, 40, 500, 50, 54, 500, 58, 60, 152, 500, 28, 500, 64, 78, 500, 500, 500, 274, 500, 500, 108, 76, 464, 500, 500, 120, 500, 36, 34, 500, 106, 42, 24, 500, 500, 42, 138, 50, 70, 66, 36, 500, 404, 500, 38, 500, 500, 500, 500, 30, 500, 102, 40, 58, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47008907344743134, "mean_inference_ms": 1.5052839489371774, "mean_action_processing_ms": 0.17788472169446046, "mean_env_wait_ms": 0.1068062826228344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041015625, "StateBufferConnector_ms": 0.015870094299316406, "ViewRequirementAgentConnector_ms": 0.19504833221435547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3725.373996897128, "num_env_steps_trained_throughput_per_sec": 3725.373996897128, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 4486.601, "sample_time_ms": 4024.56, "load_time_ms": 27.255, "load_throughput": 660435.955, "learn_time_ms": 418.023, "learn_throughput": 43059.801, "synch_weights_time_ms": 15.045}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5130, "training_iteration": 76, "trial_id": "9f288_00007", "date": "2023-10-25_16-09-57", "timestamp": 1698246597, "time_this_iter_s": 4.837729215621948, "time_total_s": 299.0397741794586, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 299.0397741794586, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 94.75, "ram_util_percent": 32.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.473827981948853, "policy_loss": -0.00031395545229315756, "vf_loss": 6.474182367324829, "vf_explained_var": -1.8417835235595702e-06, "kl": 0.0006965051631539154, "entropy": 0.40478760898113253, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1530.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.902999999999801, "episode_len_mean": 266.54, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.699999999999612, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 39.50000000000002, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 45.9, 36.30000000000003, 45.1, 43.10000000000001, 43.50000000000001, 46.5, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 39.90000000000002, 46.099999999999994, 44.300000000000004, 47.7, -50.00000000000044, 47.1, 41.500000000000014, 19.899999999999842, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.3, 39.10000000000002, -50.00000000000044, 43.10000000000001, 47.1, 43.30000000000001, 46.699999999999996, 45.9, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.50000000000001, 45.1, 42.70000000000001, 27.099999999999945, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 42.30000000000001, 26.499999999999936, 46.5, 46.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 39.50000000000002, 45.9, 40.90000000000002, -50.00000000000044], "episode_lengths": [464, 500, 500, 120, 500, 36, 34, 500, 106, 42, 24, 500, 500, 42, 138, 50, 70, 66, 36, 500, 404, 500, 38, 500, 500, 500, 500, 30, 500, 102, 40, 58, 24, 500, 30, 86, 302, 500, 500, 132, 500, 500, 80, 500, 38, 110, 500, 70, 30, 68, 34, 42, 160, 500, 500, 500, 32, 66, 50, 74, 230, 500, 302, 500, 500, 500, 30, 44, 250, 500, 500, 500, 500, 500, 32, 28, 78, 236, 36, 32, 500, 32, 500, 500, 500, 32, 42, 500, 72, 500, 500, 500, 500, 500, 58, 52, 106, 42, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4724225685699281, "mean_inference_ms": 1.5070773430319797, "mean_action_processing_ms": 0.17831028257883358, "mean_env_wait_ms": 0.10692153143433647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400564193725586, "StateBufferConnector_ms": 0.009997129440307617, "ViewRequirementAgentConnector_ms": 0.18544816970825195}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.902999999999801, "episode_len_mean": 266.54, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.699999999999612, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, 46.699999999999996, -50.00000000000044, 39.50000000000002, 45.9, 47.7, -50.00000000000044, -50.00000000000044, 45.9, 36.30000000000003, 45.1, 43.10000000000001, 43.50000000000001, 46.5, -50.00000000000044, 9.699999999999697, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 39.90000000000002, 46.099999999999994, 44.300000000000004, 47.7, -50.00000000000044, 47.1, 41.500000000000014, 19.899999999999842, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 46.3, 39.10000000000002, -50.00000000000044, 43.10000000000001, 47.1, 43.30000000000001, 46.699999999999996, 45.9, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.50000000000001, 45.1, 42.70000000000001, 27.099999999999945, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 42.30000000000001, 26.499999999999936, 46.5, 46.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 39.50000000000002, 45.9, 40.90000000000002, -50.00000000000044], "episode_lengths": [464, 500, 500, 120, 500, 36, 34, 500, 106, 42, 24, 500, 500, 42, 138, 50, 70, 66, 36, 500, 404, 500, 38, 500, 500, 500, 500, 30, 500, 102, 40, 58, 24, 500, 30, 86, 302, 500, 500, 132, 500, 500, 80, 500, 38, 110, 500, 70, 30, 68, 34, 42, 160, 500, 500, 500, 32, 66, 50, 74, 230, 500, 302, 500, 500, 500, 30, 44, 250, 500, 500, 500, 500, 500, 32, 28, 78, 236, 36, 32, 500, 32, 500, 500, 500, 32, 42, 500, 72, 500, 500, 500, 500, 500, 58, 52, 106, 42, 92, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4724225685699281, "mean_inference_ms": 1.5070773430319797, "mean_action_processing_ms": 0.17831028257883358, "mean_env_wait_ms": 0.10692153143433647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400564193725586, "StateBufferConnector_ms": 0.009997129440307617, "ViewRequirementAgentConnector_ms": 0.18544816970825195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3849.912632103594, "num_env_steps_trained_throughput_per_sec": 3849.912632103594, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 4610.876, "sample_time_ms": 4103.629, "load_time_ms": 30.111, "load_throughput": 597793.806, "learn_time_ms": 459.354, "learn_throughput": 39185.443, "synch_weights_time_ms": 15.964}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5197, "training_iteration": 77, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-02", "timestamp": 1698246602, "time_this_iter_s": 4.683429956436157, "time_total_s": 303.7232041358948, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 303.7232041358948, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 83.97142857142858, "ram_util_percent": 32.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.361332821846008, "policy_loss": -0.012988430797122419, "vf_loss": 6.3743620872497555, "vf_explained_var": -1.5795230865478516e-06, "kl": 0.0004264774870335941, "entropy": 0.40885659754276277, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1550.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8959999999998045, "episode_len_mean": 261.62, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 42.30000000000001, 26.499999999999936, 46.5, 46.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 39.50000000000002, 45.9, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 27.699999999999953, -50.00000000000044, 40.70000000000002, -50.00000000000044, 17.899999999999814, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 19.69999999999984, 13.099999999999746, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 32.100000000000016, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 44.5, 45.5, 45.3, 45.7, 44.10000000000001, 46.699999999999996, 46.099999999999994, -50.00000000000044, 40.500000000000014, 17.099999999999802, 42.500000000000014, 31.900000000000013, 44.900000000000006, 46.5, 47.1, 44.5, 42.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 17.899999999999814, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 47.5, 47.3, -50.00000000000044, 47.1, 46.3], "episode_lengths": [44, 250, 500, 500, 500, 500, 500, 32, 28, 78, 236, 36, 32, 500, 32, 500, 500, 500, 32, 42, 500, 72, 500, 500, 500, 500, 500, 58, 52, 106, 42, 92, 500, 500, 500, 500, 500, 68, 36, 500, 500, 42, 224, 500, 94, 500, 322, 86, 500, 500, 44, 500, 500, 30, 304, 370, 500, 500, 38, 500, 180, 46, 500, 54, 500, 44, 56, 46, 48, 44, 60, 34, 40, 500, 96, 330, 76, 182, 52, 36, 30, 56, 72, 500, 38, 500, 500, 46, 322, 500, 42, 500, 500, 500, 88, 26, 28, 500, 30, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734444997253861, "mean_inference_ms": 1.5090594782977285, "mean_action_processing_ms": 0.17860394030825608, "mean_env_wait_ms": 0.10724867303930744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04096174240112305, "StateBufferConnector_ms": 0.009993553161621094, "ViewRequirementAgentConnector_ms": 0.1844639778137207}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8959999999998045, "episode_len_mean": 261.62, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 47.3, 42.30000000000001, 26.499999999999936, 46.5, 46.9, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.900000000000006, 39.50000000000002, 45.9, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, -50.00000000000044, -50.00000000000044, 45.9, 27.699999999999953, -50.00000000000044, 40.70000000000002, -50.00000000000044, 17.899999999999814, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 19.69999999999984, 13.099999999999746, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 32.100000000000016, 45.5, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 44.5, 45.5, 45.3, 45.7, 44.10000000000001, 46.699999999999996, 46.099999999999994, -50.00000000000044, 40.500000000000014, 17.099999999999802, 42.500000000000014, 31.900000000000013, 44.900000000000006, 46.5, 47.1, 44.5, 42.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 17.899999999999814, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 47.5, 47.3, -50.00000000000044, 47.1, 46.3], "episode_lengths": [44, 250, 500, 500, 500, 500, 500, 32, 28, 78, 236, 36, 32, 500, 32, 500, 500, 500, 32, 42, 500, 72, 500, 500, 500, 500, 500, 58, 52, 106, 42, 92, 500, 500, 500, 500, 500, 68, 36, 500, 500, 42, 224, 500, 94, 500, 322, 86, 500, 500, 44, 500, 500, 30, 304, 370, 500, 500, 38, 500, 180, 46, 500, 54, 500, 44, 56, 46, 48, 44, 60, 34, 40, 500, 96, 330, 76, 182, 52, 36, 30, 56, 72, 500, 38, 500, 500, 46, 322, 500, 42, 500, 500, 500, 88, 26, 28, 500, 30, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734444997253861, "mean_inference_ms": 1.5090594782977285, "mean_action_processing_ms": 0.17860394030825608, "mean_env_wait_ms": 0.10724867303930744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04096174240112305, "StateBufferConnector_ms": 0.009993553161621094, "ViewRequirementAgentConnector_ms": 0.1844639778137207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3888.1285640655265, "num_env_steps_trained_throughput_per_sec": 3888.1285640655265, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 4697.494, "sample_time_ms": 4164.973, "load_time_ms": 31.726, "load_throughput": 567360.939, "learn_time_ms": 481.079, "learn_throughput": 37415.875, "synch_weights_time_ms": 17.497}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5264, "training_iteration": 78, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-07", "timestamp": 1698246607, "time_this_iter_s": 4.636481285095215, "time_total_s": 308.35968542099, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 308.35968542099, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 79.7, "ram_util_percent": 32.95714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.906170344352722, "policy_loss": -0.06089221402071417, "vf_loss": 6.967106437683105, "vf_explained_var": -1.2069940567016602e-06, "kl": 0.00016943932551498618, "entropy": 0.43822408467531204, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1570.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.652999999999851, "episode_len_mean": 219.16, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 17.899999999999814, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 47.5, 47.3, -50.00000000000044, 47.1, 46.3, 33.30000000000003, 43.50000000000001, 41.100000000000016, -50.00000000000044, 20.099999999999845, 39.70000000000002, 46.099999999999994, 37.50000000000003, 42.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 47.9, 42.10000000000001, 45.3, -50.00000000000044, 45.5, 25.099999999999916, 45.7, 3.2999999999996064, 41.30000000000001, 45.9, 30.499999999999993, 24.499999999999908, -50.00000000000044, 40.70000000000002, 36.50000000000003, 46.5, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.3, 46.9, -50.00000000000044, 37.50000000000003, 47.5, 46.099999999999994, 47.1, 41.500000000000014, 47.1, 41.90000000000001, 46.5, 47.7, 46.099999999999994, 44.7, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 4.899999999999629, 33.90000000000004, 45.3, 47.1, 44.900000000000006, 20.899999999999856, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [46, 322, 500, 42, 500, 500, 500, 88, 26, 28, 500, 30, 38, 168, 66, 90, 500, 300, 104, 40, 126, 72, 32, 500, 500, 22, 80, 48, 500, 46, 250, 44, 468, 88, 42, 196, 256, 500, 94, 136, 36, 500, 90, 32, 500, 500, 88, 500, 500, 500, 42, 28, 32, 500, 126, 26, 40, 30, 86, 30, 82, 36, 24, 40, 54, 500, 44, 254, 500, 68, 70, 500, 44, 500, 500, 62, 500, 500, 98, 452, 162, 48, 30, 52, 292, 500, 32, 30, 500, 500, 50, 500, 72, 42, 500, 122, 26, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4732411697673302, "mean_inference_ms": 1.5106499322405775, "mean_action_processing_ms": 0.17961865022490278, "mean_env_wait_ms": 0.10722698262553038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04601693153381348, "StateBufferConnector_ms": 0.012996673583984375, "ViewRequirementAgentConnector_ms": 0.15358400344848633}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.652999999999851, "episode_len_mean": 219.16, "episodes_this_iter": 87, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 17.899999999999814, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 47.5, 47.3, -50.00000000000044, 47.1, 46.3, 33.30000000000003, 43.50000000000001, 41.100000000000016, -50.00000000000044, 20.099999999999845, 39.70000000000002, 46.099999999999994, 37.50000000000003, 42.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 47.9, 42.10000000000001, 45.3, -50.00000000000044, 45.5, 25.099999999999916, 45.7, 3.2999999999996064, 41.30000000000001, 45.9, 30.499999999999993, 24.499999999999908, -50.00000000000044, 40.70000000000002, 36.50000000000003, 46.5, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.3, 46.9, -50.00000000000044, 37.50000000000003, 47.5, 46.099999999999994, 47.1, 41.500000000000014, 47.1, 41.90000000000001, 46.5, 47.7, 46.099999999999994, 44.7, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 4.899999999999629, 33.90000000000004, 45.3, 47.1, 44.900000000000006, 20.899999999999856, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, 44.5, -50.00000000000044], "episode_lengths": [46, 322, 500, 42, 500, 500, 500, 88, 26, 28, 500, 30, 38, 168, 66, 90, 500, 300, 104, 40, 126, 72, 32, 500, 500, 22, 80, 48, 500, 46, 250, 44, 468, 88, 42, 196, 256, 500, 94, 136, 36, 500, 90, 32, 500, 500, 88, 500, 500, 500, 42, 28, 32, 500, 126, 26, 40, 30, 86, 30, 82, 36, 24, 40, 54, 500, 44, 254, 500, 68, 70, 500, 44, 500, 500, 62, 500, 500, 98, 452, 162, 48, 30, 52, 292, 500, 32, 30, 500, 500, 50, 500, 72, 42, 500, 122, 26, 500, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4732411697673302, "mean_inference_ms": 1.5106499322405775, "mean_action_processing_ms": 0.17961865022490278, "mean_env_wait_ms": 0.10722698262553038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04601693153381348, "StateBufferConnector_ms": 0.012996673583984375, "ViewRequirementAgentConnector_ms": 0.15358400344848633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3873.8558465856563, "num_env_steps_trained_throughput_per_sec": 3873.8558465856563, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 4800.121, "sample_time_ms": 4237.953, "load_time_ms": 33.738, "load_throughput": 533522.76, "learn_time_ms": 507.349, "learn_throughput": 35478.54, "synch_weights_time_ms": 18.762}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5351, "training_iteration": 79, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-11", "timestamp": 1698246611, "time_this_iter_s": 4.654203176498413, "time_total_s": 313.0138885974884, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 313.0138885974884, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 85.26666666666667, "ram_util_percent": 32.916666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 5.89981963634491, "policy_loss": 0.004330113716423512, "vf_loss": 5.895530486106873, "vf_explained_var": -1.138448715209961e-06, "kl": 0.00026727347527071287, "entropy": 0.4083690270781517, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1590.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0249999999998014, "episode_len_mean": 265.32, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 47.1, 41.500000000000014, 47.1, 41.90000000000001, 46.5, 47.7, 46.099999999999994, 44.7, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 4.899999999999629, 33.90000000000004, 45.3, 47.1, 44.900000000000006, 20.899999999999856, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, 45.1, 44.7, 29.899999999999984, -50.00000000000044, 17.099999999999802, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, 30.699999999999996, 47.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 47.5, 46.5, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044], "episode_lengths": [40, 30, 86, 30, 82, 36, 24, 40, 54, 500, 44, 254, 500, 68, 70, 500, 44, 500, 500, 62, 500, 500, 98, 452, 162, 48, 30, 52, 292, 500, 32, 30, 500, 500, 50, 500, 72, 42, 500, 122, 26, 500, 56, 500, 140, 50, 54, 202, 500, 330, 500, 58, 500, 500, 282, 194, 24, 70, 500, 500, 500, 46, 26, 500, 500, 32, 500, 500, 500, 500, 26, 500, 500, 500, 500, 38, 500, 500, 30, 70, 500, 500, 274, 500, 26, 36, 46, 36, 500, 500, 56, 500, 144, 500, 28, 36, 500, 500, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4745708051147016, "mean_inference_ms": 1.5132564543247513, "mean_action_processing_ms": 0.17932614805031405, "mean_env_wait_ms": 0.10744925793166996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04798531532287598, "StateBufferConnector_ms": 0.012004375457763672, "ViewRequirementAgentConnector_ms": 0.17525005340576172}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0249999999998014, "episode_len_mean": 265.32, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 47.1, 41.500000000000014, 47.1, 41.90000000000001, 46.5, 47.7, 46.099999999999994, 44.7, -50.00000000000044, 45.7, 24.69999999999991, -50.00000000000044, 43.30000000000001, 43.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 4.899999999999629, 33.90000000000004, 45.3, 47.1, 44.900000000000006, 20.899999999999856, -50.00000000000044, 46.9, 47.1, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 37.90000000000003, 47.5, -50.00000000000044, 44.5, -50.00000000000044, 36.10000000000004, 45.1, 44.7, 29.899999999999984, -50.00000000000044, 17.099999999999802, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 21.89999999999987, 30.699999999999996, 47.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 47.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 47.5, 46.5, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044], "episode_lengths": [40, 30, 86, 30, 82, 36, 24, 40, 54, 500, 44, 254, 500, 68, 70, 500, 44, 500, 500, 62, 500, 500, 98, 452, 162, 48, 30, 52, 292, 500, 32, 30, 500, 500, 50, 500, 72, 42, 500, 122, 26, 500, 56, 500, 140, 50, 54, 202, 500, 330, 500, 58, 500, 500, 282, 194, 24, 70, 500, 500, 500, 46, 26, 500, 500, 32, 500, 500, 500, 500, 26, 500, 500, 500, 500, 38, 500, 500, 30, 70, 500, 500, 274, 500, 26, 36, 46, 36, 500, 500, 56, 500, 144, 500, 28, 36, 500, 500, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4745708051147016, "mean_inference_ms": 1.5132564543247513, "mean_action_processing_ms": 0.17932614805031405, "mean_env_wait_ms": 0.10744925793166996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04798531532287598, "StateBufferConnector_ms": 0.012004375457763672, "ViewRequirementAgentConnector_ms": 0.17525005340576172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3829.3225458127845, "num_env_steps_trained_throughput_per_sec": 3829.3225458127845, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 4899.54, "sample_time_ms": 4308.59, "load_time_ms": 35.726, "load_throughput": 503834.422, "learn_time_ms": 533.342, "learn_throughput": 33749.445, "synch_weights_time_ms": 19.563}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5407, "training_iteration": 80, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-16", "timestamp": 1698246616, "time_this_iter_s": 4.7075746059417725, "time_total_s": 317.7214632034302, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 317.7214632034302, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 80.37142857142858, "ram_util_percent": 32.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.500157165527344, "policy_loss": -0.02309684120118618, "vf_loss": 6.523294830322266, "vf_explained_var": -6.973743438720703e-07, "kl": 0.0003801156128247385, "entropy": 0.40875611901283265, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1610.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.243000000000213, "episode_len_mean": 277.96, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 47.5, 46.5, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 47.1, -50.00000000000044, 47.3, 44.300000000000004, 28.89999999999997, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.699999999999996, 27.699999999999953, 46.3, 6.299999999999649, 46.699999999999996, 47.9, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 44.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.7, 34.10000000000004, 40.90000000000002, 45.7, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 500, 38, 500, 500, 30, 70, 500, 500, 274, 500, 26, 36, 46, 36, 500, 500, 56, 500, 144, 500, 28, 36, 500, 500, 150, 500, 500, 52, 500, 500, 50, 500, 500, 38, 26, 30, 500, 28, 58, 212, 58, 500, 500, 500, 328, 68, 500, 500, 500, 88, 34, 224, 38, 438, 34, 22, 42, 500, 500, 48, 52, 88, 500, 500, 500, 26, 64, 160, 92, 44, 42, 56, 500, 500, 100, 500, 500, 54, 500, 108, 500, 84, 38, 500, 500, 66, 500, 36, 164, 500, 500, 500, 500, 32, 74, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47516696343539794, "mean_inference_ms": 1.5157605284851814, "mean_action_processing_ms": 0.17969449402250384, "mean_env_wait_ms": 0.10793216335335762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041878700256347656, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.19170832633972168}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.243000000000213, "episode_len_mean": 277.96, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, 47.5, 46.5, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 47.1, -50.00000000000044, 47.3, 44.300000000000004, 28.89999999999997, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.699999999999996, 27.699999999999953, 46.3, 6.299999999999649, 46.699999999999996, 47.9, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 44.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.7, 34.10000000000004, 40.90000000000002, 45.7, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.1], "episode_lengths": [500, 500, 500, 38, 500, 500, 30, 70, 500, 500, 274, 500, 26, 36, 46, 36, 500, 500, 56, 500, 144, 500, 28, 36, 500, 500, 150, 500, 500, 52, 500, 500, 50, 500, 500, 38, 26, 30, 500, 28, 58, 212, 58, 500, 500, 500, 328, 68, 500, 500, 500, 88, 34, 224, 38, 438, 34, 22, 42, 500, 500, 48, 52, 88, 500, 500, 500, 26, 64, 160, 92, 44, 42, 56, 500, 500, 100, 500, 500, 54, 500, 108, 500, 84, 38, 500, 500, 66, 500, 36, 164, 500, 500, 500, 500, 32, 74, 500, 500, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47516696343539794, "mean_inference_ms": 1.5157605284851814, "mean_action_processing_ms": 0.17969449402250384, "mean_env_wait_ms": 0.10793216335335762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041878700256347656, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.19170832633972168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3855.305095316291, "num_env_steps_trained_throughput_per_sec": 3855.305095316291, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 4969.192, "sample_time_ms": 4354.824, "load_time_ms": 37.096, "load_throughput": 485229.081, "learn_time_ms": 554.191, "learn_throughput": 32479.805, "synch_weights_time_ms": 20.663}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5479, "training_iteration": 81, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-21", "timestamp": 1698246621, "time_this_iter_s": 4.6758880615234375, "time_total_s": 322.3973512649536, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 322.3973512649536, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 89.26666666666667, "ram_util_percent": 32.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.480319190025329, "policy_loss": 0.013256041606655344, "vf_loss": 6.467100787162781, "vf_explained_var": -4.5299530029296873e-07, "kl": 0.00040722794772136696, "entropy": 0.37626999616622925, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1630.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1119999999998105, "episode_len_mean": 259.46, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.5, -50.00000000000044, 47.7, -50.00000000000044, 31.300000000000004, 42.900000000000006, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.10000000000002, 44.7, 33.90000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.9, 47.3, 46.099999999999994, -50.00000000000044, 47.5, 46.699999999999996, -50.00000000000044, 43.10000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 20.699999999999854, 45.3, 46.699999999999996, 37.90000000000003, 4.899999999999629, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 13.699999999999754, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 38.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 43.900000000000006, 47.7, 45.5, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 35.900000000000034, 43.900000000000006, 47.5], "episode_lengths": [44, 42, 56, 500, 500, 100, 500, 500, 54, 500, 108, 500, 84, 38, 500, 500, 66, 500, 36, 164, 500, 500, 500, 500, 32, 74, 500, 500, 30, 500, 36, 500, 24, 500, 188, 72, 28, 500, 34, 500, 100, 54, 162, 58, 500, 500, 120, 500, 60, 40, 500, 500, 500, 106, 42, 28, 40, 500, 26, 34, 500, 70, 500, 208, 500, 294, 48, 34, 122, 452, 500, 154, 500, 500, 500, 500, 34, 52, 364, 36, 500, 500, 42, 500, 142, 112, 500, 146, 500, 38, 62, 24, 46, 500, 24, 500, 32, 142, 62, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47538441630468803, "mean_inference_ms": 1.5192563469867977, "mean_action_processing_ms": 0.18005828163788867, "mean_env_wait_ms": 0.1080771977078643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04389476776123047, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.16299867630004883}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1119999999998105, "episode_len_mean": 259.46, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 45.9, 44.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.5, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 42.70000000000001, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.5, -50.00000000000044, 47.7, -50.00000000000044, 31.300000000000004, 42.900000000000006, 47.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.10000000000002, 44.7, 33.90000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.9, 47.3, 46.099999999999994, -50.00000000000044, 47.5, 46.699999999999996, -50.00000000000044, 43.10000000000001, -50.00000000000044, 29.299999999999976, -50.00000000000044, 20.699999999999854, 45.3, 46.699999999999996, 37.90000000000003, 4.899999999999629, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 13.699999999999754, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 38.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 43.900000000000006, 47.7, 45.5, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 35.900000000000034, 43.900000000000006, 47.5], "episode_lengths": [44, 42, 56, 500, 500, 100, 500, 500, 54, 500, 108, 500, 84, 38, 500, 500, 66, 500, 36, 164, 500, 500, 500, 500, 32, 74, 500, 500, 30, 500, 36, 500, 24, 500, 188, 72, 28, 500, 34, 500, 100, 54, 162, 58, 500, 500, 120, 500, 60, 40, 500, 500, 500, 106, 42, 28, 40, 500, 26, 34, 500, 70, 500, 208, 500, 294, 48, 34, 122, 452, 500, 154, 500, 500, 500, 500, 34, 52, 364, 36, 500, 500, 42, 500, 142, 112, 500, 146, 500, 38, 62, 24, 46, 500, 24, 500, 32, 142, 62, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47538441630468803, "mean_inference_ms": 1.5192563469867977, "mean_action_processing_ms": 0.18005828163788867, "mean_env_wait_ms": 0.1080771977078643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04389476776123047, "StateBufferConnector_ms": 0.01099538803100586, "ViewRequirementAgentConnector_ms": 0.16299867630004883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3856.1768470249904, "num_env_steps_trained_throughput_per_sec": 3856.1768470249904, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 5013.122, "sample_time_ms": 4399.009, "load_time_ms": 38.805, "load_throughput": 463854.806, "learn_time_ms": 552.458, "learn_throughput": 32581.689, "synch_weights_time_ms": 20.432}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5550, "training_iteration": 82, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-25", "timestamp": 1698246625, "time_this_iter_s": 4.674834966659546, "time_total_s": 327.07218623161316, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 327.07218623161316, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 81.47142857142856, "ram_util_percent": 33.01428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.2975109100341795, "policy_loss": 0.026874450966715813, "vf_loss": 6.270674538612366, "vf_explained_var": -1.7285346984863281e-06, "kl": 0.0006661412366693042, "entropy": 0.38184823244810107, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1650.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.583999999999802, "episode_len_mean": 264.74, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 46.699999999999996, 37.90000000000003, 4.899999999999629, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 13.699999999999754, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 38.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 43.900000000000006, 47.7, 45.5, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 35.900000000000034, 43.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.10000000000001, 47.3, -50.00000000000044, 47.3, 29.69999999999998, 47.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.7, 47.9, 5.299999999999635, 45.7, 37.10000000000003, -50.00000000000044, 44.900000000000006, 44.5, 45.5, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, 17.299999999999805, -50.00000000000044, 27.099999999999945, 45.9, 47.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, 32.90000000000003, -50.00000000000044, 5.099999999999632], "episode_lengths": [48, 34, 122, 452, 500, 154, 500, 500, 500, 500, 34, 52, 364, 36, 500, 500, 42, 500, 142, 112, 500, 146, 500, 38, 62, 24, 46, 500, 24, 500, 32, 142, 62, 26, 500, 500, 500, 36, 80, 28, 500, 28, 204, 30, 34, 500, 500, 500, 500, 114, 500, 500, 64, 22, 448, 44, 130, 500, 52, 56, 46, 500, 44, 500, 34, 34, 38, 500, 500, 500, 500, 30, 500, 500, 64, 500, 24, 58, 500, 328, 500, 230, 42, 24, 36, 500, 500, 500, 120, 500, 28, 500, 26, 500, 500, 34, 48, 172, 500, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4761541262773281, "mean_inference_ms": 1.5204052067920835, "mean_action_processing_ms": 0.1803724927582774, "mean_env_wait_ms": 0.10817298900393756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0415349006652832, "StateBufferConnector_ms": 0.009026050567626953, "ViewRequirementAgentConnector_ms": 0.17898344993591309}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.583999999999802, "episode_len_mean": 264.74, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 46.699999999999996, 37.90000000000003, 4.899999999999629, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 13.699999999999754, 46.5, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 35.900000000000034, 38.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 43.900000000000006, 47.7, 45.5, -50.00000000000044, 47.7, -50.00000000000044, 46.9, 35.900000000000034, 43.900000000000006, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.10000000000001, 47.3, -50.00000000000044, 47.3, 29.69999999999998, 47.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 43.7, 47.9, 5.299999999999635, 45.7, 37.10000000000003, -50.00000000000044, 44.900000000000006, 44.5, 45.5, -50.00000000000044, 45.7, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, 17.299999999999805, -50.00000000000044, 27.099999999999945, 45.9, 47.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, 32.90000000000003, -50.00000000000044, 5.099999999999632], "episode_lengths": [48, 34, 122, 452, 500, 154, 500, 500, 500, 500, 34, 52, 364, 36, 500, 500, 42, 500, 142, 112, 500, 146, 500, 38, 62, 24, 46, 500, 24, 500, 32, 142, 62, 26, 500, 500, 500, 36, 80, 28, 500, 28, 204, 30, 34, 500, 500, 500, 500, 114, 500, 500, 64, 22, 448, 44, 130, 500, 52, 56, 46, 500, 44, 500, 34, 34, 38, 500, 500, 500, 500, 30, 500, 500, 64, 500, 24, 58, 500, 328, 500, 230, 42, 24, 36, 500, 500, 500, 120, 500, 28, 500, 26, 500, 500, 34, 48, 172, 500, 450]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4761541262773281, "mean_inference_ms": 1.5204052067920835, "mean_action_processing_ms": 0.1803724927582774, "mean_env_wait_ms": 0.10817298900393756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0415349006652832, "StateBufferConnector_ms": 0.009026050567626953, "ViewRequirementAgentConnector_ms": 0.17898344993591309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4020.2326179156403, "num_env_steps_trained_throughput_per_sec": 4020.2326179156403, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 4856.344, "sample_time_ms": 4220.234, "load_time_ms": 40.205, "load_throughput": 447701.507, "learn_time_ms": 573.154, "learn_throughput": 31405.17, "synch_weights_time_ms": 20.532}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5616, "training_iteration": 83, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-30", "timestamp": 1698246630, "time_this_iter_s": 4.485350608825684, "time_total_s": 331.55753684043884, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 331.55753684043884, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 85.05000000000001, "ram_util_percent": 33.016666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.417926883697509, "policy_loss": -0.00703838374465704, "vf_loss": 6.425002527236939, "vf_explained_var": -9.47713851928711e-07, "kl": 0.0003850317590490704, "entropy": 0.3712218925356865, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1670.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6140000000002235, "episode_len_mean": 286.68, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, 17.299999999999805, -50.00000000000044, 27.099999999999945, 45.9, 47.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, 32.90000000000003, -50.00000000000044, 5.099999999999632, 26.89999999999994, -50.00000000000044, 47.3, 47.5, 46.699999999999996, 35.30000000000004, 48.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 2.699999999999598, 23.29999999999989, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, 9.699999999999697, 47.3, -50.00000000000044, 27.299999999999947, -50.00000000000044, 47.7, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 47.7, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 29.899999999999984, -50.00000000000044, 47.3, 39.10000000000002, -50.00000000000044, 47.5, 15.299999999999777, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 7.499999999999666, 46.5], "episode_lengths": [500, 500, 500, 500, 30, 500, 500, 64, 500, 24, 58, 500, 328, 500, 230, 42, 24, 36, 500, 500, 500, 120, 500, 28, 500, 26, 500, 500, 34, 48, 172, 500, 450, 232, 500, 28, 26, 34, 148, 20, 96, 500, 500, 40, 500, 500, 90, 500, 500, 36, 500, 66, 474, 268, 40, 26, 500, 500, 404, 28, 500, 228, 500, 24, 54, 50, 500, 500, 40, 500, 58, 24, 500, 500, 38, 26, 202, 500, 28, 110, 500, 26, 348, 500, 500, 42, 500, 48, 500, 38, 500, 500, 30, 500, 500, 500, 500, 22, 426, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4775497388150953, "mean_inference_ms": 1.521562050497029, "mean_action_processing_ms": 0.18038030417494091, "mean_env_wait_ms": 0.10828428693614306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037491798400878906, "StateBufferConnector_ms": 0.01102137565612793, "ViewRequirementAgentConnector_ms": 0.17728447914123535}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6140000000002235, "episode_len_mean": 286.68, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 47.7, 44.300000000000004, -50.00000000000044, 17.299999999999805, -50.00000000000044, 27.099999999999945, 45.9, 47.7, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 47.3, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, 32.90000000000003, -50.00000000000044, 5.099999999999632, 26.89999999999994, -50.00000000000044, 47.3, 47.5, 46.699999999999996, 35.30000000000004, 48.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.50000000000001, 2.699999999999598, 23.29999999999989, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, 9.699999999999697, 47.3, -50.00000000000044, 27.299999999999947, -50.00000000000044, 47.7, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 47.7, -50.00000000000044, -50.00000000000044, 46.3, 47.5, 29.899999999999984, -50.00000000000044, 47.3, 39.10000000000002, -50.00000000000044, 47.5, 15.299999999999777, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 7.499999999999666, 46.5], "episode_lengths": [500, 500, 500, 500, 30, 500, 500, 64, 500, 24, 58, 500, 328, 500, 230, 42, 24, 36, 500, 500, 500, 120, 500, 28, 500, 26, 500, 500, 34, 48, 172, 500, 450, 232, 500, 28, 26, 34, 148, 20, 96, 500, 500, 40, 500, 500, 90, 500, 500, 36, 500, 66, 474, 268, 40, 26, 500, 500, 404, 28, 500, 228, 500, 24, 54, 50, 500, 500, 40, 500, 58, 24, 500, 500, 38, 26, 202, 500, 28, 110, 500, 26, 348, 500, 500, 42, 500, 48, 500, 38, 500, 500, 30, 500, 500, 500, 500, 22, 426, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4775497388150953, "mean_inference_ms": 1.521562050497029, "mean_action_processing_ms": 0.18038030417494091, "mean_env_wait_ms": 0.10828428693614306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037491798400878906, "StateBufferConnector_ms": 0.01102137565612793, "ViewRequirementAgentConnector_ms": 0.17728447914123535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 3980.3785545838887, "num_env_steps_trained_throughput_per_sec": 3980.3785545838887, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 4795.443, "sample_time_ms": 4145.99, "load_time_ms": 40.605, "load_throughput": 443292.334, "learn_time_ms": 586.513, "learn_throughput": 30689.861, "synch_weights_time_ms": 20.232}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5683, "training_iteration": 84, "trial_id": "9f288_00007", "date": "2023-10-25_16-10-34", "timestamp": 1698246634, "time_this_iter_s": 4.529181003570557, "time_total_s": 336.0867178440094, "pid": 26696, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 336.0867178440094, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 88.21666666666665, "ram_util_percent": 33.016666666666666}}
