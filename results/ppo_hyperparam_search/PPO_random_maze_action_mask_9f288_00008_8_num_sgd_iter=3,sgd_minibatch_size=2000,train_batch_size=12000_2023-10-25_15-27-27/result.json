{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.408058696322971, "policy_loss": -0.0026064275039566886, "vf_loss": 9.410039318932427, "vf_explained_var": 0.00026590294308132597, "kl": 0.003498118068052768, "entropy": 0.7365412480301328, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 9.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -30.94166666666702, "episode_len_mean": 434.6666666666667, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.099999999999945, -50.00000000000044], "episode_lengths": [52, 500, 258, 500, 500, 300, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 492, 500, 500, 100, 230, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5135116400894942, "mean_inference_ms": 1.6456854331505284, "mean_action_processing_ms": 0.19305166386779926, "mean_env_wait_ms": 0.12120081510616866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045843919118245445, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.17912586530049643}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -30.94166666666702, "episode_len_mean": 434.6666666666667, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.099999999999945, -50.00000000000044], "episode_lengths": [52, 500, 258, 500, 500, 300, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 492, 500, 500, 100, 230, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5135116400894942, "mean_inference_ms": 1.6456854331505284, "mean_action_processing_ms": 0.19305166386779926, "mean_env_wait_ms": 0.12120081510616866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045843919118245445, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.17912586530049643}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3860.7328233313483, "num_env_steps_trained_throughput_per_sec": 3860.7328233313483, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 3108.218, "sample_time_ms": 2562.544, "load_time_ms": 31.0, "load_throughput": 387101.014, "learn_time_ms": 493.671, "learn_throughput": 24307.678, "synch_weights_time_ms": 20.001}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 24, "training_iteration": 1, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-05", "timestamp": 1698246665, "time_this_iter_s": 3.114218235015869, "time_total_s": 3.114218235015869, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.114218235015869, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 80.88000000000001, "ram_util_percent": 32.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.00195746951633, "policy_loss": -0.0024682036601006985, "vf_loss": 9.004151344299316, "vf_explained_var": -0.00014761090278625488, "kl": 0.0034473029984509493, "entropy": 0.7067345347669389, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 27.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -21.944230769231087, "episode_len_mean": 402.5, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 17.299999999999805, 19.899999999999842, 25.29999999999992, -50.00000000000044, 26.499999999999936, 11.29999999999972, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 30.099999999999987, 32.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 258, 500, 500, 300, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 492, 500, 500, 100, 230, 500, 500, 90, 144, 500, 500, 500, 500, 500, 404, 328, 302, 248, 500, 236, 388, 500, 184, 500, 500, 130, 500, 200, 176, 500, 500, 168, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5151658736443996, "mean_inference_ms": 1.6622935953437394, "mean_action_processing_ms": 0.19416692678079753, "mean_env_wait_ms": 0.12025743704922559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04627704620361328, "StateBufferConnector_ms": 0.003990301719078651, "ViewRequirementAgentConnector_ms": 0.14627667573782113}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -21.944230769231087, "episode_len_mean": 402.5, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 17.299999999999805, 19.899999999999842, 25.29999999999992, -50.00000000000044, 26.499999999999936, 11.29999999999972, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 30.099999999999987, 32.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 258, 500, 500, 300, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 492, 500, 500, 100, 230, 500, 500, 90, 144, 500, 500, 500, 500, 500, 404, 328, 302, 248, 500, 236, 388, 500, 184, 500, 500, 130, 500, 200, 176, 500, 500, 168, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5151658736443996, "mean_inference_ms": 1.6622935953437394, "mean_action_processing_ms": 0.19416692678079753, "mean_env_wait_ms": 0.12025743704922559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04627704620361328, "StateBufferConnector_ms": 0.003990301719078651, "ViewRequirementAgentConnector_ms": 0.14627667573782113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3812.3809474755485, "num_env_steps_trained_throughput_per_sec": 3812.3809474755485, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 3127.929, "sample_time_ms": 2609.036, "load_time_ms": 30.29, "load_throughput": 396165.577, "learn_time_ms": 469.1, "learn_throughput": 25580.874, "synch_weights_time_ms": 19.001}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 52, "training_iteration": 2, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-08", "timestamp": 1698246668, "time_this_iter_s": 3.1546413898468018, "time_total_s": 6.268859624862671, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.268859624862671, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 85.67500000000001, "ram_util_percent": 32.824999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 8.909038331773546, "policy_loss": 0.00018915032140082784, "vf_loss": 8.908908526102701, "vf_explained_var": 3.3371978335910375e-05, "kl": 0.00021161122463632232, "entropy": 0.7031520340177748, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -12.97752808988792, "episode_len_mean": 377.46067415730334, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 17.299999999999805, 19.899999999999842, 25.29999999999992, -50.00000000000044, 26.499999999999936, 11.29999999999972, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 30.099999999999987, 32.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 16.699999999999797, 17.499999999999808, 25.29999999999992, 39.300000000000026, 32.50000000000002, 6.699999999999655, -50.00000000000044, -50.00000000000044, 9.299999999999692, 37.70000000000003, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.900000000000013, -50.00000000000044, 33.500000000000036, 24.69999999999991, -50.00000000000044, 18.099999999999817, 2.499999999999595, 38.50000000000003, 1.6999999999995836, 32.90000000000003, 10.299999999999706, -50.00000000000044, 18.899999999999828, 13.899999999999757, -50.00000000000044, 9.099999999999689, -50.00000000000044], "episode_lengths": [52, 500, 258, 500, 500, 300, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 492, 500, 500, 100, 230, 500, 500, 90, 144, 500, 500, 500, 500, 500, 404, 328, 302, 248, 500, 236, 388, 500, 184, 500, 500, 130, 500, 200, 176, 500, 500, 168, 500, 500, 500, 100, 110, 500, 500, 382, 334, 326, 248, 108, 176, 434, 500, 500, 408, 124, 138, 500, 124, 500, 182, 500, 166, 254, 500, 320, 476, 116, 484, 172, 398, 500, 312, 362, 500, 410, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5164668921806033, "mean_inference_ms": 1.6693008469499981, "mean_action_processing_ms": 0.1952933383386957, "mean_env_wait_ms": 0.12049979284132269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042762381307194744, "StateBufferConnector_ms": 0.006822521766919768, "ViewRequirementAgentConnector_ms": 0.14841074354193184}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -12.97752808988792, "episode_len_mean": 377.46067415730334, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.8999999999995723, -50.00000000000044, -50.00000000000044, 40.10000000000002, 27.099999999999945, -50.00000000000044, -50.00000000000044, 41.100000000000016, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 17.299999999999805, 19.899999999999842, 25.29999999999992, -50.00000000000044, 26.499999999999936, 11.29999999999972, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 30.099999999999987, 32.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 16.699999999999797, 17.499999999999808, 25.29999999999992, 39.300000000000026, 32.50000000000002, 6.699999999999655, -50.00000000000044, -50.00000000000044, 9.299999999999692, 37.70000000000003, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.900000000000013, -50.00000000000044, 33.500000000000036, 24.69999999999991, -50.00000000000044, 18.099999999999817, 2.499999999999595, 38.50000000000003, 1.6999999999995836, 32.90000000000003, 10.299999999999706, -50.00000000000044, 18.899999999999828, 13.899999999999757, -50.00000000000044, 9.099999999999689, -50.00000000000044], "episode_lengths": [52, 500, 258, 500, 500, 300, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 492, 500, 500, 100, 230, 500, 500, 90, 144, 500, 500, 500, 500, 500, 404, 328, 302, 248, 500, 236, 388, 500, 184, 500, 500, 130, 500, 200, 176, 500, 500, 168, 500, 500, 500, 100, 110, 500, 500, 382, 334, 326, 248, 108, 176, 434, 500, 500, 408, 124, 138, 500, 124, 500, 182, 500, 166, 254, 500, 320, 476, 116, 484, 172, 398, 500, 312, 362, 500, 410, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5164668921806033, "mean_inference_ms": 1.6693008469499981, "mean_action_processing_ms": 0.1952933383386957, "mean_env_wait_ms": 0.12049979284132269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042762381307194744, "StateBufferConnector_ms": 0.006822521766919768, "ViewRequirementAgentConnector_ms": 0.14841074354193184}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3842.4202744893023, "num_env_steps_trained_throughput_per_sec": 3842.4202744893023, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3126.296, "sample_time_ms": 2611.368, "load_time_ms": 28.527, "load_throughput": 420657.317, "learn_time_ms": 466.519, "learn_throughput": 25722.44, "synch_weights_time_ms": 18.888}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 89, "training_iteration": 3, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-11", "timestamp": 1698246671, "time_this_iter_s": 3.130599021911621, "time_total_s": 9.399458646774292, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.399458646774292, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.12, "ram_util_percent": 32.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 8.979459974500868, "policy_loss": -0.0017554490930504268, "vf_loss": 8.981210284762913, "vf_explained_var": 2.4540556801689996e-05, "kl": 0.0029072595842920793, "entropy": 0.6757234235604604, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 63.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2859999999997946, "episode_len_mean": 317.8, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.299999999999805, 19.899999999999842, 25.29999999999992, -50.00000000000044, 26.499999999999936, 11.29999999999972, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 30.099999999999987, 32.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 16.699999999999797, 17.499999999999808, 25.29999999999992, 39.300000000000026, 32.50000000000002, 6.699999999999655, -50.00000000000044, -50.00000000000044, 9.299999999999692, 37.70000000000003, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.900000000000013, -50.00000000000044, 33.500000000000036, 24.69999999999991, -50.00000000000044, 18.099999999999817, 2.499999999999595, 38.50000000000003, 1.6999999999995836, 32.90000000000003, 10.299999999999706, -50.00000000000044, 18.899999999999828, 13.899999999999757, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 20.899999999999856, 40.90000000000002, 34.70000000000004, 7.899999999999672, 37.300000000000026, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 12.69999999999974, 39.90000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 26.89999999999994, 36.10000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 35.30000000000004, 37.50000000000003, 38.300000000000026, -50.00000000000044, 39.70000000000002, 41.90000000000001, 3.699999999999612, 13.499999999999751, 26.69999999999994, 22.699999999999882, 36.30000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 30.9, 29.899999999999984, 42.500000000000014, 45.3], "episode_lengths": [328, 302, 248, 500, 236, 388, 500, 184, 500, 500, 130, 500, 200, 176, 500, 500, 168, 500, 500, 500, 100, 110, 500, 500, 382, 334, 326, 248, 108, 176, 434, 500, 500, 408, 124, 138, 500, 124, 500, 182, 500, 166, 254, 500, 320, 476, 116, 484, 172, 398, 500, 312, 362, 500, 410, 500, 500, 500, 324, 292, 92, 154, 422, 128, 500, 48, 50, 500, 374, 102, 120, 500, 500, 230, 500, 232, 140, 160, 500, 500, 500, 204, 148, 126, 118, 500, 104, 82, 464, 366, 234, 274, 138, 500, 112, 500, 192, 202, 76, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5200415316925694, "mean_inference_ms": 1.6820606647849143, "mean_action_processing_ms": 0.19923700634956062, "mean_env_wait_ms": 0.12181011969757442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04802060127258301, "StateBufferConnector_ms": 0.00707554817199707, "ViewRequirementAgentConnector_ms": 0.14603543281555176}}, "episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2859999999997946, "episode_len_mean": 317.8, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.299999999999805, 19.899999999999842, 25.29999999999992, -50.00000000000044, 26.499999999999936, 11.29999999999972, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 30.099999999999987, 32.50000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 11.899999999999729, 16.699999999999797, 17.499999999999808, 25.29999999999992, 39.300000000000026, 32.50000000000002, 6.699999999999655, -50.00000000000044, -50.00000000000044, 9.299999999999692, 37.70000000000003, 36.30000000000003, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.900000000000013, -50.00000000000044, 33.500000000000036, 24.69999999999991, -50.00000000000044, 18.099999999999817, 2.499999999999595, 38.50000000000003, 1.6999999999995836, 32.90000000000003, 10.299999999999706, -50.00000000000044, 18.899999999999828, 13.899999999999757, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 20.899999999999856, 40.90000000000002, 34.70000000000004, 7.899999999999672, 37.300000000000026, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 12.69999999999974, 39.90000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 26.89999999999994, 36.10000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 35.30000000000004, 37.50000000000003, 38.300000000000026, -50.00000000000044, 39.70000000000002, 41.90000000000001, 3.699999999999612, 13.499999999999751, 26.69999999999994, 22.699999999999882, 36.30000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 30.9, 29.899999999999984, 42.500000000000014, 45.3], "episode_lengths": [328, 302, 248, 500, 236, 388, 500, 184, 500, 500, 130, 500, 200, 176, 500, 500, 168, 500, 500, 500, 100, 110, 500, 500, 382, 334, 326, 248, 108, 176, 434, 500, 500, 408, 124, 138, 500, 124, 500, 182, 500, 166, 254, 500, 320, 476, 116, 484, 172, 398, 500, 312, 362, 500, 410, 500, 500, 500, 324, 292, 92, 154, 422, 128, 500, 48, 50, 500, 374, 102, 120, 500, 500, 230, 500, 232, 140, 160, 500, 500, 500, 204, 148, 126, 118, 500, 104, 82, 464, 366, 234, 274, 138, 500, 112, 500, 192, 202, 76, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5200415316925694, "mean_inference_ms": 1.6820606647849143, "mean_action_processing_ms": 0.19923700634956062, "mean_env_wait_ms": 0.12181011969757442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04802060127258301, "StateBufferConnector_ms": 0.00707554817199707, "ViewRequirementAgentConnector_ms": 0.14603543281555176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3413.3164352688414, "num_env_steps_trained_throughput_per_sec": 3413.3164352688414, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 3223.633, "sample_time_ms": 2629.56, "load_time_ms": 28.895, "load_throughput": 415297.326, "learn_time_ms": 513.009, "learn_throughput": 23391.418, "synch_weights_time_ms": 50.922}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 133, "training_iteration": 4, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-15", "timestamp": 1698246675, "time_this_iter_s": 3.521641969680786, "time_total_s": 12.921100616455078, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.921100616455078, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 78.24, "ram_util_percent": 32.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.855460696750217, "policy_loss": 0.00017522254751788246, "vf_loss": 8.855340586768257, "vf_explained_var": 2.9702981313069663e-06, "kl": 0.0005718436326434232, "entropy": 0.6197991851303313, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 81.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.979999999999819, "episode_len_mean": 290.88, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.499999999999595, 38.50000000000003, 1.6999999999995836, 32.90000000000003, 10.299999999999706, -50.00000000000044, 18.899999999999828, 13.899999999999757, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 20.899999999999856, 40.90000000000002, 34.70000000000004, 7.899999999999672, 37.300000000000026, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 12.69999999999974, 39.90000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 26.89999999999994, 36.10000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 35.30000000000004, 37.50000000000003, 38.300000000000026, -50.00000000000044, 39.70000000000002, 41.90000000000001, 3.699999999999612, 13.499999999999751, 26.69999999999994, 22.699999999999882, 36.30000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 30.9, 29.899999999999984, 42.500000000000014, 45.3, -50.00000000000044, 36.70000000000003, 19.09999999999983, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 13.499999999999751, -50.00000000000044, 44.900000000000006, 34.900000000000034, 43.10000000000001, 32.100000000000016, 44.7, 39.10000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 41.500000000000014, -50.00000000000044, 41.30000000000001, 43.50000000000001, 35.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.299999999999834, 11.499999999999723, 33.500000000000036, 37.50000000000003, 43.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 34.900000000000034, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 34.10000000000004], "episode_lengths": [476, 116, 484, 172, 398, 500, 312, 362, 500, 410, 500, 500, 500, 324, 292, 92, 154, 422, 128, 500, 48, 50, 500, 374, 102, 120, 500, 500, 230, 500, 232, 140, 160, 500, 500, 500, 204, 148, 126, 118, 500, 104, 82, 464, 366, 234, 274, 138, 500, 112, 500, 192, 202, 76, 48, 500, 134, 310, 500, 184, 500, 120, 500, 366, 500, 52, 152, 70, 180, 54, 110, 104, 500, 500, 500, 86, 86, 500, 88, 66, 150, 500, 62, 500, 308, 386, 166, 126, 64, 240, 500, 500, 500, 222, 152, 270, 500, 134, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236179097374395, "mean_inference_ms": 1.6915863433358624, "mean_action_processing_ms": 0.2015876311732292, "mean_env_wait_ms": 0.12379882679606403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050986289978027344, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.16705775260925293}}, "episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.979999999999819, "episode_len_mean": 290.88, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.499999999999595, 38.50000000000003, 1.6999999999995836, 32.90000000000003, 10.299999999999706, -50.00000000000044, 18.899999999999828, 13.899999999999757, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 20.899999999999856, 40.90000000000002, 34.70000000000004, 7.899999999999672, 37.300000000000026, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 12.69999999999974, 39.90000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.099999999999945, -50.00000000000044, 26.89999999999994, 36.10000000000004, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 35.30000000000004, 37.50000000000003, 38.300000000000026, -50.00000000000044, 39.70000000000002, 41.90000000000001, 3.699999999999612, 13.499999999999751, 26.69999999999994, 22.699999999999882, 36.30000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 30.9, 29.899999999999984, 42.500000000000014, 45.3, -50.00000000000044, 36.70000000000003, 19.09999999999983, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 13.499999999999751, -50.00000000000044, 44.900000000000006, 34.900000000000034, 43.10000000000001, 32.100000000000016, 44.7, 39.10000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 41.500000000000014, -50.00000000000044, 41.30000000000001, 43.50000000000001, 35.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.299999999999834, 11.499999999999723, 33.500000000000036, 37.50000000000003, 43.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 34.900000000000034, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 34.10000000000004], "episode_lengths": [476, 116, 484, 172, 398, 500, 312, 362, 500, 410, 500, 500, 500, 324, 292, 92, 154, 422, 128, 500, 48, 50, 500, 374, 102, 120, 500, 500, 230, 500, 232, 140, 160, 500, 500, 500, 204, 148, 126, 118, 500, 104, 82, 464, 366, 234, 274, 138, 500, 112, 500, 192, 202, 76, 48, 500, 134, 310, 500, 184, 500, 120, 500, 366, 500, 52, 152, 70, 180, 54, 110, 104, 500, 500, 500, 86, 86, 500, 88, 66, 150, 500, 62, 500, 308, 386, 166, 126, 64, 240, 500, 500, 500, 222, 152, 270, 500, 134, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236179097374395, "mean_inference_ms": 1.6915863433358624, "mean_action_processing_ms": 0.2015876311732292, "mean_env_wait_ms": 0.12379882679606403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050986289978027344, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.16705775260925293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3746.4638833874815, "num_env_steps_trained_throughput_per_sec": 3746.4638833874815, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 3219.51, "sample_time_ms": 2646.792, "load_time_ms": 28.516, "load_throughput": 420821.214, "learn_time_ms": 498.667, "learn_throughput": 24064.176, "synch_weights_time_ms": 44.339}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 178, "training_iteration": 5, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-18", "timestamp": 1698246678, "time_this_iter_s": 3.210017681121826, "time_total_s": 16.131118297576904, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.131118297576904, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 88.44999999999999, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.859113640255398, "policy_loss": -0.00024208923180898032, "vf_loss": 8.859420458475748, "vf_explained_var": -6.589624616834852e-07, "kl": 0.0002731658111656543, "entropy": 0.6644680599371592, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 99.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.62699999999985, "episode_len_mean": 269.46, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 3.699999999999612, 13.499999999999751, 26.69999999999994, 22.699999999999882, 36.30000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 30.9, 29.899999999999984, 42.500000000000014, 45.3, -50.00000000000044, 36.70000000000003, 19.09999999999983, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 13.499999999999751, -50.00000000000044, 44.900000000000006, 34.900000000000034, 43.10000000000001, 32.100000000000016, 44.7, 39.10000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 41.500000000000014, -50.00000000000044, 41.30000000000001, 43.50000000000001, 35.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.299999999999834, 11.499999999999723, 33.500000000000036, 37.50000000000003, 43.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 34.900000000000034, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 34.10000000000004, 5.499999999999638, 29.899999999999984, 32.30000000000002, 35.10000000000004, 27.49999999999995, 27.299999999999947, 24.499999999999908, -50.00000000000044, 21.499999999999865, -50.00000000000044, 24.299999999999905, 31.500000000000007, -50.00000000000044, 36.10000000000004, 37.90000000000003, 0.2999999999995637, -50.00000000000044, 26.299999999999933, 18.29999999999982, 34.10000000000004, 41.90000000000001, 43.30000000000001, 33.70000000000004, -50.00000000000044, 43.30000000000001, 13.499999999999751, 23.8999999999999, 33.10000000000003, 8.49999999999968, 41.30000000000001, 35.500000000000036, 42.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, 36.70000000000003, -50.00000000000044, 40.90000000000002, 33.70000000000004], "episode_lengths": [82, 464, 366, 234, 274, 138, 500, 112, 500, 192, 202, 76, 48, 500, 134, 310, 500, 184, 500, 120, 500, 366, 500, 52, 152, 70, 180, 54, 110, 104, 500, 500, 500, 86, 86, 500, 88, 66, 150, 500, 62, 500, 308, 386, 166, 126, 64, 240, 500, 500, 500, 222, 152, 270, 500, 134, 500, 160, 446, 202, 178, 150, 226, 228, 256, 500, 286, 500, 258, 186, 500, 140, 122, 498, 500, 238, 318, 160, 82, 68, 164, 500, 68, 366, 262, 170, 416, 88, 146, 72, 228, 500, 500, 500, 176, 68, 134, 500, 92, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258450082052262, "mean_inference_ms": 1.694578744811123, "mean_action_processing_ms": 0.2020175796417267, "mean_env_wait_ms": 0.12474556103940826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04300498962402344, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.17103266716003418}}, "episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.62699999999985, "episode_len_mean": 269.46, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 3.699999999999612, 13.499999999999751, 26.69999999999994, 22.699999999999882, 36.30000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 30.9, 29.899999999999984, 42.500000000000014, 45.3, -50.00000000000044, 36.70000000000003, 19.09999999999983, -50.00000000000044, 31.70000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 13.499999999999751, -50.00000000000044, 44.900000000000006, 34.900000000000034, 43.10000000000001, 32.100000000000016, 44.7, 39.10000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 41.500000000000014, -50.00000000000044, 41.30000000000001, 43.50000000000001, 35.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 19.299999999999834, 11.499999999999723, 33.500000000000036, 37.50000000000003, 43.7, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 34.900000000000034, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 34.10000000000004, 5.499999999999638, 29.899999999999984, 32.30000000000002, 35.10000000000004, 27.49999999999995, 27.299999999999947, 24.499999999999908, -50.00000000000044, 21.499999999999865, -50.00000000000044, 24.299999999999905, 31.500000000000007, -50.00000000000044, 36.10000000000004, 37.90000000000003, 0.2999999999995637, -50.00000000000044, 26.299999999999933, 18.29999999999982, 34.10000000000004, 41.90000000000001, 43.30000000000001, 33.70000000000004, -50.00000000000044, 43.30000000000001, 13.499999999999751, 23.8999999999999, 33.10000000000003, 8.49999999999968, 41.30000000000001, 35.500000000000036, 42.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, 36.70000000000003, -50.00000000000044, 40.90000000000002, 33.70000000000004], "episode_lengths": [82, 464, 366, 234, 274, 138, 500, 112, 500, 192, 202, 76, 48, 500, 134, 310, 500, 184, 500, 120, 500, 366, 500, 52, 152, 70, 180, 54, 110, 104, 500, 500, 500, 86, 86, 500, 88, 66, 150, 500, 62, 500, 308, 386, 166, 126, 64, 240, 500, 500, 500, 222, 152, 270, 500, 134, 500, 160, 446, 202, 178, 150, 226, 228, 256, 500, 286, 500, 258, 186, 500, 140, 122, 498, 500, 238, 318, 160, 82, 68, 164, 500, 68, 366, 262, 170, 416, 88, 146, 72, 228, 500, 500, 500, 176, 68, 134, 500, 92, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258450082052262, "mean_inference_ms": 1.694578744811123, "mean_action_processing_ms": 0.2020175796417267, "mean_env_wait_ms": 0.12474556103940826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04300498962402344, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.17103266716003418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3871.714073931394, "num_env_steps_trained_throughput_per_sec": 3871.714073931394, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3199.492, "sample_time_ms": 2637.684, "load_time_ms": 28.597, "load_throughput": 419629.724, "learn_time_ms": 490.895, "learn_throughput": 24445.158, "synch_weights_time_ms": 40.987}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 220, "training_iteration": 6, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-21", "timestamp": 1698246681, "time_this_iter_s": 3.1054015159606934, "time_total_s": 19.236519813537598, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.236519813537598, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 76.34, "ram_util_percent": 32.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.451704502105713, "policy_loss": -0.0005892537592444569, "vf_loss": 8.452354855007595, "vf_explained_var": 1.1189116372002496e-05, "kl": 0.001150980054565783, "entropy": 0.6439760294225481, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 117.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.221999999999849, "episode_len_mean": 268.5, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 34.900000000000034, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 34.10000000000004, 5.499999999999638, 29.899999999999984, 32.30000000000002, 35.10000000000004, 27.49999999999995, 27.299999999999947, 24.499999999999908, -50.00000000000044, 21.499999999999865, -50.00000000000044, 24.299999999999905, 31.500000000000007, -50.00000000000044, 36.10000000000004, 37.90000000000003, 0.2999999999995637, -50.00000000000044, 26.299999999999933, 18.29999999999982, 34.10000000000004, 41.90000000000001, 43.30000000000001, 33.70000000000004, -50.00000000000044, 43.30000000000001, 13.499999999999751, 23.8999999999999, 33.10000000000003, 8.49999999999968, 41.30000000000001, 35.500000000000036, 42.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, 36.70000000000003, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, 29.099999999999973, 37.300000000000026, 29.299999999999976, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 44.5, 22.49999999999988, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.300000000000026, 42.500000000000014, 25.899999999999928, -50.00000000000044, 9.099999999999689, 34.50000000000004, 34.50000000000004, 44.5, 42.30000000000001, 41.70000000000002, 3.699999999999612, 41.30000000000001, -50.00000000000044, 35.30000000000004, 44.10000000000001, 37.300000000000026, 43.10000000000001, 20.699999999999854, 37.10000000000003, 38.300000000000026, 21.499999999999865, 42.900000000000006, 39.90000000000002, 44.900000000000006, 41.90000000000001, 41.70000000000002, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 222, 152, 270, 500, 134, 500, 160, 446, 202, 178, 150, 226, 228, 256, 500, 286, 500, 258, 186, 500, 140, 122, 498, 500, 238, 318, 160, 82, 68, 164, 500, 68, 366, 262, 170, 416, 88, 146, 72, 228, 500, 500, 500, 176, 68, 134, 500, 92, 164, 500, 500, 210, 128, 208, 500, 500, 78, 500, 500, 166, 500, 56, 276, 180, 500, 500, 84, 118, 76, 242, 500, 410, 156, 156, 56, 78, 84, 464, 88, 500, 148, 60, 128, 70, 294, 130, 118, 286, 72, 102, 52, 82, 84, 316, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5285254422565192, "mean_inference_ms": 1.698852194300743, "mean_action_processing_ms": 0.20168963497431797, "mean_env_wait_ms": 0.12465871551016466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600192070007324, "StateBufferConnector_ms": 0.008999109268188477, "ViewRequirementAgentConnector_ms": 0.16302776336669922}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.221999999999849, "episode_len_mean": 268.5, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 34.900000000000034, 23.099999999999888, -50.00000000000044, 36.70000000000003, -50.00000000000044, 34.10000000000004, 5.499999999999638, 29.899999999999984, 32.30000000000002, 35.10000000000004, 27.49999999999995, 27.299999999999947, 24.499999999999908, -50.00000000000044, 21.499999999999865, -50.00000000000044, 24.299999999999905, 31.500000000000007, -50.00000000000044, 36.10000000000004, 37.90000000000003, 0.2999999999995637, -50.00000000000044, 26.299999999999933, 18.29999999999982, 34.10000000000004, 41.90000000000001, 43.30000000000001, 33.70000000000004, -50.00000000000044, 43.30000000000001, 13.499999999999751, 23.8999999999999, 33.10000000000003, 8.49999999999968, 41.30000000000001, 35.500000000000036, 42.900000000000006, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, 36.70000000000003, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, 29.099999999999973, 37.300000000000026, 29.299999999999976, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 44.5, 22.49999999999988, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.300000000000026, 42.500000000000014, 25.899999999999928, -50.00000000000044, 9.099999999999689, 34.50000000000004, 34.50000000000004, 44.5, 42.30000000000001, 41.70000000000002, 3.699999999999612, 41.30000000000001, -50.00000000000044, 35.30000000000004, 44.10000000000001, 37.300000000000026, 43.10000000000001, 20.699999999999854, 37.10000000000003, 38.300000000000026, 21.499999999999865, 42.900000000000006, 39.90000000000002, 44.900000000000006, 41.90000000000001, 41.70000000000002, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 222, 152, 270, 500, 134, 500, 160, 446, 202, 178, 150, 226, 228, 256, 500, 286, 500, 258, 186, 500, 140, 122, 498, 500, 238, 318, 160, 82, 68, 164, 500, 68, 366, 262, 170, 416, 88, 146, 72, 228, 500, 500, 500, 176, 68, 134, 500, 92, 164, 500, 500, 210, 128, 208, 500, 500, 78, 500, 500, 166, 500, 56, 276, 180, 500, 500, 84, 118, 76, 242, 500, 410, 156, 156, 56, 78, 84, 464, 88, 500, 148, 60, 128, 70, 294, 130, 118, 286, 72, 102, 52, 82, 84, 316, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5285254422565192, "mean_inference_ms": 1.698852194300743, "mean_action_processing_ms": 0.20168963497431797, "mean_env_wait_ms": 0.12465871551016466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600192070007324, "StateBufferConnector_ms": 0.008999109268188477, "ViewRequirementAgentConnector_ms": 0.16302776336669922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3647.9623575661576, "num_env_steps_trained_throughput_per_sec": 3647.9623575661576, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 3212.352, "sample_time_ms": 2654.787, "load_time_ms": 28.735, "load_throughput": 417615.76, "learn_time_ms": 490.128, "learn_throughput": 24483.385, "synch_weights_time_ms": 37.419}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 268, "training_iteration": 7, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-25", "timestamp": 1698246685, "time_this_iter_s": 3.6001148223876953, "time_total_s": 22.836634635925293, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.836634635925293, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 78.70000000000002, "ram_util_percent": 32.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.329452011320326, "policy_loss": -0.00032630728350745305, "vf_loss": 8.32983954747518, "vf_explained_var": -4.036558998955621e-06, "kl": 0.00027519457598322735, "entropy": 0.6146035393079122, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.830999999999865, "episode_len_mean": 247.42, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.50000000000002, 43.30000000000001, 36.70000000000003, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, 29.099999999999973, 37.300000000000026, 29.299999999999976, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 44.5, 22.49999999999988, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.300000000000026, 42.500000000000014, 25.899999999999928, -50.00000000000044, 9.099999999999689, 34.50000000000004, 34.50000000000004, 44.5, 42.30000000000001, 41.70000000000002, 3.699999999999612, 41.30000000000001, -50.00000000000044, 35.30000000000004, 44.10000000000001, 37.300000000000026, 43.10000000000001, 20.699999999999854, 37.10000000000003, 38.300000000000026, 21.499999999999865, 42.900000000000006, 39.90000000000002, 44.900000000000006, 41.90000000000001, 41.70000000000002, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.50000000000001, 36.70000000000003, -50.00000000000044, 39.50000000000002, 36.900000000000034, 32.50000000000002, 41.500000000000014, -50.00000000000044, 35.70000000000003, 39.90000000000002, -50.00000000000044, 9.699999999999697, -50.00000000000044, 35.500000000000036, 21.09999999999986, -50.00000000000044, 23.099999999999888, 42.30000000000001, 20.899999999999856, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 27.699999999999953, 43.50000000000001, -50.00000000000044, 27.099999999999945, 39.50000000000002, 41.500000000000014, -50.00000000000044, 14.899999999999771, 37.70000000000003, 37.50000000000003, 42.70000000000001, 27.299999999999947, 45.1, 31.70000000000001, 37.50000000000003, 16.8999999999998, -50.00000000000044, 41.500000000000014, 33.500000000000036, -50.00000000000044, 41.30000000000001], "episode_lengths": [176, 68, 134, 500, 92, 164, 500, 500, 210, 128, 208, 500, 500, 78, 500, 500, 166, 500, 56, 276, 180, 500, 500, 84, 118, 76, 242, 500, 410, 156, 156, 56, 78, 84, 464, 88, 500, 148, 60, 128, 70, 294, 130, 118, 286, 72, 102, 52, 82, 84, 316, 500, 500, 500, 500, 168, 66, 134, 500, 106, 132, 176, 86, 500, 144, 102, 500, 404, 500, 146, 290, 500, 270, 78, 292, 500, 36, 500, 74, 224, 66, 500, 230, 106, 86, 500, 352, 124, 126, 74, 228, 50, 184, 126, 332, 500, 86, 166, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5293326291096906, "mean_inference_ms": 1.699492791454407, "mean_action_processing_ms": 0.20161088698351343, "mean_env_wait_ms": 0.12433125765287992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700733184814453, "StateBufferConnector_ms": 0.016012191772460938, "ViewRequirementAgentConnector_ms": 0.1669483184814453}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.830999999999865, "episode_len_mean": 247.42, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.50000000000002, 43.30000000000001, 36.70000000000003, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, 29.099999999999973, 37.300000000000026, 29.299999999999976, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 33.500000000000036, -50.00000000000044, 44.5, 22.49999999999988, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.70000000000002, 38.300000000000026, 42.500000000000014, 25.899999999999928, -50.00000000000044, 9.099999999999689, 34.50000000000004, 34.50000000000004, 44.5, 42.30000000000001, 41.70000000000002, 3.699999999999612, 41.30000000000001, -50.00000000000044, 35.30000000000004, 44.10000000000001, 37.300000000000026, 43.10000000000001, 20.699999999999854, 37.10000000000003, 38.300000000000026, 21.499999999999865, 42.900000000000006, 39.90000000000002, 44.900000000000006, 41.90000000000001, 41.70000000000002, 18.499999999999822, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.50000000000001, 36.70000000000003, -50.00000000000044, 39.50000000000002, 36.900000000000034, 32.50000000000002, 41.500000000000014, -50.00000000000044, 35.70000000000003, 39.90000000000002, -50.00000000000044, 9.699999999999697, -50.00000000000044, 35.500000000000036, 21.09999999999986, -50.00000000000044, 23.099999999999888, 42.30000000000001, 20.899999999999856, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 27.699999999999953, 43.50000000000001, -50.00000000000044, 27.099999999999945, 39.50000000000002, 41.500000000000014, -50.00000000000044, 14.899999999999771, 37.70000000000003, 37.50000000000003, 42.70000000000001, 27.299999999999947, 45.1, 31.70000000000001, 37.50000000000003, 16.8999999999998, -50.00000000000044, 41.500000000000014, 33.500000000000036, -50.00000000000044, 41.30000000000001], "episode_lengths": [176, 68, 134, 500, 92, 164, 500, 500, 210, 128, 208, 500, 500, 78, 500, 500, 166, 500, 56, 276, 180, 500, 500, 84, 118, 76, 242, 500, 410, 156, 156, 56, 78, 84, 464, 88, 500, 148, 60, 128, 70, 294, 130, 118, 286, 72, 102, 52, 82, 84, 316, 500, 500, 500, 500, 168, 66, 134, 500, 106, 132, 176, 86, 500, 144, 102, 500, 404, 500, 146, 290, 500, 270, 78, 292, 500, 36, 500, 74, 224, 66, 500, 230, 106, 86, 500, 352, 124, 126, 74, 228, 50, 184, 126, 332, 500, 86, 166, 500, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5293326291096906, "mean_inference_ms": 1.699492791454407, "mean_action_processing_ms": 0.20161088698351343, "mean_env_wait_ms": 0.12433125765287992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700733184814453, "StateBufferConnector_ms": 0.016012191772460938, "ViewRequirementAgentConnector_ms": 0.1669483184814453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3884.717583023761, "num_env_steps_trained_throughput_per_sec": 3884.717583023761, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 3196.811, "sample_time_ms": 2641.814, "load_time_ms": 28.768, "load_throughput": 417133.126, "learn_time_ms": 489.801, "learn_throughput": 24499.739, "synch_weights_time_ms": 35.181}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 314, "training_iteration": 8, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-28", "timestamp": 1698246688, "time_this_iter_s": 3.09502911567688, "time_total_s": 25.931663751602173, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.931663751602173, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 84.65, "ram_util_percent": 32.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 8.019727150599161, "policy_loss": -0.00034651325808631047, "vf_loss": 8.02013365427653, "vf_explained_var": 2.3179584079318576e-07, "kl": 0.00042480594662524455, "entropy": 0.6027589009867774, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 153.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.173999999999857, "episode_len_mean": 248.96, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.50000000000001, 36.70000000000003, -50.00000000000044, 39.50000000000002, 36.900000000000034, 32.50000000000002, 41.500000000000014, -50.00000000000044, 35.70000000000003, 39.90000000000002, -50.00000000000044, 9.699999999999697, -50.00000000000044, 35.500000000000036, 21.09999999999986, -50.00000000000044, 23.099999999999888, 42.30000000000001, 20.899999999999856, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 27.699999999999953, 43.50000000000001, -50.00000000000044, 27.099999999999945, 39.50000000000002, 41.500000000000014, -50.00000000000044, 14.899999999999771, 37.70000000000003, 37.50000000000003, 42.70000000000001, 27.299999999999947, 45.1, 31.70000000000001, 37.50000000000003, 16.8999999999998, -50.00000000000044, 41.500000000000014, 33.500000000000036, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 35.900000000000034, 41.70000000000002, 42.500000000000014, -50.00000000000044, 12.69999999999974, 41.100000000000016, 37.70000000000003, 45.9, 41.500000000000014, 25.499999999999922, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.10000000000002, 41.90000000000001, 40.90000000000002, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.50000000000002, 14.499999999999766, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, 38.50000000000003, 28.09999999999996, 14.899999999999771, 40.90000000000002, 45.9, -50.00000000000044, 36.50000000000003, 42.10000000000001, 42.30000000000001, 46.099999999999994, -50.00000000000044, 31.70000000000001, -50.00000000000044, 31.1], "episode_lengths": [500, 500, 500, 500, 168, 66, 134, 500, 106, 132, 176, 86, 500, 144, 102, 500, 404, 500, 146, 290, 500, 270, 78, 292, 500, 36, 500, 74, 224, 66, 500, 230, 106, 86, 500, 352, 124, 126, 74, 228, 50, 184, 126, 332, 500, 86, 166, 500, 88, 500, 56, 34, 500, 184, 500, 142, 84, 76, 500, 374, 90, 124, 42, 86, 246, 500, 500, 142, 110, 82, 92, 42, 500, 48, 500, 168, 500, 106, 356, 500, 42, 70, 500, 500, 150, 68, 116, 220, 352, 92, 42, 500, 136, 80, 78, 40, 500, 184, 500, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5297413593927659, "mean_inference_ms": 1.698500996671459, "mean_action_processing_ms": 0.20158934228746578, "mean_env_wait_ms": 0.12377983579433112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04199671745300293, "StateBufferConnector_ms": 0.011959075927734375, "ViewRequirementAgentConnector_ms": 0.1780223846435547}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.173999999999857, "episode_len_mean": 248.96, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.50000000000001, 36.70000000000003, -50.00000000000044, 39.50000000000002, 36.900000000000034, 32.50000000000002, 41.500000000000014, -50.00000000000044, 35.70000000000003, 39.90000000000002, -50.00000000000044, 9.699999999999697, -50.00000000000044, 35.500000000000036, 21.09999999999986, -50.00000000000044, 23.099999999999888, 42.30000000000001, 20.899999999999856, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 27.699999999999953, 43.50000000000001, -50.00000000000044, 27.099999999999945, 39.50000000000002, 41.500000000000014, -50.00000000000044, 14.899999999999771, 37.70000000000003, 37.50000000000003, 42.70000000000001, 27.299999999999947, 45.1, 31.70000000000001, 37.50000000000003, 16.8999999999998, -50.00000000000044, 41.500000000000014, 33.500000000000036, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.5, 46.699999999999996, -50.00000000000044, 31.70000000000001, -50.00000000000044, 35.900000000000034, 41.70000000000002, 42.500000000000014, -50.00000000000044, 12.69999999999974, 41.100000000000016, 37.70000000000003, 45.9, 41.500000000000014, 25.499999999999922, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.10000000000002, 41.90000000000001, 40.90000000000002, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.50000000000002, 14.499999999999766, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, 38.50000000000003, 28.09999999999996, 14.899999999999771, 40.90000000000002, 45.9, -50.00000000000044, 36.50000000000003, 42.10000000000001, 42.30000000000001, 46.099999999999994, -50.00000000000044, 31.70000000000001, -50.00000000000044, 31.1], "episode_lengths": [500, 500, 500, 500, 168, 66, 134, 500, 106, 132, 176, 86, 500, 144, 102, 500, 404, 500, 146, 290, 500, 270, 78, 292, 500, 36, 500, 74, 224, 66, 500, 230, 106, 86, 500, 352, 124, 126, 74, 228, 50, 184, 126, 332, 500, 86, 166, 500, 88, 500, 56, 34, 500, 184, 500, 142, 84, 76, 500, 374, 90, 124, 42, 86, 246, 500, 500, 142, 110, 82, 92, 42, 500, 48, 500, 168, 500, 106, 356, 500, 42, 70, 500, 500, 150, 68, 116, 220, 352, 92, 42, 500, 136, 80, 78, 40, 500, 184, 500, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5297413593927659, "mean_inference_ms": 1.698500996671459, "mean_action_processing_ms": 0.20158934228746578, "mean_env_wait_ms": 0.12377983579433112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04199671745300293, "StateBufferConnector_ms": 0.011959075927734375, "ViewRequirementAgentConnector_ms": 0.1780223846435547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3686.588289616745, "num_env_steps_trained_throughput_per_sec": 3686.588289616745, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3203.281, "sample_time_ms": 2649.784, "load_time_ms": 28.905, "load_throughput": 415160.018, "learn_time_ms": 489.987, "learn_throughput": 24490.439, "synch_weights_time_ms": 33.274}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 365, "training_iteration": 9, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-31", "timestamp": 1698246691, "time_this_iter_s": 3.2620420455932617, "time_total_s": 29.193705797195435, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.193705797195435, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 88.04999999999998, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 7.0637781620025635, "policy_loss": -0.00021699546939796873, "vf_loss": 7.064048555162218, "vf_explained_var": 1.0927518208821614e-07, "kl": 0.0002473329919546864, "entropy": 0.5355647620227602, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 171.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.67499999999988, "episode_len_mean": 219.0, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 42.500000000000014, -50.00000000000044, 12.69999999999974, 41.100000000000016, 37.70000000000003, 45.9, 41.500000000000014, 25.499999999999922, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.10000000000002, 41.90000000000001, 40.90000000000002, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.50000000000002, 14.499999999999766, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, 38.50000000000003, 28.09999999999996, 14.899999999999771, 40.90000000000002, 45.9, -50.00000000000044, 36.50000000000003, 42.10000000000001, 42.30000000000001, 46.099999999999994, -50.00000000000044, 31.70000000000001, -50.00000000000044, 31.1, 24.099999999999902, -50.00000000000044, 40.70000000000002, 37.70000000000003, -50.00000000000044, 43.50000000000001, 34.30000000000004, 24.299999999999905, 43.900000000000006, 41.500000000000014, 33.70000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, 31.1, -50.00000000000044, 33.30000000000003, 46.9, 44.900000000000006, 45.1, 28.699999999999967, 42.500000000000014, 43.30000000000001, -50.00000000000044, 44.900000000000006, 45.5, 43.900000000000006, 29.69999999999998, 41.90000000000001, 46.3, -50.00000000000044, 36.50000000000003, 45.9, 42.900000000000006, 37.90000000000003, 30.099999999999987, 17.099999999999802, 39.10000000000002, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.30000000000001, 35.10000000000004, 28.499999999999964, 45.9, 35.70000000000003, 15.099999999999774, 38.10000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044], "episode_lengths": [84, 76, 500, 374, 90, 124, 42, 86, 246, 500, 500, 142, 110, 82, 92, 42, 500, 48, 500, 168, 500, 106, 356, 500, 42, 70, 500, 500, 150, 68, 116, 220, 352, 92, 42, 500, 136, 80, 78, 40, 500, 184, 500, 190, 260, 500, 94, 124, 500, 66, 158, 258, 62, 86, 164, 500, 122, 500, 50, 500, 66, 500, 190, 500, 168, 32, 52, 50, 214, 76, 68, 500, 52, 46, 62, 204, 82, 38, 500, 136, 42, 72, 122, 200, 330, 110, 62, 500, 66, 500, 68, 150, 216, 42, 144, 350, 120, 500, 198, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305460319950294, "mean_inference_ms": 1.6985962424625614, "mean_action_processing_ms": 0.20225049603728146, "mean_env_wait_ms": 0.12295514681654661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.005942821502685547, "ViewRequirementAgentConnector_ms": 0.18709921836853027}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.67499999999988, "episode_len_mean": 219.0, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 42.500000000000014, -50.00000000000044, 12.69999999999974, 41.100000000000016, 37.70000000000003, 45.9, 41.500000000000014, 25.499999999999922, -50.00000000000044, -50.00000000000044, 35.900000000000034, 39.10000000000002, 41.90000000000001, 40.90000000000002, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 33.30000000000003, -50.00000000000044, 39.50000000000002, 14.499999999999766, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.30000000000001, 38.50000000000003, 28.09999999999996, 14.899999999999771, 40.90000000000002, 45.9, -50.00000000000044, 36.50000000000003, 42.10000000000001, 42.30000000000001, 46.099999999999994, -50.00000000000044, 31.70000000000001, -50.00000000000044, 31.1, 24.099999999999902, -50.00000000000044, 40.70000000000002, 37.70000000000003, -50.00000000000044, 43.50000000000001, 34.30000000000004, 24.299999999999905, 43.900000000000006, 41.500000000000014, 33.70000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, 31.1, -50.00000000000044, 33.30000000000003, 46.9, 44.900000000000006, 45.1, 28.699999999999967, 42.500000000000014, 43.30000000000001, -50.00000000000044, 44.900000000000006, 45.5, 43.900000000000006, 29.69999999999998, 41.90000000000001, 46.3, -50.00000000000044, 36.50000000000003, 45.9, 42.900000000000006, 37.90000000000003, 30.099999999999987, 17.099999999999802, 39.10000000000002, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.30000000000001, 35.10000000000004, 28.499999999999964, 45.9, 35.70000000000003, 15.099999999999774, 38.10000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044], "episode_lengths": [84, 76, 500, 374, 90, 124, 42, 86, 246, 500, 500, 142, 110, 82, 92, 42, 500, 48, 500, 168, 500, 106, 356, 500, 42, 70, 500, 500, 150, 68, 116, 220, 352, 92, 42, 500, 136, 80, 78, 40, 500, 184, 500, 190, 260, 500, 94, 124, 500, 66, 158, 258, 62, 86, 164, 500, 122, 500, 50, 500, 66, 500, 190, 500, 168, 32, 52, 50, 214, 76, 68, 500, 52, 46, 62, 204, 82, 38, 500, 136, 42, 72, 122, 200, 330, 110, 62, 500, 66, 500, 68, 150, 216, 42, 144, 350, 120, 500, 198, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305460319950294, "mean_inference_ms": 1.6985962424625614, "mean_action_processing_ms": 0.20225049603728146, "mean_env_wait_ms": 0.12295514681654661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.005942821502685547, "ViewRequirementAgentConnector_ms": 0.18709921836853027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3850.917671254258, "num_env_steps_trained_throughput_per_sec": 3850.917671254258, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 3194.567, "sample_time_ms": 2642.806, "load_time_ms": 28.914, "load_throughput": 415022.515, "learn_time_ms": 489.641, "learn_throughput": 24507.755, "synch_weights_time_ms": 31.808}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 421, "training_iteration": 10, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-35", "timestamp": 1698246695, "time_this_iter_s": 3.12213397026062, "time_total_s": 32.315839767456055, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.315839767456055, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 78.54, "ram_util_percent": 32.940000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 6.59030360645718, "policy_loss": -0.0002879516945944892, "vf_loss": 6.5906446774800616, "vf_explained_var": 1.1258655124240451e-07, "kl": 0.0003443195334398297, "entropy": 0.531588097413381, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 189.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.999999999999863, "episode_len_mean": 230.72, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, 43.50000000000001, 34.30000000000004, 24.299999999999905, 43.900000000000006, 41.500000000000014, 33.70000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, 31.1, -50.00000000000044, 33.30000000000003, 46.9, 44.900000000000006, 45.1, 28.699999999999967, 42.500000000000014, 43.30000000000001, -50.00000000000044, 44.900000000000006, 45.5, 43.900000000000006, 29.69999999999998, 41.90000000000001, 46.3, -50.00000000000044, 36.50000000000003, 45.9, 42.900000000000006, 37.90000000000003, 30.099999999999987, 17.099999999999802, 39.10000000000002, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.30000000000001, 35.10000000000004, 28.499999999999964, 45.9, 35.70000000000003, 15.099999999999774, 38.10000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.500000000000014, 46.5, 44.900000000000006, 40.500000000000014, 44.300000000000004, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.5, 31.900000000000013, -50.00000000000044, 43.30000000000001, 1.099999999999575, 40.70000000000002, -50.00000000000044, 28.09999999999996, 39.10000000000002, 43.50000000000001, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 33.30000000000003, 36.30000000000003, 40.30000000000002, 41.70000000000002, 20.699999999999854], "episode_lengths": [124, 500, 66, 158, 258, 62, 86, 164, 500, 122, 500, 50, 500, 66, 500, 190, 500, 168, 32, 52, 50, 214, 76, 68, 500, 52, 46, 62, 204, 82, 38, 500, 136, 42, 72, 122, 200, 330, 110, 62, 500, 66, 500, 68, 150, 216, 42, 144, 350, 120, 500, 198, 500, 500, 362, 500, 500, 126, 76, 36, 52, 96, 58, 60, 58, 60, 500, 264, 500, 320, 500, 500, 56, 182, 500, 68, 490, 94, 500, 220, 110, 66, 222, 500, 500, 500, 70, 500, 500, 56, 72, 500, 50, 48, 500, 168, 138, 98, 84, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5314925172790262, "mean_inference_ms": 1.6979047965449978, "mean_action_processing_ms": 0.20192496040906321, "mean_env_wait_ms": 0.12307492292944723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03690743446350098, "StateBufferConnector_ms": 0.008986234664916992, "ViewRequirementAgentConnector_ms": 0.19089198112487793}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.999999999999863, "episode_len_mean": 230.72, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, -50.00000000000044, 43.50000000000001, 34.30000000000004, 24.299999999999905, 43.900000000000006, 41.500000000000014, 33.70000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.50000000000001, -50.00000000000044, 31.1, -50.00000000000044, 33.30000000000003, 46.9, 44.900000000000006, 45.1, 28.699999999999967, 42.500000000000014, 43.30000000000001, -50.00000000000044, 44.900000000000006, 45.5, 43.900000000000006, 29.69999999999998, 41.90000000000001, 46.3, -50.00000000000044, 36.50000000000003, 45.9, 42.900000000000006, 37.90000000000003, 30.099999999999987, 17.099999999999802, 39.10000000000002, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.30000000000001, 35.10000000000004, 28.499999999999964, 45.9, 35.70000000000003, 15.099999999999774, 38.10000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.500000000000014, 46.5, 44.900000000000006, 40.500000000000014, 44.300000000000004, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.5, 31.900000000000013, -50.00000000000044, 43.30000000000001, 1.099999999999575, 40.70000000000002, -50.00000000000044, 28.09999999999996, 39.10000000000002, 43.50000000000001, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 33.30000000000003, 36.30000000000003, 40.30000000000002, 41.70000000000002, 20.699999999999854], "episode_lengths": [124, 500, 66, 158, 258, 62, 86, 164, 500, 122, 500, 50, 500, 66, 500, 190, 500, 168, 32, 52, 50, 214, 76, 68, 500, 52, 46, 62, 204, 82, 38, 500, 136, 42, 72, 122, 200, 330, 110, 62, 500, 66, 500, 68, 150, 216, 42, 144, 350, 120, 500, 198, 500, 500, 362, 500, 500, 126, 76, 36, 52, 96, 58, 60, 58, 60, 500, 264, 500, 320, 500, 500, 56, 182, 500, 68, 490, 94, 500, 220, 110, 66, 222, 500, 500, 500, 70, 500, 500, 56, 72, 500, 50, 48, 500, 168, 138, 98, 84, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5314925172790262, "mean_inference_ms": 1.6979047965449978, "mean_action_processing_ms": 0.20192496040906321, "mean_env_wait_ms": 0.12307492292944723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03690743446350098, "StateBufferConnector_ms": 0.008986234664916992, "ViewRequirementAgentConnector_ms": 0.19089198112487793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3702.617936621319, "num_env_steps_trained_throughput_per_sec": 3702.617936621319, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 3207.84, "sample_time_ms": 2657.395, "load_time_ms": 28.514, "load_throughput": 420849.364, "learn_time_ms": 488.874, "learn_throughput": 24546.216, "synch_weights_time_ms": 31.509}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 468, "training_iteration": 11, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-38", "timestamp": 1698246698, "time_this_iter_s": 3.2479453086853027, "time_total_s": 35.56378507614136, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.56378507614136, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 88.0, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.7135946485731335, "policy_loss": -0.00021756399008962844, "vf_loss": 6.713865756988525, "vf_explained_var": 4.238552517361111e-07, "kl": 0.00037432545064507313, "entropy": 0.536128141813808, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 207.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.865999999999831, "episode_len_mean": 262.0, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, 15.099999999999774, 38.10000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.500000000000014, 46.5, 44.900000000000006, 40.500000000000014, 44.300000000000004, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.5, 31.900000000000013, -50.00000000000044, 43.30000000000001, 1.099999999999575, 40.70000000000002, -50.00000000000044, 28.09999999999996, 39.10000000000002, 43.50000000000001, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 33.30000000000003, 36.30000000000003, 40.30000000000002, 41.70000000000002, 20.699999999999854, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 12.69999999999974, 28.499999999999964, 6.699999999999655, 40.30000000000002, -50.00000000000044, 27.299999999999947, -50.00000000000044, 31.500000000000007, 35.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 26.69999999999994, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, 43.30000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 43.10000000000001, 37.300000000000026, 26.69999999999994, 17.299999999999805, 44.300000000000004, -50.00000000000044, 41.100000000000016, 35.70000000000003, 44.900000000000006, -50.00000000000044, 45.1, 45.7, 47.5], "episode_lengths": [144, 350, 120, 500, 198, 500, 500, 362, 500, 500, 126, 76, 36, 52, 96, 58, 60, 58, 60, 500, 264, 500, 320, 500, 500, 56, 182, 500, 68, 490, 94, 500, 220, 110, 66, 222, 500, 500, 500, 70, 500, 500, 56, 72, 500, 50, 48, 500, 168, 138, 98, 84, 294, 500, 500, 70, 92, 374, 216, 434, 98, 500, 228, 500, 186, 142, 500, 54, 500, 500, 500, 38, 50, 500, 500, 48, 234, 136, 500, 500, 68, 500, 198, 68, 178, 98, 500, 70, 128, 234, 328, 58, 500, 90, 144, 52, 500, 50, 44, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319214254122884, "mean_inference_ms": 1.6950874749590792, "mean_action_processing_ms": 0.20218948960393796, "mean_env_wait_ms": 0.12366864133868512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037995338439941406, "StateBufferConnector_ms": 0.008990287780761719, "ViewRequirementAgentConnector_ms": 0.18880987167358398}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.865999999999831, "episode_len_mean": 262.0, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, 15.099999999999774, 38.10000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.500000000000014, 46.5, 44.900000000000006, 40.500000000000014, 44.300000000000004, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, 23.699999999999896, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.5, 31.900000000000013, -50.00000000000044, 43.30000000000001, 1.099999999999575, 40.70000000000002, -50.00000000000044, 28.09999999999996, 39.10000000000002, 43.50000000000001, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 33.30000000000003, 36.30000000000003, 40.30000000000002, 41.70000000000002, 20.699999999999854, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 12.69999999999974, 28.499999999999964, 6.699999999999655, 40.30000000000002, -50.00000000000044, 27.299999999999947, -50.00000000000044, 31.500000000000007, 35.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 26.69999999999994, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, 43.30000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 43.10000000000001, 37.300000000000026, 26.69999999999994, 17.299999999999805, 44.300000000000004, -50.00000000000044, 41.100000000000016, 35.70000000000003, 44.900000000000006, -50.00000000000044, 45.1, 45.7, 47.5], "episode_lengths": [144, 350, 120, 500, 198, 500, 500, 362, 500, 500, 126, 76, 36, 52, 96, 58, 60, 58, 60, 500, 264, 500, 320, 500, 500, 56, 182, 500, 68, 490, 94, 500, 220, 110, 66, 222, 500, 500, 500, 70, 500, 500, 56, 72, 500, 50, 48, 500, 168, 138, 98, 84, 294, 500, 500, 70, 92, 374, 216, 434, 98, 500, 228, 500, 186, 142, 500, 54, 500, 500, 500, 38, 50, 500, 500, 48, 234, 136, 500, 500, 68, 500, 198, 68, 178, 98, 500, 70, 128, 234, 328, 58, 500, 90, 144, 52, 500, 50, 44, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319214254122884, "mean_inference_ms": 1.6950874749590792, "mean_action_processing_ms": 0.20218948960393796, "mean_env_wait_ms": 0.12366864133868512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037995338439941406, "StateBufferConnector_ms": 0.008990287780761719, "ViewRequirementAgentConnector_ms": 0.18880987167358398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3844.219866595503, "num_env_steps_trained_throughput_per_sec": 3844.219866595503, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3205.233, "sample_time_ms": 2649.296, "load_time_ms": 28.356, "load_throughput": 423195.429, "learn_time_ms": 494.266, "learn_throughput": 24278.43, "synch_weights_time_ms": 31.666}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 515, "training_iteration": 12, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-41", "timestamp": 1698246701, "time_this_iter_s": 3.1295697689056396, "time_total_s": 38.693354845047, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.693354845047, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 76.8, "ram_util_percent": 32.940000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 6.610373576482137, "policy_loss": -1.0213918156094021e-05, "vf_loss": 6.6104341348012285, "vf_explained_var": -4.384252760145399e-06, "kl": 0.0001552843824741659, "entropy": 0.5031687849097781, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4509999999998047, "episode_len_mean": 281.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 33.30000000000003, 36.30000000000003, 40.30000000000002, 41.70000000000002, 20.699999999999854, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 12.69999999999974, 28.499999999999964, 6.699999999999655, 40.30000000000002, -50.00000000000044, 27.299999999999947, -50.00000000000044, 31.500000000000007, 35.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 26.69999999999994, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, 43.30000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 43.10000000000001, 37.300000000000026, 26.69999999999994, 17.299999999999805, 44.300000000000004, -50.00000000000044, 41.100000000000016, 35.70000000000003, 44.900000000000006, -50.00000000000044, 45.1, 45.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 10.899999999999714, 37.10000000000003, -50.00000000000044, 23.099999999999888, 37.10000000000003, 47.1, -50.00000000000044, 44.300000000000004, 45.9, 45.3, 45.7, -50.00000000000044, 45.5, 40.10000000000002, 9.299999999999692, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 56, 72, 500, 50, 48, 500, 168, 138, 98, 84, 294, 500, 500, 70, 92, 374, 216, 434, 98, 500, 228, 500, 186, 142, 500, 54, 500, 500, 500, 38, 50, 500, 500, 48, 234, 136, 500, 500, 68, 500, 198, 68, 178, 98, 500, 70, 128, 234, 328, 58, 500, 90, 144, 52, 500, 50, 44, 26, 500, 500, 500, 500, 500, 66, 102, 392, 130, 500, 270, 130, 30, 500, 58, 42, 48, 44, 500, 46, 100, 408, 500, 56, 500, 500, 52, 236, 500, 56, 100, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5323357672161084, "mean_inference_ms": 1.6981583714412993, "mean_action_processing_ms": 0.20342766934602804, "mean_env_wait_ms": 0.12391826426665248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199958801269531, "StateBufferConnector_ms": 0.009000539779663086, "ViewRequirementAgentConnector_ms": 0.1990642547607422}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4509999999998047, "episode_len_mean": 281.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.5, 42.900000000000006, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 33.30000000000003, 36.30000000000003, 40.30000000000002, 41.70000000000002, 20.699999999999854, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 12.69999999999974, 28.499999999999964, 6.699999999999655, 40.30000000000002, -50.00000000000044, 27.299999999999947, -50.00000000000044, 31.500000000000007, 35.900000000000034, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 26.69999999999994, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 30.29999999999999, 43.30000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 43.10000000000001, 37.300000000000026, 26.69999999999994, 17.299999999999805, 44.300000000000004, -50.00000000000044, 41.100000000000016, 35.70000000000003, 44.900000000000006, -50.00000000000044, 45.1, 45.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 10.899999999999714, 37.10000000000003, -50.00000000000044, 23.099999999999888, 37.10000000000003, 47.1, -50.00000000000044, 44.300000000000004, 45.9, 45.3, 45.7, -50.00000000000044, 45.5, 40.10000000000002, 9.299999999999692, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 56, 72, 500, 50, 48, 500, 168, 138, 98, 84, 294, 500, 500, 70, 92, 374, 216, 434, 98, 500, 228, 500, 186, 142, 500, 54, 500, 500, 500, 38, 50, 500, 500, 48, 234, 136, 500, 500, 68, 500, 198, 68, 178, 98, 500, 70, 128, 234, 328, 58, 500, 90, 144, 52, 500, 50, 44, 26, 500, 500, 500, 500, 500, 66, 102, 392, 130, 500, 270, 130, 30, 500, 58, 42, 48, 44, 500, 46, 100, 408, 500, 56, 500, 500, 52, 236, 500, 56, 100, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5323357672161084, "mean_inference_ms": 1.6981583714412993, "mean_action_processing_ms": 0.20342766934602804, "mean_env_wait_ms": 0.12391826426665248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199958801269531, "StateBufferConnector_ms": 0.009000539779663086, "ViewRequirementAgentConnector_ms": 0.1990642547607422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3520.0870586309948, "num_env_steps_trained_throughput_per_sec": 3520.0870586309948, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 3233.831, "sample_time_ms": 2677.896, "load_time_ms": 28.856, "load_throughput": 415861.614, "learn_time_ms": 494.029, "learn_throughput": 24290.058, "synch_weights_time_ms": 31.499}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 555, "training_iteration": 13, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-44", "timestamp": 1698246704, "time_this_iter_s": 3.414835214614868, "time_total_s": 42.108190059661865, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.108190059661865, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 83.67999999999999, "ram_util_percent": 32.980000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.703633361392551, "policy_loss": -0.0006653656148248249, "vf_loss": 6.704351584116618, "vf_explained_var": -3.841188218858507e-07, "kl": 0.00081344720961359, "entropy": 0.5275183750523461, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 243.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4189999999998144, "episode_len_mean": 271.42, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 43.10000000000001, 37.300000000000026, 26.69999999999994, 17.299999999999805, 44.300000000000004, -50.00000000000044, 41.100000000000016, 35.70000000000003, 44.900000000000006, -50.00000000000044, 45.1, 45.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 10.899999999999714, 37.10000000000003, -50.00000000000044, 23.099999999999888, 37.10000000000003, 47.1, -50.00000000000044, 44.300000000000004, 45.9, 45.3, 45.7, -50.00000000000044, 45.5, 40.10000000000002, 9.299999999999692, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 39.300000000000026, 43.10000000000001, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 45.3, 38.10000000000002, 36.50000000000003, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 38.700000000000024, 20.49999999999985, 43.10000000000001, 16.09999999999979, 23.099999999999888, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, 8.49999999999968, 38.50000000000003], "episode_lengths": [68, 178, 98, 500, 70, 128, 234, 328, 58, 500, 90, 144, 52, 500, 50, 44, 26, 500, 500, 500, 500, 500, 66, 102, 392, 130, 500, 270, 130, 30, 500, 58, 42, 48, 44, 500, 46, 100, 408, 500, 56, 500, 500, 52, 236, 500, 56, 100, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 74, 120, 500, 58, 98, 500, 500, 56, 500, 148, 108, 70, 40, 500, 148, 500, 182, 48, 120, 136, 36, 500, 32, 500, 74, 134, 500, 500, 500, 262, 500, 114, 296, 70, 340, 270, 500, 76, 66, 500, 416, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.535778750954983, "mean_inference_ms": 1.712062272834974, "mean_action_processing_ms": 0.20498671949322753, "mean_env_wait_ms": 0.12486326701704145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035979270935058594, "StateBufferConnector_ms": 0.010004997253417969, "ViewRequirementAgentConnector_ms": 0.20318055152893066}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4189999999998144, "episode_len_mean": 271.42, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 32.30000000000002, 40.30000000000002, -50.00000000000044, 43.10000000000001, 37.300000000000026, 26.69999999999994, 17.299999999999805, 44.300000000000004, -50.00000000000044, 41.100000000000016, 35.70000000000003, 44.900000000000006, -50.00000000000044, 45.1, 45.7, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 10.899999999999714, 37.10000000000003, -50.00000000000044, 23.099999999999888, 37.10000000000003, 47.1, -50.00000000000044, 44.300000000000004, 45.9, 45.3, 45.7, -50.00000000000044, 45.5, 40.10000000000002, 9.299999999999692, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 26.499999999999936, -50.00000000000044, 44.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 39.300000000000026, 43.10000000000001, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 45.3, 38.10000000000002, 36.50000000000003, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 38.700000000000024, 20.49999999999985, 43.10000000000001, 16.09999999999979, 23.099999999999888, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, 8.49999999999968, 38.50000000000003], "episode_lengths": [68, 178, 98, 500, 70, 128, 234, 328, 58, 500, 90, 144, 52, 500, 50, 44, 26, 500, 500, 500, 500, 500, 66, 102, 392, 130, 500, 270, 130, 30, 500, 58, 42, 48, 44, 500, 46, 100, 408, 500, 56, 500, 500, 52, 236, 500, 56, 100, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 74, 120, 500, 58, 98, 500, 500, 56, 500, 148, 108, 70, 40, 500, 148, 500, 182, 48, 120, 136, 36, 500, 32, 500, 74, 134, 500, 500, 500, 262, 500, 114, 296, 70, 340, 270, 500, 76, 66, 500, 416, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.535778750954983, "mean_inference_ms": 1.712062272834974, "mean_action_processing_ms": 0.20498671949322753, "mean_env_wait_ms": 0.12486326701704145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035979270935058594, "StateBufferConnector_ms": 0.010004997253417969, "ViewRequirementAgentConnector_ms": 0.20318055152893066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3018.6431244602245, "num_env_steps_trained_throughput_per_sec": 3018.6431244602245, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 3279.796, "sample_time_ms": 2758.541, "load_time_ms": 28.545, "load_throughput": 420389.94, "learn_time_ms": 472.763, "learn_throughput": 25382.695, "synch_weights_time_ms": 18.497}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 598, "training_iteration": 14, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-48", "timestamp": 1698246708, "time_this_iter_s": 3.9822916984558105, "time_total_s": 46.090481758117676, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 46.090481758117676, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 90.52000000000001, "ram_util_percent": 33.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.460772487852308, "policy_loss": -0.00035133274892965954, "vf_loss": 6.46117737558153, "vf_explained_var": 2.1855036417643228e-07, "kl": 0.00031356527040315996, "entropy": 0.5378332038720449, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 261.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7719999999998133, "episode_len_mean": 272.88, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 39.300000000000026, 43.10000000000001, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 45.3, 38.10000000000002, 36.50000000000003, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 38.700000000000024, 20.49999999999985, 43.10000000000001, 16.09999999999979, 23.099999999999888, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, 8.49999999999968, 38.50000000000003, 47.3, -50.00000000000044, 45.9, 47.1, 40.500000000000014, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 32.700000000000024, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.9, 13.299999999999748, 37.300000000000026, -50.00000000000044, 42.10000000000001, 13.699999999999754, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 26.09999999999993, 42.500000000000014, 40.500000000000014, 44.5, -50.00000000000044, 43.30000000000001, 39.90000000000002, 36.30000000000003, 43.7, 45.1, 46.099999999999994, -50.00000000000044, 35.500000000000036], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 74, 120, 500, 58, 98, 500, 500, 56, 500, 148, 108, 70, 40, 500, 148, 500, 182, 48, 120, 136, 36, 500, 32, 500, 74, 134, 500, 500, 500, 262, 500, 114, 296, 70, 340, 270, 500, 76, 66, 500, 416, 116, 28, 500, 42, 30, 96, 432, 500, 500, 64, 500, 104, 500, 64, 500, 500, 116, 174, 500, 54, 74, 500, 500, 500, 40, 78, 32, 368, 128, 500, 80, 364, 50, 500, 500, 86, 240, 76, 96, 56, 500, 68, 102, 138, 64, 50, 40, 500, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391809806132762, "mean_inference_ms": 1.7266295200855653, "mean_action_processing_ms": 0.20578767281061236, "mean_env_wait_ms": 0.12550298240835658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04098773002624512, "StateBufferConnector_ms": 0.014003276824951172, "ViewRequirementAgentConnector_ms": 0.18898940086364746}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7719999999998133, "episode_len_mean": 272.88, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 38.10000000000002, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 35.30000000000004, 39.300000000000026, 43.10000000000001, 46.099999999999994, -50.00000000000044, 35.30000000000004, -50.00000000000044, 31.900000000000013, 45.3, 38.10000000000002, 36.50000000000003, 46.5, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 38.700000000000024, 20.49999999999985, 43.10000000000001, 16.09999999999979, 23.099999999999888, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, 8.49999999999968, 38.50000000000003, 47.3, -50.00000000000044, 45.9, 47.1, 40.500000000000014, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 32.700000000000024, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.9, 13.299999999999748, 37.300000000000026, -50.00000000000044, 42.10000000000001, 13.699999999999754, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 26.09999999999993, 42.500000000000014, 40.500000000000014, 44.5, -50.00000000000044, 43.30000000000001, 39.90000000000002, 36.30000000000003, 43.7, 45.1, 46.099999999999994, -50.00000000000044, 35.500000000000036], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 74, 120, 500, 58, 98, 500, 500, 56, 500, 148, 108, 70, 40, 500, 148, 500, 182, 48, 120, 136, 36, 500, 32, 500, 74, 134, 500, 500, 500, 262, 500, 114, 296, 70, 340, 270, 500, 76, 66, 500, 416, 116, 28, 500, 42, 30, 96, 432, 500, 500, 64, 500, 104, 500, 64, 500, 500, 116, 174, 500, 54, 74, 500, 500, 500, 40, 78, 32, 368, 128, 500, 80, 364, 50, 500, 500, 86, 240, 76, 96, 56, 500, 68, 102, 138, 64, 50, 40, 500, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391809806132762, "mean_inference_ms": 1.7266295200855653, "mean_action_processing_ms": 0.20578767281061236, "mean_env_wait_ms": 0.12550298240835658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04098773002624512, "StateBufferConnector_ms": 0.014003276824951172, "ViewRequirementAgentConnector_ms": 0.18898940086364746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3642.7629723856776, "num_env_steps_trained_throughput_per_sec": 3642.7629723856776, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3288.915, "sample_time_ms": 2756.668, "load_time_ms": 28.945, "load_throughput": 414579.475, "learn_time_ms": 482.854, "learn_throughput": 24852.247, "synch_weights_time_ms": 18.896}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 646, "training_iteration": 15, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-52", "timestamp": 1698246712, "time_this_iter_s": 3.3022210597991943, "time_total_s": 49.39270281791687, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.39270281791687, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 81.52, "ram_util_percent": 33.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.081836091147529, "policy_loss": -0.0006397363419334093, "vf_loss": 6.082523902257283, "vf_explained_var": -2.125898996988932e-06, "kl": 0.0008119714171294214, "entropy": 0.4807118342982398, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 279.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.304999999999831, "episode_len_mean": 252.6, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 16.09999999999979, 23.099999999999888, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, 8.49999999999968, 38.50000000000003, 47.3, -50.00000000000044, 45.9, 47.1, 40.500000000000014, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 32.700000000000024, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.9, 13.299999999999748, 37.300000000000026, -50.00000000000044, 42.10000000000001, 13.699999999999754, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 26.09999999999993, 42.500000000000014, 40.500000000000014, 44.5, -50.00000000000044, 43.30000000000001, 39.90000000000002, 36.30000000000003, 43.7, 45.1, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.5, 44.7, 35.70000000000003, 40.70000000000002, 31.900000000000013, -50.00000000000044, 41.90000000000001, 46.699999999999996, 44.900000000000006, 44.900000000000006, 43.10000000000001, -50.00000000000044, 38.300000000000026, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 30.099999999999987, 28.699999999999967, 42.30000000000001, 45.1, 43.30000000000001, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 8.699999999999683, 45.9, -50.00000000000044, -50.00000000000044, 40.10000000000002], "episode_lengths": [70, 340, 270, 500, 76, 66, 500, 416, 116, 28, 500, 42, 30, 96, 432, 500, 500, 64, 500, 104, 500, 64, 500, 500, 116, 174, 500, 54, 74, 500, 500, 500, 40, 78, 32, 368, 128, 500, 80, 364, 50, 500, 500, 86, 240, 76, 96, 56, 500, 68, 102, 138, 64, 50, 40, 500, 146, 500, 500, 60, 500, 56, 54, 144, 94, 182, 500, 82, 34, 52, 52, 70, 500, 118, 114, 500, 500, 500, 500, 500, 106, 118, 200, 214, 78, 50, 68, 500, 216, 76, 500, 500, 500, 32, 500, 414, 42, 500, 500, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406419837044149, "mean_inference_ms": 1.7325299503727618, "mean_action_processing_ms": 0.20619791260963483, "mean_env_wait_ms": 0.12591536284572635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04799818992614746, "StateBufferConnector_ms": 0.01469874382019043, "ViewRequirementAgentConnector_ms": 0.1879727840423584}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.304999999999831, "episode_len_mean": 252.6, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 16.09999999999979, 23.099999999999888, -50.00000000000044, 42.500000000000014, 43.50000000000001, -50.00000000000044, 8.49999999999968, 38.50000000000003, 47.3, -50.00000000000044, 45.9, 47.1, 40.500000000000014, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 38.50000000000003, 32.700000000000024, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 42.30000000000001, 46.9, 13.299999999999748, 37.300000000000026, -50.00000000000044, 42.10000000000001, 13.699999999999754, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 26.09999999999993, 42.500000000000014, 40.500000000000014, 44.5, -50.00000000000044, 43.30000000000001, 39.90000000000002, 36.30000000000003, 43.7, 45.1, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.5, 44.7, 35.70000000000003, 40.70000000000002, 31.900000000000013, -50.00000000000044, 41.90000000000001, 46.699999999999996, 44.900000000000006, 44.900000000000006, 43.10000000000001, -50.00000000000044, 38.300000000000026, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 30.099999999999987, 28.699999999999967, 42.30000000000001, 45.1, 43.30000000000001, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 8.699999999999683, 45.9, -50.00000000000044, -50.00000000000044, 40.10000000000002], "episode_lengths": [70, 340, 270, 500, 76, 66, 500, 416, 116, 28, 500, 42, 30, 96, 432, 500, 500, 64, 500, 104, 500, 64, 500, 500, 116, 174, 500, 54, 74, 500, 500, 500, 40, 78, 32, 368, 128, 500, 80, 364, 50, 500, 500, 86, 240, 76, 96, 56, 500, 68, 102, 138, 64, 50, 40, 500, 146, 500, 500, 60, 500, 56, 54, 144, 94, 182, 500, 82, 34, 52, 52, 70, 500, 118, 114, 500, 500, 500, 500, 500, 106, 118, 200, 214, 78, 50, 68, 500, 216, 76, 500, 500, 500, 32, 500, 414, 42, 500, 500, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5406419837044149, "mean_inference_ms": 1.7325299503727618, "mean_action_processing_ms": 0.20619791260963483, "mean_env_wait_ms": 0.12591536284572635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04799818992614746, "StateBufferConnector_ms": 0.01469874382019043, "ViewRequirementAgentConnector_ms": 0.1879727840423584}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3431.9079392371036, "num_env_steps_trained_throughput_per_sec": 3431.9079392371036, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 3328.634, "sample_time_ms": 2801.155, "load_time_ms": 29.111, "load_throughput": 412208.507, "learn_time_ms": 478.943, "learn_throughput": 25055.198, "synch_weights_time_ms": 17.974}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 689, "training_iteration": 16, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-55", "timestamp": 1698246715, "time_this_iter_s": 3.502614974975586, "time_total_s": 52.895317792892456, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 52.895317792892456, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 81.92, "ram_util_percent": 33.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.2535268730587426, "policy_loss": -0.0003286335203382704, "vf_loss": 6.253911071353489, "vf_explained_var": 7.583035363091362e-07, "kl": 0.0006155995679111786, "entropy": 0.5565983123249478, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 297.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.9339999999998385, "episode_len_mean": 251.32, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 43.30000000000001, 39.90000000000002, 36.30000000000003, 43.7, 45.1, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.5, 44.7, 35.70000000000003, 40.70000000000002, 31.900000000000013, -50.00000000000044, 41.90000000000001, 46.699999999999996, 44.900000000000006, 44.900000000000006, 43.10000000000001, -50.00000000000044, 38.300000000000026, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 30.099999999999987, 28.699999999999967, 42.30000000000001, 45.1, 43.30000000000001, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 8.699999999999683, 45.9, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, 23.29999999999989, 40.10000000000002, 9.499999999999694, 46.9, 36.30000000000003, 34.30000000000004, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.1, 25.099999999999916, 44.10000000000001, 44.7, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, 37.300000000000026, 29.899999999999984, 13.699999999999754, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 46.3, 40.70000000000002, 37.50000000000003, 45.3, 19.299999999999834, 4.899999999999629, -50.00000000000044, 46.099999999999994, 39.300000000000026], "episode_lengths": [56, 500, 68, 102, 138, 64, 50, 40, 500, 146, 500, 500, 60, 500, 56, 54, 144, 94, 182, 500, 82, 34, 52, 52, 70, 500, 118, 114, 500, 500, 500, 500, 500, 106, 118, 200, 214, 78, 50, 68, 500, 216, 76, 500, 500, 500, 32, 500, 414, 42, 500, 500, 100, 500, 70, 268, 100, 406, 32, 138, 158, 60, 56, 500, 500, 500, 370, 500, 500, 500, 188, 500, 50, 250, 60, 54, 122, 500, 38, 500, 500, 58, 500, 82, 128, 202, 364, 500, 72, 500, 102, 38, 94, 126, 48, 308, 452, 500, 40, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5418792956066978, "mean_inference_ms": 1.7350546614839066, "mean_action_processing_ms": 0.20675869553388676, "mean_env_wait_ms": 0.12609579735311427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04301953315734863, "StateBufferConnector_ms": 0.00969839096069336, "ViewRequirementAgentConnector_ms": 0.18073630332946777}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.9339999999998385, "episode_len_mean": 251.32, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 43.30000000000001, 39.90000000000002, 36.30000000000003, 43.7, 45.1, 46.099999999999994, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.5, 44.7, 35.70000000000003, 40.70000000000002, 31.900000000000013, -50.00000000000044, 41.90000000000001, 46.699999999999996, 44.900000000000006, 44.900000000000006, 43.10000000000001, -50.00000000000044, 38.300000000000026, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.300000000000026, 30.099999999999987, 28.699999999999967, 42.30000000000001, 45.1, 43.30000000000001, -50.00000000000044, 28.499999999999964, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 8.699999999999683, 45.9, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, 23.29999999999989, 40.10000000000002, 9.499999999999694, 46.9, 36.30000000000003, 34.30000000000004, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.1, 25.099999999999916, 44.10000000000001, 44.7, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, 37.300000000000026, 29.899999999999984, 13.699999999999754, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 46.3, 40.70000000000002, 37.50000000000003, 45.3, 19.299999999999834, 4.899999999999629, -50.00000000000044, 46.099999999999994, 39.300000000000026], "episode_lengths": [56, 500, 68, 102, 138, 64, 50, 40, 500, 146, 500, 500, 60, 500, 56, 54, 144, 94, 182, 500, 82, 34, 52, 52, 70, 500, 118, 114, 500, 500, 500, 500, 500, 106, 118, 200, 214, 78, 50, 68, 500, 216, 76, 500, 500, 500, 32, 500, 414, 42, 500, 500, 100, 500, 70, 268, 100, 406, 32, 138, 158, 60, 56, 500, 500, 500, 370, 500, 500, 500, 188, 500, 50, 250, 60, 54, 122, 500, 38, 500, 500, 58, 500, 82, 128, 202, 364, 500, 72, 500, 102, 38, 94, 126, 48, 308, 452, 500, 40, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5418792956066978, "mean_inference_ms": 1.7350546614839066, "mean_action_processing_ms": 0.20675869553388676, "mean_env_wait_ms": 0.12609579735311427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04301953315734863, "StateBufferConnector_ms": 0.00969839096069336, "ViewRequirementAgentConnector_ms": 0.18073630332946777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3689.8420208441025, "num_env_steps_trained_throughput_per_sec": 3689.8420208441025, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 3324.9, "sample_time_ms": 2796.377, "load_time_ms": 29.655, "load_throughput": 404650.864, "learn_time_ms": 479.244, "learn_throughput": 25039.419, "synch_weights_time_ms": 18.173}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 736, "training_iteration": 17, "trial_id": "9f288_00008", "date": "2023-10-25_16-11-59", "timestamp": 1698246719, "time_this_iter_s": 3.257171154022217, "time_total_s": 56.15248894691467, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.15248894691467, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 89.775, "ram_util_percent": 33.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.910761117935181, "policy_loss": -4.55398629936907e-06, "vf_loss": 6.910826868481106, "vf_explained_var": -1.4106432596842449e-06, "kl": 0.0002985090470954472, "entropy": 0.6115759710470835, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.14499999999982, "episode_len_mean": 264.22, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.699999999999683, 45.9, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, 23.29999999999989, 40.10000000000002, 9.499999999999694, 46.9, 36.30000000000003, 34.30000000000004, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.1, 25.099999999999916, 44.10000000000001, 44.7, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, 37.300000000000026, 29.899999999999984, 13.699999999999754, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 46.3, 40.70000000000002, 37.50000000000003, 45.3, 19.299999999999834, 4.899999999999629, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 9.499999999999694, 43.50000000000001, 41.500000000000014, -50.00000000000044, 37.50000000000003, 8.099999999999675, 28.699999999999967, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 41.500000000000014, 44.10000000000001, -50.00000000000044, 45.5, 38.700000000000024, 42.70000000000001, 4.099999999999618, -50.00000000000044, 43.30000000000001, 45.1, 44.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 42.900000000000006, 13.899999999999757, 41.500000000000014, 42.70000000000001, 1.8999999999995865, 26.09999999999993, -50.00000000000044], "episode_lengths": [414, 42, 500, 500, 100, 500, 70, 268, 100, 406, 32, 138, 158, 60, 56, 500, 500, 500, 370, 500, 500, 500, 188, 500, 50, 250, 60, 54, 122, 500, 38, 500, 500, 58, 500, 82, 128, 202, 364, 500, 72, 500, 102, 38, 94, 126, 48, 308, 452, 500, 40, 108, 500, 36, 78, 500, 500, 154, 406, 66, 86, 500, 126, 420, 214, 54, 66, 500, 500, 500, 48, 500, 58, 500, 84, 86, 60, 500, 46, 114, 74, 460, 500, 68, 50, 52, 500, 394, 500, 500, 50, 500, 58, 72, 362, 86, 74, 482, 240, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5417791930860245, "mean_inference_ms": 1.7357328914029564, "mean_action_processing_ms": 0.20745068932902339, "mean_env_wait_ms": 0.12663397687719616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03636336326599121, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.1992950439453125}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.14499999999982, "episode_len_mean": 264.22, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.699999999999683, 45.9, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 43.10000000000001, 23.29999999999989, 40.10000000000002, 9.499999999999694, 46.9, 36.30000000000003, 34.30000000000004, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 45.1, 25.099999999999916, 44.10000000000001, 44.7, 37.90000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.90000000000001, 37.300000000000026, 29.899999999999984, 13.699999999999754, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.90000000000002, 46.3, 40.70000000000002, 37.50000000000003, 45.3, 19.299999999999834, 4.899999999999629, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 9.499999999999694, 43.50000000000001, 41.500000000000014, -50.00000000000044, 37.50000000000003, 8.099999999999675, 28.699999999999967, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 41.500000000000014, 44.10000000000001, -50.00000000000044, 45.5, 38.700000000000024, 42.70000000000001, 4.099999999999618, -50.00000000000044, 43.30000000000001, 45.1, 44.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 42.900000000000006, 13.899999999999757, 41.500000000000014, 42.70000000000001, 1.8999999999995865, 26.09999999999993, -50.00000000000044], "episode_lengths": [414, 42, 500, 500, 100, 500, 70, 268, 100, 406, 32, 138, 158, 60, 56, 500, 500, 500, 370, 500, 500, 500, 188, 500, 50, 250, 60, 54, 122, 500, 38, 500, 500, 58, 500, 82, 128, 202, 364, 500, 72, 500, 102, 38, 94, 126, 48, 308, 452, 500, 40, 108, 500, 36, 78, 500, 500, 154, 406, 66, 86, 500, 126, 420, 214, 54, 66, 500, 500, 500, 48, 500, 58, 500, 84, 86, 60, 500, 46, 114, 74, 460, 500, 68, 50, 52, 500, 394, 500, 500, 50, 500, 58, 72, 362, 86, 74, 482, 240, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5417791930860245, "mean_inference_ms": 1.7357328914029564, "mean_action_processing_ms": 0.20745068932902339, "mean_env_wait_ms": 0.12663397687719616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03636336326599121, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.1992950439453125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3951.3800683151067, "num_env_steps_trained_throughput_per_sec": 3951.3800683151067, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3319.789, "sample_time_ms": 2821.091, "load_time_ms": 29.755, "load_throughput": 403297.169, "learn_time_ms": 450.07, "learn_throughput": 26662.491, "synch_weights_time_ms": 17.221}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 784, "training_iteration": 18, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-02", "timestamp": 1698246722, "time_this_iter_s": 3.042442560195923, "time_total_s": 59.194931507110596, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 59.194931507110596, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 82.75999999999999, "ram_util_percent": 33.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.674783892101711, "policy_loss": -0.0002939324412080977, "vf_loss": 6.675135082668728, "vf_explained_var": -2.7285681830512153e-06, "kl": 0.0005749702090093302, "entropy": 0.5733596450752683, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 333.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.270999999999837, "episode_len_mean": 252.98, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.899999999999629, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 9.499999999999694, 43.50000000000001, 41.500000000000014, -50.00000000000044, 37.50000000000003, 8.099999999999675, 28.699999999999967, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 41.500000000000014, 44.10000000000001, -50.00000000000044, 45.5, 38.700000000000024, 42.70000000000001, 4.099999999999618, -50.00000000000044, 43.30000000000001, 45.1, 44.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 42.900000000000006, 13.899999999999757, 41.500000000000014, 42.70000000000001, 1.8999999999995865, 26.09999999999993, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, 12.899999999999743, 43.900000000000006, 27.899999999999956, 38.700000000000024, 42.30000000000001, 46.099999999999994, 43.900000000000006, 27.899999999999956, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, 39.70000000000002, 34.30000000000004, 42.900000000000006, 37.50000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 42.30000000000001, 33.500000000000036, 43.50000000000001, 39.70000000000002, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.5, 33.500000000000036, 25.099999999999916, 45.5, 39.10000000000002, 37.50000000000003, 37.70000000000003], "episode_lengths": [452, 500, 40, 108, 500, 36, 78, 500, 500, 154, 406, 66, 86, 500, 126, 420, 214, 54, 66, 500, 500, 500, 48, 500, 58, 500, 84, 86, 60, 500, 46, 114, 74, 460, 500, 68, 50, 52, 500, 394, 500, 500, 50, 500, 58, 72, 362, 86, 74, 482, 240, 500, 500, 436, 500, 500, 500, 500, 500, 60, 500, 108, 500, 66, 372, 62, 222, 114, 78, 40, 62, 222, 500, 62, 100, 500, 500, 74, 52, 104, 158, 72, 126, 500, 500, 376, 78, 166, 66, 104, 102, 114, 500, 56, 166, 250, 46, 110, 126, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391734187598415, "mean_inference_ms": 1.7260104877313096, "mean_action_processing_ms": 0.20651290257126714, "mean_env_wait_ms": 0.12641577156818096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03264307975769043, "StateBufferConnector_ms": 0.012000083923339844, "ViewRequirementAgentConnector_ms": 0.17836260795593262}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.270999999999837, "episode_len_mean": 252.98, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.899999999999629, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 9.499999999999694, 43.50000000000001, 41.500000000000014, -50.00000000000044, 37.50000000000003, 8.099999999999675, 28.699999999999967, 44.7, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 41.500000000000014, 44.10000000000001, -50.00000000000044, 45.5, 38.700000000000024, 42.70000000000001, 4.099999999999618, -50.00000000000044, 43.30000000000001, 45.1, 44.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 42.900000000000006, 13.899999999999757, 41.500000000000014, 42.70000000000001, 1.8999999999995865, 26.09999999999993, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, 12.899999999999743, 43.900000000000006, 27.899999999999956, 38.700000000000024, 42.30000000000001, 46.099999999999994, 43.900000000000006, 27.899999999999956, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, 39.70000000000002, 34.30000000000004, 42.900000000000006, 37.50000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 42.30000000000001, 33.500000000000036, 43.50000000000001, 39.70000000000002, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.5, 33.500000000000036, 25.099999999999916, 45.5, 39.10000000000002, 37.50000000000003, 37.70000000000003], "episode_lengths": [452, 500, 40, 108, 500, 36, 78, 500, 500, 154, 406, 66, 86, 500, 126, 420, 214, 54, 66, 500, 500, 500, 48, 500, 58, 500, 84, 86, 60, 500, 46, 114, 74, 460, 500, 68, 50, 52, 500, 394, 500, 500, 50, 500, 58, 72, 362, 86, 74, 482, 240, 500, 500, 436, 500, 500, 500, 500, 500, 60, 500, 108, 500, 66, 372, 62, 222, 114, 78, 40, 62, 222, 500, 62, 100, 500, 500, 74, 52, 104, 158, 72, 126, 500, 500, 376, 78, 166, 66, 104, 102, 114, 500, 56, 166, 250, 46, 110, 126, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391734187598415, "mean_inference_ms": 1.7260104877313096, "mean_action_processing_ms": 0.20651290257126714, "mean_env_wait_ms": 0.12641577156818096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03264307975769043, "StateBufferConnector_ms": 0.012000083923339844, "ViewRequirementAgentConnector_ms": 0.17836260795593262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5183.277171846118, "num_env_steps_trained_throughput_per_sec": 5183.277171846118, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 3225.799, "sample_time_ms": 2764.65, "load_time_ms": 27.555, "load_throughput": 435497.726, "learn_time_ms": 415.723, "learn_throughput": 28865.395, "synch_weights_time_ms": 16.32}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 832, "training_iteration": 19, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-04", "timestamp": 1698246724, "time_this_iter_s": 2.320136070251465, "time_total_s": 61.51506757736206, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.51506757736206, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.30000000000001, "ram_util_percent": 29.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.288294050428602, "policy_loss": -0.00023419948087798225, "vf_loss": 6.288584020402697, "vf_explained_var": 3.039836883544922e-06, "kl": 0.0002797743864435789, "entropy": 0.5582224958472781, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 351.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.037999999999806, "episode_len_mean": 280.24, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 44.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 42.900000000000006, 13.899999999999757, 41.500000000000014, 42.70000000000001, 1.8999999999995865, 26.09999999999993, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, 12.899999999999743, 43.900000000000006, 27.899999999999956, 38.700000000000024, 42.30000000000001, 46.099999999999994, 43.900000000000006, 27.899999999999956, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, 39.70000000000002, 34.30000000000004, 42.900000000000006, 37.50000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 42.30000000000001, 33.500000000000036, 43.50000000000001, 39.70000000000002, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.5, 33.500000000000036, 25.099999999999916, 45.5, 39.10000000000002, 37.50000000000003, 37.70000000000003, -50.00000000000044, 7.09999999999966, 40.90000000000002, 37.90000000000003, 45.9, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 15.49999999999978, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 12.69999999999974, 46.5], "episode_lengths": [50, 52, 500, 394, 500, 500, 50, 500, 58, 72, 362, 86, 74, 482, 240, 500, 500, 436, 500, 500, 500, 500, 500, 60, 500, 108, 500, 66, 372, 62, 222, 114, 78, 40, 62, 222, 500, 62, 100, 500, 500, 74, 52, 104, 158, 72, 126, 500, 500, 376, 78, 166, 66, 104, 102, 114, 500, 56, 166, 250, 46, 110, 126, 124, 500, 430, 92, 122, 42, 48, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 404, 500, 500, 346, 48, 500, 68, 500, 184, 500, 176, 500, 80, 48, 500, 80, 500, 374, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347466040957785, "mean_inference_ms": 1.7099413523860831, "mean_action_processing_ms": 0.20396850519683798, "mean_env_wait_ms": 0.12478494965113704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03227853775024414, "StateBufferConnector_ms": 0.008005857467651367, "ViewRequirementAgentConnector_ms": 0.13241195678710938}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.037999999999806, "episode_len_mean": 280.24, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 44.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 42.900000000000006, 13.899999999999757, 41.500000000000014, 42.70000000000001, 1.8999999999995865, 26.09999999999993, -50.00000000000044, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.50000000000001, 12.899999999999743, 43.900000000000006, 27.899999999999956, 38.700000000000024, 42.30000000000001, 46.099999999999994, 43.900000000000006, 27.899999999999956, -50.00000000000044, 43.900000000000006, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, 39.70000000000002, 34.30000000000004, 42.900000000000006, 37.50000000000003, -50.00000000000044, -50.00000000000044, 12.499999999999737, 42.30000000000001, 33.500000000000036, 43.50000000000001, 39.70000000000002, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.5, 33.500000000000036, 25.099999999999916, 45.5, 39.10000000000002, 37.50000000000003, 37.70000000000003, -50.00000000000044, 7.09999999999966, 40.90000000000002, 37.90000000000003, 45.9, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 15.49999999999978, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 12.69999999999974, 46.5], "episode_lengths": [50, 52, 500, 394, 500, 500, 50, 500, 58, 72, 362, 86, 74, 482, 240, 500, 500, 436, 500, 500, 500, 500, 500, 60, 500, 108, 500, 66, 372, 62, 222, 114, 78, 40, 62, 222, 500, 62, 100, 500, 500, 74, 52, 104, 158, 72, 126, 500, 500, 376, 78, 166, 66, 104, 102, 114, 500, 56, 166, 250, 46, 110, 126, 124, 500, 430, 92, 122, 42, 48, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 404, 500, 500, 346, 48, 500, 68, 500, 184, 500, 176, 500, 80, 48, 500, 80, 500, 374, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347466040957785, "mean_inference_ms": 1.7099413523860831, "mean_action_processing_ms": 0.20396850519683798, "mean_env_wait_ms": 0.12478494965113704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03227853775024414, "StateBufferConnector_ms": 0.008005857467651367, "ViewRequirementAgentConnector_ms": 0.13241195678710938}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5935.189569030669, "num_env_steps_trained_throughput_per_sec": 5935.189569030669, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 3116.368, "sample_time_ms": 2688.251, "load_time_ms": 25.357, "load_throughput": 473242.399, "learn_time_ms": 385.792, "learn_throughput": 31104.818, "synch_weights_time_ms": 15.516}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 868, "training_iteration": 20, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-06", "timestamp": 1698246726, "time_this_iter_s": 2.026841402053833, "time_total_s": 63.541908979415894, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.541908979415894, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.948677645789252, "policy_loss": 8.760227097405327e-05, "vf_loss": 6.948646492428249, "vf_explained_var": 2.3179584079318576e-07, "kl": 0.00011003332694296357, "entropy": 0.5646006895436181, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 369.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.914999999999819, "episode_len_mean": 266.48, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.5, 33.500000000000036, 25.099999999999916, 45.5, 39.10000000000002, 37.50000000000003, 37.70000000000003, -50.00000000000044, 7.09999999999966, 40.90000000000002, 37.90000000000003, 45.9, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 15.49999999999978, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 12.69999999999974, 46.5, 43.50000000000001, 42.500000000000014, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, 45.3, 45.1, 31.900000000000013, 27.099999999999945, 43.10000000000001, 23.699999999999896, 45.3, -50.00000000000044, 17.499999999999808, 47.5, 45.9, 46.699999999999996, 17.299999999999805, 26.499999999999936, -50.00000000000044, -50.00000000000044, 46.3, 18.699999999999825, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.10000000000001, 40.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 42.900000000000006, 39.90000000000002, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 42.70000000000001, 41.90000000000001, 31.300000000000004, 44.7, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [104, 102, 114, 500, 56, 166, 250, 46, 110, 126, 124, 500, 430, 92, 122, 42, 48, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 404, 500, 500, 346, 48, 500, 68, 500, 184, 500, 176, 500, 80, 48, 500, 80, 500, 374, 36, 66, 76, 500, 38, 52, 500, 48, 50, 182, 230, 70, 264, 48, 500, 326, 26, 42, 34, 328, 236, 500, 500, 38, 314, 500, 500, 126, 52, 500, 92, 60, 94, 500, 104, 500, 500, 408, 500, 72, 102, 180, 500, 500, 500, 60, 48, 74, 82, 188, 54, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247058532376031, "mean_inference_ms": 1.680266467611696, "mean_action_processing_ms": 0.20010739567448724, "mean_env_wait_ms": 0.12215070480450528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199244499206543, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.10663557052612305}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.914999999999819, "episode_len_mean": 266.48, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 39.90000000000002, 38.700000000000024, -50.00000000000044, 44.5, 33.500000000000036, 25.099999999999916, 45.5, 39.10000000000002, 37.50000000000003, 37.70000000000003, -50.00000000000044, 7.09999999999966, 40.90000000000002, 37.90000000000003, 45.9, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, -50.00000000000044, 15.49999999999978, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 42.10000000000001, 45.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 12.69999999999974, 46.5, 43.50000000000001, 42.500000000000014, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, 45.3, 45.1, 31.900000000000013, 27.099999999999945, 43.10000000000001, 23.699999999999896, 45.3, -50.00000000000044, 17.499999999999808, 47.5, 45.9, 46.699999999999996, 17.299999999999805, 26.499999999999936, -50.00000000000044, -50.00000000000044, 46.3, 18.699999999999825, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.10000000000001, 40.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 42.900000000000006, 39.90000000000002, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 42.70000000000001, 41.90000000000001, 31.300000000000004, 44.7, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [104, 102, 114, 500, 56, 166, 250, 46, 110, 126, 124, 500, 430, 92, 122, 42, 48, 500, 500, 500, 52, 500, 500, 500, 500, 500, 500, 500, 404, 500, 500, 346, 48, 500, 68, 500, 184, 500, 176, 500, 80, 48, 500, 80, 500, 374, 36, 66, 76, 500, 38, 52, 500, 48, 50, 182, 230, 70, 264, 48, 500, 326, 26, 42, 34, 328, 236, 500, 500, 38, 314, 500, 500, 126, 52, 500, 92, 60, 94, 500, 104, 500, 500, 408, 500, 72, 102, 180, 500, 500, 500, 60, 48, 74, 82, 188, 54, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247058532376031, "mean_inference_ms": 1.680266467611696, "mean_action_processing_ms": 0.20010739567448724, "mean_env_wait_ms": 0.12215070480450528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199244499206543, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.10663557052612305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5425.545104982963, "num_env_steps_trained_throughput_per_sec": 5425.545104982963, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3013.449, "sample_time_ms": 2609.897, "load_time_ms": 23.537, "load_throughput": 509841.947, "learn_time_ms": 363.924, "learn_throughput": 32973.902, "synch_weights_time_ms": 14.792}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 921, "training_iteration": 21, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-08", "timestamp": 1698246728, "time_this_iter_s": 2.21675705909729, "time_total_s": 65.75866603851318, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.75866603851318, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 60.53333333333333, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 7.005362590154012, "policy_loss": -0.0005724454919497172, "vf_loss": 7.005986796485053, "vf_explained_var": -4.6359168158637154e-08, "kl": 0.0007121704648645909, "entropy": 0.518450043267674, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 387.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.715999999999829, "episode_len_mean": 253.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 43.50000000000001, 42.500000000000014, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, 45.3, 45.1, 31.900000000000013, 27.099999999999945, 43.10000000000001, 23.699999999999896, 45.3, -50.00000000000044, 17.499999999999808, 47.5, 45.9, 46.699999999999996, 17.299999999999805, 26.499999999999936, -50.00000000000044, -50.00000000000044, 46.3, 18.699999999999825, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.10000000000001, 40.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 42.900000000000006, 39.90000000000002, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 42.70000000000001, 41.90000000000001, 31.300000000000004, 44.7, 44.5, -50.00000000000044, -50.00000000000044, 5.899999999999643, 43.7, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 34.70000000000004, 45.7, 43.10000000000001, 19.499999999999837, 43.50000000000001, 34.50000000000004, 44.7, 40.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 44.5, 43.30000000000001, 38.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 6.299999999999649, -50.00000000000044, 29.099999999999973, 43.7, 1.299999999999578, 0.09999999999956088, 10.899999999999714, -50.00000000000044, 45.3], "episode_lengths": [36, 66, 76, 500, 38, 52, 500, 48, 50, 182, 230, 70, 264, 48, 500, 326, 26, 42, 34, 328, 236, 500, 500, 38, 314, 500, 500, 126, 52, 500, 92, 60, 94, 500, 104, 500, 500, 408, 500, 72, 102, 180, 500, 500, 500, 60, 48, 74, 82, 188, 54, 56, 500, 500, 442, 64, 58, 82, 500, 500, 500, 500, 416, 500, 500, 500, 62, 82, 154, 44, 70, 306, 66, 156, 54, 96, 500, 62, 500, 74, 56, 68, 116, 42, 500, 500, 114, 500, 88, 500, 84, 438, 500, 210, 64, 488, 500, 392, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5165148683264976, "mean_inference_ms": 1.657823612547771, "mean_action_processing_ms": 0.19698150443579, "mean_env_wait_ms": 0.1198776788178511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001079559326172, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.11559844017028809}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.715999999999829, "episode_len_mean": 253.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 43.50000000000001, 42.500000000000014, -50.00000000000044, 46.3, 44.900000000000006, -50.00000000000044, 45.3, 45.1, 31.900000000000013, 27.099999999999945, 43.10000000000001, 23.699999999999896, 45.3, -50.00000000000044, 17.499999999999808, 47.5, 45.9, 46.699999999999996, 17.299999999999805, 26.499999999999936, -50.00000000000044, -50.00000000000044, 46.3, 18.699999999999825, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, 40.90000000000002, 44.10000000000001, 40.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 9.299999999999692, -50.00000000000044, 42.900000000000006, 39.90000000000002, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 42.70000000000001, 41.90000000000001, 31.300000000000004, 44.7, 44.5, -50.00000000000044, -50.00000000000044, 5.899999999999643, 43.7, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 34.70000000000004, 45.7, 43.10000000000001, 19.499999999999837, 43.50000000000001, 34.50000000000004, 44.7, 40.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 44.5, 43.30000000000001, 38.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 6.299999999999649, -50.00000000000044, 29.099999999999973, 43.7, 1.299999999999578, 0.09999999999956088, 10.899999999999714, -50.00000000000044, 45.3], "episode_lengths": [36, 66, 76, 500, 38, 52, 500, 48, 50, 182, 230, 70, 264, 48, 500, 326, 26, 42, 34, 328, 236, 500, 500, 38, 314, 500, 500, 126, 52, 500, 92, 60, 94, 500, 104, 500, 500, 408, 500, 72, 102, 180, 500, 500, 500, 60, 48, 74, 82, 188, 54, 56, 500, 500, 442, 64, 58, 82, 500, 500, 500, 500, 416, 500, 500, 500, 62, 82, 154, 44, 70, 306, 66, 156, 54, 96, 500, 62, 500, 74, 56, 68, 116, 42, 500, 500, 114, 500, 88, 500, 84, 438, 500, 210, 64, 488, 500, 392, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5165148683264976, "mean_inference_ms": 1.657823612547771, "mean_action_processing_ms": 0.19698150443579, "mean_env_wait_ms": 0.1198776788178511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001079559326172, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.11559844017028809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5489.656649743779, "num_env_steps_trained_throughput_per_sec": 5489.656649743779, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2919.885, "sample_time_ms": 2540.794, "load_time_ms": 22.141, "load_throughput": 541990.19, "learn_time_ms": 341.92, "learn_throughput": 35095.937, "synch_weights_time_ms": 13.731}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 967, "training_iteration": 22, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-11", "timestamp": 1698246731, "time_this_iter_s": 2.1911609172821045, "time_total_s": 67.94982695579529, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.94982695579529, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 58.166666666666664, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.323020882076687, "policy_loss": -0.000611037015914917, "vf_loss": 6.32368983162774, "vf_explained_var": 3.642506069607205e-08, "kl": 0.001638117947701782, "entropy": 0.577886700630188, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.504999999999808, "episode_len_mean": 270.58, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 42.70000000000001, 41.90000000000001, 31.300000000000004, 44.7, 44.5, -50.00000000000044, -50.00000000000044, 5.899999999999643, 43.7, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 34.70000000000004, 45.7, 43.10000000000001, 19.499999999999837, 43.50000000000001, 34.50000000000004, 44.7, 40.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 44.5, 43.30000000000001, 38.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 6.299999999999649, -50.00000000000044, 29.099999999999973, 43.7, 1.299999999999578, 0.09999999999956088, 10.899999999999714, -50.00000000000044, 45.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 12.499999999999737, 44.10000000000001, 34.900000000000034, 43.10000000000001, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 11.699999999999726, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 42.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.50000000000001, 45.9, 43.7, 41.90000000000001], "episode_lengths": [180, 500, 500, 500, 60, 48, 74, 82, 188, 54, 56, 500, 500, 442, 64, 58, 82, 500, 500, 500, 500, 416, 500, 500, 500, 62, 82, 154, 44, 70, 306, 66, 156, 54, 96, 500, 62, 500, 74, 56, 68, 116, 42, 500, 500, 114, 500, 88, 500, 84, 438, 500, 210, 64, 488, 500, 392, 500, 48, 500, 96, 500, 500, 56, 500, 80, 376, 60, 152, 70, 48, 500, 66, 500, 134, 500, 500, 500, 500, 62, 384, 500, 174, 500, 38, 72, 68, 500, 500, 42, 80, 500, 54, 500, 454, 500, 66, 42, 64, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.512261570876065, "mean_inference_ms": 1.6386171929926194, "mean_action_processing_ms": 0.19471053462744847, "mean_env_wait_ms": 0.11854210445796724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017790555953979492, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12101244926452637}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.504999999999808, "episode_len_mean": 270.58, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.3, 42.70000000000001, 41.90000000000001, 31.300000000000004, 44.7, 44.5, -50.00000000000044, -50.00000000000044, 5.899999999999643, 43.7, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 41.90000000000001, 34.70000000000004, 45.7, 43.10000000000001, 19.499999999999837, 43.50000000000001, 34.50000000000004, 44.7, 40.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.70000000000001, 44.5, 43.30000000000001, 38.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 6.299999999999649, -50.00000000000044, 29.099999999999973, 43.7, 1.299999999999578, 0.09999999999956088, 10.899999999999714, -50.00000000000044, 45.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 12.499999999999737, 44.10000000000001, 34.900000000000034, 43.10000000000001, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 11.699999999999726, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 42.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.50000000000001, 45.9, 43.7, 41.90000000000001], "episode_lengths": [180, 500, 500, 500, 60, 48, 74, 82, 188, 54, 56, 500, 500, 442, 64, 58, 82, 500, 500, 500, 500, 416, 500, 500, 500, 62, 82, 154, 44, 70, 306, 66, 156, 54, 96, 500, 62, 500, 74, 56, 68, 116, 42, 500, 500, 114, 500, 88, 500, 84, 438, 500, 210, 64, 488, 500, 392, 500, 48, 500, 96, 500, 500, 56, 500, 80, 376, 60, 152, 70, 48, 500, 66, 500, 134, 500, 500, 500, 500, 62, 384, 500, 174, 500, 38, 72, 68, 500, 500, 42, 80, 500, 54, 500, 454, 500, 66, 42, 64, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.512261570876065, "mean_inference_ms": 1.6386171929926194, "mean_action_processing_ms": 0.19471053462744847, "mean_env_wait_ms": 0.11854210445796724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017790555953979492, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12101244926452637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5847.122219208208, "num_env_steps_trained_throughput_per_sec": 5847.122219208208, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2784.214, "sample_time_ms": 2438.031, "load_time_ms": 19.943, "load_throughput": 601699.815, "learn_time_ms": 311.908, "learn_throughput": 38472.932, "synch_weights_time_ms": 12.933}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1008, "training_iteration": 23, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-13", "timestamp": 1698246733, "time_this_iter_s": 2.0572903156280518, "time_total_s": 70.00711727142334, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.00711727142334, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.334522088368733, "policy_loss": 1.8074138400455315e-05, "vf_loss": 6.334555096096462, "vf_explained_var": 9.437402089436849e-07, "kl": 0.00023022763873667727, "entropy": 0.5119034565157361, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 423.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9029999999997922, "episode_len_mean": 286.56, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 6.299999999999649, -50.00000000000044, 29.099999999999973, 43.7, 1.299999999999578, 0.09999999999956088, 10.899999999999714, -50.00000000000044, 45.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 12.499999999999737, 44.10000000000001, 34.900000000000034, 43.10000000000001, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 11.699999999999726, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 42.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.50000000000001, 45.9, 43.7, 41.90000000000001, 32.30000000000002, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.500000000000014, 14.09999999999976, 37.10000000000003, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.300000000000026, -50.00000000000044, 25.099999999999916, 44.5, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 46.3, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 38.50000000000003, 36.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044], "episode_lengths": [116, 42, 500, 500, 114, 500, 88, 500, 84, 438, 500, 210, 64, 488, 500, 392, 500, 48, 500, 96, 500, 500, 56, 500, 80, 376, 60, 152, 70, 48, 500, 66, 500, 134, 500, 500, 500, 500, 62, 384, 500, 174, 500, 38, 72, 68, 500, 500, 42, 80, 500, 54, 500, 454, 500, 66, 42, 64, 82, 178, 40, 500, 82, 500, 86, 360, 130, 500, 144, 500, 500, 500, 66, 118, 500, 250, 56, 34, 500, 56, 500, 500, 386, 38, 46, 104, 500, 500, 500, 66, 500, 76, 500, 116, 138, 500, 50, 500, 132, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5075701093630021, "mean_inference_ms": 1.6212458794919025, "mean_action_processing_ms": 0.1931924978756109, "mean_env_wait_ms": 0.11707951471358484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017563581466674805, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.13222360610961914}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9029999999997922, "episode_len_mean": 286.56, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 45.9, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.70000000000002, 6.299999999999649, -50.00000000000044, 29.099999999999973, 43.7, 1.299999999999578, 0.09999999999956088, 10.899999999999714, -50.00000000000044, 45.3, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 12.499999999999737, 44.10000000000001, 34.900000000000034, 43.10000000000001, 45.3, -50.00000000000044, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 11.699999999999726, -50.00000000000044, 32.700000000000024, -50.00000000000044, 46.3, 42.900000000000006, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.50000000000001, 45.9, 43.7, 41.90000000000001, 32.30000000000002, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.500000000000014, 14.09999999999976, 37.10000000000003, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.300000000000026, -50.00000000000044, 25.099999999999916, 44.5, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 46.3, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 38.50000000000003, 36.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044], "episode_lengths": [116, 42, 500, 500, 114, 500, 88, 500, 84, 438, 500, 210, 64, 488, 500, 392, 500, 48, 500, 96, 500, 500, 56, 500, 80, 376, 60, 152, 70, 48, 500, 66, 500, 134, 500, 500, 500, 500, 62, 384, 500, 174, 500, 38, 72, 68, 500, 500, 42, 80, 500, 54, 500, 454, 500, 66, 42, 64, 82, 178, 40, 500, 82, 500, 86, 360, 130, 500, 144, 500, 500, 500, 66, 118, 500, 250, 56, 34, 500, 56, 500, 500, 386, 38, 46, 104, 500, 500, 500, 66, 500, 76, 500, 116, 138, 500, 50, 500, 132, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5075701093630021, "mean_inference_ms": 1.6212458794919025, "mean_action_processing_ms": 0.1931924978756109, "mean_env_wait_ms": 0.11707951471358484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017563581466674805, "StateBufferConnector_ms": 0.0039980411529541016, "ViewRequirementAgentConnector_ms": 0.13222360610961914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5513.667707944899, "num_env_steps_trained_throughput_per_sec": 5513.667707944899, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2604.325, "sample_time_ms": 2277.0, "load_time_ms": 18.615, "load_throughput": 644640.336, "learn_time_ms": 294.995, "learn_throughput": 40678.626, "synch_weights_time_ms": 12.217}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1049, "training_iteration": 24, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-15", "timestamp": 1698246735, "time_this_iter_s": 2.181407928466797, "time_total_s": 72.18852519989014, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.18852519989014, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 61.36666666666667, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.309321641921997, "policy_loss": -0.00046024471521377563, "vf_loss": 6.309832361009386, "vf_explained_var": -1.4967388576931423e-06, "kl": 0.0004087208628157492, "entropy": 0.5065470669004652, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 441.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3209999999998114, "episode_len_mean": 272.38, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.50000000000001, 45.9, 43.7, 41.90000000000001, 32.30000000000002, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.500000000000014, 14.09999999999976, 37.10000000000003, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.300000000000026, -50.00000000000044, 25.099999999999916, 44.5, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 46.3, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 38.50000000000003, 36.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, 45.1, -50.00000000000044, 40.500000000000014, 11.699999999999726, -50.00000000000044, 43.30000000000001, 39.90000000000002, 44.10000000000001, 24.499999999999908, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.3, 46.699999999999996, -50.00000000000044, 31.1, 29.299999999999976, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 35.70000000000003], "episode_lengths": [68, 500, 500, 42, 80, 500, 54, 500, 454, 500, 66, 42, 64, 82, 178, 40, 500, 82, 500, 86, 360, 130, 500, 144, 500, 500, 500, 66, 118, 500, 250, 56, 34, 500, 56, 500, 500, 386, 38, 46, 104, 500, 500, 500, 66, 500, 76, 500, 116, 138, 500, 50, 500, 132, 500, 500, 500, 110, 56, 70, 500, 500, 500, 86, 152, 50, 500, 96, 384, 500, 68, 102, 60, 256, 500, 500, 48, 88, 500, 94, 500, 86, 64, 500, 500, 206, 48, 34, 500, 190, 208, 500, 102, 500, 148, 500, 44, 40, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5011229932481036, "mean_inference_ms": 1.600565109603241, "mean_action_processing_ms": 0.19063099586461124, "mean_env_wait_ms": 0.11551985555719209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020417213439941406, "StateBufferConnector_ms": 0.0050122737884521484, "ViewRequirementAgentConnector_ms": 0.13703060150146484}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3209999999998114, "episode_len_mean": 272.38, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, 4.699999999999626, -50.00000000000044, 43.50000000000001, 45.9, 43.7, 41.90000000000001, 32.30000000000002, 46.099999999999994, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.500000000000014, 14.09999999999976, 37.10000000000003, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.300000000000026, -50.00000000000044, 25.099999999999916, 44.5, 46.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 11.499999999999723, 46.3, 45.5, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 38.50000000000003, 36.30000000000003, -50.00000000000044, 45.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, 45.1, -50.00000000000044, 40.500000000000014, 11.699999999999726, -50.00000000000044, 43.30000000000001, 39.90000000000002, 44.10000000000001, 24.499999999999908, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.3, 46.699999999999996, -50.00000000000044, 31.1, 29.299999999999976, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 35.70000000000003], "episode_lengths": [68, 500, 500, 42, 80, 500, 54, 500, 454, 500, 66, 42, 64, 82, 178, 40, 500, 82, 500, 86, 360, 130, 500, 144, 500, 500, 500, 66, 118, 500, 250, 56, 34, 500, 56, 500, 500, 386, 38, 46, 104, 500, 500, 500, 66, 500, 76, 500, 116, 138, 500, 50, 500, 132, 500, 500, 500, 110, 56, 70, 500, 500, 500, 86, 152, 50, 500, 96, 384, 500, 68, 102, 60, 256, 500, 500, 48, 88, 500, 94, 500, 86, 64, 500, 500, 206, 48, 34, 500, 190, 208, 500, 102, 500, 148, 500, 44, 40, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5011229932481036, "mean_inference_ms": 1.600565109603241, "mean_action_processing_ms": 0.19063099586461124, "mean_env_wait_ms": 0.11551985555719209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020417213439941406, "StateBufferConnector_ms": 0.0050122737884521484, "ViewRequirementAgentConnector_ms": 0.13703060150146484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5670.275222970386, "num_env_steps_trained_throughput_per_sec": 5670.275222970386, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2486.535, "sample_time_ms": 2193.274, "load_time_ms": 16.795, "load_throughput": 714502.782, "learn_time_ms": 264.147, "learn_throughput": 45429.332, "synch_weights_time_ms": 10.918}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1094, "training_iteration": 25, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-17", "timestamp": 1698246737, "time_this_iter_s": 2.121258020401001, "time_total_s": 74.30978322029114, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.30978322029114, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 57.63333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 7.224912722905477, "policy_loss": 1.7732899222109052e-05, "vf_loss": 7.224952777226766, "vf_explained_var": -1.1987156338161892e-06, "kl": 0.0004993055121044816, "entropy": 0.5782963964674208, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 459.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.720999999999833, "episode_len_mean": 258.44, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, 45.1, -50.00000000000044, 40.500000000000014, 11.699999999999726, -50.00000000000044, 43.30000000000001, 39.90000000000002, 44.10000000000001, 24.499999999999908, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.3, 46.699999999999996, -50.00000000000044, 31.1, 29.299999999999976, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 35.70000000000003, -50.00000000000044, 37.50000000000003, 42.900000000000006, 42.70000000000001, 14.899999999999771, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 44.7, 27.099999999999945, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 32.100000000000016, 20.099999999999845, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 32.30000000000002, 42.900000000000006, 43.7, -50.00000000000044, 32.100000000000016, -50.00000000000044, 17.69999999999981, 36.70000000000003, 35.900000000000034, 46.699999999999996, 43.30000000000001, 42.500000000000014, 17.099999999999802, -50.00000000000044, 43.900000000000006, 25.29999999999992, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 13.899999999999757, 25.499999999999922, 28.09999999999996, 43.900000000000006, 42.30000000000001], "episode_lengths": [500, 132, 500, 500, 500, 110, 56, 70, 500, 500, 500, 86, 152, 50, 500, 96, 384, 500, 68, 102, 60, 256, 500, 500, 48, 88, 500, 94, 500, 86, 64, 500, 500, 206, 48, 34, 500, 190, 208, 500, 102, 500, 148, 500, 44, 40, 500, 144, 500, 126, 72, 74, 352, 48, 68, 500, 500, 66, 148, 500, 54, 230, 72, 500, 500, 44, 180, 300, 94, 500, 114, 500, 178, 72, 64, 500, 180, 500, 324, 134, 142, 34, 68, 76, 330, 500, 62, 248, 500, 76, 500, 150, 500, 500, 30, 362, 246, 220, 62, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4949722504036126, "mean_inference_ms": 1.581008187849012, "mean_action_processing_ms": 0.18806539607910422, "mean_env_wait_ms": 0.11357455139864785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026630878448486328, "StateBufferConnector_ms": 0.0050122737884521484, "ViewRequirementAgentConnector_ms": 0.12074089050292969}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.720999999999833, "episode_len_mean": 258.44, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 34.900000000000034, 45.1, -50.00000000000044, 40.500000000000014, 11.699999999999726, -50.00000000000044, 43.30000000000001, 39.90000000000002, 44.10000000000001, 24.499999999999908, -50.00000000000044, -50.00000000000044, 45.3, 41.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 29.49999999999998, 45.3, 46.699999999999996, -50.00000000000044, 31.1, 29.299999999999976, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 35.70000000000003, -50.00000000000044, 37.50000000000003, 42.900000000000006, 42.70000000000001, 14.899999999999771, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 44.7, 27.099999999999945, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 32.100000000000016, 20.099999999999845, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 32.30000000000002, 42.900000000000006, 43.7, -50.00000000000044, 32.100000000000016, -50.00000000000044, 17.69999999999981, 36.70000000000003, 35.900000000000034, 46.699999999999996, 43.30000000000001, 42.500000000000014, 17.099999999999802, -50.00000000000044, 43.900000000000006, 25.29999999999992, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 13.899999999999757, 25.499999999999922, 28.09999999999996, 43.900000000000006, 42.30000000000001], "episode_lengths": [500, 132, 500, 500, 500, 110, 56, 70, 500, 500, 500, 86, 152, 50, 500, 96, 384, 500, 68, 102, 60, 256, 500, 500, 48, 88, 500, 94, 500, 86, 64, 500, 500, 206, 48, 34, 500, 190, 208, 500, 102, 500, 148, 500, 44, 40, 500, 144, 500, 126, 72, 74, 352, 48, 68, 500, 500, 66, 148, 500, 54, 230, 72, 500, 500, 44, 180, 300, 94, 500, 114, 500, 178, 72, 64, 500, 180, 500, 324, 134, 142, 34, 68, 76, 330, 500, 62, 248, 500, 76, 500, 150, 500, 500, 30, 362, 246, 220, 62, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4949722504036126, "mean_inference_ms": 1.581008187849012, "mean_action_processing_ms": 0.18806539607910422, "mean_env_wait_ms": 0.11357455139864785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026630878448486328, "StateBufferConnector_ms": 0.0050122737884521484, "ViewRequirementAgentConnector_ms": 0.12074089050292969}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5777.591919304159, "num_env_steps_trained_throughput_per_sec": 5777.591919304159, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2344.574, "sample_time_ms": 2079.277, "load_time_ms": 14.432, "load_throughput": 831466.293, "learn_time_ms": 238.948, "learn_throughput": 50220.204, "synch_weights_time_ms": 10.315}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1146, "training_iteration": 26, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-19", "timestamp": 1698246739, "time_this_iter_s": 2.0819876194000244, "time_total_s": 76.39177083969116, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.39177083969116, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 58.300000000000004, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.411765840318468, "policy_loss": -0.000327874802880817, "vf_loss": 6.412148925993177, "vf_explained_var": -7.682376437717014e-07, "kl": 0.000212102706124521, "entropy": 0.5532953209347196, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 477.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.1759999999998305, "episode_len_mean": 258.9, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 35.70000000000003, -50.00000000000044, 37.50000000000003, 42.900000000000006, 42.70000000000001, 14.899999999999771, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 44.7, 27.099999999999945, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 32.100000000000016, 20.099999999999845, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 32.30000000000002, 42.900000000000006, 43.7, -50.00000000000044, 32.100000000000016, -50.00000000000044, 17.69999999999981, 36.70000000000003, 35.900000000000034, 46.699999999999996, 43.30000000000001, 42.500000000000014, 17.099999999999802, -50.00000000000044, 43.900000000000006, 25.29999999999992, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 13.899999999999757, 25.499999999999922, 28.09999999999996, 43.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 42.900000000000006, -50.00000000000044, 2.299999999999592, -50.00000000000044, 40.70000000000002, 46.3, 40.500000000000014, -50.00000000000044, 21.499999999999865, 44.10000000000001, 45.5, 29.69999999999998, 34.10000000000004, 45.7, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 42.70000000000001, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575], "episode_lengths": [500, 148, 500, 44, 40, 500, 144, 500, 126, 72, 74, 352, 48, 68, 500, 500, 66, 148, 500, 54, 230, 72, 500, 500, 44, 180, 300, 94, 500, 114, 500, 178, 72, 64, 500, 180, 500, 324, 134, 142, 34, 68, 76, 330, 500, 62, 248, 500, 76, 500, 150, 500, 500, 30, 362, 246, 220, 62, 78, 500, 46, 30, 500, 74, 500, 500, 82, 500, 500, 152, 66, 500, 34, 60, 72, 500, 478, 500, 94, 38, 96, 500, 286, 60, 46, 204, 160, 44, 98, 78, 500, 500, 284, 500, 74, 190, 500, 500, 500, 490]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4908583087505678, "mean_inference_ms": 1.5681952986991354, "mean_action_processing_ms": 0.18640100506213897, "mean_env_wait_ms": 0.11254669759349627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021979570388793945, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.11910772323608398}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.1759999999998305, "episode_len_mean": 258.9, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.30000000000004, -50.00000000000044, 45.7, 46.099999999999994, -50.00000000000044, 35.70000000000003, -50.00000000000044, 37.50000000000003, 42.900000000000006, 42.70000000000001, 14.899999999999771, 45.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 44.7, 27.099999999999945, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 32.100000000000016, 20.099999999999845, 40.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 32.30000000000002, 42.900000000000006, 43.7, -50.00000000000044, 32.100000000000016, -50.00000000000044, 17.69999999999981, 36.70000000000003, 35.900000000000034, 46.699999999999996, 43.30000000000001, 42.500000000000014, 17.099999999999802, -50.00000000000044, 43.900000000000006, 25.29999999999992, -50.00000000000044, 42.500000000000014, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 47.1, 13.899999999999757, 25.499999999999922, 28.09999999999996, 43.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 42.900000000000006, -50.00000000000044, 2.299999999999592, -50.00000000000044, 40.70000000000002, 46.3, 40.500000000000014, -50.00000000000044, 21.499999999999865, 44.10000000000001, 45.5, 29.69999999999998, 34.10000000000004, 45.7, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 42.70000000000001, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575], "episode_lengths": [500, 148, 500, 44, 40, 500, 144, 500, 126, 72, 74, 352, 48, 68, 500, 500, 66, 148, 500, 54, 230, 72, 500, 500, 44, 180, 300, 94, 500, 114, 500, 178, 72, 64, 500, 180, 500, 324, 134, 142, 34, 68, 76, 330, 500, 62, 248, 500, 76, 500, 150, 500, 500, 30, 362, 246, 220, 62, 78, 500, 46, 30, 500, 74, 500, 500, 82, 500, 500, 152, 66, 500, 34, 60, 72, 500, 478, 500, 94, 38, 96, 500, 286, 60, 46, 204, 160, 44, 98, 78, 500, 500, 284, 500, 74, 190, 500, 500, 500, 490]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4908583087505678, "mean_inference_ms": 1.5681952986991354, "mean_action_processing_ms": 0.18640100506213897, "mean_env_wait_ms": 0.11254669759349627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021979570388793945, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.11910772323608398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5477.380346065948, "num_env_steps_trained_throughput_per_sec": 5477.380346065948, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2238.44, "sample_time_ms": 1996.974, "load_time_ms": 12.195, "load_throughput": 984035.567, "learn_time_ms": 218.091, "learn_throughput": 55022.937, "synch_weights_time_ms": 9.478}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1187, "training_iteration": 27, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-21", "timestamp": 1698246741, "time_this_iter_s": 2.1958272457122803, "time_total_s": 78.58759808540344, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.58759808540344, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.764848417705959, "policy_loss": -2.943683001730177e-05, "vf_loss": 6.76492895020379, "vf_explained_var": -2.3179584079318575e-06, "kl": 8.684406718215441e-05, "entropy": 0.5109666734933853, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.555999999999828, "episode_len_mean": 255.1, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 13.899999999999757, 25.499999999999922, 28.09999999999996, 43.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 42.900000000000006, -50.00000000000044, 2.299999999999592, -50.00000000000044, 40.70000000000002, 46.3, 40.500000000000014, -50.00000000000044, 21.499999999999865, 44.10000000000001, 45.5, 29.69999999999998, 34.10000000000004, 45.7, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 42.70000000000001, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 45.1, 36.50000000000003, -50.00000000000044, 47.1, 41.70000000000002, 43.50000000000001, 40.500000000000014, 43.900000000000006, -50.00000000000044, 2.499999999999595, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 17.499999999999808, 43.50000000000001, 28.499999999999964, 16.29999999999979, 41.100000000000016, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.90000000000001, 43.50000000000001, 47.1, 27.099999999999945, 23.8999999999999, 44.7, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.699999999999996], "episode_lengths": [500, 500, 30, 362, 246, 220, 62, 78, 500, 46, 30, 500, 74, 500, 500, 82, 500, 500, 152, 66, 500, 34, 60, 72, 500, 478, 500, 94, 38, 96, 500, 286, 60, 46, 204, 160, 44, 98, 78, 500, 500, 284, 500, 74, 190, 500, 500, 500, 490, 500, 114, 500, 130, 50, 136, 500, 30, 84, 66, 96, 62, 500, 476, 78, 34, 500, 500, 326, 66, 216, 338, 90, 500, 500, 242, 500, 54, 500, 50, 34, 500, 500, 128, 82, 66, 30, 230, 262, 54, 500, 500, 54, 34, 62, 230, 500, 500, 76, 62, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48623059541842667, "mean_inference_ms": 1.5534904583131357, "mean_action_processing_ms": 0.18445230985381664, "mean_env_wait_ms": 0.11135862001797601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029024839401245117, "StateBufferConnector_ms": 0.005011081695556641, "ViewRequirementAgentConnector_ms": 0.10568690299987793}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.555999999999828, "episode_len_mean": 255.1, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 47.1, 13.899999999999757, 25.499999999999922, 28.09999999999996, 43.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, 47.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.50000000000001, -50.00000000000044, 46.699999999999996, 44.10000000000001, 42.900000000000006, -50.00000000000044, 2.299999999999592, -50.00000000000044, 40.70000000000002, 46.3, 40.500000000000014, -50.00000000000044, 21.499999999999865, 44.10000000000001, 45.5, 29.69999999999998, 34.10000000000004, 45.7, 40.30000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 42.70000000000001, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 45.1, 36.50000000000003, -50.00000000000044, 47.1, 41.70000000000002, 43.50000000000001, 40.500000000000014, 43.900000000000006, -50.00000000000044, 2.499999999999595, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 17.499999999999808, 43.50000000000001, 28.499999999999964, 16.29999999999979, 41.100000000000016, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.90000000000001, 43.50000000000001, 47.1, 27.099999999999945, 23.8999999999999, 44.7, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.699999999999996], "episode_lengths": [500, 500, 30, 362, 246, 220, 62, 78, 500, 46, 30, 500, 74, 500, 500, 82, 500, 500, 152, 66, 500, 34, 60, 72, 500, 478, 500, 94, 38, 96, 500, 286, 60, 46, 204, 160, 44, 98, 78, 500, 500, 284, 500, 74, 190, 500, 500, 500, 490, 500, 114, 500, 130, 50, 136, 500, 30, 84, 66, 96, 62, 500, 476, 78, 34, 500, 500, 326, 66, 216, 338, 90, 500, 500, 242, 500, 54, 500, 50, 34, 500, 500, 128, 82, 66, 30, 230, 262, 54, 500, 500, 54, 34, 62, 230, 500, 500, 76, 62, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48623059541842667, "mean_inference_ms": 1.5534904583131357, "mean_action_processing_ms": 0.18445230985381664, "mean_env_wait_ms": 0.11135862001797601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029024839401245117, "StateBufferConnector_ms": 0.005011081695556641, "ViewRequirementAgentConnector_ms": 0.10568690299987793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.258048916083, "num_env_steps_trained_throughput_per_sec": 5354.258048916083, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2158.869, "sample_time_ms": 1909.881, "load_time_ms": 10.599, "load_throughput": 1132231.388, "learn_time_ms": 227.54, "learn_throughput": 52737.987, "synch_weights_time_ms": 9.347}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1238, "training_iteration": 28, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-24", "timestamp": 1698246744, "time_this_iter_s": 2.2462058067321777, "time_total_s": 80.83380389213562, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.83380389213562, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 56.833333333333336, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.959988647037083, "policy_loss": -0.0001802858379152086, "vf_loss": 6.960222880045573, "vf_explained_var": -9.006924099392361e-07, "kl": 0.00032469885937302934, "entropy": 0.5376941098107232, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 513.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.549999999999829, "episode_len_mean": 255.16, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 45.1, 36.50000000000003, -50.00000000000044, 47.1, 41.70000000000002, 43.50000000000001, 40.500000000000014, 43.900000000000006, -50.00000000000044, 2.499999999999595, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 17.499999999999808, 43.50000000000001, 28.499999999999964, 16.29999999999979, 41.100000000000016, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.90000000000001, 43.50000000000001, 47.1, 27.099999999999945, 23.8999999999999, 44.7, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.699999999999996, 46.699999999999996, -50.00000000000044, 35.30000000000004, 44.10000000000001, 39.300000000000026, 44.10000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 31.1, 32.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, 45.1, 45.7, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 35.70000000000003, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, 43.30000000000001, 38.10000000000002, 11.699999999999726, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 0.09999999999956088, 36.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 490, 500, 114, 500, 130, 50, 136, 500, 30, 84, 66, 96, 62, 500, 476, 78, 34, 500, 500, 326, 66, 216, 338, 90, 500, 500, 242, 500, 54, 500, 50, 34, 500, 500, 128, 82, 66, 30, 230, 262, 54, 500, 500, 54, 34, 62, 230, 500, 500, 76, 62, 34, 34, 500, 148, 60, 108, 60, 66, 500, 104, 190, 174, 74, 500, 500, 56, 258, 50, 44, 266, 36, 500, 500, 500, 72, 500, 500, 66, 98, 144, 500, 92, 46, 500, 68, 120, 384, 90, 500, 500, 500, 102, 500, 500, 136, 204, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48184001991715436, "mean_inference_ms": 1.5428044854112288, "mean_action_processing_ms": 0.1836351609726884, "mean_env_wait_ms": 0.11037420049128141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02507925033569336, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.08954405784606934}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.549999999999829, "episode_len_mean": 255.16, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, -50.00000000000044, 38.700000000000024, -50.00000000000044, 37.10000000000003, 45.1, 36.50000000000003, -50.00000000000044, 47.1, 41.70000000000002, 43.50000000000001, 40.500000000000014, 43.900000000000006, -50.00000000000044, 2.499999999999595, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 17.499999999999808, 43.50000000000001, 28.499999999999964, 16.29999999999979, 41.100000000000016, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.300000000000026, 41.90000000000001, 43.50000000000001, 47.1, 27.099999999999945, 23.8999999999999, 44.7, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.699999999999996, 46.699999999999996, -50.00000000000044, 35.30000000000004, 44.10000000000001, 39.300000000000026, 44.10000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 31.1, 32.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, 45.1, 45.7, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 35.70000000000003, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, 43.30000000000001, 38.10000000000002, 11.699999999999726, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 0.09999999999956088, 36.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 490, 500, 114, 500, 130, 50, 136, 500, 30, 84, 66, 96, 62, 500, 476, 78, 34, 500, 500, 326, 66, 216, 338, 90, 500, 500, 242, 500, 54, 500, 50, 34, 500, 500, 128, 82, 66, 30, 230, 262, 54, 500, 500, 54, 34, 62, 230, 500, 500, 76, 62, 34, 34, 500, 148, 60, 108, 60, 66, 500, 104, 190, 174, 74, 500, 500, 56, 258, 50, 44, 266, 36, 500, 500, 500, 72, 500, 500, 66, 98, 144, 500, 92, 46, 500, 68, 120, 384, 90, 500, 500, 500, 102, 500, 500, 136, 204, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48184001991715436, "mean_inference_ms": 1.5428044854112288, "mean_action_processing_ms": 0.1836351609726884, "mean_env_wait_ms": 0.11037420049128141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02507925033569336, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.08954405784606934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5500.595504937696, "num_env_steps_trained_throughput_per_sec": 5500.595504937696, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2145.514, "sample_time_ms": 1892.736, "load_time_ms": 10.601, "load_throughput": 1131951.287, "learn_time_ms": 231.23, "learn_throughput": 51896.376, "synch_weights_time_ms": 9.444}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1285, "training_iteration": 29, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-26", "timestamp": 1698246746, "time_this_iter_s": 2.186579942703247, "time_total_s": 83.02038383483887, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.02038383483887, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.8857101334465876, "policy_loss": -8.907417456309001e-05, "vf_loss": 6.885855807198419, "vf_explained_var": 1.3245476616753473e-07, "kl": 0.00020734336669292475, "entropy": 0.5660690565903982, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 531.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.076999999999838, "episode_len_mean": 254.9, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.699999999999996, 46.699999999999996, -50.00000000000044, 35.30000000000004, 44.10000000000001, 39.300000000000026, 44.10000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 31.1, 32.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, 45.1, 45.7, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 35.70000000000003, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, 43.30000000000001, 38.10000000000002, 11.699999999999726, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 0.09999999999956088, 36.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044, 30.699999999999996, 5.299999999999635, 6.099999999999646, -50.00000000000044, 45.3, 43.30000000000001, 45.9, -50.00000000000044, 17.099999999999802, 46.099999999999994, -50.00000000000044, 38.10000000000002, 36.30000000000003, 40.70000000000002, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, 40.70000000000002, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 42.900000000000006, 25.499999999999922, 34.900000000000034, 44.5, 45.3, 37.10000000000003, 25.29999999999992, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 29.69999999999998, 34.900000000000034, -50.00000000000044, 43.900000000000006, 41.500000000000014, 41.30000000000001], "episode_lengths": [62, 230, 500, 500, 76, 62, 34, 34, 500, 148, 60, 108, 60, 66, 500, 104, 190, 174, 74, 500, 500, 56, 258, 50, 44, 266, 36, 500, 500, 500, 72, 500, 500, 66, 98, 144, 500, 92, 46, 500, 68, 120, 384, 90, 500, 500, 500, 102, 500, 500, 136, 204, 500, 500, 194, 448, 440, 500, 48, 68, 42, 500, 330, 40, 500, 120, 138, 94, 244, 500, 500, 500, 500, 68, 74, 94, 92, 500, 114, 500, 166, 72, 246, 152, 56, 48, 130, 248, 500, 66, 500, 500, 500, 252, 204, 152, 500, 62, 86, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4795726430529118, "mean_inference_ms": 1.5326826757601715, "mean_action_processing_ms": 0.18264221441256065, "mean_env_wait_ms": 0.10959031571255022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017628908157348633, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.11728668212890625}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.076999999999838, "episode_len_mean": 254.9, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.900000000000006, 46.699999999999996, 46.699999999999996, -50.00000000000044, 35.30000000000004, 44.10000000000001, 39.300000000000026, 44.10000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 31.1, 32.700000000000024, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.5, 24.299999999999905, 45.1, 45.7, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 40.30000000000002, 35.70000000000003, -50.00000000000044, 40.90000000000002, 45.5, -50.00000000000044, 43.30000000000001, 38.10000000000002, 11.699999999999726, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 0.09999999999956088, 36.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044, 30.699999999999996, 5.299999999999635, 6.099999999999646, -50.00000000000044, 45.3, 43.30000000000001, 45.9, -50.00000000000044, 17.099999999999802, 46.099999999999994, -50.00000000000044, 38.10000000000002, 36.30000000000003, 40.70000000000002, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, 40.70000000000002, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 42.900000000000006, 25.499999999999922, 34.900000000000034, 44.5, 45.3, 37.10000000000003, 25.29999999999992, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 29.69999999999998, 34.900000000000034, -50.00000000000044, 43.900000000000006, 41.500000000000014, 41.30000000000001], "episode_lengths": [62, 230, 500, 500, 76, 62, 34, 34, 500, 148, 60, 108, 60, 66, 500, 104, 190, 174, 74, 500, 500, 56, 258, 50, 44, 266, 36, 500, 500, 500, 72, 500, 500, 66, 98, 144, 500, 92, 46, 500, 68, 120, 384, 90, 500, 500, 500, 102, 500, 500, 136, 204, 500, 500, 194, 448, 440, 500, 48, 68, 42, 500, 330, 40, 500, 120, 138, 94, 244, 500, 500, 500, 500, 68, 74, 94, 92, 500, 114, 500, 166, 72, 246, 152, 56, 48, 130, 248, 500, 66, 500, 500, 500, 252, 204, 152, 500, 62, 86, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4795726430529118, "mean_inference_ms": 1.5326826757601715, "mean_action_processing_ms": 0.18264221441256065, "mean_env_wait_ms": 0.10959031571255022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017628908157348633, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.11728668212890625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5132.29874282682, "num_env_steps_trained_throughput_per_sec": 5132.29874282682, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2177.143, "sample_time_ms": 1912.387, "load_time_ms": 11.204, "load_throughput": 1071091.23, "learn_time_ms": 242.693, "learn_throughput": 49445.151, "synch_weights_time_ms": 9.357}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1331, "training_iteration": 30, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-28", "timestamp": 1698246748, "time_this_iter_s": 2.343132257461548, "time_total_s": 85.36351609230042, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.36351609230042, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 59.89999999999999, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.8092160489824085, "policy_loss": -3.568155484067069e-06, "vf_loss": 6.809276183446248, "vf_explained_var": 1.5232298109266492e-07, "kl": 0.00014096106268526556, "entropy": 0.5654975440767076, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 549.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.162999999999842, "episode_len_mean": 254.04, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044, 30.699999999999996, 5.299999999999635, 6.099999999999646, -50.00000000000044, 45.3, 43.30000000000001, 45.9, -50.00000000000044, 17.099999999999802, 46.099999999999994, -50.00000000000044, 38.10000000000002, 36.30000000000003, 40.70000000000002, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, 40.70000000000002, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 42.900000000000006, 25.499999999999922, 34.900000000000034, 44.5, 45.3, 37.10000000000003, 25.29999999999992, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 29.69999999999998, 34.900000000000034, -50.00000000000044, 43.900000000000006, 41.500000000000014, 41.30000000000001, -50.00000000000044, 44.900000000000006, 28.499999999999964, 41.100000000000016, -50.00000000000044, 22.899999999999885, 40.90000000000002, 45.5, 41.30000000000001, -50.00000000000044, 42.30000000000001, 38.700000000000024, 17.299999999999805, 47.3, 33.70000000000004, 45.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.89999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, 29.099999999999973, 31.1, 43.900000000000006, 45.3], "episode_lengths": [136, 204, 500, 500, 194, 448, 440, 500, 48, 68, 42, 500, 330, 40, 500, 120, 138, 94, 244, 500, 500, 500, 500, 68, 74, 94, 92, 500, 114, 500, 166, 72, 246, 152, 56, 48, 130, 248, 500, 66, 500, 500, 500, 252, 204, 152, 500, 62, 86, 88, 500, 52, 216, 90, 500, 272, 92, 46, 88, 500, 78, 114, 328, 28, 164, 46, 500, 500, 82, 98, 56, 68, 500, 500, 86, 76, 500, 40, 106, 500, 72, 500, 90, 500, 212, 500, 74, 500, 500, 500, 376, 52, 74, 500, 500, 202, 210, 190, 62, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47626218917545143, "mean_inference_ms": 1.5216309092753146, "mean_action_processing_ms": 0.18113945178451396, "mean_env_wait_ms": 0.10861479070329533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018324613571166992, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.12879657745361328}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.162999999999842, "episode_len_mean": 254.04, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044, 30.699999999999996, 5.299999999999635, 6.099999999999646, -50.00000000000044, 45.3, 43.30000000000001, 45.9, -50.00000000000044, 17.099999999999802, 46.099999999999994, -50.00000000000044, 38.10000000000002, 36.30000000000003, 40.70000000000002, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.70000000000001, 40.70000000000002, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 33.500000000000036, 42.900000000000006, 25.499999999999922, 34.900000000000034, 44.5, 45.3, 37.10000000000003, 25.29999999999992, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 29.69999999999998, 34.900000000000034, -50.00000000000044, 43.900000000000006, 41.500000000000014, 41.30000000000001, -50.00000000000044, 44.900000000000006, 28.499999999999964, 41.100000000000016, -50.00000000000044, 22.899999999999885, 40.90000000000002, 45.5, 41.30000000000001, -50.00000000000044, 42.30000000000001, 38.700000000000024, 17.299999999999805, 47.3, 33.70000000000004, 45.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.89999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, 29.099999999999973, 31.1, 43.900000000000006, 45.3], "episode_lengths": [136, 204, 500, 500, 194, 448, 440, 500, 48, 68, 42, 500, 330, 40, 500, 120, 138, 94, 244, 500, 500, 500, 500, 68, 74, 94, 92, 500, 114, 500, 166, 72, 246, 152, 56, 48, 130, 248, 500, 66, 500, 500, 500, 252, 204, 152, 500, 62, 86, 88, 500, 52, 216, 90, 500, 272, 92, 46, 88, 500, 78, 114, 328, 28, 164, 46, 500, 500, 82, 98, 56, 68, 500, 500, 86, 76, 500, 40, 106, 500, 72, 500, 90, 500, 212, 500, 74, 500, 500, 500, 376, 52, 74, 500, 500, 202, 210, 190, 62, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47626218917545143, "mean_inference_ms": 1.5216309092753146, "mean_action_processing_ms": 0.18113945178451396, "mean_env_wait_ms": 0.10861479070329533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018324613571166992, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.12879657745361328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5445.632233105676, "num_env_steps_trained_throughput_per_sec": 5445.632233105676, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2176.327, "sample_time_ms": 1913.679, "load_time_ms": 11.702, "load_throughput": 1025431.164, "learn_time_ms": 240.066, "learn_throughput": 49986.347, "synch_weights_time_ms": 9.379}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1381, "training_iteration": 31, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-30", "timestamp": 1698246750, "time_this_iter_s": 2.208599328994751, "time_total_s": 87.57211542129517, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.57211542129517, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 61.93333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 7.44518780708313, "policy_loss": -0.00023657000727123686, "vf_loss": 7.445480902989705, "vf_explained_var": -5.13262218899197e-07, "kl": 0.0003710126377275537, "entropy": 0.5636696467796961, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 567.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.636999999999846, "episode_len_mean": 249.32, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 28.499999999999964, 41.100000000000016, -50.00000000000044, 22.899999999999885, 40.90000000000002, 45.5, 41.30000000000001, -50.00000000000044, 42.30000000000001, 38.700000000000024, 17.299999999999805, 47.3, 33.70000000000004, 45.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.89999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, 29.099999999999973, 31.1, 43.900000000000006, 45.3, 39.10000000000002, 42.30000000000001, 46.3, 27.299999999999947, 23.699999999999896, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 37.70000000000003, 37.300000000000026, 1.299999999999578, -50.00000000000044, 44.5, -50.00000000000044, 4.699999999999626, 19.09999999999983, 35.10000000000004, 41.90000000000001, 43.10000000000001, 34.30000000000004, 43.30000000000001, 14.499999999999766, 11.899999999999729, 44.900000000000006, 44.5, 36.70000000000003, 32.700000000000024, 44.300000000000004, 26.299999999999933, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 30.499999999999993, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 36.50000000000003], "episode_lengths": [500, 52, 216, 90, 500, 272, 92, 46, 88, 500, 78, 114, 328, 28, 164, 46, 500, 500, 82, 98, 56, 68, 500, 500, 86, 76, 500, 40, 106, 500, 72, 500, 90, 500, 212, 500, 74, 500, 500, 500, 376, 52, 74, 500, 500, 202, 210, 190, 62, 48, 110, 78, 38, 228, 264, 82, 500, 500, 500, 58, 64, 124, 128, 488, 500, 56, 500, 454, 310, 150, 82, 70, 158, 68, 356, 382, 52, 56, 134, 174, 58, 238, 82, 500, 500, 500, 150, 148, 500, 500, 500, 62, 500, 196, 50, 116, 500, 500, 144, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723533472888864, "mean_inference_ms": 1.5127476450820638, "mean_action_processing_ms": 0.17949049844586554, "mean_env_wait_ms": 0.10766241488650063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022737503051757812, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.1293947696685791}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.636999999999846, "episode_len_mean": 249.32, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 28.499999999999964, 41.100000000000016, -50.00000000000044, 22.899999999999885, 40.90000000000002, 45.5, 41.30000000000001, -50.00000000000044, 42.30000000000001, 38.700000000000024, 17.299999999999805, 47.3, 33.70000000000004, 45.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.30000000000002, 44.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, -50.00000000000044, 46.099999999999994, 39.50000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 28.89999999999997, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, 44.900000000000006, 42.70000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, 29.099999999999973, 31.1, 43.900000000000006, 45.3, 39.10000000000002, 42.30000000000001, 46.3, 27.299999999999947, 23.699999999999896, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 37.70000000000003, 37.300000000000026, 1.299999999999578, -50.00000000000044, 44.5, -50.00000000000044, 4.699999999999626, 19.09999999999983, 35.10000000000004, 41.90000000000001, 43.10000000000001, 34.30000000000004, 43.30000000000001, 14.499999999999766, 11.899999999999729, 44.900000000000006, 44.5, 36.70000000000003, 32.700000000000024, 44.300000000000004, 26.299999999999933, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 30.499999999999993, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 36.50000000000003], "episode_lengths": [500, 52, 216, 90, 500, 272, 92, 46, 88, 500, 78, 114, 328, 28, 164, 46, 500, 500, 82, 98, 56, 68, 500, 500, 86, 76, 500, 40, 106, 500, 72, 500, 90, 500, 212, 500, 74, 500, 500, 500, 376, 52, 74, 500, 500, 202, 210, 190, 62, 48, 110, 78, 38, 228, 264, 82, 500, 500, 500, 58, 64, 124, 128, 488, 500, 56, 500, 454, 310, 150, 82, 70, 158, 68, 356, 382, 52, 56, 134, 174, 58, 238, 82, 500, 500, 500, 150, 148, 500, 500, 500, 62, 500, 196, 50, 116, 500, 500, 144, 136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723533472888864, "mean_inference_ms": 1.5127476450820638, "mean_action_processing_ms": 0.17949049844586554, "mean_env_wait_ms": 0.10766241488650063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022737503051757812, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.1293947696685791}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5388.833178622247, "num_env_steps_trained_throughput_per_sec": 5388.833178622247, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2180.417, "sample_time_ms": 1920.327, "load_time_ms": 11.599, "load_throughput": 1034538.604, "learn_time_ms": 237.633, "learn_throughput": 50498.115, "synch_weights_time_ms": 9.381}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1431, "training_iteration": 32, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-33", "timestamp": 1698246753, "time_this_iter_s": 2.2315640449523926, "time_total_s": 89.80367946624756, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 89.80367946624756, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.699999999999996, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.609343025419447, "policy_loss": -0.0001983377668592665, "vf_loss": 6.609596146477593, "vf_explained_var": -1.3245476616753471e-08, "kl": 0.00033053829043991654, "entropy": 0.5485872195826637, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.869999999999868, "episode_len_mean": 232.04, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 27.299999999999947, 23.699999999999896, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 37.70000000000003, 37.300000000000026, 1.299999999999578, -50.00000000000044, 44.5, -50.00000000000044, 4.699999999999626, 19.09999999999983, 35.10000000000004, 41.90000000000001, 43.10000000000001, 34.30000000000004, 43.30000000000001, 14.499999999999766, 11.899999999999729, 44.900000000000006, 44.5, 36.70000000000003, 32.700000000000024, 44.300000000000004, 26.299999999999933, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 30.499999999999993, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 36.50000000000003, 6.099999999999646, 39.50000000000002, 40.30000000000002, 32.50000000000002, 31.500000000000007, 43.7, 35.900000000000034, 43.900000000000006, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 30.29999999999999, 44.900000000000006, 44.300000000000004, 43.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 21.299999999999862, -50.00000000000044, 38.700000000000024, 18.899999999999828, 40.500000000000014, 43.50000000000001, 23.699999999999896, 44.5, 46.3, 24.69999999999991, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, 35.900000000000034, 39.300000000000026, 44.900000000000006, 45.5, 41.100000000000016, 41.30000000000001, -50.00000000000044, 46.099999999999994, 32.50000000000002, -50.00000000000044, 45.9, 30.499999999999993], "episode_lengths": [38, 228, 264, 82, 500, 500, 500, 58, 64, 124, 128, 488, 500, 56, 500, 454, 310, 150, 82, 70, 158, 68, 356, 382, 52, 56, 134, 174, 58, 238, 82, 500, 500, 500, 150, 148, 500, 500, 500, 62, 500, 196, 50, 116, 500, 500, 144, 136, 440, 106, 98, 176, 186, 64, 142, 62, 500, 64, 162, 500, 32, 50, 500, 500, 198, 52, 58, 68, 500, 50, 500, 500, 54, 54, 288, 500, 114, 312, 96, 66, 264, 56, 38, 254, 68, 500, 500, 196, 142, 108, 52, 46, 90, 88, 500, 40, 176, 500, 42, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47136313245781325, "mean_inference_ms": 1.5080299844956102, "mean_action_processing_ms": 0.17837961072470893, "mean_env_wait_ms": 0.10697863319644327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601170539855957, "StateBufferConnector_ms": 0.005003929138183594, "ViewRequirementAgentConnector_ms": 0.13402223587036133}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.869999999999868, "episode_len_mean": 232.04, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 27.299999999999947, 23.699999999999896, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 37.70000000000003, 37.300000000000026, 1.299999999999578, -50.00000000000044, 44.5, -50.00000000000044, 4.699999999999626, 19.09999999999983, 35.10000000000004, 41.90000000000001, 43.10000000000001, 34.30000000000004, 43.30000000000001, 14.499999999999766, 11.899999999999729, 44.900000000000006, 44.5, 36.70000000000003, 32.700000000000024, 44.300000000000004, 26.299999999999933, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 30.499999999999993, 45.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.70000000000003, 36.50000000000003, 6.099999999999646, 39.50000000000002, 40.30000000000002, 32.50000000000002, 31.500000000000007, 43.7, 35.900000000000034, 43.900000000000006, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 30.29999999999999, 44.900000000000006, 44.300000000000004, 43.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 21.299999999999862, -50.00000000000044, 38.700000000000024, 18.899999999999828, 40.500000000000014, 43.50000000000001, 23.699999999999896, 44.5, 46.3, 24.69999999999991, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, 35.900000000000034, 39.300000000000026, 44.900000000000006, 45.5, 41.100000000000016, 41.30000000000001, -50.00000000000044, 46.099999999999994, 32.50000000000002, -50.00000000000044, 45.9, 30.499999999999993], "episode_lengths": [38, 228, 264, 82, 500, 500, 500, 58, 64, 124, 128, 488, 500, 56, 500, 454, 310, 150, 82, 70, 158, 68, 356, 382, 52, 56, 134, 174, 58, 238, 82, 500, 500, 500, 150, 148, 500, 500, 500, 62, 500, 196, 50, 116, 500, 500, 144, 136, 440, 106, 98, 176, 186, 64, 142, 62, 500, 64, 162, 500, 32, 50, 500, 500, 198, 52, 58, 68, 500, 50, 500, 500, 54, 54, 288, 500, 114, 312, 96, 66, 264, 56, 38, 254, 68, 500, 500, 196, 142, 108, 52, 46, 90, 88, 500, 40, 176, 500, 42, 196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47136313245781325, "mean_inference_ms": 1.5080299844956102, "mean_action_processing_ms": 0.17837961072470893, "mean_env_wait_ms": 0.10697863319644327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601170539855957, "StateBufferConnector_ms": 0.005003929138183594, "ViewRequirementAgentConnector_ms": 0.13402223587036133}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5021.303476926803, "num_env_steps_trained_throughput_per_sec": 5021.303476926803, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2214.17, "sample_time_ms": 1945.18, "load_time_ms": 12.077, "load_throughput": 993596.968, "learn_time_ms": 246.153, "learn_throughput": 48750.197, "synch_weights_time_ms": 9.381}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1483, "training_iteration": 33, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-35", "timestamp": 1698246755, "time_this_iter_s": 2.3948254585266113, "time_total_s": 92.19850492477417, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.19850492477417, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 67.2, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.708015335930718, "policy_loss": -6.576461924446953e-05, "vf_loss": 6.708136611514622, "vf_explained_var": -1.3444158766004775e-06, "kl": 0.00030999232429188933, "entropy": 0.5557050936751895, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 603.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.65599999999987, "episode_len_mean": 224.16, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.500000000000007, 43.7, 35.900000000000034, 43.900000000000006, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 30.29999999999999, 44.900000000000006, 44.300000000000004, 43.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 21.299999999999862, -50.00000000000044, 38.700000000000024, 18.899999999999828, 40.500000000000014, 43.50000000000001, 23.699999999999896, 44.5, 46.3, 24.69999999999991, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, 35.900000000000034, 39.300000000000026, 44.900000000000006, 45.5, 41.100000000000016, 41.30000000000001, -50.00000000000044, 46.099999999999994, 32.50000000000002, -50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 43.7, 42.900000000000006, 34.900000000000034, 46.3, 40.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, 39.90000000000002, 16.09999999999979, 40.500000000000014, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.90000000000002, 37.70000000000003, 43.900000000000006, 27.299999999999947, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.50000000000003, 41.100000000000016, 41.70000000000002, 38.10000000000002, 40.500000000000014, 44.900000000000006, 12.69999999999974, -50.00000000000044, -50.00000000000044, 43.7, 13.499999999999751, 23.8999999999999, 43.7, 33.70000000000004, 41.500000000000014, 35.900000000000034, 45.5], "episode_lengths": [186, 64, 142, 62, 500, 64, 162, 500, 32, 50, 500, 500, 198, 52, 58, 68, 500, 50, 500, 500, 54, 54, 288, 500, 114, 312, 96, 66, 264, 56, 38, 254, 68, 500, 500, 196, 142, 108, 52, 46, 90, 88, 500, 40, 176, 500, 42, 196, 500, 32, 500, 500, 500, 500, 38, 500, 84, 64, 72, 152, 38, 96, 500, 44, 68, 102, 340, 96, 500, 82, 500, 500, 306, 500, 74, 500, 92, 124, 62, 228, 500, 68, 500, 116, 90, 84, 120, 96, 52, 374, 500, 500, 64, 366, 262, 64, 164, 86, 142, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4720026563226446, "mean_inference_ms": 1.505466204640785, "mean_action_processing_ms": 0.17813023289032365, "mean_env_wait_ms": 0.1065878573212936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004003524780273, "StateBufferConnector_ms": 0.005028963088989258, "ViewRequirementAgentConnector_ms": 0.14545035362243652}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.65599999999987, "episode_len_mean": 224.16, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.500000000000007, 43.7, 35.900000000000034, 43.900000000000006, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 30.29999999999999, 44.900000000000006, 44.300000000000004, 43.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.7, 44.7, 21.299999999999862, -50.00000000000044, 38.700000000000024, 18.899999999999828, 40.500000000000014, 43.50000000000001, 23.699999999999896, 44.5, 46.3, 24.69999999999991, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, 35.900000000000034, 39.300000000000026, 44.900000000000006, 45.5, 41.100000000000016, 41.30000000000001, -50.00000000000044, 46.099999999999994, 32.50000000000002, -50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 43.7, 42.900000000000006, 34.900000000000034, 46.3, 40.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, 39.90000000000002, 16.09999999999979, 40.500000000000014, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.90000000000002, 37.70000000000003, 43.900000000000006, 27.299999999999947, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.50000000000003, 41.100000000000016, 41.70000000000002, 38.10000000000002, 40.500000000000014, 44.900000000000006, 12.69999999999974, -50.00000000000044, -50.00000000000044, 43.7, 13.499999999999751, 23.8999999999999, 43.7, 33.70000000000004, 41.500000000000014, 35.900000000000034, 45.5], "episode_lengths": [186, 64, 142, 62, 500, 64, 162, 500, 32, 50, 500, 500, 198, 52, 58, 68, 500, 50, 500, 500, 54, 54, 288, 500, 114, 312, 96, 66, 264, 56, 38, 254, 68, 500, 500, 196, 142, 108, 52, 46, 90, 88, 500, 40, 176, 500, 42, 196, 500, 32, 500, 500, 500, 500, 38, 500, 84, 64, 72, 152, 38, 96, 500, 44, 68, 102, 340, 96, 500, 82, 500, 500, 306, 500, 74, 500, 92, 124, 62, 228, 500, 68, 500, 116, 90, 84, 120, 96, 52, 374, 500, 500, 64, 366, 262, 64, 164, 86, 142, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4720026563226446, "mean_inference_ms": 1.505466204640785, "mean_action_processing_ms": 0.17813023289032365, "mean_env_wait_ms": 0.1065878573212936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004003524780273, "StateBufferConnector_ms": 0.005028963088989258, "ViewRequirementAgentConnector_ms": 0.14545035362243652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4655.668314890103, "num_env_steps_trained_throughput_per_sec": 4655.668314890103, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2254.279, "sample_time_ms": 1994.82, "load_time_ms": 11.519, "load_throughput": 1041791.334, "learn_time_ms": 237.168, "learn_throughput": 50597.151, "synch_weights_time_ms": 9.395}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1535, "training_iteration": 34, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-38", "timestamp": 1698246758, "time_this_iter_s": 2.5825016498565674, "time_total_s": 94.78100657463074, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.78100657463074, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 67.775, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.616408771938747, "policy_loss": -0.0005060794452826182, "vf_loss": 6.616966803868611, "vf_explained_var": -2.3510720994737412e-06, "kl": 0.0007868768014986927, "entropy": 0.5202846841679679, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 621.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.313999999999842, "episode_len_mean": 247.52, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 43.7, 42.900000000000006, 34.900000000000034, 46.3, 40.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, 39.90000000000002, 16.09999999999979, 40.500000000000014, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.90000000000002, 37.70000000000003, 43.900000000000006, 27.299999999999947, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.50000000000003, 41.100000000000016, 41.70000000000002, 38.10000000000002, 40.500000000000014, 44.900000000000006, 12.69999999999974, -50.00000000000044, -50.00000000000044, 43.7, 13.499999999999751, 23.8999999999999, 43.7, 33.70000000000004, 41.500000000000014, 35.900000000000034, 45.5, -50.00000000000044, 27.49999999999995, 27.099999999999945, 45.1, -50.00000000000044, 41.30000000000001, 37.50000000000003, 45.9, 42.30000000000001, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 46.3, -50.00000000000044, 20.299999999999848, 39.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.7, 47.7, 41.500000000000014, -50.00000000000044, 29.299999999999976, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.500000000000014, 44.300000000000004, 32.700000000000024, 31.900000000000013], "episode_lengths": [500, 42, 196, 500, 32, 500, 500, 500, 500, 38, 500, 84, 64, 72, 152, 38, 96, 500, 44, 68, 102, 340, 96, 500, 82, 500, 500, 306, 500, 74, 500, 92, 124, 62, 228, 500, 68, 500, 116, 90, 84, 120, 96, 52, 374, 500, 500, 64, 366, 262, 64, 164, 86, 142, 46, 500, 226, 230, 50, 500, 88, 126, 42, 78, 36, 500, 60, 500, 42, 500, 500, 92, 122, 38, 500, 298, 102, 106, 500, 500, 500, 58, 500, 500, 500, 136, 44, 24, 86, 500, 208, 500, 188, 500, 156, 500, 76, 58, 174, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47077736785383933, "mean_inference_ms": 1.5025998899683162, "mean_action_processing_ms": 0.1774419906617355, "mean_env_wait_ms": 0.10643302012740807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02625751495361328, "StateBufferConnector_ms": 0.005045890808105469, "ViewRequirementAgentConnector_ms": 0.1313915252685547}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.313999999999842, "episode_len_mean": 247.52, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.70000000000002, 43.7, 42.900000000000006, 34.900000000000034, 46.3, 40.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, 39.90000000000002, 16.09999999999979, 40.500000000000014, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.90000000000002, 37.70000000000003, 43.900000000000006, 27.299999999999947, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.50000000000003, 41.100000000000016, 41.70000000000002, 38.10000000000002, 40.500000000000014, 44.900000000000006, 12.69999999999974, -50.00000000000044, -50.00000000000044, 43.7, 13.499999999999751, 23.8999999999999, 43.7, 33.70000000000004, 41.500000000000014, 35.900000000000034, 45.5, -50.00000000000044, 27.49999999999995, 27.099999999999945, 45.1, -50.00000000000044, 41.30000000000001, 37.50000000000003, 45.9, 42.30000000000001, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 46.3, -50.00000000000044, 20.299999999999848, 39.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.7, 47.7, 41.500000000000014, -50.00000000000044, 29.299999999999976, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.500000000000014, 44.300000000000004, 32.700000000000024, 31.900000000000013], "episode_lengths": [500, 42, 196, 500, 32, 500, 500, 500, 500, 38, 500, 84, 64, 72, 152, 38, 96, 500, 44, 68, 102, 340, 96, 500, 82, 500, 500, 306, 500, 74, 500, 92, 124, 62, 228, 500, 68, 500, 116, 90, 84, 120, 96, 52, 374, 500, 500, 64, 366, 262, 64, 164, 86, 142, 46, 500, 226, 230, 50, 500, 88, 126, 42, 78, 36, 500, 60, 500, 42, 500, 500, 92, 122, 38, 500, 298, 102, 106, 500, 500, 500, 58, 500, 500, 500, 136, 44, 24, 86, 500, 208, 500, 188, 500, 156, 500, 76, 58, 174, 182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47077736785383933, "mean_inference_ms": 1.5025998899683162, "mean_action_processing_ms": 0.1774419906617355, "mean_env_wait_ms": 0.10643302012740807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02625751495361328, "StateBufferConnector_ms": 0.005045890808105469, "ViewRequirementAgentConnector_ms": 0.1313915252685547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4842.979074550762, "num_env_steps_trained_throughput_per_sec": 4842.979074550762, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2290.43, "sample_time_ms": 2018.365, "load_time_ms": 13.039, "load_throughput": 920309.746, "learn_time_ms": 247.708, "learn_throughput": 48444.134, "synch_weights_time_ms": 9.844}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1580, "training_iteration": 35, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-40", "timestamp": 1698246760, "time_this_iter_s": 2.4828133583068848, "time_total_s": 97.26381993293762, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.26381993293762, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.650000000000006, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.166516939798991, "policy_loss": 8.815940883424546e-05, "vf_loss": 6.1664788193172875, "vf_explained_var": 1.7053551144070095e-06, "kl": 8.02190461407627e-05, "entropy": 0.500592451956537, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 639.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.222999999999825, "episode_len_mean": 263.4, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 44.900000000000006, 12.69999999999974, -50.00000000000044, -50.00000000000044, 43.7, 13.499999999999751, 23.8999999999999, 43.7, 33.70000000000004, 41.500000000000014, 35.900000000000034, 45.5, -50.00000000000044, 27.49999999999995, 27.099999999999945, 45.1, -50.00000000000044, 41.30000000000001, 37.50000000000003, 45.9, 42.30000000000001, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 46.3, -50.00000000000044, 20.299999999999848, 39.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.7, 47.7, 41.500000000000014, -50.00000000000044, 29.299999999999976, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.500000000000014, 44.300000000000004, 32.700000000000024, 31.900000000000013, -50.00000000000044, 45.5, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.099999999999874, 39.50000000000002, 46.3, 44.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 11.29999999999972, 46.9, 43.30000000000001, 25.499999999999922, 44.300000000000004, 44.300000000000004, -50.00000000000044, 35.70000000000003, 44.5, 42.70000000000001, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002], "episode_lengths": [96, 52, 374, 500, 500, 64, 366, 262, 64, 164, 86, 142, 46, 500, 226, 230, 50, 500, 88, 126, 42, 78, 36, 500, 60, 500, 42, 500, 500, 92, 122, 38, 500, 298, 102, 106, 500, 500, 500, 58, 500, 500, 500, 136, 44, 24, 86, 500, 208, 500, 188, 500, 156, 500, 76, 58, 174, 182, 500, 46, 34, 88, 500, 500, 92, 500, 280, 106, 38, 54, 500, 148, 500, 500, 500, 478, 500, 500, 500, 500, 500, 148, 500, 388, 32, 68, 246, 58, 58, 500, 144, 56, 74, 32, 148, 500, 500, 500, 82, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46973354666566375, "mean_inference_ms": 1.4986090870350643, "mean_action_processing_ms": 0.17656056003774195, "mean_env_wait_ms": 0.1062614301062485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02333521842956543, "StateBufferConnector_ms": 0.005042314529418945, "ViewRequirementAgentConnector_ms": 0.11022210121154785}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.222999999999825, "episode_len_mean": 263.4, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 44.900000000000006, 12.69999999999974, -50.00000000000044, -50.00000000000044, 43.7, 13.499999999999751, 23.8999999999999, 43.7, 33.70000000000004, 41.500000000000014, 35.900000000000034, 45.5, -50.00000000000044, 27.49999999999995, 27.099999999999945, 45.1, -50.00000000000044, 41.30000000000001, 37.50000000000003, 45.9, 42.30000000000001, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.90000000000003, 46.3, -50.00000000000044, 20.299999999999848, 39.90000000000002, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.7, 47.7, 41.500000000000014, -50.00000000000044, 29.299999999999976, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.500000000000014, 44.300000000000004, 32.700000000000024, 31.900000000000013, -50.00000000000044, 45.5, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.099999999999874, 39.50000000000002, 46.3, 44.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 11.29999999999972, 46.9, 43.30000000000001, 25.499999999999922, 44.300000000000004, 44.300000000000004, -50.00000000000044, 35.70000000000003, 44.5, 42.70000000000001, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002], "episode_lengths": [96, 52, 374, 500, 500, 64, 366, 262, 64, 164, 86, 142, 46, 500, 226, 230, 50, 500, 88, 126, 42, 78, 36, 500, 60, 500, 42, 500, 500, 92, 122, 38, 500, 298, 102, 106, 500, 500, 500, 58, 500, 500, 500, 136, 44, 24, 86, 500, 208, 500, 188, 500, 156, 500, 76, 58, 174, 182, 500, 46, 34, 88, 500, 500, 92, 500, 280, 106, 38, 54, 500, 148, 500, 500, 500, 478, 500, 500, 500, 500, 500, 148, 500, 388, 32, 68, 246, 58, 58, 500, 144, 56, 74, 32, 148, 500, 500, 500, 82, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46973354666566375, "mean_inference_ms": 1.4986090870350643, "mean_action_processing_ms": 0.17656056003774195, "mean_env_wait_ms": 0.1062614301062485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02333521842956543, "StateBufferConnector_ms": 0.005042314529418945, "ViewRequirementAgentConnector_ms": 0.11022210121154785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5307.748426235047, "num_env_steps_trained_throughput_per_sec": 5307.748426235047, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2308.816, "sample_time_ms": 2026.346, "load_time_ms": 13.616, "load_throughput": 881335.285, "learn_time_ms": 257.659, "learn_throughput": 46573.127, "synch_weights_time_ms": 9.921}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1622, "training_iteration": 36, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-42", "timestamp": 1698246762, "time_this_iter_s": 2.2658438682556152, "time_total_s": 99.52966380119324, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 99.52966380119324, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 63.666666666666664, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.395447227689955, "policy_loss": -0.00014514884807997278, "vf_loss": 6.395642280578613, "vf_explained_var": -4.2054388258192273e-07, "kl": 0.00019738618698126074, "entropy": 0.4993275867568122, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 657.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1559999999998034, "episode_len_mean": 279.02, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 45.7, 47.7, 41.500000000000014, -50.00000000000044, 29.299999999999976, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.500000000000014, 44.300000000000004, 32.700000000000024, 31.900000000000013, -50.00000000000044, 45.5, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.099999999999874, 39.50000000000002, 46.3, 44.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 11.29999999999972, 46.9, 43.30000000000001, 25.499999999999922, 44.300000000000004, 44.300000000000004, -50.00000000000044, 35.70000000000003, 44.5, 42.70000000000001, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 44.300000000000004, 31.500000000000007, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.3, 17.099999999999802, 43.30000000000001, 30.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 6.499999999999652, 44.7], "episode_lengths": [500, 136, 44, 24, 86, 500, 208, 500, 188, 500, 156, 500, 76, 58, 174, 182, 500, 46, 34, 88, 500, 500, 92, 500, 280, 106, 38, 54, 500, 148, 500, 500, 500, 478, 500, 500, 500, 500, 500, 148, 500, 388, 32, 68, 246, 58, 58, 500, 144, 56, 74, 32, 148, 500, 500, 500, 82, 100, 500, 46, 500, 34, 58, 186, 64, 500, 500, 134, 500, 48, 500, 284, 500, 48, 50, 500, 500, 500, 500, 500, 500, 500, 104, 500, 500, 42, 82, 500, 122, 76, 38, 330, 68, 194, 32, 500, 500, 42, 436, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684192448823717, "mean_inference_ms": 1.4921268349213745, "mean_action_processing_ms": 0.17555556275702167, "mean_env_wait_ms": 0.10547259350217378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02408766746520996, "StateBufferConnector_ms": 0.006005048751831055, "ViewRequirementAgentConnector_ms": 0.10325193405151367}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1559999999998034, "episode_len_mean": 279.02, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 45.7, 47.7, 41.500000000000014, -50.00000000000044, 29.299999999999976, -50.00000000000044, 31.300000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 42.500000000000014, 44.300000000000004, 32.700000000000024, 31.900000000000013, -50.00000000000044, 45.5, 46.699999999999996, 41.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 22.099999999999874, 39.50000000000002, 46.3, 44.7, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.299999999999592, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 11.29999999999972, 46.9, 43.30000000000001, 25.499999999999922, 44.300000000000004, 44.300000000000004, -50.00000000000044, 35.70000000000003, 44.5, 42.70000000000001, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 44.300000000000004, 31.500000000000007, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.3, 17.099999999999802, 43.30000000000001, 30.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 6.499999999999652, 44.7], "episode_lengths": [500, 136, 44, 24, 86, 500, 208, 500, 188, 500, 156, 500, 76, 58, 174, 182, 500, 46, 34, 88, 500, 500, 92, 500, 280, 106, 38, 54, 500, 148, 500, 500, 500, 478, 500, 500, 500, 500, 500, 148, 500, 388, 32, 68, 246, 58, 58, 500, 144, 56, 74, 32, 148, 500, 500, 500, 82, 100, 500, 46, 500, 34, 58, 186, 64, 500, 500, 134, 500, 48, 500, 284, 500, 48, 50, 500, 500, 500, 500, 500, 500, 500, 104, 500, 500, 42, 82, 500, 122, 76, 38, 330, 68, 194, 32, 500, 500, 42, 436, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684192448823717, "mean_inference_ms": 1.4921268349213745, "mean_action_processing_ms": 0.17555556275702167, "mean_env_wait_ms": 0.10547259350217378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02408766746520996, "StateBufferConnector_ms": 0.006005048751831055, "ViewRequirementAgentConnector_ms": 0.10325193405151367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5411.000344344658, "num_env_steps_trained_throughput_per_sec": 5411.000344344658, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2311.504, "sample_time_ms": 2027.08, "load_time_ms": 13.691, "load_throughput": 876459.45, "learn_time_ms": 259.587, "learn_throughput": 46227.331, "synch_weights_time_ms": 9.972}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1664, "training_iteration": 37, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-45", "timestamp": 1698246765, "time_this_iter_s": 2.222703695297241, "time_total_s": 101.75236749649048, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.75236749649048, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.221969736946954, "policy_loss": -0.0005673828224341074, "vf_loss": 6.222588433159722, "vf_explained_var": 1.3245476616753471e-08, "kl": 0.0007242435145574038, "entropy": 0.5117601272132661, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.897999999999813, "episode_len_mean": 271.62, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.29999999999972, 46.9, 43.30000000000001, 25.499999999999922, 44.300000000000004, 44.300000000000004, -50.00000000000044, 35.70000000000003, 44.5, 42.70000000000001, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 44.300000000000004, 31.500000000000007, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.3, 17.099999999999802, 43.30000000000001, 30.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 6.499999999999652, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, 44.900000000000006, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 36.70000000000003, -50.00000000000044, 33.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 35.70000000000003, 35.70000000000003, 30.099999999999987, 44.5, 39.70000000000002, 28.699999999999967, 45.3, 46.9, 31.1, 44.300000000000004, -50.00000000000044], "episode_lengths": [388, 32, 68, 246, 58, 58, 500, 144, 56, 74, 32, 148, 500, 500, 500, 82, 100, 500, 46, 500, 34, 58, 186, 64, 500, 500, 134, 500, 48, 500, 284, 500, 48, 50, 500, 500, 500, 500, 500, 500, 500, 104, 500, 500, 42, 82, 500, 122, 76, 38, 330, 68, 194, 32, 500, 500, 42, 436, 54, 236, 500, 500, 94, 44, 500, 500, 500, 302, 82, 52, 500, 68, 94, 500, 500, 500, 74, 500, 500, 402, 500, 134, 500, 166, 116, 500, 500, 500, 50, 144, 144, 200, 56, 104, 214, 48, 32, 190, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4666704875279024, "mean_inference_ms": 1.4860205097000558, "mean_action_processing_ms": 0.17507662410085323, "mean_env_wait_ms": 0.10517524884344429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027688980102539062, "StateBufferConnector_ms": 0.005005836486816406, "ViewRequirementAgentConnector_ms": 0.13322758674621582}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.897999999999813, "episode_len_mean": 271.62, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.29999999999972, 46.9, 43.30000000000001, 25.499999999999922, 44.300000000000004, 44.300000000000004, -50.00000000000044, 35.70000000000003, 44.5, 42.70000000000001, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 40.10000000000002, -50.00000000000044, 45.5, -50.00000000000044, 46.699999999999996, 44.300000000000004, 31.500000000000007, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.3, -50.00000000000044, 21.699999999999868, -50.00000000000044, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 41.90000000000001, -50.00000000000044, 37.90000000000003, 42.500000000000014, 46.3, 17.099999999999802, 43.30000000000001, 30.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 6.499999999999652, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, 44.900000000000006, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 36.70000000000003, -50.00000000000044, 33.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 35.70000000000003, 35.70000000000003, 30.099999999999987, 44.5, 39.70000000000002, 28.699999999999967, 45.3, 46.9, 31.1, 44.300000000000004, -50.00000000000044], "episode_lengths": [388, 32, 68, 246, 58, 58, 500, 144, 56, 74, 32, 148, 500, 500, 500, 82, 100, 500, 46, 500, 34, 58, 186, 64, 500, 500, 134, 500, 48, 500, 284, 500, 48, 50, 500, 500, 500, 500, 500, 500, 500, 104, 500, 500, 42, 82, 500, 122, 76, 38, 330, 68, 194, 32, 500, 500, 42, 436, 54, 236, 500, 500, 94, 44, 500, 500, 500, 302, 82, 52, 500, 68, 94, 500, 500, 500, 74, 500, 500, 402, 500, 134, 500, 166, 116, 500, 500, 500, 50, 144, 144, 200, 56, 104, 214, 48, 32, 190, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4666704875279024, "mean_inference_ms": 1.4860205097000558, "mean_action_processing_ms": 0.17507662410085323, "mean_env_wait_ms": 0.10517524884344429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027688980102539062, "StateBufferConnector_ms": 0.005005836486816406, "ViewRequirementAgentConnector_ms": 0.13322758674621582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4308.791830531084, "num_env_steps_trained_throughput_per_sec": 4308.791830531084, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2365.883, "sample_time_ms": 2038.269, "load_time_ms": 13.889, "load_throughput": 864012.195, "learn_time_ms": 271.605, "learn_throughput": 44181.779, "synch_weights_time_ms": 40.946}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1705, "training_iteration": 38, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-48", "timestamp": 1698246768, "time_this_iter_s": 2.789757490158081, "time_total_s": 104.54212498664856, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.54212498664856, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 54.800000000000004, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.455998473697239, "policy_loss": -0.0005823772711058458, "vf_loss": 6.456638044781155, "vf_explained_var": -5.695554945203993e-07, "kl": 0.0010372109638865368, "entropy": 0.5715183450116051, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 693.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.78299999999983, "episode_len_mean": 257.82, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 46.3, 17.099999999999802, 43.30000000000001, 30.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 6.499999999999652, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, 44.900000000000006, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 36.70000000000003, -50.00000000000044, 33.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 35.70000000000003, 35.70000000000003, 30.099999999999987, 44.5, 39.70000000000002, 28.699999999999967, 45.3, 46.9, 31.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.30000000000003, 44.300000000000004, 35.30000000000004, 30.29999999999999, 36.50000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.10000000000004, 25.499999999999922, 43.50000000000001, 13.499999999999751, -50.00000000000044, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 3.2999999999996064, 44.300000000000004, 44.900000000000006, 37.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, 20.49999999999985, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 43.7, 33.30000000000003, -50.00000000000044, 38.10000000000002, 45.9], "episode_lengths": [76, 38, 330, 68, 194, 32, 500, 500, 42, 436, 54, 236, 500, 500, 94, 44, 500, 500, 500, 302, 82, 52, 500, 68, 94, 500, 500, 500, 74, 500, 500, 402, 500, 134, 500, 166, 116, 500, 500, 500, 50, 144, 144, 200, 56, 104, 214, 48, 32, 190, 58, 500, 500, 56, 500, 92, 52, 500, 500, 84, 500, 138, 58, 148, 198, 136, 124, 500, 500, 74, 160, 246, 66, 366, 500, 30, 36, 500, 500, 36, 62, 468, 58, 52, 126, 500, 64, 500, 296, 210, 500, 500, 38, 40, 500, 64, 168, 500, 120, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4641663743598779, "mean_inference_ms": 1.4780926553554052, "mean_action_processing_ms": 0.17409499601634493, "mean_env_wait_ms": 0.10462695653197202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026633739471435547, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.126084566116333}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.78299999999983, "episode_len_mean": 257.82, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 46.3, 17.099999999999802, 43.30000000000001, 30.699999999999996, 46.9, -50.00000000000044, -50.00000000000044, 45.9, 6.499999999999652, 44.7, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, 41.90000000000001, 44.900000000000006, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, 36.70000000000003, -50.00000000000044, 33.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 35.70000000000003, 35.70000000000003, 30.099999999999987, 44.5, 39.70000000000002, 28.699999999999967, 45.3, 46.9, 31.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.30000000000003, 44.300000000000004, 35.30000000000004, 30.29999999999999, 36.50000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.10000000000004, 25.499999999999922, 43.50000000000001, 13.499999999999751, -50.00000000000044, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 3.2999999999996064, 44.300000000000004, 44.900000000000006, 37.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, 20.49999999999985, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 43.7, 33.30000000000003, -50.00000000000044, 38.10000000000002, 45.9], "episode_lengths": [76, 38, 330, 68, 194, 32, 500, 500, 42, 436, 54, 236, 500, 500, 94, 44, 500, 500, 500, 302, 82, 52, 500, 68, 94, 500, 500, 500, 74, 500, 500, 402, 500, 134, 500, 166, 116, 500, 500, 500, 50, 144, 144, 200, 56, 104, 214, 48, 32, 190, 58, 500, 500, 56, 500, 92, 52, 500, 500, 84, 500, 138, 58, 148, 198, 136, 124, 500, 500, 74, 160, 246, 66, 366, 500, 30, 36, 500, 500, 36, 62, 468, 58, 52, 126, 500, 64, 500, 296, 210, 500, 500, 38, 40, 500, 64, 168, 500, 120, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4641663743598779, "mean_inference_ms": 1.4780926553554052, "mean_action_processing_ms": 0.17409499601634493, "mean_env_wait_ms": 0.10462695653197202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026633739471435547, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.126084566116333}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5632.963925365728, "num_env_steps_trained_throughput_per_sec": 5632.963925365728, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2360.757, "sample_time_ms": 2029.897, "load_time_ms": 14.103, "load_throughput": 850853.581, "learn_time_ms": 274.577, "learn_throughput": 43703.539, "synch_weights_time_ms": 41.005}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1753, "training_iteration": 39, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-50", "timestamp": 1698246770, "time_this_iter_s": 2.1353137493133545, "time_total_s": 106.67743873596191, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.67743873596191, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.692696359422472, "policy_loss": 7.239594641658995e-05, "vf_loss": 6.692675564024183, "vf_explained_var": -1.3245476616753473e-07, "kl": 5.192860792549128e-05, "entropy": 0.515363613764445, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 711.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.518999999999836, "episode_len_mean": 250.46, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.30000000000003, 44.300000000000004, 35.30000000000004, 30.29999999999999, 36.50000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.10000000000004, 25.499999999999922, 43.50000000000001, 13.499999999999751, -50.00000000000044, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 3.2999999999996064, 44.300000000000004, 44.900000000000006, 37.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, 20.49999999999985, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 43.7, 33.30000000000003, -50.00000000000044, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 25.099999999999916, 11.899999999999729, 46.5, 38.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.500000000000036, 31.300000000000004, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 40.30000000000002, -50.00000000000044, 37.10000000000003, 21.299999999999862, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.9, -50.00000000000044, 45.5, 40.90000000000002, 44.300000000000004, 45.9, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002], "episode_lengths": [190, 58, 500, 500, 56, 500, 92, 52, 500, 500, 84, 500, 138, 58, 148, 198, 136, 124, 500, 500, 74, 160, 246, 66, 366, 500, 30, 36, 500, 500, 36, 62, 468, 58, 52, 126, 500, 64, 500, 296, 210, 500, 500, 38, 40, 500, 64, 168, 500, 120, 42, 500, 500, 186, 500, 500, 44, 500, 132, 66, 500, 42, 500, 40, 250, 382, 36, 116, 284, 500, 500, 146, 188, 500, 84, 48, 500, 500, 58, 102, 98, 500, 130, 288, 54, 50, 500, 500, 36, 46, 32, 500, 46, 92, 58, 42, 500, 116, 500, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.461344287690875, "mean_inference_ms": 1.4709047154749653, "mean_action_processing_ms": 0.17300102164970022, "mean_env_wait_ms": 0.10387838384802649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260465145111084, "StateBufferConnector_ms": 0.007885456085205078, "ViewRequirementAgentConnector_ms": 0.10516142845153809}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.518999999999836, "episode_len_mean": 250.46, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.30000000000003, 44.300000000000004, 35.30000000000004, 30.29999999999999, 36.50000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.10000000000004, 25.499999999999922, 43.50000000000001, 13.499999999999751, -50.00000000000044, 47.1, 46.5, -50.00000000000044, -50.00000000000044, 46.5, 43.900000000000006, 3.2999999999996064, 44.300000000000004, 44.900000000000006, 37.50000000000003, -50.00000000000044, 43.7, -50.00000000000044, 20.49999999999985, 29.099999999999973, -50.00000000000044, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, 43.7, 33.30000000000003, -50.00000000000044, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 25.099999999999916, 11.899999999999729, 46.5, 38.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.500000000000036, 31.300000000000004, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 40.30000000000002, -50.00000000000044, 37.10000000000003, 21.299999999999862, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.9, -50.00000000000044, 45.5, 40.90000000000002, 44.300000000000004, 45.9, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002], "episode_lengths": [190, 58, 500, 500, 56, 500, 92, 52, 500, 500, 84, 500, 138, 58, 148, 198, 136, 124, 500, 500, 74, 160, 246, 66, 366, 500, 30, 36, 500, 500, 36, 62, 468, 58, 52, 126, 500, 64, 500, 296, 210, 500, 500, 38, 40, 500, 64, 168, 500, 120, 42, 500, 500, 186, 500, 500, 44, 500, 132, 66, 500, 42, 500, 40, 250, 382, 36, 116, 284, 500, 500, 146, 188, 500, 84, 48, 500, 500, 58, 102, 98, 500, 130, 288, 54, 50, 500, 500, 36, 46, 32, 500, 46, 92, 58, 42, 500, 116, 500, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.461344287690875, "mean_inference_ms": 1.4709047154749653, "mean_action_processing_ms": 0.17300102164970022, "mean_env_wait_ms": 0.10387838384802649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260465145111084, "StateBufferConnector_ms": 0.007885456085205078, "ViewRequirementAgentConnector_ms": 0.10516142845153809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5097.894809554841, "num_env_steps_trained_throughput_per_sec": 5097.894809554841, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2362.335, "sample_time_ms": 2025.346, "load_time_ms": 27.341, "load_throughput": 438896.942, "learn_time_ms": 267.539, "learn_throughput": 44853.21, "synch_weights_time_ms": 40.934}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1802, "training_iteration": 40, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-52", "timestamp": 1698246772, "time_this_iter_s": 2.359269142150879, "time_total_s": 109.0367078781128, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.0367078781128, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 61.800000000000004, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 7.20794497595893, "policy_loss": -0.00027302900950113934, "vf_loss": 7.208269410663181, "vf_explained_var": 2.748436397976345e-07, "kl": 0.00031641078920882946, "entropy": 0.5133563876152039, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 729.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.012999999999827, "episode_len_mean": 255.52, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 25.099999999999916, 11.899999999999729, 46.5, 38.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.500000000000036, 31.300000000000004, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 40.30000000000002, -50.00000000000044, 37.10000000000003, 21.299999999999862, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.9, -50.00000000000044, 45.5, 40.90000000000002, 44.300000000000004, 45.9, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002, 44.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.099999999999874, 44.300000000000004, 44.5, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, 45.7, 46.3, 45.7, 33.500000000000036, 7.499999999999666, 44.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.10000000000002, 45.3, 17.299999999999805, 45.3, 41.30000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 37.300000000000026, 43.900000000000006, 41.30000000000001, -50.00000000000044, 43.10000000000001, 37.70000000000003, 40.30000000000002, -50.00000000000044, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044], "episode_lengths": [42, 500, 500, 186, 500, 500, 44, 500, 132, 66, 500, 42, 500, 40, 250, 382, 36, 116, 284, 500, 500, 146, 188, 500, 84, 48, 500, 500, 58, 102, 98, 500, 130, 288, 54, 50, 500, 500, 36, 46, 32, 500, 46, 92, 58, 42, 500, 116, 500, 98, 52, 386, 500, 500, 500, 372, 500, 86, 500, 280, 58, 56, 56, 54, 500, 500, 326, 44, 38, 44, 166, 426, 56, 500, 500, 206, 500, 100, 48, 328, 48, 88, 188, 74, 500, 128, 62, 88, 500, 70, 124, 98, 500, 78, 66, 500, 500, 500, 326, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45916189994889406, "mean_inference_ms": 1.465635563164196, "mean_action_processing_ms": 0.17221701815582327, "mean_env_wait_ms": 0.10333794219614316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035865068435668945, "StateBufferConnector_ms": 0.007886409759521484, "ViewRequirementAgentConnector_ms": 0.11265087127685547}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.012999999999827, "episode_len_mean": 255.52, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 36.900000000000034, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 25.099999999999916, 11.899999999999729, 46.5, 38.50000000000003, 21.699999999999868, -50.00000000000044, -50.00000000000044, 35.500000000000036, 31.300000000000004, -50.00000000000044, 41.70000000000002, 45.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.90000000000002, 40.30000000000002, -50.00000000000044, 37.10000000000003, 21.299999999999862, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 45.5, 46.9, -50.00000000000044, 45.5, 40.90000000000002, 44.300000000000004, 45.9, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002, 44.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.099999999999874, 44.300000000000004, 44.5, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, 45.7, 46.3, 45.7, 33.500000000000036, 7.499999999999666, 44.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.10000000000002, 45.3, 17.299999999999805, 45.3, 41.30000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 37.300000000000026, 43.900000000000006, 41.30000000000001, -50.00000000000044, 43.10000000000001, 37.70000000000003, 40.30000000000002, -50.00000000000044, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044], "episode_lengths": [42, 500, 500, 186, 500, 500, 44, 500, 132, 66, 500, 42, 500, 40, 250, 382, 36, 116, 284, 500, 500, 146, 188, 500, 84, 48, 500, 500, 58, 102, 98, 500, 130, 288, 54, 50, 500, 500, 36, 46, 32, 500, 46, 92, 58, 42, 500, 116, 500, 98, 52, 386, 500, 500, 500, 372, 500, 86, 500, 280, 58, 56, 56, 54, 500, 500, 326, 44, 38, 44, 166, 426, 56, 500, 500, 206, 500, 100, 48, 328, 48, 88, 188, 74, 500, 128, 62, 88, 500, 70, 124, 98, 500, 78, 66, 500, 500, 500, 326, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45916189994889406, "mean_inference_ms": 1.465635563164196, "mean_action_processing_ms": 0.17221701815582327, "mean_env_wait_ms": 0.10333794219614316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035865068435668945, "StateBufferConnector_ms": 0.007886409759521484, "ViewRequirementAgentConnector_ms": 0.11265087127685547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5746.584273873262, "num_env_steps_trained_throughput_per_sec": 5746.584273873262, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2350.794, "sample_time_ms": 2024.283, "load_time_ms": 26.764, "load_throughput": 448365.28, "learn_time_ms": 257.837, "learn_throughput": 46541.047, "synch_weights_time_ms": 40.837}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1852, "training_iteration": 41, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-54", "timestamp": 1698246774, "time_this_iter_s": 2.093883752822876, "time_total_s": 111.13059163093567, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.13059163093567, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 60.0, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 6.5082512166765, "policy_loss": -0.00016285106539726257, "vf_loss": 6.5084611309899225, "vf_explained_var": -1.2914339701334636e-06, "kl": 0.0005535733713549638, "entropy": 0.4696415579981274, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 747.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.56299999999982, "episode_len_mean": 260.02, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 40.90000000000002, 44.300000000000004, 45.9, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002, 44.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.099999999999874, 44.300000000000004, 44.5, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, 45.7, 46.3, 45.7, 33.500000000000036, 7.499999999999666, 44.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.10000000000002, 45.3, 17.299999999999805, 45.3, 41.30000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 37.300000000000026, 43.900000000000006, 41.30000000000001, -50.00000000000044, 43.10000000000001, 37.70000000000003, 40.30000000000002, -50.00000000000044, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 12.69999999999974, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.300000000000004, 10.499999999999709, 43.7, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.50000000000001, 10.499999999999709, 36.70000000000003, -50.00000000000044, 43.30000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, 28.29999999999996, 45.3, 40.90000000000002, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 92, 58, 42, 500, 116, 500, 98, 52, 386, 500, 500, 500, 372, 500, 86, 500, 280, 58, 56, 56, 54, 500, 500, 326, 44, 38, 44, 166, 426, 56, 500, 500, 206, 500, 100, 48, 328, 48, 88, 188, 74, 500, 128, 62, 88, 500, 70, 124, 98, 500, 78, 66, 500, 500, 500, 326, 500, 374, 500, 148, 500, 58, 396, 64, 46, 500, 34, 500, 28, 72, 500, 84, 34, 500, 500, 44, 500, 62, 500, 500, 106, 66, 396, 134, 500, 68, 488, 500, 500, 170, 68, 218, 48, 92, 86, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45818551614880887, "mean_inference_ms": 1.4612212478924937, "mean_action_processing_ms": 0.1715933322813305, "mean_env_wait_ms": 0.10319712596559873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026618003845214844, "StateBufferConnector_ms": 0.007778167724609375, "ViewRequirementAgentConnector_ms": 0.12088632583618164}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.56299999999982, "episode_len_mean": 260.02, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 40.90000000000002, 44.300000000000004, 45.9, -50.00000000000044, 38.50000000000003, -50.00000000000044, 40.30000000000002, 44.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, 41.500000000000014, -50.00000000000044, 22.099999999999874, 44.300000000000004, 44.5, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, 45.7, 46.3, 45.7, 33.500000000000036, 7.499999999999666, 44.5, -50.00000000000044, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.10000000000002, 45.3, 17.299999999999805, 45.3, 41.30000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 37.300000000000026, 43.900000000000006, 41.30000000000001, -50.00000000000044, 43.10000000000001, 37.70000000000003, 40.30000000000002, -50.00000000000044, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 12.69999999999974, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.300000000000004, 10.499999999999709, 43.7, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.50000000000001, 10.499999999999709, 36.70000000000003, -50.00000000000044, 43.30000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, 28.29999999999996, 45.3, 40.90000000000002, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 92, 58, 42, 500, 116, 500, 98, 52, 386, 500, 500, 500, 372, 500, 86, 500, 280, 58, 56, 56, 54, 500, 500, 326, 44, 38, 44, 166, 426, 56, 500, 500, 206, 500, 100, 48, 328, 48, 88, 188, 74, 500, 128, 62, 88, 500, 70, 124, 98, 500, 78, 66, 500, 500, 500, 326, 500, 374, 500, 148, 500, 58, 396, 64, 46, 500, 34, 500, 28, 72, 500, 84, 34, 500, 500, 44, 500, 62, 500, 500, 106, 66, 396, 134, 500, 68, 488, 500, 500, 170, 68, 218, 48, 92, 86, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45818551614880887, "mean_inference_ms": 1.4612212478924937, "mean_action_processing_ms": 0.1715933322813305, "mean_env_wait_ms": 0.10319712596559873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026618003845214844, "StateBufferConnector_ms": 0.007778167724609375, "ViewRequirementAgentConnector_ms": 0.12088632583618164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5107.428858575227, "num_env_steps_trained_throughput_per_sec": 5107.428858575227, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2363.063, "sample_time_ms": 2020.485, "load_time_ms": 26.077, "load_throughput": 460178.854, "learn_time_ms": 243.739, "learn_throughput": 49232.951, "synch_weights_time_ms": 71.664}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1893, "training_iteration": 42, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-57", "timestamp": 1698246777, "time_this_iter_s": 2.3545174598693848, "time_total_s": 113.48510909080505, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.48510909080505, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 54.825, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.3438149558173285, "policy_loss": -2.5640086581309635e-05, "vf_loss": 6.3438858720991345, "vf_explained_var": -4.238552517361111e-07, "kl": 0.00017181924919087678, "entropy": 0.454119763440556, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.835999999999804, "episode_len_mean": 272.22, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 41.30000000000001, -50.00000000000044, 43.10000000000001, 37.70000000000003, 40.30000000000002, -50.00000000000044, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 12.69999999999974, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.300000000000004, 10.499999999999709, 43.7, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.50000000000001, 10.499999999999709, 36.70000000000003, -50.00000000000044, 43.30000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, 28.29999999999996, 45.3, 40.90000000000002, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 47.1, -50.00000000000044, 28.89999999999997, 43.7, 45.1, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 40.70000000000002, 44.7, 38.300000000000026, 44.5, -50.00000000000044, 46.9, 44.10000000000001, 33.70000000000004], "episode_lengths": [62, 88, 500, 70, 124, 98, 500, 78, 66, 500, 500, 500, 326, 500, 374, 500, 148, 500, 58, 396, 64, 46, 500, 34, 500, 28, 72, 500, 84, 34, 500, 500, 44, 500, 62, 500, 500, 106, 66, 396, 134, 500, 68, 488, 500, 500, 170, 68, 218, 48, 92, 86, 46, 500, 500, 500, 500, 44, 500, 54, 500, 500, 500, 500, 500, 44, 500, 38, 500, 30, 500, 212, 64, 50, 500, 66, 62, 500, 500, 170, 56, 56, 500, 500, 146, 500, 500, 50, 500, 500, 62, 98, 94, 54, 118, 56, 500, 32, 60, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561390662610216, "mean_inference_ms": 1.4555586327842969, "mean_action_processing_ms": 0.1710958436753036, "mean_env_wait_ms": 0.10297534810877078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023648738861083984, "StateBufferConnector_ms": 0.008778095245361328, "ViewRequirementAgentConnector_ms": 0.12556171417236328}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.835999999999804, "episode_len_mean": 272.22, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 41.30000000000001, -50.00000000000044, 43.10000000000001, 37.70000000000003, 40.30000000000002, -50.00000000000044, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 12.69999999999974, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.300000000000004, 10.499999999999709, 43.7, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.50000000000001, 10.499999999999709, 36.70000000000003, -50.00000000000044, 43.30000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.30000000000001, 28.29999999999996, 45.3, 40.90000000000002, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 47.1, -50.00000000000044, 28.89999999999997, 43.7, 45.1, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 40.70000000000002, 44.7, 38.300000000000026, 44.5, -50.00000000000044, 46.9, 44.10000000000001, 33.70000000000004], "episode_lengths": [62, 88, 500, 70, 124, 98, 500, 78, 66, 500, 500, 500, 326, 500, 374, 500, 148, 500, 58, 396, 64, 46, 500, 34, 500, 28, 72, 500, 84, 34, 500, 500, 44, 500, 62, 500, 500, 106, 66, 396, 134, 500, 68, 488, 500, 500, 170, 68, 218, 48, 92, 86, 46, 500, 500, 500, 500, 44, 500, 54, 500, 500, 500, 500, 500, 44, 500, 38, 500, 30, 500, 212, 64, 50, 500, 66, 62, 500, 500, 170, 56, 56, 500, 500, 146, 500, 500, 50, 500, 500, 62, 98, 94, 54, 118, 56, 500, 32, 60, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4561390662610216, "mean_inference_ms": 1.4555586327842969, "mean_action_processing_ms": 0.1710958436753036, "mean_env_wait_ms": 0.10297534810877078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023648738861083984, "StateBufferConnector_ms": 0.008778095245361328, "ViewRequirementAgentConnector_ms": 0.12556171417236328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5697.350530097734, "num_env_steps_trained_throughput_per_sec": 5697.350530097734, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2334.706, "sample_time_ms": 2001.124, "load_time_ms": 25.679, "load_throughput": 467311.095, "learn_time_ms": 235.072, "learn_throughput": 51048.098, "synch_weights_time_ms": 71.732}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1938, "training_iteration": 43, "trial_id": "9f288_00008", "date": "2023-10-25_16-12-59", "timestamp": 1698246779, "time_this_iter_s": 2.1107866764068604, "time_total_s": 115.59589576721191, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.59589576721191, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 61.53333333333334, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.780467510223389, "policy_loss": -0.00021346345440381102, "vf_loss": 6.780731280644734, "vf_explained_var": -1.8676122029622395e-06, "kl": 0.00026738859867473747, "entropy": 0.5034488108423021, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 783.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8199999999998124, "episode_len_mean": 262.4, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.10000000000003, 43.30000000000001, 28.29999999999996, 45.3, 40.90000000000002, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 47.1, -50.00000000000044, 28.89999999999997, 43.7, 45.1, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 40.70000000000002, 44.7, 38.300000000000026, 44.5, -50.00000000000044, 46.9, 44.10000000000001, 33.70000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 29.099999999999973, 34.900000000000034, 47.1, 45.5, 30.099999999999987, 41.90000000000001, -50.00000000000044, 44.900000000000006, 2.699999999999598, 47.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 17.69999999999981, 41.500000000000014, 46.699999999999996, -50.00000000000044, 43.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 43.900000000000006, 47.5, 47.3, 45.3, 8.49999999999968], "episode_lengths": [170, 68, 218, 48, 92, 86, 46, 500, 500, 500, 500, 44, 500, 54, 500, 500, 500, 500, 500, 44, 500, 38, 500, 30, 500, 212, 64, 50, 500, 66, 62, 500, 500, 170, 56, 56, 500, 500, 146, 500, 500, 50, 500, 500, 62, 98, 94, 54, 118, 56, 500, 32, 60, 164, 74, 500, 500, 46, 500, 274, 500, 500, 210, 152, 30, 46, 200, 82, 500, 52, 474, 30, 500, 320, 500, 324, 86, 34, 500, 64, 38, 500, 500, 500, 256, 500, 52, 46, 500, 42, 500, 500, 44, 76, 500, 62, 26, 28, 48, 416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45430960350080946, "mean_inference_ms": 1.4491815695910686, "mean_action_processing_ms": 0.1704025464191482, "mean_env_wait_ms": 0.1024565163875695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025579214096069336, "StateBufferConnector_ms": 0.011707305908203125, "ViewRequirementAgentConnector_ms": 0.11615109443664551}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8199999999998124, "episode_len_mean": 262.4, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.10000000000003, 43.30000000000001, 28.29999999999996, 45.3, 40.90000000000002, 41.500000000000014, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, 47.1, -50.00000000000044, 28.89999999999997, 43.7, 45.1, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.10000000000003, 44.5, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 40.70000000000002, 44.7, 38.300000000000026, 44.5, -50.00000000000044, 46.9, 44.10000000000001, 33.70000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 29.099999999999973, 34.900000000000034, 47.1, 45.5, 30.099999999999987, 41.90000000000001, -50.00000000000044, 44.900000000000006, 2.699999999999598, 47.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 17.69999999999981, 41.500000000000014, 46.699999999999996, -50.00000000000044, 43.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 43.900000000000006, 47.5, 47.3, 45.3, 8.49999999999968], "episode_lengths": [170, 68, 218, 48, 92, 86, 46, 500, 500, 500, 500, 44, 500, 54, 500, 500, 500, 500, 500, 44, 500, 38, 500, 30, 500, 212, 64, 50, 500, 66, 62, 500, 500, 170, 56, 56, 500, 500, 146, 500, 500, 50, 500, 500, 62, 98, 94, 54, 118, 56, 500, 32, 60, 164, 74, 500, 500, 46, 500, 274, 500, 500, 210, 152, 30, 46, 200, 82, 500, 52, 474, 30, 500, 320, 500, 324, 86, 34, 500, 64, 38, 500, 500, 500, 256, 500, 52, 46, 500, 42, 500, 500, 44, 76, 500, 62, 26, 28, 48, 416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45430960350080946, "mean_inference_ms": 1.4491815695910686, "mean_action_processing_ms": 0.1704025464191482, "mean_env_wait_ms": 0.1024565163875695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025579214096069336, "StateBufferConnector_ms": 0.011707305908203125, "ViewRequirementAgentConnector_ms": 0.11615109443664551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.689394603196, "num_env_steps_trained_throughput_per_sec": 5512.689394603196, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2294.635, "sample_time_ms": 1951.011, "load_time_ms": 26.308, "load_throughput": 456131.087, "learn_time_ms": 244.626, "learn_throughput": 49054.557, "synch_weights_time_ms": 71.691}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1984, "training_iteration": 44, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-01", "timestamp": 1698246781, "time_this_iter_s": 2.1817948818206787, "time_total_s": 117.77769064903259, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.77769064903259, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.6487701998816595, "policy_loss": -0.0003752000629901886, "vf_loss": 6.649192916022407, "vf_explained_var": -1.3576613532172308e-07, "kl": 0.00047865968507486575, "entropy": 0.4767911665969425, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 801.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.061999999999826, "episode_len_mean": 250.02, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 44.10000000000001, 33.70000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 29.099999999999973, 34.900000000000034, 47.1, 45.5, 30.099999999999987, 41.90000000000001, -50.00000000000044, 44.900000000000006, 2.699999999999598, 47.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 17.69999999999981, 41.500000000000014, 46.699999999999996, -50.00000000000044, 43.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 43.900000000000006, 47.5, 47.3, 45.3, 8.49999999999968, -50.00000000000044, 45.9, 31.900000000000013, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, 47.3, 44.7, 34.50000000000004, 45.5, 39.50000000000002, 22.699999999999882, 41.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.30000000000001, 44.5, -50.00000000000044, 46.3, 11.699999999999726, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.5, 42.500000000000014], "episode_lengths": [500, 32, 60, 164, 74, 500, 500, 46, 500, 274, 500, 500, 210, 152, 30, 46, 200, 82, 500, 52, 474, 30, 500, 320, 500, 324, 86, 34, 500, 64, 38, 500, 500, 500, 256, 500, 52, 46, 500, 42, 500, 500, 44, 76, 500, 62, 26, 28, 48, 416, 500, 42, 182, 500, 130, 500, 500, 34, 500, 80, 80, 42, 500, 500, 50, 500, 500, 38, 82, 82, 500, 100, 28, 54, 156, 46, 106, 274, 86, 196, 500, 500, 500, 56, 68, 56, 500, 38, 384, 132, 500, 500, 114, 46, 40, 500, 170, 500, 46, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4513137816822421, "mean_inference_ms": 1.4424286202089989, "mean_action_processing_ms": 0.16946789036926588, "mean_env_wait_ms": 0.10186305822669638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02377915382385254, "StateBufferConnector_ms": 0.008701324462890625, "ViewRequirementAgentConnector_ms": 0.11648058891296387}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.061999999999826, "episode_len_mean": 250.02, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 44.10000000000001, 33.70000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 29.099999999999973, 34.900000000000034, 47.1, 45.5, 30.099999999999987, 41.90000000000001, -50.00000000000044, 44.900000000000006, 2.699999999999598, 47.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 17.69999999999981, 41.500000000000014, 46.699999999999996, -50.00000000000044, 43.7, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, -50.00000000000044, 44.900000000000006, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 43.900000000000006, 47.5, 47.3, 45.3, 8.49999999999968, -50.00000000000044, 45.9, 31.900000000000013, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, 47.3, 44.7, 34.50000000000004, 45.5, 39.50000000000002, 22.699999999999882, 41.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.30000000000001, 44.5, -50.00000000000044, 46.3, 11.699999999999726, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.5, 42.500000000000014], "episode_lengths": [500, 32, 60, 164, 74, 500, 500, 46, 500, 274, 500, 500, 210, 152, 30, 46, 200, 82, 500, 52, 474, 30, 500, 320, 500, 324, 86, 34, 500, 64, 38, 500, 500, 500, 256, 500, 52, 46, 500, 42, 500, 500, 44, 76, 500, 62, 26, 28, 48, 416, 500, 42, 182, 500, 130, 500, 500, 34, 500, 80, 80, 42, 500, 500, 50, 500, 500, 38, 82, 82, 500, 100, 28, 54, 156, 46, 106, 274, 86, 196, 500, 500, 500, 56, 68, 56, 500, 38, 384, 132, 500, 500, 114, 46, 40, 500, 170, 500, 46, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4513137816822421, "mean_inference_ms": 1.4424286202089989, "mean_action_processing_ms": 0.16946789036926588, "mean_env_wait_ms": 0.10186305822669638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02377915382385254, "StateBufferConnector_ms": 0.008701324462890625, "ViewRequirementAgentConnector_ms": 0.11648058891296387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5630.140411081875, "num_env_steps_trained_throughput_per_sec": 5630.140411081875, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2259.992, "sample_time_ms": 1939.212, "load_time_ms": 24.508, "load_throughput": 489637.001, "learn_time_ms": 224.032, "learn_throughput": 53563.76, "synch_weights_time_ms": 71.241}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2034, "training_iteration": 45, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-03", "timestamp": 1698246783, "time_this_iter_s": 2.136767625808716, "time_total_s": 119.91445827484131, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 119.91445827484131, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 65.8, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.448096646202935, "policy_loss": 5.78724882668919e-05, "vf_loss": 6.44808636771308, "vf_explained_var": -2.076228459676107e-06, "kl": 0.00015394932636228178, "entropy": 0.47522659765349495, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 819.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.003999999999828, "episode_len_mean": 250.6, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 42.500000000000014, -50.00000000000044, 43.900000000000006, 47.5, 47.3, 45.3, 8.49999999999968, -50.00000000000044, 45.9, 31.900000000000013, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, 47.3, 44.7, 34.50000000000004, 45.5, 39.50000000000002, 22.699999999999882, 41.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.30000000000001, 44.5, -50.00000000000044, 46.3, 11.699999999999726, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 35.900000000000034, -50.00000000000044, 45.5, 38.90000000000002, 11.29999999999972, -50.00000000000044, 45.9, 42.70000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.70000000000001, 17.69999999999981, 34.30000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.90000000000003, 29.69999999999998, 43.900000000000006, 43.50000000000001, 39.90000000000002], "episode_lengths": [44, 76, 500, 62, 26, 28, 48, 416, 500, 42, 182, 500, 130, 500, 500, 34, 500, 80, 80, 42, 500, 500, 50, 500, 500, 38, 82, 82, 500, 100, 28, 54, 156, 46, 106, 274, 86, 196, 500, 500, 500, 56, 68, 56, 500, 38, 384, 132, 500, 500, 114, 46, 40, 500, 170, 500, 46, 76, 500, 42, 500, 500, 500, 500, 130, 36, 142, 500, 46, 112, 388, 500, 42, 74, 488, 500, 500, 500, 26, 500, 74, 324, 158, 500, 140, 500, 92, 192, 80, 500, 500, 56, 500, 500, 48, 122, 204, 62, 66, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505328691872223, "mean_inference_ms": 1.4381397676674792, "mean_action_processing_ms": 0.16881539005090476, "mean_env_wait_ms": 0.10142512397044852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999688148498535, "StateBufferConnector_ms": 0.004703998565673828, "ViewRequirementAgentConnector_ms": 0.12276148796081543}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.003999999999828, "episode_len_mean": 250.6, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 42.500000000000014, -50.00000000000044, 43.900000000000006, 47.5, 47.3, 45.3, 8.49999999999968, -50.00000000000044, 45.9, 31.900000000000013, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 42.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.3, 41.90000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, 47.3, 44.7, 34.50000000000004, 45.5, 39.50000000000002, 22.699999999999882, 41.500000000000014, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 43.30000000000001, 44.5, -50.00000000000044, 46.3, 11.699999999999726, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 35.900000000000034, -50.00000000000044, 45.5, 38.90000000000002, 11.29999999999972, -50.00000000000044, 45.9, 42.70000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.70000000000001, 17.69999999999981, 34.30000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.90000000000003, 29.69999999999998, 43.900000000000006, 43.50000000000001, 39.90000000000002], "episode_lengths": [44, 76, 500, 62, 26, 28, 48, 416, 500, 42, 182, 500, 130, 500, 500, 34, 500, 80, 80, 42, 500, 500, 50, 500, 500, 38, 82, 82, 500, 100, 28, 54, 156, 46, 106, 274, 86, 196, 500, 500, 500, 56, 68, 56, 500, 38, 384, 132, 500, 500, 114, 46, 40, 500, 170, 500, 46, 76, 500, 42, 500, 500, 500, 500, 130, 36, 142, 500, 46, 112, 388, 500, 42, 74, 488, 500, 500, 500, 26, 500, 74, 324, 158, 500, 140, 500, 92, 192, 80, 500, 500, 56, 500, 500, 48, 122, 204, 62, 66, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505328691872223, "mean_inference_ms": 1.4381397676674792, "mean_action_processing_ms": 0.16881539005090476, "mean_env_wait_ms": 0.10142512397044852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999688148498535, "StateBufferConnector_ms": 0.004703998565673828, "ViewRequirementAgentConnector_ms": 0.12276148796081543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5816.336888582372, "num_env_steps_trained_throughput_per_sec": 5816.336888582372, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2240.223, "sample_time_ms": 1931.219, "load_time_ms": 23.827, "load_throughput": 503629.234, "learn_time_ms": 212.736, "learn_throughput": 56407.838, "synch_weights_time_ms": 71.341}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2076, "training_iteration": 46, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-05", "timestamp": 1698246785, "time_this_iter_s": 2.067873477935791, "time_total_s": 121.9823317527771, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.9823317527771, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.411102268430922, "policy_loss": 2.12998129427433e-05, "vf_loss": 6.411127302381727, "vf_explained_var": 2.483526865641276e-07, "kl": 4.720340497025669e-05, "entropy": 0.4647762460841073, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 837.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.194999999999808, "episode_len_mean": 273.66, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 44.5, -50.00000000000044, 46.3, 11.699999999999726, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 35.900000000000034, -50.00000000000044, 45.5, 38.90000000000002, 11.29999999999972, -50.00000000000044, 45.9, 42.70000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.70000000000001, 17.69999999999981, 34.30000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.90000000000003, 29.69999999999998, 43.900000000000006, 43.50000000000001, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 39.10000000000002, 40.500000000000014, 43.30000000000001, 46.099999999999994, 12.299999999999734, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 30.9, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 6.299999999999649, 46.699999999999996, 47.5, 46.099999999999994], "episode_lengths": [68, 56, 500, 38, 384, 132, 500, 500, 114, 46, 40, 500, 170, 500, 46, 76, 500, 42, 500, 500, 500, 500, 130, 36, 142, 500, 46, 112, 388, 500, 42, 74, 488, 500, 500, 500, 26, 500, 74, 324, 158, 500, 140, 500, 92, 192, 80, 500, 500, 56, 500, 500, 48, 122, 204, 62, 66, 102, 110, 500, 500, 136, 82, 500, 500, 100, 98, 500, 500, 500, 480, 500, 56, 48, 500, 500, 40, 66, 500, 110, 96, 68, 40, 378, 500, 414, 500, 500, 192, 54, 182, 500, 500, 58, 500, 104, 438, 34, 26, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45049077938498017, "mean_inference_ms": 1.435466492765264, "mean_action_processing_ms": 0.16848341318041724, "mean_env_wait_ms": 0.1009441378502493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995948791503906, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.12914729118347168}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.194999999999808, "episode_len_mean": 273.66, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 44.5, -50.00000000000044, 46.3, 11.699999999999726, 36.900000000000034, -50.00000000000044, -50.00000000000044, 38.700000000000024, 45.5, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, 35.900000000000034, -50.00000000000044, 45.5, 38.90000000000002, 11.29999999999972, -50.00000000000044, 45.9, 42.70000000000001, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 42.70000000000001, 17.69999999999981, 34.30000000000004, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 37.90000000000003, 29.69999999999998, 43.900000000000006, 43.50000000000001, 39.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 39.10000000000002, 40.500000000000014, 43.30000000000001, 46.099999999999994, 12.299999999999734, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 30.9, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 6.299999999999649, 46.699999999999996, 47.5, 46.099999999999994], "episode_lengths": [68, 56, 500, 38, 384, 132, 500, 500, 114, 46, 40, 500, 170, 500, 46, 76, 500, 42, 500, 500, 500, 500, 130, 36, 142, 500, 46, 112, 388, 500, 42, 74, 488, 500, 500, 500, 26, 500, 74, 324, 158, 500, 140, 500, 92, 192, 80, 500, 500, 56, 500, 500, 48, 122, 204, 62, 66, 102, 110, 500, 500, 136, 82, 500, 500, 100, 98, 500, 500, 500, 480, 500, 56, 48, 500, 500, 40, 66, 500, 110, 96, 68, 40, 378, 500, 414, 500, 500, 192, 54, 182, 500, 500, 58, 500, 104, 438, 34, 26, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45049077938498017, "mean_inference_ms": 1.435466492765264, "mean_action_processing_ms": 0.16848341318041724, "mean_env_wait_ms": 0.1009441378502493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995948791503906, "StateBufferConnector_ms": 0.0030024051666259766, "ViewRequirementAgentConnector_ms": 0.12914729118347168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5777.621100793057, "num_env_steps_trained_throughput_per_sec": 5777.621100793057, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2226.151, "sample_time_ms": 1929.111, "load_time_ms": 23.47, "load_throughput": 511300.436, "learn_time_ms": 201.206, "learn_throughput": 59640.491, "synch_weights_time_ms": 71.266}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2118, "training_iteration": 47, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-07", "timestamp": 1698246787, "time_this_iter_s": 2.081976890563965, "time_total_s": 124.06430864334106, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 124.06430864334106, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 7.108134773042467, "policy_loss": -0.0001404678655995263, "vf_loss": 7.108326991399129, "vf_explained_var": -5.927350785997179e-07, "kl": 0.00012341948809850103, "entropy": 0.5173623710870743, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.65999999999984, "episode_len_mean": 244.06, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.50000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 39.10000000000002, 40.500000000000014, 43.30000000000001, 46.099999999999994, 12.299999999999734, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 30.9, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 6.299999999999649, 46.699999999999996, 47.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, 30.499999999999993, 29.299999999999976, 38.300000000000026, 39.90000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, 45.5, 46.5, 44.300000000000004, 39.70000000000002, 46.699999999999996, 40.10000000000002, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 32.50000000000002, 37.300000000000026, -50.00000000000044, 42.900000000000006, 44.900000000000006, 39.300000000000026, 45.1, 14.899999999999771, 33.30000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 46.9, 34.70000000000004, 44.10000000000001, 37.10000000000003, 44.900000000000006, 39.70000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [500, 500, 136, 82, 500, 500, 100, 98, 500, 500, 500, 480, 500, 56, 48, 500, 500, 40, 66, 500, 110, 96, 68, 40, 378, 500, 414, 500, 500, 192, 54, 182, 500, 500, 58, 500, 104, 438, 34, 26, 40, 500, 500, 36, 142, 196, 208, 118, 102, 32, 56, 500, 500, 56, 130, 46, 36, 58, 104, 34, 100, 500, 222, 50, 500, 500, 30, 72, 500, 500, 42, 148, 500, 36, 500, 176, 128, 500, 72, 52, 108, 50, 352, 168, 122, 500, 500, 70, 500, 48, 32, 154, 60, 130, 52, 104, 72, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4482824893050629, "mean_inference_ms": 1.429435817802932, "mean_action_processing_ms": 0.16740161635175826, "mean_env_wait_ms": 0.10023539585938496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02074909210205078, "StateBufferConnector_ms": 0.002070188522338867, "ViewRequirementAgentConnector_ms": 0.1183617115020752}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.65999999999984, "episode_len_mean": 244.06, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 36.50000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, -50.00000000000044, 39.10000000000002, 40.500000000000014, 43.30000000000001, 46.099999999999994, 12.299999999999734, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, 30.9, 44.7, 31.900000000000013, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.70000000000002, 6.299999999999649, 46.699999999999996, 47.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, 30.499999999999993, 29.299999999999976, 38.300000000000026, 39.90000000000002, 46.9, 44.5, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, 45.5, 46.5, 44.300000000000004, 39.70000000000002, 46.699999999999996, 40.10000000000002, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 32.50000000000002, 37.300000000000026, -50.00000000000044, 42.900000000000006, 44.900000000000006, 39.300000000000026, 45.1, 14.899999999999771, 33.30000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 46.9, 34.70000000000004, 44.10000000000001, 37.10000000000003, 44.900000000000006, 39.70000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [500, 500, 136, 82, 500, 500, 100, 98, 500, 500, 500, 480, 500, 56, 48, 500, 500, 40, 66, 500, 110, 96, 68, 40, 378, 500, 414, 500, 500, 192, 54, 182, 500, 500, 58, 500, 104, 438, 34, 26, 40, 500, 500, 36, 142, 196, 208, 118, 102, 32, 56, 500, 500, 56, 130, 46, 36, 58, 104, 34, 100, 500, 222, 50, 500, 500, 30, 72, 500, 500, 42, 148, 500, 36, 500, 176, 128, 500, 72, 52, 108, 50, 352, 168, 122, 500, 500, 70, 500, 48, 32, 154, 60, 130, 52, 104, 72, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4482824893050629, "mean_inference_ms": 1.429435817802932, "mean_action_processing_ms": 0.16740161635175826, "mean_env_wait_ms": 0.10023539585938496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02074909210205078, "StateBufferConnector_ms": 0.002070188522338867, "ViewRequirementAgentConnector_ms": 0.1183617115020752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5423.064714556589, "num_env_steps_trained_throughput_per_sec": 5423.064714556589, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2168.927, "sample_time_ms": 1917.0, "load_time_ms": 23.116, "load_throughput": 519121.123, "learn_time_ms": 187.343, "learn_throughput": 64053.658, "synch_weights_time_ms": 40.298}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2177, "training_iteration": 48, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-09", "timestamp": 1698246789, "time_this_iter_s": 2.218320846557617, "time_total_s": 126.28262948989868, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.28262948989868, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 60.53333333333334, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.755821784337361, "policy_loss": -8.049151963657803e-05, "vf_loss": 6.7559545040130615, "vf_explained_var": -2.761681874593099e-06, "kl": 0.0003089355926262114, "entropy": 0.5215966833962334, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 873.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.854999999999862, "episode_len_mean": 227.14, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, 45.5, 46.5, 44.300000000000004, 39.70000000000002, 46.699999999999996, 40.10000000000002, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 32.50000000000002, 37.300000000000026, -50.00000000000044, 42.900000000000006, 44.900000000000006, 39.300000000000026, 45.1, 14.899999999999771, 33.30000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 46.9, 34.70000000000004, 44.10000000000001, 37.10000000000003, 44.900000000000006, 39.70000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, 45.5, 42.900000000000006, 29.69999999999998, 46.9, 45.5, -50.00000000000044, 24.899999999999913, 39.50000000000002, 39.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 15.49999999999978, -50.00000000000044, 40.10000000000002, 44.300000000000004, 42.10000000000001, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 39.70000000000002, 42.30000000000001, 44.5, 34.30000000000004, 23.099999999999888, 30.099999999999987, 45.9, 29.299999999999976, 29.099999999999973, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.90000000000002, 43.7, 45.7], "episode_lengths": [56, 500, 500, 56, 130, 46, 36, 58, 104, 34, 100, 500, 222, 50, 500, 500, 30, 72, 500, 500, 42, 148, 500, 36, 500, 176, 128, 500, 72, 52, 108, 50, 352, 168, 122, 500, 500, 70, 500, 48, 32, 154, 60, 130, 52, 104, 72, 500, 500, 62, 198, 500, 46, 72, 204, 32, 46, 500, 252, 106, 104, 500, 70, 52, 500, 346, 500, 100, 58, 80, 44, 500, 110, 500, 500, 500, 54, 140, 104, 78, 56, 158, 270, 200, 42, 208, 210, 500, 168, 500, 500, 110, 500, 500, 500, 500, 64, 92, 64, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4470802016432407, "mean_inference_ms": 1.4244404720023551, "mean_action_processing_ms": 0.166857479093492, "mean_env_wait_ms": 0.09974838586075224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025530099868774414, "StateBufferConnector_ms": 0.003827333450317383, "ViewRequirementAgentConnector_ms": 0.11440038681030273}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.854999999999862, "episode_len_mean": 227.14, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, 45.5, 46.5, 44.300000000000004, 39.70000000000002, 46.699999999999996, 40.10000000000002, -50.00000000000044, 27.899999999999956, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 32.50000000000002, 37.300000000000026, -50.00000000000044, 42.900000000000006, 44.900000000000006, 39.300000000000026, 45.1, 14.899999999999771, 33.30000000000003, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.3, 46.9, 34.70000000000004, 44.10000000000001, 37.10000000000003, 44.900000000000006, 39.70000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, 45.5, 42.900000000000006, 29.69999999999998, 46.9, 45.5, -50.00000000000044, 24.899999999999913, 39.50000000000002, 39.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 15.49999999999978, -50.00000000000044, 40.10000000000002, 44.300000000000004, 42.10000000000001, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 39.70000000000002, 42.30000000000001, 44.5, 34.30000000000004, 23.099999999999888, 30.099999999999987, 45.9, 29.299999999999976, 29.099999999999973, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.90000000000002, 43.7, 45.7], "episode_lengths": [56, 500, 500, 56, 130, 46, 36, 58, 104, 34, 100, 500, 222, 50, 500, 500, 30, 72, 500, 500, 42, 148, 500, 36, 500, 176, 128, 500, 72, 52, 108, 50, 352, 168, 122, 500, 500, 70, 500, 48, 32, 154, 60, 130, 52, 104, 72, 500, 500, 62, 198, 500, 46, 72, 204, 32, 46, 500, 252, 106, 104, 500, 70, 52, 500, 346, 500, 100, 58, 80, 44, 500, 110, 500, 500, 500, 54, 140, 104, 78, 56, 158, 270, 200, 42, 208, 210, 500, 168, 500, 500, 110, 500, 500, 500, 500, 64, 92, 64, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4470802016432407, "mean_inference_ms": 1.4244404720023551, "mean_action_processing_ms": 0.166857479093492, "mean_env_wait_ms": 0.09974838586075224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025530099868774414, "StateBufferConnector_ms": 0.003827333450317383, "ViewRequirementAgentConnector_ms": 0.11440038681030273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5478.656254694204, "num_env_steps_trained_throughput_per_sec": 5478.656254694204, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2174.927, "sample_time_ms": 1915.926, "load_time_ms": 23.454, "load_throughput": 511641.397, "learn_time_ms": 194.023, "learn_throughput": 61848.295, "synch_weights_time_ms": 40.354}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2227, "training_iteration": 49, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-12", "timestamp": 1698246792, "time_this_iter_s": 2.1953177452087402, "time_total_s": 128.47794723510742, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.47794723510742, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 61.1, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 7.079650163650513, "policy_loss": 2.9382192426257665e-05, "vf_loss": 7.079676442676121, "vf_explained_var": -2.1523899502224394e-06, "kl": 0.00013958021421305803, "entropy": 0.5554836458630033, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 891.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.120999999999835, "episode_len_mean": 254.44, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, 45.5, 42.900000000000006, 29.69999999999998, 46.9, 45.5, -50.00000000000044, 24.899999999999913, 39.50000000000002, 39.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 15.49999999999978, -50.00000000000044, 40.10000000000002, 44.300000000000004, 42.10000000000001, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 39.70000000000002, 42.30000000000001, 44.5, 34.30000000000004, 23.099999999999888, 30.099999999999987, 45.9, 29.299999999999976, 29.099999999999973, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.90000000000002, 43.7, 45.7, -50.00000000000044, 32.50000000000002, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.10000000000002, 45.1, 43.50000000000001, 43.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 30.9, 10.699999999999712, 39.10000000000002, 43.7, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 41.30000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, 13.699999999999754, 20.699999999999854, -50.00000000000044, 33.10000000000003, 42.70000000000001], "episode_lengths": [500, 62, 198, 500, 46, 72, 204, 32, 46, 500, 252, 106, 104, 500, 70, 52, 500, 346, 500, 100, 58, 80, 44, 500, 110, 500, 500, 500, 54, 140, 104, 78, 56, 158, 270, 200, 42, 208, 210, 500, 168, 500, 500, 110, 500, 500, 500, 500, 64, 92, 64, 44, 500, 176, 54, 500, 500, 88, 500, 66, 500, 120, 50, 66, 68, 32, 500, 500, 500, 134, 54, 398, 500, 54, 500, 192, 394, 110, 64, 500, 50, 170, 140, 88, 90, 500, 500, 500, 500, 184, 38, 500, 500, 50, 68, 364, 294, 500, 170, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44450542040491475, "mean_inference_ms": 1.4205895092521528, "mean_action_processing_ms": 0.16654654018300083, "mean_env_wait_ms": 0.0996201745318764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023797273635864258, "StateBufferConnector_ms": 0.004756450653076172, "ViewRequirementAgentConnector_ms": 0.11566591262817383}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.120999999999835, "episode_len_mean": 254.44, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, 45.5, 42.900000000000006, 29.69999999999998, 46.9, 45.5, -50.00000000000044, 24.899999999999913, 39.50000000000002, 39.70000000000002, -50.00000000000044, 43.10000000000001, 44.900000000000006, -50.00000000000044, 15.49999999999978, -50.00000000000044, 40.10000000000002, 44.300000000000004, 42.10000000000001, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 39.70000000000002, 42.30000000000001, 44.5, 34.30000000000004, 23.099999999999888, 30.099999999999987, 45.9, 29.299999999999976, 29.099999999999973, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.90000000000002, 43.7, 45.7, -50.00000000000044, 32.50000000000002, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.10000000000002, 45.1, 43.50000000000001, 43.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 30.9, 10.699999999999712, 39.10000000000002, 43.7, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 41.30000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, 13.699999999999754, 20.699999999999854, -50.00000000000044, 33.10000000000003, 42.70000000000001], "episode_lengths": [500, 62, 198, 500, 46, 72, 204, 32, 46, 500, 252, 106, 104, 500, 70, 52, 500, 346, 500, 100, 58, 80, 44, 500, 110, 500, 500, 500, 54, 140, 104, 78, 56, 158, 270, 200, 42, 208, 210, 500, 168, 500, 500, 110, 500, 500, 500, 500, 64, 92, 64, 44, 500, 176, 54, 500, 500, 88, 500, 66, 500, 120, 50, 66, 68, 32, 500, 500, 500, 134, 54, 398, 500, 54, 500, 192, 394, 110, 64, 500, 50, 170, 140, 88, 90, 500, 500, 500, 500, 184, 38, 500, 500, 50, 68, 364, 294, 500, 170, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44450542040491475, "mean_inference_ms": 1.4205895092521528, "mean_action_processing_ms": 0.16654654018300083, "mean_env_wait_ms": 0.0996201745318764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023797273635864258, "StateBufferConnector_ms": 0.004756450653076172, "ViewRequirementAgentConnector_ms": 0.11566591262817383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5446.163734476561, "num_env_steps_trained_throughput_per_sec": 5446.163734476561, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2159.875, "sample_time_ms": 1911.123, "load_time_ms": 10.195, "load_throughput": 1177001.585, "learn_time_ms": 197.048, "learn_throughput": 60899.016, "synch_weights_time_ms": 40.339}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2275, "training_iteration": 50, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-14", "timestamp": 1698246794, "time_this_iter_s": 2.2079155445098877, "time_total_s": 130.6858627796173, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 130.6858627796173, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.709352625740899, "policy_loss": -0.0004891293744246165, "vf_loss": 6.709898683759901, "vf_explained_var": -1.8941031561957466e-06, "kl": 0.000395723525438522, "entropy": 0.5691784703069263, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 909.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.72299999999985, "episode_len_mean": 238.46, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 43.7, 45.7, -50.00000000000044, 32.50000000000002, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.10000000000002, 45.1, 43.50000000000001, 43.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 30.9, 10.699999999999712, 39.10000000000002, 43.7, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 41.30000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, 13.699999999999754, 20.699999999999854, -50.00000000000044, 33.10000000000003, 42.70000000000001, 31.500000000000007, 42.70000000000001, 46.5, 46.099999999999994, -50.00000000000044, 29.899999999999984, 32.100000000000016, -50.00000000000044, 35.70000000000003, 45.5, 47.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 46.9, 21.499999999999865, 44.900000000000006, 41.500000000000014, 28.09999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 19.899999999999842, -50.00000000000044, 41.30000000000001, 45.5, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.49999999999995, 43.30000000000001, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 39.50000000000002, 35.30000000000004, 44.5, 45.7, 44.5, -50.00000000000044, 6.299999999999649, 41.70000000000002], "episode_lengths": [92, 64, 44, 500, 176, 54, 500, 500, 88, 500, 66, 500, 120, 50, 66, 68, 32, 500, 500, 500, 134, 54, 398, 500, 54, 500, 192, 394, 110, 64, 500, 50, 170, 140, 88, 90, 500, 500, 500, 500, 184, 38, 500, 500, 50, 68, 364, 294, 500, 170, 74, 186, 74, 36, 40, 500, 202, 180, 500, 144, 46, 24, 500, 60, 500, 28, 154, 32, 286, 52, 86, 220, 36, 500, 500, 48, 500, 302, 500, 88, 46, 362, 78, 500, 500, 96, 226, 68, 500, 56, 58, 500, 106, 148, 56, 44, 56, 500, 438, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4437026212679897, "mean_inference_ms": 1.417372940771831, "mean_action_processing_ms": 0.16629866693517875, "mean_env_wait_ms": 0.09977595823592388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.13021397590637207}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.72299999999985, "episode_len_mean": 238.46, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 43.7, 45.7, -50.00000000000044, 32.50000000000002, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.10000000000002, 45.1, 43.50000000000001, 43.30000000000001, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.7, 10.299999999999706, -50.00000000000044, 44.7, -50.00000000000044, 30.9, 10.699999999999712, 39.10000000000002, 43.7, -50.00000000000044, 45.1, 33.10000000000003, 36.10000000000004, 41.30000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, 13.699999999999754, 20.699999999999854, -50.00000000000044, 33.10000000000003, 42.70000000000001, 31.500000000000007, 42.70000000000001, 46.5, 46.099999999999994, -50.00000000000044, 29.899999999999984, 32.100000000000016, -50.00000000000044, 35.70000000000003, 45.5, 47.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 46.9, 21.499999999999865, 44.900000000000006, 41.500000000000014, 28.09999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 19.899999999999842, -50.00000000000044, 41.30000000000001, 45.5, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.49999999999995, 43.30000000000001, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 39.50000000000002, 35.30000000000004, 44.5, 45.7, 44.5, -50.00000000000044, 6.299999999999649, 41.70000000000002], "episode_lengths": [92, 64, 44, 500, 176, 54, 500, 500, 88, 500, 66, 500, 120, 50, 66, 68, 32, 500, 500, 500, 134, 54, 398, 500, 54, 500, 192, 394, 110, 64, 500, 50, 170, 140, 88, 90, 500, 500, 500, 500, 184, 38, 500, 500, 50, 68, 364, 294, 500, 170, 74, 186, 74, 36, 40, 500, 202, 180, 500, 144, 46, 24, 500, 60, 500, 28, 154, 32, 286, 52, 86, 220, 36, 500, 500, 48, 500, 302, 500, 88, 46, 362, 78, 500, 500, 96, 226, 68, 500, 56, 58, 500, 106, 148, 56, 44, 56, 500, 438, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4437026212679897, "mean_inference_ms": 1.417372940771831, "mean_action_processing_ms": 0.16629866693517875, "mean_env_wait_ms": 0.09977595823592388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.13021397590637207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5429.907507957958, "num_env_steps_trained_throughput_per_sec": 5429.907507957958, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2172.053, "sample_time_ms": 1925.801, "load_time_ms": 9.988, "load_throughput": 1201413.291, "learn_time_ms": 194.611, "learn_throughput": 61661.483, "synch_weights_time_ms": 40.383}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2324, "training_iteration": 51, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-16", "timestamp": 1698246796, "time_this_iter_s": 2.214454174041748, "time_total_s": 132.90031695365906, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.90031695365906, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.666666666666664, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.185076793034871, "policy_loss": -0.00010396876475877232, "vf_loss": 6.185231712129381, "vf_explained_var": -2.2980901930067275e-06, "kl": 0.00036730740857314633, "entropy": 0.5088821417755551, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 927.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.302999999999832, "episode_len_mean": 252.62, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, 13.699999999999754, 20.699999999999854, -50.00000000000044, 33.10000000000003, 42.70000000000001, 31.500000000000007, 42.70000000000001, 46.5, 46.099999999999994, -50.00000000000044, 29.899999999999984, 32.100000000000016, -50.00000000000044, 35.70000000000003, 45.5, 47.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 46.9, 21.499999999999865, 44.900000000000006, 41.500000000000014, 28.09999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 19.899999999999842, -50.00000000000044, 41.30000000000001, 45.5, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.49999999999995, 43.30000000000001, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 39.50000000000002, 35.30000000000004, 44.5, 45.7, 44.5, -50.00000000000044, 6.299999999999649, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 30.099999999999987, 25.29999999999992, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, 11.099999999999717, 44.10000000000001, 36.10000000000004, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.50000000000003, 33.70000000000004, 45.9, 43.900000000000006, 41.100000000000016, 27.49999999999995, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 46.9], "episode_lengths": [38, 500, 500, 50, 68, 364, 294, 500, 170, 74, 186, 74, 36, 40, 500, 202, 180, 500, 144, 46, 24, 500, 60, 500, 28, 154, 32, 286, 52, 86, 220, 36, 500, 500, 48, 500, 302, 500, 88, 46, 362, 78, 500, 500, 96, 226, 68, 500, 56, 58, 500, 106, 148, 56, 44, 56, 500, 438, 84, 500, 500, 500, 500, 94, 500, 500, 500, 500, 28, 500, 500, 500, 96, 500, 52, 200, 248, 500, 114, 54, 500, 500, 390, 60, 140, 54, 500, 94, 500, 116, 164, 42, 62, 90, 226, 500, 48, 54, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4442682471091978, "mean_inference_ms": 1.4153737484770923, "mean_action_processing_ms": 0.1660266495877821, "mean_env_wait_ms": 0.09986514189103152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020763874053955078, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.1496739387512207}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.302999999999832, "episode_len_mean": 252.62, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 45.1, 43.30000000000001, 13.699999999999754, 20.699999999999854, -50.00000000000044, 33.10000000000003, 42.70000000000001, 31.500000000000007, 42.70000000000001, 46.5, 46.099999999999994, -50.00000000000044, 29.899999999999984, 32.100000000000016, -50.00000000000044, 35.70000000000003, 45.5, 47.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 46.9, 21.499999999999865, 44.900000000000006, 41.500000000000014, 28.09999999999996, 46.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 19.899999999999842, -50.00000000000044, 41.30000000000001, 45.5, 13.899999999999757, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 27.49999999999995, 43.30000000000001, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 39.50000000000002, 35.30000000000004, 44.5, 45.7, 44.5, -50.00000000000044, 6.299999999999649, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 30.099999999999987, 25.29999999999992, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, 11.099999999999717, 44.10000000000001, 36.10000000000004, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.50000000000003, 33.70000000000004, 45.9, 43.900000000000006, 41.100000000000016, 27.49999999999995, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 46.9], "episode_lengths": [38, 500, 500, 50, 68, 364, 294, 500, 170, 74, 186, 74, 36, 40, 500, 202, 180, 500, 144, 46, 24, 500, 60, 500, 28, 154, 32, 286, 52, 86, 220, 36, 500, 500, 48, 500, 302, 500, 88, 46, 362, 78, 500, 500, 96, 226, 68, 500, 56, 58, 500, 106, 148, 56, 44, 56, 500, 438, 84, 500, 500, 500, 500, 94, 500, 500, 500, 500, 28, 500, 500, 500, 96, 500, 52, 200, 248, 500, 114, 54, 500, 500, 390, 60, 140, 54, 500, 94, 500, 116, 164, 42, 62, 90, 226, 500, 48, 54, 500, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4442682471091978, "mean_inference_ms": 1.4153737484770923, "mean_action_processing_ms": 0.1660266495877821, "mean_env_wait_ms": 0.09986514189103152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020763874053955078, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.1496739387512207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5071.253463387464, "num_env_steps_trained_throughput_per_sec": 5071.253463387464, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2173.729, "sample_time_ms": 1942.418, "load_time_ms": 11.992, "load_throughput": 1000653.057, "learn_time_ms": 208.166, "learn_throughput": 57646.215, "synch_weights_time_ms": 9.882}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2365, "training_iteration": 52, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-19", "timestamp": 1698246799, "time_this_iter_s": 2.371278762817383, "time_total_s": 135.27159571647644, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.27159571647644, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 59.425, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.258954869376288, "policy_loss": -2.7484777900907728e-05, "vf_loss": 6.2590341038174095, "vf_explained_var": -1.142422358194987e-06, "kl": 9.274821091606909e-05, "entropy": 0.5163448916541206, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.179999999999814, "episode_len_mean": 268.8, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 27.49999999999995, 43.30000000000001, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 39.50000000000002, 35.30000000000004, 44.5, 45.7, 44.5, -50.00000000000044, 6.299999999999649, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 30.099999999999987, 25.29999999999992, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, 11.099999999999717, 44.10000000000001, 36.10000000000004, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.50000000000003, 33.70000000000004, 45.9, 43.900000000000006, 41.100000000000016, 27.49999999999995, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 46.9, 26.499999999999936, 25.699999999999925, 44.5, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 32.50000000000002, -50.00000000000044, 40.500000000000014, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 38.10000000000002, 45.7, 42.900000000000006, 44.900000000000006, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001], "episode_lengths": [500, 96, 226, 68, 500, 56, 58, 500, 106, 148, 56, 44, 56, 500, 438, 84, 500, 500, 500, 500, 94, 500, 500, 500, 500, 28, 500, 500, 500, 96, 500, 52, 200, 248, 500, 114, 54, 500, 500, 390, 60, 140, 54, 500, 94, 500, 116, 164, 42, 62, 90, 226, 500, 48, 54, 500, 32, 236, 244, 56, 500, 350, 500, 500, 56, 188, 176, 500, 96, 44, 500, 110, 500, 368, 500, 54, 500, 50, 52, 500, 500, 56, 500, 500, 42, 44, 500, 118, 500, 120, 44, 72, 52, 42, 66, 500, 500, 500, 176, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44385195091927415, "mean_inference_ms": 1.414644367913165, "mean_action_processing_ms": 0.16550891381915026, "mean_env_wait_ms": 0.0994195685374684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024549245834350586, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.15341567993164062}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.179999999999814, "episode_len_mean": 268.8, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 27.49999999999995, 43.30000000000001, -50.00000000000044, 44.5, 44.300000000000004, -50.00000000000044, 39.50000000000002, 35.30000000000004, 44.5, 45.7, 44.5, -50.00000000000044, 6.299999999999649, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 30.099999999999987, 25.29999999999992, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, 11.099999999999717, 44.10000000000001, 36.10000000000004, 44.7, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.50000000000003, 33.70000000000004, 45.9, 43.900000000000006, 41.100000000000016, 27.49999999999995, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 46.9, 26.499999999999936, 25.699999999999925, 44.5, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 32.50000000000002, -50.00000000000044, 40.500000000000014, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 38.10000000000002, 45.7, 42.900000000000006, 44.900000000000006, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001], "episode_lengths": [500, 96, 226, 68, 500, 56, 58, 500, 106, 148, 56, 44, 56, 500, 438, 84, 500, 500, 500, 500, 94, 500, 500, 500, 500, 28, 500, 500, 500, 96, 500, 52, 200, 248, 500, 114, 54, 500, 500, 390, 60, 140, 54, 500, 94, 500, 116, 164, 42, 62, 90, 226, 500, 48, 54, 500, 32, 236, 244, 56, 500, 350, 500, 500, 56, 188, 176, 500, 96, 44, 500, 110, 500, 368, 500, 54, 500, 50, 52, 500, 500, 56, 500, 500, 42, 44, 500, 118, 500, 120, 44, 72, 52, 42, 66, 500, 500, 500, 176, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44385195091927415, "mean_inference_ms": 1.414644367913165, "mean_action_processing_ms": 0.16550891381915026, "mean_env_wait_ms": 0.0994195685374684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024549245834350586, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.15341567993164062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5333.553181986045, "num_env_steps_trained_throughput_per_sec": 5333.553181986045, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2188.096, "sample_time_ms": 1954.28, "load_time_ms": 11.882, "load_throughput": 1009933.422, "learn_time_ms": 210.614, "learn_throughput": 56976.337, "synch_weights_time_ms": 10.05}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2408, "training_iteration": 53, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-21", "timestamp": 1698246801, "time_this_iter_s": 2.2549068927764893, "time_total_s": 137.52650260925293, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 137.52650260925293, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 6.797580083211263, "policy_loss": 3.674978183375465e-05, "vf_loss": 6.797597063912286, "vf_explained_var": -6.523397233751085e-07, "kl": 6.390031775222522e-05, "entropy": 0.5354539288414849, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 963.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.34099999999982, "episode_len_mean": 262.2, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, 33.70000000000004, 45.9, 43.900000000000006, 41.100000000000016, 27.49999999999995, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 46.9, 26.499999999999936, 25.699999999999925, 44.5, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 32.50000000000002, -50.00000000000044, 40.500000000000014, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 38.10000000000002, 45.7, 42.900000000000006, 44.900000000000006, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 35.900000000000034, 45.3, 38.90000000000002, 37.300000000000026, 10.299999999999706, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.300000000000004, 42.900000000000006, 44.7, -50.00000000000044, 11.29999999999972, -50.00000000000044, 36.50000000000003, -50.00000000000044, 21.499999999999865, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [500, 116, 164, 42, 62, 90, 226, 500, 48, 54, 500, 32, 236, 244, 56, 500, 350, 500, 500, 56, 188, 176, 500, 96, 44, 500, 110, 500, 368, 500, 54, 500, 50, 52, 500, 500, 56, 500, 500, 42, 44, 500, 118, 500, 120, 44, 72, 52, 42, 66, 500, 500, 500, 176, 74, 62, 36, 500, 500, 54, 500, 70, 500, 86, 500, 44, 500, 142, 48, 112, 128, 398, 124, 500, 500, 130, 52, 500, 500, 38, 62, 106, 500, 500, 58, 500, 500, 66, 58, 72, 54, 500, 388, 500, 136, 500, 286, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44255821976959714, "mean_inference_ms": 1.4118269807553838, "mean_action_processing_ms": 0.1654362158890626, "mean_env_wait_ms": 0.09925276215893396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02955913543701172, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.15036773681640625}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.34099999999982, "episode_len_mean": 262.2, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.50000000000003, 33.70000000000004, 45.9, 43.900000000000006, 41.100000000000016, 27.49999999999995, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 46.9, 26.499999999999936, 25.699999999999925, 44.5, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 32.50000000000002, -50.00000000000044, 40.500000000000014, 45.7, -50.00000000000044, 39.10000000000002, -50.00000000000044, 13.299999999999748, -50.00000000000044, 44.7, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, 38.10000000000002, 45.7, 42.900000000000006, 44.900000000000006, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 35.900000000000034, 45.3, 38.90000000000002, 37.300000000000026, 10.299999999999706, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.300000000000004, 42.900000000000006, 44.7, -50.00000000000044, 11.29999999999972, -50.00000000000044, 36.50000000000003, -50.00000000000044, 21.499999999999865, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [500, 116, 164, 42, 62, 90, 226, 500, 48, 54, 500, 32, 236, 244, 56, 500, 350, 500, 500, 56, 188, 176, 500, 96, 44, 500, 110, 500, 368, 500, 54, 500, 50, 52, 500, 500, 56, 500, 500, 42, 44, 500, 118, 500, 120, 44, 72, 52, 42, 66, 500, 500, 500, 176, 74, 62, 36, 500, 500, 54, 500, 70, 500, 86, 500, 44, 500, 142, 48, 112, 128, 398, 124, 500, 500, 130, 52, 500, 500, 38, 62, 106, 500, 500, 58, 500, 500, 66, 58, 72, 54, 500, 388, 500, 136, 500, 286, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44255821976959714, "mean_inference_ms": 1.4118269807553838, "mean_action_processing_ms": 0.1654362158890626, "mean_env_wait_ms": 0.09925276215893396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02955913543701172, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.15036773681640625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4820.545020768945, "num_env_steps_trained_throughput_per_sec": 4820.545020768945, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2219.351, "sample_time_ms": 1971.395, "load_time_ms": 12.222, "load_throughput": 981849.124, "learn_time_ms": 224.221, "learn_throughput": 53518.714, "synch_weights_time_ms": 10.243}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2453, "training_iteration": 54, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-23", "timestamp": 1698246803, "time_this_iter_s": 2.495346784591675, "time_total_s": 140.0218493938446, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.0218493938446, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 67.36666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.690115928649902, "policy_loss": -0.0007078564829296536, "vf_loss": 6.690878444247776, "vf_explained_var": 4.6028031243218317e-07, "kl": 0.001019907465250627, "entropy": 0.5483935359451506, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 981.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.827999999999822, "episode_len_mean": 262.34, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 35.900000000000034, 45.3, 38.90000000000002, 37.300000000000026, 10.299999999999706, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.300000000000004, 42.900000000000006, 44.7, -50.00000000000044, 11.29999999999972, -50.00000000000044, 36.50000000000003, -50.00000000000044, 21.499999999999865, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.5, 19.69999999999984, 41.90000000000001, 10.699999999999712, -50.00000000000044, -50.00000000000044, 30.699999999999996, 38.90000000000002, 32.700000000000024, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, 46.099999999999994, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 24.69999999999991, 32.90000000000003, 34.50000000000004, 45.9, 14.09999999999976, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 45.9, 31.900000000000013, 44.900000000000006, 46.9, 42.500000000000014, 30.29999999999999, -50.00000000000044, 44.7, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 66, 500, 500, 500, 176, 74, 62, 36, 500, 500, 54, 500, 70, 500, 86, 500, 44, 500, 142, 48, 112, 128, 398, 124, 500, 500, 130, 52, 500, 500, 38, 62, 106, 500, 500, 58, 500, 500, 66, 58, 72, 54, 500, 388, 500, 136, 500, 286, 500, 90, 500, 500, 46, 304, 82, 394, 500, 500, 194, 112, 174, 500, 138, 500, 62, 40, 50, 152, 500, 500, 52, 500, 44, 254, 172, 156, 42, 360, 500, 232, 500, 500, 42, 62, 42, 182, 52, 32, 76, 198, 500, 54, 52, 78, 500, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4414151850415392, "mean_inference_ms": 1.408907182120401, "mean_action_processing_ms": 0.16504879981495815, "mean_env_wait_ms": 0.09900104631111413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.15398240089416504}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.827999999999822, "episode_len_mean": 262.34, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 43.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 35.900000000000034, 45.3, 38.90000000000002, 37.300000000000026, 10.299999999999706, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.10000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.300000000000004, 42.900000000000006, 44.7, -50.00000000000044, 11.29999999999972, -50.00000000000044, 36.50000000000003, -50.00000000000044, 21.499999999999865, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.5, 19.69999999999984, 41.90000000000001, 10.699999999999712, -50.00000000000044, -50.00000000000044, 30.699999999999996, 38.90000000000002, 32.700000000000024, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, 46.099999999999994, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 24.69999999999991, 32.90000000000003, 34.50000000000004, 45.9, 14.09999999999976, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 45.9, 31.900000000000013, 44.900000000000006, 46.9, 42.500000000000014, 30.29999999999999, -50.00000000000044, 44.7, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [42, 66, 500, 500, 500, 176, 74, 62, 36, 500, 500, 54, 500, 70, 500, 86, 500, 44, 500, 142, 48, 112, 128, 398, 124, 500, 500, 130, 52, 500, 500, 38, 62, 106, 500, 500, 58, 500, 500, 66, 58, 72, 54, 500, 388, 500, 136, 500, 286, 500, 90, 500, 500, 46, 304, 82, 394, 500, 500, 194, 112, 174, 500, 138, 500, 62, 40, 50, 152, 500, 500, 52, 500, 44, 254, 172, 156, 42, 360, 500, 232, 500, 500, 42, 62, 42, 182, 52, 32, 76, 198, 500, 54, 52, 78, 500, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4414151850415392, "mean_inference_ms": 1.408907182120401, "mean_action_processing_ms": 0.16504879981495815, "mean_env_wait_ms": 0.09900104631111413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900075912475586, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.15398240089416504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5502.319523980221, "num_env_steps_trained_throughput_per_sec": 5502.319523980221, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2224.302, "sample_time_ms": 1975.18, "load_time_ms": 11.925, "load_throughput": 1006278.75, "learn_time_ms": 225.804, "learn_throughput": 53143.547, "synch_weights_time_ms": 10.223}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2501, "training_iteration": 55, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-26", "timestamp": 1698246806, "time_this_iter_s": 2.185896158218384, "time_total_s": 142.207745552063, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.207745552063, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.975515445073445, "policy_loss": -0.0006978019244141049, "vf_loss": 6.976270172331068, "vf_explained_var": -2.0199351840549043e-06, "kl": 0.0009892397044318892, "entropy": 0.5681977768739065, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 999.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.211999999999838, "episode_len_mean": 248.54, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 19.69999999999984, 41.90000000000001, 10.699999999999712, -50.00000000000044, -50.00000000000044, 30.699999999999996, 38.90000000000002, 32.700000000000024, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, 46.099999999999994, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 24.69999999999991, 32.90000000000003, 34.50000000000004, 45.9, 14.09999999999976, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 45.9, 31.900000000000013, 44.900000000000006, 46.9, 42.500000000000014, 30.29999999999999, -50.00000000000044, 44.7, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.70000000000001, 45.1, 10.099999999999703, 36.10000000000004, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, 46.3, 11.099999999999717, 45.9, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 21.89999999999987, 45.1, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.5, 35.900000000000034, 33.10000000000003, 9.299999999999692, -50.00000000000044, 45.5, 45.1, 43.10000000000001, 41.30000000000001, 43.30000000000001, 44.900000000000006, 42.70000000000001, 45.7], "episode_lengths": [500, 46, 304, 82, 394, 500, 500, 194, 112, 174, 500, 138, 500, 62, 40, 50, 152, 500, 500, 52, 500, 44, 254, 172, 156, 42, 360, 500, 232, 500, 500, 42, 62, 42, 182, 52, 32, 76, 198, 500, 54, 52, 78, 500, 46, 500, 500, 500, 500, 500, 54, 500, 500, 128, 500, 74, 50, 400, 140, 58, 56, 500, 500, 82, 118, 38, 390, 42, 128, 500, 500, 64, 282, 50, 112, 500, 500, 42, 500, 500, 500, 30, 500, 132, 500, 500, 150, 46, 142, 170, 408, 500, 46, 50, 70, 88, 68, 52, 74, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4400987775416361, "mean_inference_ms": 1.4061042124329284, "mean_action_processing_ms": 0.16454215197356592, "mean_env_wait_ms": 0.09865344512692613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299666404724121, "StateBufferConnector_ms": 0.007875442504882812, "ViewRequirementAgentConnector_ms": 0.13156580924987793}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.211999999999838, "episode_len_mean": 248.54, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 19.69999999999984, 41.90000000000001, 10.699999999999712, -50.00000000000044, -50.00000000000044, 30.699999999999996, 38.90000000000002, 32.700000000000024, -50.00000000000044, 36.30000000000003, -50.00000000000044, 43.900000000000006, 46.099999999999994, 45.1, 34.900000000000034, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.7, 24.69999999999991, 32.90000000000003, 34.50000000000004, 45.9, 14.09999999999976, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 45.9, 43.900000000000006, 45.9, 31.900000000000013, 44.900000000000006, 46.9, 42.500000000000014, 30.29999999999999, -50.00000000000044, 44.7, 44.900000000000006, 42.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.70000000000001, 45.1, 10.099999999999703, 36.10000000000004, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, 46.3, 11.099999999999717, 45.9, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 21.89999999999987, 45.1, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.5, 35.900000000000034, 33.10000000000003, 9.299999999999692, -50.00000000000044, 45.5, 45.1, 43.10000000000001, 41.30000000000001, 43.30000000000001, 44.900000000000006, 42.70000000000001, 45.7], "episode_lengths": [500, 46, 304, 82, 394, 500, 500, 194, 112, 174, 500, 138, 500, 62, 40, 50, 152, 500, 500, 52, 500, 44, 254, 172, 156, 42, 360, 500, 232, 500, 500, 42, 62, 42, 182, 52, 32, 76, 198, 500, 54, 52, 78, 500, 46, 500, 500, 500, 500, 500, 54, 500, 500, 128, 500, 74, 50, 400, 140, 58, 56, 500, 500, 82, 118, 38, 390, 42, 128, 500, 500, 64, 282, 50, 112, 500, 500, 42, 500, 500, 500, 30, 500, 132, 500, 500, 150, 46, 142, 170, 408, 500, 46, 50, 70, 88, 68, 52, 74, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4400987775416361, "mean_inference_ms": 1.4061042124329284, "mean_action_processing_ms": 0.16454215197356592, "mean_env_wait_ms": 0.09865344512692613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299666404724121, "StateBufferConnector_ms": 0.007875442504882812, "ViewRequirementAgentConnector_ms": 0.13156580924987793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5340.450021900115, "num_env_steps_trained_throughput_per_sec": 5340.450021900115, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2242.687, "sample_time_ms": 1980.254, "load_time_ms": 12.521, "load_throughput": 958407.796, "learn_time_ms": 238.835, "learn_throughput": 50243.837, "synch_weights_time_ms": 10.105}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2553, "training_iteration": 56, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-28", "timestamp": 1698246808, "time_this_iter_s": 2.2529964447021484, "time_total_s": 144.46074199676514, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.46074199676514, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.37499999999999, "ram_util_percent": 26.650000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.854940546883477, "policy_loss": -0.0003643367025587294, "vf_loss": 6.855355554156834, "vf_explained_var": 6.324715084499783e-07, "kl": 0.0009158056341473437, "entropy": 0.5070448882049985, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1017.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.907999999999821, "episode_len_mean": 261.56, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.70000000000001, 45.1, 10.099999999999703, 36.10000000000004, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, 46.3, 11.099999999999717, 45.9, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 21.89999999999987, 45.1, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.5, 35.900000000000034, 33.10000000000003, 9.299999999999692, -50.00000000000044, 45.5, 45.1, 43.10000000000001, 41.30000000000001, 43.30000000000001, 44.900000000000006, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, 28.09999999999996, 46.699999999999996, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, 34.900000000000034, 45.9, 30.499999999999993, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 34.30000000000004, 40.30000000000002, 21.89999999999987, -50.00000000000044, 43.30000000000001, 20.699999999999854, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.49999999999988, 46.699999999999996, -50.00000000000044, 3.0999999999996035, 31.70000000000001, 8.49999999999968, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 54, 500, 500, 128, 500, 74, 50, 400, 140, 58, 56, 500, 500, 82, 118, 38, 390, 42, 128, 500, 500, 64, 282, 50, 112, 500, 500, 42, 500, 500, 500, 30, 500, 132, 500, 500, 150, 46, 142, 170, 408, 500, 46, 50, 70, 88, 68, 52, 74, 44, 500, 500, 500, 290, 500, 134, 500, 36, 500, 220, 34, 52, 500, 42, 40, 152, 42, 196, 56, 46, 500, 500, 40, 248, 68, 158, 98, 282, 500, 68, 294, 42, 66, 500, 500, 500, 88, 106, 276, 34, 500, 470, 184, 416, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43885714186105873, "mean_inference_ms": 1.403778341023125, "mean_action_processing_ms": 0.1642786462992729, "mean_env_wait_ms": 0.09846009298602787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025528907775878906, "StateBufferConnector_ms": 0.008877754211425781, "ViewRequirementAgentConnector_ms": 0.12303495407104492}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.907999999999821, "episode_len_mean": 261.56, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 42.70000000000001, 45.1, 10.099999999999703, 36.10000000000004, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, 46.3, 11.099999999999717, 45.9, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 21.89999999999987, 45.1, 38.90000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.5, 35.900000000000034, 33.10000000000003, 9.299999999999692, -50.00000000000044, 45.5, 45.1, 43.10000000000001, 41.30000000000001, 43.30000000000001, 44.900000000000006, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, 28.09999999999996, 46.699999999999996, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, 34.900000000000034, 45.9, 30.499999999999993, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 34.30000000000004, 40.30000000000002, 21.89999999999987, -50.00000000000044, 43.30000000000001, 20.699999999999854, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.49999999999988, 46.699999999999996, -50.00000000000044, 3.0999999999996035, 31.70000000000001, 8.49999999999968, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 54, 500, 500, 128, 500, 74, 50, 400, 140, 58, 56, 500, 500, 82, 118, 38, 390, 42, 128, 500, 500, 64, 282, 50, 112, 500, 500, 42, 500, 500, 500, 30, 500, 132, 500, 500, 150, 46, 142, 170, 408, 500, 46, 50, 70, 88, 68, 52, 74, 44, 500, 500, 500, 290, 500, 134, 500, 36, 500, 220, 34, 52, 500, 42, 40, 152, 42, 196, 56, 46, 500, 500, 40, 248, 68, 158, 98, 282, 500, 68, 294, 42, 66, 500, 500, 500, 88, 106, 276, 34, 500, 470, 184, 416, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43885714186105873, "mean_inference_ms": 1.403778341023125, "mean_action_processing_ms": 0.1642786462992729, "mean_env_wait_ms": 0.09846009298602787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025528907775878906, "StateBufferConnector_ms": 0.008877754211425781, "ViewRequirementAgentConnector_ms": 0.12303495407104492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5200.655552528053, "num_env_steps_trained_throughput_per_sec": 5200.655552528053, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2265.729, "sample_time_ms": 1993.234, "load_time_ms": 13.178, "load_throughput": 910602.628, "learn_time_ms": 248.246, "learn_throughput": 48339.245, "synch_weights_time_ms": 10.0}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2598, "training_iteration": 57, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-30", "timestamp": 1698246810, "time_this_iter_s": 2.3121814727783203, "time_total_s": 146.77292346954346, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.77292346954346, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 65.73333333333333, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.424644814597236, "policy_loss": -0.00024656951427459717, "vf_loss": 6.424939235051473, "vf_explained_var": -8.742014567057291e-07, "kl": 0.000439204582471437, "entropy": 0.4789804601007038, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.565999999999843, "episode_len_mean": 235.02, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, 28.09999999999996, 46.699999999999996, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, 34.900000000000034, 45.9, 30.499999999999993, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 34.30000000000004, 40.30000000000002, 21.89999999999987, -50.00000000000044, 43.30000000000001, 20.699999999999854, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.49999999999988, 46.699999999999996, -50.00000000000044, 3.0999999999996035, 31.70000000000001, 8.49999999999968, -50.00000000000044, 44.900000000000006, 47.5, 47.5, -50.00000000000044, 34.10000000000004, 47.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.299999999999933, 47.3, 46.099999999999994, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 32.30000000000002, 45.7, 35.70000000000003, 38.10000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 8.099999999999675, 42.10000000000001, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 35.70000000000003, 40.70000000000002, 42.70000000000001, 23.099999999999888, -50.00000000000044, 42.30000000000001], "episode_lengths": [52, 74, 44, 500, 500, 500, 290, 500, 134, 500, 36, 500, 220, 34, 52, 500, 42, 40, 152, 42, 196, 56, 46, 500, 500, 40, 248, 68, 158, 98, 282, 500, 68, 294, 42, 66, 500, 500, 500, 88, 106, 276, 34, 500, 470, 184, 416, 500, 52, 26, 26, 500, 160, 28, 500, 62, 34, 58, 38, 500, 500, 44, 500, 500, 238, 28, 40, 40, 38, 500, 500, 38, 500, 32, 178, 44, 144, 120, 78, 500, 500, 500, 500, 62, 106, 420, 80, 500, 46, 50, 500, 36, 48, 500, 144, 94, 74, 270, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43790449890858185, "mean_inference_ms": 1.4017133623694198, "mean_action_processing_ms": 0.1641755666144529, "mean_env_wait_ms": 0.09852543938808511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03154182434082031, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.11906290054321289}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.565999999999843, "episode_len_mean": 235.02, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 42.70000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, -50.00000000000044, 28.09999999999996, 46.699999999999996, 44.900000000000006, -50.00000000000044, 45.9, 46.099999999999994, 34.900000000000034, 45.9, 30.499999999999993, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.29999999999992, 43.30000000000001, 34.30000000000004, 40.30000000000002, 21.89999999999987, -50.00000000000044, 43.30000000000001, 20.699999999999854, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.49999999999988, 46.699999999999996, -50.00000000000044, 3.0999999999996035, 31.70000000000001, 8.49999999999968, -50.00000000000044, 44.900000000000006, 47.5, 47.5, -50.00000000000044, 34.10000000000004, 47.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.299999999999933, 47.3, 46.099999999999994, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 32.30000000000002, 45.7, 35.70000000000003, 38.10000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 8.099999999999675, 42.10000000000001, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 35.70000000000003, 40.70000000000002, 42.70000000000001, 23.099999999999888, -50.00000000000044, 42.30000000000001], "episode_lengths": [52, 74, 44, 500, 500, 500, 290, 500, 134, 500, 36, 500, 220, 34, 52, 500, 42, 40, 152, 42, 196, 56, 46, 500, 500, 40, 248, 68, 158, 98, 282, 500, 68, 294, 42, 66, 500, 500, 500, 88, 106, 276, 34, 500, 470, 184, 416, 500, 52, 26, 26, 500, 160, 28, 500, 62, 34, 58, 38, 500, 500, 44, 500, 500, 238, 28, 40, 40, 38, 500, 500, 38, 500, 32, 178, 44, 144, 120, 78, 500, 500, 500, 500, 62, 106, 420, 80, 500, 46, 50, 500, 36, 48, 500, 144, 94, 74, 270, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43790449890858185, "mean_inference_ms": 1.4017133623694198, "mean_action_processing_ms": 0.1641755666144529, "mean_env_wait_ms": 0.09852543938808511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03154182434082031, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.11906290054321289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5523.569384207477, "num_env_steps_trained_throughput_per_sec": 5523.569384207477, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2261.703, "sample_time_ms": 2005.598, "load_time_ms": 12.531, "load_throughput": 957596.365, "learn_time_ms": 232.53, "learn_throughput": 51606.187, "synch_weights_time_ms": 10.043}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2650, "training_iteration": 58, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-32", "timestamp": 1698246812, "time_this_iter_s": 2.1766891479492188, "time_total_s": 148.94961261749268, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.94961261749268, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 63.96666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.013351334465875, "policy_loss": -0.00037300840227140323, "vf_loss": 6.0137696795993385, "vf_explained_var": 2.9471185472276477e-07, "kl": 0.0006041980206974687, "entropy": 0.45238301157951355, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1053.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.624999999999816, "episode_len_mean": 259.36, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 39.50000000000002, 22.49999999999988, 46.699999999999996, -50.00000000000044, 3.0999999999996035, 31.70000000000001, 8.49999999999968, -50.00000000000044, 44.900000000000006, 47.5, 47.5, -50.00000000000044, 34.10000000000004, 47.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.299999999999933, 47.3, 46.099999999999994, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 32.30000000000002, 45.7, 35.70000000000003, 38.10000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 8.099999999999675, 42.10000000000001, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 35.70000000000003, 40.70000000000002, 42.70000000000001, 23.099999999999888, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.10000000000004, 44.10000000000001, 43.10000000000001, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 46.099999999999994, -50.00000000000044, 35.70000000000003, 42.500000000000014, 33.90000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.90000000000002, -50.00000000000044, 9.099999999999689, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 88, 106, 276, 34, 500, 470, 184, 416, 500, 52, 26, 26, 500, 160, 28, 500, 62, 34, 58, 38, 500, 500, 44, 500, 500, 238, 28, 40, 40, 38, 500, 500, 38, 500, 32, 178, 44, 144, 120, 78, 500, 500, 500, 500, 62, 106, 420, 80, 500, 46, 50, 500, 36, 48, 500, 144, 94, 74, 270, 500, 78, 500, 160, 60, 70, 44, 28, 500, 500, 500, 34, 500, 24, 500, 500, 52, 30, 40, 500, 144, 76, 162, 500, 50, 500, 500, 100, 102, 500, 410, 110, 500, 500, 112, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43794662820731894, "mean_inference_ms": 1.400690698881266, "mean_action_processing_ms": 0.16411402112622053, "mean_env_wait_ms": 0.09855709767753516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03101515769958496, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12003612518310547}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.624999999999816, "episode_len_mean": 259.36, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 39.50000000000002, 22.49999999999988, 46.699999999999996, -50.00000000000044, 3.0999999999996035, 31.70000000000001, 8.49999999999968, -50.00000000000044, 44.900000000000006, 47.5, 47.5, -50.00000000000044, 34.10000000000004, 47.3, -50.00000000000044, 43.900000000000006, 46.699999999999996, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 26.299999999999933, 47.3, 46.099999999999994, 46.099999999999994, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 46.9, 32.30000000000002, 45.7, 35.70000000000003, 38.10000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 8.099999999999675, 42.10000000000001, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 35.70000000000003, 40.70000000000002, 42.70000000000001, 23.099999999999888, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.10000000000004, 44.10000000000001, 43.10000000000001, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 46.099999999999994, -50.00000000000044, 35.70000000000003, 42.500000000000014, 33.90000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.90000000000002, -50.00000000000044, 9.099999999999689, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 88, 106, 276, 34, 500, 470, 184, 416, 500, 52, 26, 26, 500, 160, 28, 500, 62, 34, 58, 38, 500, 500, 44, 500, 500, 238, 28, 40, 40, 38, 500, 500, 38, 500, 32, 178, 44, 144, 120, 78, 500, 500, 500, 500, 62, 106, 420, 80, 500, 46, 50, 500, 36, 48, 500, 144, 94, 74, 270, 500, 78, 500, 160, 60, 70, 44, 28, 500, 500, 500, 34, 500, 24, 500, 500, 52, 30, 40, 500, 144, 76, 162, 500, 50, 500, 500, 100, 102, 500, 410, 110, 500, 500, 112, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43794662820731894, "mean_inference_ms": 1.400690698881266, "mean_action_processing_ms": 0.16411402112622053, "mean_env_wait_ms": 0.09855709767753516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03101515769958496, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12003612518310547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5370.145168419971, "num_env_steps_trained_throughput_per_sec": 5370.145168419971, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2266.129, "sample_time_ms": 2026.901, "load_time_ms": 11.876, "load_throughput": 1010436.242, "learn_time_ms": 216.458, "learn_throughput": 55437.888, "synch_weights_time_ms": 9.893}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2688, "training_iteration": 59, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-35", "timestamp": 1698246815, "time_this_iter_s": 2.238577127456665, "time_total_s": 151.18818974494934, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.18818974494934, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 67.06666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 5.956188042958577, "policy_loss": -0.00024871652324994403, "vf_loss": 5.956476953294542, "vf_explained_var": -1.4040205213758681e-06, "kl": 0.00044986797907616466, "entropy": 0.40215440260039437, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1071.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1960000000002124, "episode_len_mean": 282.5, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 8.099999999999675, 42.10000000000001, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 35.70000000000003, 40.70000000000002, 42.70000000000001, 23.099999999999888, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.10000000000004, 44.10000000000001, 43.10000000000001, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 46.099999999999994, -50.00000000000044, 35.70000000000003, 42.500000000000014, 33.90000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.90000000000002, -50.00000000000044, 9.099999999999689, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 14.299999999999763, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 45.3, -50.00000000000044, 45.7, 14.699999999999768, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 47.5, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.9, 45.5, 40.30000000000002], "episode_lengths": [500, 500, 500, 62, 106, 420, 80, 500, 46, 50, 500, 36, 48, 500, 144, 94, 74, 270, 500, 78, 500, 160, 60, 70, 44, 28, 500, 500, 500, 34, 500, 24, 500, 500, 52, 30, 40, 500, 144, 76, 162, 500, 50, 500, 500, 100, 102, 500, 410, 110, 500, 500, 112, 500, 500, 500, 500, 500, 500, 34, 500, 46, 358, 500, 208, 500, 500, 22, 500, 48, 500, 44, 354, 48, 500, 500, 48, 500, 500, 92, 196, 500, 500, 500, 32, 500, 500, 36, 500, 500, 44, 40, 26, 500, 34, 48, 500, 32, 46, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43840521411289346, "mean_inference_ms": 1.3996438828360633, "mean_action_processing_ms": 0.1639351895494487, "mean_env_wait_ms": 0.09831501628034811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300572395324707, "StateBufferConnector_ms": 0.009003639221191406, "ViewRequirementAgentConnector_ms": 0.12894272804260254}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.1960000000002124, "episode_len_mean": 282.5, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 39.50000000000002, 8.099999999999675, 42.10000000000001, -50.00000000000044, 45.5, 45.1, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 35.70000000000003, 40.70000000000002, 42.70000000000001, 23.099999999999888, -50.00000000000044, 42.30000000000001, -50.00000000000044, 34.10000000000004, 44.10000000000001, 43.10000000000001, 45.7, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 46.099999999999994, -50.00000000000044, 35.70000000000003, 42.500000000000014, 33.90000000000004, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 39.90000000000002, -50.00000000000044, 9.099999999999689, 39.10000000000002, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 14.299999999999763, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 45.3, -50.00000000000044, 45.7, 14.699999999999768, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 47.5, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.9, 45.5, 40.30000000000002], "episode_lengths": [500, 500, 500, 62, 106, 420, 80, 500, 46, 50, 500, 36, 48, 500, 144, 94, 74, 270, 500, 78, 500, 160, 60, 70, 44, 28, 500, 500, 500, 34, 500, 24, 500, 500, 52, 30, 40, 500, 144, 76, 162, 500, 50, 500, 500, 100, 102, 500, 410, 110, 500, 500, 112, 500, 500, 500, 500, 500, 500, 34, 500, 46, 358, 500, 208, 500, 500, 22, 500, 48, 500, 44, 354, 48, 500, 500, 48, 500, 500, 92, 196, 500, 500, 500, 32, 500, 500, 36, 500, 500, 44, 40, 26, 500, 34, 48, 500, 32, 46, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43840521411289346, "mean_inference_ms": 1.3996438828360633, "mean_action_processing_ms": 0.1639351895494487, "mean_env_wait_ms": 0.09831501628034811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300572395324707, "StateBufferConnector_ms": 0.009003639221191406, "ViewRequirementAgentConnector_ms": 0.12894272804260254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.136285727805, "num_env_steps_trained_throughput_per_sec": 5328.136285727805, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2271.009, "sample_time_ms": 2046.254, "load_time_ms": 11.192, "load_throughput": 1072206.995, "learn_time_ms": 202.499, "learn_throughput": 59259.591, "synch_weights_time_ms": 10.064}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2730, "training_iteration": 60, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-37", "timestamp": 1698246817, "time_this_iter_s": 2.257193088531494, "time_total_s": 153.44538283348083, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.44538283348083, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 69.23333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.849800851609972, "policy_loss": -8.060286442438762e-05, "vf_loss": 6.849924829271105, "vf_explained_var": -1.8676122029622395e-06, "kl": 5.1853396687167536e-05, "entropy": 0.43388758103052777, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1089.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.469999999999823, "episode_len_mean": 245.92, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 14.299999999999763, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 45.3, -50.00000000000044, 45.7, 14.699999999999768, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 47.5, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.9, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 47.3, 36.900000000000034, 43.7, 22.699999999999882, -50.00000000000044, 47.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.3, 23.499999999999893, 21.89999999999987, -50.00000000000044, 43.900000000000006, 43.7, 47.7, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, 46.699999999999996, 25.899999999999928, 45.9, -50.00000000000044, 45.1, 24.099999999999902, 44.900000000000006, 43.7, 45.1, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 47.1, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 46.099999999999994, 46.3, 46.099999999999994, 44.5, -50.00000000000044, 30.9, 32.700000000000024, -50.00000000000044, -50.00000000000044, 21.89999999999987], "episode_lengths": [500, 34, 500, 46, 358, 500, 208, 500, 500, 22, 500, 48, 500, 44, 354, 48, 500, 500, 48, 500, 500, 92, 196, 500, 500, 500, 32, 500, 500, 36, 500, 500, 44, 40, 26, 500, 34, 48, 500, 32, 46, 98, 500, 500, 52, 44, 500, 28, 132, 64, 274, 500, 30, 122, 500, 500, 24, 500, 48, 266, 282, 500, 62, 64, 24, 40, 500, 70, 500, 28, 34, 242, 42, 500, 50, 260, 52, 64, 50, 500, 68, 94, 500, 30, 84, 46, 500, 500, 32, 34, 40, 38, 40, 56, 500, 192, 174, 500, 500, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43748486457723884, "mean_inference_ms": 1.3982223871338004, "mean_action_processing_ms": 0.16356572037178144, "mean_env_wait_ms": 0.09811625026283086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300548553466797, "StateBufferConnector_ms": 0.01100611686706543, "ViewRequirementAgentConnector_ms": 0.12093615531921387}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.469999999999823, "episode_len_mean": 245.92, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 14.299999999999763, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 45.3, -50.00000000000044, 45.7, 14.699999999999768, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 46.099999999999994, 47.5, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.9, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, 45.7, -50.00000000000044, 47.3, 36.900000000000034, 43.7, 22.699999999999882, -50.00000000000044, 47.1, 37.90000000000003, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 45.3, 23.499999999999893, 21.89999999999987, -50.00000000000044, 43.900000000000006, 43.7, 47.7, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, 46.699999999999996, 25.899999999999928, 45.9, -50.00000000000044, 45.1, 24.099999999999902, 44.900000000000006, 43.7, 45.1, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 47.1, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 46.099999999999994, 46.3, 46.099999999999994, 44.5, -50.00000000000044, 30.9, 32.700000000000024, -50.00000000000044, -50.00000000000044, 21.89999999999987], "episode_lengths": [500, 34, 500, 46, 358, 500, 208, 500, 500, 22, 500, 48, 500, 44, 354, 48, 500, 500, 48, 500, 500, 92, 196, 500, 500, 500, 32, 500, 500, 36, 500, 500, 44, 40, 26, 500, 34, 48, 500, 32, 46, 98, 500, 500, 52, 44, 500, 28, 132, 64, 274, 500, 30, 122, 500, 500, 24, 500, 48, 266, 282, 500, 62, 64, 24, 40, 500, 70, 500, 28, 34, 242, 42, 500, 50, 260, 52, 64, 50, 500, 68, 94, 500, 30, 84, 46, 500, 500, 32, 34, 40, 38, 40, 56, 500, 192, 174, 500, 500, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43748486457723884, "mean_inference_ms": 1.3982223871338004, "mean_action_processing_ms": 0.16356572037178144, "mean_env_wait_ms": 0.09811625026283086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300548553466797, "StateBufferConnector_ms": 0.01100611686706543, "ViewRequirementAgentConnector_ms": 0.12093615531921387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5057.294670059254, "num_env_steps_trained_throughput_per_sec": 5057.294670059254, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2287.292, "sample_time_ms": 2041.805, "load_time_ms": 11.509, "load_throughput": 1042637.312, "learn_time_ms": 223.058, "learn_throughput": 53797.728, "synch_weights_time_ms": 9.92}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2788, "training_iteration": 61, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-39", "timestamp": 1698246819, "time_this_iter_s": 2.3775386810302734, "time_total_s": 155.8229215145111, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.8229215145111, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 64.35000000000001, "ram_util_percent": 26.650000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.869703451792399, "policy_loss": 2.8865955149134e-05, "vf_loss": 6.8697192668914795, "vf_explained_var": -8.179081810845269e-07, "kl": 2.5281213239796647e-05, "entropy": 0.4462336285246743, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1107.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.97599999999987, "episode_len_mean": 200.98, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 23.499999999999893, 21.89999999999987, -50.00000000000044, 43.900000000000006, 43.7, 47.7, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, 46.699999999999996, 25.899999999999928, 45.9, -50.00000000000044, 45.1, 24.099999999999902, 44.900000000000006, 43.7, 45.1, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 47.1, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 46.099999999999994, 46.3, 46.099999999999994, 44.5, -50.00000000000044, 30.9, 32.700000000000024, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 46.099999999999994, 43.900000000000006, 34.50000000000004, 47.1, 45.9, 45.1, 45.7, 46.699999999999996, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.7, 46.9, 45.5, 42.500000000000014, 45.9, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.299999999999748, 44.7, 47.5, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 46.099999999999994, 9.299999999999692, 46.099999999999994, 46.099999999999994, 46.9, 43.30000000000001, 44.5, 12.69999999999974, 23.699999999999896, 7.899999999999672, 44.7, 46.099999999999994, 38.50000000000003, 45.1, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 34.70000000000004, 44.7], "episode_lengths": [48, 266, 282, 500, 62, 64, 24, 40, 500, 70, 500, 28, 34, 242, 42, 500, 50, 260, 52, 64, 50, 500, 68, 94, 500, 30, 84, 46, 500, 500, 32, 34, 40, 38, 40, 56, 500, 192, 174, 500, 500, 282, 500, 40, 62, 156, 30, 42, 50, 44, 34, 500, 236, 500, 500, 44, 62, 500, 54, 32, 46, 76, 42, 500, 178, 500, 368, 54, 26, 58, 500, 42, 500, 36, 60, 500, 40, 408, 40, 40, 32, 68, 56, 374, 264, 422, 54, 40, 116, 50, 500, 28, 500, 500, 500, 500, 54, 44, 154, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4367557708316406, "mean_inference_ms": 1.3975559089752914, "mean_action_processing_ms": 0.16311215427110096, "mean_env_wait_ms": 0.09791994558939664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003360748291016, "StateBufferConnector_ms": 0.010001897811889648, "ViewRequirementAgentConnector_ms": 0.13897418975830078}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.97599999999987, "episode_len_mean": 200.98, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 23.499999999999893, 21.89999999999987, -50.00000000000044, 43.900000000000006, 43.7, 47.7, 46.099999999999994, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, 46.699999999999996, 25.899999999999928, 45.9, -50.00000000000044, 45.1, 24.099999999999902, 44.900000000000006, 43.7, 45.1, -50.00000000000044, 43.30000000000001, 40.70000000000002, -50.00000000000044, 47.1, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 46.099999999999994, 46.3, 46.099999999999994, 44.5, -50.00000000000044, 30.9, 32.700000000000024, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, 46.099999999999994, 43.900000000000006, 34.50000000000004, 47.1, 45.9, 45.1, 45.7, 46.699999999999996, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.7, 46.9, 45.5, 42.500000000000014, 45.9, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.299999999999748, 44.7, 47.5, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 46.099999999999994, 9.299999999999692, 46.099999999999994, 46.099999999999994, 46.9, 43.30000000000001, 44.5, 12.69999999999974, 23.699999999999896, 7.899999999999672, 44.7, 46.099999999999994, 38.50000000000003, 45.1, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 34.70000000000004, 44.7], "episode_lengths": [48, 266, 282, 500, 62, 64, 24, 40, 500, 70, 500, 28, 34, 242, 42, 500, 50, 260, 52, 64, 50, 500, 68, 94, 500, 30, 84, 46, 500, 500, 32, 34, 40, 38, 40, 56, 500, 192, 174, 500, 500, 282, 500, 40, 62, 156, 30, 42, 50, 44, 34, 500, 236, 500, 500, 44, 62, 500, 54, 32, 46, 76, 42, 500, 178, 500, 368, 54, 26, 58, 500, 42, 500, 36, 60, 500, 40, 408, 40, 40, 32, 68, 56, 374, 264, 422, 54, 40, 116, 50, 500, 28, 500, 500, 500, 500, 54, 44, 154, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4367557708316406, "mean_inference_ms": 1.3975559089752914, "mean_action_processing_ms": 0.16311215427110096, "mean_env_wait_ms": 0.09791994558939664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026003360748291016, "StateBufferConnector_ms": 0.010001897811889648, "ViewRequirementAgentConnector_ms": 0.13897418975830078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5566.425588130066, "num_env_steps_trained_throughput_per_sec": 5566.425588130066, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2266.243, "sample_time_ms": 2036.247, "load_time_ms": 9.491, "load_throughput": 1264420.478, "learn_time_ms": 209.91, "learn_throughput": 57167.289, "synch_weights_time_ms": 9.595}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2846, "training_iteration": 62, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-42", "timestamp": 1698246822, "time_this_iter_s": 2.1607789993286133, "time_total_s": 157.98370051383972, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.98370051383972, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 65.46666666666667, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.356713692347209, "policy_loss": -0.00014945057531197867, "vf_loss": 6.356906678941515, "vf_explained_var": 3.6425060696072046e-07, "kl": 0.00015418562822549435, "entropy": 0.43587999045848846, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.237999999999847, "episode_len_mean": 218.3, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.7, 46.9, 45.5, 42.500000000000014, 45.9, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.299999999999748, 44.7, 47.5, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 46.099999999999994, 9.299999999999692, 46.099999999999994, 46.099999999999994, 46.9, 43.30000000000001, 44.5, 12.69999999999974, 23.699999999999896, 7.899999999999672, 44.7, 46.099999999999994, 38.50000000000003, 45.1, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 34.70000000000004, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.5, 5.6999999999996405, 35.500000000000036, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 38.300000000000026, 47.1, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.5, 46.5, 42.900000000000006, -50.00000000000044, 47.5, 41.70000000000002, 46.9, 43.50000000000001, 45.5], "episode_lengths": [500, 44, 62, 500, 54, 32, 46, 76, 42, 500, 178, 500, 368, 54, 26, 58, 500, 42, 500, 36, 60, 500, 40, 408, 40, 40, 32, 68, 56, 374, 264, 422, 54, 40, 116, 50, 500, 28, 500, 500, 500, 500, 54, 44, 154, 54, 500, 36, 500, 500, 40, 54, 70, 500, 68, 500, 78, 500, 500, 154, 36, 34, 500, 500, 500, 48, 42, 36, 444, 146, 92, 500, 48, 500, 500, 32, 500, 52, 118, 30, 46, 76, 500, 500, 28, 40, 500, 500, 500, 30, 28, 46, 36, 72, 500, 26, 84, 32, 66, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43668567824669646, "mean_inference_ms": 1.3920966266060304, "mean_action_processing_ms": 0.16312850066332854, "mean_env_wait_ms": 0.09775751664092161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02298903465270996, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.12098574638366699}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.237999999999847, "episode_len_mean": 218.3, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.7, 46.9, 45.5, 42.500000000000014, 45.9, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.299999999999748, 44.7, 47.5, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 44.10000000000001, -50.00000000000044, 46.099999999999994, 9.299999999999692, 46.099999999999994, 46.099999999999994, 46.9, 43.30000000000001, 44.5, 12.69999999999974, 23.699999999999896, 7.899999999999672, 44.7, 46.099999999999994, 38.50000000000003, 45.1, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, 34.70000000000004, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.5, 5.6999999999996405, 35.500000000000036, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 38.300000000000026, 47.1, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.5, 46.5, 42.900000000000006, -50.00000000000044, 47.5, 41.70000000000002, 46.9, 43.50000000000001, 45.5], "episode_lengths": [500, 44, 62, 500, 54, 32, 46, 76, 42, 500, 178, 500, 368, 54, 26, 58, 500, 42, 500, 36, 60, 500, 40, 408, 40, 40, 32, 68, 56, 374, 264, 422, 54, 40, 116, 50, 500, 28, 500, 500, 500, 500, 54, 44, 154, 54, 500, 36, 500, 500, 40, 54, 70, 500, 68, 500, 78, 500, 500, 154, 36, 34, 500, 500, 500, 48, 42, 36, 444, 146, 92, 500, 48, 500, 500, 32, 500, 52, 118, 30, 46, 76, 500, 500, 28, 40, 500, 500, 500, 30, 28, 46, 36, 72, 500, 26, 84, 32, 66, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43668567824669646, "mean_inference_ms": 1.3920966266060304, "mean_action_processing_ms": 0.16312850066332854, "mean_env_wait_ms": 0.09775751664092161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02298903465270996, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.12098574638366699}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5626.313876776694, "num_env_steps_trained_throughput_per_sec": 5626.313876776694, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2254.535, "sample_time_ms": 2023.924, "load_time_ms": 9.718, "load_throughput": 1234850.648, "learn_time_ms": 210.371, "learn_throughput": 57042.181, "synch_weights_time_ms": 9.422}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2900, "training_iteration": 63, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-44", "timestamp": 1698246824, "time_this_iter_s": 2.137833595275879, "time_total_s": 160.1215341091156, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.1215341091156, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 60.56666666666666, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.254624181323582, "policy_loss": -7.839625080426534e-05, "vf_loss": 6.2547415892283125, "vf_explained_var": -2.013312445746528e-06, "kl": 0.00012699308543852162, "entropy": 0.38958515723546344, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1143.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.494999999999822, "episode_len_mean": 240.66, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 45.7, 34.70000000000004, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.5, 5.6999999999996405, 35.500000000000036, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 38.300000000000026, 47.1, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.5, 46.5, 42.900000000000006, -50.00000000000044, 47.5, 41.70000000000002, 46.9, 43.50000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 42.70000000000001, 42.900000000000006, 45.7, 47.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 45.3, 43.7, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044], "episode_lengths": [54, 44, 154, 54, 500, 36, 500, 500, 40, 54, 70, 500, 68, 500, 78, 500, 500, 154, 36, 34, 500, 500, 500, 48, 42, 36, 444, 146, 92, 500, 48, 500, 500, 32, 500, 52, 118, 30, 46, 76, 500, 500, 28, 40, 500, 500, 500, 30, 28, 46, 36, 72, 500, 26, 84, 32, 66, 46, 500, 60, 500, 42, 500, 68, 500, 24, 96, 66, 500, 242, 500, 48, 500, 74, 74, 72, 44, 24, 56, 500, 500, 500, 458, 500, 500, 48, 64, 500, 90, 84, 500, 34, 500, 76, 500, 500, 500, 48, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4354257941995965, "mean_inference_ms": 1.3892317338793791, "mean_action_processing_ms": 0.16315137699288212, "mean_env_wait_ms": 0.09765229039326677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028978347778320312, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.10501909255981445}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.494999999999822, "episode_len_mean": 240.66, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 45.7, 34.70000000000004, 44.7, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.7, 43.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 46.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.5, 5.6999999999996405, 35.500000000000036, 40.90000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 38.300000000000026, 47.1, 45.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.5, 46.5, 42.900000000000006, -50.00000000000044, 47.5, 41.70000000000002, 46.9, 43.50000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 42.70000000000001, 42.900000000000006, 45.7, 47.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 45.3, 43.7, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044], "episode_lengths": [54, 44, 154, 54, 500, 36, 500, 500, 40, 54, 70, 500, 68, 500, 78, 500, 500, 154, 36, 34, 500, 500, 500, 48, 42, 36, 444, 146, 92, 500, 48, 500, 500, 32, 500, 52, 118, 30, 46, 76, 500, 500, 28, 40, 500, 500, 500, 30, 28, 46, 36, 72, 500, 26, 84, 32, 66, 46, 500, 60, 500, 42, 500, 68, 500, 24, 96, 66, 500, 242, 500, 48, 500, 74, 74, 72, 44, 24, 56, 500, 500, 500, 458, 500, 500, 48, 64, 500, 90, 84, 500, 34, 500, 76, 500, 500, 500, 48, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4354257941995965, "mean_inference_ms": 1.3892317338793791, "mean_action_processing_ms": 0.16315137699288212, "mean_env_wait_ms": 0.09765229039326677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028978347778320312, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.10501909255981445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5322.414615741226, "num_env_steps_trained_throughput_per_sec": 5322.414615741226, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2231.062, "sample_time_ms": 2010.014, "load_time_ms": 9.993, "load_throughput": 1200865.798, "learn_time_ms": 200.827, "learn_throughput": 59752.914, "synch_weights_time_ms": 9.129}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2942, "training_iteration": 64, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-46", "timestamp": 1698246826, "time_this_iter_s": 2.260051727294922, "time_total_s": 162.38158583641052, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.38158583641052, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.198528687159221, "policy_loss": -6.982477174864875e-05, "vf_loss": 6.198642545276218, "vf_explained_var": -2.278221978081597e-06, "kl": 0.00026522863661347803, "entropy": 0.43978046211931443, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1161.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7309999999998, "episode_len_mean": 268.26, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.5, 46.5, 42.900000000000006, -50.00000000000044, 47.5, 41.70000000000002, 46.9, 43.50000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 42.70000000000001, 42.900000000000006, 45.7, 47.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 45.3, 43.7, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.7, 3.0999999999996035, 41.90000000000001, 37.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 12.299999999999734, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 28.499999999999964, 45.7, 46.099999999999994, 45.5, -50.00000000000044, 22.299999999999876, 34.10000000000004, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.7, 37.10000000000003, -50.00000000000044, -50.00000000000044, 32.90000000000003], "episode_lengths": [76, 500, 500, 28, 40, 500, 500, 500, 30, 28, 46, 36, 72, 500, 26, 84, 32, 66, 46, 500, 60, 500, 42, 500, 68, 500, 24, 96, 66, 500, 242, 500, 48, 500, 74, 74, 72, 44, 24, 56, 500, 500, 500, 458, 500, 500, 48, 64, 500, 90, 84, 500, 34, 500, 76, 500, 500, 500, 48, 54, 500, 500, 500, 500, 500, 500, 26, 64, 470, 82, 128, 48, 500, 500, 378, 500, 500, 210, 58, 216, 44, 40, 46, 500, 278, 160, 40, 500, 50, 500, 500, 500, 500, 500, 86, 44, 130, 500, 500, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4352825742216214, "mean_inference_ms": 1.3877140771429104, "mean_action_processing_ms": 0.16285732021784977, "mean_env_wait_ms": 0.09745502816610097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279848575592041, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.11202669143676758}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7309999999998, "episode_len_mean": 268.26, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, -50.00000000000044, 47.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.3, 45.5, 46.5, 42.900000000000006, -50.00000000000044, 47.5, 41.70000000000002, 46.9, 43.50000000000001, 45.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, 25.899999999999928, -50.00000000000044, 45.3, -50.00000000000044, 42.70000000000001, 42.70000000000001, 42.900000000000006, 45.7, 47.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.299999999999621, -50.00000000000044, -50.00000000000044, 45.3, 43.7, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.7, 3.0999999999996035, 41.90000000000001, 37.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 12.299999999999734, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 28.499999999999964, 45.7, 46.099999999999994, 45.5, -50.00000000000044, 22.299999999999876, 34.10000000000004, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.7, 37.10000000000003, -50.00000000000044, -50.00000000000044, 32.90000000000003], "episode_lengths": [76, 500, 500, 28, 40, 500, 500, 500, 30, 28, 46, 36, 72, 500, 26, 84, 32, 66, 46, 500, 60, 500, 42, 500, 68, 500, 24, 96, 66, 500, 242, 500, 48, 500, 74, 74, 72, 44, 24, 56, 500, 500, 500, 458, 500, 500, 48, 64, 500, 90, 84, 500, 34, 500, 76, 500, 500, 500, 48, 54, 500, 500, 500, 500, 500, 500, 26, 64, 470, 82, 128, 48, 500, 500, 378, 500, 500, 210, 58, 216, 44, 40, 46, 500, 278, 160, 40, 500, 50, 500, 500, 500, 500, 500, 86, 44, 130, 500, 500, 172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4352825742216214, "mean_inference_ms": 1.3877140771429104, "mean_action_processing_ms": 0.16285732021784977, "mean_env_wait_ms": 0.09745502816610097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279848575592041, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.11202669143676758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5739.83621532177, "num_env_steps_trained_throughput_per_sec": 5739.83621532177, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2222.038, "sample_time_ms": 1996.956, "load_time_ms": 10.29, "load_throughput": 1166153.418, "learn_time_ms": 204.546, "learn_throughput": 58666.634, "synch_weights_time_ms": 9.246}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2981, "training_iteration": 65, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-48", "timestamp": 1698246828, "time_this_iter_s": 2.0959532260894775, "time_total_s": 164.4775390625, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.4775390625, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.56103155348036, "policy_loss": -1.8121726397011014e-05, "vf_loss": 6.561091158125135, "vf_explained_var": 4.967053731282552e-08, "kl": 0.00016544804999006778, "entropy": 0.41450387405024636, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1179.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1170000000002163, "episode_len_mean": 286.7, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.7, 3.0999999999996035, 41.90000000000001, 37.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 12.299999999999734, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 28.499999999999964, 45.7, 46.099999999999994, 45.5, -50.00000000000044, 22.299999999999876, 34.10000000000004, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.7, 37.10000000000003, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 45.3, 43.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 32.700000000000024, 46.099999999999994, 45.5, 44.300000000000004, 45.7, -50.00000000000044, 45.7, 38.700000000000024, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 46.5, 47.5, -50.00000000000044], "episode_lengths": [64, 500, 90, 84, 500, 34, 500, 76, 500, 500, 500, 48, 54, 500, 500, 500, 500, 500, 500, 26, 64, 470, 82, 128, 48, 500, 500, 378, 500, 500, 210, 58, 216, 44, 40, 46, 500, 278, 160, 40, 500, 50, 500, 500, 500, 500, 500, 86, 44, 130, 500, 500, 172, 500, 48, 500, 54, 44, 500, 500, 36, 48, 62, 500, 394, 500, 500, 500, 500, 500, 500, 500, 500, 136, 500, 108, 500, 34, 500, 50, 500, 40, 174, 40, 46, 58, 44, 500, 44, 114, 122, 500, 86, 500, 46, 60, 500, 36, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4347897556927275, "mean_inference_ms": 1.3872965865211973, "mean_action_processing_ms": 0.1620323088911703, "mean_env_wait_ms": 0.09688864086062138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03310227394104004, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.10953783988952637}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.1170000000002163, "episode_len_mean": 286.7, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 41.100000000000016, 41.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 43.7, 3.0999999999996035, 41.90000000000001, 37.300000000000026, 45.3, -50.00000000000044, -50.00000000000044, 12.299999999999734, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 28.499999999999964, 45.7, 46.099999999999994, 45.5, -50.00000000000044, 22.299999999999876, 34.10000000000004, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.7, 37.10000000000003, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 45.3, 43.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 32.700000000000024, 46.099999999999994, 45.5, 44.300000000000004, 45.7, -50.00000000000044, 45.7, 38.700000000000024, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 46.5, 47.5, -50.00000000000044], "episode_lengths": [64, 500, 90, 84, 500, 34, 500, 76, 500, 500, 500, 48, 54, 500, 500, 500, 500, 500, 500, 26, 64, 470, 82, 128, 48, 500, 500, 378, 500, 500, 210, 58, 216, 44, 40, 46, 500, 278, 160, 40, 500, 50, 500, 500, 500, 500, 500, 86, 44, 130, 500, 500, 172, 500, 48, 500, 54, 44, 500, 500, 36, 48, 62, 500, 394, 500, 500, 500, 500, 500, 500, 500, 500, 136, 500, 108, 500, 34, 500, 50, 500, 40, 174, 40, 46, 58, 44, 500, 44, 114, 122, 500, 86, 500, 46, 60, 500, 36, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4347897556927275, "mean_inference_ms": 1.3872965865211973, "mean_action_processing_ms": 0.1620323088911703, "mean_env_wait_ms": 0.09688864086062138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03310227394104004, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.10953783988952637}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5309.012040293164, "num_env_steps_trained_throughput_per_sec": 5309.012040293164, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2223.368, "sample_time_ms": 1994.908, "load_time_ms": 10.795, "load_throughput": 1111574.484, "learn_time_ms": 207.276, "learn_throughput": 57893.806, "synch_weights_time_ms": 9.289}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3028, "training_iteration": 66, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-50", "timestamp": 1698246830, "time_this_iter_s": 2.2651195526123047, "time_total_s": 166.7426586151123, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.7426586151123, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 61.166666666666664, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.429709831873576, "policy_loss": -0.00033689145412709977, "vf_loss": 6.430091645982531, "vf_explained_var": -5.099508497450087e-07, "kl": 0.00040860887038205205, "entropy": 0.44972847070958877, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1197.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.377999999999816, "episode_len_mean": 256.82, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 45.3, 43.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 32.700000000000024, 46.099999999999994, 45.5, 44.300000000000004, 45.7, -50.00000000000044, 45.7, 38.700000000000024, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 43.50000000000001, 11.699999999999726, 47.5, 44.5, 37.300000000000026, 37.90000000000003, 35.10000000000004, -50.00000000000044, 33.70000000000004, 42.30000000000001, 45.3, 46.9, 47.3, 45.9, 46.3, 41.90000000000001, 40.10000000000002, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.499999999999922, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.7, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 43.900000000000006, 43.7, 47.1, 16.699999999999797, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7], "episode_lengths": [500, 500, 172, 500, 48, 500, 54, 44, 500, 500, 36, 48, 62, 500, 394, 500, 500, 500, 500, 500, 500, 500, 500, 136, 500, 108, 500, 34, 500, 50, 500, 40, 174, 40, 46, 58, 44, 500, 44, 114, 122, 500, 86, 500, 46, 60, 500, 36, 26, 500, 66, 384, 26, 56, 128, 122, 150, 500, 164, 78, 48, 32, 28, 42, 38, 82, 100, 500, 38, 104, 500, 500, 90, 246, 70, 74, 500, 500, 162, 54, 42, 500, 500, 42, 500, 500, 414, 500, 62, 64, 30, 334, 500, 42, 500, 500, 500, 84, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43241329877628376, "mean_inference_ms": 1.3827236066492077, "mean_action_processing_ms": 0.1614101076064257, "mean_env_wait_ms": 0.09660623472601654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02910137176513672, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12003803253173828}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.377999999999816, "episode_len_mean": 256.82, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 44.7, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 45.3, 43.900000000000006, -50.00000000000044, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 39.300000000000026, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, 46.099999999999994, 32.700000000000024, 46.099999999999994, 45.5, 44.300000000000004, 45.7, -50.00000000000044, 45.7, 38.700000000000024, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.10000000000001, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 43.50000000000001, 11.699999999999726, 47.5, 44.5, 37.300000000000026, 37.90000000000003, 35.10000000000004, -50.00000000000044, 33.70000000000004, 42.30000000000001, 45.3, 46.9, 47.3, 45.9, 46.3, 41.90000000000001, 40.10000000000002, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.499999999999922, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.7, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 43.900000000000006, 43.7, 47.1, 16.699999999999797, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7], "episode_lengths": [500, 500, 172, 500, 48, 500, 54, 44, 500, 500, 36, 48, 62, 500, 394, 500, 500, 500, 500, 500, 500, 500, 500, 136, 500, 108, 500, 34, 500, 50, 500, 40, 174, 40, 46, 58, 44, 500, 44, 114, 122, 500, 86, 500, 46, 60, 500, 36, 26, 500, 66, 384, 26, 56, 128, 122, 150, 500, 164, 78, 48, 32, 28, 42, 38, 82, 100, 500, 38, 104, 500, 500, 90, 246, 70, 74, 500, 500, 162, 54, 42, 500, 500, 42, 500, 500, 414, 500, 62, 64, 30, 334, 500, 42, 500, 500, 500, 84, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43241329877628376, "mean_inference_ms": 1.3827236066492077, "mean_action_processing_ms": 0.1614101076064257, "mean_env_wait_ms": 0.09660623472601654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02910137176513672, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12003803253173828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5832.135928697549, "num_env_steps_trained_throughput_per_sec": 5832.135928697549, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2198.385, "sample_time_ms": 1984.278, "load_time_ms": 9.959, "load_throughput": 1204997.187, "learn_time_ms": 193.794, "learn_throughput": 61921.319, "synch_weights_time_ms": 9.354}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3078, "training_iteration": 67, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-52", "timestamp": 1698246832, "time_this_iter_s": 2.06256365776062, "time_total_s": 168.80522227287292, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.80522227287292, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 56.166666666666664, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.366030957963732, "policy_loss": -0.00017358259194427065, "vf_loss": 6.366256290011936, "vf_explained_var": -1.2252065870496963e-06, "kl": 0.0003541060589087566, "entropy": 0.5178384880224863, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.01899999999983, "episode_len_mean": 245.46, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 44.10000000000001, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 43.50000000000001, 11.699999999999726, 47.5, 44.5, 37.300000000000026, 37.90000000000003, 35.10000000000004, -50.00000000000044, 33.70000000000004, 42.30000000000001, 45.3, 46.9, 47.3, 45.9, 46.3, 41.90000000000001, 40.10000000000002, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.499999999999922, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.7, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 43.900000000000006, 43.7, 47.1, 16.699999999999797, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 43.50000000000001, 41.90000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.099999999999746, -50.00000000000044, 14.899999999999771, 47.5, -50.00000000000044, 38.90000000000002, 47.1, 45.5, -50.00000000000044, 3.499999999999609, 42.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 31.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 39.90000000000002], "episode_lengths": [46, 60, 500, 36, 26, 500, 66, 384, 26, 56, 128, 122, 150, 500, 164, 78, 48, 32, 28, 42, 38, 82, 100, 500, 38, 104, 500, 500, 90, 246, 70, 74, 500, 500, 162, 54, 42, 500, 500, 42, 500, 500, 414, 500, 62, 64, 30, 334, 500, 42, 500, 500, 500, 84, 500, 64, 500, 408, 500, 500, 86, 62, 34, 76, 500, 500, 104, 64, 66, 82, 50, 500, 54, 500, 42, 500, 42, 500, 500, 74, 370, 500, 352, 26, 500, 112, 30, 46, 500, 466, 76, 500, 500, 144, 44, 184, 500, 122, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43167702583323025, "mean_inference_ms": 1.3794856545183523, "mean_action_processing_ms": 0.1612584496576254, "mean_env_wait_ms": 0.09645223854200229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990154266357422, "StateBufferConnector_ms": 0.007824897766113281, "ViewRequirementAgentConnector_ms": 0.10652685165405273}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.01899999999983, "episode_len_mean": 245.46, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 44.10000000000001, -50.00000000000044, 46.5, 47.5, -50.00000000000044, 43.50000000000001, 11.699999999999726, 47.5, 44.5, 37.300000000000026, 37.90000000000003, 35.10000000000004, -50.00000000000044, 33.70000000000004, 42.30000000000001, 45.3, 46.9, 47.3, 45.9, 46.3, 41.90000000000001, 40.10000000000002, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.499999999999922, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.7, 45.9, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, 43.900000000000006, 43.7, 47.1, 16.699999999999797, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 43.50000000000001, 41.90000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.099999999999746, -50.00000000000044, 14.899999999999771, 47.5, -50.00000000000044, 38.90000000000002, 47.1, 45.5, -50.00000000000044, 3.499999999999609, 42.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 31.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 39.90000000000002], "episode_lengths": [46, 60, 500, 36, 26, 500, 66, 384, 26, 56, 128, 122, 150, 500, 164, 78, 48, 32, 28, 42, 38, 82, 100, 500, 38, 104, 500, 500, 90, 246, 70, 74, 500, 500, 162, 54, 42, 500, 500, 42, 500, 500, 414, 500, 62, 64, 30, 334, 500, 42, 500, 500, 500, 84, 500, 64, 500, 408, 500, 500, 86, 62, 34, 76, 500, 500, 104, 64, 66, 82, 50, 500, 54, 500, 42, 500, 42, 500, 500, 74, 370, 500, 352, 26, 500, 112, 30, 46, 500, 466, 76, 500, 500, 144, 44, 184, 500, 122, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43167702583323025, "mean_inference_ms": 1.3794856545183523, "mean_action_processing_ms": 0.1612584496576254, "mean_env_wait_ms": 0.09645223854200229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023990154266357422, "StateBufferConnector_ms": 0.007824897766113281, "ViewRequirementAgentConnector_ms": 0.10652685165405273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5299.77250579002, "num_env_steps_trained_throughput_per_sec": 5299.77250579002, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2207.559, "sample_time_ms": 1978.737, "load_time_ms": 10.259, "load_throughput": 1169736.312, "learn_time_ms": 208.267, "learn_throughput": 57618.287, "synch_weights_time_ms": 9.296}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3122, "training_iteration": 68, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-55", "timestamp": 1698246835, "time_this_iter_s": 2.269021987915039, "time_total_s": 171.07424426078796, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.07424426078796, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 61.43333333333334, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.308286534415351, "policy_loss": -0.0004244277046786414, "vf_loss": 6.308756801817152, "vf_explained_var": 6.357828776041666e-07, "kl": 0.000404425180016056, "entropy": 0.45783039596345687, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1233.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.852999999999804, "episode_len_mean": 267.06, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 43.7, 47.1, 16.699999999999797, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 43.50000000000001, 41.90000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.099999999999746, -50.00000000000044, 14.899999999999771, 47.5, -50.00000000000044, 38.90000000000002, 47.1, 45.5, -50.00000000000044, 3.499999999999609, 42.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 31.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 48.1, 46.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 13.099999999999746, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 25.699999999999925, 43.7, 45.5, 39.90000000000002, 44.300000000000004, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.9, -50.00000000000044, 31.70000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [62, 64, 30, 334, 500, 42, 500, 500, 500, 84, 500, 64, 500, 408, 500, 500, 86, 62, 34, 76, 500, 500, 104, 64, 66, 82, 50, 500, 54, 500, 42, 500, 42, 500, 500, 74, 370, 500, 352, 26, 500, 112, 30, 46, 500, 466, 76, 500, 500, 144, 44, 184, 500, 122, 500, 102, 500, 500, 500, 500, 500, 58, 20, 38, 52, 500, 40, 54, 76, 500, 500, 36, 500, 42, 500, 370, 500, 26, 52, 500, 500, 36, 244, 64, 46, 102, 58, 500, 200, 500, 500, 230, 42, 500, 184, 40, 36, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4320220444062625, "mean_inference_ms": 1.3783264099958732, "mean_action_processing_ms": 0.161280356043444, "mean_env_wait_ms": 0.09629883667101038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027969837188720703, "StateBufferConnector_ms": 0.004823446273803711, "ViewRequirementAgentConnector_ms": 0.10045242309570312}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.852999999999804, "episode_len_mean": 267.06, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 43.7, 47.1, 16.699999999999797, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.900000000000006, 46.699999999999996, 42.500000000000014, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 43.50000000000001, 41.90000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 42.70000000000001, 13.099999999999746, -50.00000000000044, 14.899999999999771, 47.5, -50.00000000000044, 38.90000000000002, 47.1, 45.5, -50.00000000000044, 3.499999999999609, 42.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 31.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 48.1, 46.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 13.099999999999746, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 25.699999999999925, 43.7, 45.5, 39.90000000000002, 44.300000000000004, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.9, -50.00000000000044, 31.70000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 43.900000000000006], "episode_lengths": [62, 64, 30, 334, 500, 42, 500, 500, 500, 84, 500, 64, 500, 408, 500, 500, 86, 62, 34, 76, 500, 500, 104, 64, 66, 82, 50, 500, 54, 500, 42, 500, 42, 500, 500, 74, 370, 500, 352, 26, 500, 112, 30, 46, 500, 466, 76, 500, 500, 144, 44, 184, 500, 122, 500, 102, 500, 500, 500, 500, 500, 58, 20, 38, 52, 500, 40, 54, 76, 500, 500, 36, 500, 42, 500, 370, 500, 26, 52, 500, 500, 36, 244, 64, 46, 102, 58, 500, 200, 500, 500, 230, 42, 500, 184, 40, 36, 500, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4320220444062625, "mean_inference_ms": 1.3783264099958732, "mean_action_processing_ms": 0.161280356043444, "mean_env_wait_ms": 0.09629883667101038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027969837188720703, "StateBufferConnector_ms": 0.004823446273803711, "ViewRequirementAgentConnector_ms": 0.10045242309570312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.667211354788, "num_env_steps_trained_throughput_per_sec": 5300.667211354788, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2210.488, "sample_time_ms": 1960.319, "load_time_ms": 11.237, "load_throughput": 1067898.285, "learn_time_ms": 228.701, "learn_throughput": 52470.208, "synch_weights_time_ms": 9.331}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3166, "training_iteration": 69, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-57", "timestamp": 1698246837, "time_this_iter_s": 2.269231081008911, "time_total_s": 173.34347534179688, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 173.34347534179688, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 53.125, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.444301658206516, "policy_loss": -9.615843494733174e-05, "vf_loss": 6.444444391462538, "vf_explained_var": -2.2517310248480902e-07, "kl": 0.00026301296276819305, "entropy": 0.4657784816291597, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1251.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3999999999997996, "episode_len_mean": 276.58, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 3.499999999999609, 42.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 31.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 48.1, 46.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 13.099999999999746, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 25.699999999999925, 43.7, 45.5, 39.90000000000002, 44.300000000000004, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.9, -50.00000000000044, 31.70000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, 39.90000000000002, 39.90000000000002, -50.00000000000044, 45.3, 47.3, 30.099999999999987, 26.09999999999993, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 5.6999999999996405, 47.3, 44.10000000000001, 41.90000000000001, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.3, 44.900000000000006, 20.899999999999856, 27.699999999999953, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [500, 466, 76, 500, 500, 144, 44, 184, 500, 122, 500, 102, 500, 500, 500, 500, 500, 58, 20, 38, 52, 500, 40, 54, 76, 500, 500, 36, 500, 42, 500, 370, 500, 26, 52, 500, 500, 36, 244, 64, 46, 102, 58, 500, 200, 500, 500, 230, 42, 500, 184, 40, 36, 500, 500, 62, 500, 500, 338, 102, 102, 500, 48, 28, 200, 240, 500, 98, 500, 500, 42, 444, 28, 60, 82, 104, 118, 500, 500, 34, 500, 500, 500, 500, 46, 36, 500, 500, 328, 38, 52, 292, 224, 58, 94, 500, 500, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43120065059872154, "mean_inference_ms": 1.376979342048021, "mean_action_processing_ms": 0.1611352829289763, "mean_env_wait_ms": 0.09620557260162309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025824785232543945, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.11442303657531738}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3999999999997996, "episode_len_mean": 276.58, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 3.499999999999609, 42.500000000000014, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.7, 31.70000000000001, -50.00000000000044, 37.90000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 48.1, 46.3, 44.900000000000006, -50.00000000000044, 46.099999999999994, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.9, -50.00000000000044, 13.099999999999746, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 25.699999999999925, 43.7, 45.5, 39.90000000000002, 44.300000000000004, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.9, -50.00000000000044, 31.70000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, 39.90000000000002, 39.90000000000002, -50.00000000000044, 45.3, 47.3, 30.099999999999987, 26.09999999999993, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 5.6999999999996405, 47.3, 44.10000000000001, 41.90000000000001, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.3, 44.900000000000006, 20.899999999999856, 27.699999999999953, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014], "episode_lengths": [500, 466, 76, 500, 500, 144, 44, 184, 500, 122, 500, 102, 500, 500, 500, 500, 500, 58, 20, 38, 52, 500, 40, 54, 76, 500, 500, 36, 500, 42, 500, 370, 500, 26, 52, 500, 500, 36, 244, 64, 46, 102, 58, 500, 200, 500, 500, 230, 42, 500, 184, 40, 36, 500, 500, 62, 500, 500, 338, 102, 102, 500, 48, 28, 200, 240, 500, 98, 500, 500, 42, 444, 28, 60, 82, 104, 118, 500, 500, 34, 500, 500, 500, 500, 46, 36, 500, 500, 328, 38, 52, 292, 224, 58, 94, 500, 500, 500, 500, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43120065059872154, "mean_inference_ms": 1.376979342048021, "mean_action_processing_ms": 0.1611352829289763, "mean_env_wait_ms": 0.09620557260162309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025824785232543945, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.11442303657531738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5357.975452057058, "num_env_steps_trained_throughput_per_sec": 5357.975452057058, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2209.232, "sample_time_ms": 1940.03, "load_time_ms": 12.139, "load_throughput": 988563.987, "learn_time_ms": 247.028, "learn_throughput": 48577.43, "synch_weights_time_ms": 9.135}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3210, "training_iteration": 70, "trial_id": "9f288_00008", "date": "2023-10-25_16-13-59", "timestamp": 1698246839, "time_this_iter_s": 2.2452168464660645, "time_total_s": 175.58869218826294, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.58869218826294, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 60.46666666666667, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.101603613959418, "policy_loss": -0.0002553861898680528, "vf_loss": 6.101908180448744, "vf_explained_var": -3.0464596218532984e-07, "kl": 0.0007114248560798034, "entropy": 0.49158070153660244, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1269.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.3450000000002222, "episode_len_mean": 298.98, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, 25.699999999999925, 43.7, 45.5, 39.90000000000002, 44.300000000000004, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.9, -50.00000000000044, 31.70000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, 39.90000000000002, 39.90000000000002, -50.00000000000044, 45.3, 47.3, 30.099999999999987, 26.09999999999993, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 5.6999999999996405, 47.3, 44.10000000000001, 41.90000000000001, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.3, 44.900000000000006, 20.899999999999856, 27.699999999999953, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 11.099999999999717, 31.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 15.299999999999777, -50.00000000000044, 42.30000000000001, 41.30000000000001, 43.7, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 36, 244, 64, 46, 102, 58, 500, 200, 500, 500, 230, 42, 500, 184, 40, 36, 500, 500, 62, 500, 500, 338, 102, 102, 500, 48, 28, 200, 240, 500, 98, 500, 500, 42, 444, 28, 60, 82, 104, 118, 500, 500, 34, 500, 500, 500, 500, 46, 36, 500, 500, 328, 38, 52, 292, 224, 58, 94, 500, 500, 500, 500, 76, 500, 500, 50, 500, 500, 390, 190, 500, 500, 114, 500, 500, 500, 30, 348, 500, 78, 88, 64, 46, 66, 500, 500, 500, 500, 500, 500, 32, 212, 500, 34, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4301773684467908, "mean_inference_ms": 1.3748247842606145, "mean_action_processing_ms": 0.16088566579844726, "mean_env_wait_ms": 0.09613557059205036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831035614013672, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.1288604736328125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.3450000000002222, "episode_len_mean": 298.98, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, 25.699999999999925, 43.7, 45.5, 39.90000000000002, 44.300000000000004, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.9, -50.00000000000044, 31.70000000000001, 46.099999999999994, 46.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, 39.90000000000002, 39.90000000000002, -50.00000000000044, 45.3, 47.3, 30.099999999999987, 26.09999999999993, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 5.6999999999996405, 47.3, 44.10000000000001, 41.90000000000001, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.3, 44.900000000000006, 20.899999999999856, 27.699999999999953, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 11.099999999999717, 31.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 15.299999999999777, -50.00000000000044, 42.30000000000001, 41.30000000000001, 43.7, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 36, 244, 64, 46, 102, 58, 500, 200, 500, 500, 230, 42, 500, 184, 40, 36, 500, 500, 62, 500, 500, 338, 102, 102, 500, 48, 28, 200, 240, 500, 98, 500, 500, 42, 444, 28, 60, 82, 104, 118, 500, 500, 34, 500, 500, 500, 500, 46, 36, 500, 500, 328, 38, 52, 292, 224, 58, 94, 500, 500, 500, 500, 76, 500, 500, 50, 500, 500, 390, 190, 500, 500, 114, 500, 500, 500, 30, 348, 500, 78, 88, 64, 46, 66, 500, 500, 500, 500, 500, 500, 32, 212, 500, 34, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4301773684467908, "mean_inference_ms": 1.3748247842606145, "mean_action_processing_ms": 0.16088566579844726, "mean_env_wait_ms": 0.09613557059205036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831035614013672, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.1288604736328125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5528.12369675154, "num_env_steps_trained_throughput_per_sec": 5528.12369675154, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2189.023, "sample_time_ms": 1932.903, "load_time_ms": 12.228, "load_throughput": 981393.482, "learn_time_ms": 233.757, "learn_throughput": 51335.467, "synch_weights_time_ms": 9.236}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3245, "training_iteration": 71, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-02", "timestamp": 1698246842, "time_this_iter_s": 2.175938844680786, "time_total_s": 177.76463103294373, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.76463103294373, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 6.903668774498834, "policy_loss": -0.0002834987309243944, "vf_loss": 6.9039956198798285, "vf_explained_var": -1.1457337273491753e-06, "kl": 0.0003107083018559899, "entropy": 0.4341125902202394, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1287.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.5270000000002355, "episode_len_mean": 310.8, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.3, 44.900000000000006, 20.899999999999856, 27.699999999999953, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 11.099999999999717, 31.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 15.299999999999777, -50.00000000000044, 42.30000000000001, 41.30000000000001, 43.7, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.300000000000026, 13.099999999999746, 28.29999999999996, 5.499999999999638, 39.50000000000002, 20.099999999999845, -50.00000000000044, 39.50000000000002, 45.3, 46.3, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 46.099999999999994, 41.500000000000014, -50.00000000000044, 13.099999999999746, 42.500000000000014, -50.00000000000044, 47.3, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 8.099999999999675, 15.899999999999785, 36.10000000000004, 30.699999999999996, 45.3, -50.00000000000044, 45.5], "episode_lengths": [500, 34, 500, 500, 500, 500, 46, 36, 500, 500, 328, 38, 52, 292, 224, 58, 94, 500, 500, 500, 500, 76, 500, 500, 50, 500, 500, 390, 190, 500, 500, 114, 500, 500, 500, 30, 348, 500, 78, 88, 64, 46, 66, 500, 500, 500, 500, 500, 500, 32, 212, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 208, 108, 370, 218, 446, 106, 300, 500, 106, 48, 38, 50, 76, 500, 500, 492, 40, 86, 500, 370, 76, 500, 28, 62, 50, 500, 500, 500, 500, 46, 46, 420, 342, 140, 194, 48, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42989464729960614, "mean_inference_ms": 1.371076051730673, "mean_action_processing_ms": 0.16029066770801426, "mean_env_wait_ms": 0.09613853822580565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021059036254882812, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.128126859664917}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.5270000000002355, "episode_len_mean": 310.8, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, 46.3, 44.900000000000006, 20.899999999999856, 27.699999999999953, 44.300000000000004, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 11.099999999999717, 31.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 15.299999999999777, -50.00000000000044, 42.30000000000001, 41.30000000000001, 43.7, 45.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.300000000000026, 13.099999999999746, 28.29999999999996, 5.499999999999638, 39.50000000000002, 20.099999999999845, -50.00000000000044, 39.50000000000002, 45.3, 46.3, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 46.099999999999994, 41.500000000000014, -50.00000000000044, 13.099999999999746, 42.500000000000014, -50.00000000000044, 47.3, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 8.099999999999675, 15.899999999999785, 36.10000000000004, 30.699999999999996, 45.3, -50.00000000000044, 45.5], "episode_lengths": [500, 34, 500, 500, 500, 500, 46, 36, 500, 500, 328, 38, 52, 292, 224, 58, 94, 500, 500, 500, 500, 76, 500, 500, 50, 500, 500, 390, 190, 500, 500, 114, 500, 500, 500, 30, 348, 500, 78, 88, 64, 46, 66, 500, 500, 500, 500, 500, 500, 32, 212, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 208, 108, 370, 218, 446, 106, 300, 500, 106, 48, 38, 50, 76, 500, 500, 492, 40, 86, 500, 370, 76, 500, 28, 62, 50, 500, 500, 500, 500, 46, 46, 420, 342, 140, 194, 48, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42989464729960614, "mean_inference_ms": 1.371076051730673, "mean_action_processing_ms": 0.16029066770801426, "mean_env_wait_ms": 0.09613853822580565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021059036254882812, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.128126859664917}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5408.507078486334, "num_env_steps_trained_throughput_per_sec": 5408.507078486334, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2195.318, "sample_time_ms": 1922.124, "load_time_ms": 13.109, "load_throughput": 915373.849, "learn_time_ms": 249.963, "learn_throughput": 48007.009, "synch_weights_time_ms": 9.221}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3288, "training_iteration": 72, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-04", "timestamp": 1698246844, "time_this_iter_s": 2.2237234115600586, "time_total_s": 179.98835444450378, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.98835444450378, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.217105123731825, "policy_loss": -0.00013567372742626403, "vf_loss": 6.217285262213813, "vf_explained_var": -1.672241422865126e-06, "kl": 0.00038149622771769626, "entropy": 0.44617096583048504, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7299999999997914, "episode_len_mean": 283.28, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.300000000000026, 13.099999999999746, 28.29999999999996, 5.499999999999638, 39.50000000000002, 20.099999999999845, -50.00000000000044, 39.50000000000002, 45.3, 46.3, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 46.099999999999994, 41.500000000000014, -50.00000000000044, 13.099999999999746, 42.500000000000014, -50.00000000000044, 47.3, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 8.099999999999675, 15.899999999999785, 36.10000000000004, 30.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, 23.499999999999893, 45.1, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 39.70000000000002, 44.10000000000001, 2.499999999999595, 42.30000000000001, 45.9, 45.1, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.3, 40.10000000000002, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 32, 212, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 208, 108, 370, 218, 446, 106, 300, 500, 106, 48, 38, 50, 76, 500, 500, 492, 40, 86, 500, 370, 76, 500, 28, 62, 50, 500, 500, 500, 500, 46, 46, 420, 342, 140, 194, 48, 500, 46, 500, 266, 50, 500, 56, 48, 500, 500, 500, 500, 500, 168, 62, 84, 500, 500, 54, 72, 104, 60, 476, 78, 42, 50, 42, 44, 500, 500, 26, 50, 500, 500, 500, 42, 40, 48, 100, 198, 500, 48, 500, 68, 114, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4298908626488503, "mean_inference_ms": 1.3700824443545332, "mean_action_processing_ms": 0.16007565014924907, "mean_env_wait_ms": 0.09591882850157762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601337432861328, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13557934761047363}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7299999999997914, "episode_len_mean": 283.28, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 28.89999999999997, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.300000000000026, 13.099999999999746, 28.29999999999996, 5.499999999999638, 39.50000000000002, 20.099999999999845, -50.00000000000044, 39.50000000000002, 45.3, 46.3, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 0.8999999999995723, 46.099999999999994, 41.500000000000014, -50.00000000000044, 13.099999999999746, 42.500000000000014, -50.00000000000044, 47.3, 43.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 8.099999999999675, 15.899999999999785, 36.10000000000004, 30.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, 23.499999999999893, 45.1, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 39.70000000000002, 44.10000000000001, 2.499999999999595, 42.30000000000001, 45.9, 45.1, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.3, 40.10000000000002, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 32, 212, 500, 34, 500, 500, 500, 500, 500, 500, 500, 500, 500, 208, 108, 370, 218, 446, 106, 300, 500, 106, 48, 38, 50, 76, 500, 500, 492, 40, 86, 500, 370, 76, 500, 28, 62, 50, 500, 500, 500, 500, 46, 46, 420, 342, 140, 194, 48, 500, 46, 500, 266, 50, 500, 56, 48, 500, 500, 500, 500, 500, 168, 62, 84, 500, 500, 54, 72, 104, 60, 476, 78, 42, 50, 42, 44, 500, 500, 26, 50, 500, 500, 500, 42, 40, 48, 100, 198, 500, 48, 500, 68, 114, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4298908626488503, "mean_inference_ms": 1.3700824443545332, "mean_action_processing_ms": 0.16007565014924907, "mean_env_wait_ms": 0.09591882850157762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601337432861328, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13557934761047363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5671.558230166676, "num_env_steps_trained_throughput_per_sec": 5671.558230166676, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2193.616, "sample_time_ms": 1922.643, "load_time_ms": 13.11, "load_throughput": 915365.525, "learn_time_ms": 248.01, "learn_throughput": 48385.087, "synch_weights_time_ms": 9.154}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3333, "training_iteration": 73, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-06", "timestamp": 1698246846, "time_this_iter_s": 2.120820999145508, "time_total_s": 182.1091754436493, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.1091754436493, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.0718766583336725, "policy_loss": 4.955494983328713e-05, "vf_loss": 6.0718760755327015, "vf_explained_var": -8.742014567057291e-07, "kl": 0.00011406320171640043, "entropy": 0.49001901348431903, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1323.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.791999999999814, "episode_len_mean": 262.7, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 8.099999999999675, 15.899999999999785, 36.10000000000004, 30.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, 23.499999999999893, 45.1, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 39.70000000000002, 44.10000000000001, 2.499999999999595, 42.30000000000001, 45.9, 45.1, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.3, 40.10000000000002, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.7, 41.70000000000002, 46.3, 34.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 34.10000000000004, 46.099999999999994, 11.29999999999972, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 46.699999999999996, 46.9, 42.500000000000014, -50.00000000000044, 19.69999999999984, 42.30000000000001, 28.89999999999997, 46.099999999999994, 45.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 6.299999999999649, 36.10000000000004, 42.70000000000001, 43.10000000000001], "episode_lengths": [500, 500, 500, 46, 46, 420, 342, 140, 194, 48, 500, 46, 500, 266, 50, 500, 56, 48, 500, 500, 500, 500, 500, 168, 62, 84, 500, 500, 54, 72, 104, 60, 476, 78, 42, 50, 42, 44, 500, 500, 26, 50, 500, 500, 500, 42, 40, 48, 100, 198, 500, 48, 500, 68, 114, 500, 500, 500, 96, 24, 84, 38, 152, 500, 52, 500, 500, 500, 500, 54, 500, 36, 160, 40, 388, 500, 342, 500, 500, 500, 500, 306, 500, 34, 32, 76, 500, 304, 78, 212, 40, 48, 500, 500, 124, 56, 438, 140, 74, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42901091222559684, "mean_inference_ms": 1.3674832490240483, "mean_action_processing_ms": 0.15995847570811839, "mean_env_wait_ms": 0.09596099132220438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03601241111755371, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.1261305809020996}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.791999999999814, "episode_len_mean": 262.7, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.5, 8.099999999999675, 15.899999999999785, 36.10000000000004, 30.699999999999996, 45.3, -50.00000000000044, 45.5, -50.00000000000044, 23.499999999999893, 45.1, -50.00000000000044, 44.5, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 43.900000000000006, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 39.70000000000002, 44.10000000000001, 2.499999999999595, 42.30000000000001, 45.9, 45.1, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.3, 40.10000000000002, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.7, 41.70000000000002, 46.3, 34.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 34.10000000000004, 46.099999999999994, 11.29999999999972, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 46.699999999999996, 46.9, 42.500000000000014, -50.00000000000044, 19.69999999999984, 42.30000000000001, 28.89999999999997, 46.099999999999994, 45.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 6.299999999999649, 36.10000000000004, 42.70000000000001, 43.10000000000001], "episode_lengths": [500, 500, 500, 46, 46, 420, 342, 140, 194, 48, 500, 46, 500, 266, 50, 500, 56, 48, 500, 500, 500, 500, 500, 168, 62, 84, 500, 500, 54, 72, 104, 60, 476, 78, 42, 50, 42, 44, 500, 500, 26, 50, 500, 500, 500, 42, 40, 48, 100, 198, 500, 48, 500, 68, 114, 500, 500, 500, 96, 24, 84, 38, 152, 500, 52, 500, 500, 500, 500, 54, 500, 36, 160, 40, 388, 500, 342, 500, 500, 500, 500, 306, 500, 34, 32, 76, 500, 304, 78, 212, 40, 48, 500, 500, 124, 56, 438, 140, 74, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42901091222559684, "mean_inference_ms": 1.3674832490240483, "mean_action_processing_ms": 0.15995847570811839, "mean_env_wait_ms": 0.09596099132220438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03601241111755371, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.1261305809020996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5470.324704712129, "num_env_steps_trained_throughput_per_sec": 5470.324704712129, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2187.52, "sample_time_ms": 1922.538, "load_time_ms": 12.663, "load_throughput": 947636.878, "learn_time_ms": 242.226, "learn_throughput": 49540.457, "synch_weights_time_ms": 9.091}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3376, "training_iteration": 74, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-08", "timestamp": 1698246848, "time_this_iter_s": 2.198652505874634, "time_total_s": 184.30782794952393, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.30782794952393, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.404789262347752, "policy_loss": -6.201718416478898e-05, "vf_loss": 6.404901557498508, "vf_explained_var": -1.1987156338161892e-06, "kl": 0.00010435071997171185, "entropy": 0.5029253363609314, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1341.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.815999999999811, "episode_len_mean": 272.46, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.3, 40.10000000000002, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.7, 41.70000000000002, 46.3, 34.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 34.10000000000004, 46.099999999999994, 11.29999999999972, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 46.699999999999996, 46.9, 42.500000000000014, -50.00000000000044, 19.69999999999984, 42.30000000000001, 28.89999999999997, 46.099999999999994, 45.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 6.299999999999649, 36.10000000000004, 42.70000000000001, 43.10000000000001, -50.00000000000044, 40.90000000000002, 44.5, 43.10000000000001, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.10000000000002, 33.10000000000003, 29.69999999999998, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 32.700000000000024, -50.00000000000044, 18.29999999999982, 41.70000000000002, 43.7, 43.900000000000006, 47.1, -50.00000000000044, 38.700000000000024, 27.299999999999947, 42.70000000000001, 44.7, -50.00000000000044, 40.30000000000002], "episode_lengths": [500, 500, 42, 40, 48, 100, 198, 500, 48, 500, 68, 114, 500, 500, 500, 96, 24, 84, 38, 152, 500, 52, 500, 500, 500, 500, 54, 500, 36, 160, 40, 388, 500, 342, 500, 500, 500, 500, 306, 500, 34, 32, 76, 500, 304, 78, 212, 40, 48, 500, 500, 124, 56, 438, 140, 74, 70, 500, 92, 56, 70, 488, 500, 130, 500, 500, 138, 500, 110, 170, 204, 438, 500, 500, 500, 52, 500, 58, 500, 500, 500, 50, 104, 500, 130, 500, 174, 500, 318, 84, 64, 62, 30, 500, 114, 228, 74, 54, 500, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42816349757239236, "mean_inference_ms": 1.3648360665606685, "mean_action_processing_ms": 0.15946972573847007, "mean_env_wait_ms": 0.09577787461902582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031009674072265625, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.12618112564086914}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.815999999999811, "episode_len_mean": 272.46, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, 45.3, 40.10000000000002, 30.29999999999999, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.7, 41.70000000000002, 46.3, 34.900000000000034, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.5, 34.10000000000004, 46.099999999999994, 11.29999999999972, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.499999999999837, -50.00000000000044, 46.699999999999996, 46.9, 42.500000000000014, -50.00000000000044, 19.69999999999984, 42.30000000000001, 28.89999999999997, 46.099999999999994, 45.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 6.299999999999649, 36.10000000000004, 42.70000000000001, 43.10000000000001, -50.00000000000044, 40.90000000000002, 44.5, 43.10000000000001, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.10000000000002, 33.10000000000003, 29.69999999999998, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 32.700000000000024, -50.00000000000044, 18.29999999999982, 41.70000000000002, 43.7, 43.900000000000006, 47.1, -50.00000000000044, 38.700000000000024, 27.299999999999947, 42.70000000000001, 44.7, -50.00000000000044, 40.30000000000002], "episode_lengths": [500, 500, 42, 40, 48, 100, 198, 500, 48, 500, 68, 114, 500, 500, 500, 96, 24, 84, 38, 152, 500, 52, 500, 500, 500, 500, 54, 500, 36, 160, 40, 388, 500, 342, 500, 500, 500, 500, 306, 500, 34, 32, 76, 500, 304, 78, 212, 40, 48, 500, 500, 124, 56, 438, 140, 74, 70, 500, 92, 56, 70, 488, 500, 130, 500, 500, 138, 500, 110, 170, 204, 438, 500, 500, 500, 52, 500, 58, 500, 500, 500, 50, 104, 500, 130, 500, 174, 500, 318, 84, 64, 62, 30, 500, 114, 228, 74, 54, 500, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42816349757239236, "mean_inference_ms": 1.3648360665606685, "mean_action_processing_ms": 0.15946972573847007, "mean_env_wait_ms": 0.09577787461902582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031009674072265625, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.12618112564086914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5730.828399247468, "num_env_steps_trained_throughput_per_sec": 5730.828399247468, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2187.749, "sample_time_ms": 1924.551, "load_time_ms": 12.515, "load_throughput": 958842.34, "learn_time_ms": 240.557, "learn_throughput": 49884.177, "synch_weights_time_ms": 9.123}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3419, "training_iteration": 75, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-10", "timestamp": 1698246850, "time_this_iter_s": 2.097938060760498, "time_total_s": 186.40576601028442, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.40576601028442, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 58.23333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.679026126861572, "policy_loss": -8.700648322701454e-06, "vf_loss": 6.679088089201185, "vf_explained_var": -6.159146626790365e-07, "kl": 0.00021634491690747382, "entropy": 0.5320120023356544, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1359.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.677999999999822, "episode_len_mean": 263.86, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 44.5, 6.299999999999649, 36.10000000000004, 42.70000000000001, 43.10000000000001, -50.00000000000044, 40.90000000000002, 44.5, 43.10000000000001, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.10000000000002, 33.10000000000003, 29.69999999999998, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 32.700000000000024, -50.00000000000044, 18.29999999999982, 41.70000000000002, 43.7, 43.900000000000006, 47.1, -50.00000000000044, 38.700000000000024, 27.299999999999947, 42.70000000000001, 44.7, -50.00000000000044, 40.30000000000002, 24.099999999999902, 32.90000000000003, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.70000000000002, 44.300000000000004, 41.500000000000014, 38.300000000000026, 45.1, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 44.7, 43.50000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.5, 18.29999999999982, -50.00000000000044, 19.499999999999837, 46.9, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 13.499999999999751, -50.00000000000044, 33.500000000000036, -50.00000000000044, 47.9, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 124, 56, 438, 140, 74, 70, 500, 92, 56, 70, 488, 500, 130, 500, 500, 138, 500, 110, 170, 204, 438, 500, 500, 500, 52, 500, 58, 500, 500, 500, 50, 104, 500, 130, 500, 174, 500, 318, 84, 64, 62, 30, 500, 114, 228, 74, 54, 500, 98, 260, 172, 100, 102, 92, 500, 500, 58, 104, 58, 86, 118, 50, 500, 46, 46, 500, 54, 66, 96, 500, 500, 44, 500, 160, 70, 500, 500, 62, 500, 56, 318, 500, 306, 32, 500, 48, 118, 500, 366, 500, 166, 500, 22, 52, 500, 66, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4265764582366047, "mean_inference_ms": 1.3620986186628405, "mean_action_processing_ms": 0.15909685543695581, "mean_env_wait_ms": 0.09538383327491246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01924920082092285, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.11248111724853516}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.677999999999822, "episode_len_mean": 263.86, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.70000000000003, 44.5, 6.299999999999649, 36.10000000000004, 42.70000000000001, 43.10000000000001, -50.00000000000044, 40.90000000000002, 44.5, 43.10000000000001, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.10000000000002, 33.10000000000003, 29.69999999999998, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.300000000000004, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, 37.10000000000003, -50.00000000000044, 32.700000000000024, -50.00000000000044, 18.29999999999982, 41.70000000000002, 43.7, 43.900000000000006, 47.1, -50.00000000000044, 38.700000000000024, 27.299999999999947, 42.70000000000001, 44.7, -50.00000000000044, 40.30000000000002, 24.099999999999902, 32.90000000000003, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.70000000000002, 44.300000000000004, 41.500000000000014, 38.300000000000026, 45.1, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 44.7, 43.50000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.5, 18.29999999999982, -50.00000000000044, 19.499999999999837, 46.9, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 13.499999999999751, -50.00000000000044, 33.500000000000036, -50.00000000000044, 47.9, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 124, 56, 438, 140, 74, 70, 500, 92, 56, 70, 488, 500, 130, 500, 500, 138, 500, 110, 170, 204, 438, 500, 500, 500, 52, 500, 58, 500, 500, 500, 50, 104, 500, 130, 500, 174, 500, 318, 84, 64, 62, 30, 500, 114, 228, 74, 54, 500, 98, 260, 172, 100, 102, 92, 500, 500, 58, 104, 58, 86, 118, 50, 500, 46, 46, 500, 54, 66, 96, 500, 500, 44, 500, 160, 70, 500, 500, 62, 500, 56, 318, 500, 306, 32, 500, 48, 118, 500, 366, 500, 166, 500, 22, 52, 500, 66, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4265764582366047, "mean_inference_ms": 1.3620986186628405, "mean_action_processing_ms": 0.15909685543695581, "mean_env_wait_ms": 0.09538383327491246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01924920082092285, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.11248111724853516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5353.588302436245, "num_env_steps_trained_throughput_per_sec": 5353.588302436245, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2185.867, "sample_time_ms": 1922.902, "load_time_ms": 12.399, "load_throughput": 967830.692, "learn_time_ms": 240.543, "learn_throughput": 49887.064, "synch_weights_time_ms": 9.021}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3469, "training_iteration": 76, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-13", "timestamp": 1698246853, "time_this_iter_s": 2.246485948562622, "time_total_s": 188.65225195884705, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.65225195884705, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 59.93333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.551576693852742, "policy_loss": -0.0003606329361597697, "vf_loss": 6.551985926098293, "vf_explained_var": -3.4769376118977863e-07, "kl": 0.0004768939861937345, "entropy": 0.4866744991805818, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1377.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.273999999999834, "episode_len_mean": 247.9, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 40.30000000000002, 24.099999999999902, 32.90000000000003, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.70000000000002, 44.300000000000004, 41.500000000000014, 38.300000000000026, 45.1, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 44.7, 43.50000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.5, 18.29999999999982, -50.00000000000044, 19.499999999999837, 46.9, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 13.499999999999751, -50.00000000000044, 33.500000000000036, -50.00000000000044, 47.9, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 25.29999999999992, 45.1, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, 32.90000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 42.70000000000001, 41.500000000000014, 46.3, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 19.899999999999842, -50.00000000000044, 41.70000000000002, 33.90000000000004, 44.7, 45.9, 24.899999999999913, 14.299999999999763, -50.00000000000044, 44.5], "episode_lengths": [54, 500, 98, 260, 172, 100, 102, 92, 500, 500, 58, 104, 58, 86, 118, 50, 500, 46, 46, 500, 54, 66, 96, 500, 500, 44, 500, 160, 70, 500, 500, 62, 500, 56, 318, 500, 306, 32, 500, 48, 118, 500, 366, 500, 166, 500, 22, 52, 500, 66, 500, 500, 500, 500, 46, 70, 500, 248, 50, 42, 500, 98, 500, 26, 500, 500, 46, 82, 172, 140, 500, 500, 500, 54, 34, 500, 160, 500, 58, 74, 68, 74, 86, 38, 188, 500, 500, 500, 40, 40, 302, 500, 84, 162, 54, 42, 252, 358, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4255253964973676, "mean_inference_ms": 1.3608329950204583, "mean_action_processing_ms": 0.15893922367251803, "mean_env_wait_ms": 0.09522195381043398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022769927978515625, "StateBufferConnector_ms": 0.004011631011962891, "ViewRequirementAgentConnector_ms": 0.12427186965942383}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.273999999999834, "episode_len_mean": 247.9, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 40.30000000000002, 24.099999999999902, 32.90000000000003, 40.10000000000002, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 39.70000000000002, 44.300000000000004, 41.500000000000014, 38.300000000000026, 45.1, -50.00000000000044, 45.5, 45.5, -50.00000000000044, 44.7, 43.50000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.10000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.5, 18.29999999999982, -50.00000000000044, 19.499999999999837, 46.9, -50.00000000000044, 45.3, 38.300000000000026, -50.00000000000044, 13.499999999999751, -50.00000000000044, 33.500000000000036, -50.00000000000044, 47.9, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, 25.29999999999992, 45.1, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, 32.90000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 42.70000000000001, 41.500000000000014, 46.3, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 19.899999999999842, -50.00000000000044, 41.70000000000002, 33.90000000000004, 44.7, 45.9, 24.899999999999913, 14.299999999999763, -50.00000000000044, 44.5], "episode_lengths": [54, 500, 98, 260, 172, 100, 102, 92, 500, 500, 58, 104, 58, 86, 118, 50, 500, 46, 46, 500, 54, 66, 96, 500, 500, 44, 500, 160, 70, 500, 500, 62, 500, 56, 318, 500, 306, 32, 500, 48, 118, 500, 366, 500, 166, 500, 22, 52, 500, 66, 500, 500, 500, 500, 46, 70, 500, 248, 50, 42, 500, 98, 500, 26, 500, 500, 46, 82, 172, 140, 500, 500, 500, 54, 34, 500, 160, 500, 58, 74, 68, 74, 86, 38, 188, 500, 500, 500, 40, 40, 302, 500, 84, 162, 54, 42, 252, 358, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4255253964973676, "mean_inference_ms": 1.3608329950204583, "mean_action_processing_ms": 0.15893922367251803, "mean_env_wait_ms": 0.09522195381043398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022769927978515625, "StateBufferConnector_ms": 0.004011631011962891, "ViewRequirementAgentConnector_ms": 0.12427186965942383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5835.531740635861, "num_env_steps_trained_throughput_per_sec": 5835.531740635861, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2185.747, "sample_time_ms": 1922.49, "load_time_ms": 12.29, "load_throughput": 976382.672, "learn_time_ms": 240.946, "learn_throughput": 49803.738, "synch_weights_time_ms": 9.019}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3516, "training_iteration": 77, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-15", "timestamp": 1698246855, "time_this_iter_s": 2.060380697250366, "time_total_s": 190.7126326560974, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.7126326560974, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.6, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 5.888843880759345, "policy_loss": -0.00030280442701445683, "vf_loss": 5.8891951243082685, "vf_explained_var": -2.1855036417643228e-07, "kl": 0.0005566079627467641, "entropy": 0.4832465085718367, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.630999999999867, "episode_len_mean": 209.42, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.29999999999992, 45.1, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, 32.90000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 42.70000000000001, 41.500000000000014, 46.3, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 19.899999999999842, -50.00000000000044, 41.70000000000002, 33.90000000000004, 44.7, 45.9, 24.899999999999913, 14.299999999999763, -50.00000000000044, 44.5, 7.499999999999666, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.900000000000006, 46.699999999999996, 46.3, 39.50000000000002, 5.099999999999632, 46.699999999999996, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 45.5, 44.300000000000004, 44.900000000000006, 23.699999999999896, -50.00000000000044, 46.5, 41.90000000000001, 44.900000000000006, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.9, 45.7, 33.30000000000003, 43.10000000000001, 39.70000000000002, -50.00000000000044, 43.900000000000006, 45.3, 47.5, 47.1, 12.69999999999974, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 44.300000000000004, 36.900000000000034, 31.900000000000013, 43.10000000000001, 44.7, 47.1, 46.9], "episode_lengths": [248, 50, 42, 500, 98, 500, 26, 500, 500, 46, 82, 172, 140, 500, 500, 500, 54, 34, 500, 160, 500, 58, 74, 68, 74, 86, 38, 188, 500, 500, 500, 40, 40, 302, 500, 84, 162, 54, 42, 252, 358, 500, 56, 426, 60, 52, 500, 500, 322, 62, 34, 38, 106, 450, 34, 22, 500, 52, 500, 500, 40, 62, 46, 58, 52, 264, 500, 36, 82, 52, 70, 500, 46, 500, 94, 500, 32, 44, 168, 70, 104, 500, 62, 48, 26, 30, 374, 500, 134, 500, 500, 68, 36, 58, 132, 182, 70, 54, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42525277454056437, "mean_inference_ms": 1.3574803224766612, "mean_action_processing_ms": 0.1584760024492558, "mean_env_wait_ms": 0.09490491429232083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028529882431030273, "StateBufferConnector_ms": 0.00400996208190918, "ViewRequirementAgentConnector_ms": 0.12589287757873535}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.630999999999867, "episode_len_mean": 209.42, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.29999999999992, 45.1, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 45.5, 41.90000000000001, 32.90000000000003, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 42.70000000000001, 41.500000000000014, 46.3, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 19.899999999999842, -50.00000000000044, 41.70000000000002, 33.90000000000004, 44.7, 45.9, 24.899999999999913, 14.299999999999763, -50.00000000000044, 44.5, 7.499999999999666, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.900000000000006, 46.699999999999996, 46.3, 39.50000000000002, 5.099999999999632, 46.699999999999996, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 45.5, 44.300000000000004, 44.900000000000006, 23.699999999999896, -50.00000000000044, 46.5, 41.90000000000001, 44.900000000000006, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.9, 45.7, 33.30000000000003, 43.10000000000001, 39.70000000000002, -50.00000000000044, 43.900000000000006, 45.3, 47.5, 47.1, 12.69999999999974, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 44.300000000000004, 36.900000000000034, 31.900000000000013, 43.10000000000001, 44.7, 47.1, 46.9], "episode_lengths": [248, 50, 42, 500, 98, 500, 26, 500, 500, 46, 82, 172, 140, 500, 500, 500, 54, 34, 500, 160, 500, 58, 74, 68, 74, 86, 38, 188, 500, 500, 500, 40, 40, 302, 500, 84, 162, 54, 42, 252, 358, 500, 56, 426, 60, 52, 500, 500, 322, 62, 34, 38, 106, 450, 34, 22, 500, 52, 500, 500, 40, 62, 46, 58, 52, 264, 500, 36, 82, 52, 70, 500, 46, 500, 94, 500, 32, 44, 168, 70, 104, 500, 62, 48, 26, 30, 374, 500, 134, 500, 500, 68, 36, 58, 132, 182, 70, 54, 30, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42525277454056437, "mean_inference_ms": 1.3574803224766612, "mean_action_processing_ms": 0.1584760024492558, "mean_env_wait_ms": 0.09490491429232083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028529882431030273, "StateBufferConnector_ms": 0.00400996208190918, "ViewRequirementAgentConnector_ms": 0.12589287757873535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5281.399003398117, "num_env_steps_trained_throughput_per_sec": 5281.399003398117, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2186.535, "sample_time_ms": 1917.46, "load_time_ms": 13.093, "load_throughput": 916490.61, "learn_time_ms": 245.336, "learn_throughput": 48912.605, "synch_weights_time_ms": 9.544}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3573, "training_iteration": 78, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-17", "timestamp": 1698246857, "time_this_iter_s": 2.2771239280700684, "time_total_s": 192.98975658416748, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.98975658416748, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 55.650000000000006, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.303370396296184, "policy_loss": 1.7149994770685833e-05, "vf_loss": 6.3034033510420056, "vf_explained_var": -1.5166070726182725e-06, "kl": 0.00024704057304031975, "entropy": 0.5018051481909223, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1413.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.46499999999983, "episode_len_mean": 241.0, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.499999999999666, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.900000000000006, 46.699999999999996, 46.3, 39.50000000000002, 5.099999999999632, 46.699999999999996, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 45.5, 44.300000000000004, 44.900000000000006, 23.699999999999896, -50.00000000000044, 46.5, 41.90000000000001, 44.900000000000006, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.9, 45.7, 33.30000000000003, 43.10000000000001, 39.70000000000002, -50.00000000000044, 43.900000000000006, 45.3, 47.5, 47.1, 12.69999999999974, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 44.300000000000004, 36.900000000000034, 31.900000000000013, 43.10000000000001, 44.7, 47.1, 46.9, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 46.3, 36.50000000000003, 44.7, 45.1, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 40.30000000000002, -50.00000000000044, 24.299999999999905, 38.50000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.10000000000003, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [426, 60, 52, 500, 500, 322, 62, 34, 38, 106, 450, 34, 22, 500, 52, 500, 500, 40, 62, 46, 58, 52, 264, 500, 36, 82, 52, 70, 500, 46, 500, 94, 500, 32, 44, 168, 70, 104, 500, 62, 48, 26, 30, 374, 500, 134, 500, 500, 68, 36, 58, 132, 182, 70, 54, 30, 32, 500, 86, 70, 500, 62, 500, 28, 38, 136, 54, 50, 46, 500, 500, 500, 452, 500, 500, 500, 500, 500, 60, 98, 98, 500, 258, 116, 46, 500, 500, 500, 500, 190, 500, 500, 500, 92, 130, 50, 500, 126, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4246949647929695, "mean_inference_ms": 1.3561056952112986, "mean_action_processing_ms": 0.1583172358368933, "mean_env_wait_ms": 0.09492205632490622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0289309024810791, "StateBufferConnector_ms": 0.006992816925048828, "ViewRequirementAgentConnector_ms": 0.1054372787475586}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.46499999999983, "episode_len_mean": 241.0, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.499999999999666, 44.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.899999999999814, 43.900000000000006, 46.699999999999996, 46.3, 39.50000000000002, 5.099999999999632, 46.699999999999996, 47.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, 45.5, 44.300000000000004, 44.900000000000006, 23.699999999999896, -50.00000000000044, 46.5, 41.90000000000001, 44.900000000000006, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.9, 45.7, 33.30000000000003, 43.10000000000001, 39.70000000000002, -50.00000000000044, 43.900000000000006, 45.3, 47.5, 47.1, 12.69999999999974, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 44.300000000000004, 36.900000000000034, 31.900000000000013, 43.10000000000001, 44.7, 47.1, 46.9, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 46.3, 36.50000000000003, 44.7, 45.1, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 40.30000000000002, -50.00000000000044, 24.299999999999905, 38.50000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.10000000000003, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [426, 60, 52, 500, 500, 322, 62, 34, 38, 106, 450, 34, 22, 500, 52, 500, 500, 40, 62, 46, 58, 52, 264, 500, 36, 82, 52, 70, 500, 46, 500, 94, 500, 32, 44, 168, 70, 104, 500, 62, 48, 26, 30, 374, 500, 134, 500, 500, 68, 36, 58, 132, 182, 70, 54, 30, 32, 500, 86, 70, 500, 62, 500, 28, 38, 136, 54, 50, 46, 500, 500, 500, 452, 500, 500, 500, 500, 500, 60, 98, 98, 500, 258, 116, 46, 500, 500, 500, 500, 190, 500, 500, 500, 92, 130, 50, 500, 126, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4246949647929695, "mean_inference_ms": 1.3561056952112986, "mean_action_processing_ms": 0.1583172358368933, "mean_env_wait_ms": 0.09492205632490622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0289309024810791, "StateBufferConnector_ms": 0.006992816925048828, "ViewRequirementAgentConnector_ms": 0.1054372787475586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5691.221377757404, "num_env_steps_trained_throughput_per_sec": 5691.221377757404, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2170.999, "sample_time_ms": 1916.634, "load_time_ms": 12.316, "load_throughput": 974362.088, "learn_time_ms": 231.049, "learn_throughput": 51937.048, "synch_weights_time_ms": 9.898}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3616, "training_iteration": 79, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-19", "timestamp": 1698246859, "time_this_iter_s": 2.1135191917419434, "time_total_s": 195.10327577590942, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.10327577590942, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 59.900000000000006, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.798710902531941, "policy_loss": -0.00043040017286936444, "vf_loss": 6.799188560909695, "vf_explained_var": -6.192260318332248e-07, "kl": 0.00040889849376905357, "entropy": 0.47203745941321057, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1431.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.182000000000219, "episode_len_mean": 292.36, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 47.5, 47.1, 12.69999999999974, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 44.300000000000004, 36.900000000000034, 31.900000000000013, 43.10000000000001, 44.7, 47.1, 46.9, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 46.3, 36.50000000000003, 44.7, 45.1, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 40.30000000000002, -50.00000000000044, 24.299999999999905, 38.50000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.10000000000003, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 45.3, 45.3, 43.7, 20.49999999999985, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [48, 26, 30, 374, 500, 134, 500, 500, 68, 36, 58, 132, 182, 70, 54, 30, 32, 500, 86, 70, 500, 62, 500, 28, 38, 136, 54, 50, 46, 500, 500, 500, 452, 500, 500, 500, 500, 500, 60, 98, 98, 500, 258, 116, 46, 500, 500, 500, 500, 190, 500, 500, 500, 92, 130, 50, 500, 126, 500, 500, 442, 500, 500, 500, 24, 46, 500, 48, 92, 500, 56, 500, 74, 302, 500, 500, 500, 30, 500, 500, 500, 356, 500, 48, 48, 64, 296, 500, 392, 500, 500, 98, 162, 500, 500, 500, 34, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42485224404641886, "mean_inference_ms": 1.354126272410735, "mean_action_processing_ms": 0.15854958531975463, "mean_env_wait_ms": 0.09508515959361111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02980518341064453, "StateBufferConnector_ms": 0.006993770599365234, "ViewRequirementAgentConnector_ms": 0.10733461380004883}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.182000000000219, "episode_len_mean": 292.36, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 47.5, 47.1, 12.69999999999974, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.5, 44.300000000000004, 36.900000000000034, 31.900000000000013, 43.10000000000001, 44.7, 47.1, 46.9, -50.00000000000044, 41.500000000000014, 43.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 46.3, 36.50000000000003, 44.7, 45.1, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, 40.30000000000002, -50.00000000000044, 24.299999999999905, 38.50000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.10000000000003, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 45.3, 45.3, 43.7, 20.49999999999985, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [48, 26, 30, 374, 500, 134, 500, 500, 68, 36, 58, 132, 182, 70, 54, 30, 32, 500, 86, 70, 500, 62, 500, 28, 38, 136, 54, 50, 46, 500, 500, 500, 452, 500, 500, 500, 500, 500, 60, 98, 98, 500, 258, 116, 46, 500, 500, 500, 500, 190, 500, 500, 500, 92, 130, 50, 500, 126, 500, 500, 442, 500, 500, 500, 24, 46, 500, 48, 92, 500, 56, 500, 74, 302, 500, 500, 500, 30, 500, 500, 500, 356, 500, 48, 48, 64, 296, 500, 392, 500, 500, 98, 162, 500, 500, 500, 34, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42485224404641886, "mean_inference_ms": 1.354126272410735, "mean_action_processing_ms": 0.15854958531975463, "mean_env_wait_ms": 0.09508515959361111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02980518341064453, "StateBufferConnector_ms": 0.006993770599365234, "ViewRequirementAgentConnector_ms": 0.10733461380004883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5302.550819540182, "num_env_steps_trained_throughput_per_sec": 5302.550819540182, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2173.341, "sample_time_ms": 1914.384, "load_time_ms": 12.414, "load_throughput": 966648.511, "learn_time_ms": 235.603, "learn_throughput": 50933.097, "synch_weights_time_ms": 9.838}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3656, "training_iteration": 80, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-21", "timestamp": 1698246861, "time_this_iter_s": 2.267864942550659, "time_total_s": 197.37114071846008, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.37114071846008, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 60.599999999999994, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.598880423439874, "policy_loss": -0.0003270424074596829, "vf_loss": 6.599248700671726, "vf_explained_var": -8.775128258599175e-07, "kl": 0.0008489083456121685, "entropy": 0.4115520765384038, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1449.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.439999999999795, "episode_len_mean": 276.18, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.90000000000002, 37.10000000000003, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 45.3, 45.3, 43.7, 20.49999999999985, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 35.70000000000003, 46.5, -50.00000000000044, 43.10000000000001, 40.90000000000002, 47.3, 38.90000000000002, 46.3, -50.00000000000044, 47.7, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, 19.899999999999842, 41.70000000000002, 46.3, 11.29999999999972, 39.70000000000002, -50.00000000000044, 30.9, 47.9, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.5, -50.00000000000044, 46.5, 47.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 45.9, -50.00000000000044, 47.1, 43.900000000000006, 46.3, -50.00000000000044, 28.29999999999996, 11.099999999999717, 44.900000000000006], "episode_lengths": [500, 500, 92, 130, 50, 500, 126, 500, 500, 442, 500, 500, 500, 24, 46, 500, 48, 92, 500, 56, 500, 74, 302, 500, 500, 500, 30, 500, 500, 500, 356, 500, 48, 48, 64, 296, 500, 392, 500, 500, 98, 162, 500, 500, 500, 34, 500, 500, 64, 500, 144, 36, 500, 70, 92, 28, 112, 38, 500, 24, 50, 40, 500, 500, 60, 500, 500, 500, 26, 28, 302, 84, 38, 388, 104, 500, 192, 22, 60, 72, 500, 84, 36, 500, 36, 28, 46, 500, 500, 500, 472, 42, 500, 30, 62, 38, 500, 218, 390, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42384450816902897, "mean_inference_ms": 1.3532087403955608, "mean_action_processing_ms": 0.15826147486571585, "mean_env_wait_ms": 0.09481185226578254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02589559555053711, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.1375429630279541}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.439999999999795, "episode_len_mean": 276.18, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.90000000000002, 37.10000000000003, 45.1, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 45.5, -50.00000000000044, 45.3, 40.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 45.3, 45.3, 43.7, 20.49999999999985, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 35.70000000000003, 46.5, -50.00000000000044, 43.10000000000001, 40.90000000000002, 47.3, 38.90000000000002, 46.3, -50.00000000000044, 47.7, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, 19.899999999999842, 41.70000000000002, 46.3, 11.29999999999972, 39.70000000000002, -50.00000000000044, 30.9, 47.9, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.5, -50.00000000000044, 46.5, 47.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 45.9, -50.00000000000044, 47.1, 43.900000000000006, 46.3, -50.00000000000044, 28.29999999999996, 11.099999999999717, 44.900000000000006], "episode_lengths": [500, 500, 92, 130, 50, 500, 126, 500, 500, 442, 500, 500, 500, 24, 46, 500, 48, 92, 500, 56, 500, 74, 302, 500, 500, 500, 30, 500, 500, 500, 356, 500, 48, 48, 64, 296, 500, 392, 500, 500, 98, 162, 500, 500, 500, 34, 500, 500, 64, 500, 144, 36, 500, 70, 92, 28, 112, 38, 500, 24, 50, 40, 500, 500, 60, 500, 500, 500, 26, 28, 302, 84, 38, 388, 104, 500, 192, 22, 60, 72, 500, 84, 36, 500, 36, 28, 46, 500, 500, 500, 472, 42, 500, 30, 62, 38, 500, 218, 390, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42384450816902897, "mean_inference_ms": 1.3532087403955608, "mean_action_processing_ms": 0.15826147486571585, "mean_env_wait_ms": 0.09481185226578254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02589559555053711, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.1375429630279541}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5689.281148444344, "num_env_steps_trained_throughput_per_sec": 5689.281148444344, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2167.192, "sample_time_ms": 1909.091, "load_time_ms": 12.415, "load_throughput": 966581.681, "learn_time_ms": 234.692, "learn_throughput": 51130.776, "synch_weights_time_ms": 9.893}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3707, "training_iteration": 81, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-23", "timestamp": 1698246863, "time_this_iter_s": 2.114237070083618, "time_total_s": 199.4853777885437, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 199.4853777885437, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.390661001205444, "policy_loss": -0.0002821410695711772, "vf_loss": 6.390988349914551, "vf_explained_var": -2.8279092576768662e-06, "kl": 0.00040705639174929174, "entropy": 0.4525800413555569, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1467.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.85399999999984, "episode_len_mean": 232.12, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, 46.5, -50.00000000000044, 43.10000000000001, 40.90000000000002, 47.3, 38.90000000000002, 46.3, -50.00000000000044, 47.7, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, 19.899999999999842, 41.70000000000002, 46.3, 11.29999999999972, 39.70000000000002, -50.00000000000044, 30.9, 47.9, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.5, -50.00000000000044, 46.5, 47.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 45.9, -50.00000000000044, 47.1, 43.900000000000006, 46.3, -50.00000000000044, 28.29999999999996, 11.099999999999717, 44.900000000000006, 35.10000000000004, 45.7, 31.70000000000001, 46.9, 11.499999999999723, 39.10000000000002, 46.699999999999996, -50.00000000000044, 44.900000000000006, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 30.699999999999996, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, 27.49999999999995, 47.1, 41.90000000000001, 46.5, 45.1, -50.00000000000044, 38.10000000000002, 40.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [144, 36, 500, 70, 92, 28, 112, 38, 500, 24, 50, 40, 500, 500, 60, 500, 500, 500, 26, 28, 302, 84, 38, 388, 104, 500, 192, 22, 60, 72, 500, 84, 36, 500, 36, 28, 46, 500, 500, 500, 472, 42, 500, 30, 62, 38, 500, 218, 390, 52, 150, 44, 184, 32, 386, 110, 34, 500, 52, 58, 46, 500, 500, 30, 500, 194, 82, 500, 52, 500, 500, 38, 102, 500, 52, 500, 500, 500, 500, 42, 40, 500, 226, 30, 82, 36, 50, 500, 120, 94, 500, 48, 500, 76, 50, 500, 64, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42287226878855205, "mean_inference_ms": 1.3519712674864928, "mean_action_processing_ms": 0.15772576800989355, "mean_env_wait_ms": 0.09457343763214986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026015281677246094, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1425161361694336}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.85399999999984, "episode_len_mean": 232.12, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, 46.5, -50.00000000000044, 43.10000000000001, 40.90000000000002, 47.3, 38.90000000000002, 46.3, -50.00000000000044, 47.7, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.3, 19.899999999999842, 41.70000000000002, 46.3, 11.29999999999972, 39.70000000000002, -50.00000000000044, 30.9, 47.9, 44.10000000000001, 42.900000000000006, -50.00000000000044, 41.70000000000002, 46.5, -50.00000000000044, 46.5, 47.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 45.9, -50.00000000000044, 47.1, 43.900000000000006, 46.3, -50.00000000000044, 28.29999999999996, 11.099999999999717, 44.900000000000006, 35.10000000000004, 45.7, 31.70000000000001, 46.9, 11.499999999999723, 39.10000000000002, 46.699999999999996, -50.00000000000044, 44.900000000000006, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 30.699999999999996, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, 27.49999999999995, 47.1, 41.90000000000001, 46.5, 45.1, -50.00000000000044, 38.10000000000002, 40.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [144, 36, 500, 70, 92, 28, 112, 38, 500, 24, 50, 40, 500, 500, 60, 500, 500, 500, 26, 28, 302, 84, 38, 388, 104, 500, 192, 22, 60, 72, 500, 84, 36, 500, 36, 28, 46, 500, 500, 500, 472, 42, 500, 30, 62, 38, 500, 218, 390, 52, 150, 44, 184, 32, 386, 110, 34, 500, 52, 58, 46, 500, 500, 30, 500, 194, 82, 500, 52, 500, 500, 38, 102, 500, 52, 500, 500, 500, 500, 42, 40, 500, 226, 30, 82, 36, 50, 500, 120, 94, 500, 48, 500, 76, 50, 500, 64, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42287226878855205, "mean_inference_ms": 1.3519712674864928, "mean_action_processing_ms": 0.15772576800989355, "mean_env_wait_ms": 0.09457343763214986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026015281677246094, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1425161361694336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5336.4258780084, "num_env_steps_trained_throughput_per_sec": 5336.4258780084, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2170.189, "sample_time_ms": 1913.402, "load_time_ms": 12.334, "load_throughput": 972915.597, "learn_time_ms": 233.444, "learn_throughput": 51404.223, "synch_weights_time_ms": 9.909}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3757, "training_iteration": 82, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-26", "timestamp": 1698246866, "time_this_iter_s": 2.2536957263946533, "time_total_s": 201.73907351493835, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.73907351493835, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 63.43333333333334, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.1307050122155085, "policy_loss": -0.00011971841255823772, "vf_loss": 6.1308683554331465, "vf_explained_var": -1.0033448537190755e-06, "kl": 0.0002816705171271552, "entropy": 0.43795574870374465, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.236999999999815, "episode_len_mean": 253.22, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 43.900000000000006, 46.3, -50.00000000000044, 28.29999999999996, 11.099999999999717, 44.900000000000006, 35.10000000000004, 45.7, 31.70000000000001, 46.9, 11.499999999999723, 39.10000000000002, 46.699999999999996, -50.00000000000044, 44.900000000000006, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 30.699999999999996, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, 27.49999999999995, 47.1, 41.90000000000001, 46.5, 45.1, -50.00000000000044, 38.10000000000002, 40.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, 39.50000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, 46.3, 44.7, 41.30000000000001, 46.5, 40.30000000000002, 46.5, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5], "episode_lengths": [30, 62, 38, 500, 218, 390, 52, 150, 44, 184, 32, 386, 110, 34, 500, 52, 58, 46, 500, 500, 30, 500, 194, 82, 500, 52, 500, 500, 38, 102, 500, 52, 500, 500, 500, 500, 42, 40, 500, 226, 30, 82, 36, 50, 500, 120, 94, 500, 48, 500, 76, 50, 500, 64, 500, 500, 64, 500, 500, 66, 90, 106, 100, 500, 500, 500, 40, 500, 500, 86, 500, 500, 500, 500, 40, 62, 500, 66, 500, 500, 60, 44, 500, 38, 54, 88, 36, 98, 36, 58, 58, 500, 500, 34, 500, 500, 48, 500, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42339837860848534, "mean_inference_ms": 1.3496752160307142, "mean_action_processing_ms": 0.15731067741119342, "mean_env_wait_ms": 0.09451158046936406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024008512496948242, "StateBufferConnector_ms": 0.003995656967163086, "ViewRequirementAgentConnector_ms": 0.13515162467956543}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.236999999999815, "episode_len_mean": 253.22, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 43.900000000000006, 46.3, -50.00000000000044, 28.29999999999996, 11.099999999999717, 44.900000000000006, 35.10000000000004, 45.7, 31.70000000000001, 46.9, 11.499999999999723, 39.10000000000002, 46.699999999999996, -50.00000000000044, 44.900000000000006, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 30.699999999999996, 41.90000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, 27.49999999999995, 47.1, 41.90000000000001, 46.5, 45.1, -50.00000000000044, 38.10000000000002, 40.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, 39.50000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, 46.3, 44.7, 41.30000000000001, 46.5, 40.30000000000002, 46.5, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5], "episode_lengths": [30, 62, 38, 500, 218, 390, 52, 150, 44, 184, 32, 386, 110, 34, 500, 52, 58, 46, 500, 500, 30, 500, 194, 82, 500, 52, 500, 500, 38, 102, 500, 52, 500, 500, 500, 500, 42, 40, 500, 226, 30, 82, 36, 50, 500, 120, 94, 500, 48, 500, 76, 50, 500, 64, 500, 500, 64, 500, 500, 66, 90, 106, 100, 500, 500, 500, 40, 500, 500, 86, 500, 500, 500, 500, 40, 62, 500, 66, 500, 500, 60, 44, 500, 38, 54, 88, 36, 98, 36, 58, 58, 500, 500, 34, 500, 500, 48, 500, 500, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42339837860848534, "mean_inference_ms": 1.3496752160307142, "mean_action_processing_ms": 0.15731067741119342, "mean_env_wait_ms": 0.09451158046936406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024008512496948242, "StateBufferConnector_ms": 0.003995656967163086, "ViewRequirementAgentConnector_ms": 0.13515162467956543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5798.150113142592, "num_env_steps_trained_throughput_per_sec": 5798.150113142592, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2165.57, "sample_time_ms": 1911.584, "load_time_ms": 11.934, "load_throughput": 1005532.907, "learn_time_ms": 230.781, "learn_throughput": 51997.239, "synch_weights_time_ms": 10.012}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3800, "training_iteration": 83, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-28", "timestamp": 1698246868, "time_this_iter_s": 2.074424982070923, "time_total_s": 203.81349849700928, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.81349849700928, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 58.56666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.8294022878011065, "policy_loss": -0.0005672258428401417, "vf_loss": 6.830012718836467, "vf_explained_var": -9.834766387939453e-07, "kl": 0.00047557529255076107, "entropy": 0.4319864759842555, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1503.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.25900000000020723, "episode_len_mean": 278.14, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 40.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, 39.50000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, 46.3, 44.7, 41.30000000000001, 46.5, 40.30000000000002, 46.5, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5, 15.899999999999785, 46.699999999999996, 21.89999999999987, 45.7, 42.900000000000006, -50.00000000000044, 31.300000000000004, 12.099999999999731, 45.9, 40.10000000000002, -50.00000000000044, 40.90000000000002, 15.699999999999783, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 45.9, 37.90000000000003, 29.69999999999998, 13.699999999999754, -50.00000000000044, 46.3, 29.099999999999973, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 120, 94, 500, 48, 500, 76, 50, 500, 64, 500, 500, 64, 500, 500, 66, 90, 106, 100, 500, 500, 500, 40, 500, 500, 86, 500, 500, 500, 500, 40, 62, 500, 66, 500, 500, 60, 44, 500, 38, 54, 88, 36, 98, 36, 58, 58, 500, 500, 34, 500, 500, 48, 500, 500, 56, 342, 34, 282, 44, 72, 500, 188, 380, 42, 100, 500, 92, 344, 500, 74, 500, 500, 500, 66, 54, 42, 122, 204, 364, 500, 38, 210, 40, 500, 500, 48, 134, 500, 38, 500, 500, 500, 42, 500, 500, 500, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4230074124091634, "mean_inference_ms": 1.3482975797487677, "mean_action_processing_ms": 0.15732058858115547, "mean_env_wait_ms": 0.0945260773931598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017012596130371094, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.11623430252075195}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.25900000000020723, "episode_len_mean": 278.14, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 40.70000000000002, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 45.1, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.100000000000016, 39.50000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, 46.3, 44.7, 41.30000000000001, 46.5, 40.30000000000002, 46.5, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5, 15.899999999999785, 46.699999999999996, 21.89999999999987, 45.7, 42.900000000000006, -50.00000000000044, 31.300000000000004, 12.099999999999731, 45.9, 40.10000000000002, -50.00000000000044, 40.90000000000002, 15.699999999999783, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 45.9, 37.90000000000003, 29.69999999999998, 13.699999999999754, -50.00000000000044, 46.3, 29.099999999999973, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 120, 94, 500, 48, 500, 76, 50, 500, 64, 500, 500, 64, 500, 500, 66, 90, 106, 100, 500, 500, 500, 40, 500, 500, 86, 500, 500, 500, 500, 40, 62, 500, 66, 500, 500, 60, 44, 500, 38, 54, 88, 36, 98, 36, 58, 58, 500, 500, 34, 500, 500, 48, 500, 500, 56, 342, 34, 282, 44, 72, 500, 188, 380, 42, 100, 500, 92, 344, 500, 74, 500, 500, 500, 66, 54, 42, 122, 204, 364, 500, 38, 210, 40, 500, 500, 48, 134, 500, 38, 500, 500, 500, 42, 500, 500, 500, 38, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4230074124091634, "mean_inference_ms": 1.3482975797487677, "mean_action_processing_ms": 0.15732058858115547, "mean_env_wait_ms": 0.0945260773931598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017012596130371094, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.11623430252075195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5353.642969337597, "num_env_steps_trained_throughput_per_sec": 5353.642969337597, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2170.351, "sample_time_ms": 1912.568, "load_time_ms": 11.636, "load_throughput": 1031250.983, "learn_time_ms": 234.975, "learn_throughput": 51069.371, "synch_weights_time_ms": 10.116}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3844, "training_iteration": 84, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-30", "timestamp": 1698246870, "time_this_iter_s": 2.2454652786254883, "time_total_s": 206.05896377563477, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.05896377563477, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 60.666666666666664, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0339757656912848e-26, "cur_lr": 0.0003, "total_loss": 6.094034036000569, "policy_loss": 7.390360244446331e-05, "vf_loss": 6.094005955590142, "vf_explained_var": -1.5331639183892144e-06, "kl": 0.0005024188722081312, "entropy": 0.4588168263435364, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1521.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7849999999997925, "episode_len_mean": 277.72, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, 46.3, 44.7, 41.30000000000001, 46.5, 40.30000000000002, 46.5, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5, 15.899999999999785, 46.699999999999996, 21.89999999999987, 45.7, 42.900000000000006, -50.00000000000044, 31.300000000000004, 12.099999999999731, 45.9, 40.10000000000002, -50.00000000000044, 40.90000000000002, 15.699999999999783, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 45.9, 37.90000000000003, 29.69999999999998, 13.699999999999754, -50.00000000000044, 46.3, 29.099999999999973, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.699999999999655, 30.099999999999987, -50.00000000000044, 47.9, -50.00000000000044, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 8.899999999999686, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 44.5, 47.7], "episode_lengths": [500, 60, 44, 500, 38, 54, 88, 36, 98, 36, 58, 58, 500, 500, 34, 500, 500, 48, 500, 500, 56, 342, 34, 282, 44, 72, 500, 188, 380, 42, 100, 500, 92, 344, 500, 74, 500, 500, 500, 66, 54, 42, 122, 204, 364, 500, 38, 210, 40, 500, 500, 48, 134, 500, 38, 500, 500, 500, 42, 500, 500, 500, 38, 500, 500, 500, 28, 66, 500, 72, 500, 434, 200, 500, 22, 500, 34, 104, 500, 500, 36, 142, 68, 500, 500, 500, 500, 40, 32, 500, 500, 412, 22, 500, 500, 500, 338, 500, 56, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42215510837993264, "mean_inference_ms": 1.3471277562473412, "mean_action_processing_ms": 0.15703270830126592, "mean_env_wait_ms": 0.09431741636274028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701568603515625, "StateBufferConnector_ms": 0.0039942264556884766, "ViewRequirementAgentConnector_ms": 0.10848069190979004}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7849999999997925, "episode_len_mean": 277.72, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.10000000000001, 45.7, -50.00000000000044, 46.3, 44.7, 41.30000000000001, 46.5, 40.30000000000002, 46.5, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.5, 15.899999999999785, 46.699999999999996, 21.89999999999987, 45.7, 42.900000000000006, -50.00000000000044, 31.300000000000004, 12.099999999999731, 45.9, 40.10000000000002, -50.00000000000044, 40.90000000000002, 15.699999999999783, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.7, 45.9, 37.90000000000003, 29.69999999999998, 13.699999999999754, -50.00000000000044, 46.3, 29.099999999999973, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.699999999999655, 30.099999999999987, -50.00000000000044, 47.9, -50.00000000000044, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 8.899999999999686, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 44.5, 47.7], "episode_lengths": [500, 60, 44, 500, 38, 54, 88, 36, 98, 36, 58, 58, 500, 500, 34, 500, 500, 48, 500, 500, 56, 342, 34, 282, 44, 72, 500, 188, 380, 42, 100, 500, 92, 344, 500, 74, 500, 500, 500, 66, 54, 42, 122, 204, 364, 500, 38, 210, 40, 500, 500, 48, 134, 500, 38, 500, 500, 500, 42, 500, 500, 500, 38, 500, 500, 500, 28, 66, 500, 72, 500, 434, 200, 500, 22, 500, 34, 104, 500, 500, 36, 142, 68, 500, 500, 500, 500, 40, 32, 500, 500, 412, 22, 500, 500, 500, 338, 500, 56, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42215510837993264, "mean_inference_ms": 1.3471277562473412, "mean_action_processing_ms": 0.15703270830126592, "mean_env_wait_ms": 0.09431741636274028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701568603515625, "StateBufferConnector_ms": 0.0039942264556884766, "ViewRequirementAgentConnector_ms": 0.10848069190979004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5625.888119023039, "num_env_steps_trained_throughput_per_sec": 5625.888119023039, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2174.356, "sample_time_ms": 1915.094, "load_time_ms": 11.688, "load_throughput": 1026705.044, "learn_time_ms": 236.435, "learn_throughput": 50753.962, "synch_weights_time_ms": 9.983}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3879, "training_iteration": 85, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-32", "timestamp": 1698246872, "time_this_iter_s": 2.136995315551758, "time_total_s": 208.19595909118652, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.19595909118652, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.73333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456424e-27, "cur_lr": 0.0003, "total_loss": 6.32629378636678, "policy_loss": -2.101719534645478e-05, "vf_loss": 6.326360781987508, "vf_explained_var": 7.9141722785102e-07, "kl": 0.00012165000694292555, "entropy": 0.4587311264541414, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1539.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.760000000000238, "episode_len_mean": 308.1, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 37.90000000000003, 29.69999999999998, 13.699999999999754, -50.00000000000044, 46.3, 29.099999999999973, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.699999999999655, 30.099999999999987, -50.00000000000044, 47.9, -50.00000000000044, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 8.899999999999686, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 44.5, 47.7, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 38.90000000000002, -50.00000000000044, 33.500000000000036, 43.7, 42.70000000000001, 47.5, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 43.10000000000001], "episode_lengths": [42, 122, 204, 364, 500, 38, 210, 40, 500, 500, 48, 134, 500, 38, 500, 500, 500, 42, 500, 500, 500, 38, 500, 500, 500, 28, 66, 500, 72, 500, 434, 200, 500, 22, 500, 34, 104, 500, 500, 36, 142, 68, 500, 500, 500, 500, 40, 32, 500, 500, 412, 22, 500, 500, 500, 338, 500, 56, 24, 500, 256, 500, 500, 500, 398, 32, 500, 56, 500, 52, 500, 500, 74, 500, 40, 500, 134, 34, 500, 500, 500, 500, 500, 196, 500, 500, 430, 500, 112, 500, 166, 64, 74, 26, 82, 500, 32, 500, 32, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4212853885791945, "mean_inference_ms": 1.3453284579475127, "mean_action_processing_ms": 0.15690377489796142, "mean_env_wait_ms": 0.09419897970337601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.005991935729980469, "ViewRequirementAgentConnector_ms": 0.12847232818603516}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.760000000000238, "episode_len_mean": 308.1, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 37.90000000000003, 29.69999999999998, 13.699999999999754, -50.00000000000044, 46.3, 29.099999999999973, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 36.70000000000003, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 43.50000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.699999999999655, 30.099999999999987, -50.00000000000044, 47.9, -50.00000000000044, 46.699999999999996, 39.70000000000002, -50.00000000000044, -50.00000000000044, 46.5, 35.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 8.899999999999686, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 44.5, 47.7, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 38.90000000000002, -50.00000000000044, 33.500000000000036, 43.7, 42.70000000000001, 47.5, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 43.10000000000001], "episode_lengths": [42, 122, 204, 364, 500, 38, 210, 40, 500, 500, 48, 134, 500, 38, 500, 500, 500, 42, 500, 500, 500, 38, 500, 500, 500, 28, 66, 500, 72, 500, 434, 200, 500, 22, 500, 34, 104, 500, 500, 36, 142, 68, 500, 500, 500, 500, 40, 32, 500, 500, 412, 22, 500, 500, 500, 338, 500, 56, 24, 500, 256, 500, 500, 500, 398, 32, 500, 56, 500, 52, 500, 500, 74, 500, 40, 500, 134, 34, 500, 500, 500, 500, 500, 196, 500, 500, 430, 500, 112, 500, 166, 64, 74, 26, 82, 500, 32, 500, 32, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4212853885791945, "mean_inference_ms": 1.3453284579475127, "mean_action_processing_ms": 0.15690377489796142, "mean_env_wait_ms": 0.09419897970337601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.005991935729980469, "ViewRequirementAgentConnector_ms": 0.12847232818603516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5356.4564045232, "num_env_steps_trained_throughput_per_sec": 5356.4564045232, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2174.236, "sample_time_ms": 1915.263, "load_time_ms": 11.579, "load_throughput": 1036357.774, "learn_time_ms": 236.251, "learn_throughput": 50793.329, "synch_weights_time_ms": 9.987}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3920, "training_iteration": 86, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-35", "timestamp": 1698246875, "time_this_iter_s": 2.245286226272583, "time_total_s": 210.4412453174591, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 210.4412453174591, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.584939414228212e-27, "cur_lr": 0.0003, "total_loss": 6.4359292719099255, "policy_loss": -4.058414035373264e-05, "vf_loss": 6.436015605926514, "vf_explained_var": -1.1093086666531033e-06, "kl": 0.0002533675518705536, "entropy": 0.45770664513111115, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1557.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.618000000000244, "episode_len_mean": 316.66, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 35.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 8.899999999999686, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 44.5, 47.7, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 38.90000000000002, -50.00000000000044, 33.500000000000036, 43.7, 42.70000000000001, 47.5, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 43.10000000000001, 14.499999999999766, -50.00000000000044, 46.9, 44.7, 42.500000000000014, 31.300000000000004, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.3, 44.300000000000004, 32.50000000000002, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.7, 46.099999999999994], "episode_lengths": [500, 36, 142, 68, 500, 500, 500, 500, 40, 32, 500, 500, 412, 22, 500, 500, 500, 338, 500, 56, 24, 500, 256, 500, 500, 500, 398, 32, 500, 56, 500, 52, 500, 500, 74, 500, 40, 500, 134, 34, 500, 500, 500, 500, 500, 196, 500, 500, 430, 500, 112, 500, 166, 64, 74, 26, 82, 500, 32, 500, 32, 70, 356, 500, 32, 54, 76, 188, 500, 122, 46, 500, 500, 500, 156, 48, 58, 176, 500, 454, 500, 500, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 40, 58, 500, 500, 138, 64, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42090392121291104, "mean_inference_ms": 1.3433869180462619, "mean_action_processing_ms": 0.15687202733942335, "mean_env_wait_ms": 0.09409144179337059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033003807067871094, "StateBufferConnector_ms": 0.004993438720703125, "ViewRequirementAgentConnector_ms": 0.12295103073120117}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.618000000000244, "episode_len_mean": 316.66, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 35.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, -50.00000000000044, -50.00000000000044, 8.899999999999686, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 44.5, 47.7, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.299999999999706, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 38.90000000000002, -50.00000000000044, 33.500000000000036, 43.7, 42.70000000000001, 47.5, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 43.10000000000001, 14.499999999999766, -50.00000000000044, 46.9, 44.7, 42.500000000000014, 31.300000000000004, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.3, 44.300000000000004, 32.50000000000002, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.7, 46.099999999999994], "episode_lengths": [500, 36, 142, 68, 500, 500, 500, 500, 40, 32, 500, 500, 412, 22, 500, 500, 500, 338, 500, 56, 24, 500, 256, 500, 500, 500, 398, 32, 500, 56, 500, 52, 500, 500, 74, 500, 40, 500, 134, 34, 500, 500, 500, 500, 500, 196, 500, 500, 430, 500, 112, 500, 166, 64, 74, 26, 82, 500, 32, 500, 32, 70, 356, 500, 32, 54, 76, 188, 500, 122, 46, 500, 500, 500, 156, 48, 58, 176, 500, 454, 500, 500, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 40, 58, 500, 500, 138, 64, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42090392121291104, "mean_inference_ms": 1.3433869180462619, "mean_action_processing_ms": 0.15687202733942335, "mean_env_wait_ms": 0.09409144179337059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033003807067871094, "StateBufferConnector_ms": 0.004993438720703125, "ViewRequirementAgentConnector_ms": 0.12295103073120117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5666.042480530864, "num_env_steps_trained_throughput_per_sec": 5666.042480530864, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2180.388, "sample_time_ms": 1918.562, "load_time_ms": 11.687, "load_throughput": 1026801.393, "learn_time_ms": 239.039, "learn_throughput": 50201.11, "synch_weights_time_ms": 9.944}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3958, "training_iteration": 87, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-37", "timestamp": 1698246877, "time_this_iter_s": 2.122891426086426, "time_total_s": 212.56413674354553, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.56413674354553, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 58.199999999999996, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.292469707114106e-27, "cur_lr": 0.0003, "total_loss": 6.4485964510175915, "policy_loss": -4.702413247691261e-05, "vf_loss": 6.4486849837832985, "vf_explained_var": 2.1855036417643228e-07, "kl": 0.00012988111332548315, "entropy": 0.41659289764033425, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.464000000000243, "episode_len_mean": 315.12, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 38.90000000000002, -50.00000000000044, 33.500000000000036, 43.7, 42.70000000000001, 47.5, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 43.10000000000001, 14.499999999999766, -50.00000000000044, 46.9, 44.7, 42.500000000000014, 31.300000000000004, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.3, 44.300000000000004, 32.50000000000002, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 47.1, 44.900000000000006, 45.7, -50.00000000000044, 10.899999999999714, 27.49999999999995, 37.50000000000003, -50.00000000000044, 47.1, 46.5, -50.00000000000044], "episode_lengths": [34, 500, 500, 500, 500, 500, 196, 500, 500, 430, 500, 112, 500, 166, 64, 74, 26, 82, 500, 32, 500, 32, 70, 356, 500, 32, 54, 76, 188, 500, 122, 46, 500, 500, 500, 156, 48, 58, 176, 500, 454, 500, 500, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 40, 58, 500, 500, 138, 64, 40, 500, 500, 500, 500, 438, 64, 500, 500, 500, 54, 500, 50, 500, 46, 80, 212, 500, 500, 500, 36, 500, 500, 500, 500, 500, 58, 500, 84, 30, 52, 44, 500, 392, 226, 126, 500, 30, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42092741132899386, "mean_inference_ms": 1.3421816390392451, "mean_action_processing_ms": 0.1568033290387513, "mean_env_wait_ms": 0.09404783590952664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000187873840332, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.11389613151550293}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.464000000000243, "episode_len_mean": 315.12, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 38.90000000000002, -50.00000000000044, 33.500000000000036, 43.7, 42.70000000000001, 47.5, 41.90000000000001, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 43.10000000000001, 14.499999999999766, -50.00000000000044, 46.9, 44.7, 42.500000000000014, 31.300000000000004, -50.00000000000044, 37.90000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 45.3, 44.300000000000004, 32.50000000000002, -50.00000000000044, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 47.1, 44.900000000000006, 45.7, -50.00000000000044, 10.899999999999714, 27.49999999999995, 37.50000000000003, -50.00000000000044, 47.1, 46.5, -50.00000000000044], "episode_lengths": [34, 500, 500, 500, 500, 500, 196, 500, 500, 430, 500, 112, 500, 166, 64, 74, 26, 82, 500, 32, 500, 32, 70, 356, 500, 32, 54, 76, 188, 500, 122, 46, 500, 500, 500, 156, 48, 58, 176, 500, 454, 500, 500, 500, 500, 500, 500, 500, 500, 500, 30, 500, 500, 500, 40, 58, 500, 500, 138, 64, 40, 500, 500, 500, 500, 438, 64, 500, 500, 500, 54, 500, 50, 500, 46, 80, 212, 500, 500, 500, 36, 500, 500, 500, 500, 500, 58, 500, 84, 30, 52, 44, 500, 392, 226, 126, 500, 30, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42092741132899386, "mean_inference_ms": 1.3421816390392451, "mean_action_processing_ms": 0.1568033290387513, "mean_env_wait_ms": 0.09404783590952664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000187873840332, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.11389613151550293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5187.525856903182, "num_env_steps_trained_throughput_per_sec": 5187.525856903182, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2184.499, "sample_time_ms": 1919.49, "load_time_ms": 11.286, "load_throughput": 1063304.989, "learn_time_ms": 243.232, "learn_throughput": 49335.66, "synch_weights_time_ms": 9.436}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3997, "training_iteration": 88, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-39", "timestamp": 1698246879, "time_this_iter_s": 2.318236827850342, "time_total_s": 214.88237357139587, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.88237357139587, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 54.25, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.46234853557053e-28, "cur_lr": 0.0003, "total_loss": 6.914191272523668, "policy_loss": -0.0004392961661020915, "vf_loss": 6.914680745866564, "vf_explained_var": -1.5364752875434028e-06, "kl": 0.0006747360567342437, "entropy": 0.5033384081390169, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1593.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1259999999998076, "episode_len_mean": 269.34, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 47.1, 44.900000000000006, 45.7, -50.00000000000044, 10.899999999999714, 27.49999999999995, 37.50000000000003, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 30.9, 43.900000000000006, -50.00000000000044, 32.90000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, 38.10000000000002, -50.00000000000044, 19.899999999999842, 42.30000000000001, 21.299999999999862, 41.70000000000002, 46.5, 46.3, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 43.7, 28.09999999999996, 46.3, 46.3, 27.899999999999956, 40.500000000000014, 15.899999999999785, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 31.70000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 21.89999999999987, 31.300000000000004, 44.10000000000001, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 42.900000000000006, 43.50000000000001, -50.00000000000044, 43.7, 8.099999999999675], "episode_lengths": [500, 500, 500, 40, 58, 500, 500, 138, 64, 40, 500, 500, 500, 500, 438, 64, 500, 500, 500, 54, 500, 50, 500, 46, 80, 212, 500, 500, 500, 36, 500, 500, 500, 500, 500, 58, 500, 84, 30, 52, 44, 500, 392, 226, 126, 500, 30, 36, 500, 192, 62, 500, 172, 40, 500, 40, 120, 500, 302, 78, 288, 84, 36, 38, 106, 500, 34, 500, 80, 64, 220, 38, 38, 222, 96, 342, 102, 500, 500, 500, 30, 184, 500, 500, 168, 282, 188, 60, 500, 26, 44, 500, 80, 500, 58, 72, 66, 500, 64, 420]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4196762299814929, "mean_inference_ms": 1.3409269950310343, "mean_action_processing_ms": 0.1563918953432995, "mean_env_wait_ms": 0.09379407519586598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028001070022583008, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.08594536781311035}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1259999999998076, "episode_len_mean": 269.34, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 43.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.70000000000002, 47.1, 44.900000000000006, 45.7, -50.00000000000044, 10.899999999999714, 27.49999999999995, 37.50000000000003, -50.00000000000044, 47.1, 46.5, -50.00000000000044, 30.9, 43.900000000000006, -50.00000000000044, 32.90000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, 38.10000000000002, -50.00000000000044, 19.899999999999842, 42.30000000000001, 21.299999999999862, 41.70000000000002, 46.5, 46.3, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 43.7, 28.09999999999996, 46.3, 46.3, 27.899999999999956, 40.500000000000014, 15.899999999999785, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 31.70000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 21.89999999999987, 31.300000000000004, 44.10000000000001, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 42.900000000000006, 43.50000000000001, -50.00000000000044, 43.7, 8.099999999999675], "episode_lengths": [500, 500, 500, 40, 58, 500, 500, 138, 64, 40, 500, 500, 500, 500, 438, 64, 500, 500, 500, 54, 500, 50, 500, 46, 80, 212, 500, 500, 500, 36, 500, 500, 500, 500, 500, 58, 500, 84, 30, 52, 44, 500, 392, 226, 126, 500, 30, 36, 500, 192, 62, 500, 172, 40, 500, 40, 120, 500, 302, 78, 288, 84, 36, 38, 106, 500, 34, 500, 80, 64, 220, 38, 38, 222, 96, 342, 102, 500, 500, 500, 30, 184, 500, 500, 168, 282, 188, 60, 500, 26, 44, 500, 80, 500, 58, 72, 66, 500, 64, 420]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4196762299814929, "mean_inference_ms": 1.3409269950310343, "mean_action_processing_ms": 0.1563918953432995, "mean_env_wait_ms": 0.09379407519586598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028001070022583008, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.08594536781311035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5299.689357607706, "num_env_steps_trained_throughput_per_sec": 5299.689357607706, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2200.077, "sample_time_ms": 1921.947, "load_time_ms": 11.993, "load_throughput": 1000585.422, "learn_time_ms": 256.099, "learn_throughput": 46856.86, "synch_weights_time_ms": 8.881}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4048, "training_iteration": 89, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-41", "timestamp": 1698246881, "time_this_iter_s": 2.269280433654785, "time_total_s": 217.15165400505066, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.15165400505066, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 61.43333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.231174267785265e-28, "cur_lr": 0.0003, "total_loss": 6.279445356792873, "policy_loss": -0.0007029482060008579, "vf_loss": 6.280195474624634, "vf_explained_var": -9.801652696397569e-07, "kl": 0.0009653468099739055, "entropy": 0.47143815126683974, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1611.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.042999999999854, "episode_len_mean": 235.26, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 46.5, -50.00000000000044, 30.9, 43.900000000000006, -50.00000000000044, 32.90000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, 38.10000000000002, -50.00000000000044, 19.899999999999842, 42.30000000000001, 21.299999999999862, 41.70000000000002, 46.5, 46.3, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 43.7, 28.09999999999996, 46.3, 46.3, 27.899999999999956, 40.500000000000014, 15.899999999999785, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 31.70000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 21.89999999999987, 31.300000000000004, 44.10000000000001, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 42.900000000000006, 43.50000000000001, -50.00000000000044, 43.7, 8.099999999999675, -50.00000000000044, 38.50000000000003, 44.7, 34.10000000000004, 37.50000000000003, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 43.30000000000001, 38.10000000000002, 39.90000000000002, 42.30000000000001, 41.90000000000001, 36.50000000000003, 36.900000000000034, 44.10000000000001, 34.50000000000004, 23.29999999999989, -50.00000000000044, 44.10000000000001, 46.3, 37.50000000000003, 41.30000000000001, -50.00000000000044, 29.899999999999984, 43.7, 47.7, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 39.50000000000002, -50.00000000000044], "episode_lengths": [30, 36, 500, 192, 62, 500, 172, 40, 500, 40, 120, 500, 302, 78, 288, 84, 36, 38, 106, 500, 34, 500, 80, 64, 220, 38, 38, 222, 96, 342, 102, 500, 500, 500, 30, 184, 500, 500, 168, 282, 188, 60, 500, 26, 44, 500, 80, 500, 58, 72, 66, 500, 64, 420, 500, 116, 54, 160, 126, 500, 50, 104, 500, 500, 500, 130, 36, 500, 500, 500, 284, 68, 120, 102, 78, 82, 136, 132, 60, 156, 268, 500, 60, 38, 126, 88, 500, 202, 64, 24, 78, 500, 50, 500, 500, 500, 500, 326, 106, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41839111322974437, "mean_inference_ms": 1.3392631899760008, "mean_action_processing_ms": 0.15627748001201897, "mean_env_wait_ms": 0.0938100509090786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026906728744506836, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.0950772762298584}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.042999999999854, "episode_len_mean": 235.26, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 46.5, -50.00000000000044, 30.9, 43.900000000000006, -50.00000000000044, 32.90000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, 38.10000000000002, -50.00000000000044, 19.899999999999842, 42.30000000000001, 21.299999999999862, 41.70000000000002, 46.5, 46.3, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 43.7, 28.09999999999996, 46.3, 46.3, 27.899999999999956, 40.500000000000014, 15.899999999999785, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 31.70000000000001, -50.00000000000044, -50.00000000000044, 33.30000000000003, 21.89999999999987, 31.300000000000004, 44.10000000000001, -50.00000000000044, 47.5, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, 42.900000000000006, 43.50000000000001, -50.00000000000044, 43.7, 8.099999999999675, -50.00000000000044, 38.50000000000003, 44.7, 34.10000000000004, 37.50000000000003, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 43.30000000000001, 38.10000000000002, 39.90000000000002, 42.30000000000001, 41.90000000000001, 36.50000000000003, 36.900000000000034, 44.10000000000001, 34.50000000000004, 23.29999999999989, -50.00000000000044, 44.10000000000001, 46.3, 37.50000000000003, 41.30000000000001, -50.00000000000044, 29.899999999999984, 43.7, 47.7, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 39.50000000000002, -50.00000000000044], "episode_lengths": [30, 36, 500, 192, 62, 500, 172, 40, 500, 40, 120, 500, 302, 78, 288, 84, 36, 38, 106, 500, 34, 500, 80, 64, 220, 38, 38, 222, 96, 342, 102, 500, 500, 500, 30, 184, 500, 500, 168, 282, 188, 60, 500, 26, 44, 500, 80, 500, 58, 72, 66, 500, 64, 420, 500, 116, 54, 160, 126, 500, 50, 104, 500, 500, 500, 130, 36, 500, 500, 500, 284, 68, 120, 102, 78, 82, 136, 132, 60, 156, 268, 500, 60, 38, 126, 88, 500, 202, 64, 24, 78, 500, 50, 500, 500, 500, 500, 326, 106, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41839111322974437, "mean_inference_ms": 1.3392631899760008, "mean_action_processing_ms": 0.15627748001201897, "mean_env_wait_ms": 0.0938100509090786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026906728744506836, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.0950772762298584}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5608.754228715124, "num_env_steps_trained_throughput_per_sec": 5608.754228715124, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2187.722, "sample_time_ms": 1930.399, "load_time_ms": 11.181, "load_throughput": 1073295.333, "learn_time_ms": 236.012, "learn_throughput": 50844.871, "synch_weights_time_ms": 8.974}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4094, "training_iteration": 90, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-44", "timestamp": 1698246884, "time_this_iter_s": 2.1445140838623047, "time_total_s": 219.29616808891296, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.29616808891296, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926325e-28, "cur_lr": 0.0003, "total_loss": 6.897874302334255, "policy_loss": -0.00029960523049036664, "vf_loss": 6.898221996095446, "vf_explained_var": -8.874469333224827e-07, "kl": 0.00027940703291228094, "entropy": 0.4809163709481557, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1629.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.653999999999833, "episode_len_mean": 254.1, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, 44.300000000000004, 42.900000000000006, 43.50000000000001, -50.00000000000044, 43.7, 8.099999999999675, -50.00000000000044, 38.50000000000003, 44.7, 34.10000000000004, 37.50000000000003, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 43.30000000000001, 38.10000000000002, 39.90000000000002, 42.30000000000001, 41.90000000000001, 36.50000000000003, 36.900000000000034, 44.10000000000001, 34.50000000000004, 23.29999999999989, -50.00000000000044, 44.10000000000001, 46.3, 37.50000000000003, 41.30000000000001, -50.00000000000044, 29.899999999999984, 43.7, 47.7, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, 13.699999999999754, 9.699999999999697, 41.70000000000002, -50.00000000000044, 47.5, 34.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 45.7, 43.30000000000001, 24.099999999999902, 41.500000000000014, 29.299999999999976, -50.00000000000044, 26.299999999999933, 46.3, 45.9, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.700000000000024, 46.5, 29.49999999999998, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 500, 58, 72, 66, 500, 64, 420, 500, 116, 54, 160, 126, 500, 50, 104, 500, 500, 500, 130, 36, 500, 500, 500, 284, 68, 120, 102, 78, 82, 136, 132, 60, 156, 268, 500, 60, 38, 126, 88, 500, 202, 64, 24, 78, 500, 50, 500, 500, 500, 500, 326, 106, 500, 500, 500, 500, 48, 500, 500, 34, 500, 500, 38, 364, 404, 84, 500, 26, 158, 60, 500, 50, 50, 500, 44, 68, 260, 86, 208, 500, 238, 38, 42, 78, 116, 500, 500, 142, 500, 114, 36, 206, 130, 500, 40, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41859504269566805, "mean_inference_ms": 1.3386242924522853, "mean_action_processing_ms": 0.15620101762449626, "mean_env_wait_ms": 0.0936754005254734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037903547286987305, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.12849903106689453}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.653999999999833, "episode_len_mean": 254.1, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, 44.300000000000004, 42.900000000000006, 43.50000000000001, -50.00000000000044, 43.7, 8.099999999999675, -50.00000000000044, 38.50000000000003, 44.7, 34.10000000000004, 37.50000000000003, -50.00000000000044, 45.1, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, 43.30000000000001, 38.10000000000002, 39.90000000000002, 42.30000000000001, 41.90000000000001, 36.50000000000003, 36.900000000000034, 44.10000000000001, 34.50000000000004, 23.29999999999989, -50.00000000000044, 44.10000000000001, 46.3, 37.50000000000003, 41.30000000000001, -50.00000000000044, 29.899999999999984, 43.7, 47.7, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, 13.699999999999754, 9.699999999999697, 41.70000000000002, -50.00000000000044, 47.5, 34.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 45.7, 43.30000000000001, 24.099999999999902, 41.500000000000014, 29.299999999999976, -50.00000000000044, 26.299999999999933, 46.3, 45.9, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.700000000000024, 46.5, 29.49999999999998, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 500, 58, 72, 66, 500, 64, 420, 500, 116, 54, 160, 126, 500, 50, 104, 500, 500, 500, 130, 36, 500, 500, 500, 284, 68, 120, 102, 78, 82, 136, 132, 60, 156, 268, 500, 60, 38, 126, 88, 500, 202, 64, 24, 78, 500, 50, 500, 500, 500, 500, 326, 106, 500, 500, 500, 500, 48, 500, 500, 34, 500, 500, 38, 364, 404, 84, 500, 26, 158, 60, 500, 50, 50, 500, 44, 68, 260, 86, 208, 500, 238, 38, 42, 78, 116, 500, 500, 142, 500, 114, 36, 206, 130, 500, 40, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41859504269566805, "mean_inference_ms": 1.3386242924522853, "mean_action_processing_ms": 0.15620101762449626, "mean_env_wait_ms": 0.0936754005254734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037903547286987305, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.12849903106689453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5495.834963940292, "num_env_steps_trained_throughput_per_sec": 5495.834963940292, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2195.146, "sample_time_ms": 1929.537, "load_time_ms": 11.883, "load_throughput": 1009852.369, "learn_time_ms": 243.594, "learn_throughput": 49262.292, "synch_weights_time_ms": 8.876}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4140, "training_iteration": 91, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-46", "timestamp": 1698246886, "time_this_iter_s": 2.1884706020355225, "time_total_s": 221.4846386909485, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.4846386909485, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 0.0003, "total_loss": 7.323247777091132, "policy_loss": -0.0007013206680615743, "vf_loss": 7.323998769124349, "vf_explained_var": -2.284844716389974e-07, "kl": 0.0009157412622238484, "entropy": 0.4962034142679638, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1647.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.322999999999825, "episode_len_mean": 252.42, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, 13.699999999999754, 9.699999999999697, 41.70000000000002, -50.00000000000044, 47.5, 34.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 45.7, 43.30000000000001, 24.099999999999902, 41.500000000000014, 29.299999999999976, -50.00000000000044, 26.299999999999933, 46.3, 45.9, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.700000000000024, 46.5, 29.49999999999998, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 10.499999999999709, 45.7, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 25.899999999999928, 37.10000000000003, 45.7, 43.50000000000001, 45.7, 16.8999999999998, 14.899999999999771, 40.90000000000002, 9.8999999999997, 45.3, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.7, 16.499999999999794, -50.00000000000044, 45.7, 40.90000000000002, 43.30000000000001, -50.00000000000044, 14.699999999999768, 44.10000000000001, 44.300000000000004, 46.3, 46.699999999999996, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 500, 500, 500, 48, 500, 500, 34, 500, 500, 38, 364, 404, 84, 500, 26, 158, 60, 500, 50, 50, 500, 44, 68, 260, 86, 208, 500, 238, 38, 42, 78, 116, 500, 500, 142, 500, 114, 36, 206, 130, 500, 40, 500, 64, 500, 500, 500, 60, 396, 44, 94, 500, 56, 500, 500, 46, 242, 130, 44, 66, 44, 332, 352, 92, 402, 48, 500, 140, 500, 34, 500, 34, 40, 500, 44, 336, 500, 44, 92, 68, 500, 354, 60, 58, 38, 34, 66, 500, 90, 500, 280, 500, 500, 52, 60, 64, 500, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41783795455573364, "mean_inference_ms": 1.3372266530326775, "mean_action_processing_ms": 0.15599303633076667, "mean_env_wait_ms": 0.09337401425707471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700137138366699, "StateBufferConnector_ms": 0.007992029190063477, "ViewRequirementAgentConnector_ms": 0.13340377807617188}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.322999999999825, "episode_len_mean": 252.42, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.3, 13.699999999999754, 9.699999999999697, 41.70000000000002, -50.00000000000044, 47.5, 34.30000000000004, 44.10000000000001, -50.00000000000044, 45.1, 45.1, -50.00000000000044, 45.7, 43.30000000000001, 24.099999999999902, 41.500000000000014, 29.299999999999976, -50.00000000000044, 26.299999999999933, 46.3, 45.9, 42.30000000000001, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.700000000000024, 46.5, 29.49999999999998, 37.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 10.499999999999709, 45.7, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 25.899999999999928, 37.10000000000003, 45.7, 43.50000000000001, 45.7, 16.8999999999998, 14.899999999999771, 40.90000000000002, 9.8999999999997, 45.3, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.7, 16.499999999999794, -50.00000000000044, 45.7, 40.90000000000002, 43.30000000000001, -50.00000000000044, 14.699999999999768, 44.10000000000001, 44.300000000000004, 46.3, 46.699999999999996, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 500, 500, 500, 48, 500, 500, 34, 500, 500, 38, 364, 404, 84, 500, 26, 158, 60, 500, 50, 50, 500, 44, 68, 260, 86, 208, 500, 238, 38, 42, 78, 116, 500, 500, 142, 500, 114, 36, 206, 130, 500, 40, 500, 64, 500, 500, 500, 60, 396, 44, 94, 500, 56, 500, 500, 46, 242, 130, 44, 66, 44, 332, 352, 92, 402, 48, 500, 140, 500, 34, 500, 34, 40, 500, 44, 336, 500, 44, 92, 68, 500, 354, 60, 58, 38, 34, 66, 500, 90, 500, 280, 500, 500, 52, 60, 64, 500, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41783795455573364, "mean_inference_ms": 1.3372266530326775, "mean_action_processing_ms": 0.15599303633076667, "mean_env_wait_ms": 0.09337401425707471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700137138366699, "StateBufferConnector_ms": 0.007992029190063477, "ViewRequirementAgentConnector_ms": 0.13340377807617188}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5052.239530346825, "num_env_steps_trained_throughput_per_sec": 5052.239530346825, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2207.795, "sample_time_ms": 1951.439, "load_time_ms": 11.382, "load_throughput": 1054251.387, "learn_time_ms": 234.841, "learn_throughput": 51098.296, "synch_weights_time_ms": 8.875}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4193, "training_iteration": 92, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-48", "timestamp": 1698246888, "time_this_iter_s": 2.380183458328247, "time_total_s": 223.86482214927673, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.86482214927673, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731581e-29, "cur_lr": 0.0003, "total_loss": 6.1482212278578015, "policy_loss": -8.542918496661716e-05, "vf_loss": 6.148354318406847, "vf_explained_var": -1.8841690487331814e-06, "kl": 0.00033541809356544644, "entropy": 0.47650283243921066, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.878999999999831, "episode_len_mean": 246.86, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 10.499999999999709, 45.7, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 25.899999999999928, 37.10000000000003, 45.7, 43.50000000000001, 45.7, 16.8999999999998, 14.899999999999771, 40.90000000000002, 9.8999999999997, 45.3, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.7, 16.499999999999794, -50.00000000000044, 45.7, 40.90000000000002, 43.30000000000001, -50.00000000000044, 14.699999999999768, 44.10000000000001, 44.300000000000004, 46.3, 46.699999999999996, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.30000000000004, 44.300000000000004, 46.9, 45.7, -50.00000000000044, 46.5, 44.7, 22.099999999999874, -50.00000000000044, 29.69999999999998, 41.90000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 37.70000000000003, 42.900000000000006, 41.90000000000001, 40.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, 35.30000000000004], "episode_lengths": [500, 500, 500, 60, 396, 44, 94, 500, 56, 500, 500, 46, 242, 130, 44, 66, 44, 332, 352, 92, 402, 48, 500, 140, 500, 34, 500, 34, 40, 500, 44, 336, 500, 44, 92, 68, 500, 354, 60, 58, 38, 34, 66, 500, 90, 500, 280, 500, 500, 52, 60, 64, 500, 500, 80, 148, 58, 32, 44, 500, 36, 54, 280, 500, 204, 82, 500, 180, 500, 500, 58, 500, 124, 72, 82, 96, 26, 500, 500, 60, 234, 500, 500, 54, 500, 62, 500, 98, 82, 500, 28, 118, 500, 500, 72, 500, 500, 92, 46, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169508734547954, "mean_inference_ms": 1.3352486236867578, "mean_action_processing_ms": 0.15558062607644157, "mean_env_wait_ms": 0.09326230953516161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031009674072265625, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12404203414916992}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.878999999999831, "episode_len_mean": 246.86, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 10.499999999999709, 45.7, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 25.899999999999928, 37.10000000000003, 45.7, 43.50000000000001, 45.7, 16.8999999999998, 14.899999999999771, 40.90000000000002, 9.8999999999997, 45.3, -50.00000000000044, 36.10000000000004, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 45.7, 16.499999999999794, -50.00000000000044, 45.7, 40.90000000000002, 43.30000000000001, -50.00000000000044, 14.699999999999768, 44.10000000000001, 44.300000000000004, 46.3, 46.699999999999996, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.30000000000004, 44.300000000000004, 46.9, 45.7, -50.00000000000044, 46.5, 44.7, 22.099999999999874, -50.00000000000044, 29.69999999999998, 41.90000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 37.70000000000003, 42.900000000000006, 41.90000000000001, 40.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, 35.30000000000004], "episode_lengths": [500, 500, 500, 60, 396, 44, 94, 500, 56, 500, 500, 46, 242, 130, 44, 66, 44, 332, 352, 92, 402, 48, 500, 140, 500, 34, 500, 34, 40, 500, 44, 336, 500, 44, 92, 68, 500, 354, 60, 58, 38, 34, 66, 500, 90, 500, 280, 500, 500, 52, 60, 64, 500, 500, 80, 148, 58, 32, 44, 500, 36, 54, 280, 500, 204, 82, 500, 180, 500, 500, 58, 500, 124, 72, 82, 96, 26, 500, 500, 60, 234, 500, 500, 54, 500, 62, 500, 98, 82, 500, 28, 118, 500, 500, 72, 500, 500, 92, 46, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169508734547954, "mean_inference_ms": 1.3352486236867578, "mean_action_processing_ms": 0.15558062607644157, "mean_env_wait_ms": 0.09326230953516161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031009674072265625, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.12404203414916992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5507.113002849534, "num_env_steps_trained_throughput_per_sec": 5507.113002849534, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2218.732, "sample_time_ms": 1950.466, "load_time_ms": 12.382, "load_throughput": 969118.387, "learn_time_ms": 245.909, "learn_throughput": 48798.506, "synch_weights_time_ms": 8.775}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4238, "training_iteration": 93, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-50", "timestamp": 1698246890, "time_this_iter_s": 2.1839983463287354, "time_total_s": 226.04882049560547, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 226.04882049560547, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 52.29999999999999, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0194839173657906e-29, "cur_lr": 0.0003, "total_loss": 7.274759584003025, "policy_loss": 9.678656028376686e-05, "vf_loss": 7.274711714850532, "vf_explained_var": -1.1324882507324219e-06, "kl": 4.621520439387597e-05, "entropy": 0.48847390711307526, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1683.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.036999999999815, "episode_len_mean": 265.24, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.30000000000004, 44.300000000000004, 46.9, 45.7, -50.00000000000044, 46.5, 44.7, 22.099999999999874, -50.00000000000044, 29.69999999999998, 41.90000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 37.70000000000003, 42.900000000000006, 41.90000000000001, 40.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, 35.30000000000004, -50.00000000000044, 7.899999999999672, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 2.299999999999592, -50.00000000000044, 47.3, 44.7, 46.3, 14.299999999999763, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, 44.300000000000004, 45.7, 40.30000000000002, 15.699999999999783, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.299999999999748, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 43.30000000000001, 44.900000000000006, 33.10000000000003, -50.00000000000044, 28.89999999999997, 33.10000000000003, 45.9], "episode_lengths": [500, 500, 52, 60, 64, 500, 500, 80, 148, 58, 32, 44, 500, 36, 54, 280, 500, 204, 82, 500, 180, 500, 500, 58, 500, 124, 72, 82, 96, 26, 500, 500, 60, 234, 500, 500, 54, 500, 62, 500, 98, 82, 500, 28, 118, 500, 500, 72, 500, 500, 92, 46, 148, 500, 422, 500, 58, 500, 500, 500, 222, 500, 478, 500, 28, 54, 38, 358, 500, 500, 158, 500, 500, 30, 60, 58, 44, 98, 344, 500, 500, 144, 368, 500, 76, 64, 500, 88, 36, 500, 110, 48, 500, 68, 52, 170, 500, 212, 170, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4176786254889705, "mean_inference_ms": 1.3346116356441127, "mean_action_processing_ms": 0.15545870634717335, "mean_env_wait_ms": 0.09324642991002065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030007600784301758, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.1336681842803955}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.036999999999815, "episode_len_mean": 265.24, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.900000000000006, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.30000000000004, 44.300000000000004, 46.9, 45.7, -50.00000000000044, 46.5, 44.7, 22.099999999999874, -50.00000000000044, 29.69999999999998, 41.90000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 37.70000000000003, 42.900000000000006, 41.90000000000001, 40.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, 35.30000000000004, -50.00000000000044, 7.899999999999672, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 2.299999999999592, -50.00000000000044, 47.3, 44.7, 46.3, 14.299999999999763, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, 44.300000000000004, 45.7, 40.30000000000002, 15.699999999999783, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.299999999999748, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 43.30000000000001, 44.900000000000006, 33.10000000000003, -50.00000000000044, 28.89999999999997, 33.10000000000003, 45.9], "episode_lengths": [500, 500, 52, 60, 64, 500, 500, 80, 148, 58, 32, 44, 500, 36, 54, 280, 500, 204, 82, 500, 180, 500, 500, 58, 500, 124, 72, 82, 96, 26, 500, 500, 60, 234, 500, 500, 54, 500, 62, 500, 98, 82, 500, 28, 118, 500, 500, 72, 500, 500, 92, 46, 148, 500, 422, 500, 58, 500, 500, 500, 222, 500, 478, 500, 28, 54, 38, 358, 500, 500, 158, 500, 500, 30, 60, 58, 44, 98, 344, 500, 500, 144, 368, 500, 76, 64, 500, 88, 36, 500, 110, 48, 500, 68, 52, 170, 500, 212, 170, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4176786254889705, "mean_inference_ms": 1.3346116356441127, "mean_action_processing_ms": 0.15545870634717335, "mean_env_wait_ms": 0.09324642991002065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030007600784301758, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.1336681842803955}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5698.878751464444, "num_env_steps_trained_throughput_per_sec": 5698.878751464444, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2205.154, "sample_time_ms": 1952.708, "load_time_ms": 11.78, "load_throughput": 1018669.56, "learn_time_ms": 230.788, "learn_throughput": 51995.783, "synch_weights_time_ms": 8.778}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4285, "training_iteration": 94, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-52", "timestamp": 1698246892, "time_this_iter_s": 2.11067533493042, "time_total_s": 228.1594958305359, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.1594958305359, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 58.4, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 0.0003, "total_loss": 6.259669886695014, "policy_loss": -0.0006834934982988569, "vf_loss": 6.260403474171956, "vf_explained_var": -1.4172659979926216e-06, "kl": 0.0008352904298162637, "entropy": 0.5015677627589967, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1701.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9239999999998094, "episode_len_mean": 271.36, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, 35.30000000000004, -50.00000000000044, 7.899999999999672, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 2.299999999999592, -50.00000000000044, 47.3, 44.7, 46.3, 14.299999999999763, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, 44.300000000000004, 45.7, 40.30000000000002, 15.699999999999783, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.299999999999748, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 43.30000000000001, 44.900000000000006, 33.10000000000003, -50.00000000000044, 28.89999999999997, 33.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 43.50000000000001, 30.29999999999999, 29.299999999999976, 27.699999999999953, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 42.900000000000006, 46.3, -50.00000000000044, 45.1, 37.70000000000003, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.3, 44.10000000000001, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 30.9, 45.3, 43.10000000000001], "episode_lengths": [500, 28, 118, 500, 500, 72, 500, 500, 92, 46, 148, 500, 422, 500, 58, 500, 500, 500, 222, 500, 478, 500, 28, 54, 38, 358, 500, 500, 158, 500, 500, 30, 60, 58, 44, 98, 344, 500, 500, 144, 368, 500, 76, 64, 500, 88, 36, 500, 110, 48, 500, 68, 52, 170, 500, 212, 170, 42, 500, 500, 500, 60, 118, 42, 500, 500, 86, 36, 66, 198, 208, 224, 500, 66, 500, 30, 72, 38, 500, 50, 124, 396, 500, 500, 500, 500, 500, 500, 500, 120, 48, 60, 48, 80, 500, 500, 54, 192, 48, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41771285446766016, "mean_inference_ms": 1.3327905675033938, "mean_action_processing_ms": 0.15566729368464605, "mean_env_wait_ms": 0.0931708592004121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029047489166259766, "StateBufferConnector_ms": 0.005911588668823242, "ViewRequirementAgentConnector_ms": 0.12770557403564453}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9239999999998094, "episode_len_mean": 271.36, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.5, 35.30000000000004, -50.00000000000044, 7.899999999999672, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 2.299999999999592, -50.00000000000044, 47.3, 44.7, 46.3, 14.299999999999763, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, 44.300000000000004, 45.7, 40.30000000000002, 15.699999999999783, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.299999999999748, -50.00000000000044, 42.500000000000014, 43.7, -50.00000000000044, 41.30000000000001, 46.5, -50.00000000000044, 39.10000000000002, 45.3, -50.00000000000044, 43.30000000000001, 44.900000000000006, 33.10000000000003, -50.00000000000044, 28.89999999999997, 33.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 43.50000000000001, 30.29999999999999, 29.299999999999976, 27.699999999999953, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 42.900000000000006, 46.3, -50.00000000000044, 45.1, 37.70000000000003, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.3, 44.10000000000001, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 30.9, 45.3, 43.10000000000001], "episode_lengths": [500, 28, 118, 500, 500, 72, 500, 500, 92, 46, 148, 500, 422, 500, 58, 500, 500, 500, 222, 500, 478, 500, 28, 54, 38, 358, 500, 500, 158, 500, 500, 30, 60, 58, 44, 98, 344, 500, 500, 144, 368, 500, 76, 64, 500, 88, 36, 500, 110, 48, 500, 68, 52, 170, 500, 212, 170, 42, 500, 500, 500, 60, 118, 42, 500, 500, 86, 36, 66, 198, 208, 224, 500, 66, 500, 30, 72, 38, 500, 50, 124, 396, 500, 500, 500, 500, 500, 500, 500, 120, 48, 60, 48, 80, 500, 500, 54, 192, 48, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41771285446766016, "mean_inference_ms": 1.3327905675033938, "mean_action_processing_ms": 0.15566729368464605, "mean_env_wait_ms": 0.0931708592004121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029047489166259766, "StateBufferConnector_ms": 0.005911588668823242, "ViewRequirementAgentConnector_ms": 0.12770557403564453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.924353246206, "num_env_steps_trained_throughput_per_sec": 5314.924353246206, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2217.633, "sample_time_ms": 1949.992, "load_time_ms": 12.377, "load_throughput": 969547.758, "learn_time_ms": 245.183, "learn_throughput": 48942.974, "synch_weights_time_ms": 8.781}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4327, "training_iteration": 95, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-55", "timestamp": 1698246895, "time_this_iter_s": 2.2617921829223633, "time_total_s": 230.42128801345825, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.42128801345825, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 56.27499999999999, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.0487097934144765e-30, "cur_lr": 0.0003, "total_loss": 6.370409409205119, "policy_loss": -0.0003153003425621945, "vf_loss": 6.3707736068301735, "vf_explained_var": -1.834498511420356e-06, "kl": 0.000522022085685118, "entropy": 0.488144694103135, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1719.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.084999999999837, "episode_len_mean": 244.8, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 44.900000000000006, 33.10000000000003, -50.00000000000044, 28.89999999999997, 33.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 43.50000000000001, 30.29999999999999, 29.299999999999976, 27.699999999999953, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 42.900000000000006, 46.3, -50.00000000000044, 45.1, 37.70000000000003, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.3, 44.10000000000001, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 30.9, 45.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 46.699999999999996, -50.00000000000044, 40.90000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.7, 45.3, 43.7, 46.099999999999994, -50.00000000000044, 46.3, 35.70000000000003, 43.7, 41.90000000000001, 44.5, 43.7, 36.900000000000034, 45.7, 39.50000000000002, 32.100000000000016, 44.10000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.5, 17.499999999999808, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.29999999999996, 45.9, -50.00000000000044], "episode_lengths": [500, 68, 52, 170, 500, 212, 170, 42, 500, 500, 500, 60, 118, 42, 500, 500, 86, 36, 66, 198, 208, 224, 500, 66, 500, 30, 72, 38, 500, 50, 124, 396, 500, 500, 500, 500, 500, 500, 500, 120, 48, 60, 48, 80, 500, 500, 54, 192, 48, 70, 500, 500, 500, 456, 34, 500, 92, 392, 500, 500, 50, 48, 500, 92, 500, 500, 36, 44, 48, 64, 40, 500, 38, 144, 64, 82, 56, 64, 132, 44, 106, 180, 60, 500, 70, 188, 68, 500, 48, 62, 500, 164, 46, 326, 500, 134, 500, 218, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169411701532586, "mean_inference_ms": 1.330978206276651, "mean_action_processing_ms": 0.1556549083991451, "mean_env_wait_ms": 0.09305974812813403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025036334991455078, "StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.12469863891601562}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.084999999999837, "episode_len_mean": 244.8, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 44.900000000000006, 33.10000000000003, -50.00000000000044, 28.89999999999997, 33.10000000000003, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.300000000000026, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.5, 43.50000000000001, 30.29999999999999, 29.299999999999976, 27.699999999999953, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.1, 42.900000000000006, 46.3, -50.00000000000044, 45.1, 37.70000000000003, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 45.3, 44.10000000000001, 45.3, 42.10000000000001, -50.00000000000044, -50.00000000000044, 44.7, 30.9, 45.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 46.699999999999996, -50.00000000000044, 40.90000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.7, 45.3, 43.7, 46.099999999999994, -50.00000000000044, 46.3, 35.70000000000003, 43.7, 41.90000000000001, 44.5, 43.7, 36.900000000000034, 45.7, 39.50000000000002, 32.100000000000016, 44.10000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.5, 17.499999999999808, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.29999999999996, 45.9, -50.00000000000044], "episode_lengths": [500, 68, 52, 170, 500, 212, 170, 42, 500, 500, 500, 60, 118, 42, 500, 500, 86, 36, 66, 198, 208, 224, 500, 66, 500, 30, 72, 38, 500, 50, 124, 396, 500, 500, 500, 500, 500, 500, 500, 120, 48, 60, 48, 80, 500, 500, 54, 192, 48, 70, 500, 500, 500, 456, 34, 500, 92, 392, 500, 500, 50, 48, 500, 92, 500, 500, 36, 44, 48, 64, 40, 500, 38, 144, 64, 82, 56, 64, 132, 44, 106, 180, 60, 500, 70, 188, 68, 500, 48, 62, 500, 164, 46, 326, 500, 134, 500, 218, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169411701532586, "mean_inference_ms": 1.330978206276651, "mean_action_processing_ms": 0.1556549083991451, "mean_env_wait_ms": 0.09305974812813403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025036334991455078, "StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.12469863891601562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5627.619851911119, "num_env_steps_trained_throughput_per_sec": 5627.619851911119, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2206.838, "sample_time_ms": 1952.787, "load_time_ms": 11.701, "load_throughput": 1025529.364, "learn_time_ms": 232.27, "learn_throughput": 51663.958, "synch_weights_time_ms": 8.881}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4377, "training_iteration": 96, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-57", "timestamp": 1698246897, "time_this_iter_s": 2.1373393535614014, "time_total_s": 232.55862736701965, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.55862736701965, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 63.199999999999996, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072383e-30, "cur_lr": 0.0003, "total_loss": 6.7039175563388405, "policy_loss": -4.334292478031582e-05, "vf_loss": 6.704007440143162, "vf_explained_var": -1.2119611104329426e-06, "kl": 0.00016924241779431922, "entropy": 0.46504125495751697, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1737.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.86599999999984, "episode_len_mean": 242.0, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 46.699999999999996, -50.00000000000044, 40.90000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.7, 45.3, 43.7, 46.099999999999994, -50.00000000000044, 46.3, 35.70000000000003, 43.7, 41.90000000000001, 44.5, 43.7, 36.900000000000034, 45.7, 39.50000000000002, 32.100000000000016, 44.10000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.5, 17.499999999999808, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.29999999999996, 45.9, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.30000000000003, 22.49999999999988, -50.00000000000044, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.500000000000036, 42.10000000000001, 12.299999999999734, 46.699999999999996, 36.900000000000034, 43.900000000000006, 39.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 23.8999999999999, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 45.7, 45.5, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 18.499999999999822, -50.00000000000044, 38.300000000000026], "episode_lengths": [48, 70, 500, 500, 500, 456, 34, 500, 92, 392, 500, 500, 50, 48, 500, 92, 500, 500, 36, 44, 48, 64, 40, 500, 38, 144, 64, 82, 56, 64, 132, 44, 106, 180, 60, 500, 70, 188, 68, 500, 48, 62, 500, 164, 46, 326, 500, 134, 500, 218, 42, 500, 500, 166, 168, 276, 500, 60, 68, 500, 500, 52, 110, 500, 500, 500, 500, 34, 500, 166, 80, 378, 34, 132, 62, 106, 500, 82, 500, 262, 172, 50, 500, 500, 34, 46, 44, 46, 54, 500, 70, 500, 88, 46, 500, 500, 30, 316, 500, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41656923236249144, "mean_inference_ms": 1.3305919267441135, "mean_action_processing_ms": 0.15542495037590337, "mean_env_wait_ms": 0.09296734444129517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995450973510742, "StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.12492203712463379}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.86599999999984, "episode_len_mean": 242.0, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 46.699999999999996, -50.00000000000044, 40.90000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 45.1, 45.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 45.7, 45.3, 43.7, 46.099999999999994, -50.00000000000044, 46.3, 35.70000000000003, 43.7, 41.90000000000001, 44.5, 43.7, 36.900000000000034, 45.7, 39.50000000000002, 32.100000000000016, 44.10000000000001, -50.00000000000044, 43.10000000000001, 31.300000000000004, 43.30000000000001, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 33.70000000000004, 45.5, 17.499999999999808, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.29999999999996, 45.9, -50.00000000000044, -50.00000000000044, 33.500000000000036, 33.30000000000003, 22.49999999999988, -50.00000000000044, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.500000000000036, 42.10000000000001, 12.299999999999734, 46.699999999999996, 36.900000000000034, 43.900000000000006, 39.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 23.8999999999999, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 45.7, 45.5, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 18.499999999999822, -50.00000000000044, 38.300000000000026], "episode_lengths": [48, 70, 500, 500, 500, 456, 34, 500, 92, 392, 500, 500, 50, 48, 500, 92, 500, 500, 36, 44, 48, 64, 40, 500, 38, 144, 64, 82, 56, 64, 132, 44, 106, 180, 60, 500, 70, 188, 68, 500, 48, 62, 500, 164, 46, 326, 500, 134, 500, 218, 42, 500, 500, 166, 168, 276, 500, 60, 68, 500, 500, 52, 110, 500, 500, 500, 500, 34, 500, 166, 80, 378, 34, 132, 62, 106, 500, 82, 500, 262, 172, 50, 500, 500, 34, 46, 44, 46, 54, 500, 70, 500, 88, 46, 500, 500, 30, 316, 500, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41656923236249144, "mean_inference_ms": 1.3305919267441135, "mean_action_processing_ms": 0.15542495037590337, "mean_env_wait_ms": 0.09296734444129517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995450973510742, "StateBufferConnector_ms": 0.0049114227294921875, "ViewRequirementAgentConnector_ms": 0.12492203712463379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5517.438063222311, "num_env_steps_trained_throughput_per_sec": 5517.438063222311, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2212.543, "sample_time_ms": 1948.476, "load_time_ms": 12.501, "load_throughput": 959912.117, "learn_time_ms": 241.418, "learn_throughput": 49706.303, "synch_weights_time_ms": 8.849}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4425, "training_iteration": 97, "trial_id": "9f288_00008", "date": "2023-10-25_16-14-59", "timestamp": 1698246899, "time_this_iter_s": 2.1804568767547607, "time_total_s": 234.7390842437744, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.7390842437744, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 58.699999999999996, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536191e-30, "cur_lr": 0.0003, "total_loss": 6.8729663954840765, "policy_loss": -1.4697046329577764e-05, "vf_loss": 6.873029152552287, "vf_explained_var": -1.2583202785915798e-06, "kl": 4.075824627964359e-05, "entropy": 0.4787492056687673, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.635999999999826, "episode_len_mean": 254.26, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.500000000000036, 33.30000000000003, 22.49999999999988, -50.00000000000044, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.500000000000036, 42.10000000000001, 12.299999999999734, 46.699999999999996, 36.900000000000034, 43.900000000000006, 39.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 23.8999999999999, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 45.7, 45.5, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 18.499999999999822, -50.00000000000044, 38.300000000000026, 11.29999999999972, 47.1, -50.00000000000044, 22.099999999999874, 20.699999999999854, 37.50000000000003, 46.3, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 31.70000000000001, 41.100000000000016, 46.5, 45.3, 35.900000000000034, 33.30000000000003, 45.3, 45.1, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 166, 168, 276, 500, 60, 68, 500, 500, 52, 110, 500, 500, 500, 500, 34, 500, 166, 80, 378, 34, 132, 62, 106, 500, 82, 500, 262, 172, 50, 500, 500, 34, 46, 44, 46, 54, 500, 70, 500, 88, 46, 500, 500, 30, 316, 500, 118, 388, 30, 500, 280, 294, 126, 38, 34, 500, 40, 500, 92, 500, 72, 64, 84, 500, 500, 62, 500, 50, 500, 74, 68, 114, 500, 500, 500, 48, 500, 500, 500, 500, 26, 500, 38, 500, 500, 38, 184, 90, 36, 48, 142, 168, 48, 50, 500, 128, 32, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158921834957667, "mean_inference_ms": 1.3296668833030583, "mean_action_processing_ms": 0.15490084706127594, "mean_env_wait_ms": 0.09281087957044701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021003007888793945, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.1186988353729248}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.635999999999826, "episode_len_mean": 254.26, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.500000000000036, 33.30000000000003, 22.49999999999988, -50.00000000000044, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 33.500000000000036, 42.10000000000001, 12.299999999999734, 46.699999999999996, 36.900000000000034, 43.900000000000006, 39.50000000000002, -50.00000000000044, 41.90000000000001, -50.00000000000044, 23.8999999999999, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.5, 45.7, 45.5, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 18.499999999999822, -50.00000000000044, 38.300000000000026, 11.29999999999972, 47.1, -50.00000000000044, 22.099999999999874, 20.699999999999854, 37.50000000000003, 46.3, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 31.70000000000001, 41.100000000000016, 46.5, 45.3, 35.900000000000034, 33.30000000000003, 45.3, 45.1, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 166, 168, 276, 500, 60, 68, 500, 500, 52, 110, 500, 500, 500, 500, 34, 500, 166, 80, 378, 34, 132, 62, 106, 500, 82, 500, 262, 172, 50, 500, 500, 34, 46, 44, 46, 54, 500, 70, 500, 88, 46, 500, 500, 30, 316, 500, 118, 388, 30, 500, 280, 294, 126, 38, 34, 500, 40, 500, 92, 500, 72, 64, 84, 500, 500, 62, 500, 50, 500, 74, 68, 114, 500, 500, 500, 48, 500, 500, 500, 500, 26, 500, 38, 500, 500, 38, 184, 90, 36, 48, 142, 168, 48, 50, 500, 128, 32, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4158921834957667, "mean_inference_ms": 1.3296668833030583, "mean_action_processing_ms": 0.15490084706127594, "mean_env_wait_ms": 0.09281087957044701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021003007888793945, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.1186988353729248}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5727.084730542261, "num_env_steps_trained_throughput_per_sec": 5727.084730542261, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2190.749, "sample_time_ms": 1942.954, "load_time_ms": 12.2, "load_throughput": 983637.483, "learn_time_ms": 225.373, "learn_throughput": 53245.159, "synch_weights_time_ms": 8.925}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4477, "training_iteration": 98, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-01", "timestamp": 1698246901, "time_this_iter_s": 2.100308656692505, "time_total_s": 236.83939290046692, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.83939290046692, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 58.86666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.310887241768096e-31, "cur_lr": 0.0003, "total_loss": 6.047809415393406, "policy_loss": -0.00025524933718972735, "vf_loss": 6.048108047909206, "vf_explained_var": -1.1258655124240452e-06, "kl": 0.0005309350707308388, "entropy": 0.432542825738589, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1773.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.84499999999982, "episode_len_mean": 257.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 18.499999999999822, -50.00000000000044, 38.300000000000026, 11.29999999999972, 47.1, -50.00000000000044, 22.099999999999874, 20.699999999999854, 37.50000000000003, 46.3, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 31.70000000000001, 41.100000000000016, 46.5, 45.3, 35.900000000000034, 33.30000000000003, 45.3, 45.1, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, 41.100000000000016, 40.90000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 46.3, 46.699999999999996, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 22.699999999999882, 41.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 44.300000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 39.50000000000002, 25.899999999999928, 46.5, -50.00000000000044, 27.899999999999956, 46.9, 40.30000000000002, -50.00000000000044, 41.500000000000014, 43.30000000000001], "episode_lengths": [88, 46, 500, 500, 30, 316, 500, 118, 388, 30, 500, 280, 294, 126, 38, 34, 500, 40, 500, 92, 500, 72, 64, 84, 500, 500, 62, 500, 50, 500, 74, 68, 114, 500, 500, 500, 48, 500, 500, 500, 500, 26, 500, 38, 500, 500, 38, 184, 90, 36, 48, 142, 168, 48, 50, 500, 128, 32, 500, 90, 92, 204, 500, 500, 500, 36, 60, 38, 34, 500, 330, 500, 500, 274, 84, 500, 132, 500, 500, 80, 500, 500, 44, 58, 500, 58, 100, 500, 500, 28, 106, 242, 36, 500, 222, 32, 98, 500, 86, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41566409940910565, "mean_inference_ms": 1.3281627996580105, "mean_action_processing_ms": 0.1547695735419613, "mean_env_wait_ms": 0.09271929304529786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017012357711791992, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.11045694351196289}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.84499999999982, "episode_len_mean": 257.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 45.5, -50.00000000000044, -50.00000000000044, 47.1, 18.499999999999822, -50.00000000000044, 38.300000000000026, 11.29999999999972, 47.1, -50.00000000000044, 22.099999999999874, 20.699999999999854, 37.50000000000003, 46.3, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.900000000000006, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 31.70000000000001, 41.100000000000016, 46.5, 45.3, 35.900000000000034, 33.30000000000003, 45.3, 45.1, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, 41.100000000000016, 40.90000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 46.3, 46.699999999999996, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 22.699999999999882, 41.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 44.300000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 39.50000000000002, 25.899999999999928, 46.5, -50.00000000000044, 27.899999999999956, 46.9, 40.30000000000002, -50.00000000000044, 41.500000000000014, 43.30000000000001], "episode_lengths": [88, 46, 500, 500, 30, 316, 500, 118, 388, 30, 500, 280, 294, 126, 38, 34, 500, 40, 500, 92, 500, 72, 64, 84, 500, 500, 62, 500, 50, 500, 74, 68, 114, 500, 500, 500, 48, 500, 500, 500, 500, 26, 500, 38, 500, 500, 38, 184, 90, 36, 48, 142, 168, 48, 50, 500, 128, 32, 500, 90, 92, 204, 500, 500, 500, 36, 60, 38, 34, 500, 330, 500, 500, 274, 84, 500, 132, 500, 500, 80, 500, 500, 44, 58, 500, 58, 100, 500, 500, 28, 106, 242, 36, 500, 222, 32, 98, 500, 86, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41566409940910565, "mean_inference_ms": 1.3281627996580105, "mean_action_processing_ms": 0.1547695735419613, "mean_env_wait_ms": 0.09271929304529786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017012357711791992, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.11045694351196289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4670.187549258983, "num_env_steps_trained_throughput_per_sec": 4670.187549258983, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2221.27, "sample_time_ms": 1938.157, "load_time_ms": 12.093, "load_throughput": 992325.609, "learn_time_ms": 230.5, "learn_throughput": 52060.838, "synch_weights_time_ms": 39.222}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4517, "training_iteration": 99, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-04", "timestamp": 1698246904, "time_this_iter_s": 2.574488878250122, "time_total_s": 239.41388177871704, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.41388177871704, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.155443620884048e-31, "cur_lr": 0.0003, "total_loss": 6.432666063308716, "policy_loss": 7.369203699959649e-05, "vf_loss": 6.4326429102155895, "vf_explained_var": -1.27818849351671e-06, "kl": 0.00019057157587414823, "entropy": 0.5062928977939818, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1791.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.757999999999846, "episode_len_mean": 243.08, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 31.70000000000001, 41.100000000000016, 46.5, 45.3, 35.900000000000034, 33.30000000000003, 45.3, 45.1, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, 41.100000000000016, 40.90000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 46.3, 46.699999999999996, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 22.699999999999882, 41.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 44.300000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 39.50000000000002, 25.899999999999928, 46.5, -50.00000000000044, 27.899999999999956, 46.9, 40.30000000000002, -50.00000000000044, 41.500000000000014, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 44.5, 46.3, 38.300000000000026, 40.10000000000002, -50.00000000000044, 32.30000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.899999999999956, 35.10000000000004, -50.00000000000044, 45.1, 46.099999999999994, 44.5, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.90000000000002, 42.900000000000006, 41.100000000000016, -50.00000000000044, 35.10000000000004, 30.099999999999987, 20.299999999999848, 38.300000000000026, 42.70000000000001, 45.5, 32.50000000000002, 9.299999999999692, -50.00000000000044], "episode_lengths": [38, 184, 90, 36, 48, 142, 168, 48, 50, 500, 128, 32, 500, 90, 92, 204, 500, 500, 500, 36, 60, 38, 34, 500, 330, 500, 500, 274, 84, 500, 132, 500, 500, 80, 500, 500, 44, 58, 500, 58, 100, 500, 500, 28, 106, 242, 36, 500, 222, 32, 98, 500, 86, 68, 500, 62, 500, 500, 500, 500, 220, 56, 38, 118, 100, 500, 178, 100, 500, 500, 108, 130, 500, 500, 500, 58, 222, 150, 500, 50, 40, 56, 134, 74, 500, 500, 94, 92, 72, 90, 500, 150, 200, 298, 118, 74, 46, 176, 408, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155156702768943, "mean_inference_ms": 1.327099906183808, "mean_action_processing_ms": 0.154446724451786, "mean_env_wait_ms": 0.0925546665957987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015006780624389648, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.10622882843017578}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.757999999999846, "episode_len_mean": 243.08, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 31.70000000000001, 41.100000000000016, 46.5, 45.3, 35.900000000000034, 33.30000000000003, 45.3, 45.1, -50.00000000000044, 37.300000000000026, 46.9, -50.00000000000044, 41.100000000000016, 40.90000000000002, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 46.3, 46.699999999999996, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 22.699999999999882, 41.70000000000002, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.7, 44.300000000000004, -50.00000000000044, 44.300000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 39.50000000000002, 25.899999999999928, 46.5, -50.00000000000044, 27.899999999999956, 46.9, 40.30000000000002, -50.00000000000044, 41.500000000000014, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 44.5, 46.3, 38.300000000000026, 40.10000000000002, -50.00000000000044, 32.30000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.899999999999956, 35.10000000000004, -50.00000000000044, 45.1, 46.099999999999994, 44.5, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.90000000000002, 42.900000000000006, 41.100000000000016, -50.00000000000044, 35.10000000000004, 30.099999999999987, 20.299999999999848, 38.300000000000026, 42.70000000000001, 45.5, 32.50000000000002, 9.299999999999692, -50.00000000000044], "episode_lengths": [38, 184, 90, 36, 48, 142, 168, 48, 50, 500, 128, 32, 500, 90, 92, 204, 500, 500, 500, 36, 60, 38, 34, 500, 330, 500, 500, 274, 84, 500, 132, 500, 500, 80, 500, 500, 44, 58, 500, 58, 100, 500, 500, 28, 106, 242, 36, 500, 222, 32, 98, 500, 86, 68, 500, 62, 500, 500, 500, 500, 220, 56, 38, 118, 100, 500, 178, 100, 500, 500, 108, 130, 500, 500, 500, 58, 222, 150, 500, 50, 40, 56, 134, 74, 500, 500, 94, 92, 72, 90, 500, 150, 200, 298, 118, 74, 46, 176, 408, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155156702768943, "mean_inference_ms": 1.327099906183808, "mean_action_processing_ms": 0.154446724451786, "mean_env_wait_ms": 0.0925546665957987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015006780624389648, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.10622882843017578}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5899.960437682316, "num_env_steps_trained_throughput_per_sec": 5899.960437682316, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2210.71, "sample_time_ms": 1927.398, "load_time_ms": 11.905, "load_throughput": 1007943.286, "learn_time_ms": 230.579, "learn_throughput": 52042.977, "synch_weights_time_ms": 39.529}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4563, "training_iteration": 100, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-06", "timestamp": 1698246906, "time_this_iter_s": 2.039911985397339, "time_total_s": 241.45379376411438, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.45379376411438, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 48.43333333333334, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.577721810442024e-31, "cur_lr": 0.0003, "total_loss": 6.625227928161621, "policy_loss": -4.6682440572314794e-05, "vf_loss": 6.625324116812812, "vf_explained_var": -6.324715084499783e-07, "kl": 8.668348971122934e-05, "entropy": 0.4947216808795929, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1809.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1039999999998076, "episode_len_mean": 279.54, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 39.50000000000002, 25.899999999999928, 46.5, -50.00000000000044, 27.899999999999956, 46.9, 40.30000000000002, -50.00000000000044, 41.500000000000014, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 44.5, 46.3, 38.300000000000026, 40.10000000000002, -50.00000000000044, 32.30000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.899999999999956, 35.10000000000004, -50.00000000000044, 45.1, 46.099999999999994, 44.5, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.90000000000002, 42.900000000000006, 41.100000000000016, -50.00000000000044, 35.10000000000004, 30.099999999999987, 20.299999999999848, 38.300000000000026, 42.70000000000001, 45.5, 32.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 38.90000000000002, -50.00000000000044, 46.9, 29.899999999999984, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 28.89999999999997], "episode_lengths": [100, 500, 500, 28, 106, 242, 36, 500, 222, 32, 98, 500, 86, 68, 500, 62, 500, 500, 500, 500, 220, 56, 38, 118, 100, 500, 178, 100, 500, 500, 108, 130, 500, 500, 500, 58, 222, 150, 500, 50, 40, 56, 134, 74, 500, 500, 94, 92, 72, 90, 500, 150, 200, 298, 118, 74, 46, 176, 408, 500, 500, 68, 500, 500, 500, 500, 500, 242, 112, 500, 32, 202, 48, 52, 500, 500, 328, 56, 500, 500, 36, 42, 266, 500, 500, 500, 54, 500, 288, 500, 500, 26, 50, 500, 500, 500, 110, 500, 500, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41478480077675867, "mean_inference_ms": 1.325523007215202, "mean_action_processing_ms": 0.15458225061954745, "mean_env_wait_ms": 0.09251011109376282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017510652542114258, "StateBufferConnector_ms": 0.0030345916748046875, "ViewRequirementAgentConnector_ms": 0.11220431327819824}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1039999999998076, "episode_len_mean": 279.54, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 39.50000000000002, 25.899999999999928, 46.5, -50.00000000000044, 27.899999999999956, 46.9, 40.30000000000002, -50.00000000000044, 41.500000000000014, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 44.5, 46.3, 38.300000000000026, 40.10000000000002, -50.00000000000044, 32.30000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 27.899999999999956, 35.10000000000004, -50.00000000000044, 45.1, 46.099999999999994, 44.5, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.90000000000002, 42.900000000000006, 41.100000000000016, -50.00000000000044, 35.10000000000004, 30.099999999999987, 20.299999999999848, 38.300000000000026, 42.70000000000001, 45.5, 32.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 38.90000000000002, -50.00000000000044, 46.9, 29.899999999999984, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 28.89999999999997], "episode_lengths": [100, 500, 500, 28, 106, 242, 36, 500, 222, 32, 98, 500, 86, 68, 500, 62, 500, 500, 500, 500, 220, 56, 38, 118, 100, 500, 178, 100, 500, 500, 108, 130, 500, 500, 500, 58, 222, 150, 500, 50, 40, 56, 134, 74, 500, 500, 94, 92, 72, 90, 500, 150, 200, 298, 118, 74, 46, 176, 408, 500, 500, 68, 500, 500, 500, 500, 500, 242, 112, 500, 32, 202, 48, 52, 500, 500, 328, 56, 500, 500, 36, 42, 266, 500, 500, 500, 54, 500, 288, 500, 500, 26, 50, 500, 500, 500, 110, 500, 500, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41478480077675867, "mean_inference_ms": 1.325523007215202, "mean_action_processing_ms": 0.15458225061954745, "mean_env_wait_ms": 0.09251011109376282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017510652542114258, "StateBufferConnector_ms": 0.0030345916748046875, "ViewRequirementAgentConnector_ms": 0.11220431327819824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5613.46518354694, "num_env_steps_trained_throughput_per_sec": 5613.46518354694, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2206.134, "sample_time_ms": 1925.893, "load_time_ms": 11.002, "load_throughput": 1090676.097, "learn_time_ms": 228.369, "learn_throughput": 52546.449, "synch_weights_time_ms": 39.671}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4603, "training_iteration": 101, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-08", "timestamp": 1698246908, "time_this_iter_s": 2.1427159309387207, "time_total_s": 243.5965096950531, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.5965096950531, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.88860905221012e-32, "cur_lr": 0.0003, "total_loss": 6.7961279021369085, "policy_loss": -0.000599011934051911, "vf_loss": 6.79677579138014, "vf_explained_var": -1.2516975402832031e-06, "kl": 0.0006768327041134133, "entropy": 0.4876058300336202, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1827.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2210000000002124, "episode_len_mean": 297.76, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 46.099999999999994, 44.5, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.90000000000002, 42.900000000000006, 41.100000000000016, -50.00000000000044, 35.10000000000004, 30.099999999999987, 20.299999999999848, 38.300000000000026, 42.70000000000001, 45.5, 32.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 38.90000000000002, -50.00000000000044, 46.9, 29.899999999999984, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 40.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 36.50000000000003, 8.699999999999683, 37.90000000000003, 14.699999999999768, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.70000000000003, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 16.8999999999998, 40.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001], "episode_lengths": [500, 50, 40, 56, 134, 74, 500, 500, 94, 92, 72, 90, 500, 150, 200, 298, 118, 74, 46, 176, 408, 500, 500, 68, 500, 500, 500, 500, 500, 242, 112, 500, 32, 202, 48, 52, 500, 500, 328, 56, 500, 500, 36, 42, 266, 500, 500, 500, 54, 500, 288, 500, 500, 26, 50, 500, 500, 500, 110, 500, 500, 212, 500, 92, 86, 500, 500, 42, 136, 414, 122, 354, 500, 100, 500, 134, 202, 72, 500, 500, 500, 500, 48, 500, 60, 332, 92, 500, 244, 500, 500, 500, 66, 500, 500, 94, 500, 500, 102, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41422895039408675, "mean_inference_ms": 1.324270534908619, "mean_action_processing_ms": 0.1545020615210383, "mean_env_wait_ms": 0.09237368688730786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025693655014038086, "StateBufferConnector_ms": 0.003035306930541992, "ViewRequirementAgentConnector_ms": 0.11181020736694336}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.2210000000002124, "episode_len_mean": 297.76, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.1, 46.099999999999994, 44.5, 36.70000000000003, 42.70000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.90000000000002, 42.900000000000006, 41.100000000000016, -50.00000000000044, 35.10000000000004, 30.099999999999987, 20.299999999999848, 38.300000000000026, 42.70000000000001, 45.5, 32.50000000000002, 9.299999999999692, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 38.90000000000002, -50.00000000000044, 46.9, 29.899999999999984, 45.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 17.299999999999805, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 45.9, 23.499999999999893, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 40.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 36.50000000000003, 8.699999999999683, 37.90000000000003, 14.699999999999768, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.70000000000003, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 16.8999999999998, 40.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001], "episode_lengths": [500, 50, 40, 56, 134, 74, 500, 500, 94, 92, 72, 90, 500, 150, 200, 298, 118, 74, 46, 176, 408, 500, 500, 68, 500, 500, 500, 500, 500, 242, 112, 500, 32, 202, 48, 52, 500, 500, 328, 56, 500, 500, 36, 42, 266, 500, 500, 500, 54, 500, 288, 500, 500, 26, 50, 500, 500, 500, 110, 500, 500, 212, 500, 92, 86, 500, 500, 42, 136, 414, 122, 354, 500, 100, 500, 134, 202, 72, 500, 500, 500, 500, 48, 500, 60, 332, 92, 500, 244, 500, 500, 500, 66, 500, 500, 94, 500, 500, 102, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41422895039408675, "mean_inference_ms": 1.324270534908619, "mean_action_processing_ms": 0.1545020615210383, "mean_env_wait_ms": 0.09237368688730786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025693655014038086, "StateBufferConnector_ms": 0.003035306930541992, "ViewRequirementAgentConnector_ms": 0.11181020736694336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5749.66703172563, "num_env_steps_trained_throughput_per_sec": 5749.66703172563, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2177.324, "sample_time_ms": 1897.787, "load_time_ms": 11.003, "load_throughput": 1090657.19, "learn_time_ms": 227.664, "learn_throughput": 52709.241, "synch_weights_time_ms": 39.671}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4641, "training_iteration": 102, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-10", "timestamp": 1698246910, "time_this_iter_s": 2.0920753479003906, "time_total_s": 245.6885850429535, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.6885850429535, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 59.23333333333333, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.94430452610506e-32, "cur_lr": 0.0003, "total_loss": 6.736359622743395, "policy_loss": -0.0001897518652387791, "vf_loss": 6.736597935358684, "vf_explained_var": -6.02669186062283e-07, "kl": 0.0005717961572497327, "entropy": 0.48555492692523533, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.365000000000215, "episode_len_mean": 299.2, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 40.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 36.50000000000003, 8.699999999999683, 37.90000000000003, 14.699999999999768, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.70000000000003, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 16.8999999999998, 40.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 33.500000000000036, 43.7, -50.00000000000044, 42.70000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 42.30000000000001, 40.10000000000002, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 30.29999999999999, 5.299999999999635, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 44.7, 39.70000000000002, 40.30000000000002, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, 45.5, 14.09999999999976, 46.099999999999994, -50.00000000000044, 36.10000000000004, 26.09999999999993, 44.900000000000006], "episode_lengths": [500, 500, 54, 500, 288, 500, 500, 26, 50, 500, 500, 500, 110, 500, 500, 212, 500, 92, 86, 500, 500, 42, 136, 414, 122, 354, 500, 100, 500, 134, 202, 72, 500, 500, 500, 500, 48, 500, 60, 332, 92, 500, 244, 500, 500, 500, 66, 500, 500, 94, 500, 500, 102, 88, 500, 166, 64, 500, 74, 56, 500, 500, 64, 500, 500, 500, 62, 170, 500, 500, 40, 60, 78, 100, 68, 500, 54, 500, 318, 198, 448, 270, 500, 500, 500, 286, 54, 104, 98, 500, 58, 32, 500, 46, 360, 40, 500, 140, 240, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41360796231617597, "mean_inference_ms": 1.3230674692530167, "mean_action_processing_ms": 0.15446964570481836, "mean_env_wait_ms": 0.09235815295566915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024698734283447266, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.1067497730255127}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.365000000000215, "episode_len_mean": 299.2, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 47.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 28.89999999999997, -50.00000000000044, 40.90000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 36.50000000000003, 8.699999999999683, 37.90000000000003, 14.699999999999768, -50.00000000000044, 40.10000000000002, -50.00000000000044, 36.70000000000003, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.10000000000001, 16.8999999999998, 40.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 33.500000000000036, 43.7, -50.00000000000044, 42.70000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 42.30000000000001, 40.10000000000002, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 30.29999999999999, 5.299999999999635, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 44.7, 39.70000000000002, 40.30000000000002, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, 45.5, 14.09999999999976, 46.099999999999994, -50.00000000000044, 36.10000000000004, 26.09999999999993, 44.900000000000006], "episode_lengths": [500, 500, 54, 500, 288, 500, 500, 26, 50, 500, 500, 500, 110, 500, 500, 212, 500, 92, 86, 500, 500, 42, 136, 414, 122, 354, 500, 100, 500, 134, 202, 72, 500, 500, 500, 500, 48, 500, 60, 332, 92, 500, 244, 500, 500, 500, 66, 500, 500, 94, 500, 500, 102, 88, 500, 166, 64, 500, 74, 56, 500, 500, 64, 500, 500, 500, 62, 170, 500, 500, 40, 60, 78, 100, 68, 500, 54, 500, 318, 198, 448, 270, 500, 500, 500, 286, 54, 104, 98, 500, 58, 32, 500, 46, 360, 40, 500, 140, 240, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41360796231617597, "mean_inference_ms": 1.3230674692530167, "mean_action_processing_ms": 0.15446964570481836, "mean_env_wait_ms": 0.09235815295566915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024698734283447266, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.1067497730255127}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5181.992665759136, "num_env_steps_trained_throughput_per_sec": 5181.992665759136, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2190.995, "sample_time_ms": 1900.321, "load_time_ms": 11.106, "load_throughput": 1080516.519, "learn_time_ms": 238.698, "learn_throughput": 50272.678, "synch_weights_time_ms": 39.671}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4687, "training_iteration": 103, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-13", "timestamp": 1698246913, "time_this_iter_s": 2.3207099437713623, "time_total_s": 248.00929498672485, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.00929498672485, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 54.875, "ram_util_percent": 26.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.97215226305253e-32, "cur_lr": 0.0003, "total_loss": 6.334054999881321, "policy_loss": -0.0004809308383199904, "vf_loss": 6.334587017695109, "vf_explained_var": -1.2351406945122612e-06, "kl": 0.0006643117708904356, "entropy": 0.5124643627140257, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1863.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.946999999999828, "episode_len_mean": 256.16, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 33.500000000000036, 43.7, -50.00000000000044, 42.70000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 42.30000000000001, 40.10000000000002, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 30.29999999999999, 5.299999999999635, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 44.7, 39.70000000000002, 40.30000000000002, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, 45.5, 14.09999999999976, 46.099999999999994, -50.00000000000044, 36.10000000000004, 26.09999999999993, 44.900000000000006, 38.300000000000026, 44.300000000000004, -50.00000000000044, 41.100000000000016, 45.1, -50.00000000000044, 15.699999999999783, 40.70000000000002, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 20.099999999999845, -50.00000000000044, 42.500000000000014, 44.10000000000001, 46.3, 44.10000000000001, 47.3, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.30000000000001, 30.9, -50.00000000000044, 34.10000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.699999999999996, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 94, 500, 500, 102, 88, 500, 166, 64, 500, 74, 56, 500, 500, 64, 500, 500, 500, 62, 170, 500, 500, 40, 60, 78, 100, 68, 500, 54, 500, 318, 198, 448, 270, 500, 500, 500, 286, 54, 104, 98, 500, 58, 32, 500, 46, 360, 40, 500, 140, 240, 52, 118, 58, 500, 90, 50, 500, 344, 94, 500, 80, 64, 500, 56, 500, 500, 148, 34, 300, 500, 76, 60, 38, 60, 28, 44, 500, 102, 500, 78, 192, 500, 160, 38, 500, 500, 500, 62, 144, 106, 500, 80, 500, 60, 34, 54, 180, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.412776933685207, "mean_inference_ms": 1.3219753577548912, "mean_action_processing_ms": 0.15408969383906865, "mean_env_wait_ms": 0.0922453992805362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03129291534423828, "StateBufferConnector_ms": 0.006005287170410156, "ViewRequirementAgentConnector_ms": 0.11220002174377441}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.946999999999828, "episode_len_mean": 256.16, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 33.500000000000036, 43.7, -50.00000000000044, 42.70000000000001, 44.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 42.30000000000001, 40.10000000000002, 43.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 18.29999999999982, 30.29999999999999, 5.299999999999635, 23.099999999999888, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.499999999999865, 44.7, 39.70000000000002, 40.30000000000002, -50.00000000000044, 44.300000000000004, 46.9, -50.00000000000044, 45.5, 14.09999999999976, 46.099999999999994, -50.00000000000044, 36.10000000000004, 26.09999999999993, 44.900000000000006, 38.300000000000026, 44.300000000000004, -50.00000000000044, 41.100000000000016, 45.1, -50.00000000000044, 15.699999999999783, 40.70000000000002, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 20.099999999999845, -50.00000000000044, 42.500000000000014, 44.10000000000001, 46.3, 44.10000000000001, 47.3, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.30000000000001, 30.9, -50.00000000000044, 34.10000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.699999999999996, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 94, 500, 500, 102, 88, 500, 166, 64, 500, 74, 56, 500, 500, 64, 500, 500, 500, 62, 170, 500, 500, 40, 60, 78, 100, 68, 500, 54, 500, 318, 198, 448, 270, 500, 500, 500, 286, 54, 104, 98, 500, 58, 32, 500, 46, 360, 40, 500, 140, 240, 52, 118, 58, 500, 90, 50, 500, 344, 94, 500, 80, 64, 500, 56, 500, 500, 148, 34, 300, 500, 76, 60, 38, 60, 28, 44, 500, 102, 500, 78, 192, 500, 160, 38, 500, 500, 500, 62, 144, 106, 500, 80, 500, 60, 34, 54, 180, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.412776933685207, "mean_inference_ms": 1.3219753577548912, "mean_action_processing_ms": 0.15408969383906865, "mean_env_wait_ms": 0.0922453992805362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03129291534423828, "StateBufferConnector_ms": 0.006005287170410156, "ViewRequirementAgentConnector_ms": 0.11220002174377441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5658.981362738835, "num_env_steps_trained_throughput_per_sec": 5658.981362738835, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2192.479, "sample_time_ms": 1901.583, "load_time_ms": 11.206, "load_throughput": 1070867.9, "learn_time_ms": 238.858, "learn_throughput": 50239.057, "synch_weights_time_ms": 39.634}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4735, "training_iteration": 104, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-15", "timestamp": 1698246915, "time_this_iter_s": 2.1258351802825928, "time_total_s": 250.13513016700745, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.13513016700745, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 60.0, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.86076131526265e-33, "cur_lr": 0.0003, "total_loss": 6.876747475730048, "policy_loss": -0.0002257742453366518, "vf_loss": 6.877022531297472, "vf_explained_var": -1.3245476616753472e-06, "kl": 0.0002531768431658242, "entropy": 0.49227920340167153, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1881.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.448999999999838, "episode_len_mean": 251.16, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.10000000000004, 26.09999999999993, 44.900000000000006, 38.300000000000026, 44.300000000000004, -50.00000000000044, 41.100000000000016, 45.1, -50.00000000000044, 15.699999999999783, 40.70000000000002, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 20.099999999999845, -50.00000000000044, 42.500000000000014, 44.10000000000001, 46.3, 44.10000000000001, 47.3, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.30000000000001, 30.9, -50.00000000000044, 34.10000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.699999999999996, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.5, 9.099999999999689, -50.00000000000044, 31.1, 35.900000000000034, 45.3, 42.500000000000014, 34.900000000000034, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.30000000000003, 22.699999999999882, 24.69999999999991, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, 46.5, 29.49999999999998, -50.00000000000044, 30.499999999999993, 13.699999999999754, 45.7, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 32.50000000000002, 44.300000000000004, 43.900000000000006, 45.1, 47.3, 34.30000000000004, -50.00000000000044], "episode_lengths": [500, 140, 240, 52, 118, 58, 500, 90, 50, 500, 344, 94, 500, 80, 64, 500, 56, 500, 500, 148, 34, 300, 500, 76, 60, 38, 60, 28, 44, 500, 102, 500, 78, 192, 500, 160, 38, 500, 500, 500, 62, 144, 106, 500, 80, 500, 60, 34, 54, 180, 500, 500, 500, 78, 500, 56, 410, 500, 190, 142, 48, 76, 152, 86, 64, 500, 500, 156, 500, 500, 500, 110, 500, 168, 274, 254, 500, 54, 500, 118, 36, 206, 500, 196, 364, 44, 56, 500, 40, 500, 500, 242, 500, 176, 58, 62, 50, 28, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4126151272694031, "mean_inference_ms": 1.3197229975433376, "mean_action_processing_ms": 0.15374117641903196, "mean_env_wait_ms": 0.09204222532950283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0293881893157959, "StateBufferConnector_ms": 0.006917715072631836, "ViewRequirementAgentConnector_ms": 0.12498974800109863}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.448999999999838, "episode_len_mean": 251.16, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.10000000000004, 26.09999999999993, 44.900000000000006, 38.300000000000026, 44.300000000000004, -50.00000000000044, 41.100000000000016, 45.1, -50.00000000000044, 15.699999999999783, 40.70000000000002, -50.00000000000044, 42.10000000000001, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 46.699999999999996, 20.099999999999845, -50.00000000000044, 42.500000000000014, 44.10000000000001, 46.3, 44.10000000000001, 47.3, 45.7, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.30000000000001, 30.9, -50.00000000000044, 34.10000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 39.50000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.10000000000001, 46.699999999999996, 44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.5, 9.099999999999689, -50.00000000000044, 31.1, 35.900000000000034, 45.3, 42.500000000000014, 34.900000000000034, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.30000000000003, 22.699999999999882, 24.69999999999991, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, 46.5, 29.49999999999998, -50.00000000000044, 30.499999999999993, 13.699999999999754, 45.7, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 32.50000000000002, 44.300000000000004, 43.900000000000006, 45.1, 47.3, 34.30000000000004, -50.00000000000044], "episode_lengths": [500, 140, 240, 52, 118, 58, 500, 90, 50, 500, 344, 94, 500, 80, 64, 500, 56, 500, 500, 148, 34, 300, 500, 76, 60, 38, 60, 28, 44, 500, 102, 500, 78, 192, 500, 160, 38, 500, 500, 500, 62, 144, 106, 500, 80, 500, 60, 34, 54, 180, 500, 500, 500, 78, 500, 56, 410, 500, 190, 142, 48, 76, 152, 86, 64, 500, 500, 156, 500, 500, 500, 110, 500, 168, 274, 254, 500, 54, 500, 118, 36, 206, 500, 196, 364, 44, 56, 500, 40, 500, 500, 242, 500, 176, 58, 62, 50, 28, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4126151272694031, "mean_inference_ms": 1.3197229975433376, "mean_action_processing_ms": 0.15374117641903196, "mean_env_wait_ms": 0.09204222532950283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0293881893157959, "StateBufferConnector_ms": 0.006917715072631836, "ViewRequirementAgentConnector_ms": 0.12498974800109863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5533.784722042796, "num_env_steps_trained_throughput_per_sec": 5533.784722042796, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2183.55, "sample_time_ms": 1901.791, "load_time_ms": 10.766, "load_throughput": 1114582.505, "learn_time_ms": 230.343, "learn_throughput": 52096.263, "synch_weights_time_ms": 39.633}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4783, "training_iteration": 105, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-17", "timestamp": 1698246917, "time_this_iter_s": 2.173354148864746, "time_total_s": 252.3084843158722, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.3084843158722, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 61.4, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.930380657631325e-33, "cur_lr": 0.0003, "total_loss": 6.773498031828138, "policy_loss": -0.0002744497938288583, "vf_loss": 6.773827261394924, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.0006390239314413293, "entropy": 0.5479311015870836, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1899.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.441999999999853, "episode_len_mean": 246.28, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.5, 9.099999999999689, -50.00000000000044, 31.1, 35.900000000000034, 45.3, 42.500000000000014, 34.900000000000034, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.30000000000003, 22.699999999999882, 24.69999999999991, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, 46.5, 29.49999999999998, -50.00000000000044, 30.499999999999993, 13.699999999999754, 45.7, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 32.50000000000002, 44.300000000000004, 43.900000000000006, 45.1, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.30000000000001, 26.499999999999936, -50.00000000000044, 36.30000000000003, 26.299999999999933, 40.30000000000002, 46.699999999999996, 34.50000000000004, 43.900000000000006, 44.10000000000001, -50.00000000000044, 39.10000000000002, 44.5, 18.699999999999825, 43.30000000000001, 45.7, 43.900000000000006, 42.30000000000001, 29.099999999999973, 25.499999999999922, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 6.8999999999996575, 32.700000000000024, 25.099999999999916, 40.30000000000002, 31.500000000000007, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.30000000000001, 45.9, 18.099999999999817, 12.099999999999731, -50.00000000000044, 26.89999999999994, 44.10000000000001, 36.30000000000003, 40.30000000000002, -50.00000000000044, 37.90000000000003], "episode_lengths": [54, 180, 500, 500, 500, 78, 500, 56, 410, 500, 190, 142, 48, 76, 152, 86, 64, 500, 500, 156, 500, 500, 500, 110, 500, 168, 274, 254, 500, 54, 500, 118, 36, 206, 500, 196, 364, 44, 56, 500, 40, 500, 500, 242, 500, 176, 58, 62, 50, 28, 158, 500, 500, 34, 500, 500, 100, 68, 236, 500, 138, 238, 98, 34, 156, 62, 60, 500, 110, 56, 314, 68, 44, 62, 78, 210, 246, 54, 500, 500, 40, 432, 174, 250, 98, 186, 500, 136, 500, 68, 42, 320, 380, 500, 232, 60, 138, 98, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.412677338077643, "mean_inference_ms": 1.3188780136911473, "mean_action_processing_ms": 0.15367430231722307, "mean_env_wait_ms": 0.09203649951965318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019558429718017578, "StateBufferConnector_ms": 0.003921985626220703, "ViewRequirementAgentConnector_ms": 0.14046931266784668}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.441999999999853, "episode_len_mean": 246.28, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.5, 9.099999999999689, -50.00000000000044, 31.1, 35.900000000000034, 45.3, 42.500000000000014, 34.900000000000034, 41.500000000000014, 43.7, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 33.30000000000003, 22.699999999999882, 24.69999999999991, -50.00000000000044, 44.7, -50.00000000000044, 38.300000000000026, 46.5, 29.49999999999998, -50.00000000000044, 30.499999999999993, 13.699999999999754, 45.7, 44.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 32.50000000000002, 44.300000000000004, 43.900000000000006, 45.1, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.30000000000001, 26.499999999999936, -50.00000000000044, 36.30000000000003, 26.299999999999933, 40.30000000000002, 46.699999999999996, 34.50000000000004, 43.900000000000006, 44.10000000000001, -50.00000000000044, 39.10000000000002, 44.5, 18.699999999999825, 43.30000000000001, 45.7, 43.900000000000006, 42.30000000000001, 29.099999999999973, 25.499999999999922, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 6.8999999999996575, 32.700000000000024, 25.099999999999916, 40.30000000000002, 31.500000000000007, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.30000000000001, 45.9, 18.099999999999817, 12.099999999999731, -50.00000000000044, 26.89999999999994, 44.10000000000001, 36.30000000000003, 40.30000000000002, -50.00000000000044, 37.90000000000003], "episode_lengths": [54, 180, 500, 500, 500, 78, 500, 56, 410, 500, 190, 142, 48, 76, 152, 86, 64, 500, 500, 156, 500, 500, 500, 110, 500, 168, 274, 254, 500, 54, 500, 118, 36, 206, 500, 196, 364, 44, 56, 500, 40, 500, 500, 242, 500, 176, 58, 62, 50, 28, 158, 500, 500, 34, 500, 500, 100, 68, 236, 500, 138, 238, 98, 34, 156, 62, 60, 500, 110, 56, 314, 68, 44, 62, 78, 210, 246, 54, 500, 500, 40, 432, 174, 250, 98, 186, 500, 136, 500, 68, 42, 320, 380, 500, 232, 60, 138, 98, 500, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.412677338077643, "mean_inference_ms": 1.3188780136911473, "mean_action_processing_ms": 0.15367430231722307, "mean_env_wait_ms": 0.09203649951965318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019558429718017578, "StateBufferConnector_ms": 0.003921985626220703, "ViewRequirementAgentConnector_ms": 0.14046931266784668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5675.205317762755, "num_env_steps_trained_throughput_per_sec": 5675.205317762755, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2181.762, "sample_time_ms": 1899.736, "load_time_ms": 10.766, "load_throughput": 1114607.187, "learn_time_ms": 230.41, "learn_throughput": 52081.174, "synch_weights_time_ms": 39.534}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4831, "training_iteration": 106, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-19", "timestamp": 1698246919, "time_this_iter_s": 2.119474411010742, "time_total_s": 254.42795872688293, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.42795872688293, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156624e-33, "cur_lr": 0.0003, "total_loss": 6.714304791556464, "policy_loss": -0.0006125694554713038, "vf_loss": 6.714975039164226, "vf_explained_var": -9.006924099392361e-07, "kl": 0.0009938327058939143, "entropy": 0.5769195059935252, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1917.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.084999999999855, "episode_len_mean": 244.84, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.50000000000002, 44.300000000000004, 43.900000000000006, 45.1, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.30000000000001, 26.499999999999936, -50.00000000000044, 36.30000000000003, 26.299999999999933, 40.30000000000002, 46.699999999999996, 34.50000000000004, 43.900000000000006, 44.10000000000001, -50.00000000000044, 39.10000000000002, 44.5, 18.699999999999825, 43.30000000000001, 45.7, 43.900000000000006, 42.30000000000001, 29.099999999999973, 25.499999999999922, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 6.8999999999996575, 32.700000000000024, 25.099999999999916, 40.30000000000002, 31.500000000000007, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.30000000000001, 45.9, 18.099999999999817, 12.099999999999731, -50.00000000000044, 26.89999999999994, 44.10000000000001, 36.30000000000003, 40.30000000000002, -50.00000000000044, 37.90000000000003, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 33.30000000000003, -50.00000000000044, 34.30000000000004, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.70000000000002, -50.00000000000044, 37.300000000000026, 45.3, -50.00000000000044, 44.300000000000004, 37.300000000000026, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, 42.500000000000014, -50.00000000000044, 31.900000000000013, -50.00000000000044, 20.49999999999985, 37.300000000000026, 43.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 25.499999999999922, 44.7], "episode_lengths": [176, 58, 62, 50, 28, 158, 500, 500, 34, 500, 500, 100, 68, 236, 500, 138, 238, 98, 34, 156, 62, 60, 500, 110, 56, 314, 68, 44, 62, 78, 210, 246, 54, 500, 500, 40, 432, 174, 250, 98, 186, 500, 136, 500, 68, 42, 320, 380, 500, 232, 60, 138, 98, 500, 122, 96, 102, 500, 500, 76, 500, 74, 168, 500, 158, 130, 500, 62, 84, 500, 128, 48, 500, 58, 128, 212, 500, 500, 500, 228, 500, 500, 500, 122, 500, 92, 76, 500, 182, 500, 296, 128, 64, 500, 88, 500, 500, 110, 246, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41201088727341584, "mean_inference_ms": 1.3171420994137986, "mean_action_processing_ms": 0.15382344885347785, "mean_env_wait_ms": 0.09184488535700532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02608942985534668, "StateBufferConnector_ms": 0.005913496017456055, "ViewRequirementAgentConnector_ms": 0.1278836727142334}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.084999999999855, "episode_len_mean": 244.84, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.50000000000002, 44.300000000000004, 43.900000000000006, 45.1, 47.3, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.30000000000001, 26.499999999999936, -50.00000000000044, 36.30000000000003, 26.299999999999933, 40.30000000000002, 46.699999999999996, 34.50000000000004, 43.900000000000006, 44.10000000000001, -50.00000000000044, 39.10000000000002, 44.5, 18.699999999999825, 43.30000000000001, 45.7, 43.900000000000006, 42.30000000000001, 29.099999999999973, 25.499999999999922, 44.7, -50.00000000000044, -50.00000000000044, 46.099999999999994, 6.8999999999996575, 32.700000000000024, 25.099999999999916, 40.30000000000002, 31.500000000000007, -50.00000000000044, 36.50000000000003, -50.00000000000044, 43.30000000000001, 45.9, 18.099999999999817, 12.099999999999731, -50.00000000000044, 26.89999999999994, 44.10000000000001, 36.30000000000003, 40.30000000000002, -50.00000000000044, 37.90000000000003, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 33.30000000000003, -50.00000000000044, 34.30000000000004, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.70000000000002, -50.00000000000044, 37.300000000000026, 45.3, -50.00000000000044, 44.300000000000004, 37.300000000000026, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, 42.500000000000014, -50.00000000000044, 31.900000000000013, -50.00000000000044, 20.49999999999985, 37.300000000000026, 43.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 25.499999999999922, 44.7], "episode_lengths": [176, 58, 62, 50, 28, 158, 500, 500, 34, 500, 500, 100, 68, 236, 500, 138, 238, 98, 34, 156, 62, 60, 500, 110, 56, 314, 68, 44, 62, 78, 210, 246, 54, 500, 500, 40, 432, 174, 250, 98, 186, 500, 136, 500, 68, 42, 320, 380, 500, 232, 60, 138, 98, 500, 122, 96, 102, 500, 500, 76, 500, 74, 168, 500, 158, 130, 500, 62, 84, 500, 128, 48, 500, 58, 128, 212, 500, 500, 500, 228, 500, 500, 500, 122, 500, 92, 76, 500, 182, 500, 296, 128, 64, 500, 88, 500, 500, 110, 246, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41201088727341584, "mean_inference_ms": 1.3171420994137986, "mean_action_processing_ms": 0.15382344885347785, "mean_env_wait_ms": 0.09184488535700532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02608942985534668, "StateBufferConnector_ms": 0.005913496017456055, "ViewRequirementAgentConnector_ms": 0.1278836727142334}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5287.068325741234, "num_env_steps_trained_throughput_per_sec": 5287.068325741234, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2191.239, "sample_time_ms": 1899.887, "load_time_ms": 10.666, "load_throughput": 1125061.426, "learn_time_ms": 239.958, "learn_throughput": 50008.657, "synch_weights_time_ms": 39.511}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4876, "training_iteration": 107, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-21", "timestamp": 1698246921, "time_this_iter_s": 2.274688243865967, "time_total_s": 256.7026469707489, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.7026469707489, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 60.53333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078312e-33, "cur_lr": 0.0003, "total_loss": 6.896050797568427, "policy_loss": -0.00011971178981992934, "vf_loss": 6.896232022179498, "vf_explained_var": -9.669197930230034e-07, "kl": 0.0001598791478727435, "entropy": 0.6154949764410654, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.801999999999826, "episode_len_mean": 272.6, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.099999999999817, 12.099999999999731, -50.00000000000044, 26.89999999999994, 44.10000000000001, 36.30000000000003, 40.30000000000002, -50.00000000000044, 37.90000000000003, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 33.30000000000003, -50.00000000000044, 34.30000000000004, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.70000000000002, -50.00000000000044, 37.300000000000026, 45.3, -50.00000000000044, 44.300000000000004, 37.300000000000026, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, 42.500000000000014, -50.00000000000044, 31.900000000000013, -50.00000000000044, 20.49999999999985, 37.300000000000026, 43.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 25.499999999999922, 44.7, -50.00000000000044, 11.699999999999726, 37.300000000000026, 42.10000000000001, 44.7, 39.90000000000002, -50.00000000000044, 40.30000000000002, 40.70000000000002, -50.00000000000044, 20.699999999999854, 32.30000000000002, 38.90000000000002, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, 45.9, 37.70000000000003, 39.50000000000002, -50.00000000000044, 24.899999999999913, 30.29999999999999, -50.00000000000044, 47.9, -50.00000000000044, 23.699999999999896, 37.10000000000003, -50.00000000000044, 39.90000000000002], "episode_lengths": [320, 380, 500, 232, 60, 138, 98, 500, 122, 96, 102, 500, 500, 76, 500, 74, 168, 500, 158, 130, 500, 62, 84, 500, 128, 48, 500, 58, 128, 212, 500, 500, 500, 228, 500, 500, 500, 122, 500, 92, 76, 500, 182, 500, 296, 128, 64, 500, 88, 500, 500, 110, 246, 54, 500, 384, 128, 80, 54, 102, 500, 98, 94, 500, 294, 178, 112, 500, 140, 64, 500, 500, 500, 148, 52, 500, 500, 164, 500, 72, 80, 500, 108, 500, 46, 500, 62, 42, 124, 106, 500, 252, 198, 500, 22, 500, 264, 130, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41229031645645103, "mean_inference_ms": 1.317325821265311, "mean_action_processing_ms": 0.15378289303961654, "mean_env_wait_ms": 0.09195471302786959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.010996580123901367, "ViewRequirementAgentConnector_ms": 0.11003327369689941}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.801999999999826, "episode_len_mean": 272.6, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.099999999999817, 12.099999999999731, -50.00000000000044, 26.89999999999994, 44.10000000000001, 36.30000000000003, 40.30000000000002, -50.00000000000044, 37.90000000000003, 40.500000000000014, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, 33.30000000000003, -50.00000000000044, 34.30000000000004, 37.10000000000003, -50.00000000000044, 43.900000000000006, 41.70000000000002, -50.00000000000044, 37.300000000000026, 45.3, -50.00000000000044, 44.300000000000004, 37.300000000000026, 28.89999999999997, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, 42.500000000000014, -50.00000000000044, 31.900000000000013, -50.00000000000044, 20.49999999999985, 37.300000000000026, 43.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 25.499999999999922, 44.7, -50.00000000000044, 11.699999999999726, 37.300000000000026, 42.10000000000001, 44.7, 39.90000000000002, -50.00000000000044, 40.30000000000002, 40.70000000000002, -50.00000000000044, 20.699999999999854, 32.30000000000002, 38.90000000000002, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, 45.9, 37.70000000000003, 39.50000000000002, -50.00000000000044, 24.899999999999913, 30.29999999999999, -50.00000000000044, 47.9, -50.00000000000044, 23.699999999999896, 37.10000000000003, -50.00000000000044, 39.90000000000002], "episode_lengths": [320, 380, 500, 232, 60, 138, 98, 500, 122, 96, 102, 500, 500, 76, 500, 74, 168, 500, 158, 130, 500, 62, 84, 500, 128, 48, 500, 58, 128, 212, 500, 500, 500, 228, 500, 500, 500, 122, 500, 92, 76, 500, 182, 500, 296, 128, 64, 500, 88, 500, 500, 110, 246, 54, 500, 384, 128, 80, 54, 102, 500, 98, 94, 500, 294, 178, 112, 500, 140, 64, 500, 500, 500, 148, 52, 500, 500, 164, 500, 72, 80, 500, 108, 500, 46, 500, 62, 42, 124, 106, 500, 252, 198, 500, 22, 500, 264, 130, 500, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41229031645645103, "mean_inference_ms": 1.317325821265311, "mean_action_processing_ms": 0.15378289303961654, "mean_env_wait_ms": 0.09195471302786959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.010996580123901367, "ViewRequirementAgentConnector_ms": 0.11003327369689941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5579.7622121342165, "num_env_steps_trained_throughput_per_sec": 5579.7622121342165, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2196.771, "sample_time_ms": 1905.904, "load_time_ms": 10.669, "load_throughput": 1124734.591, "learn_time_ms": 239.508, "learn_throughput": 50102.639, "synch_weights_time_ms": 39.459}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4922, "training_iteration": 108, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-24", "timestamp": 1698246924, "time_this_iter_s": 2.1558995246887207, "time_total_s": 258.8585464954376, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.8585464954376, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039156e-34, "cur_lr": 0.0003, "total_loss": 6.727846490012275, "policy_loss": -0.0006882987088627286, "vf_loss": 6.7285916275448265, "vf_explained_var": -9.5367431640625e-07, "kl": 0.001252801762620474, "entropy": 0.5688138256470362, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1953.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.382999999999823, "episode_len_mean": 271.8, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.49999999999985, 37.300000000000026, 43.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 25.499999999999922, 44.7, -50.00000000000044, 11.699999999999726, 37.300000000000026, 42.10000000000001, 44.7, 39.90000000000002, -50.00000000000044, 40.30000000000002, 40.70000000000002, -50.00000000000044, 20.699999999999854, 32.30000000000002, 38.90000000000002, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, 45.9, 37.70000000000003, 39.50000000000002, -50.00000000000044, 24.899999999999913, 30.29999999999999, -50.00000000000044, 47.9, -50.00000000000044, 23.699999999999896, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, 37.10000000000003, -50.00000000000044, 45.7, 24.499999999999908, 39.90000000000002, 45.7, 44.10000000000001, -50.00000000000044, 40.30000000000002, 3.899999999999615, 16.29999999999979, 37.90000000000003, 36.900000000000034, 40.70000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 29.49999999999998, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 39.300000000000026, 45.5, 33.500000000000036, 8.899999999999686, -50.00000000000044, 37.70000000000003, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 296, 128, 64, 500, 88, 500, 500, 110, 246, 54, 500, 384, 128, 80, 54, 102, 500, 98, 94, 500, 294, 178, 112, 500, 140, 64, 500, 500, 500, 148, 52, 500, 500, 164, 500, 72, 80, 500, 108, 500, 46, 500, 62, 42, 124, 106, 500, 252, 198, 500, 22, 500, 264, 130, 500, 102, 500, 96, 130, 500, 44, 256, 102, 44, 60, 500, 98, 462, 338, 122, 132, 94, 500, 146, 500, 500, 500, 42, 46, 206, 500, 66, 500, 500, 72, 384, 500, 500, 500, 500, 158, 108, 46, 166, 412, 500, 124, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4120430352025577, "mean_inference_ms": 1.3161003071396389, "mean_action_processing_ms": 0.15372576163376037, "mean_env_wait_ms": 0.09201673576872345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020996570587158203, "StateBufferConnector_ms": 0.013991594314575195, "ViewRequirementAgentConnector_ms": 0.11677837371826172}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.382999999999823, "episode_len_mean": 271.8, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.49999999999985, 37.300000000000026, 43.7, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, 25.499999999999922, 44.7, -50.00000000000044, 11.699999999999726, 37.300000000000026, 42.10000000000001, 44.7, 39.90000000000002, -50.00000000000044, 40.30000000000002, 40.70000000000002, -50.00000000000044, 20.699999999999854, 32.30000000000002, 38.90000000000002, -50.00000000000044, 36.10000000000004, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, 42.900000000000006, 42.10000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.5, -50.00000000000044, 43.900000000000006, 45.9, 37.70000000000003, 39.50000000000002, -50.00000000000044, 24.899999999999913, 30.29999999999999, -50.00000000000044, 47.9, -50.00000000000044, 23.699999999999896, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, 37.10000000000003, -50.00000000000044, 45.7, 24.499999999999908, 39.90000000000002, 45.7, 44.10000000000001, -50.00000000000044, 40.30000000000002, 3.899999999999615, 16.29999999999979, 37.90000000000003, 36.900000000000034, 40.70000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 29.49999999999998, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 39.300000000000026, 45.5, 33.500000000000036, 8.899999999999686, -50.00000000000044, 37.70000000000003, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 296, 128, 64, 500, 88, 500, 500, 110, 246, 54, 500, 384, 128, 80, 54, 102, 500, 98, 94, 500, 294, 178, 112, 500, 140, 64, 500, 500, 500, 148, 52, 500, 500, 164, 500, 72, 80, 500, 108, 500, 46, 500, 62, 42, 124, 106, 500, 252, 198, 500, 22, 500, 264, 130, 500, 102, 500, 96, 130, 500, 44, 256, 102, 44, 60, 500, 98, 462, 338, 122, 132, 94, 500, 146, 500, 500, 500, 42, 46, 206, 500, 66, 500, 500, 72, 384, 500, 500, 500, 500, 158, 108, 46, 166, 412, 500, 124, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4120430352025577, "mean_inference_ms": 1.3161003071396389, "mean_action_processing_ms": 0.15372576163376037, "mean_env_wait_ms": 0.09201673576872345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020996570587158203, "StateBufferConnector_ms": 0.013991594314575195, "ViewRequirementAgentConnector_ms": 0.11677837371826172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5137.269511747763, "num_env_steps_trained_throughput_per_sec": 5137.269511747763, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2173.409, "sample_time_ms": 1912.2, "load_time_ms": 10.707, "load_throughput": 1120732.494, "learn_time_ms": 240.017, "learn_throughput": 49996.521, "synch_weights_time_ms": 9.254}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4965, "training_iteration": 109, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-26", "timestamp": 1698246926, "time_this_iter_s": 2.3408701419830322, "time_total_s": 261.19941663742065, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.19941663742065, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.081487911019578e-34, "cur_lr": 0.0003, "total_loss": 7.332015011045668, "policy_loss": -0.0007908025549517737, "vf_loss": 7.332867834303114, "vf_explained_var": -8.477105034722222e-07, "kl": 0.001434148493561654, "entropy": 0.6200685732894473, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1971.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.73199999999984, "episode_len_mean": 253.38, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.699999999999896, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, 37.10000000000003, -50.00000000000044, 45.7, 24.499999999999908, 39.90000000000002, 45.7, 44.10000000000001, -50.00000000000044, 40.30000000000002, 3.899999999999615, 16.29999999999979, 37.90000000000003, 36.900000000000034, 40.70000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 29.49999999999998, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 39.300000000000026, 45.5, 33.500000000000036, 8.899999999999686, -50.00000000000044, 37.70000000000003, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.699999999999925, 10.299999999999706, 40.30000000000002, 43.10000000000001, 25.099999999999916, 44.900000000000006, 21.09999999999986, 35.30000000000004, 8.49999999999968, 5.299999999999635, 39.90000000000002, 42.500000000000014, -50.00000000000044, 41.70000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 25.099999999999916, 43.50000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 41.70000000000002, 12.299999999999734, 39.10000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 43.50000000000001, 38.10000000000002, 40.70000000000002, 22.699999999999882, 43.7, 46.099999999999994, 44.5, -50.00000000000044, 45.5], "episode_lengths": [500, 264, 130, 500, 102, 500, 96, 130, 500, 44, 256, 102, 44, 60, 500, 98, 462, 338, 122, 132, 94, 500, 146, 500, 500, 500, 42, 46, 206, 500, 66, 500, 500, 72, 384, 500, 500, 500, 500, 158, 108, 46, 166, 412, 500, 124, 40, 500, 36, 46, 488, 500, 500, 500, 500, 64, 500, 244, 398, 98, 70, 250, 52, 290, 148, 416, 448, 102, 76, 500, 84, 116, 500, 40, 98, 90, 116, 500, 500, 100, 250, 66, 76, 58, 500, 84, 378, 110, 500, 86, 110, 66, 120, 94, 274, 64, 40, 56, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4117112498077084, "mean_inference_ms": 1.3151307846714757, "mean_action_processing_ms": 0.15354045375475311, "mean_env_wait_ms": 0.09184088665758372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01722574234008789, "StateBufferConnector_ms": 0.00799107551574707, "ViewRequirementAgentConnector_ms": 0.12084746360778809}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.73199999999984, "episode_len_mean": 253.38, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.699999999999896, 37.10000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, 40.500000000000014, 37.10000000000003, -50.00000000000044, 45.7, 24.499999999999908, 39.90000000000002, 45.7, 44.10000000000001, -50.00000000000044, 40.30000000000002, 3.899999999999615, 16.29999999999979, 37.90000000000003, 36.900000000000034, 40.70000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 29.49999999999998, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 11.699999999999726, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 39.300000000000026, 45.5, 33.500000000000036, 8.899999999999686, -50.00000000000044, 37.70000000000003, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.699999999999925, 10.299999999999706, 40.30000000000002, 43.10000000000001, 25.099999999999916, 44.900000000000006, 21.09999999999986, 35.30000000000004, 8.49999999999968, 5.299999999999635, 39.90000000000002, 42.500000000000014, -50.00000000000044, 41.70000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 25.099999999999916, 43.50000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 41.70000000000002, 12.299999999999734, 39.10000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 43.50000000000001, 38.10000000000002, 40.70000000000002, 22.699999999999882, 43.7, 46.099999999999994, 44.5, -50.00000000000044, 45.5], "episode_lengths": [500, 264, 130, 500, 102, 500, 96, 130, 500, 44, 256, 102, 44, 60, 500, 98, 462, 338, 122, 132, 94, 500, 146, 500, 500, 500, 42, 46, 206, 500, 66, 500, 500, 72, 384, 500, 500, 500, 500, 158, 108, 46, 166, 412, 500, 124, 40, 500, 36, 46, 488, 500, 500, 500, 500, 64, 500, 244, 398, 98, 70, 250, 52, 290, 148, 416, 448, 102, 76, 500, 84, 116, 500, 40, 98, 90, 116, 500, 500, 100, 250, 66, 76, 58, 500, 84, 378, 110, 500, 86, 110, 66, 120, 94, 274, 64, 40, 56, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4117112498077084, "mean_inference_ms": 1.3151307846714757, "mean_action_processing_ms": 0.15354045375475311, "mean_env_wait_ms": 0.09184088665758372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01722574234008789, "StateBufferConnector_ms": 0.00799107551574707, "ViewRequirementAgentConnector_ms": 0.12084746360778809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5454.443074406225, "num_env_steps_trained_throughput_per_sec": 5454.443074406225, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2190.022, "sample_time_ms": 1925.286, "load_time_ms": 11.034, "load_throughput": 1087588.713, "learn_time_ms": 243.564, "learn_throughput": 49268.368, "synch_weights_time_ms": 8.907}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5017, "training_iteration": 110, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-28", "timestamp": 1698246928, "time_this_iter_s": 2.2050390243530273, "time_total_s": 263.4044556617737, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.4044556617737, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.540743955509789e-34, "cur_lr": 0.0003, "total_loss": 6.86870018641154, "policy_loss": 0.00010229067669974433, "vf_loss": 6.8686567942301435, "vf_explained_var": -1.0530153910319011e-06, "kl": 0.00029855817229436826, "entropy": 0.5900480151176453, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1989.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.151999999999855, "episode_len_mean": 239.22, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.699999999999925, 10.299999999999706, 40.30000000000002, 43.10000000000001, 25.099999999999916, 44.900000000000006, 21.09999999999986, 35.30000000000004, 8.49999999999968, 5.299999999999635, 39.90000000000002, 42.500000000000014, -50.00000000000044, 41.70000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 25.099999999999916, 43.50000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 41.70000000000002, 12.299999999999734, 39.10000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 43.50000000000001, 38.10000000000002, 40.70000000000002, 22.699999999999882, 43.7, 46.099999999999994, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 34.70000000000004, 31.300000000000004, 27.49999999999995, -50.00000000000044, 39.50000000000002, 45.3, 44.900000000000006, 23.8999999999999, 41.90000000000001, 40.30000000000002, 45.1, 43.7, 25.099999999999916, 33.30000000000003, 34.10000000000004, 39.90000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.300000000000004, 39.90000000000002, 46.3, 28.699999999999967, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.899999999999615, 45.5, 32.100000000000016, 0.49999999999956657, 44.300000000000004, -50.00000000000044, 42.900000000000006, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 40, 500, 36, 46, 488, 500, 500, 500, 500, 64, 500, 244, 398, 98, 70, 250, 52, 290, 148, 416, 448, 102, 76, 500, 84, 116, 500, 40, 98, 90, 116, 500, 500, 100, 250, 66, 76, 58, 500, 84, 378, 110, 500, 86, 110, 66, 120, 94, 274, 64, 40, 56, 500, 46, 500, 60, 154, 188, 226, 500, 106, 48, 52, 262, 82, 98, 50, 64, 250, 168, 160, 102, 212, 500, 500, 158, 58, 102, 38, 214, 500, 500, 490, 500, 52, 500, 60, 500, 462, 46, 180, 496, 58, 500, 72, 142, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41131632980863303, "mean_inference_ms": 1.3148120871293743, "mean_action_processing_ms": 0.1534977528292458, "mean_env_wait_ms": 0.09168964968035163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01926422119140625, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1235959529876709}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.151999999999855, "episode_len_mean": 239.22, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, 46.099999999999994, -50.00000000000044, 46.5, 45.5, 1.299999999999578, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 25.699999999999925, 10.299999999999706, 40.30000000000002, 43.10000000000001, 25.099999999999916, 44.900000000000006, 21.09999999999986, 35.30000000000004, 8.49999999999968, 5.299999999999635, 39.90000000000002, 42.500000000000014, -50.00000000000044, 41.70000000000002, 38.50000000000003, -50.00000000000044, 46.099999999999994, 40.30000000000002, 41.100000000000016, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 25.099999999999916, 43.50000000000001, 42.500000000000014, 44.300000000000004, -50.00000000000044, 41.70000000000002, 12.299999999999734, 39.10000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 43.50000000000001, 38.10000000000002, 40.70000000000002, 22.699999999999882, 43.7, 46.099999999999994, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 34.70000000000004, 31.300000000000004, 27.49999999999995, -50.00000000000044, 39.50000000000002, 45.3, 44.900000000000006, 23.8999999999999, 41.90000000000001, 40.30000000000002, 45.1, 43.7, 25.099999999999916, 33.30000000000003, 34.10000000000004, 39.90000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.300000000000004, 39.90000000000002, 46.3, 28.699999999999967, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.899999999999615, 45.5, 32.100000000000016, 0.49999999999956657, 44.300000000000004, -50.00000000000044, 42.900000000000006, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [124, 40, 500, 36, 46, 488, 500, 500, 500, 500, 64, 500, 244, 398, 98, 70, 250, 52, 290, 148, 416, 448, 102, 76, 500, 84, 116, 500, 40, 98, 90, 116, 500, 500, 100, 250, 66, 76, 58, 500, 84, 378, 110, 500, 86, 110, 66, 120, 94, 274, 64, 40, 56, 500, 46, 500, 60, 154, 188, 226, 500, 106, 48, 52, 262, 82, 98, 50, 64, 250, 168, 160, 102, 212, 500, 500, 158, 58, 102, 38, 214, 500, 500, 490, 500, 52, 500, 60, 500, 462, 46, 180, 496, 58, 500, 72, 142, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41131632980863303, "mean_inference_ms": 1.3148120871293743, "mean_action_processing_ms": 0.1534977528292458, "mean_env_wait_ms": 0.09168964968035163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01926422119140625, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.1235959529876709}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5469.471665032834, "num_env_steps_trained_throughput_per_sec": 5469.471665032834, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2195.65, "sample_time_ms": 1928.328, "load_time_ms": 11.741, "load_throughput": 1022053.706, "learn_time_ms": 245.488, "learn_throughput": 48882.274, "synch_weights_time_ms": 8.763}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5062, "training_iteration": 111, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-30", "timestamp": 1698246930, "time_this_iter_s": 2.1986799240112305, "time_total_s": 265.6031355857849, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.6031355857849, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 26.650000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548945e-35, "cur_lr": 0.0003, "total_loss": 6.657232920328776, "policy_loss": -0.00016655648748079935, "vf_loss": 6.657458941141765, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.0002893283713290747, "entropy": 0.5936200784312354, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2007.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.668999999999851, "episode_len_mean": 249.02, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 39.10000000000002, 43.50000000000001, 38.10000000000002, 40.70000000000002, 22.699999999999882, 43.7, 46.099999999999994, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 34.70000000000004, 31.300000000000004, 27.49999999999995, -50.00000000000044, 39.50000000000002, 45.3, 44.900000000000006, 23.8999999999999, 41.90000000000001, 40.30000000000002, 45.1, 43.7, 25.099999999999916, 33.30000000000003, 34.10000000000004, 39.90000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.300000000000004, 39.90000000000002, 46.3, 28.699999999999967, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.899999999999615, 45.5, 32.100000000000016, 0.49999999999956657, 44.300000000000004, -50.00000000000044, 42.900000000000006, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 30.499999999999993, 44.10000000000001, -50.00000000000044, 43.7, 42.10000000000001, 38.90000000000002, 6.699999999999655, 46.099999999999994, 37.50000000000003, -50.00000000000044, 43.10000000000001, 41.500000000000014, -50.00000000000044, 27.699999999999953, 41.70000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 22.899999999999885, 32.50000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, 38.50000000000003, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, -50.00000000000044, 42.30000000000001, 20.099999999999845, 27.099999999999945, 37.50000000000003, 39.10000000000002, 7.899999999999672], "episode_lengths": [500, 86, 110, 66, 120, 94, 274, 64, 40, 56, 500, 46, 500, 60, 154, 188, 226, 500, 106, 48, 52, 262, 82, 98, 50, 64, 250, 168, 160, 102, 212, 500, 500, 158, 58, 102, 38, 214, 500, 500, 490, 500, 52, 500, 60, 500, 462, 46, 180, 496, 58, 500, 72, 142, 500, 500, 500, 500, 228, 196, 60, 500, 64, 80, 112, 434, 40, 126, 500, 70, 86, 500, 224, 84, 238, 500, 500, 38, 500, 500, 52, 272, 176, 500, 500, 216, 116, 152, 500, 500, 500, 146, 60, 500, 78, 300, 230, 126, 110, 422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109032769341847, "mean_inference_ms": 1.3136719351730652, "mean_action_processing_ms": 0.15334768641541688, "mean_env_wait_ms": 0.09159645947529574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023260831832885742, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.12989187240600586}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.668999999999851, "episode_len_mean": 249.02, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 39.10000000000002, 43.50000000000001, 38.10000000000002, 40.70000000000002, 22.699999999999882, 43.7, 46.099999999999994, 44.5, -50.00000000000044, 45.5, -50.00000000000044, 44.10000000000001, 34.70000000000004, 31.300000000000004, 27.49999999999995, -50.00000000000044, 39.50000000000002, 45.3, 44.900000000000006, 23.8999999999999, 41.90000000000001, 40.30000000000002, 45.1, 43.7, 25.099999999999916, 33.30000000000003, 34.10000000000004, 39.90000000000002, 28.89999999999997, -50.00000000000044, -50.00000000000044, 34.30000000000004, 44.300000000000004, 39.90000000000002, 46.3, 28.699999999999967, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 3.899999999999615, 45.5, 32.100000000000016, 0.49999999999956657, 44.300000000000004, -50.00000000000044, 42.900000000000006, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 30.499999999999993, 44.10000000000001, -50.00000000000044, 43.7, 42.10000000000001, 38.90000000000002, 6.699999999999655, 46.099999999999994, 37.50000000000003, -50.00000000000044, 43.10000000000001, 41.500000000000014, -50.00000000000044, 27.699999999999953, 41.70000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 22.899999999999885, 32.50000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, 38.50000000000003, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, -50.00000000000044, 42.30000000000001, 20.099999999999845, 27.099999999999945, 37.50000000000003, 39.10000000000002, 7.899999999999672], "episode_lengths": [500, 86, 110, 66, 120, 94, 274, 64, 40, 56, 500, 46, 500, 60, 154, 188, 226, 500, 106, 48, 52, 262, 82, 98, 50, 64, 250, 168, 160, 102, 212, 500, 500, 158, 58, 102, 38, 214, 500, 500, 490, 500, 52, 500, 60, 500, 462, 46, 180, 496, 58, 500, 72, 142, 500, 500, 500, 500, 228, 196, 60, 500, 64, 80, 112, 434, 40, 126, 500, 70, 86, 500, 224, 84, 238, 500, 500, 38, 500, 500, 52, 272, 176, 500, 500, 216, 116, 152, 500, 500, 500, 146, 60, 500, 78, 300, 230, 126, 110, 422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4109032769341847, "mean_inference_ms": 1.3136719351730652, "mean_action_processing_ms": 0.15334768641541688, "mean_env_wait_ms": 0.09159645947529574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023260831832885742, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.12989187240600586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5743.94135597085, "num_env_steps_trained_throughput_per_sec": 5743.94135597085, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2195.858, "sample_time_ms": 1928.186, "load_time_ms": 11.741, "load_throughput": 1022039.179, "learn_time_ms": 245.725, "learn_throughput": 48835.025, "synch_weights_time_ms": 8.875}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5105, "training_iteration": 112, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-32", "timestamp": 1698246932, "time_this_iter_s": 2.09415602684021, "time_total_s": 267.6972916126251, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.6972916126251, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8518598887744725e-35, "cur_lr": 0.0003, "total_loss": 7.40707262357076, "policy_loss": -0.00021542789828446176, "vf_loss": 7.407348500357734, "vf_explained_var": -7.583035363091362e-07, "kl": 0.00037614999922021123, "entropy": 0.6025820126136144, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.590999999999835, "episode_len_mean": 269.76, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 30.499999999999993, 44.10000000000001, -50.00000000000044, 43.7, 42.10000000000001, 38.90000000000002, 6.699999999999655, 46.099999999999994, 37.50000000000003, -50.00000000000044, 43.10000000000001, 41.500000000000014, -50.00000000000044, 27.699999999999953, 41.70000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 22.899999999999885, 32.50000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, 38.50000000000003, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, -50.00000000000044, 42.30000000000001, 20.099999999999845, 27.099999999999945, 37.50000000000003, 39.10000000000002, 7.899999999999672, -50.00000000000044, 41.100000000000016, 34.70000000000004, 43.7, 13.699999999999754, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 35.70000000000003, 37.50000000000003, -50.00000000000044, 12.299999999999734, 33.70000000000004, 34.900000000000034, 43.10000000000001, 25.29999999999992, 38.700000000000024, 30.29999999999999, -50.00000000000044, -50.00000000000044, 23.699999999999896, 39.300000000000026, 1.8999999999995865, 19.299999999999834, 39.50000000000002, 37.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 36.30000000000003, 32.100000000000016, -50.00000000000044, 45.7, 38.90000000000002, 38.50000000000003, -50.00000000000044, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, 24.099999999999902, 33.70000000000004, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044], "episode_lengths": [500, 72, 142, 500, 500, 500, 500, 228, 196, 60, 500, 64, 80, 112, 434, 40, 126, 500, 70, 86, 500, 224, 84, 238, 500, 500, 38, 500, 500, 52, 272, 176, 500, 500, 216, 116, 152, 500, 500, 500, 146, 60, 500, 78, 300, 230, 126, 110, 422, 500, 90, 154, 64, 364, 142, 500, 500, 46, 144, 126, 500, 378, 164, 152, 70, 248, 114, 198, 500, 500, 264, 108, 482, 308, 106, 122, 88, 104, 500, 138, 180, 500, 44, 112, 116, 500, 46, 86, 500, 500, 262, 500, 104, 500, 260, 164, 500, 136, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41028552192936785, "mean_inference_ms": 1.3130594333002577, "mean_action_processing_ms": 0.15340069434607076, "mean_env_wait_ms": 0.09146119304587756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025021076202392578, "StateBufferConnector_ms": 0.00099945068359375, "ViewRequirementAgentConnector_ms": 0.1279296875}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.590999999999835, "episode_len_mean": 269.76, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 30.499999999999993, 44.10000000000001, -50.00000000000044, 43.7, 42.10000000000001, 38.90000000000002, 6.699999999999655, 46.099999999999994, 37.50000000000003, -50.00000000000044, 43.10000000000001, 41.500000000000014, -50.00000000000044, 27.699999999999953, 41.70000000000002, 26.299999999999933, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 22.899999999999885, 32.50000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, 38.50000000000003, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.10000000000001, -50.00000000000044, 42.30000000000001, 20.099999999999845, 27.099999999999945, 37.50000000000003, 39.10000000000002, 7.899999999999672, -50.00000000000044, 41.100000000000016, 34.70000000000004, 43.7, 13.699999999999754, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 35.70000000000003, 37.50000000000003, -50.00000000000044, 12.299999999999734, 33.70000000000004, 34.900000000000034, 43.10000000000001, 25.29999999999992, 38.700000000000024, 30.29999999999999, -50.00000000000044, -50.00000000000044, 23.699999999999896, 39.300000000000026, 1.8999999999995865, 19.299999999999834, 39.50000000000002, 37.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 36.30000000000003, 32.100000000000016, -50.00000000000044, 45.7, 38.90000000000002, 38.50000000000003, -50.00000000000044, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, 24.099999999999902, 33.70000000000004, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044], "episode_lengths": [500, 72, 142, 500, 500, 500, 500, 228, 196, 60, 500, 64, 80, 112, 434, 40, 126, 500, 70, 86, 500, 224, 84, 238, 500, 500, 38, 500, 500, 52, 272, 176, 500, 500, 216, 116, 152, 500, 500, 500, 146, 60, 500, 78, 300, 230, 126, 110, 422, 500, 90, 154, 64, 364, 142, 500, 500, 46, 144, 126, 500, 378, 164, 152, 70, 248, 114, 198, 500, 500, 264, 108, 482, 308, 106, 122, 88, 104, 500, 138, 180, 500, 44, 112, 116, 500, 46, 86, 500, 500, 262, 500, 104, 500, 260, 164, 500, 136, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41028552192936785, "mean_inference_ms": 1.3130594333002577, "mean_action_processing_ms": 0.15340069434607076, "mean_env_wait_ms": 0.09146119304587756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025021076202392578, "StateBufferConnector_ms": 0.00099945068359375, "ViewRequirementAgentConnector_ms": 0.1279296875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5316.945044469459, "num_env_steps_trained_throughput_per_sec": 5316.945044469459, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2189.98, "sample_time_ms": 1928.681, "load_time_ms": 11.538, "load_throughput": 1040036.864, "learn_time_ms": 239.555, "learn_throughput": 50092.801, "synch_weights_time_ms": 8.875}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5156, "training_iteration": 113, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-35", "timestamp": 1698246935, "time_this_iter_s": 2.261946439743042, "time_total_s": 269.95923805236816, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.95923805236816, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 59.73333333333334, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872362e-35, "cur_lr": 0.0003, "total_loss": 6.487131277720134, "policy_loss": -0.00039962738648884825, "vf_loss": 6.487588723500569, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.0008661658791406049, "entropy": 0.5780911842981974, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2043.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.711999999999854, "episode_len_mean": 243.58, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 34.70000000000004, 43.7, 13.699999999999754, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 35.70000000000003, 37.50000000000003, -50.00000000000044, 12.299999999999734, 33.70000000000004, 34.900000000000034, 43.10000000000001, 25.29999999999992, 38.700000000000024, 30.29999999999999, -50.00000000000044, -50.00000000000044, 23.699999999999896, 39.300000000000026, 1.8999999999995865, 19.299999999999834, 39.50000000000002, 37.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 36.30000000000003, 32.100000000000016, -50.00000000000044, 45.7, 38.90000000000002, 38.50000000000003, -50.00000000000044, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, 24.099999999999902, 33.70000000000004, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, 46.5, 45.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.099999999999994, 35.70000000000003, 40.10000000000002, -50.00000000000044, 20.299999999999848, 43.7, 41.30000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, 40.70000000000002, 43.10000000000001, 47.3, -50.00000000000044, 47.1, 46.3, 46.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 45.3, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.90000000000002, 45.5, -50.00000000000044, 38.90000000000002, 38.90000000000002, 43.10000000000001], "episode_lengths": [90, 154, 64, 364, 142, 500, 500, 46, 144, 126, 500, 378, 164, 152, 70, 248, 114, 198, 500, 500, 264, 108, 482, 308, 106, 122, 88, 104, 500, 138, 180, 500, 44, 112, 116, 500, 46, 86, 500, 500, 262, 500, 104, 500, 260, 164, 500, 136, 42, 500, 162, 500, 46, 36, 50, 70, 500, 500, 66, 40, 144, 100, 500, 298, 64, 88, 500, 108, 500, 218, 500, 162, 94, 70, 28, 500, 30, 38, 34, 124, 500, 126, 500, 60, 48, 488, 500, 130, 500, 156, 500, 500, 500, 102, 112, 46, 500, 112, 112, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4096420390207438, "mean_inference_ms": 1.3118582751023924, "mean_action_processing_ms": 0.1532820614954654, "mean_env_wait_ms": 0.09132613581369182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023168563842773438, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.12386083602905273}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.711999999999854, "episode_len_mean": 243.58, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 34.70000000000004, 43.7, 13.699999999999754, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.5, 35.70000000000003, 37.50000000000003, -50.00000000000044, 12.299999999999734, 33.70000000000004, 34.900000000000034, 43.10000000000001, 25.29999999999992, 38.700000000000024, 30.29999999999999, -50.00000000000044, -50.00000000000044, 23.699999999999896, 39.300000000000026, 1.8999999999995865, 19.299999999999834, 39.50000000000002, 37.90000000000003, 41.30000000000001, 39.70000000000002, -50.00000000000044, 36.30000000000003, 32.100000000000016, -50.00000000000044, 45.7, 38.90000000000002, 38.50000000000003, -50.00000000000044, 45.5, 41.500000000000014, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 39.70000000000002, -50.00000000000044, 24.099999999999902, 33.70000000000004, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, 46.5, 45.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.099999999999994, 35.70000000000003, 40.10000000000002, -50.00000000000044, 20.299999999999848, 43.7, 41.30000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, 40.70000000000002, 43.10000000000001, 47.3, -50.00000000000044, 47.1, 46.3, 46.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 45.3, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.90000000000002, 45.5, -50.00000000000044, 38.90000000000002, 38.90000000000002, 43.10000000000001], "episode_lengths": [90, 154, 64, 364, 142, 500, 500, 46, 144, 126, 500, 378, 164, 152, 70, 248, 114, 198, 500, 500, 264, 108, 482, 308, 106, 122, 88, 104, 500, 138, 180, 500, 44, 112, 116, 500, 46, 86, 500, 500, 262, 500, 104, 500, 260, 164, 500, 136, 42, 500, 162, 500, 46, 36, 50, 70, 500, 500, 66, 40, 144, 100, 500, 298, 64, 88, 500, 108, 500, 218, 500, 162, 94, 70, 28, 500, 30, 38, 34, 124, 500, 126, 500, 60, 48, 488, 500, 130, 500, 156, 500, 500, 500, 102, 112, 46, 500, 112, 112, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4096420390207438, "mean_inference_ms": 1.3118582751023924, "mean_action_processing_ms": 0.1532820614954654, "mean_env_wait_ms": 0.09132613581369182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023168563842773438, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.12386083602905273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5885.060911835367, "num_env_steps_trained_throughput_per_sec": 5885.060911835367, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2181.834, "sample_time_ms": 1921.031, "load_time_ms": 11.338, "load_throughput": 1058377.012, "learn_time_ms": 239.144, "learn_throughput": 50178.958, "synch_weights_time_ms": 8.89}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5206, "training_iteration": 114, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-37", "timestamp": 1698246937, "time_this_iter_s": 2.044059991836548, "time_total_s": 272.0032980442047, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.0032980442047, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936181e-36, "cur_lr": 0.0003, "total_loss": 6.321345435248481, "policy_loss": -0.0001813843846321106, "vf_loss": 6.321578714582655, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.0006627262959600304, "entropy": 0.5182736102077696, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2061.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.696999999999835, "episode_len_mean": 248.68, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, 46.5, 45.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.099999999999994, 35.70000000000003, 40.10000000000002, -50.00000000000044, 20.299999999999848, 43.7, 41.30000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, 40.70000000000002, 43.10000000000001, 47.3, -50.00000000000044, 47.1, 46.3, 46.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 45.3, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.90000000000002, 45.5, -50.00000000000044, 38.90000000000002, 38.90000000000002, 43.10000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 25.29999999999992, 43.7, -50.00000000000044, 27.899999999999956, -50.00000000000044, 47.1, 42.900000000000006, 35.30000000000004, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 16.09999999999979, 44.300000000000004, 41.100000000000016, 45.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 38.700000000000024, -50.00000000000044, 44.10000000000001, 39.50000000000002, 1.8999999999995865, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [164, 500, 136, 42, 500, 162, 500, 46, 36, 50, 70, 500, 500, 66, 40, 144, 100, 500, 298, 64, 88, 500, 108, 500, 218, 500, 162, 94, 70, 28, 500, 30, 38, 34, 124, 500, 126, 500, 60, 48, 488, 500, 130, 500, 156, 500, 500, 500, 102, 112, 46, 500, 112, 112, 70, 500, 78, 500, 500, 500, 500, 500, 124, 248, 64, 500, 222, 500, 30, 72, 148, 88, 84, 48, 500, 54, 500, 86, 500, 500, 392, 88, 340, 58, 90, 48, 68, 500, 62, 114, 500, 60, 106, 482, 500, 46, 36, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40984739412512583, "mean_inference_ms": 1.3105131227740188, "mean_action_processing_ms": 0.15293569063479684, "mean_env_wait_ms": 0.09136544041636477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021169662475585938, "StateBufferConnector_ms": 0.005005359649658203, "ViewRequirementAgentConnector_ms": 0.11786365509033203}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.696999999999835, "episode_len_mean": 248.68, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, -50.00000000000044, 36.50000000000003, 45.9, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.5, 46.5, 45.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.099999999999994, 35.70000000000003, 40.10000000000002, -50.00000000000044, 20.299999999999848, 43.7, 41.30000000000001, -50.00000000000044, 39.300000000000026, -50.00000000000044, 28.29999999999996, -50.00000000000044, 33.90000000000004, 40.70000000000002, 43.10000000000001, 47.3, -50.00000000000044, 47.1, 46.3, 46.699999999999996, 37.70000000000003, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 45.3, 1.299999999999578, -50.00000000000044, 37.10000000000003, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.90000000000002, 45.5, -50.00000000000044, 38.90000000000002, 38.90000000000002, 43.10000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.70000000000003, 25.29999999999992, 43.7, -50.00000000000044, 27.899999999999956, -50.00000000000044, 47.1, 42.900000000000006, 35.30000000000004, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 16.09999999999979, 44.300000000000004, 41.100000000000016, 45.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 38.700000000000024, -50.00000000000044, 44.10000000000001, 39.50000000000002, 1.8999999999995865, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [164, 500, 136, 42, 500, 162, 500, 46, 36, 50, 70, 500, 500, 66, 40, 144, 100, 500, 298, 64, 88, 500, 108, 500, 218, 500, 162, 94, 70, 28, 500, 30, 38, 34, 124, 500, 126, 500, 60, 48, 488, 500, 130, 500, 156, 500, 500, 500, 102, 112, 46, 500, 112, 112, 70, 500, 78, 500, 500, 500, 500, 500, 124, 248, 64, 500, 222, 500, 30, 72, 148, 88, 84, 48, 500, 54, 500, 86, 500, 500, 392, 88, 340, 58, 90, 48, 68, 500, 62, 114, 500, 60, 106, 482, 500, 46, 36, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40984739412512583, "mean_inference_ms": 1.3105131227740188, "mean_action_processing_ms": 0.15293569063479684, "mean_env_wait_ms": 0.09136544041636477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021169662475585938, "StateBufferConnector_ms": 0.005005359649658203, "ViewRequirementAgentConnector_ms": 0.11786365509033203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5281.470494566812, "num_env_steps_trained_throughput_per_sec": 5281.470494566812, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2192.194, "sample_time_ms": 1921.979, "load_time_ms": 11.758, "load_throughput": 1020576.07, "learn_time_ms": 248.153, "learn_throughput": 48357.223, "synch_weights_time_ms": 8.89}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5251, "training_iteration": 115, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-39", "timestamp": 1698246939, "time_this_iter_s": 2.2766551971435547, "time_total_s": 274.27995324134827, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.27995324134827, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8148248609680906e-36, "cur_lr": 0.0003, "total_loss": 6.93938782480028, "policy_loss": -0.00027781476577123004, "vf_loss": 6.939722140630086, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.0005152668430178488, "entropy": 0.563849969042672, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2079.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.131999999999861, "episode_len_mean": 219.4, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.70000000000003, 25.29999999999992, 43.7, -50.00000000000044, 27.899999999999956, -50.00000000000044, 47.1, 42.900000000000006, 35.30000000000004, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 16.09999999999979, 44.300000000000004, 41.100000000000016, 45.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 38.700000000000024, -50.00000000000044, 44.10000000000001, 39.50000000000002, 1.8999999999995865, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.7, 41.90000000000001, 26.299999999999933, 2.299999999999592, 42.900000000000006, 43.50000000000001, 19.69999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 45.5, 41.100000000000016, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.9, 44.10000000000001, 31.70000000000001, 45.1, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.70000000000002, 43.30000000000001, 46.3, 44.300000000000004, 45.5, -50.00000000000044, 41.70000000000002, 42.30000000000001, 35.30000000000004, 37.70000000000003, 45.5, 13.099999999999746, 44.900000000000006, 43.30000000000001, 38.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.900000000000006, 41.30000000000001, 41.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.099999999999987], "episode_lengths": [500, 500, 124, 248, 64, 500, 222, 500, 30, 72, 148, 88, 84, 48, 500, 54, 500, 86, 500, 500, 392, 88, 340, 58, 90, 48, 68, 500, 62, 114, 500, 60, 106, 482, 500, 46, 36, 500, 500, 58, 500, 88, 84, 64, 82, 238, 478, 72, 66, 304, 500, 38, 500, 500, 46, 500, 94, 46, 90, 52, 500, 36, 500, 194, 42, 60, 184, 50, 40, 42, 500, 500, 52, 94, 68, 38, 58, 46, 500, 84, 78, 148, 124, 46, 370, 52, 68, 118, 500, 60, 500, 52, 88, 86, 158, 500, 500, 500, 46, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40963109050129054, "mean_inference_ms": 1.31052680561527, "mean_action_processing_ms": 0.15304265142080561, "mean_env_wait_ms": 0.09125397542074598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016993284225463867, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.12083935737609863}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.131999999999861, "episode_len_mean": 219.4, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.70000000000003, 25.29999999999992, 43.7, -50.00000000000044, 27.899999999999956, -50.00000000000044, 47.1, 42.900000000000006, 35.30000000000004, 41.30000000000001, 41.70000000000002, 45.3, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 10.899999999999714, 41.30000000000001, 16.09999999999979, 44.300000000000004, 41.100000000000016, 45.3, 43.30000000000001, -50.00000000000044, 43.900000000000006, 38.700000000000024, -50.00000000000044, 44.10000000000001, 39.50000000000002, 1.8999999999995865, -50.00000000000044, 45.5, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.7, 41.90000000000001, 26.299999999999933, 2.299999999999592, 42.900000000000006, 43.50000000000001, 19.69999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 45.5, 41.100000000000016, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.9, 44.10000000000001, 31.70000000000001, 45.1, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.70000000000002, 43.30000000000001, 46.3, 44.300000000000004, 45.5, -50.00000000000044, 41.70000000000002, 42.30000000000001, 35.30000000000004, 37.70000000000003, 45.5, 13.099999999999746, 44.900000000000006, 43.30000000000001, 38.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.900000000000006, 41.30000000000001, 41.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.099999999999987], "episode_lengths": [500, 500, 124, 248, 64, 500, 222, 500, 30, 72, 148, 88, 84, 48, 500, 54, 500, 86, 500, 500, 392, 88, 340, 58, 90, 48, 68, 500, 62, 114, 500, 60, 106, 482, 500, 46, 36, 500, 500, 58, 500, 88, 84, 64, 82, 238, 478, 72, 66, 304, 500, 38, 500, 500, 46, 500, 94, 46, 90, 52, 500, 36, 500, 194, 42, 60, 184, 50, 40, 42, 500, 500, 52, 94, 68, 38, 58, 46, 500, 84, 78, 148, 124, 46, 370, 52, 68, 118, 500, 60, 500, 52, 88, 86, 158, 500, 500, 500, 46, 200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40963109050129054, "mean_inference_ms": 1.31052680561527, "mean_action_processing_ms": 0.15304265142080561, "mean_env_wait_ms": 0.09125397542074598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016993284225463867, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.12083935737609863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5744.073116358351, "num_env_steps_trained_throughput_per_sec": 5744.073116358351, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2189.659, "sample_time_ms": 1917.925, "load_time_ms": 11.86, "load_throughput": 1011778.867, "learn_time_ms": 249.67, "learn_throughput": 48063.438, "synch_weights_time_ms": 8.99}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5311, "training_iteration": 116, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-41", "timestamp": 1698246941, "time_this_iter_s": 2.094109058380127, "time_total_s": 276.3740622997284, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.3740622997284, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840453e-36, "cur_lr": 0.0003, "total_loss": 6.2234371768103705, "policy_loss": -0.00012050227572520573, "vf_loss": 6.223602877722846, "vf_explained_var": -9.669197930230034e-07, "kl": 0.00014869538211491494, "entropy": 0.45309590962198043, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2097.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.606999999999843, "episode_len_mean": 239.6, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.7, 41.90000000000001, 26.299999999999933, 2.299999999999592, 42.900000000000006, 43.50000000000001, 19.69999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 45.5, 41.100000000000016, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.9, 44.10000000000001, 31.70000000000001, 45.1, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.70000000000002, 43.30000000000001, 46.3, 44.300000000000004, 45.5, -50.00000000000044, 41.70000000000002, 42.30000000000001, 35.30000000000004, 37.70000000000003, 45.5, 13.099999999999746, 44.900000000000006, 43.30000000000001, 38.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.900000000000006, 41.30000000000001, 41.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.099999999999987, -50.00000000000044, 41.70000000000002, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 45.7, -50.00000000000044, 43.10000000000001, 34.50000000000004, 39.50000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 44.10000000000001, 47.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.499999999999694, 41.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 58, 500, 88, 84, 64, 82, 238, 478, 72, 66, 304, 500, 38, 500, 500, 46, 500, 94, 46, 90, 52, 500, 36, 500, 194, 42, 60, 184, 50, 40, 42, 500, 500, 52, 94, 68, 38, 58, 46, 500, 84, 78, 148, 124, 46, 370, 52, 68, 118, 500, 60, 500, 52, 88, 86, 158, 500, 500, 500, 46, 200, 500, 84, 82, 500, 472, 44, 500, 70, 156, 106, 130, 500, 500, 114, 500, 500, 98, 76, 500, 500, 320, 52, 60, 24, 500, 124, 500, 96, 92, 500, 500, 500, 86, 500, 406, 86, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4091680813664369, "mean_inference_ms": 1.309439763224818, "mean_action_processing_ms": 0.15292196570576472, "mean_env_wait_ms": 0.09117418994316885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02051687240600586, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.13128089904785156}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.606999999999843, "episode_len_mean": 239.6, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 41.30000000000001, 41.70000000000002, 43.7, 41.90000000000001, 26.299999999999933, 2.299999999999592, 42.900000000000006, 43.50000000000001, 19.69999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 40.70000000000002, 45.5, 41.100000000000016, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 30.699999999999996, 45.9, 44.10000000000001, 31.70000000000001, 45.1, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.70000000000002, 43.30000000000001, 46.3, 44.300000000000004, 45.5, -50.00000000000044, 41.70000000000002, 42.30000000000001, 35.30000000000004, 37.70000000000003, 45.5, 13.099999999999746, 44.900000000000006, 43.30000000000001, 38.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.900000000000006, 41.30000000000001, 41.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.099999999999987, -50.00000000000044, 41.70000000000002, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 45.7, -50.00000000000044, 43.10000000000001, 34.50000000000004, 39.50000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 44.10000000000001, 47.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.499999999999694, 41.500000000000014, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 58, 500, 88, 84, 64, 82, 238, 478, 72, 66, 304, 500, 38, 500, 500, 46, 500, 94, 46, 90, 52, 500, 36, 500, 194, 42, 60, 184, 50, 40, 42, 500, 500, 52, 94, 68, 38, 58, 46, 500, 84, 78, 148, 124, 46, 370, 52, 68, 118, 500, 60, 500, 52, 88, 86, 158, 500, 500, 500, 46, 200, 500, 84, 82, 500, 472, 44, 500, 70, 156, 106, 130, 500, 500, 114, 500, 500, 98, 76, 500, 500, 320, 52, 60, 24, 500, 124, 500, 96, 92, 500, 500, 500, 86, 500, 406, 86, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4091680813664369, "mean_inference_ms": 1.309439763224818, "mean_action_processing_ms": 0.15292196570576472, "mean_env_wait_ms": 0.09117418994316885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02051687240600586, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.13128089904785156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5336.041164518661, "num_env_steps_trained_throughput_per_sec": 5336.041164518661, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2187.575, "sample_time_ms": 1919.066, "load_time_ms": 11.942, "load_throughput": 1004896.499, "learn_time_ms": 246.265, "learn_throughput": 48728.028, "synch_weights_time_ms": 9.09}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5349, "training_iteration": 117, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-44", "timestamp": 1698246944, "time_this_iter_s": 2.2538564205169678, "time_total_s": 278.62791872024536, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 278.62791872024536, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420226e-36, "cur_lr": 0.0003, "total_loss": 6.649637593163384, "policy_loss": -0.00014633499085903168, "vf_loss": 6.64983966615465, "vf_explained_var": -9.205606248643663e-07, "kl": 0.0004964503772113302, "entropy": 0.5580290026134915, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.715999999999808, "episode_len_mean": 273.42, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 43.30000000000001, 38.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.900000000000006, 41.30000000000001, 41.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.099999999999987, -50.00000000000044, 41.70000000000002, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 45.7, -50.00000000000044, 43.10000000000001, 34.50000000000004, 39.50000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 44.10000000000001, 47.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.499999999999694, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 38.50000000000003, 15.099999999999774, 42.900000000000006, 44.300000000000004, 42.500000000000014, 42.30000000000001, 44.5, 44.5, -50.00000000000044, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, 41.500000000000014, 45.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.1], "episode_lengths": [52, 68, 118, 500, 60, 500, 52, 88, 86, 158, 500, 500, 500, 46, 200, 500, 84, 82, 500, 472, 44, 500, 70, 156, 106, 130, 500, 500, 114, 500, 500, 98, 76, 500, 500, 320, 52, 60, 24, 500, 124, 500, 96, 92, 500, 500, 500, 86, 500, 406, 86, 500, 500, 500, 86, 58, 500, 146, 500, 44, 116, 350, 72, 58, 76, 78, 56, 56, 500, 94, 62, 500, 500, 374, 86, 48, 500, 148, 500, 36, 500, 126, 500, 500, 74, 500, 500, 48, 48, 50, 500, 500, 500, 500, 500, 500, 80, 116, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40947381996922816, "mean_inference_ms": 1.307748231680366, "mean_action_processing_ms": 0.15248555156291996, "mean_env_wait_ms": 0.09124359780026625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025219440460205078, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.09992218017578125}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.715999999999808, "episode_len_mean": 273.42, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 43.30000000000001, 38.300000000000026, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.900000000000006, 41.30000000000001, 41.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 30.099999999999987, -50.00000000000044, 41.70000000000002, 41.90000000000001, -50.00000000000044, 2.8999999999996007, 45.7, -50.00000000000044, 43.10000000000001, 34.50000000000004, 39.50000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.099999999999817, 44.900000000000006, 44.10000000000001, 47.7, -50.00000000000044, 37.70000000000003, -50.00000000000044, 40.500000000000014, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.499999999999694, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 38.50000000000003, 15.099999999999774, 42.900000000000006, 44.300000000000004, 42.500000000000014, 42.30000000000001, 44.5, 44.5, -50.00000000000044, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, 41.500000000000014, 45.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.1], "episode_lengths": [52, 68, 118, 500, 60, 500, 52, 88, 86, 158, 500, 500, 500, 46, 200, 500, 84, 82, 500, 472, 44, 500, 70, 156, 106, 130, 500, 500, 114, 500, 500, 98, 76, 500, 500, 320, 52, 60, 24, 500, 124, 500, 96, 92, 500, 500, 500, 86, 500, 406, 86, 500, 500, 500, 86, 58, 500, 146, 500, 44, 116, 350, 72, 58, 76, 78, 56, 56, 500, 94, 62, 500, 500, 374, 86, 48, 500, 148, 500, 36, 500, 126, 500, 500, 74, 500, 500, 48, 48, 50, 500, 500, 500, 500, 500, 500, 80, 116, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40947381996922816, "mean_inference_ms": 1.307748231680366, "mean_action_processing_ms": 0.15248555156291996, "mean_env_wait_ms": 0.09124359780026625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025219440460205078, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.09992218017578125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5811.194212688055, "num_env_steps_trained_throughput_per_sec": 5811.194212688055, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2178.911, "sample_time_ms": 1912.046, "load_time_ms": 11.741, "load_throughput": 1022068.234, "learn_time_ms": 244.935, "learn_throughput": 48992.592, "synch_weights_time_ms": 9.089}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5396, "training_iteration": 118, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-46", "timestamp": 1698246946, "time_this_iter_s": 2.0702292919158936, "time_total_s": 280.69814801216125, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 280.69814801216125, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 56.199999999999996, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210113e-37, "cur_lr": 0.0003, "total_loss": 6.756668885548909, "policy_loss": -0.000310691280497445, "vf_loss": 6.757037003835042, "vf_explained_var": -9.735425313313801e-07, "kl": 0.0003334830525921638, "entropy": 0.5734711587429047, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2133.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.947000000000218, "episode_len_mean": 295.0, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.499999999999694, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 38.50000000000003, 15.099999999999774, 42.900000000000006, 44.300000000000004, 42.500000000000014, 42.30000000000001, 44.5, 44.5, -50.00000000000044, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, 41.500000000000014, 45.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 12.499999999999737, -50.00000000000044, 45.5, -50.00000000000044, 43.10000000000001, 21.299999999999862, 41.70000000000002, 32.90000000000003, 37.50000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.7, 45.9, 42.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, 15.699999999999783, 41.30000000000001, 36.50000000000003, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 96, 92, 500, 500, 500, 86, 500, 406, 86, 500, 500, 500, 86, 58, 500, 146, 500, 44, 116, 350, 72, 58, 76, 78, 56, 56, 500, 94, 62, 500, 500, 374, 86, 48, 500, 148, 500, 36, 500, 126, 500, 500, 74, 500, 500, 48, 48, 50, 500, 500, 500, 500, 500, 500, 80, 116, 500, 50, 376, 500, 46, 500, 70, 288, 84, 172, 126, 500, 76, 500, 500, 500, 500, 500, 500, 500, 500, 250, 500, 44, 42, 78, 72, 500, 500, 66, 500, 50, 344, 88, 136, 46, 72, 500, 500, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40907155290050434, "mean_inference_ms": 1.306990224399283, "mean_action_processing_ms": 0.1526103064160262, "mean_env_wait_ms": 0.09115998141537549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022699832916259766, "StateBufferConnector_ms": 0.003019094467163086, "ViewRequirementAgentConnector_ms": 0.10664582252502441}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.947000000000218, "episode_len_mean": 295.0, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 9.499999999999694, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 38.50000000000003, 15.099999999999774, 42.900000000000006, 44.300000000000004, 42.500000000000014, 42.30000000000001, 44.5, 44.5, -50.00000000000044, 40.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 12.69999999999974, 41.500000000000014, 45.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.3, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 12.499999999999737, -50.00000000000044, 45.5, -50.00000000000044, 43.10000000000001, 21.299999999999862, 41.70000000000002, 32.90000000000003, 37.50000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.7, 45.9, 42.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, 15.699999999999783, 41.30000000000001, 36.50000000000003, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 96, 92, 500, 500, 500, 86, 500, 406, 86, 500, 500, 500, 86, 58, 500, 146, 500, 44, 116, 350, 72, 58, 76, 78, 56, 56, 500, 94, 62, 500, 500, 374, 86, 48, 500, 148, 500, 36, 500, 126, 500, 500, 74, 500, 500, 48, 48, 50, 500, 500, 500, 500, 500, 500, 80, 116, 500, 50, 376, 500, 46, 500, 70, 288, 84, 172, 126, 500, 76, 500, 500, 500, 500, 500, 500, 500, 500, 250, 500, 44, 42, 78, 72, 500, 500, 66, 500, 50, 344, 88, 136, 46, 72, 500, 500, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40907155290050434, "mean_inference_ms": 1.306990224399283, "mean_action_processing_ms": 0.1526103064160262, "mean_env_wait_ms": 0.09115998141537549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022699832916259766, "StateBufferConnector_ms": 0.003019094467163086, "ViewRequirementAgentConnector_ms": 0.10664582252502441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5277.948116731848, "num_env_steps_trained_throughput_per_sec": 5277.948116731848, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2172.685, "sample_time_ms": 1911.25, "load_time_ms": 12.002, "load_throughput": 999855.936, "learn_time_ms": 239.033, "learn_throughput": 50202.347, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5437, "training_iteration": 119, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-48", "timestamp": 1698246948, "time_this_iter_s": 2.277621030807495, "time_total_s": 282.97576904296875, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 282.97576904296875, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0092655381050566e-37, "cur_lr": 0.0003, "total_loss": 7.112113687727186, "policy_loss": -0.00013004072631398836, "vf_loss": 7.112299839655559, "vf_explained_var": -7.351239522298177e-07, "kl": 0.00025056175511571784, "entropy": 0.5610172847906748, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2151.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.68399999999981, "episode_len_mean": 273.78, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 12.499999999999737, -50.00000000000044, 45.5, -50.00000000000044, 43.10000000000001, 21.299999999999862, 41.70000000000002, 32.90000000000003, 37.50000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.7, 45.9, 42.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, 15.699999999999783, 41.30000000000001, 36.50000000000003, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 46.5, 13.099999999999746, 45.1, 42.30000000000001, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.099999999999945, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 8.699999999999683, -50.00000000000044, 7.499999999999666, 39.90000000000002, 45.1, 47.3, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, 43.7, 25.899999999999928, 42.900000000000006, 24.099999999999902, 42.900000000000006, 30.099999999999987, 33.90000000000004, 41.500000000000014, 11.899999999999729, 46.5, 47.1, 45.1, 40.90000000000002, -50.00000000000044, 44.900000000000006, 42.70000000000001, 39.10000000000002, 45.7], "episode_lengths": [500, 500, 500, 500, 80, 116, 500, 50, 376, 500, 46, 500, 70, 288, 84, 172, 126, 500, 76, 500, 500, 500, 500, 500, 500, 500, 500, 250, 500, 44, 42, 78, 72, 500, 500, 66, 500, 50, 344, 88, 136, 46, 72, 500, 500, 500, 500, 72, 500, 298, 500, 232, 68, 500, 36, 370, 50, 78, 500, 300, 500, 62, 500, 500, 74, 230, 112, 110, 500, 500, 500, 122, 414, 500, 426, 102, 50, 28, 500, 296, 48, 500, 64, 242, 72, 260, 72, 200, 162, 86, 382, 36, 30, 50, 92, 500, 52, 74, 110, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40908302069419106, "mean_inference_ms": 1.3053303712663962, "mean_action_processing_ms": 0.1524813863151673, "mean_env_wait_ms": 0.09103560345928935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022794485092163086, "StateBufferConnector_ms": 0.004019260406494141, "ViewRequirementAgentConnector_ms": 0.13271021842956543}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.68399999999981, "episode_len_mean": 273.78, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 12.499999999999737, -50.00000000000044, 45.5, -50.00000000000044, 43.10000000000001, 21.299999999999862, 41.70000000000002, 32.90000000000003, 37.50000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 45.7, 45.9, 42.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.1, 15.699999999999783, 41.30000000000001, 36.50000000000003, 45.5, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 46.5, 13.099999999999746, 45.1, 42.30000000000001, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.099999999999945, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 8.699999999999683, -50.00000000000044, 7.499999999999666, 39.90000000000002, 45.1, 47.3, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, 43.7, 25.899999999999928, 42.900000000000006, 24.099999999999902, 42.900000000000006, 30.099999999999987, 33.90000000000004, 41.500000000000014, 11.899999999999729, 46.5, 47.1, 45.1, 40.90000000000002, -50.00000000000044, 44.900000000000006, 42.70000000000001, 39.10000000000002, 45.7], "episode_lengths": [500, 500, 500, 500, 80, 116, 500, 50, 376, 500, 46, 500, 70, 288, 84, 172, 126, 500, 76, 500, 500, 500, 500, 500, 500, 500, 500, 250, 500, 44, 42, 78, 72, 500, 500, 66, 500, 50, 344, 88, 136, 46, 72, 500, 500, 500, 500, 72, 500, 298, 500, 232, 68, 500, 36, 370, 50, 78, 500, 300, 500, 62, 500, 500, 74, 230, 112, 110, 500, 500, 500, 122, 414, 500, 426, 102, 50, 28, 500, 296, 48, 500, 64, 242, 72, 260, 72, 200, 162, 86, 382, 36, 30, 50, 92, 500, 52, 74, 110, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40908302069419106, "mean_inference_ms": 1.3053303712663962, "mean_action_processing_ms": 0.1524813863151673, "mean_env_wait_ms": 0.09103560345928935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022794485092163086, "StateBufferConnector_ms": 0.004019260406494141, "ViewRequirementAgentConnector_ms": 0.13271021842956543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5699.3730668428625, "num_env_steps_trained_throughput_per_sec": 5699.3730668428625, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2163.23, "sample_time_ms": 1905.956, "load_time_ms": 11.676, "load_throughput": 1027723.91, "learn_time_ms": 235.151, "learn_throughput": 51031.09, "synch_weights_time_ms": 9.248}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5488, "training_iteration": 120, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-50", "timestamp": 1698246950, "time_this_iter_s": 2.1104934215545654, "time_total_s": 285.0862624645233, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 285.0862624645233, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 56.300000000000004, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525283e-37, "cur_lr": 0.0003, "total_loss": 6.3174519538879395, "policy_loss": -0.00014999085882057747, "vf_loss": 6.317654662662083, "vf_explained_var": -7.483694288465712e-07, "kl": 0.000995831400827127, "entropy": 0.5266068660550647, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2169.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.379999999999855, "episode_len_mean": 236.92, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 46.5, 13.099999999999746, 45.1, 42.30000000000001, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.099999999999945, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 8.699999999999683, -50.00000000000044, 7.499999999999666, 39.90000000000002, 45.1, 47.3, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, 43.7, 25.899999999999928, 42.900000000000006, 24.099999999999902, 42.900000000000006, 30.099999999999987, 33.90000000000004, 41.500000000000014, 11.899999999999729, 46.5, 47.1, 45.1, 40.90000000000002, -50.00000000000044, 44.900000000000006, 42.70000000000001, 39.10000000000002, 45.7, -50.00000000000044, 44.900000000000006, 44.300000000000004, 38.700000000000024, 31.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.70000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.50000000000001, 45.3, 44.300000000000004, 23.29999999999989, 44.300000000000004, 29.299999999999976, -50.00000000000044, 29.099999999999973, 13.299999999999748, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 36.30000000000003, 1.4999999999995808, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 43.7, 42.10000000000001, 29.69999999999998, 41.100000000000016, 43.900000000000006, 35.900000000000034, 45.5, 43.7], "episode_lengths": [500, 72, 500, 298, 500, 232, 68, 500, 36, 370, 50, 78, 500, 300, 500, 62, 500, 500, 74, 230, 112, 110, 500, 500, 500, 122, 414, 500, 426, 102, 50, 28, 500, 296, 48, 500, 64, 242, 72, 260, 72, 200, 162, 86, 382, 36, 30, 50, 92, 500, 52, 74, 110, 44, 500, 52, 58, 114, 184, 52, 500, 500, 500, 500, 64, 104, 214, 60, 500, 500, 154, 66, 48, 58, 268, 58, 208, 500, 210, 368, 34, 84, 500, 500, 114, 500, 138, 486, 500, 90, 500, 48, 64, 80, 204, 90, 62, 142, 46, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40863145841799986, "mean_inference_ms": 1.3044196280421827, "mean_action_processing_ms": 0.15232394233693022, "mean_env_wait_ms": 0.09097612236723929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02679276466369629, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.14054393768310547}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.379999999999855, "episode_len_mean": 236.92, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, -50.00000000000044, 20.299999999999848, -50.00000000000044, 26.89999999999994, 43.30000000000001, -50.00000000000044, 46.5, 13.099999999999746, 45.1, 42.30000000000001, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 27.099999999999945, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 8.699999999999683, -50.00000000000044, 7.499999999999666, 39.90000000000002, 45.1, 47.3, -50.00000000000044, 20.49999999999985, 45.3, -50.00000000000044, 43.7, 25.899999999999928, 42.900000000000006, 24.099999999999902, 42.900000000000006, 30.099999999999987, 33.90000000000004, 41.500000000000014, 11.899999999999729, 46.5, 47.1, 45.1, 40.90000000000002, -50.00000000000044, 44.900000000000006, 42.70000000000001, 39.10000000000002, 45.7, -50.00000000000044, 44.900000000000006, 44.300000000000004, 38.700000000000024, 31.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.70000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.50000000000001, 45.3, 44.300000000000004, 23.29999999999989, 44.300000000000004, 29.299999999999976, -50.00000000000044, 29.099999999999973, 13.299999999999748, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 36.30000000000003, 1.4999999999995808, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 43.7, 42.10000000000001, 29.69999999999998, 41.100000000000016, 43.900000000000006, 35.900000000000034, 45.5, 43.7], "episode_lengths": [500, 72, 500, 298, 500, 232, 68, 500, 36, 370, 50, 78, 500, 300, 500, 62, 500, 500, 74, 230, 112, 110, 500, 500, 500, 122, 414, 500, 426, 102, 50, 28, 500, 296, 48, 500, 64, 242, 72, 260, 72, 200, 162, 86, 382, 36, 30, 50, 92, 500, 52, 74, 110, 44, 500, 52, 58, 114, 184, 52, 500, 500, 500, 500, 64, 104, 214, 60, 500, 500, 154, 66, 48, 58, 268, 58, 208, 500, 210, 368, 34, 84, 500, 500, 114, 500, 138, 486, 500, 90, 500, 48, 64, 80, 204, 90, 62, 142, 46, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40863145841799986, "mean_inference_ms": 1.3044196280421827, "mean_action_processing_ms": 0.15232394233693022, "mean_env_wait_ms": 0.09097612236723929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02679276466369629, "StateBufferConnector_ms": 0.004995822906494141, "ViewRequirementAgentConnector_ms": 0.14054393768310547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5362.001327832233, "num_env_steps_trained_throughput_per_sec": 5362.001327832233, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2167.627, "sample_time_ms": 1905.053, "load_time_ms": 12.069, "load_throughput": 994297.703, "learn_time_ms": 240.013, "learn_throughput": 49997.316, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5534, "training_iteration": 121, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-52", "timestamp": 1698246952, "time_this_iter_s": 2.2429697513580322, "time_total_s": 287.32923221588135, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 287.32923221588135, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 60.73333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262642e-38, "cur_lr": 0.0003, "total_loss": 7.070721732245551, "policy_loss": -2.6397319339189886e-05, "vf_loss": 7.070798211627537, "vf_explained_var": -1.099374559190538e-06, "kl": 7.491415509422141e-05, "entropy": 0.5015922553009458, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2187.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.975999999999843, "episode_len_mean": 240.92, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 44.900000000000006, 44.300000000000004, 38.700000000000024, 31.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.70000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.50000000000001, 45.3, 44.300000000000004, 23.29999999999989, 44.300000000000004, 29.299999999999976, -50.00000000000044, 29.099999999999973, 13.299999999999748, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 36.30000000000003, 1.4999999999995808, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 43.7, 42.10000000000001, 29.69999999999998, 41.100000000000016, 43.900000000000006, 35.900000000000034, 45.5, 43.7, -50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.30000000000001, 43.900000000000006, 32.90000000000003, -50.00000000000044, 20.49999999999985, 21.09999999999986, 0.2999999999995637, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 46.099999999999994, 29.49999999999998, -50.00000000000044, 40.500000000000014, 42.70000000000001, 37.90000000000003, 44.300000000000004, 12.499999999999737, 45.1, -50.00000000000044, 43.900000000000006, 44.900000000000006, 40.90000000000002, 42.70000000000001, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 31.300000000000004, 26.499999999999936, 46.9, 45.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [44, 500, 52, 58, 114, 184, 52, 500, 500, 500, 500, 64, 104, 214, 60, 500, 500, 154, 66, 48, 58, 268, 58, 208, 500, 210, 368, 34, 84, 500, 500, 114, 500, 138, 486, 500, 90, 500, 48, 64, 80, 204, 90, 62, 142, 46, 64, 500, 80, 56, 500, 92, 500, 88, 62, 172, 500, 296, 290, 498, 500, 48, 44, 500, 40, 206, 500, 96, 74, 122, 58, 376, 50, 500, 62, 52, 92, 74, 500, 70, 50, 500, 188, 236, 32, 42, 500, 30, 500, 500, 500, 500, 500, 70, 84, 68, 500, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40762122973075166, "mean_inference_ms": 1.3047531540752357, "mean_action_processing_ms": 0.15254971273094184, "mean_env_wait_ms": 0.0909127011799295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299642562866211, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.13750123977661133}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.975999999999843, "episode_len_mean": 240.92, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 44.900000000000006, 44.300000000000004, 38.700000000000024, 31.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.70000000000002, 28.699999999999967, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.50000000000001, 45.3, 44.300000000000004, 23.29999999999989, 44.300000000000004, 29.299999999999976, -50.00000000000044, 29.099999999999973, 13.299999999999748, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 36.30000000000003, 1.4999999999995808, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.3, 43.7, 42.10000000000001, 29.69999999999998, 41.100000000000016, 43.900000000000006, 35.900000000000034, 45.5, 43.7, -50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.30000000000001, 43.900000000000006, 32.90000000000003, -50.00000000000044, 20.49999999999985, 21.09999999999986, 0.2999999999995637, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 46.099999999999994, 29.49999999999998, -50.00000000000044, 40.500000000000014, 42.70000000000001, 37.90000000000003, 44.300000000000004, 12.499999999999737, 45.1, -50.00000000000044, 43.900000000000006, 44.900000000000006, 40.90000000000002, 42.70000000000001, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 31.300000000000004, 26.499999999999936, 46.9, 45.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [44, 500, 52, 58, 114, 184, 52, 500, 500, 500, 500, 64, 104, 214, 60, 500, 500, 154, 66, 48, 58, 268, 58, 208, 500, 210, 368, 34, 84, 500, 500, 114, 500, 138, 486, 500, 90, 500, 48, 64, 80, 204, 90, 62, 142, 46, 64, 500, 80, 56, 500, 92, 500, 88, 62, 172, 500, 296, 290, 498, 500, 48, 44, 500, 40, 206, 500, 96, 74, 122, 58, 376, 50, 500, 62, 52, 92, 74, 500, 70, 50, 500, 188, 236, 32, 42, 500, 30, 500, 500, 500, 500, 500, 70, 84, 68, 500, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40762122973075166, "mean_inference_ms": 1.3047531540752357, "mean_action_processing_ms": 0.15254971273094184, "mean_env_wait_ms": 0.0909127011799295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299642562866211, "StateBufferConnector_ms": 0.005995988845825195, "ViewRequirementAgentConnector_ms": 0.13750123977661133}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5625.794423235235, "num_env_steps_trained_throughput_per_sec": 5625.794423235235, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2172.015, "sample_time_ms": 1908.41, "load_time_ms": 12.169, "load_throughput": 986131.29, "learn_time_ms": 240.557, "learn_throughput": 49884.306, "synch_weights_time_ms": 9.78}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5587, "training_iteration": 122, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-54", "timestamp": 1698246954, "time_this_iter_s": 2.138031005859375, "time_total_s": 289.4672632217407, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 289.4672632217407, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 56.150000000000006, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.761581922631321e-38, "cur_lr": 0.0003, "total_loss": 6.362438387340969, "policy_loss": -1.5718448493215772e-05, "vf_loss": 6.362510522206624, "vf_explained_var": -9.338061014811198e-07, "kl": 8.380501775680689e-05, "entropy": 0.5663132336404588, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.616999999999843, "episode_len_mean": 239.52, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.30000000000001, 43.900000000000006, 32.90000000000003, -50.00000000000044, 20.49999999999985, 21.09999999999986, 0.2999999999995637, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 46.099999999999994, 29.49999999999998, -50.00000000000044, 40.500000000000014, 42.70000000000001, 37.90000000000003, 44.300000000000004, 12.499999999999737, 45.1, -50.00000000000044, 43.900000000000006, 44.900000000000006, 40.90000000000002, 42.70000000000001, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 31.300000000000004, 26.499999999999936, 46.9, 45.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 44.10000000000001, 42.10000000000001, 45.5, 34.30000000000004, -50.00000000000044, 31.300000000000004, 44.5, 21.299999999999862, 23.699999999999896, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 8.299999999999677, 32.50000000000002, 45.7, 42.70000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.499999999999652, 36.70000000000003, 44.900000000000006, 35.70000000000003, 43.10000000000001, 44.5, 37.90000000000003, 43.7, 43.900000000000006, 35.10000000000004, 41.100000000000016, -50.00000000000044, 46.699999999999996, 6.099999999999646, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 80, 56, 500, 92, 500, 88, 62, 172, 500, 296, 290, 498, 500, 48, 44, 500, 40, 206, 500, 96, 74, 122, 58, 376, 50, 500, 62, 52, 92, 74, 500, 70, 50, 500, 188, 236, 32, 42, 500, 30, 500, 500, 500, 500, 500, 70, 84, 68, 500, 500, 64, 500, 500, 64, 64, 60, 80, 46, 158, 500, 188, 56, 288, 264, 500, 500, 124, 46, 46, 500, 500, 500, 90, 92, 418, 176, 44, 74, 500, 126, 500, 92, 500, 436, 134, 52, 144, 70, 56, 122, 64, 62, 150, 90, 500, 34, 440, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4075798933651975, "mean_inference_ms": 1.305171732081203, "mean_action_processing_ms": 0.1525067304085151, "mean_env_wait_ms": 0.09090927376481711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997493743896484, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13010549545288086}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.616999999999843, "episode_len_mean": 239.52, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 44.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.30000000000001, 43.900000000000006, 32.90000000000003, -50.00000000000044, 20.49999999999985, 21.09999999999986, 0.2999999999995637, -50.00000000000044, 45.3, 45.7, -50.00000000000044, 46.099999999999994, 29.49999999999998, -50.00000000000044, 40.500000000000014, 42.70000000000001, 37.90000000000003, 44.300000000000004, 12.499999999999737, 45.1, -50.00000000000044, 43.900000000000006, 44.900000000000006, 40.90000000000002, 42.70000000000001, -50.00000000000044, 43.10000000000001, 45.1, -50.00000000000044, 31.300000000000004, 26.499999999999936, 46.9, 45.9, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 44.10000000000001, 42.10000000000001, 45.5, 34.30000000000004, -50.00000000000044, 31.300000000000004, 44.5, 21.299999999999862, 23.699999999999896, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 8.299999999999677, 32.50000000000002, 45.7, 42.70000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.499999999999652, 36.70000000000003, 44.900000000000006, 35.70000000000003, 43.10000000000001, 44.5, 37.90000000000003, 43.7, 43.900000000000006, 35.10000000000004, 41.100000000000016, -50.00000000000044, 46.699999999999996, 6.099999999999646, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 80, 56, 500, 92, 500, 88, 62, 172, 500, 296, 290, 498, 500, 48, 44, 500, 40, 206, 500, 96, 74, 122, 58, 376, 50, 500, 62, 52, 92, 74, 500, 70, 50, 500, 188, 236, 32, 42, 500, 30, 500, 500, 500, 500, 500, 70, 84, 68, 500, 500, 64, 500, 500, 64, 64, 60, 80, 46, 158, 500, 188, 56, 288, 264, 500, 500, 124, 46, 46, 500, 500, 500, 90, 92, 418, 176, 44, 74, 500, 126, 500, 92, 500, 436, 134, 52, 144, 70, 56, 122, 64, 62, 150, 90, 500, 34, 440, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4075798933651975, "mean_inference_ms": 1.305171732081203, "mean_action_processing_ms": 0.1525067304085151, "mean_env_wait_ms": 0.09090927376481711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997493743896484, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13010549545288086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5393.529712253413, "num_env_steps_trained_throughput_per_sec": 5393.529712253413, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2168.81, "sample_time_ms": 1908.078, "load_time_ms": 12.169, "load_throughput": 986139.019, "learn_time_ms": 237.586, "learn_throughput": 50507.976, "synch_weights_time_ms": 9.778}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5634, "training_iteration": 123, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-57", "timestamp": 1698246957, "time_this_iter_s": 2.229887008666992, "time_total_s": 291.6971502304077, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 291.6971502304077, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 61.03333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156604e-38, "cur_lr": 0.0003, "total_loss": 6.226471583048503, "policy_loss": 7.472104496426053e-06, "vf_loss": 6.226515955395168, "vf_explained_var": -1.079506344265408e-06, "kl": 4.191382828366841e-05, "entropy": 0.518272610174285, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2223.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.09899999999984, "episode_len_mean": 244.68, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 44.10000000000001, 42.10000000000001, 45.5, 34.30000000000004, -50.00000000000044, 31.300000000000004, 44.5, 21.299999999999862, 23.699999999999896, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 8.299999999999677, 32.50000000000002, 45.7, 42.70000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.499999999999652, 36.70000000000003, 44.900000000000006, 35.70000000000003, 43.10000000000001, 44.5, 37.90000000000003, 43.7, 43.900000000000006, 35.10000000000004, 41.100000000000016, -50.00000000000044, 46.699999999999996, 6.099999999999646, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 38.300000000000026, 41.90000000000001, 43.900000000000006, 39.70000000000002, 38.90000000000002, -50.00000000000044, 41.90000000000001, 46.099999999999994, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, 5.299999999999635, 44.7, 43.30000000000001, 36.10000000000004, 38.50000000000003, 43.50000000000001, 9.8999999999997, -50.00000000000044, 42.30000000000001], "episode_lengths": [84, 68, 500, 500, 64, 500, 500, 64, 64, 60, 80, 46, 158, 500, 188, 56, 288, 264, 500, 500, 124, 46, 46, 500, 500, 500, 90, 92, 418, 176, 44, 74, 500, 126, 500, 92, 500, 436, 134, 52, 144, 70, 56, 122, 64, 62, 150, 90, 500, 34, 440, 500, 40, 500, 500, 96, 28, 500, 142, 500, 112, 500, 500, 500, 68, 64, 500, 42, 500, 118, 82, 62, 104, 112, 500, 82, 40, 46, 500, 34, 500, 500, 122, 500, 330, 48, 500, 116, 500, 42, 500, 448, 54, 68, 140, 116, 66, 402, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4078884743613919, "mean_inference_ms": 1.304371622546777, "mean_action_processing_ms": 0.15234451949472005, "mean_env_wait_ms": 0.09098515207575102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399658203125, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.12410736083984375}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.09899999999984, "episode_len_mean": 244.68, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 43.7, 44.10000000000001, 42.10000000000001, 45.5, 34.30000000000004, -50.00000000000044, 31.300000000000004, 44.5, 21.299999999999862, 23.699999999999896, -50.00000000000044, -50.00000000000044, 37.70000000000003, 45.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.90000000000002, 8.299999999999677, 32.50000000000002, 45.7, 42.70000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.499999999999652, 36.70000000000003, 44.900000000000006, 35.70000000000003, 43.10000000000001, 44.5, 37.90000000000003, 43.7, 43.900000000000006, 35.10000000000004, 41.100000000000016, -50.00000000000044, 46.699999999999996, 6.099999999999646, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 38.300000000000026, 41.90000000000001, 43.900000000000006, 39.70000000000002, 38.90000000000002, -50.00000000000044, 41.90000000000001, 46.099999999999994, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, 5.299999999999635, 44.7, 43.30000000000001, 36.10000000000004, 38.50000000000003, 43.50000000000001, 9.8999999999997, -50.00000000000044, 42.30000000000001], "episode_lengths": [84, 68, 500, 500, 64, 500, 500, 64, 64, 60, 80, 46, 158, 500, 188, 56, 288, 264, 500, 500, 124, 46, 46, 500, 500, 500, 90, 92, 418, 176, 44, 74, 500, 126, 500, 92, 500, 436, 134, 52, 144, 70, 56, 122, 64, 62, 150, 90, 500, 34, 440, 500, 40, 500, 500, 96, 28, 500, 142, 500, 112, 500, 500, 500, 68, 64, 500, 42, 500, 118, 82, 62, 104, 112, 500, 82, 40, 46, 500, 34, 500, 500, 122, 500, 330, 48, 500, 116, 500, 42, 500, 448, 54, 68, 140, 116, 66, 402, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4078884743613919, "mean_inference_ms": 1.304371622546777, "mean_action_processing_ms": 0.15234451949472005, "mean_env_wait_ms": 0.09098515207575102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399658203125, "StateBufferConnector_ms": 0.007001399993896484, "ViewRequirementAgentConnector_ms": 0.12410736083984375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5601.545187898254, "num_env_steps_trained_throughput_per_sec": 5601.545187898254, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2179.131, "sample_time_ms": 1915.625, "load_time_ms": 12.469, "load_throughput": 962424.933, "learn_time_ms": 240.137, "learn_throughput": 49971.419, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5681, "training_iteration": 124, "trial_id": "9f288_00008", "date": "2023-10-25_16-15-59", "timestamp": 1698246959, "time_this_iter_s": 2.147263288497925, "time_total_s": 293.84441351890564, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 293.84441351890564, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 61.73333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578302e-39, "cur_lr": 0.0003, "total_loss": 6.622867902119954, "policy_loss": -0.00025581536141948565, "vf_loss": 6.623177660836114, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0003320178544975584, "entropy": 0.5397917098469205, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2241.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.710999999999813, "episode_len_mean": 268.52, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 37.90000000000003, 43.7, 43.900000000000006, 35.10000000000004, 41.100000000000016, -50.00000000000044, 46.699999999999996, 6.099999999999646, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 38.300000000000026, 41.90000000000001, 43.900000000000006, 39.70000000000002, 38.90000000000002, -50.00000000000044, 41.90000000000001, 46.099999999999994, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, 5.299999999999635, 44.7, 43.30000000000001, 36.10000000000004, 38.50000000000003, 43.50000000000001, 9.8999999999997, -50.00000000000044, 42.30000000000001, 9.099999999999689, -50.00000000000044, 40.30000000000002, 29.099999999999973, 43.10000000000001, 37.70000000000003, 44.5, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.30000000000001, 31.500000000000007, 45.3, 20.699999999999854, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.70000000000002, 1.099999999999575, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 13.499999999999751], "episode_lengths": [56, 122, 64, 62, 150, 90, 500, 34, 440, 500, 40, 500, 500, 96, 28, 500, 142, 500, 112, 500, 500, 500, 68, 64, 500, 42, 500, 118, 82, 62, 104, 112, 500, 82, 40, 46, 500, 34, 500, 500, 122, 500, 330, 48, 500, 116, 500, 42, 500, 448, 54, 68, 140, 116, 66, 402, 500, 78, 410, 500, 98, 210, 70, 124, 56, 86, 96, 500, 500, 40, 88, 186, 48, 294, 500, 500, 78, 64, 500, 500, 130, 104, 490, 500, 240, 500, 500, 244, 500, 370, 500, 500, 44, 500, 38, 500, 500, 500, 58, 366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4074294288980239, "mean_inference_ms": 1.3031277243427568, "mean_action_processing_ms": 0.15235106791770808, "mean_env_wait_ms": 0.09089209111202115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.009007692337036133, "ViewRequirementAgentConnector_ms": 0.11699175834655762}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.710999999999813, "episode_len_mean": 268.52, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 37.90000000000003, 43.7, 43.900000000000006, 35.10000000000004, 41.100000000000016, -50.00000000000044, 46.699999999999996, 6.099999999999646, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, 47.3, -50.00000000000044, 35.900000000000034, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 38.300000000000026, 41.90000000000001, 43.900000000000006, 39.70000000000002, 38.90000000000002, -50.00000000000044, 41.90000000000001, 46.099999999999994, 45.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 17.099999999999802, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044, 45.9, -50.00000000000044, 5.299999999999635, 44.7, 43.30000000000001, 36.10000000000004, 38.50000000000003, 43.50000000000001, 9.8999999999997, -50.00000000000044, 42.30000000000001, 9.099999999999689, -50.00000000000044, 40.30000000000002, 29.099999999999973, 43.10000000000001, 37.70000000000003, 44.5, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.30000000000001, 31.500000000000007, 45.3, 20.699999999999854, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 37.10000000000003, 39.70000000000002, 1.099999999999575, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 13.099999999999746, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 13.499999999999751], "episode_lengths": [56, 122, 64, 62, 150, 90, 500, 34, 440, 500, 40, 500, 500, 96, 28, 500, 142, 500, 112, 500, 500, 500, 68, 64, 500, 42, 500, 118, 82, 62, 104, 112, 500, 82, 40, 46, 500, 34, 500, 500, 122, 500, 330, 48, 500, 116, 500, 42, 500, 448, 54, 68, 140, 116, 66, 402, 500, 78, 410, 500, 98, 210, 70, 124, 56, 86, 96, 500, 500, 40, 88, 186, 48, 294, 500, 500, 78, 64, 500, 500, 130, 104, 490, 500, 240, 500, 500, 244, 500, 370, 500, 500, 44, 500, 38, 500, 500, 500, 58, 366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4074294288980239, "mean_inference_ms": 1.3031277243427568, "mean_action_processing_ms": 0.15235106791770808, "mean_env_wait_ms": 0.09089209111202115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699756622314453, "StateBufferConnector_ms": 0.009007692337036133, "ViewRequirementAgentConnector_ms": 0.11699175834655762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5391.959248278577, "num_env_steps_trained_throughput_per_sec": 5391.959248278577, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2174.475, "sample_time_ms": 1913.034, "load_time_ms": 12.287, "load_throughput": 976649.811, "learn_time_ms": 238.257, "learn_throughput": 50365.872, "synch_weights_time_ms": 9.897}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5723, "training_iteration": 125, "trial_id": "9f288_00008", "date": "2023-10-25_16-16-01", "timestamp": 1698246961, "time_this_iter_s": 2.230543375015259, "time_total_s": 296.0749568939209, "pid": 27040, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 296.0749568939209, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 60.56666666666666, "ram_util_percent": 26.633333333333336}}
